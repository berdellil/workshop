/*! For license information please see 307.chunk.js.LICENSE.txt */
(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([[307],{1865:function(e,t,n){"use strict";n.r(t);n.d(t,"Provider",function(){return c});n.d(t,"connectAdvanced",function(){return b});n.d(t,"ReactReduxContext",function(){return f});n.d(t,"connect",function(){return K});function r(e,t){return(r=Object.setPrototypeOf||function(e,t){e.__proto__=t;return e})(e,t)}function i(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;r(e,t)}var s=n("react-lib"),o=n.n(s),u=n("prop-types-lib"),a=n.n(u),f=o.a.createContext(null),l=(function(e){i(t,e);function t(t){var n;n=e.call(this,t)||this;var r=t.store;n.state={storeState:r.getState(),store:r};return n}var n=t.prototype;n.componentDidMount=function(){this._isMounted=!0;this.subscribe()};n.componentWillUnmount=function(){this.unsubscribe&&this.unsubscribe();this._isMounted=!1};n.componentDidUpdate=function(e){if(this.props.store!==e.store){this.unsubscribe&&this.unsubscribe();this.subscribe()}};n.subscribe=function(){var e=this,t=this.props.store;this.unsubscribe=t.subscribe(function(){var n=t.getState();e._isMounted&&e.setState(function(e){return e.storeState===n?null:{storeState:n}})});var n=t.getState();n!==this.state.storeState&&this.setState({storeState:n})};n.render=function(){var e=this.props.context||f;return o.a.createElement(e.Provider,{value:this.state},this.props.children)};return t})(s.Component);l.propTypes={store:a.a.shape({subscribe:a.a.func.isRequired,dispatch:a.a.func.isRequired,getState:a.a.func.isRequired}),context:a.a.object,children:a.a.any};var c=l;function h(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function p(){return(p=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function d(e,t){if(null==e)return{};var n,r,i={},s=Object.keys(e);for(r=0;r<s.length;r++){n=s[r];t.indexOf(n)>=0||(i[n]=e[n])}return i}var v=n(1410),m=n.n(v),g=n(41),y=n.n(g);n(1557);function b(e,t){void 0===t&&(t={});var n=t,r=n.getDisplayName,u=void 0===r?function(e){return"ConnectAdvanced("+e+")"}:r,a=n.methodName,l=void 0===a?"connectAdvanced":a,c=n.renderCountProp,v=void 0===c?void 0:c,g=n.shouldHandleStateChanges,b=void 0===g||g,w=n.storeKey,E=void 0===w?"store":w,S=n.withRef,x=void 0!==S&&S,T=n.forwardRef,N=void 0!==T&&T,C=n.context,k=void 0===C?f:C,L=d(n,["getDisplayName","methodName","renderCountProp","shouldHandleStateChanges","storeKey","withRef","forwardRef","context"]);y()(void 0===v,"renderCountProp is removed. render counting is built into the latest React dev tools profiling extension");y()(!x,"withRef is removed. To access the wrapped instance, use a ref on the connected component");var A="To use a custom Redux store for specific components,  create a custom React context with React.createContext(), and pass the context object to React-Redux's Provider and specific components like:  <Provider context={MyContext}><ConnectedComponent context={MyContext} /></Provider>. You may also pass a {context : MyContext} option to connect";y()("store"===E,"storeKey has been removed and does not do anything. "+A);var O=k;return function(t){0;var n=t.displayName||t.name||"Component",r=u(n),a=p({},L,{getDisplayName:u,methodName:l,renderCountProp:v,shouldHandleStateChanges:b,storeKey:E,displayName:r,wrappedComponentName:n,WrappedComponent:t}),f=L.pure,c=s.Component,d=t;f&&(c=s.PureComponent);var g=(function(t){i(n,t);function n(n){var r,i,s,u,l,c,v,m,g;r=t.call(this,n)||this;y()(N?!n.wrapperProps[E]:!n[E],"Passing redux store in props has been removed and does not do anything. "+A);r.selectDerivedProps=function(t,n,r){if(f&&i===n&&s===t)return u;if(r!==l){l=r;c=e(r.dispatch,a)}i=n;s=t;var o=c(t,n);return u===o?u:u=o};r.selectChildElement=function(e,t){if(e!==v||t!==m){v=e;m=t;g=o.a.createElement(d,p({},e,{ref:t}))}return g};r.renderWrappedComponent=r.renderWrappedComponent.bind(h(h(r)));return r}var s=n.prototype;s.renderWrappedComponent=function(e){y()(e,'Could not find "store" in the context of "'+r+'". Either wrap the root component in a <Provider>, or pass a custom React context provider to <Provider> and the corresponding React context consumer to '+r+" in connect options.");var t,n=e.storeState,i=e.store,s=this.props;if(N){s=this.props.wrapperProps;t=this.props.forwardedRef}var o=this.selectDerivedProps(n,s,i);return this.selectChildElement(o,t)};s.render=function(){var e=this.props.context||O;return o.a.createElement(e.Consumer,null,this.renderWrappedComponent)};return n})(c);g.WrappedComponent=t;g.displayName=r;if(N){var w=o.a.forwardRef(function(e,t){return o.a.createElement(g,{wrapperProps:e,forwardedRef:t})});w.displayName=r;w.WrappedComponent=t;return m()(w,t)}return m()(g,t)}}var w=Object.prototype.hasOwnProperty;function E(e,t){return e===t?0!==e||0!==t||1/e==1/t:e!=e&&t!=t}function S(e,t){if(E(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(var i=0;i<n.length;i++)if(!w.call(t,n[i])||!E(e[n[i]],t[n[i]]))return!1;return!0}n(1061);var x=function(){return Math.random().toString(36).substring(7).split("").join(".")};x(),x();function T(e,t){return function(){return t(e.apply(this,arguments))}}0;function N(e){return function(t,n){var r=e(t,n);function i(){return r}i.dependsOnOwnProps=!1;return i}}function C(e){return null!==e.dependsOnOwnProps&&void 0!==e.dependsOnOwnProps?Boolean(e.dependsOnOwnProps):1!==e.length}function k(e,t){return function(t,n){n.displayName;var r=function(e,t){return r.dependsOnOwnProps?r.mapToProps(e,t):r.mapToProps(e)};r.dependsOnOwnProps=!0;r.mapToProps=function(t,n){r.mapToProps=e;r.dependsOnOwnProps=C(e);var i=r(t,n);if("function"==typeof i){r.mapToProps=i;r.dependsOnOwnProps=C(i);i=r(t,n)}0;return i};return r}}var L=[function(e){return"function"==typeof e?k(e):void 0},function(e){return e?void 0:N(function(e){return{dispatch:e}})},function(e){return e&&"object"==typeof e?N(function(t){return(function(e,t){if("function"==typeof e)return T(e,t);if("object"!=typeof e||null===e)throw new Error("bindActionCreators expected an object or a function, instead received "+(null===e?"null":typeof e)+'. Did you write "import ActionCreators from" instead of "import * as ActionCreators from"?');for(var n=Object.keys(e),r={},i=0;i<n.length;i++){var s=n[i],o=e[s];"function"==typeof o&&(r[s]=T(o,t))}return r})(e,t)}):void 0}];var A=[function(e){return"function"==typeof e?k(e):void 0},function(e){return e?void 0:N(function(){return{}})}];function O(e,t,n){return p({},n,e,t)}var M=[function(e){return"function"==typeof e?(function(e){return function(t,n){n.displayName;var r,i=n.pure,s=n.areMergedPropsEqual,o=!1;return function(t,n,u){var a=e(t,n,u);if(o)i&&s(a,r)||(r=a);else{o=!0;r=a;0}return r}}})(e):void 0},function(e){return e?void 0:function(){return O}}];function _(e,t,n,r){return function(i,s){return n(e(i,s),t(r,s),s)}}function D(e,t,n,r,i){var s,o,u,a,f,l=i.areStatesEqual,c=i.areOwnPropsEqual,h=i.areStatePropsEqual,p=!1;function d(i,p){var d=!c(p,o),v=!l(i,s);s=i;o=p;return d&&v?(function(){u=e(s,o);t.dependsOnOwnProps&&(a=t(r,o));return f=n(u,a,o)})():d?(function(){e.dependsOnOwnProps&&(u=e(s,o));t.dependsOnOwnProps&&(a=t(r,o));return f=n(u,a,o)})():v?(function(){var t=e(s,o),r=!h(t,u);u=t;r&&(f=n(u,a,o));return f})():f}return function(i,l){return p?d(i,l):(function(i,l){u=e(s=i,o=l);a=t(r,o);f=n(u,a,o);p=!0;return f})(i,l)}}function P(e,t){var n=t.initMapStateToProps,r=t.initMapDispatchToProps,i=t.initMergeProps,s=d(t,["initMapStateToProps","initMapDispatchToProps","initMergeProps"]),o=n(e,s),u=r(e,s),a=i(e,s);0;return(s.pure?D:_)(o,u,a,e,s)}function H(e,t,n){for(var r=t.length-1;r>=0;r--){var i=t[r](e);if(i)return i}return function(t,r){throw new Error("Invalid value of type "+typeof e+" for "+n+" argument when connecting component "+r.wrappedComponentName+".")}}function B(e,t){return e===t}var j,F,I,q,R,U,z,W,X,V,$,J,K=(I=(F=void 0===j?{}:j).connectHOC,q=void 0===I?b:I,R=F.mapStateToPropsFactories,U=void 0===R?A:R,z=F.mapDispatchToPropsFactories,W=void 0===z?L:z,X=F.mergePropsFactories,V=void 0===X?M:X,$=F.selectorFactory,J=void 0===$?P:$,function(e,t,n,r){void 0===r&&(r={});var i=r,s=i.pure,o=void 0===s||s,u=i.areStatesEqual,a=void 0===u?B:u,f=i.areOwnPropsEqual,l=void 0===f?S:f,c=i.areStatePropsEqual,h=void 0===c?S:c,v=i.areMergedPropsEqual,m=void 0===v?S:v,g=d(i,["pure","areStatesEqual","areOwnPropsEqual","areStatePropsEqual","areMergedPropsEqual"]),y=H(e,U,"mapStateToProps"),b=H(t,W,"mapDispatchToProps"),w=H(n,V,"mergeProps");return q(J,p({methodName:"connect",getDisplayName:function(e){return"Connect("+e+")"},shouldHandleStateChanges:Boolean(e),initMapStateToProps:y,initMapDispatchToProps:b,initMergeProps:w,pure:o,areStatesEqual:a,areOwnPropsEqual:l,areStatePropsEqual:h,areMergedPropsEqual:m},g))})},2183:function(e,t,n){"use strict";n.d(t,"e",function(){return S});var r=n(693),i=n(4),s=n("react-lib"),o=n(536),u=n(770),a=n(112),f=n(233),l=n(552),c=n(1454),h=n(481),p=n(40),d=n(1177),v=n(377),m=n(80),g=n(2314),y=Object(v.e)(),b=(function(e){Object(i.r)(t,e);function t(t){var n=e.call(this,t)||this;n._disposables=[];n._sliderLine=s.createRef();n._thumb=s.createRef();n._lowerValueThumb=s.createRef();n._onKeyDownTimer=-1;n._isAdjustingLowerValue=!1;n._getAriaValueText=function(e){var t=n.props.ariaValueText;if(void 0!==e)return t?t(e):e.toString()};n._calculateCurrentSteps=function(e){if(n._sliderLine.current){var t,r=n.props,i=(r.max-r.min)/r.step,s=n._sliderLine.current.getBoundingClientRect(),u=(n.props.vertical?s.height:s.width)/i;if(n.props.vertical){var a=n._getPosition(e,n.props.vertical);t=(s.bottom-a)/u}else{var f=n._getPosition(e,n.props.vertical);t=(Object(o.e)(n.props.theme)?s.right-f:f-s.left)/u}return t}};n._onMouseDownOrTouchStart=function(e){var t=n.props,r=t.ranged,i=t.min,s=t.step;if(r){var o=i+s*n._calculateCurrentSteps(e);o<=n.state.lowerValue||o-n.state.lowerValue<=n.state.value-o?n._isAdjustingLowerValue=!0:n._isAdjustingLowerValue=!1}"mousedown"===e.type?n._disposables.push(Object(u.e)(window,"mousemove",n._onMouseMoveOrTouchMove,!0),Object(u.e)(window,"mouseup",n._onMouseUpOrTouchEnd,!0)):"touchstart"===e.type&&n._disposables.push(Object(u.e)(window,"touchmove",n._onMouseMoveOrTouchMove,!0),Object(u.e)(window,"touchend",n._onMouseUpOrTouchEnd,!0));n._onMouseMoveOrTouchMove(e,!0)};n._onMouseMoveOrTouchMove=function(e,t){if(n._sliderLine.current){var r,i,s=n.props,o=s.max,u=s.min,a=s.step,f=(o-u)/a,l=n._calculateCurrentSteps(e);if(l>Math.floor(f))i=r=o;else if(l<0)i=r=u;else{i=u+a*l;r=u+a*Math.round(l)}n._updateValue(r,i);if(!t){e.preventDefault();e.stopPropagation()}}};n._onMouseUpOrTouchEnd=function(e){n.setState({renderedValue:void 0,renderedLowerValue:void 0});n.props.onChanged&&n.props.onChanged(e,n.state.value);n._disposeListeners()};n._disposeListeners=function(){n._disposables.forEach(function(e){return e()});n._disposables=[]};n._onKeyDown=function(e){var t;t=n._isAdjustingLowerValue?n.props.lowerValue||n.state.lowerValue:n.props.value||n.state.value;var r=n.props,i=r.max,s=r.min,u=r.step,f=0;switch(e.which){case Object(o.t)(a.e.left,n.props.theme):case a.e.down:f=-u;n._clearOnKeyDownTimer();n._setOnKeyDownTimer(e);break;case Object(o.t)(a.e.right,n.props.theme):case a.e.up:f=u;n._clearOnKeyDownTimer();n._setOnKeyDownTimer(e);break;case a.e.home:t=s;break;case a.e.end:t=i;break;default:return}var l=Math.min(i,Math.max(s,t+f));n._updateValue(l,l);e.preventDefault();e.stopPropagation();n.setState({renderedValue:void 0,renderedLowerValue:void 0})};n._onThumbFocus=function(e){n._isAdjustingLowerValue=e.target===n._lowerValueThumb.current};n._clearOnKeyDownTimer=function(){n._async.clearTimeout(n._onKeyDownTimer)};n._setOnKeyDownTimer=function(e){n._onKeyDownTimer=n._async.setTimeout(function(){n.props.onChanged&&n.props.onChanged(e,n.state.value)},1e3)};n._async=new f.e(n);Object(l.e)(n);Object(c.e)("SliderBase",n.props,{value:"defaultValue"});t.ranged&&Object(c.e)("SliderBase",n.props,{lowerValue:"defaultLowerValue"});n._id=Object(h.e)("Slider");var r=void 0!==t.value?t.value:void 0!==t.defaultValue?t.defaultValue:t.min,i=void 0!==t.lowerValue?t.lowerValue:void 0!==t.defaultLowerValue?t.defaultLowerValue:t.min;n.state={value:r,lowerValue:i,renderedValue:void 0,renderedLowerValue:void 0};return n}t.prototype.componentWillUnmount=function(){this._async.dispose();this._disposeListeners()};t.prototype.render=function(){var e,t,n,r=this.props,o=r.ariaLabel,u=r.className,a=r.disabled,f=r.label,l=r.max,c=r.min,h=r.showValue,v=r.buttonProps,b=r.vertical,w=r.styles,E=r.theme,S=r.originFromZero,x=r.ranged,T=this.value,N=this.renderedValue,C=this.renderedLowerValue,k=this._getPercent(N),L=this._getPercent(C),A=S?0:c,O=this._getPercent(A),M=x?k-L:Math.abs(O-k),_=Math.min(100-k,100-O),D=x?L:Math.min(k,O),P=b?"height":"width",H=a?{}:{onMouseDown:this._onMouseDownOrTouchStart},B=a?{}:{onTouchStart:this._onMouseDownOrTouchStart},j=a?{}:{onKeyDown:this._onKeyDown},F=a?{}:{onFocus:this._onThumbFocus},I=y(w,{className:u,ranged:x,disabled:a,vertical:b,showTransitions:N===T||x&&C===this.lowerValue,showValue:h,theme:E}),q=v?Object(m.u)(v,m.s):void 0,R={"aria-disabled":a,role:"slider",tabIndex:a?void 0:0,"data-is-focusable":!a},U=Object(i.e)(Object(i.e)(Object(i.e)(Object(i.e)(Object(i.e)({id:this._id,className:Object(p.e)(I.slideBox,v.className)},H),B),j),q),!x&&Object(i.e)(Object(i.e)({},R),{"aria-valuemin":c,"aria-valuemax":l,"aria-valuenow":T,"aria-valuetext":this._getAriaValueText(T),"aria-label":o||f})),z=x?Object(i.e)(Object(i.e)(Object(i.e)({},R),F),{id:"max-"+this._id,"aria-valuemin":this.lowerValue,"aria-valuemax":l,"aria-valuenow":T,"aria-valuetext":this._getAriaValueText(T),"aria-label":"max "+(o||f)}):void 0,W=x?Object(i.e)(Object(i.e)(Object(i.e)({},R),F),{id:"min-"+this._id,"aria-valuemin":c,"aria-valuemax":T,"aria-valuenow":this.lowerValue,"aria-valuetext":this._getAriaValueText(this.lowerValue),"aria-label":"min "+(o||f)}):void 0;return s.createElement("div",{className:I.root},f&&s.createElement(g.e,Object(i.e)({className:I.titleLabel},o?{}:{htmlFor:this._id},{disabled:a}),f),s.createElement("div",{className:I.container},x&&h&&s.createElement(g.e,{className:I.valueLabel,disabled:a},this._getValueLabel(b?this.value:this.lowerValue)),s.createElement("div",Object(i.e)({},U),s.createElement("div",{ref:this._sliderLine,className:I.line},S&&s.createElement("span",{className:Object(p.e)(I.zeroTick),style:this._getStyleUsingOffsetPercent(b,O)}),x&&s.createElement("span",Object(i.e)({ref:this._lowerValueThumb,className:I.thumb,style:this._getStyleUsingOffsetPercent(b,L)},W)),s.createElement("span",Object(i.e)({ref:this._thumb,className:I.thumb,style:this._getStyleUsingOffsetPercent(b,k)},z)),(x||S)&&s.createElement("span",{className:Object(p.e)(I.lineContainer,I.inactiveSection),style:(e={},e[P]=D+"%",e)}),s.createElement("span",{className:Object(p.e)(I.lineContainer,I.activeSection),style:(t={},t[P]=M+"%",t)}),s.createElement("span",{className:Object(p.e)(I.lineContainer,I.inactiveSection),style:(n={},n[P]=_+"%",n)}))),h&&s.createElement(g.e,{className:I.valueLabel,disabled:a},this._getValueLabel(x&&b?this.lowerValue:this.value))),s.createElement(d.e,null))};t.prototype.focus=function(){this._thumb.current&&this._thumb.current.focus()};Object.defineProperty(t.prototype,"range",{get:function(){if(this.props.ranged)return[this.lowerValue,this.value]},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"value",{get:function(){var e=this.props.value,t=void 0===e?this.state.value:e;return void 0===this.props.min||void 0===this.props.max||void 0===t?void 0:Math.max(this.props.min,Math.min(this.props.max,t))},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"renderedValue",{get:function(){var e=this.state.renderedValue;return void 0===e?this.value:e},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"lowerValue",{get:function(){var e=this.props,t=e.lowerValue,n=void 0===t?this.state.lowerValue:t;return e.ranged&&void 0!==this.props.min&&void 0!==this.props.max&&void 0!==n?Math.max(this.props.min,Math.min(this.props.max,n)):void 0},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"renderedLowerValue",{get:function(){var e=this.state.renderedLowerValue;return void 0===e?this.lowerValue:e},enumerable:!0,configurable:!0});t.prototype._getPercent=function(e){var t=this.props,n=t.min,r=t.max;return r===n?0:(e-n)/(r-n)*100};t.prototype._getValueLabel=function(e){var t=this.props.valueFormat;return t?t(e):e};t.prototype._getStyleUsingOffsetPercent=function(e,t){var n;return(n={})[e?"bottom":Object(o.e)(this.props.theme)?"right":"left"]=t+"%",n};t.prototype._getPosition=function(e,t){var n;switch(e.type){case"mousedown":case"mousemove":n=t?e.clientY:e.clientX;break;case"touchstart":case"touchmove":n=t?e.touches[0].clientY:e.touches[0].clientX}return n};t.prototype._setValueState=function(e,t){var n,r=this,i=this._isAdjustingLowerValue,s=e!==(i?this.state.lowerValue:this.state.value);this.setState(((n={})[i?"lowerValue":"value"]=e,n[i?"renderedLowerValue":"renderedValue"]=t,n),function(){var e=r.state,t=e.lowerValue,n=e.value;s&&r.props.onChange&&r.props.onChange(i?t:n,r.props.ranged?[t,n]:void 0)})};t.prototype._updateValue=function(e,t){var n=this.props,r=n.step,i=n.snapToStep,s=n.ranged,o=n.originFromZero,u=0;if(isFinite(r))for(;Math.round(r*Math.pow(10,u))/Math.pow(10,u)!==r;)u++;var a=parseFloat(e.toFixed(u));i&&(t=a);var f=this._isAdjustingLowerValue&&(o?a<=0:a<=this.renderedValue),l=!this._isAdjustingLowerValue&&(o?a>=0:a>=this.renderedLowerValue);(!s||f||l)&&this._setValueState(a,t)};t.defaultProps={step:1,min:0,max:10,showValue:!0,disabled:!1,vertical:!1,buttonProps:{},originFromZero:!1};return t})(s.Component),w=n(24),E={root:"ms-Slider",enabled:"ms-Slider-enabled",disabled:"ms-Slider-disabled",row:"ms-Slider-row",column:"ms-Slider-column",container:"ms-Slider-container",slideBox:"ms-Slider-slideBox",line:"ms-Slider-line",thumb:"ms-Slider-thumb",activeSection:"ms-Slider-active",inactiveSection:"ms-Slider-inactive",valueLabel:"ms-Slider-value",showValue:"ms-Slider-showValue",showTransitions:"ms-Slider-showTransitions",zeroTick:"ms-Slider-zeroTick"},S=Object(r.e)(b,function(e){var t,n,r,s,u,a,f,l,c,h,p,d,v,m=e.className,g=e.titleLabelClassName,y=e.theme,b=e.vertical,S=e.disabled,x=e.showTransitions,T=e.showValue,N=e.ranged,C=y.semanticColors,k=Object(w.N)(E,y),L=C.inputBackgroundCheckedHovered,A=C.inputBackgroundChecked,O=C.inputPlaceholderBackgroundChecked,M=C.smallInputBorder,_=C.disabledBorder,D=C.disabledText,P=C.disabledBackground,H=C.inputBackground,B=C.smallInputBorder,j=C.disabledBorder,F=!S&&{backgroundColor:L,selectors:(t={},t[w.o]={backgroundColor:"Highlight"},t)},I=!S&&{backgroundColor:O,selectors:(n={},n[w.o]={borderColor:"Highlight"},n)},q=!S&&{backgroundColor:A,selectors:(r={},r[w.o]={backgroundColor:"Highlight"},r)},R=!S&&{border:"2px solid "+L,selectors:(s={},s[w.o]={borderColor:"Highlight"},s)},U=!e.disabled&&{backgroundColor:C.inputPlaceholderBackgroundChecked,selectors:(u={},u[w.o]={backgroundColor:"Highlight"},u)};return{root:Object(i.o)([k.root,y.fonts.medium,{userSelect:"none"},b&&{marginRight:8}],[S?void 0:k.enabled],[S?k.disabled:void 0],[b?void 0:k.row],[b?k.column:void 0],[m]),titleLabel:[{padding:0},g],container:[k.container,{display:"flex",flexWrap:"nowrap",alignItems:"center"},b&&{flexDirection:"column",height:"100%",textAlign:"center",margin:"8px 0"}],slideBox:Object(i.o)([k.slideBox,!N&&Object(w.T)(y),{background:"transparent",border:"none",flexGrow:1,lineHeight:28,display:"flex",alignItems:"center",selectors:(a={},a[":active ."+k.activeSection]=F,a[":hover ."+k.activeSection]=q,a[":active ."+k.inactiveSection]=I,a[":hover ."+k.inactiveSection]=I,a[":active ."+k.thumb]=R,a[":hover ."+k.thumb]=R,a[":active ."+k.zeroTick]=U,a[":hover ."+k.zeroTick]=U,a[w.o]={forcedColorAdjust:"none"},a)},b?{height:"100%",width:28,padding:"8px 0"}:{height:28,width:"auto",padding:"0 8px"}],[T?k.showValue:void 0],[x?k.showTransitions:void 0]),thumb:[k.thumb,N&&Object(w.T)(y,{inset:-4}),{borderWidth:2,borderStyle:"solid",borderColor:B,borderRadius:10,boxSizing:"border-box",background:H,display:"block",width:16,height:16,position:"absolute"},b?{left:-6,margin:"0 auto",transform:"translateY(8px)"}:{top:-6,transform:Object(o.e)(y)?"translateX(50%)":"translateX(-50%)"},x&&{transition:"left "+w.n.durationValue3+" "+w.n.easeFunction1},S&&{borderColor:j,selectors:(f={},f[w.o]={borderColor:"GrayText"},f)}],line:[k.line,{display:"flex",position:"relative"},b?{height:"100%",width:4,margin:"0 auto",flexDirection:"column-reverse"}:{width:"100%"}],lineContainer:[{borderRadius:4,boxSizing:"border-box"},b?{width:4,height:"100%"}:{height:4,width:"100%"}],activeSection:[k.activeSection,{background:M,selectors:(l={},l[w.o]={backgroundColor:"WindowText"},l)},x&&{transition:"width "+w.n.durationValue3+" "+w.n.easeFunction1},S&&{background:D,selectors:(c={},c[w.o]={backgroundColor:"GrayText",borderColor:"GrayText"},c)}],inactiveSection:[k.inactiveSection,{background:_,selectors:(h={},h[w.o]={border:"1px solid WindowText"},h)},x&&{transition:"width "+w.n.durationValue3+" "+w.n.easeFunction1},S&&{background:P,selectors:(p={},p[w.o]={borderColor:"GrayText"},p)}],zeroTick:[k.zeroTick,{position:"absolute",background:C.disabledBorder,selectors:(d={},d[w.o]={backgroundColor:"WindowText"},d)},e.disabled&&{background:C.disabledBackground,selectors:(v={},v[w.o]={backgroundColor:"GrayText"},v)},e.vertical?{width:"16px",height:"1px",transform:Object(o.e)(y)?"translateX(6px)":"translateX(-6px)"}:{width:"1px",height:"16px",transform:"translateY(-6px)"}],valueLabel:[k.valueLabel,{flexShrink:1,width:30,lineHeight:"1"},b?{margin:"0 auto",whiteSpace:"nowrap",width:40}:{margin:"0 8px",whiteSpace:"nowrap",width:40}]}},void 0,{scope:"Slider"})},2781:function(e,t,n){"use strict";n.d(t,"t",function(){return ie});n.d(t,"e",function(){return se});n.d(t,"n",function(){return oe});n.d(t,"r",function(){return ae});var r={};n.r(r);n.d(r,"tile",function(){return v});n.d(r,"selectable",function(){return m});n.d(r,"selected",function(){return g});n.d(r,"isFluentStyling",function(){return y});n.d(r,"name",function(){return b});n.d(r,"hasBackgroundFrame",function(){return w});n.d(r,"invokable",function(){return E});n.d(r,"label",function(){return S});n.d(r,"description",function(){return x});n.d(r,"link",function(){return T});n.d(r,"foreground",function(){return N});n.d(r,"foregroundHide",function(){return C});n.d(r,"hasForegroundFrame",function(){return k});n.d(r,"check",function(){return L});n.d(r,"uninvokable",function(){return A});n.d(r,"showCheck",function(){return O});n.d(r,"background",function(){return M});n.d(r,"backgroundHide",function(){return _});n.d(r,"aboveNameplate",function(){return D});n.d(r,"content",function(){return P});n.d(r,"nameplate",function(){return H});n.d(r,"activity",function(){return B});n.d(r,"signal",function(){return j});n.d(r,"storageSignal",function(){return F});n.d(r,"socialSignal",function(){return I});n.d(r,"lifecycleSignal",function(){return q});n.d(r,"isLarge",function(){return R});n.d(r,"isSmall",function(){return U});n.d(r,"hasBackground",function(){return z});n.d(r,"onlyOnHover",function(){return W});n.d(r,"showBackground",function(){return X});var i={};n.r(i);n.d(i,"root",function(){return $});n.d(i,"rootIsChecked",function(){return J});n.d(i,"check",function(){return K});n.d(i,"checkHost",function(){return Q});n.d(i,"circle",function(){return G});var s=n(4),o=n("react-lib"),u=n(1143),a=n(120),f=n(552),l=n(481),c=n(98),h=n(40),p=n(80),d=n(185);Object(d.n)([{rawString:".tile_62c694e9{display:block;position:absolute;top:0;bottom:0;left:0;right:0;z-index:0;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";-webkit-transition:-webkit-transform .1s linear;transition:-webkit-transform .1s linear;transition:transform .1s linear;transition:transform .1s linear,-webkit-transform .1s linear;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.tile_62c694e9::-moz-focus-inner{border:0}.tile_62c694e9{outline:transparent}.tile_62c694e9.selectable_62c694e9:hover{background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:"}.tile_62c694e9.selectable_62c694e9:hover.selected_62c694e9{background-color:"},{theme:"neutralQuaternaryAlt",defaultValue:"#e1dfdd"},{rawString:"}.tile_62c694e9.selected_62c694e9{background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.tile_62c694e9.selected_62c694e9.isFluentStyling_62c694e9 .name_62c694e9{font-weight:600}.ms-Fabric--isFocusVisible .tile_62c694e9:focus{background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:"}.ms-Fabric--isFocusVisible .tile_62c694e9:focus.isFluentStyling_62c694e9{background-color:transparent}.ms-Fabric--isFocusVisible .tile_62c694e9:focus.selected_62c694e9{background-color:"},{theme:"neutralQuaternaryAlt",defaultValue:"#e1dfdd"},{rawString:"}.ms-Fabric--isFocusVisible .tile_62c694e9:focus{outline:1px solid "},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.ms-Fabric--isFocusVisible .tile_62c694e9:focus.selected_62c694e9{outline:1px solid "},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.ms-Fabric--isFocusVisible .tile_62c694e9:focus.selected_62c694e9.isFluentStyling_62c694e9{outline:1px solid "},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.tile_62c694e9.hasBackgroundFrame_62c694e9{-webkit-box-shadow:0 1px 3px 1px rgba(1,1,0,.05);box-shadow:0 1px 3px 1px rgba(1,1,0,.05)}.tile_62c694e9.hasBackgroundFrame_62c694e9.selectable_62c694e9:hover{outline:1px solid "},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:"}.ms-Fabric--isFocusVisible .tile_62c694e9.hasBackgroundFrame_62c694e9:focus{outline:1px solid "},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.ms-Fabric--isFocusVisible .tile_62c694e9.hasBackgroundFrame_62c694e9:focus.selected_62c694e9{outline:1px solid "},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.tile_62c694e9.hasBackgroundFrame_62c694e9:after{content:'';display:block;position:absolute;top:0;left:0;bottom:0;right:0;pointer-events:none;border:2px solid "},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.tile_62c694e9.invokable_62c694e9:active{-webkit-transform:scale(.95);transform:scale(.95)}.label_62c694e9{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}.description_62c694e9{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}.link_62c694e9{border:none;background:0 0;position:absolute;padding:0;top:0;left:0;bottom:0;right:0;width:100%;text-decoration:none;color:inherit;overflow:hidden;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:stretch;-ms-flex-align:stretch;align-items:stretch;-ms-flex-line-pack:stretch;align-content:stretch;pointer-events:none}.link_62c694e9::-moz-focus-inner{border:0}.link_62c694e9{outline:transparent}.foreground_62c694e9{display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;position:relative;overflow:visible;max-width:100%;max-height:100%;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;opacity:1;-webkit-transition:opacity .2s linear;transition:opacity .2s linear}.tile_62c694e9.invokable_62c694e9 .foreground_62c694e9{pointer-events:auto;cursor:pointer}.foreground_62c694e9.foregroundHide_62c694e9{opacity:0}.hasForegroundFrame_62c694e9 .foreground_62c694e9{background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";-webkit-box-shadow:0 1px 3px 1px rgba(1,1,0,.05);box-shadow:0 1px 3px 1px rgba(1,1,0,.05);min-width:32px;min-height:32px}.hasForegroundFrame_62c694e9 .foreground_62c694e9:after{content:'';display:block;position:absolute;top:0;left:0;bottom:0;right:0;pointer-events:none;border:2px solid "},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.check_62c694e9{display:none;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:end;-ms-flex-align:end;align-items:flex-end;-webkit-box-pack:start;-ms-flex-pack:start;justify-content:flex-start;top:0;border:none;background:0 0;background-color:transparent;opacity:0;-webkit-box-sizing:border-box;box-sizing:border-box;padding:6px}.check_62c694e9::-moz-focus-inner{border:0}.check_62c694e9{outline:transparent}.check_62c694e9{position:absolute}.ms-Fabric--isFocusVisible .check_62c694e9:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{theme:"focusBorder",defaultValue:"#605e5c"},{rawString:"}html[dir=ltr] .check_62c694e9{right:0}html[dir=rtl] .check_62c694e9{left:0}.tile_62c694e9.uninvokable_62c694e9 .check_62c694e9{width:100%;height:100%}.tile_62c694e9.selectable_62c694e9 .check_62c694e9{display:-webkit-box;display:-ms-flexbox;display:flex}.tile_62c694e9.selected_62c694e9 .check_62c694e9,.tile_62c694e9.showCheck_62c694e9 .check_62c694e9,.tile_62c694e9:hover .check_62c694e9{opacity:1}.ms-Fabric--isFocusVisible .check_62c694e9:focus{opacity:1}.ms-Fabric--isFocusVisible .tile_62c694e9:focus .check_62c694e9{opacity:1}.background_62c694e9{position:absolute;top:0;left:0;right:0;bottom:0;overflow:hidden;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;opacity:1;-webkit-transition:opacity .2s linear;transition:opacity .2s linear}.tile_62c694e9.invokable_62c694e9 .background_62c694e9{cursor:pointer;pointer-events:auto}.background_62c694e9.backgroundHide_62c694e9{opacity:0}.aboveNameplate_62c694e9{-webkit-box-flex:1;-ms-flex:1;flex:1;position:relative;margin:16px 16px 0 16px}.content_62c694e9{position:absolute;top:0;left:0;bottom:0;right:0;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}.hasForegroundFrame_62c694e9 .content_62c694e9{-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end}.nameplate_62c694e9{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end;position:relative;margin:auto 0 0 0;padding:12px 8px;text-align:center;z-index:0}.nameplate_62c694e9 .name_62c694e9{-webkit-transition:color .2s linear;transition:color .2s linear}.tile_62c694e9.invokable_62c694e9 .nameplate_62c694e9 .name_62c694e9{pointer-events:auto;cursor:pointer}.link_62c694e9:hover .nameplate_62c694e9 .name_62c694e9{text-decoration:underline}.isFluentStyling_62c694e9 .link_62c694e9:hover .nameplate_62c694e9 .name_62c694e9{text-decoration:none}.nameplate_62c694e9 .activity_62c694e9{-webkit-transition:color .2s linear;transition:color .2s linear}.tile_62c694e9.hasBackgroundFrame_62c694e9 .nameplate_62c694e9{-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start;padding:12px 10px}.signal_62c694e9{display:inline-block}html[dir=ltr] .signal_62c694e9.storageSignal_62c694e9{margin-left:4px}html[dir=rtl] .signal_62c694e9.storageSignal_62c694e9{margin-right:4px}html[dir=ltr] .signal_62c694e9.socialSignal_62c694e9{margin-right:4px}html[dir=rtl] .signal_62c694e9.socialSignal_62c694e9{margin-left:4px}html[dir=ltr] .signal_62c694e9.lifecycleSignal_62c694e9{margin-right:4px}html[dir=rtl] .signal_62c694e9.lifecycleSignal_62c694e9{margin-left:4px}.name_62c694e9{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;font-weight:400;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:100%}html[dir=ltr] .name_62c694e9{margin-left:-8px}html[dir=rtl] .name_62c694e9{margin-right:-8px}html[dir=ltr] .name_62c694e9{padding-left:8px}html[dir=rtl] .name_62c694e9{padding-right:8px}.isLarge_62c694e9 .name_62c694e9,.name_62c694e9{font-size:14px;height:30px;margin-top:-7px;margin-bottom:-8px}.isSmall_62c694e9 .name_62c694e9{font-size:12px;height:24px;margin-top:-5px;margin-bottom:-7px}.activity_62c694e9{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;font-weight:400;font-size:12px;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:100%;height:24px;margin-bottom:-4px}html[dir=ltr] .activity_62c694e9{margin-left:-8px}html[dir=rtl] .activity_62c694e9{margin-right:-8px}html[dir=ltr] .activity_62c694e9{padding-left:8px}html[dir=rtl] .activity_62c694e9{padding-right:8px}.hasBackgroundFrame_62c694e9 .name_62c694e9{display:block}html[dir=ltr] .hasBackgroundFrame_62c694e9 .name_62c694e9{-webkit-box-pack:left;-ms-flex-pack:left;justify-content:left}html[dir=rtl] .hasBackgroundFrame_62c694e9 .name_62c694e9{-webkit-box-pack:right;-ms-flex-pack:right;justify-content:right}.hasBackgroundFrame_62c694e9 .name_62c694e9,.isLarge_62c694e9 .isSmall_62c694e9 .hasBackgroundFrame_62c694e9 .name_62c694e9{font-size:14px;height:auto;padding-top:6px;margin-top:0;margin-bottom:0;line-height:22px}.hasBackgroundFrame_62c694e9 .activity_62c694e9{font-size:12px;display:block;height:auto;margin-top:0;margin-bottom:0;line-height:20px}html[dir=ltr] .hasBackgroundFrame_62c694e9 .activity_62c694e9{-webkit-box-pack:left;-ms-flex-pack:left;justify-content:left;text-align:left}html[dir=rtl] .hasBackgroundFrame_62c694e9 .activity_62c694e9{-webkit-box-pack:left;-ms-flex-pack:left;justify-content:left;text-align:left}.hasBackground_62c694e9 .nameplate_62c694e9:before{position:absolute;content:'';display:block;top:-4px;bottom:0;left:0;right:0;background-image:-webkit-gradient(linear,left bottom,left top,from(rgba(0,0,0,.65)),color-stop(55%,rgba(0,0,0,.5525)),color-stop(80%,rgba(0,0,0,.195)),to(rgba(0,0,0,0)));background-image:linear-gradient(to top,rgba(0,0,0,.65) 0,rgba(0,0,0,.5525) 55%,rgba(0,0,0,.195) 80%,rgba(0,0,0,0) 100%);z-index:-1;-webkit-transition:opacity .2s linear;transition:opacity .2s linear;opacity:0}.hasBackground_62c694e9 .onlyOnHover_62c694e9 .name_62c694e9{opacity:0;-webkit-transition:opacity .2s linear,color .2s linear,-webkit-transform .25s ease-out;transition:opacity .2s linear,color .2s linear,-webkit-transform .25s ease-out;transition:transform .25s ease-out,opacity .2s linear,color .2s linear;transition:transform .25s ease-out,opacity .2s linear,color .2s linear,-webkit-transform .25s ease-out;-webkit-transform:translateY(1rem);transform:translateY(1rem)}.hasBackground_62c694e9 .onlyOnHover_62c694e9 .activity_62c694e9{opacity:0;-webkit-transition:opacity .2s linear,color .2s linear,-webkit-transform .25s ease-out;transition:opacity .2s linear,color .2s linear,-webkit-transform .25s ease-out;transition:transform .25s ease-out,opacity .2s linear,color .2s linear;transition:transform .25s ease-out,opacity .2s linear,color .2s linear,-webkit-transform .25s ease-out;-webkit-transform:translateY(1rem);transform:translateY(1rem)}.hasBackground_62c694e9.selected_62c694e9 .name_62c694e9.onlyOnHover_62c694e9,.hasBackground_62c694e9:hover .name_62c694e9.onlyOnHover_62c694e9{opacity:1;-webkit-transform:translateY(0);transform:translateY(0)}.hasBackground_62c694e9.selected_62c694e9 .activity_62c694e9.onlyOnHover_62c694e9,.hasBackground_62c694e9:hover .activity_62c694e9.onlyOnHover_62c694e9{opacity:1;-webkit-transform:translateY(0);transform:translateY(0)}.hasBackground_62c694e9.showBackground_62c694e9.selected_62c694e9 .onlyOnHover_62c694e9.nameplate_62c694e9:before,.hasBackground_62c694e9.showBackground_62c694e9:hover .onlyOnHover_62c694e9.nameplate_62c694e9:before{opacity:1}.hasBackground_62c694e9.showBackground_62c694e9 .nameplate_62c694e9:not(.onlyOnHover_62c694e9):before{opacity:1}.hasBackground_62c694e9.showBackground_62c694e9 .name_62c694e9{color:#fff;text-shadow:.5px .5px 2px rgba(0,0,0,.55)}.hasBackground_62c694e9.showBackground_62c694e9 .activity_62c694e9{color:#fff;text-shadow:.5px .5px 2px rgba(0,0,0,.55)}"}]);var v="tile_62c694e9",m="selectable_62c694e9",g="selected_62c694e9",y="isFluentStyling_62c694e9",b="name_62c694e9",w="hasBackgroundFrame_62c694e9",E="invokable_62c694e9",S="label_62c694e9",x="description_62c694e9",T="link_62c694e9",N="foreground_62c694e9",C="foregroundHide_62c694e9",k="hasForegroundFrame_62c694e9",L="check_62c694e9",A="uninvokable_62c694e9",O="showCheck_62c694e9",M="background_62c694e9",_="backgroundHide_62c694e9",D="aboveNameplate_62c694e9",P="content_62c694e9",H="nameplate_62c694e9",B="activity_62c694e9",j="signal_62c694e9",F="storageSignal_62c694e9",I="socialSignal_62c694e9",q="lifecycleSignal_62c694e9",R="isLarge_62c694e9",U="isSmall_62c694e9",z="hasBackground_62c694e9",W="onlyOnHover_62c694e9",X="showBackground_62c694e9",V=n(680);Object(d.n)([{rawString:".root_b7ee80d1{line-height:1;width:18px;height:18px;vertical-align:top;position:relative;-webkit-touch-callout:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.root_b7ee80d1:before{content:'';position:absolute;left:1px;right:1px;bottom:1px;top:1px;border-radius:50%;opacity:1;background:"},{theme:"bodyBackground",defaultValue:"#ffffff"},{rawString:"}.root_b7ee80d1.rootIsChecked_b7ee80d1:before{background:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";opacity:1}@media screen and (-ms-high-contrast:active){.root_b7ee80d1.rootIsChecked_b7ee80d1:before{background:Window}}.root_b7ee80d1 .check_b7ee80d1{opacity:0}.checkHost_b7ee80d1:focus .root_b7ee80d1 .check_b7ee80d1,.checkHost_b7ee80d1:hover .root_b7ee80d1 .check_b7ee80d1,.root_b7ee80d1.rootIsChecked_b7ee80d1 .check_b7ee80d1,.root_b7ee80d1:focus .check_b7ee80d1,.root_b7ee80d1:hover .check_b7ee80d1{opacity:1}.check_b7ee80d1,.circle_b7ee80d1{font-size:18px;position:absolute;left:0;top:0;width:18px;height:18px;text-align:center;vertical-align:middle}.circle_b7ee80d1{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}@media screen and (-ms-high-contrast:active){.circle_b7ee80d1{color:WindowText}}.rootIsChecked_b7ee80d1 .circle_b7ee80d1{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.check_b7ee80d1{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";font-size:16px;left:.5px}@media screen and (-ms-high-contrast:active){.check_b7ee80d1{-ms-high-contrast-adjust:none}}.rootIsChecked_b7ee80d1 .check_b7ee80d1{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";font-weight:900}@media screen and (-ms-high-contrast:active){.rootIsChecked_b7ee80d1 .check_b7ee80d1{border:none;color:WindowText}}"}]);var $="root_b7ee80d1",J="rootIsChecked_b7ee80d1",K="check_b7ee80d1",Q="checkHost_b7ee80d1",G="circle_b7ee80d1",Y=r,Z=V,ee=i,te=12,ne=0,re=16,ie={small:{nameplatePadding:te,nameplateNameHeight:12,nameplateMargin:ne,nameplateActivityHeight:20,foregroundMargin:re},large:{nameplatePadding:te,nameplateNameHeight:15,nameplateMargin:ne,nameplateActivityHeight:20,foregroundMargin:re}},se=(function(e){Object(s.r)(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._onSelectionChange=function(){var e=r.props,t=e.selection,n=e.selectionIndex,i=void 0===n?-1:n,s=i>-1&&!!t&&t.isIndexSelected(i),o=!!t&&!!t.isModal&&t.isModal();r.setState({isSelected:s,isModal:o})};Object(f.e)(r);r._nameId=Object(l.e)("Tile-name");r._activityId=Object(l.e)("Tile-activity");r._labelId=Object(l.e)("Tile-label");r._descriptionId=Object(l.e)("Tile-description");var i=t.selectionIndex,s=void 0===i?-1:i,o=t.selection,u=!!o&&s>-1&&o.isIndexSelected(s),a=!!o&&!!o.isModal&&o.isModal();r.state={isSelected:u,isModal:a};r._events=new c.e(r);return r}t.prototype.UNSAFE_componentWillReceiveProps=function(e){var t=this.props,n=t.selection,r=t.selectionIndex,i=e.selection,s=e.selectionIndex,o=void 0===s?-1:s;if(n!==i||r!==o){var u=!!i&&o>-1&&i.isIndexSelected(o),a=!!i&&i.isModal&&i.isModal();this.setState({isSelected:u,isModal:a})}};t.prototype.componentDidMount=function(){var e=this.props.selection;e&&this._events.on(e,a.e,this._onSelectionChange)};t.prototype.componentDidUpdate=function(e){var t=this.props.selection,n=e.selection;if(t!==n){n&&this._events.off(n);t&&this._events.on(t,a.e,this._onSelectionChange)}};t.prototype.componentWillUnmount=function(){this._events.dispose()};t.prototype.render=function(){var e,t=this.props,n=(t.children,t.selectionIndex),r=void 0===n?-1:n,i=t.invokeSelection,u=void 0!==i&&i,a=t.selection,f=t.background,l=t.foreground,c=t.showBackgroundFrame,d=void 0!==c&&c,v=t.showForegroundFrame,m=void 0!==v&&v,g=t.hideBackground,y=void 0!==g&&g,b=t.hideForeground,w=void 0!==b&&b,E=t.itemName,T=t.itemActivity,N=(t.componentRef,t.className),C=t.tileSize,k=void 0===C?"large":C,L=(t.contentSize,t.ariaLabel),A=t.descriptionAriaLabel,O=t.href,M=t.onClick,_=t.download,D=t.hrefLang,P=t.media,H=t.rel,B=t.target,j=t.isFluentStyling,F=t.ariaLabelSelected,I=t.nameplateOnlyOnHover,q=Object(s.s)(t,["children","selectionIndex","invokeSelection","selection","background","foreground","showBackgroundFrame","showForegroundFrame","hideBackground","hideForeground","itemName","itemActivity","componentRef","className","tileSize","contentSize","ariaLabel","descriptionAriaLabel","href","onClick","download","hrefLang","media","rel","target","isFluentStyling","ariaLabelSelected","nameplateOnlyOnHover"]),R=this.state,U=R.isSelected,z=void 0!==U&&U,W=R.isModal,X=void 0!==W&&W,V=this.props.isSelectable,$=void 0===V?!!a&&r>-1:V,J=!(!O&&!M&&!u||X),K=z&&F?L+", "+F:L,Q=o.createElement(o.Fragment,null,L?o.createElement("span",{key:"label",id:this._labelId,className:Object(h.e)("ms-Tile-label",S)},K):null,f?this._onRenderBackground({background:f,hideBackground:y}):null,l?this._onRenderForeground({foreground:l,hideForeground:w}):null,E||T?this._onRenderNameplate({name:E,activity:T,onlyOnHover:!!I}):null),G=O?"a":M?"button":"span",ee=o.createElement(G,{href:O,onClick:M,download:_,hrefLang:D,media:P,target:B,rel:void 0===H?O&&B?"noopener":void 0:H,ref:this.props.linkRef,"data-selection-invoke":!!(J&&r>-1)||void 0,className:Object(h.e)("ms-Tile-link",Y.link)},Q);return o.createElement("div",Object(s.e)({"aria-selected":z},Object(p.u)(q,p.s),{"aria-labelledby":L?this._labelId:this._nameId,"aria-describedby":K?this._descriptionId:this._activityId,className:Object(h.e)("ms-Tile",N,Y.tile,(e={},e["ms-Tile--isSmall "+Y.isSmall]="small"===k,e["ms-Tile--isLarge "+Y.isLarge]="large"===k,e["ms-Tile--hasBackgroundFrame "+Y.hasBackgroundFrame]=d,e["ms-Tile--hasForegroundFrame "+Y.hasForegroundFrame]=m,e["ms-Tile--isSelected "+Y.selected+" "+Z.selected]=z,e["ms-Tile--isSelectable "+Y.selectable]=$,e["ms-Tile--hasBackground "+Y.hasBackground]=!!f,e[Z.dark]=!!f&&!y,e["ms-Tile--showBackground "+Y.showBackground]=!y,e["ms-Tile--invokable "+Y.invokable]=J,e["ms-Tile--uninvokable "+Y.uninvokable]=!J,e["ms-Tile--isDisabled "+Y.disabled]=!$&&!J,e["ms-Tile--showCheck "+Y.showCheck]=X,e["ms-Tile--isFluentStyling "+Y.isFluentStyling]=j,e)),"data-is-focusable":!0,"data-is-sub-focuszone":!0,"data-disable-click-on-enter":!0,"data-selection-index":r>-1?r:void 0,"data-selection-touch-invoke":!!(J&&r>-1)||void 0}),ee,A?o.createElement("span",{key:"description",id:this._descriptionId,className:Object(h.e)("ms-Tile-description",x)},A):null,$?this._onRenderCheck({isSelected:z}):null)};t.prototype._onRenderBackground=function(e){var t,n=e.background,r=e.hideBackground,i="function"==typeof n?n(ue(this.props)):n;return i?o.createElement("span",{key:"background",className:Object(h.e)("ms-Tile-background",Y.background,(t={},t["ms-Tile-background--hide "+Y.backgroundHide]=r,t))},i):null};t.prototype._onRenderForeground=function(e){var t,n=e.foreground,r=e.hideForeground,i="function"==typeof n?n(ue(this.props)):n;return i?o.createElement("span",{key:"foreground",role:"presentation",className:Object(h.e)("ms-Tile-aboveNameplate",Y.aboveNameplate)},o.createElement("span",{role:"presentation",className:Object(h.e)("ms-Tile-content",Y.content)},o.createElement("span",{role:"presentation",className:Object(h.e)("ms-Tile-foreground",Y.foreground,(t={},t["ms-Tile-foreground--hide "+Y.foregroundHide]=r,t))},i))):null};t.prototype._onRenderNameplate=function(e){var t,n,r,i=e.name,s=e.activity,u=e.onlyOnHover;return o.createElement("span",{key:"nameplate",className:Object(h.e)("ms-Tile-nameplate",Y.nameplate,(t={},t[Y.onlyOnHover]=u,t))},i?o.createElement("span",{id:this._nameId,className:Object(h.e)("ms-Tile-name",Y.name,(n={},n[Y.onlyOnHover]=u,n))},i):null,s?o.createElement("span",{id:this._activityId,className:Object(h.e)("ms-Tile-activity",Y.activity,(r={},r[Y.onlyOnHover]=u,r))},s):null)};t.prototype._onRenderCheck=function(e){var t,n=e.isSelected,r=this.props.toggleSelectionAriaLabel;return o.createElement("span",{key:"check",role:"checkbox","aria-label":r,className:Object(h.e)("ms-Tile-check",Y.check,ee.checkHost,(t={},t[ee.hostShowCheck]=this.state.isModal,t)),"data-selection-toggle":!0,"aria-checked":n},o.createElement(u.Check,{checked:n}))};return t})(o.Component);function oe(e){return ue(e.props)}function ue(e){var t=e.contentSize,n=e.tileSize,r=void 0===n?"large":n;if(!t)return{};var i=t.width,s=ie[r],o=s.nameplatePadding,u=s.nameplateMargin,a=s.nameplateActivityHeight,f=s.nameplateNameHeight,l=s.foregroundMargin,c=0;if(e.itemName||e.itemActivity){c+=2*o;e.itemName&&(c+=f);e.itemActivity&&(c+=a+u)}return{foregroundSize:{width:i-2*l,height:t.height-l-c},backgroundSize:t}}function ae(e,t){var n=e.type;return o.createElement(n,Object(s.e)({},e.props,t))}},3399:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n("react-lib"),i=r.createContext(void 0)},3621:function(e,t,n){"use strict";n.d(t,"e",function(){return u});var r=n("react-lib"),i=n(1155),s=n(334),o=n(3399);var u=function(){var e=Object(r.useContext)(o.e),t=Object(i.e)(["theme"]).theme;return e||t||Object(s.e)({})}},4088:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(1896);function i(e,t,n){var i=(2-(t/=r.n))*(n/=r.r),s=t*n;return{h:e,s:100*(s=(s/=i<=1?i:2-i)||0),l:100*(i/=2)}}},4109:function(e,t,n){var r;(function(i,s,o,u){"use strict";var a,f=["","webkit","Moz","MS","ms","o"],l=s.createElement("div"),c=Math.round,h=Math.abs,p=Date.now;function d(e,t,n){return setTimeout(E(e,n),t)}function v(e,t,n){if(Array.isArray(e)){m(e,n[t],n);return!0}return!1}function m(e,t,n){var r;if(e)if(e.forEach)e.forEach(t,n);else if(void 0!==e.length){r=0;for(;r<e.length;){t.call(n,e[r],r,e);r++}}else for(r in e)e.hasOwnProperty(r)&&t.call(n,e[r],r,e)}function g(e,t,n){var r="DEPRECATED METHOD: "+t+"\n"+n+" AT \n";return function(){var t=new Error("get-stack-trace"),n=t&&t.stack?t.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",s=i.console&&(i.console.warn||i.console.log);s&&s.call(i.console,r,n);return e.apply(this,arguments)}}a="function"!=typeof Object.assign?function(e){if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),n=1;n<arguments.length;n++){var r=arguments[n];if(null!=r)for(var i in r)r.hasOwnProperty(i)&&(t[i]=r[i])}return t}:Object.assign;var y=g(function(e,t,n){for(var r=Object.keys(t),i=0;i<r.length;){(!n||n&&void 0===e[r[i]])&&(e[r[i]]=t[r[i]]);i++}return e},"extend","Use `assign`."),b=g(function(e,t){return y(e,t,!0)},"merge","Use `assign`.");function w(e,t,n){var r,i=t.prototype;(r=e.prototype=Object.create(i)).constructor=e;r._super=i;n&&a(r,n)}function E(e,t){return function(){return e.apply(t,arguments)}}function S(e,t){return"function"==typeof e?e.apply(t&&t[0]||void 0,t):e}function x(e,t){return void 0===e?t:e}function T(e,t,n){m(L(t),function(t){e.addEventListener(t,n,!1)})}function N(e,t,n){m(L(t),function(t){e.removeEventListener(t,n,!1)})}function C(e,t){for(;e;){if(e==t)return!0;e=e.parentNode}return!1}function k(e,t){return e.indexOf(t)>-1}function L(e){return e.trim().split(/\s+/g)}function A(e,t,n){if(e.indexOf&&!n)return e.indexOf(t);for(var r=0;r<e.length;){if(n&&e[r][n]==t||!n&&e[r]===t)return r;r++}return-1}function O(e){return Array.prototype.slice.call(e,0)}function M(e,t,n){for(var r=[],i=[],s=0;s<e.length;){var o=t?e[s][t]:e[s];A(i,o)<0&&r.push(e[s]);i[s]=o;s++}n&&(r=t?r.sort(function(e,n){return e[t]>n[t]}):r.sort());return r}function _(e,t){for(var n,r,i=t[0].toUpperCase()+t.slice(1),s=0;s<f.length;){if((r=(n=f[s])?n+i:t)in e)return r;s++}}var D=1;function P(e){var t=e.ownerDocument||e;return t.defaultView||t.parentWindow||i}var H="ontouchstart"in i,B=void 0!==_(i,"PointerEvent"),j=H&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),F=["x","y"],I=["clientX","clientY"];function q(e,t){var n=this;this.manager=e;this.callback=t;this.element=e.element;this.target=e.options.inputTarget;this.domHandler=function(t){S(e.options.enable,[e])&&n.handler(t)};this.init()}q.prototype={handler:function(){},init:function(){this.evEl&&T(this.element,this.evEl,this.domHandler);this.evTarget&&T(this.target,this.evTarget,this.domHandler);this.evWin&&T(P(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&N(this.element,this.evEl,this.domHandler);this.evTarget&&N(this.target,this.evTarget,this.domHandler);this.evWin&&N(P(this.element),this.evWin,this.domHandler)}};function R(e,t,n){var r=n.pointers.length,i=n.changedPointers.length,s=1&t&&r-i==0,o=12&t&&r-i==0;n.isFirst=!!s;n.isFinal=!!o;s&&(e.session={});n.eventType=t;(function(e,t){var n=e.session,r=t.pointers,i=r.length;n.firstInput||(n.firstInput=U(t));i>1&&!n.firstMultiple?n.firstMultiple=U(t):1===i&&(n.firstMultiple=!1);var s=n.firstInput,o=n.firstMultiple,u=o?o.center:s.center,a=t.center=z(r);t.timeStamp=p();t.deltaTime=t.timeStamp-s.timeStamp;t.angle=$(u,a);t.distance=V(u,a);(function(e,t){var n=t.center,r=e.offsetDelta||{},i=e.prevDelta||{},s=e.prevInput||{};if(1===t.eventType||4===s.eventType){i=e.prevDelta={x:s.deltaX||0,y:s.deltaY||0};r=e.offsetDelta={x:n.x,y:n.y}}t.deltaX=i.x+(n.x-r.x);t.deltaY=i.y+(n.y-r.y)})(n,t);t.offsetDirection=X(t.deltaX,t.deltaY);var f=W(t.deltaTime,t.deltaX,t.deltaY);t.overallVelocityX=f.x;t.overallVelocityY=f.y;t.overallVelocity=h(f.x)>h(f.y)?f.x:f.y;t.scale=o?(l=o.pointers,c=r,V(c[0],c[1],I)/V(l[0],l[1],I)):1;var l,c;t.rotation=o?(function(e,t){return $(t[1],t[0],I)+$(e[1],e[0],I)})(o.pointers,r):0;t.maxPointers=n.prevInput?t.pointers.length>n.prevInput.maxPointers?t.pointers.length:n.prevInput.maxPointers:t.pointers.length;(function(e,t){var n,r,i,s,o=e.lastInterval||t,u=t.timeStamp-o.timeStamp;if(8!=t.eventType&&(u>25||void 0===o.velocity)){var a=t.deltaX-o.deltaX,f=t.deltaY-o.deltaY,l=W(u,a,f);r=l.x;i=l.y;n=h(l.x)>h(l.y)?l.x:l.y;s=X(a,f);e.lastInterval=t}else{n=o.velocity;r=o.velocityX;i=o.velocityY;s=o.direction}t.velocity=n;t.velocityX=r;t.velocityY=i;t.direction=s})(n,t);var d=e.element;C(t.srcEvent.target,d)&&(d=t.srcEvent.target);t.target=d})(e,n);e.emit("hammer.input",n);e.recognize(n);e.session.prevInput=n}function U(e){for(var t=[],n=0;n<e.pointers.length;){t[n]={clientX:c(e.pointers[n].clientX),clientY:c(e.pointers[n].clientY)};n++}return{timeStamp:p(),pointers:t,center:z(t),deltaX:e.deltaX,deltaY:e.deltaY}}function z(e){var t=e.length;if(1===t)return{x:c(e[0].clientX),y:c(e[0].clientY)};for(var n=0,r=0,i=0;i<t;){n+=e[i].clientX;r+=e[i].clientY;i++}return{x:c(n/t),y:c(r/t)}}function W(e,t,n){return{x:t/e||0,y:n/e||0}}function X(e,t){return e===t?1:h(e)>=h(t)?e<0?2:4:t<0?8:16}function V(e,t,n){n||(n=F);var r=t[n[0]]-e[n[0]],i=t[n[1]]-e[n[1]];return Math.sqrt(r*r+i*i)}function $(e,t,n){n||(n=F);var r=t[n[0]]-e[n[0]],i=t[n[1]]-e[n[1]];return 180*Math.atan2(i,r)/Math.PI}var J={mousedown:1,mousemove:2,mouseup:4};function K(){this.evEl="mousedown";this.evWin="mousemove mouseup";this.pressed=!1;q.apply(this,arguments)}w(K,q,{handler:function(e){var t=J[e.type];1&t&&0===e.button&&(this.pressed=!0);2&t&&1!==e.which&&(t=4);if(this.pressed){4&t&&(this.pressed=!1);this.callback(this.manager,t,{pointers:[e],changedPointers:[e],pointerType:"mouse",srcEvent:e})}}});var Q={pointerdown:1,pointermove:2,pointerup:4,pointercancel:8,pointerout:8},G={2:"touch",3:"pen",4:"mouse",5:"kinect"},Y="pointerdown",Z="pointermove pointerup pointercancel";if(i.MSPointerEvent&&!i.PointerEvent){Y="MSPointerDown";Z="MSPointerMove MSPointerUp MSPointerCancel"}function ee(){this.evEl=Y;this.evWin=Z;q.apply(this,arguments);this.store=this.manager.session.pointerEvents=[]}w(ee,q,{handler:function(e){var t=this.store,n=!1,r=e.type.toLowerCase().replace("ms",""),i=Q[r],s=G[e.pointerType]||e.pointerType,o="touch"==s,u=A(t,e.pointerId,"pointerId");if(1&i&&(0===e.button||o)){if(u<0){t.push(e);u=t.length-1}}else 12&i&&(n=!0);if(!(u<0)){t[u]=e;this.callback(this.manager,i,{pointers:t,changedPointers:[e],pointerType:s,srcEvent:e});n&&t.splice(u,1)}}});var te={touchstart:1,touchmove:2,touchend:4,touchcancel:8};function ne(){this.evTarget="touchstart";this.evWin="touchstart touchmove touchend touchcancel";this.started=!1;q.apply(this,arguments)}w(ne,q,{handler:function(e){var t=te[e.type];1===t&&(this.started=!0);if(this.started){var n=re.call(this,e,t);12&t&&n[0].length-n[1].length==0&&(this.started=!1);this.callback(this.manager,t,{pointers:n[0],changedPointers:n[1],pointerType:"touch",srcEvent:e})}}});function re(e,t){var n=O(e.touches),r=O(e.changedTouches);12&t&&(n=M(n.concat(r),"identifier",!0));return[n,r]}var ie={touchstart:1,touchmove:2,touchend:4,touchcancel:8};function se(){this.evTarget="touchstart touchmove touchend touchcancel";this.targetIds={};q.apply(this,arguments)}w(se,q,{handler:function(e){var t=ie[e.type],n=oe.call(this,e,t);n&&this.callback(this.manager,t,{pointers:n[0],changedPointers:n[1],pointerType:"touch",srcEvent:e})}});function oe(e,t){var n=O(e.touches),r=this.targetIds;if(3&t&&1===n.length){r[n[0].identifier]=!0;return[n,n]}var i,s,o=O(e.changedTouches),u=[],a=this.target;s=n.filter(function(e){return C(e.target,a)});if(1===t){i=0;for(;i<s.length;){r[s[i].identifier]=!0;i++}}i=0;for(;i<o.length;){r[o[i].identifier]&&u.push(o[i]);12&t&&delete r[o[i].identifier];i++}if(u.length)return[M(s.concat(u),"identifier",!0),u]}function ue(){q.apply(this,arguments);var e=E(this.handler,this);this.touch=new se(this.manager,e);this.mouse=new K(this.manager,e);this.primaryTouch=null;this.lastTouches=[]}w(ue,q,{handler:function(e,t,n){var r="touch"==n.pointerType,i="mouse"==n.pointerType;if(!(i&&n.sourceCapabilities&&n.sourceCapabilities.firesTouchEvents)){if(r)ae.call(this,t,n);else if(i&&le.call(this,n))return;this.callback(e,t,n)}},destroy:function(){this.touch.destroy();this.mouse.destroy()}});function ae(e,t){if(1&e){this.primaryTouch=t.changedPointers[0].identifier;fe.call(this,t)}else 12&e&&fe.call(this,t)}function fe(e){var t=e.changedPointers[0];if(t.identifier===this.primaryTouch){var n={x:t.clientX,y:t.clientY};this.lastTouches.push(n);var r=this.lastTouches;setTimeout(function(){var e=r.indexOf(n);e>-1&&r.splice(e,1)},2500)}}function le(e){for(var t=e.srcEvent.clientX,n=e.srcEvent.clientY,r=0;r<this.lastTouches.length;r++){var i=this.lastTouches[r],s=Math.abs(t-i.x),o=Math.abs(n-i.y);if(s<=25&&o<=25)return!0}return!1}var ce=_(l.style,"touchAction"),he=void 0!==ce,pe=(function(){if(!he)return!1;var e={},t=i.CSS&&i.CSS.supports;["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(n){e[n]=!t||i.CSS.supports("touch-action",n)});return e})();function de(e,t){this.manager=e;this.set(t)}de.prototype={set:function(e){"compute"==e&&(e=this.compute());he&&this.manager.element.style&&pe[e]&&(this.manager.element.style[ce]=e);this.actions=e.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var e=[];m(this.manager.recognizers,function(t){S(t.options.enable,[t])&&(e=e.concat(t.getTouchAction()))});return(function(e){if(k(e,"none"))return"none";var t=k(e,"pan-x"),n=k(e,"pan-y");if(t&&n)return"none";if(t||n)return t?"pan-x":"pan-y";if(k(e,"manipulation"))return"manipulation";return"auto"})(e.join(" "))},preventDefaults:function(e){var t=e.srcEvent,n=e.offsetDirection;if(this.manager.session.prevented)t.preventDefault();else{var r=this.actions,i=k(r,"none")&&!pe.none,s=k(r,"pan-y")&&!pe["pan-y"],o=k(r,"pan-x")&&!pe["pan-x"];if(i){var u=1===e.pointers.length,a=e.distance<2,f=e.deltaTime<250;if(u&&a&&f)return}if(!o||!s)return i||s&&6&n||o&&24&n?this.preventSrc(t):void 0}},preventSrc:function(e){this.manager.session.prevented=!0;e.preventDefault()}};function ve(e){this.options=a({},this.defaults,e||{});this.id=D++;this.manager=null;this.options.enable=x(this.options.enable,!0);this.state=1;this.simultaneous={};this.requireFail=[]}ve.prototype={defaults:{},set:function(e){a(this.options,e);this.manager&&this.manager.touchAction.update();return this},recognizeWith:function(e){if(v(e,"recognizeWith",this))return this;var t=this.simultaneous;if(!t[(e=ye(e,this)).id]){t[e.id]=e;e.recognizeWith(this)}return this},dropRecognizeWith:function(e){if(v(e,"dropRecognizeWith",this))return this;e=ye(e,this);delete this.simultaneous[e.id];return this},requireFailure:function(e){if(v(e,"requireFailure",this))return this;var t=this.requireFail;if(-1===A(t,e=ye(e,this))){t.push(e);e.requireFailure(this)}return this},dropRequireFailure:function(e){if(v(e,"dropRequireFailure",this))return this;e=ye(e,this);var t=A(this.requireFail,e);t>-1&&this.requireFail.splice(t,1);return this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(e){return!!this.simultaneous[e.id]},emit:function(e){var t=this,n=this.state;function r(n){t.manager.emit(n,e)}n<8&&r(t.options.event+me(n));r(t.options.event);e.additionalEvent&&r(e.additionalEvent);n>=8&&r(t.options.event+me(n))},tryEmit:function(e){if(this.canEmit())return this.emit(e);this.state=32},canEmit:function(){for(var e=0;e<this.requireFail.length;){if(!(33&this.requireFail[e].state))return!1;e++}return!0},recognize:function(e){var t=a({},e);if(S(this.options.enable,[this,t])){56&this.state&&(this.state=1);this.state=this.process(t);30&this.state&&this.tryEmit(t)}else{this.reset();this.state=32}},process:function(e){},getTouchAction:function(){},reset:function(){}};function me(e){return 16&e?"cancel":8&e?"end":4&e?"move":2&e?"start":""}function ge(e){return 16==e?"down":8==e?"up":2==e?"left":4==e?"right":""}function ye(e,t){var n=t.manager;return n?n.get(e):e}function be(){ve.apply(this,arguments)}w(be,ve,{defaults:{pointers:1},attrTest:function(e){var t=this.options.pointers;return 0===t||e.pointers.length===t},process:function(e){var t=this.state,n=e.eventType,r=6&t,i=this.attrTest(e);return r&&(8&n||!i)?16|t:r||i?4&n?8|t:2&t?4|t:2:32}});function we(){be.apply(this,arguments);this.pX=null;this.pY=null}w(we,be,{defaults:{event:"pan",threshold:10,pointers:1,direction:30},getTouchAction:function(){var e=this.options.direction,t=[];6&e&&t.push("pan-y");24&e&&t.push("pan-x");return t},directionTest:function(e){var t=this.options,n=!0,r=e.distance,i=e.direction,s=e.deltaX,o=e.deltaY;if(!(i&t.direction))if(6&t.direction){i=0===s?1:s<0?2:4;n=s!=this.pX;r=Math.abs(e.deltaX)}else{i=0===o?1:o<0?8:16;n=o!=this.pY;r=Math.abs(e.deltaY)}e.direction=i;return n&&r>t.threshold&&i&t.direction},attrTest:function(e){return be.prototype.attrTest.call(this,e)&&(2&this.state||!(2&this.state)&&this.directionTest(e))},emit:function(e){this.pX=e.deltaX;this.pY=e.deltaY;var t=ge(e.direction);t&&(e.additionalEvent=this.options.event+t);this._super.emit.call(this,e)}});function Ee(){be.apply(this,arguments)}w(Ee,be,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return["none"]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.scale-1)>this.options.threshold||2&this.state)},emit:function(e){if(1!==e.scale){var t=e.scale<1?"in":"out";e.additionalEvent=this.options.event+t}this._super.emit.call(this,e)}});function Se(){ve.apply(this,arguments);this._timer=null;this._input=null}w(Se,ve,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return["auto"]},process:function(e){var t=this.options,n=e.pointers.length===t.pointers,r=e.distance<t.threshold,i=e.deltaTime>t.time;this._input=e;if(!r||!n||12&e.eventType&&!i)this.reset();else if(1&e.eventType){this.reset();this._timer=d(function(){this.state=8;this.tryEmit()},t.time,this)}else if(4&e.eventType)return 8;return 32},reset:function(){clearTimeout(this._timer)},emit:function(e){if(8===this.state)if(e&&4&e.eventType)this.manager.emit(this.options.event+"up",e);else{this._input.timeStamp=p();this.manager.emit(this.options.event,this._input)}}});function xe(){be.apply(this,arguments)}w(xe,be,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return["none"]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.rotation)>this.options.threshold||2&this.state)}});function Te(){be.apply(this,arguments)}w(Te,be,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:30,pointers:1},getTouchAction:function(){return we.prototype.getTouchAction.call(this)},attrTest:function(e){var t,n=this.options.direction;30&n?t=e.overallVelocity:6&n?t=e.overallVelocityX:24&n&&(t=e.overallVelocityY);return this._super.attrTest.call(this,e)&&n&e.offsetDirection&&e.distance>this.options.threshold&&e.maxPointers==this.options.pointers&&h(t)>this.options.velocity&&4&e.eventType},emit:function(e){var t=ge(e.offsetDirection);t&&this.manager.emit(this.options.event+t,e);this.manager.emit(this.options.event,e)}});function Ne(){ve.apply(this,arguments);this.pTime=!1;this.pCenter=!1;this._timer=null;this._input=null;this.count=0}w(Ne,ve,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return["manipulation"]},process:function(e){var t=this.options,n=e.pointers.length===t.pointers,r=e.distance<t.threshold,i=e.deltaTime<t.time;this.reset();if(1&e.eventType&&0===this.count)return this.failTimeout();if(r&&i&&n){if(4!=e.eventType)return this.failTimeout();var s=!this.pTime||e.timeStamp-this.pTime<t.interval,o=!this.pCenter||V(this.pCenter,e.center)<t.posThreshold;this.pTime=e.timeStamp;this.pCenter=e.center;o&&s?this.count+=1:this.count=1;this._input=e;if(0===this.count%t.taps){if(this.hasRequireFailures()){this._timer=d(function(){this.state=8;this.tryEmit()},t.interval,this);return 2}return 8}}return 32},failTimeout:function(){this._timer=d(function(){this.state=32},this.options.interval,this);return 32},reset:function(){clearTimeout(this._timer)},emit:function(){if(8==this.state){this._input.tapCount=this.count;this.manager.emit(this.options.event,this._input)}}});function Ce(e,t){(t=t||{}).recognizers=x(t.recognizers,Ce.defaults.preset);return new ke(e,t)}Ce.VERSION="2.0.7";Ce.defaults={domEvents:!1,touchAction:"compute",enable:!0,inputTarget:null,inputClass:null,preset:[[xe,{enable:!1}],[Ee,{enable:!1},["rotate"]],[Te,{direction:6}],[we,{direction:6},["swipe"]],[Ne],[Ne,{event:"doubletap",taps:2},["tap"]],[Se]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};function ke(e,t){this.options=a({},Ce.defaults,t||{});this.options.inputTarget=this.options.inputTarget||e;this.handlers={};this.session={};this.recognizers=[];this.oldCssProps={};this.element=e;this.input=new((n=this).options.inputClass||(B?ee:j?se:H?ue:K))(n,R);var n;this.touchAction=new de(this,this.options.touchAction);Le(this,!0);m(this.options.recognizers,function(e){var t=this.add(new e[0](e[1]));e[2]&&t.recognizeWith(e[2]);e[3]&&t.requireFailure(e[3])},this)}ke.prototype={set:function(e){a(this.options,e);e.touchAction&&this.touchAction.update();if(e.inputTarget){this.input.destroy();this.input.target=e.inputTarget;this.input.init()}return this},stop:function(e){this.session.stopped=e?2:1},recognize:function(e){var t=this.session;if(!t.stopped){this.touchAction.preventDefaults(e);var n,r=this.recognizers,i=t.curRecognizer;(!i||i&&8&i.state)&&(i=t.curRecognizer=null);for(var s=0;s<r.length;){n=r[s];2===t.stopped||i&&n!=i&&!n.canRecognizeWith(i)?n.reset():n.recognize(e);!i&&14&n.state&&(i=t.curRecognizer=n);s++}}},get:function(e){if(e instanceof ve)return e;for(var t=this.recognizers,n=0;n<t.length;n++)if(t[n].options.event==e)return t[n];return null},add:function(e){if(v(e,"add",this))return this;var t=this.get(e.options.event);t&&this.remove(t);this.recognizers.push(e);e.manager=this;this.touchAction.update();return e},remove:function(e){if(v(e,"remove",this))return this;if(e=this.get(e)){var t=this.recognizers,n=A(t,e);if(-1!==n){t.splice(n,1);this.touchAction.update()}}return this},on:function(e,t){if(void 0!==e&&void 0!==t){var n=this.handlers;m(L(e),function(e){n[e]=n[e]||[];n[e].push(t)});return this}},off:function(e,t){if(void 0!==e){var n=this.handlers;m(L(e),function(e){t?n[e]&&n[e].splice(A(n[e],t),1):delete n[e]});return this}},emit:function(e,t){this.options.domEvents&&(function(e,t){var n=s.createEvent("Event");n.initEvent(e,!0,!0);n.gesture=t;t.target.dispatchEvent(n)})(e,t);var n=this.handlers[e]&&this.handlers[e].slice();if(n&&n.length){t.type=e;t.preventDefault=function(){t.srcEvent.preventDefault()};for(var r=0;r<n.length;){n[r](t);r++}}},destroy:function(){this.element&&Le(this,!1);this.handlers={};this.session={};this.input.destroy();this.element=null}};function Le(e,t){var n=e.element;if(n.style){var r;m(e.options.cssProps,function(i,s){r=_(n.style,s);if(t){e.oldCssProps[r]=n.style[r];n.style[r]=i}else n.style[r]=e.oldCssProps[r]||""});t||(e.oldCssProps={})}}a(Ce,{INPUT_START:1,INPUT_MOVE:2,INPUT_END:4,INPUT_CANCEL:8,STATE_POSSIBLE:1,STATE_BEGAN:2,STATE_CHANGED:4,STATE_ENDED:8,STATE_RECOGNIZED:8,STATE_CANCELLED:16,STATE_FAILED:32,DIRECTION_NONE:1,DIRECTION_LEFT:2,DIRECTION_RIGHT:4,DIRECTION_UP:8,DIRECTION_DOWN:16,DIRECTION_HORIZONTAL:6,DIRECTION_VERTICAL:24,DIRECTION_ALL:30,Manager:ke,Input:q,TouchAction:de,TouchInput:se,MouseInput:K,PointerEventInput:ee,TouchMouseInput:ue,SingleTouchInput:ne,Recognizer:ve,AttrRecognizer:be,Tap:Ne,Pan:we,Swipe:Te,Pinch:Ee,Rotate:xe,Press:Se,on:T,off:N,each:m,merge:b,extend:y,assign:a,inherit:w,bindFn:E,prefixed:_});(void 0!==i?i:"undefined"!=typeof self?self:{}).Hammer=Ce;void 0!==(r=function(){return Ce}.call(t,n,t,e))&&(e.exports=r)})(window,document)},4421:function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r=n("react-lib"),i=n(1662);function s(e){var t=r.useState(e),n=t[0],s=t[1],o=r.useRef(n),u=Object(i.e)(function(){return function(){s(!0);o.current=!0}}),a=Object(i.e)(function(){return function(){s(!1);o.current=!1}}),f=Object(i.e)(function(){return function(){return o.current?a():u()}});return[n,{setTrue:u,setFalse:a,toggle:f}]}},4422:function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r=n("react-lib"),i=n(481);function s(e,t){var n=r.useRef(t);n.current||(n.current=Object(i.e)(e));return n.current}},4834:function(e,t,n){"use strict";n.r(t);var r=n(0),i=n("react-lib"),s=n.n(i),o=n(40),u=n(1589),a=n(3621),f=n(278),l=n(1586),c=n(1515),h=n(1765),p=0,d={reset:function(){f.e.getInstance().onReset(function(){return p++})},getId:function(){return p},renderStyles:function(e,t){return Object(l.e)(Array.isArray(e)?e:[e],t)},renderFontFace:function(e,t){return Object(c.e)(e)},renderKeyframes:function(e){return Object(h.e)(e)}},v=i.createContext(d);var m,g,y=function(e,t,n){void 0===n&&(n={});var r=!1;if(e)for(var i=0,s=Object.keys(e);i<s.length;i++){var o=s[i];if(!r){if(0===o.indexOf("--"))return e;r=!0}var u=t?t+("default"===o?"":"-"+o):"--"+o,a=e[o];a&&"object"==typeof a?y(a,u,n):n[u]=a}return n},b=(m=function(e){var t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g=e.tokens;return{root:y(g),body:[{color:null===(r=null===(n=null===(t=g)||void 0===t?void 0:t.color)||void 0===n?void 0:n.body)||void 0===r?void 0:r.contentColor,background:null===(o=null===(s=null===(i=g)||void 0===i?void 0:i.color)||void 0===s?void 0:s.body)||void 0===o?void 0:o.background,fontFamily:null===(a=null===(u=g)||void 0===u?void 0:u.body)||void 0===a?void 0:a.fontFamily,fontWeight:null===(l=null===(f=g)||void 0===f?void 0:f.body)||void 0===l?void 0:l.fontWeight,fontSize:null===(h=null===(c=g)||void 0===c?void 0:c.body)||void 0===h?void 0:h.fontSize,MozOsxFontSmoothing:null===(d=null===(p=g)||void 0===p?void 0:p.body)||void 0===d?void 0:d.mozOsxFontSmoothing,WebkitFontSmoothing:null===(m=null===(v=g)||void 0===v?void 0:v.body)||void 0===m?void 0:m.webkitFontSmoothing}]}},g=new Map,function(e){void 0===e&&(e={});var t=e.theme,n=e.renderer,r=Object(u.n)(),s=Object(a.e)(),o=i.useContext(v);t=t||s||{};var f=(n=n||o).getId(),l="function"==typeof m,c=l?[f,r,t]:[f,r],h=(function(e,t){for(var n=0,r=t;n<r.length;n++){var i=r[n];if(!(e=e.get(i)))return}return e})(g,c);if(!h){var p=l?m(t):m;h=n.renderStyles(p,{targetWindow:r,rtl:!!t.rtl});(function(e,t,n){for(var r=0;r<t.length-1;r++){var i=t[r],s=e.get(i);if(!s){s=new Map;e.set(i,s)}e=s}e.set(t[t.length-1],n)})(g,c,h)}return h});function w(e){var t=b(e),n=e.className,r=e.applyTo;(function(e,t){var n,r="body"===e.applyTo,s=null===(n=Object(u.t)())||void 0===n?void 0:n.body;i.useEffect(function(){if(r&&s){for(var e=0,n=t;e<n.length;e++){var i=n[e];i&&s.classList.add(i)}return function(){if(r&&s)for(var e=0,n=t;e<n.length;e++){var i=n[e];i&&s.classList.remove(i)}}}},[r,s,t])})(e,[t.root,t.body]);e.className=Object(o.e)(n,t.root,"element"===r&&t.body)}var E=n(4),S=n(1539),x=n(478),T=function(){return null},N=n(542),C=n(3399),k=function(e){var t=(function(e,t){var n={root:e.as||"div"},r={root:"string"==typeof e.as?Object(S.e)(e.as,e):Object(x.t)(e,["as"])};if(t)for(var s=0,o=t;s<o.length;s++){var u=o[s],a=e[u]||{},f=a.as,l=void 0===f?"span":f,c=a.children,h="string"==typeof l,p=h&&void 0===a.children;n[u]=p?T:l;if("function"==typeof c){r[u]={children:c(n[u],Object(x.t)(a,["as","children"]))};n[u]=i.Fragment}else n[u]!==T&&(r[u]=h?Object(S.e)(l,a):Object(x.t)(a,["as"]))}return{slots:n,slotProps:r}})(e),n=t.slots,r=t.slotProps,s=e.theme,o=e.customizerContext;return i.createElement(C.e.Provider,{value:s},i.createElement(v.Provider,{value:e.renderer},i.createElement(N.e.Provider,{value:o},i.createElement(n.root,Object(E.e)({},r.root)))))},L=n(1445),A=n(481),O=n(1174);var M=new Map,_=function(e){var t=e.theme,n=Object(a.e)(),r=e.theme=i.useMemo(function(){var e,r=Object(L.e)(n,t);r.tokens=(function(e,t){var n=e.fonts,r=e.palette,i=e.semanticColors;return Object(O.e)({color:{body:{background:i.bodyBackground,contentColor:i.bodyText},brand:{background:i.primaryButtonBackground,borderColor:i.primaryButtonBorder,contentColor:i.primaryButtonText,iconColor:r.white,dividerColor:r.white,secondaryContentColor:r.white,hovered:{background:i.primaryButtonBackgroundHovered,contentColor:i.primaryButtonTextHovered,secondaryContentColor:r.white,borderColor:"var(--color-brand-borderColor)"},pressed:{background:i.primaryButtonBackgroundPressed,contentColor:i.primaryButtonTextPressed,secondaryContentColor:i.primaryButtonTextPressed,borderColor:"var(--color-brand-borderColor)",iconColor:"var(--color-brand-iconColor)"},focused:{background:"var(--color-brand-background)",borderColor:"var(--color-brand-borderColor)",contentColor:"var(--color-brand-contentColor)",iconColor:"var(--color-brand-iconColor)",secondaryContentColor:"var(--color-brand-focused-contentColor)"},disabled:{background:i.primaryButtonBackgroundDisabled,contentColor:i.buttonTextDisabled,dividerColor:r.neutralTertiaryAlt,secondaryContentColor:"var(--color-brand-disabled-contentColor)",borderColor:"var(--color-brand-disabled-background)",iconColor:"var(--color-brand-disabled-contentColor)"},checked:{background:i.primaryButtonBackgroundPressed,contentColor:i.primaryButtonTextPressed,iconColor:i.primaryButtonTextPressed},checkedHovered:{background:i.primaryButtonBackgroundPressed,contentColor:i.primaryButtonTextPressed,iconColor:i.primaryButtonTextPressed}}},body:{fontFamily:n.medium.fontFamily,fontWeight:n.medium.fontWeight,fontSize:n.medium.fontSize,mozOsxFontSmoothing:n.medium.MozOsxFontSmoothing,webkitFontSmoothing:n.medium.WebkitFontSmoothing},text:{variant:{caption:{fontSize:"12px",fontWeight:"400",lineHeight:"14px"},body:{fontSize:"14px",fontWeight:"400",lineHeight:"20px"},subHeadline:{fontSize:"16px",fontWeight:"600",lineHeight:"22px"},headline:{fontSize:"20px",fontWeight:"600",lineHeight:"28px"},title3:{fontSize:"24px",fontWeight:"600",lineHeight:"32px"},title2:{fontSize:"28px",fontWeight:"600",lineHeight:"36px"},title1:{fontSize:"32px",fontWeight:"600",lineHeight:"40px"},largeTitle:{fontSize:"40px",fontWeight:"600",lineHeight:"52px"},display:{fontSize:"68px",fontWeight:"600",lineHeight:"92px"}}}},t)})(r,null===(e=t)||void 0===e?void 0:e.tokens);r.id=(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=[],r=0,i=e;r<i.length;r++){var s=i[r];if(s){var o=s.id||M.get(s);if(!o){o=Object(A.e)("");M.set(s,o)}n.push(o)}}return n.join("-")})(n,t);return r},[n,t]);e.customizerContext=i.useMemo(function(){return{customizations:{inCustomizerContext:!0,settings:{theme:r},scopedSettings:r.components||{}}}},[r]);e.theme.rtl!==n.rtl&&(e.dir=e.theme.rtl?"rtl":"ltr")};var D=(function(e){void 0===e&&(e={});var t=Object(E.o)(e.deepMerge||[],["style"]),n=function(e){for(var r=[],s=1;s<arguments.length;s++)r[s-1]=arguments[s];for(var u=0,a=r;u<a.length;u++){var f=a[u];if(f)for(var l=0,c=Object.keys(f);l<c.length;l++){var h=c[l],p=f[h],d=typeof p;if(void 0!==p)if(p&&"object"===d)if(Array.isArray(p))e[h]=p;else{e[h]=e[h]||{};"object"!=typeof e[h]||i.isValidElement(p)||p&&"object"==typeof p&&p.hasOwnProperty("current")||-1===t.indexOf(h)?e[h]=p:n(e[h],p)}else"className"===h?p&&(e[h]=Object(o.e)(e[h],p)):e[h]=p}}return e};return n})(),P=function(e,t,n){var r=(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=i.useCallback(function(t){n.current=t;for(var r=0,i=e;r<i.length;r++){var s=i[r];"function"==typeof s?s(t):s&&(s.current=t)}},Object(E.o)(e));return n})(t,i.useRef(null)),s=D({ref:r,as:"div"},n,e);_(s);return{state:s,render:k}},H={document:"document"},B=i.createContext({registerStyles:function(e,t){var n=t.styleCache,r=t.target;if(e&&!(e.length<1)){Array.isArray(e)||(e=[e]);var i=[],s=r||H,o=n.get(s);if(!o){o=new Map;n.set(s,o)}for(var u=0,a=e;u<a.length;u++){var f=a[u];if(!o.has(f)){i.push(f);o.set(f,!0)}}i.length&&t.renderStyles(i,t)}},renderStyles:function(e,t){var n=t.target;if(e.length&&n){var r=n.createElement("style");r.textContent=e.join("");n.head.appendChild(r)}},target:"object"==typeof window?window.document:void 0,styleCache:new WeakMap}),j=n(1177),F=i.forwardRef(function(e,t){var n,r,s=P(e,t,{renderer:d,applyTo:"element"}),o=s.render,u=s.state;n=u.theme.stylesheets,(r=i.useContext(B)).registerStyles(n,r);w(u);Object(j.t)(u.ref);return o(u)});F.displayName="ThemeProvider";var I,q=n(1865),R=(function(){function e(){this._count=0;this._min=Number.MAX_VALUE;this._totalTime=0}Object.defineProperty(e.prototype,"frameCount",{get:function(){return this._count},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"minimumFps",{get:function(){return this._min},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"averageFps",{get:function(){return 1e3*this._count/this._totalTime},enumerable:!1,configurable:!0});e.prototype.reset=function(){this._count=0;this._min=Number.MAX_VALUE;this._totalTime=0};e.prototype.reportFrame=function(e){this._count++;var t=1e3/e;this._min=Math.min(this.minimumFps,t);this._totalTime+=e};return e})();(function(e){e.Editor="Editor";e.MainImage="MainImage";e.RotationBarImage="RotationBarImage";e.RotationBarCenterAnchorImage="RotationBarCenterAnchorImage"})(I||(I={}));function U(){return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,function(e){return(+e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>+e/4).toString(16)})}var z=function(e,t){var n;return function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];return new Promise(function(i){n&&window.clearTimeout(n);n=window.setTimeout(function(){return i(e.apply(void 0,r))},t)})}};function W(e,t){return Math.round(e*Math.pow(10,t))/Math.pow(10,t)+0}function X(e){return-Math.round(-e)}var V=function(){return(V=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)},$=function(e){var t=U();return{updateSessionId:function(){t=U()},logEditorActivityEvent:function(n){return e(J(t,n))},logCropEvent:function(){return e(K(t))},logRotateEvent:function(n){return e(Q(t,V(V({},n),{angle:W(n.angle,8)})))},logEditResetEvent:function(){return e(G(t))},logZoomEvent:z(function(n){return e(Y(t,n))},1e3),logAspectRatioEvent:function(n){return e(Z(t,n))},logFlipEvent:function(n){return e(ee(t,n))},logAdjustmentEvent:z(function(n){return e(te(t,n))},1e3),logCancelEvent:function(n){return e(ne(t,n))},logPageLoadTimeEvent:function(n){return e(re(t,n))},logSessionStatistics:function(n){return e(ie(t,n))},logErrorEvent:function(n){return e(se(t,n))},logWarningEvent:function(n){return e(oe(t,n))},logSaveEvent:function(n){return e(ue(t,n))},logFailedToGetEditedImageEvent:function(){return e(ae(t))},logRecenterEvent:function(){return e(fe(t))},logMarkupSummaryEvent:function(n){return e(le(t,n))},logMaxTextureSizeEvent:function(n){return e(ce(t,n))},logMarkupToolSelectEvent:z(function(n){return e(he(t,n))},500),logInkBrushUpdateEvent:z(function(n){return e(pe(t,n))},1e3),logEditorActivityChangePrepareTimeEvent:function(n){return e(de(t,n))},logClearAllInkStrokesEvent:function(n){return e(ve(t,n))}}},J=function(e,t){return V({name:"EditorActivityChange",isIntentional:!0,sessionId:e},t)},K=function(e){return{name:"Crop",isIntentional:!0,sessionId:e}},Q=function(e,t){return V({name:"Rotate",isIntentional:!0,sessionId:e},t)},G=function(e){return{name:"EditReset",isIntentional:!0,sessionId:e}},Y=function(e,t){return V({name:"Zoom",isIntentional:!0,sessionId:e},t)},Z=function(e,t){return V({name:"AspectRatio",isIntentional:!0,sessionId:e},t)},ee=function(e,t){return V({name:"Flip",isIntentional:!0,sessionId:e},t)},te=function(e,t){return V({name:"Adjustment",isIntentional:!0,sessionId:e},t)},ne=function(e,t){return V({name:"Cancel",isIntentional:!0,sessionId:e},t)},re=function(e,t){return V({name:"PageLoadTime",isIntentional:!1,sessionId:e},t)},ie=function(e,t){return V({name:"SessionStatistics",isIntentional:!1,sessionId:e},t)},se=function(e,t){return V({name:"Error",isIntentional:!1,sessionId:e},t)},oe=function(e,t){return V({name:"Warning",isIntentional:!1,sessionId:e},t)},ue=function(e,t){return V({name:"Save",isIntentional:!0,sessionId:e},t)},ae=function(e){return{name:"GetEditedImageFailure",isIntentional:!1,sessionId:e}},fe=function(e){return{sessionId:e,name:"Recenter",isIntentional:!0}},le=function(e,t){return V({name:"MarkupSummary",isIntentional:!0,sessionId:e},t)},ce=function(e,t){return V({name:"MaxTextureSize",isIntentional:!1,sessionId:e},t)},he=function(e,t){return V({name:"MarkupToolSelect",isIntentional:!0,sessionId:e},t)},pe=function(e,t){return V({name:"InkBrushUpdate",isIntentional:!0,sessionId:e},t)},de=function(e,t){return V({name:"EditorActivityChangePrepareTime",isIntentional:!0,sessionId:e},t)},ve=function(e,t){return V({name:"ClearAllInkStrokes",isIntentional:!0,sessionId:e},t)},me=Object(i.createContext)($(function(e){}));function ge(e){var t=performance.getEntriesByName(e);return t.length>0&&e?performance.now()-t[t.length-1].startTime:-1}var ye=s.a.memo(function(e){var t=e.imageSize,n=e.children,r=Object(i.useContext)(me),o=r.logPageLoadTimeEvent,u=r.logSessionStatistics,a=r.updateSessionId,f=Object(i.useRef)(t),l=Object(i.useMemo)(function(){return new R},[]);Object(i.useEffect)(function(){var e=window.performance.now(),t=0,n=function(){var r=window.performance.now();l.reportFrame(r-e);e=r;t=window.requestAnimationFrame(n)};t=window.requestAnimationFrame(n);return function(){window.cancelAnimationFrame(t)}},[l]);Object(i.useEffect)(function(){return function(){if(f.current!==t){u({minFrameRate:l.minimumFps,avgFrameRate:l.averageFps,imageSize:{width:t.x,height:t.y}});l.reset();a();f.current=t}}},[u,a,l,t]);Object(i.useLayoutEffect)(function(){var e=window.requestAnimationFrame(function(){setTimeout(function(){o({pageLoadTimeMs:ge(I.Editor),component:I.Editor})})});return function(){window.cancelAnimationFrame(e)}},[o]);return s.a.createElement(s.a.Fragment,null,n)}),be=Object(q.connect)(function(e){return{imageSize:e.transformTools.image.originalPixelSize}},{})(ye),we=Object(i.createContext)(function(e){}),Ee=s.a.memo(function(e){var t=e.onError,n=e.children;return s.a.createElement(we.Provider,{value:t},n)});function Se(){return Object(i.useContext)(we)}var xe={adjustment_light:"Light",adjustment_color:"Color",adjustment_lightAriaLandmark:"Light Adjustments",adjustment_colorAriaLandmark:"Color Adjustments",adjustment_brightness:"Brightness",adjustment_exposure:"Exposure",adjustment_contrast:"Contrast",adjustment_highlights:"Highlights",adjustment_shadows:"Shadows",adjustment_saturation:"Saturation",adjustment_temperature:"Warmth",adjustment_tint:"Tint",adjustment_vignette:"Vignette",aspectRatio_freeform:"Free",aspectRatio_freeformAriaLabel:"Free aspect ratio",aspectRatio_original:"Original",aspectRatio_originalAriaLabel:"Original aspect ratio",aspectRatio_square:"Square",aspectRatio_squareAriaLabel:"Square aspect ratio",aspectRatio_ratioLabelFormatString:"{0} : {1}",aspectRatio_ratioAriaLabelFormatString:"{0} by {1} aspect ratio",aspectRatio_tooltip:"Aspect ratio options to crop the image",aspectRatio_changedAriaLive:"Changed to {0}",flip_portrait:"Flip to portrait",flip_portraitAriaLabel:"Flip to portrait",flip_landscape:"Flip to landscape",flip_landscapeAriaLabel:"Flip to landscape",autoEnhance_name:"Auto Enhance",autoEnhance_generatingAriaLive:"Generating auto enhance",autoEnhance_appliedAriaLive:"Applied auto enhance with {0} intensity",autoEnhance_removedAriaLive:"Removed auto enhance",autoEnhance_intensitySliderHeader:"Intensity",autoEnhance_intensitySliderAriaLabel:"Auto enhance intensity",crop_topLeftCornerAriaLabel:"Top left crop handle. Corner pixel position is {0} from the left {1} from the top.",crop_topRightCornerAriaLabel:"Top right crop handle. Corner pixel position is {0} from the left {1} from the top.",crop_bottomLeftCornerAriaLabel:"Bottom left crop handle. Corner pixel position is {0} from the left {1} from the top.",crop_bottomRightCornerAriaLabel:"Bottom right crop handle. Corner pixel position is {0} from the left {1} from the top.",crop_cornerTooltip:"Drag handle or use arrow keys to crop the image",crop_rectangleAriaLabel:"Drag the image or use the arrow keys to move image in crop region",crop_rectangleTooltip:"Drag the image or use the arrow keys to move image in crop region",crop_rectanglePositionAriaLive:"Left {0} Top {1} pixels",crop_rectangleCannotMoveInCurrentDirectionAriaLive:"Left {0} Top {1} pixels. Cannot move any further in current direction.",editor_viewingOriginal:"Viewing Original",editor_viewingOriginalAriaLive:"Viewing original image",editor_zoomPercentAriaLive:"{0} percent zoom",editor_imageDimensionLabelFormatString:"{0} x {1}",editor_imageDimensionAriaLabelFormatString:"{0} by {1} pixels",editor_imageDimensionAriaLive:"Dimension is {0} by {1} pixels",filter_intensitySliderHeader:"Intensity",filter_intensitySliderAriaLabelFormatString:"{0} intensity",filter_nameOriginal:"Original",filter_nameBurn:"Burn",filter_nameBw:"B&W",filter_nameBwCool:"B&W Cool",filter_nameBwHighContrast:"B&W High Contrast",filter_nameBwWarm:"B&W Warm",filter_nameCoolLight:"Cool Light",filter_nameCalm:"Calm",filter_nameDramaticCool:"Dramatic Cool",filter_nameFilm:"Film",filter_nameGolden:"Golden",filter_namePunch:"Punch",filter_nameRadiate:"Radiate",filter_nameVintage:"Vintage",filter_nameVividCool:"Vivid Cool",filter_nameWarmContrast:"Warm Contrast",filter_changedAriaLive:"{0} filter has been applied",filter_filtersAriaLandmark:"Filters",footer_done:"Done",nonCrop_imageTooltip:"Click and hold to view the original image",nonCrop_imageAriaLabelWithEdits:"Click and hold or press and hold the space key to view the original image",nonCrop_imageAriaLabelWithoutEdits:"No adjustments have been made or filter applied to the image",nonCrop_panViewPositionAriaLive:"Left {0} Top {1} pixels",pivot_crop:"Crop",pivot_adjustment:"Adjustment",pivot_filter:"Filter",pivot_markup:"Markup",rotate_left90:"Rotate image 90 degrees counter-clockwise",rotate_left90AriaLabel:"Rotate counter-clockwise",rotate_left90FinishedAriaLive:"Rotated 90 degrees counter-clockwise",rotate_right90:"Rotate image 90 degrees clockwise",rotate_right90AriaLabel:"Rotate clockwise",rotate_right90FinishedAriaLive:"Rotated 90 degrees clockwise",rotate_sliderAriaLabel:"Manual rotate",rotate_degree:"°",rotate_sliderTooltip:"Drag or use arrow keys to rotate the image",flip_horizontal:"Flip image horizontally",flip_horizontalAriaLabel:"Flip image horizontally",flip_horizontalFinishedAriaLive:"Flipped image horizontally",flip_vertical:"Flip image vertically",flip_verticalAriaLabel:"Flip image vertically",flip_verticalFinishedAriaLive:"Flipped image vertically",toolbar_imageSave:"Save",toolbar_imageSaveTooltip:"Save options for your image",toolbar_imageSaveAsOriginal:"Save",toolbar_imageSaveAsOriginalAriaLabel:"Save",toolbar_saveMenuSplitButtonAriaLabel:"More save options",toolbar_imageSaveAsOriginalTooltip:"Image will be overwritten with the latest edits",toolbar_imageSaveAsCopy:"Save as copy",toolbar_imageSaveAsCopyAriaLabel:"Save as copy",toolbar_imageSaveAsCopyTooltip:"Create a new image with the applied edits",toolbar_imageReset:"Reset",toolbar_imageResetTooltip:"Reset all edits performed on the image",toolbar_imageResetAriaLabel:"Reset",toolbar_imageResetFinishedAriaLive:"Image edits were reset",toolbar_zoomLevelAriaLabel:"Zoom level",toolbar_zoomInTooltip:"Zoom into the image",toolbar_zoomInAriaLabel:"Zoom in",toolbar_zoomOutTooltip:"Zoom out of the image",toolbar_zoomOutAriaLabel:"Zoom out",toolbar_cancelAriaLabel:"Cancel",toolbar_cancelTooltip:"Cancel all edits and return to previous screen",toolbar_fitToViewTooltip:"Fit to window",toolbar_viewActualSizeTooltip:"Actual size"},Te=function(){return(Te=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)};function Ne(e,t,n){return(function(e,t){var n=Te(Te({},t),{numberingSystem:"latn"});return new Intl.NumberFormat(e,n)})(t,n).format(e+0)}function Ce(e){return Ne(1.1,e).substring(1,2)}function ke(e){return"."===e}function Le(e,t,n){return Ne(e,t,(function(e){return{style:"percent",minimumFractionDigits:e,maximumFractionDigits:e}})(n))}var Ae,Oe,Me=function(e){var t=e.strings,n=e.locales;return{strings:t,localizeNumber:function(e){return Ne(e,n)},localizeNumberDecimalSeparatorOnly:function(e,t){return(function(e,t,n){var r=Ce(t),i=void 0===n?e.toString():W(e,n).toString();return ke(r)?i:i.replace(".",r)})(e,n,t)},delocalizeNumberDecimalSeparatorOnly:function(e){return(function(e,t){var n=Ce(t);return ke(n)?+e:+e.replace(n,".")})(e,n)},getDecimalSeparator:function(){return Ce(n)},isPercentSignLeading:function(){return(function(e){return null!==Le(.1,e,0).match(/\d$/)})(n)},localizePercentage:function(e,t){return Le(e,n,t)}}},_e=Object(i.createContext)(Me({strings:xe,locales:void 0})),De=function(e){var t=e.localization,n=e.children,r=Object(i.useMemo)(function(){return Me(null!=t?t:{strings:xe,locales:void 0})},[t]);return s.a.createElement(_e.Provider,{value:r},n)},Pe=function(e){var t=e.telemetryCallback,n=e.children,r=Object(i.useMemo)(function(){return t?$(t):null},[t]);return s.a.createElement(s.a.Fragment,null,t&&r?s.a.createElement(me.Provider,{value:r},n):n)},He=s.a.memo(function(){var e=Object(i.useContext)(me).logErrorEvent;Object(i.useEffect)(function(){var t=function(t){var n=t.message,r=t.filename,i=t.lineno,s=t.colno,o=t.error;e({message:n,source:r,lineNumber:i,columnNumber:s,error:{message:o.message,stack:o.stack}})};window.addEventListener("error",t);return function(){return window.removeEventListener("error",t)}},[e]);return null});(function(e){e.None="None";e.Original="Original";e.Square="Square";e.NineBySixteen="9:16";e.SixteenByNine="16:9";e.FourByFive="4:5";e.FiveByFour="5:4";e.ThreeByFour="3:4";e.FourByThree="4:3";e.TwoByThree="2:3";e.ThreeByTwo="3:2";e.OneByTwo="1:2";e.TwoByOne="2:1"})(Ae||(Ae={}));(function(e){e.Version1="Version 1";e.Test="Test";e.Latest="Version 1"})(Oe||(Oe={}));var Be=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n},je={imageTransform:{x:0,y:0,width:1,height:1,rotation:0},cropRectangle:{top:0,left:0,width:1,height:1},originalImageSize:{x:1,y:1},aspectRatioConstraint:Ae.None},Fe={brightness:0,exposure:0,saturation:0,highlights:0,shadows:0,vibrance:0,contrast:0,tint:0,temperature:0,vignette:0,version:Oe.Version1},Ie=function(e,t){if(typeof e!=typeof t)return!1;if("object"==typeof e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&!Ie(e[n],t[n]))return!1;return!0},qe=function(e){return e>=0&&e<=1},Re=function(e){var t={isValid:!0};try{var n=e.colorAdjustments,r=Be(e,["colorAdjustments"]);if(void 0!==r.version&&"number"!=typeof r.version)throw new Error("IEditOperations contains invalid data");(function(e){if(!(Ie(je,e)&&Object.values(Ae).includes(e.aspectRatioConstraint)&&e.originalImageSize.x>=1&&e.originalImageSize.y>=1&&e.imageTransform.height>=1&&e.imageTransform.width>=1&&e.cropRectangle.height>=1&&e.cropRectangle.width>=1))throw new Error("IEditTransformOperations contains invalid data")})(r);n&&(function(e){if(!(Ie(Fe,e)&&Object.values(Oe).includes(e.version)&&qe(e.brightness)&&qe(e.exposure)&&qe(e.saturation)&&qe(e.highlights)&&qe(e.shadows)&&qe(e.vibrance)&&qe(e.contrast)&&qe(e.tint)&&qe(e.vignette)&&qe(e.temperature)))throw new Error("IColorAdjustmentWithoutLutState contains invalid data")})(n)}catch(e){t.isValid=!1;t.message=e.message}return t};var Ue=function(){return(Ue=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)};function ze(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];throw Error("[Immer] minified error nr: "+e+(n.length?" "+n.map(function(e){return"'"+e+"'"}).join(","):"")+". Find the full error at: https://bit.ly/3cXEKWf")}function We(e){return!!e&&!!e[Dt]}function Xe(e){return!!e&&((function(e){if(!e||"object"!=typeof e)return!1;var t=Object.getPrototypeOf(e);return!t||t===Object.prototype})(e)||Array.isArray(e)||!!e[_t]||!!e.constructor[_t]||Ye(e)||Ze(e))}function Ve(e,t,n){void 0===n&&(n=!1),0===$e(e)?(n?Object.keys:Pt)(e).forEach(function(r){n&&"symbol"==typeof r||t(r,e[r],e)}):e.forEach(function(n,r){return t(r,n,e)})}function $e(e){var t=e[Dt];return t?t.i>3?t.i-4:t.i:Array.isArray(e)?1:Ye(e)?2:Ze(e)?3:0}function Je(e,t){return 2===$e(e)?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function Ke(e,t){return 2===$e(e)?e.get(t):e[t]}function Qe(e,t,n){var r=$e(e);2===r?e.set(t,n):3===r?(e.delete(t),e.add(n)):e[t]=n}function Ge(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}function Ye(e){return Lt&&e instanceof Map}function Ze(e){return At&&e instanceof Set}function et(e){return e.o||e.t}function tt(e){if(Array.isArray(e))return Array.prototype.slice.call(e);var t=Ht(e);delete t[Dt];for(var n=Pt(t),r=0;r<n.length;r++){var i=n[r],s=t[i];!1===s.writable&&(s.writable=!0,s.configurable=!0),(s.get||s.set)&&(t[i]={configurable:!0,writable:!0,enumerable:s.enumerable,value:e[i]})}return Object.create(Object.getPrototypeOf(e),t)}function nt(e,t){return void 0===t&&(t=!1),it(e)||We(e)||!Xe(e)||($e(e)>1&&(e.set=e.add=e.clear=e.delete=rt),Object.freeze(e),t&&Ve(e,function(e,t){return nt(t,!0)},!0)),e}function rt(){ze(2)}function it(e){return null==e||"object"!=typeof e||Object.isFrozen(e)}function st(e){var t=Bt[e];return t||ze(18,e),t}function ot(e,t){Bt[e]||(Bt[e]=t)}function ut(){return Ct}function at(e,t){t&&(st("Patches"),e.u=[],e.s=[],e.v=t)}function ft(e){lt(e),e.p.forEach(ht),e.p=null}function lt(e){e===Ct&&(Ct=e.l)}function ct(e){return Ct={p:[],l:Ct,h:e,m:!0,_:0}}function ht(e){var t=e[Dt];0===t.i||1===t.i?t.j():t.g=!0}function pt(e,t){t._=t.p.length;var n=t.p[0],r=void 0!==e&&e!==n;return t.h.O||st("ES5").S(t,e,r),r?(n[Dt].P&&(ft(t),ze(4)),Xe(e)&&(e=dt(t,e),t.l||mt(t,e)),t.u&&st("Patches").M(n[Dt],e,t.u,t.s)):e=dt(t,n,[]),ft(t),t.u&&t.v(t.u,t.s),e!==Mt?e:void 0}function dt(e,t,n){if(it(t))return t;var r=t[Dt];if(!r)return Ve(t,function(i,s){return vt(e,r,t,i,s,n)},!0),t;if(r.A!==e)return t;if(!r.P)return mt(e,r.t,!0),r.t;if(!r.I){r.I=!0,r.A._--;var i=4===r.i||5===r.i?r.o=tt(r.k):r.o;Ve(3===r.i?new Set(i):i,function(t,s){return vt(e,r,i,t,s,n)}),mt(e,i,!1),n&&e.u&&st("Patches").R(r,n,e.u,e.s)}return r.o}function vt(e,t,n,r,i,s){if(We(i)){var o=dt(e,i,s&&t&&3!==t.i&&!Je(t.D,r)?s.concat(r):void 0);if(Qe(n,r,o),!We(o))return;e.m=!1}if(Xe(i)&&!it(i)){if(!e.h.N&&e._<1)return;dt(e,i),t&&t.A.l||mt(e,i)}}function mt(e,t,n){void 0===n&&(n=!1),e.h.N&&e.m&&nt(t,n)}function gt(e,t){var n=e[Dt];return(n?et(n):e)[t]}function yt(e,t){if(t in e)for(var n=Object.getPrototypeOf(e);n;){var r=Object.getOwnPropertyDescriptor(n,t);if(r)return r;n=Object.getPrototypeOf(n)}}function bt(e){e.P||(e.P=!0,e.l&&bt(e.l))}function wt(e){e.o||(e.o=tt(e.t))}function Et(e,t,n){var r=Ye(t)?st("MapSet").T(t,n):Ze(t)?st("MapSet").F(t,n):e.O?(function(e,t){var n=Array.isArray(e),r={i:n?1:0,A:t?t.A:ut(),P:!1,I:!1,D:{},l:t,t:e,k:null,o:null,j:null,C:!1},i=r,s=jt;n&&(i=[r],s=Ft);var o=Proxy.revocable(i,s),u=o.revoke,a=o.proxy;return r.k=a,r.j=u,a})(t,n):st("ES5").J(t,n);return(n?n.A:ut()).p.push(r),r}function St(e){return We(e)||ze(22,e),(function e(t){if(!Xe(t))return t;var n,r=t[Dt],i=$e(t);if(r){if(!r.P&&(r.i<4||!st("ES5").K(r)))return r.t;r.I=!0,n=xt(t,i),r.I=!1}else n=xt(t,i);return Ve(n,function(t,i){r&&Ke(r.t,t)===i||Qe(n,t,e(i))}),3===i?new Set(n):n})(e)}function xt(e,t){switch(t){case 2:return new Map(e);case 3:return Array.from(e)}return tt(e)}function Tt(){function e(e,t){var n=i[e];return n?n.enumerable=t:i[e]=n={configurable:!0,enumerable:t,get:function(){var t=this[Dt];return jt.get(t,e)},set:function(t){var n=this[Dt];jt.set(n,e,t)}},n}function t(e){for(var t=e.length-1;t>=0;t--){var i=e[t][Dt];if(!i.P)switch(i.i){case 5:r(i)&&bt(i);break;case 4:n(i)&&bt(i)}}}function n(e){for(var t=e.t,n=e.k,r=Pt(n),i=r.length-1;i>=0;i--){var s=r[i];if(s!==Dt){var o=t[s];if(void 0===o&&!Je(t,s))return!0;var u=n[s],a=u&&u[Dt];if(a?a.t!==o:!Ge(u,o))return!0}}var f=!!t[Dt];return r.length!==Pt(t).length+(f?0:1)}function r(e){var t=e.k;if(t.length!==e.t.length)return!0;var n=Object.getOwnPropertyDescriptor(t,t.length-1);return!(!n||n.get)}var i={};ot("ES5",{J:function(t,n){var r=Array.isArray(t),i=(function(t,n){if(t){for(var r=Array(n.length),i=0;i<n.length;i++)Object.defineProperty(r,""+i,e(i,!0));return r}var s=Ht(n);delete s[Dt];for(var o=Pt(s),u=0;u<o.length;u++){var a=o[u];s[a]=e(a,t||!!s[a].enumerable)}return Object.create(Object.getPrototypeOf(n),s)})(r,t),s={i:r?5:4,A:n?n.A:ut(),P:!1,I:!1,D:{},l:n,t:t,k:i,o:null,g:!1,C:!1};return Object.defineProperty(i,Dt,{value:s,writable:!0}),i},S:function(e,n,i){i?We(n)&&n[Dt].A===e&&t(e.p):(e.u&&(function e(t){if(t&&"object"==typeof t){var n=t[Dt];if(n){var i=n.t,s=n.k,o=n.D,u=n.i;if(4===u)Ve(s,function(t){t!==Dt&&(void 0!==i[t]||Je(i,t)?o[t]||e(s[t]):(o[t]=!0,bt(n)))}),Ve(i,function(e){void 0!==s[e]||Je(s,e)||(o[e]=!1,bt(n))});else if(5===u){if(r(n)&&(bt(n),o.length=!0),s.length<i.length)for(var a=s.length;a<i.length;a++)o[a]=!1;else for(var f=i.length;f<s.length;f++)o[f]=!0;for(var l=Math.min(s.length,i.length),c=0;c<l;c++)void 0===o[c]&&e(s[c])}}}})(e.p[0]),t(e.p))},K:function(e){return 4===e.i?n(e):r(e)}})}var Nt,Ct,kt="undefined"!=typeof Symbol&&"symbol"==typeof Symbol("x"),Lt="undefined"!=typeof Map,At="undefined"!=typeof Set,Ot="undefined"!=typeof Proxy&&void 0!==Proxy.revocable&&"undefined"!=typeof Reflect,Mt=kt?Symbol.for("immer-nothing"):((Nt={})["immer-nothing"]=!0,Nt),_t=kt?Symbol.for("immer-draftable"):"__$immer_draftable",Dt=kt?Symbol.for("immer-state"):"__$immer_state",Pt=("undefined"!=typeof Symbol&&Symbol.iterator,"undefined"!=typeof Reflect&&Reflect.ownKeys?Reflect.ownKeys:void 0!==Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Object.getOwnPropertyNames),Ht=Object.getOwnPropertyDescriptors||function(e){var t={};return Pt(e).forEach(function(n){t[n]=Object.getOwnPropertyDescriptor(e,n)}),t},Bt={},jt={get:function(e,t){if(t===Dt)return e;var n=et(e);if(!Je(n,t))return(function(e,t,n){var r,i=yt(t,n);return i?"value"in i?i.value:null===(r=i.get)||void 0===r?void 0:r.call(e.k):void 0})(e,n,t);var r=n[t];return e.I||!Xe(r)?r:r===gt(e.t,t)?(wt(e),e.o[t]=Et(e.A.h,r,e)):r},has:function(e,t){return t in et(e)},ownKeys:function(e){return Reflect.ownKeys(et(e))},set:function(e,t,n){var r=yt(et(e),t);if(null==r?void 0:r.set)return r.set.call(e.k,n),!0;if(!e.P){var i=gt(et(e),t),s=null==i?void 0:i[Dt];if(s&&s.t===n)return e.o[t]=n,e.D[t]=!1,!0;if(Ge(n,i)&&(void 0!==n||Je(e.t,t)))return!0;wt(e),bt(e)}return e.o[t]=n,e.D[t]=!0,!0},deleteProperty:function(e,t){return void 0!==gt(e.t,t)||t in e.t?(e.D[t]=!1,wt(e),bt(e)):delete e.D[t],e.o&&delete e.o[t],!0},getOwnPropertyDescriptor:function(e,t){var n=et(e),r=Reflect.getOwnPropertyDescriptor(n,t);return r?{writable:!0,configurable:1!==e.i||"length"!==t,enumerable:r.enumerable,value:n[t]}:r},defineProperty:function(){ze(11)},getPrototypeOf:function(e){return Object.getPrototypeOf(e.t)},setPrototypeOf:function(){ze(12)}},Ft={};Ve(jt,function(e,t){Ft[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}}),Ft.deleteProperty=function(e,t){return jt.deleteProperty.call(this,e[0],t)},Ft.set=function(e,t,n){return jt.set.call(this,e[0],t,n,e[0])};var It=new((function(){function e(e){this.O=Ot,this.N=!0,"boolean"==typeof(null==e?void 0:e.useProxies)&&this.setUseProxies(e.useProxies),"boolean"==typeof(null==e?void 0:e.autoFreeze)&&this.setAutoFreeze(e.autoFreeze),this.produce=this.produce.bind(this),this.produceWithPatches=this.produceWithPatches.bind(this)}var t=e.prototype;return t.produce=function(e,t,n){if("function"==typeof e&&"function"!=typeof t){var r=t;t=e;var i=this;return function(e){var n=this;void 0===e&&(e=r);for(var s=arguments.length,o=Array(s>1?s-1:0),u=1;u<s;u++)o[u-1]=arguments[u];return i.produce(e,function(e){var r;return(r=t).call.apply(r,[n,e].concat(o))})}}var s;if("function"!=typeof t&&ze(6),void 0!==n&&"function"!=typeof n&&ze(7),Xe(e)){var o=ct(this),u=Et(this,e,void 0),a=!0;try{s=t(u),a=!1}finally{a?ft(o):lt(o)}return"undefined"!=typeof Promise&&s instanceof Promise?s.then(function(e){return at(o,n),pt(e,o)},function(e){throw ft(o),e}):(at(o,n),pt(s,o))}if(!e||"object"!=typeof e){if((s=t(e))===Mt)return;return void 0===s&&(s=e),this.N&&nt(s,!0),s}ze(21,e)},t.produceWithPatches=function(e,t){var n,r,i=this;return"function"==typeof e?function(t){for(var n=arguments.length,r=Array(n>1?n-1:0),s=1;s<n;s++)r[s-1]=arguments[s];return i.produceWithPatches(t,function(t){return e.apply(void 0,[t].concat(r))})}:[this.produce(e,t,function(e,t){n=e,r=t}),n,r]},t.createDraft=function(e){Xe(e)||ze(8),We(e)&&(e=St(e));var t=ct(this),n=Et(this,e,void 0);return n[Dt].C=!0,lt(t),n},t.finishDraft=function(e,t){var n=(e&&e[Dt]).A;return at(n,t),pt(void 0,n)},t.setAutoFreeze=function(e){this.N=e},t.setUseProxies=function(e){e&&!Ot&&ze(20),this.O=e},t.applyPatches=function(e,t){var n;for(n=t.length-1;n>=0;n--){var r=t[n];if(0===r.path.length&&"replace"===r.op){e=r.value;break}}var i=st("Patches").$;return We(e)?i(e,t):this.produce(e,function(e){return i(e,t.slice(n+1))})},e})()),qt=It.produce,Rt=(It.produceWithPatches.bind(It),It.setAutoFreeze.bind(It),It.setUseProxies.bind(It),It.applyPatches.bind(It),It.createDraft.bind(It),It.finishDraft.bind(It),qt),Ut=n(1228);function zt(e,t){return e===t}function Wt(e,t,n){if(null===t||null===n||t.length!==n.length)return!1;for(var r=t.length,i=0;i<r;i++)if(!e(t[i],n[i]))return!1;return!0}function Xt(e){var t=Array.isArray(e[0])?e[0]:e;if(!t.every(function(e){return"function"==typeof e})){var n=t.map(function(e){return typeof e}).join(", ");throw new Error("Selector creators expect all input-selectors to be functions, instead received the following types: ["+n+"]")}return t}var Vt=(function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return function(){for(var t=arguments.length,r=Array(t),i=0;i<t;i++)r[i]=arguments[i];var s=0,o=r.pop(),u=Xt(r),a=e.apply(void 0,[function(){s++;return o.apply(null,arguments)}].concat(n)),f=e(function(){for(var e=[],t=u.length,n=0;n<t;n++)e.push(u[n].apply(null,arguments));return a.apply(null,e)});f.resultFunc=o;f.dependencies=u;f.recomputations=function(){return s};f.resetRecomputations=function(){return s=0};return f}})(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:zt,n=null,r=null;return function(){Wt(t,n,arguments)||(r=e.apply(null,arguments));n=arguments;return r}});function $t(e){return function(t){var n=t.dispatch,r=t.getState;return function(t){return function(i){return"function"==typeof i?i(n,r,e):t(i)}}}}var Jt=$t();Jt.withExtraArgument=$t;var Kt=Jt;function Qt(){return(Qt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function Gt(e){return(Gt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Yt(e,t){return(Yt=Object.setPrototypeOf||function(e,t){e.__proto__=t;return e})(e,t)}function Zt(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return!0}catch(e){return!1}}function en(e,t,n){return(en=Zt()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var i=new(Function.bind.apply(e,r));n&&Yt(i,n.prototype);return i}).apply(null,arguments)}function tn(e){var t="function"==typeof Map?new Map:void 0;return(tn=function(e){if(null===e||!(n=e,-1!==Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return en(e,arguments,Gt(this).constructor)}r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}});return Yt(r,e)})(e)}var nn="undefined"!=typeof window&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(0!==arguments.length)return"object"==typeof arguments[0]?Ut.r:Ut.r.apply(null,arguments)};function rn(e){if("object"!=typeof e||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}var sn=(function(e){(function(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;e.__proto__=t})(t,e);function t(){return e.apply(this,arguments)||this}var n=t.prototype;n.concat=function(){for(var n,r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return en(t,(n=e.prototype.concat).call.apply(n,[this].concat(i)))};n.prepend=function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return 1===n.length&&Array.isArray(n[0])?en(t,n[0].concat(this)):en(t,n.concat(this))};return t})(tn(Array));function on(e){void 0===e&&(e={});var t=e,n=t.thunk,r=void 0===n||n,i=(t.immutableCheck,t.serializableCheck,new sn);r&&("boolean"==typeof r?i.push(Kt):i.push(Kt.withExtraArgument(r.extraArgument)));return i}function un(e){var t,n=function(e){return on(e)},r=e||{},i=r.reducer,s=void 0===i?void 0:i,o=r.middleware,u=void 0===o?n():o,a=r.devTools,f=void 0===a||a,l=r.preloadedState,c=void 0===l?void 0:l,h=r.enhancers,p=void 0===h?void 0:h;if("function"==typeof s)t=s;else{if(!rn(s))throw new Error('"reducer" is a required argument, and must be a function or an object of functions that can be passed to combineReducers');t=Object(Ut.n)(s)}var d=Ut.e.apply(void 0,"function"==typeof u?u(n):u),v=Ut.r;f&&(v=nn(Qt({trace:!1},"object"==typeof f&&f)));var m=[d];Array.isArray(p)?m=[d].concat(p):"function"==typeof p&&(m=p(m));var g=v.apply(void 0,m);return Object(Ut.i)(t,c,g)}function an(e,t){function n(){if(t){var n=t.apply(void 0,arguments);if(!n)throw new Error("prepareAction did not return an object");return Qt({type:e,payload:n.payload},"meta"in n&&{meta:n.meta},{},"error"in n&&{error:n.error})}return{type:e,payload:arguments.length<=0?void 0:arguments[0]}}n.toString=function(){return""+e};n.type=e;n.match=function(t){return t.type===e};return n}function fn(e){var t,n={},r=[],i={addCase:function(e,t){0;var r="string"==typeof e?e:e.type;if(r in n)throw new Error("addCase cannot be called with two reducers for the same action type");n[r]=t;return i},addMatcher:function(e,t){0;r.push({matcher:e,reducer:t});return i},addDefaultCase:function(e){0;t=e;return i}};e(i);return[n,r,t]}function ln(e){var t=e.name,n=e.initialState;if(!t)throw new Error("`name` is a required option for createSlice");var r=e.reducers||{},i=void 0===e.extraReducers?[]:"function"==typeof e.extraReducers?fn(e.extraReducers):[e.extraReducers],s=i[0],o=void 0===s?{}:s,u=i[1],a=void 0===u?[]:u,f=i[2],l=void 0===f?void 0:f,c=Object.keys(r),h={},p={},d={};c.forEach(function(e){var n,i,s=r[e],o=t+"/"+e;if("reducer"in s){n=s.reducer;i=s.prepare}else n=s;h[e]=n;p[o]=n;d[e]=i?an(o,i):an(o)});var v=(function(e,t,n,r){void 0===n&&(n=[]);var i="function"==typeof t?fn(t):[t,n,r],s=i[0],o=i[1],u=i[2];return function(t,n){void 0===t&&(t=e);var r=[s[n.type]].concat(o.filter(function(e){return(0,e.matcher)(n)}).map(function(e){return e.reducer}));0===r.filter(function(e){return!!e}).length&&(r=[u]);return r.reduce(function(e,t){if(t){if(We(e)){var r=t(e,n);return void 0===r?e:r}if(Xe(e))return Rt(e,function(e){return t(e,n)});var i=t(e,n);if(void 0===i){if(null===e)return e;throw Error("A case reducer on a non-draftable value must not return undefined")}return i}return e},t)}})(n,Qt({},o,{},p),a,l);return{name:t,reducer:v,actions:d,caseReducers:h}}"undefined"!=typeof Symbol&&(Symbol.iterator||(Symbol.iterator=Symbol("Symbol.iterator"))),"undefined"!=typeof Symbol&&(Symbol.asyncIterator||(Symbol.asyncIterator=Symbol("Symbol.asyncIterator")));Tt();function cn(e,t){return e.x*t.x+e.y*t.y}function hn(e){return Math.hypot(e.x,e.y)}function pn(e,t){return{x:e.x+t.x,y:e.y+t.y}}function dn(e,t){return{x:e.x-t.x,y:e.y-t.y}}function vn(e){var t=hn(e);if(0===t)throw new RangeError("Invalid Vector: Vector length is 0");return{x:e.x/t,y:e.y/t}}function mn(e,t){return{x:e.x*t,y:e.y*t}}function gn(e){return{x:Math.round(e.x),y:Math.round(e.y)}}function yn(e){return{x:W(e.x,0),y:W(e.y,0)}}function bn(e,t){return{x:(e.x+t.x)/2,y:(e.y+t.y)/2}}function wn(e,t){if(0===t.x||0===t.y)throw new RangeError("Invalid divisor vector.  Elements must be non-zero.");return{x:e.x/t.x,y:e.y/t.y}}function En(e,t){return e.x===t.x&&e.y===t.y}function Sn(e){return e.x>=0&&e.x<=1&&e.y>=0&&e.y<=1}function xn(e,t,n){return e*(1-n)+t*n}function Tn(e,t,n){var r=(n-e)/(t-e);return Math.min(Math.max(r,0),1)}function Nn(e,t){return function(n){return xn(e,t,n)}}var Cn=180/Math.PI;function kn(e){e>180?e-=360:e<=-180&&(e+=360);return e}function Ln(e){return[e[0],e[1],e[2],e[3],e[4],e[5]]}function An(e){void 0===e&&(e=0);return[-1,0,2*e,0,1,0]}function On(e){void 0===e&&(e=0);return[1,0,0,0,-1,2*e]}function Mn(e,t){void 0===t&&(t=e);return[e,0,0,0,t,0]}function _n(e,t,n,r){void 0===n&&(n=0);void 0===r&&(r=0);return[e,0,(e-1)*-n,0,t,(t-1)*-r]}function Dn(e,t){return[1,0,e,0,1,t]}function Pn(e){return[e[0],e[1],Math.round(e[2]),e[3],e[4],Math.round(e[5])]}function Hn(e){var t=e*Math.PI/180,n=Math.cos(t),r=Math.sin(t);return[n,-r,0,r,n,0]}function Bn(e,t,n){void 0===t&&(t=0);void 0===n&&(n=0);return Jn(Dn(t,n),Hn(e),Dn(-t,-n))}function jn(e){return kn(Math.atan2(e[4],e[1])*Cn-90)}function Fn(e){return e[0]*e[4]-e[1]*e[3]}function In(e){return 0!==Fn(e)}function qn(e){var t=Fn(e);if(0===t)throw new RangeError("Invalid Matrix: determinant is zero");var n=1/t,r=e[0],i=e[1],s=e[2],o=e[3],u=e[4],a=e[5];return[u*n,-i*n,(i*a-s*u)*n,-o*n,r*n,(s*o-r*a)*n]}function Rn(e,t){return{x:t.x*e[0]+t.y*e[1]+e[2],y:t.x*e[3]+t.y*e[4]+e[5]}}function Un(e){return{x:e[0],y:e[3]}}function zn(e){return{x:e[1],y:e[4]}}function Wn(e){return vn(Un(e))}function Xn(e){return vn(zn(e))}function Vn(e){return[{x:e[2],y:e[5]},{x:e[0]+e[2],y:e[3]+e[5]},{x:e[0]+e[1]+e[2],y:e[3]+e[4]+e[5]},{x:e[1]+e[2],y:e[4]+e[5]}]}function $n(e,t){return Rn(qn(e),t)}function Jn(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.reduceRight(function(e,t){return[t[0]*e[0]+t[1]*e[3],t[0]*e[1]+t[1]*e[4],t[0]*e[2]+t[1]*e[5]+t[2],t[3]*e[0]+t[4]*e[3],t[3]*e[1]+t[4]*e[4],t[3]*e[2]+t[4]*e[5]+t[5]]},[1,0,0,0,1,0])}function Kn(e){return Qn(e,1,1)}function Qn(e,t,n){if(0===t)throw new RangeError("Width cannot be 0");if(0===n)throw new RangeError("Height cannot be 0");var r=Fn(e=Jn(Mn(1/t,1/n),e));return Math.sqrt(Math.abs(r))}function Gn(e,t,n){return e.every(function(e,r){return W(e,n)===W(t[r],n)})}function Yn(e){return{x:e[2],y:e[5]}}function Zn(e,t){var n=Un(e),r=zn(e),i=Yn(e),s=Wn(e),o=Xn(e),u=hn(n),a=mn(n,(u+2*t)/u),f=hn(r),l=mn(r,(f+2*t)/f),c=dn(i,pn(mn(s,t),mn(o,t)));return[a.x,l.x,c.x,a.y,l.y,c.y]}function er(e){return[e[0],e[3],e[1],e[4],e[2],e[5]]}function tr(e,t,n){if(e.isActive){if(void 0===e.startTime)return{startTime:t,isActive:!0};if(nr(e,t,n)>=1)return{startTime:void 0,isActive:!1}}return e}function nr(e,t,n){return e.isActive?void 0!==e.startTime?Tn(e.startTime,e.startTime+n,t):0:1}var rr=function(e){return e},ir=function(e){return.5+.5*Math.sin(-Math.PI/2+e*Math.PI)},sr=function(){return(sr=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)};function or(e,t,n,r){void 0===e&&(e=void 0);void 0===t&&(t=void 0);void 0===n&&(n=void 0);void 0===r&&(r={startTime:void 0,isActive:!1});return sr(sr({},r),{startMatrix:e?Ln(e):[1,0,0,0,1,0],endMatrix:t?Ln(t):[1,0,0,0,1,0],animatedMatrix:n?Ln(n):void 0})}function ur(){return or()}function ar(e,t,n){e.isActive&&e.animatedMatrix&&(t=e.animatedMatrix);return or(t=Pn(t),n=Pn(n),t,{startTime:void 0,isActive:!0})}function fr(e,t,n,r){void 0===r&&(r=rr);var i,s,o,u=tr(e,t,n);if(u.isActive){var a=nr(e,t,n),f=(i=e.startMatrix,s=e.endMatrix,o=r(a),[xn(i[0],s[0],o),xn(i[1],s[1],o),xn(i[2],s[2],o),xn(i[3],s[3],o),xn(i[4],s[4],o),xn(i[5],s[5],o)]);return or(e.startMatrix,e.endMatrix,f,u)}return ur()}var lr=function(){return(lr=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)};function cr(e,t){void 0===e&&(e=void 0);void 0===t&&(t={startTime:void 0,isActive:!1});return lr(lr({},t),{numGridLines:e})}function hr(e){return cr(e,{startTime:void 0,isActive:!0})}function pr(e,t,n){var r=tr(e,t,n);return r.isActive?cr(e.numGridLines,r):cr()}var dr=function(e){return{left:e,right:e,top:e,bottom:e}};function vr(e,t,n){var r=(function(e,t,n){var r={left:Math.round(n.left*t),right:Math.round(n.right*t),top:Math.round(n.top*t),bottom:Math.round(n.bottom*t)};r.left/e.x>.25&&(r=dr(Math.round(.25*e.x)));r.top/e.y>.25&&(r=dr(Math.round(.25*e.y)));return r})(e,t,n);return{top:r.top,left:r.left,width:e.x-r.left-r.right,height:e.y-r.top-r.bottom}}var mr,gr,yr;(function(e){e[e.None=-1]="None";e[e.TopLeft=0]="TopLeft";e[e.TopCenter=1]="TopCenter";e[e.TopRight=2]="TopRight";e[e.SideLeft=3]="SideLeft";e[e.Center=4]="Center";e[e.SideRight=5]="SideRight";e[e.BottomLeft=6]="BottomLeft";e[e.BottomCenter=7]="BottomCenter";e[e.BottomRight=8]="BottomRight"})(mr||(mr={}));(function(e){e[e.usingNineSliceCropHandles=0]="usingNineSliceCropHandles";e[e.selectingFirstCorner=1]="selectingFirstCorner";e[e.selectingSecondCorner=2]="selectingSecondCorner";e[e.draggingView=3]="draggingView";e[e.draggingImage=4]="draggingImage";e[e.rotating=5]="rotating";e[e.zoomToCrop=6]="zoomToCrop";e[e.keyboardCropping=7]="keyboardCropping";e[e.keyboardRotating=8]="keyboardRotating";e[e.none=9]="none";e[e.disabled=10]="disabled"})(gr||(gr={}));(function(e){e[e.none=0]="none";e[e.fitCropRectInView=1]="fitCropRectInView";e[e.fitImageInView=2]="fitImageInView";e[e.actualSize=3]="actualSize"})(yr||(yr={}));var br=window.devicePixelRatio||1,wr=gr.none,Er=yr.fitCropRectInView,Sr=Ae.None,xr={mode:Er,marginCssPixels:dr(0)};function Tr(){return{cropInteraction:{aspectRatioConstraint:Sr},image:{}}}var Nr={defaults:Tr(),image:{originalPixelSize:{x:1,y:1},_preciseUvToWorld:[1,0,0,0,1,0],loadedPixelSize:void 0},view:{worldToView:[1,0,0,0,1,0],viewFitting:xr,viewportPixelSize:{x:1,y:1},allowDraggingView:!1,viewportCssSize:{width:"100%",height:"100%"},enableZoomToView:!1,animateViewWhenViewportIsResized:!1},cropUiDisplay:{handleSizeCss:28,handleHitAreaSizeCss:50},cropInteraction:{mode:wr,activeHandleIndex:mr.None,focusedHandleIndex:mr.None,isKeyboardFocused:!1,rectAtStartOfResize:{top:0,left:0,width:0,height:0},uvToWorld:[1,0,0,0,1,0],_uvToWorldBeforeRotate:[1,0,0,0,1,0],_uvToWorldBeforeZoomToCrop:[1,0,0,0,1,0],aspectRatioConstraint:Sr,rectTopLeftInImageUv:{x:0,y:0},rectBottomRightInImageUv:{x:1,y:1},shouldConstrainInImage:!0,allowDraggingImageOutsideRect:!0,enableZoomToCrop:!0},rotationUi:{deadZoneCenterPos:0,rotationBarPointer:{movePos:{x:0,y:0},isDown:!1}},device:{pixelRatio:br},pointer:{movePos:{x:0,y:0},pointerDowns:[],preventShift:!1,offset:{x:0,y:0},imageUvGrabPosition:{x:0,y:0},downOffsetFromCropHandleCenter:{x:0,y:0}},animations:{needsFrameTick:!1,currentTime:0,outsideCropVisibility:{startTime:void 0,isActive:!1},gridLineVisibility:cr(),dismissGridLineVisibility:{startTime:void 0,isActive:!1},dismissOutsideCropVisibility:{startTime:void 0,isActive:!1},worldToView:or(),image:or(),crop:or(),transitionToViewingOriginal:{startTime:void 0,isActive:!1}},touch:{scale:1,isDown:!1,downCenterPos:{x:0,y:0}}},Cr=function(){return(Cr=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)};function kr(e){return{top:Math.round(e.top),left:Math.round(e.left),width:Math.round(Math.max(1,e.width)),height:Math.round(Math.max(1,e.height))}}var Lr,Ar={top:0,left:0,width:1,height:1};function Or(e,t){return e.x>=t.left&&e.x<=t.left+t.width&&e.y>=t.top&&e.y<=t.top+t.height}function Mr(e,t){return Or({x:e.left,y:e.top},t)&&Or({x:e.left+e.width,y:e.top+e.height},t)}function _r(e){return{x:e.left+e.width/2,y:e.top+e.height/2}}function Dr(e,t){return e.width<t.width||e.height<t.height}function Pr(e){var t=Mn(e.width,e.height);return Jn(Dn(e.left,e.top),t)}function Hr(e){var t=Vn(e),n=Math.min.apply(Math,t.map(function(e){return e.x})),r=Math.min.apply(Math,t.map(function(e){return e.y}));return{left:n,top:r,width:Math.max.apply(Math,t.map(function(e){return e.x}))-n,height:Math.max.apply(Math,t.map(function(e){return e.y}))-r}}function Br(e){var t=Hr(e);return{x:t.width,y:t.height}}function jr(e){return Br(Jn(Hn(-jn(e)),e))}function Fr(e){return Rn(e,{x:.5,y:.5})}function Ir(e,t,n){var r=Fr(t);return Jn(Bn(e,r.x,r.y),n)}(function(e){e.Right="Right";e.Left="Left";e.Up="Up";e.Down="Down";e.None="None"})(Lr||(Lr={}));function qr(e,t,n,r){var i=e,s=n,o=r,u=dn(t,i),a=dn(s,o),f=dn(s,i),l=[u.x,a.x,0,u.y,a.y,0];if(In(l)){var c=$n(l,f),h=c.x,p=c.y;if(p>=0&&p<=1&&h>0)return h}}function Rr(e,t,n,r){for(var i=r/2,s=[t-i,t+i,t+n-i,t+n+i],o=0;o<3;o++)if(e>=s[o]&&e<=s[o+1])return o;return-1}function Ur(e){return e%3-1}function zr(e){return Math.floor(e/3)-1}function Wr(e,t,n){var r=t.left,i=t.width,s=t.top,o=t.height,u=Rr(e.x,r,i,n);if(-1===u)return-1;var a=Rr(e.y,s,o,n);return-1===a?-1:3*a+u}function Xr(e){return{x:(Ur(e)+1)/2,y:(zr(e)+1)/2}}function Vr(e,t,n){return dn(n,(function(e,t){var n=t.left,r=t.width,i=t.top,s=t.height,o=zr(e);return{x:n+(Ur(e)+1)*(r/2),y:i+(o+1)*(s/2)}})(e,t))}function $r(e,t){return Math.floor(e*t)}function Jr(e,t){return e*t}function Kr(e,t){var n=Vn(e),r=n[0],i=n[1],s=n[2],o=n[3],u=Vn(t),a=u[0],f=u[1],l=u[2],c=u[3],h=hn(dn(f,a)),p=hn(dn(c,a));if(0===h||0===p){var d=mn(dn(l,a),.5),v=mn(dn(s,r),.5),m=dn(d,v);return{tx:m.x,ty:m.y,scale:0}}var g=vn(dn(f,a)),y={x:-g.y,y:g.x},b={x:cn(r,g),y:cn(r,y)},w={x:cn(i,g),y:cn(i,y)},E={x:cn(s,g),y:cn(s,y)},S={x:cn(o,g),y:cn(o,y)},x=Math.min(b.x,w.x,E.x,S.x),T=Math.min(b.y,w.y,E.y,S.y),N=Math.max(b.x,w.x,E.x,S.x),C=Math.max(b.y,w.y,E.y,S.y)-T,k=N-x,L=hn(dn(f,a)),A=hn(dn(c,a)),O=Math.min(L/k,A/C),M=Jn(Mn(O,O),e),_=Rn(M,{x:0,y:0}),D=bn(Rn(M,{x:1,y:1}),_),P=dn(bn(l,a),D);return{tx:P.x,ty:P.y,scale:O}}function Qr(e,t,n,r,i,s){var o,u,a=(u=n,[Math.round(u[0]),Math.round(u[1]),Math.round(u[2]),Math.round(u[3]),Math.round(u[4]),Math.round(u[5])]),f=Vn(a);e.forEach(function(e){for(var n=null!=o?o:t,u=Rn(n,Xr(e.fixedEnd)),l=Rn(n,Xr(e.freeEnd)),c=Number.MAX_VALUE,h=0;h<f.length;h++){var p=qr(u,l,f[h],f[(h+1)%f.length]);if(void 0!==p){var d=pn(u,mn(dn(l,u),.5*p));Sn($n(a,d))&&(c=Math.min(c,p))}}if(c<1){var v=c,m=c,g=u.x,y=u.y,b=Hr(n);if(i===mr.TopCenter||i===mr.BottomCenter)if(r===Ae.None)v=1;else{g=b.left+b.width/2;v-=1-c;m-=1-c}else if(i===mr.SideLeft||i===mr.SideRight)if(r===Ae.None)m=1;else{y=b.top+b.height/2;m-=1-c;m-=1-c}s===Lr.Right||s===Lr.Left?m=1:s!==Lr.Up&&s!==Lr.Down||(v=1);o=Jn(_n(v,m,g,y),n)}});return o}function Gr(e,t){var n=qn(e),r=Vn(t).map(function(e){return Rn(n,e)}).reduce(function(e,t){var n=0;t.x<0?n=-t.x:t.x>1&&(n=1-t.x);var r=0;t.y<0?r=-t.y:t.y>1&&(r=1-t.y);Math.abs(n)>Math.abs(e.x)&&(e.x=n);Math.abs(r)>Math.abs(e.y)&&(e.y=r);return e},{x:0,y:0}),i=Yn(e);return dn(Rn(e,r),i)}function Yr(e,t,n,r){var i=Ln(e),s=n===Ae.None;switch(r){case mr.TopLeft:i=Qr([{fixedEnd:mr.BottomRight,freeEnd:mr.TopRight},{fixedEnd:mr.BottomRight,freeEnd:mr.BottomLeft},{fixedEnd:mr.BottomRight,freeEnd:mr.TopLeft}],e,t,n,r);break;case mr.TopCenter:i=Qr(s?[{fixedEnd:mr.BottomLeft,freeEnd:mr.TopLeft},{fixedEnd:mr.BottomRight,freeEnd:mr.TopRight}]:[{fixedEnd:mr.BottomRight,freeEnd:mr.TopRight},{fixedEnd:mr.BottomRight,freeEnd:mr.BottomLeft},{fixedEnd:mr.BottomRight,freeEnd:mr.TopLeft},{fixedEnd:mr.BottomLeft,freeEnd:mr.TopLeft},{fixedEnd:mr.BottomLeft,freeEnd:mr.BottomRight},{fixedEnd:mr.BottomLeft,freeEnd:mr.TopRight}],e,t,n,r);break;case mr.TopRight:i=Qr([{fixedEnd:mr.BottomLeft,freeEnd:mr.TopLeft},{fixedEnd:mr.BottomLeft,freeEnd:mr.BottomRight},{fixedEnd:mr.BottomLeft,freeEnd:mr.TopRight}],e,t,n,r);break;case mr.SideLeft:i=Qr(s?[{fixedEnd:mr.TopRight,freeEnd:mr.TopLeft},{fixedEnd:mr.BottomRight,freeEnd:mr.BottomLeft}]:[{fixedEnd:mr.BottomRight,freeEnd:mr.TopRight},{fixedEnd:mr.BottomRight,freeEnd:mr.BottomLeft},{fixedEnd:mr.BottomRight,freeEnd:mr.TopLeft},{fixedEnd:mr.TopRight,freeEnd:mr.TopLeft},{fixedEnd:mr.TopRight,freeEnd:mr.BottomRight},{fixedEnd:mr.TopRight,freeEnd:mr.BottomLeft}],e,t,n,r);break;case mr.Center:var o=Gr(t,e);i=Jn(Dn(o.x,o.y),e);break;case mr.SideRight:i=Qr(s?[{fixedEnd:mr.TopLeft,freeEnd:mr.TopRight},{fixedEnd:mr.BottomLeft,freeEnd:mr.BottomRight}]:[{fixedEnd:mr.BottomLeft,freeEnd:mr.TopLeft},{fixedEnd:mr.BottomLeft,freeEnd:mr.BottomRight},{fixedEnd:mr.BottomLeft,freeEnd:mr.TopRight},{fixedEnd:mr.TopLeft,freeEnd:mr.TopRight},{fixedEnd:mr.TopLeft,freeEnd:mr.BottomLeft},{fixedEnd:mr.TopLeft,freeEnd:mr.BottomRight}],e,t,n,r);break;case mr.BottomLeft:i=Qr([{fixedEnd:mr.TopRight,freeEnd:mr.TopLeft},{fixedEnd:mr.TopRight,freeEnd:mr.BottomRight},{fixedEnd:mr.TopRight,freeEnd:mr.BottomLeft}],e,t,n,r);break;case mr.BottomCenter:i=Qr(s?[{fixedEnd:mr.TopLeft,freeEnd:mr.BottomLeft},{fixedEnd:mr.TopRight,freeEnd:mr.BottomRight}]:[{fixedEnd:mr.TopLeft,freeEnd:mr.TopRight},{fixedEnd:mr.TopLeft,freeEnd:mr.BottomLeft},{fixedEnd:mr.TopLeft,freeEnd:mr.BottomRight},{fixedEnd:mr.TopRight,freeEnd:mr.TopLeft},{fixedEnd:mr.TopRight,freeEnd:mr.BottomRight},{fixedEnd:mr.TopRight,freeEnd:mr.BottomLeft}],e,t,n,r);break;case mr.BottomRight:i=Qr([{fixedEnd:mr.TopLeft,freeEnd:mr.TopRight},{fixedEnd:mr.TopLeft,freeEnd:mr.BottomLeft},{fixedEnd:mr.TopLeft,freeEnd:mr.BottomRight}],e,t,n,r)}if(i){return Pr(kr(Hr(i)))}return e}function Zr(e,t,n,r,i){var s=Ln(e);if(r===mr.Center){var o=Gr(t,e);return Jn(Dn(o.x,o.y),e)}var u=(function(e,t){var n=[];switch(e){case mr.TopLeft:t===Lr.Up?n=[{fixedEnd:mr.BottomLeft,freeEnd:mr.TopLeft},{fixedEnd:mr.BottomRight,freeEnd:mr.TopRight}]:t===Lr.Left&&(n=[{fixedEnd:mr.TopRight,freeEnd:mr.TopLeft},{fixedEnd:mr.BottomRight,freeEnd:mr.BottomLeft}]);break;case mr.TopRight:t===Lr.Up?n=[{fixedEnd:mr.BottomLeft,freeEnd:mr.TopLeft},{fixedEnd:mr.BottomRight,freeEnd:mr.TopRight}]:t===Lr.Right&&(n=[{fixedEnd:mr.TopLeft,freeEnd:mr.TopRight},{fixedEnd:mr.BottomLeft,freeEnd:mr.BottomRight}]);break;case mr.BottomLeft:t===Lr.Down?n=[{fixedEnd:mr.TopLeft,freeEnd:mr.BottomLeft},{fixedEnd:mr.TopRight,freeEnd:mr.BottomRight}]:t===Lr.Left&&(n=[{fixedEnd:mr.TopRight,freeEnd:mr.TopLeft},{fixedEnd:mr.BottomRight,freeEnd:mr.BottomLeft}]);break;case mr.BottomRight:t===Lr.Down?n=[{fixedEnd:mr.TopLeft,freeEnd:mr.BottomLeft},{fixedEnd:mr.TopRight,freeEnd:mr.BottomRight}]:t===Lr.Right&&(n=[{fixedEnd:mr.TopLeft,freeEnd:mr.TopRight},{fixedEnd:mr.BottomLeft,freeEnd:mr.BottomRight}]);break;case mr.Center:t===Lr.Down?n=[{fixedEnd:mr.TopLeft,freeEnd:mr.BottomLeft},{fixedEnd:mr.TopRight,freeEnd:mr.BottomRight}]:t===Lr.Right?n=[{fixedEnd:mr.TopLeft,freeEnd:mr.TopRight},{fixedEnd:mr.BottomLeft,freeEnd:mr.BottomRight}]:t===Lr.Left?n=[{fixedEnd:mr.TopRight,freeEnd:mr.TopLeft},{fixedEnd:mr.BottomRight,freeEnd:mr.BottomLeft}]:t===Lr.Up&&(n=[{fixedEnd:mr.BottomLeft,freeEnd:mr.TopLeft},{fixedEnd:mr.BottomRight,freeEnd:mr.TopRight}])}return n})(r,i);u.length>0&&(s=Qr(u,e,t,n,r,i)||s);return Pr(kr(Hr(s)))}function ei(e,t){var n=Vn(e),r=Vn(t),i=bn(n[2],n[0]);if(Sn($n(t,i))){var s=Number.MAX_VALUE;n.forEach(function(e){for(var t=0;t<r.length;t++){var n=qr(i,e,r[t],r[(t+1)%r.length]);void 0!==n&&(s=Math.min(s,n))}});return s===Number.MAX_VALUE?void 0:s}}function ti(e,t,n){var r=ei(e,t);if(void 0!==r){if(r<1){var i=Fr(e);return Pr(kr(Hr(Jn(_n(r,r,i.x,i.y),e))))}return e}var s=Kr(n,t),o=s.tx,u=s.ty,a=n,f=Mn(s.scale);return Jn(Dn(o,u),f,a)}var ni=function(e,t,n){return Math.min(Math.max(e,t),n)};function ri(e,t,n){return Jn((function(e,t,n,r,i,s){void 0===i&&(i=0);void 0===s&&(s=0);var o=Qn(e,n,r);if(0===o)throw new RangeError("Invalid Matrix");var u=t/o;return _n(u,u,i,s)})(e,t,1,1,n.x,n.y),e)}var ii=50;var si=function(e){return function(){return e}},oi=function(e,t){return function(){var n=Kr(t,Pr(e)),r=n.tx,i=n.ty,s=n.scale,o=Mn(s),u=Jn(Dn(r,i),o);if(s>ii){var a=ii/s,f=_r(e);return Jn(_n(a,a,f.x,f.y),u)}return u}},ui=function(e,t){return function(){var n=_r(e);return ri(t,1,n)}};function ai(e,t){void 0===t&&(t=!1);var n,r,i,s,o,u,a,f=e.pointer.pointerDowns.length>0&&((n=e.cropInteraction.activeHandleIndex)!==mr.None&&n!==mr.Center),l=(r=e.view.viewFitting.mode,i=vr(e.view.viewportPixelSize,e.device.pixelRatio,e.view.viewFitting.marginCssPixels),s=(function(e,t,n){if(e){var r=Hr(t);if(n.width<r.width&&n.height>r.height){r.top=n.top;r.height=n.height}if(n.height<r.height&&n.width>r.width){r.left=n.left;r.width=n.width}return Pr(r)}return Ln(t)})(f,e.cropInteraction.uvToWorld,e.cropInteraction.rectAtStartOfResize),o=e.image._preciseUvToWorld,u=e.view.worldToView,Pn(((a={})[yr.none]=si(u),a[yr.fitCropRectInView]=oi(i,s),a[yr.fitImageInView]=oi(i,o),a[yr.actualSize]=ui(i,u),a)[r]()));if(t){e.animations.needsFrameTick=!0;e.animations.worldToView=ar(e.animations.worldToView,e.view.worldToView,l)}else e.animations.worldToView=ur();e.view.worldToView=l}function fi(e){ai(e,!0)}function li(e,t,n){var r=wn(jr(e),n);return(function(e,t){var n=jn(e);return Jn(Bn(n,0,0),Mn(t.x,t.y),Bn(-n,0,0),e)})(e,wn(t,r))}function ci(e,t){e.image._preciseUvToWorld=li(e.image._preciseUvToWorld,t,e.image.originalPixelSize);e.animations.image=ur();e.animations.crop=ur();e.cropInteraction.uvToWorld=(n=Pn(e.image._preciseUvToWorld),r=e.cropInteraction.rectTopLeftInImageUv,i=e.cropInteraction.rectBottomRightInImageUv,s=Rn(n,r),o=Rn(n,i),Pr(kr({left:Math.min(s.x,o.x),top:Math.min(s.y,o.y),width:Math.abs(o.x-s.x),height:Math.abs(o.y-s.y)})));var n,r,i,s,o;e.cropInteraction._uvToWorldBeforeRotate=Ln(e.cropInteraction.uvToWorld);ai(e)}function hi(e){return e===gr.zoomToCrop||e===gr.keyboardCropping||e===gr.keyboardRotating}function pi(e,t){t=ni(t,0,1);t*=e.length-1;var n=Math.floor(t),r=Math.ceil(t);return t===n?e[n]:xn(e[n],e[r],Tn(n,r,t))}function di(e,t,n,r,i,s){return(function(e,t,n){var r=e||hi(n);return xn(r?0:.75,r?.75:0,t)})(e,r,s)*(function(e,t){if(hi(t))return pi([1,1,1,1,0],e);return 1})(i,s)*(function(e){var t=Kn(e);return Tn(8,3,t)})(t)*(function(e,t){var n=Hr(Jn(e,t)),r=Math.min(n.height,n.width);return Tn(50,80,r)})(t,n)}function vi(e,t,n,r,i){if("Crop"!==i||r===gr.disabled)return 0;if((r===gr.none||r===gr.draggingView)&&1===t)return.2;var s=e||hi(r);return xn(s?.2:.5,s?.5:.2,t)*(function(e,t){if(hi(t))return pi([1,1,1,1,.4],e);return 1})(n,r)}function mi(e,t){e.animations=(function(e,t){var n=e.outsideCropVisibility,r=e.gridLineVisibility,i=e.dismissGridLineVisibility,s=e.dismissOutsideCropVisibility,o=e.transitionToViewingOriginal,u=e.worldToView,a=e.image,f=e.crop,l=tr(n,t,100),c=pr(r,t,100),h=tr(i,t,400),p=tr(s,t,400),d=tr(o,t,300),v=fr(u,t,100,ir),m=fr(a,t,100,ir),g=fr(f,t,100,ir);return{needsFrameTick:l.isActive||c.isActive||h.isActive||p.isActive||o.isActive||v.isActive||m.isActive||g.isActive,outsideCropVisibility:l,gridLineVisibility:c,dismissGridLineVisibility:h,dismissOutsideCropVisibility:p,transitionToViewingOriginal:d,worldToView:v,image:m,crop:g,currentTime:t}})(e.animations,t);e.view.animateViewWhenViewportIsResized&&!e.animations.worldToView.isActive&&(e.view.animateViewWhenViewportIsResized=!1);!hi(e.cropInteraction.mode)||((n=e.animations).dismissGridLineVisibility.isActive||n.dismissOutsideCropVisibility.isActive)||(e.cropInteraction.mode=wr);var n}var gi,yi=function(){return(yi=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)};function bi(e,t,n){e.view.worldToView=Pn((r=e.view.worldToView,i=e.view.viewportPixelSize,s=t,o=Kn(r),Jn(r,Dn((s.x-i.x)/2/o,(s.y-i.y)/2/o))));var r,i,s,o;e.view.viewportPixelSize=yi({},t);e.view.viewportCssSize=yi({},n);ai(e,e.view.animateViewWhenViewportIsResized)}function wi(e){var t=Pn(e.image._preciseUvToWorld);e.cropInteraction.rectTopLeftInImageUv=$n(t,Rn(e.cropInteraction.uvToWorld,{x:0,y:0}));e.cropInteraction.rectBottomRightInImageUv=$n(t,Rn(e.cropInteraction.uvToWorld,{x:1,y:1}))}function Ei(e,t,n,r){void 0===r&&(r=!1);if(r){e.needsFrameTick=!0;e.image=ar(e.image,t,n)}else e.image=ur()}function Si(e,t,n){return Jn(t(n),e)}function xi(e,t){Ei(e.animations,e.image._preciseUvToWorld,t,!0);e.animations.crop=ur();e.image._preciseUvToWorld=t;wi(e)}(function(e){e[e.userIsRotating=0]="userIsRotating";e[e.userIsZoomingToCrop=1]="userIsZoomingToCrop";e[e.unspecified=2]="unspecified"})(gi||(gi={}));function Ti(e,t,n){void 0===n&&(n=gi.unspecified);e.cropInteraction.uvToWorld=Pr(t);Ci(e,n)}function Ni(e,t,n){void 0===n&&(n=gi.unspecified);e.cropInteraction.uvToWorld=t;Ci(e,n)}function Ci(e,t){t!==gi.userIsRotating&&(e.cropInteraction._uvToWorldBeforeRotate=Ln(e.cropInteraction.uvToWorld));t!==gi.userIsZoomingToCrop&&(e.cropInteraction._uvToWorldBeforeZoomToCrop=Ln(e.cropInteraction.uvToWorld))}function ki(e,t){return!e||Sn(t)}function Li(e,t){e.image._preciseUvToWorld=Ir(t,e.cropInteraction._uvToWorldBeforeRotate,e.image._preciseUvToWorld);e.animations.image=ur();e.animations.crop=ur();e.cropInteraction.shouldConstrainInImage&&Ni(e,ti(e.cropInteraction._uvToWorldBeforeRotate,e.image._preciseUvToWorld,e.cropInteraction.uvToWorld),gi.userIsRotating);wi(e)}var Ai,Oi=function(){return(Oi=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)},Mi=new Map([[Ae.Square,{x:1,y:1}],[Ae.FourByThree,{x:4,y:3}],[Ae.FiveByFour,{x:5,y:4}],[Ae.ThreeByTwo,{x:3,y:2}],[Ae.TwoByOne,{x:2,y:1}],[Ae.SixteenByNine,{x:16,y:9}],[Ae.ThreeByFour,{x:3,y:4}],[Ae.FourByFive,{x:4,y:5}],[Ae.TwoByThree,{x:2,y:3}],[Ae.OneByTwo,{x:1,y:2}],[Ae.NineBySixteen,{x:9,y:16}]]);function _i(e){var t=gn(Br(e));return t.x/t.y}function Di(e,t,n){var r;if(e===Ae.Original)r=n.x/n.y;else if(e===Ae.None){var i=Hr(t);r=i.width/i.height}else{var s=Mi.get(e);r=s?s.x/s.y:0}return r}function Pi(e){return Array.from(Mi.values()).reduce(function(t,n){var r=t.x/t.y,i=n.x/n.y;Math.abs(i-e)<Math.abs(r-e)&&(t=Oi({},n));return t},{x:1,y:1})}function Hi(e,t,n){var r=Oi({},e),i=Math.hypot(e.width,e.height),s=mn(vn({x:t,y:1}),i);r.width=s.x;r.height=s.y;if(void 0!==n){var o=Ur(n),u=zr(n);-1===o?r.left+=e.width-r.width:0===o&&(r.left+=(e.width-r.width)/2);-1===u?r.top+=e.height-r.height:0===u&&(r.top+=(e.height-r.height)/2)}return r}function Bi(e,t,n){var r=Hr(e),i=Fr(e),s=Math.hypot(r.width,r.height),o=mn(vn({x:n,y:1}),s),u=r.width/o.x,a=r.height/o.y,f={left:i.x-o.x/2,top:i.y-o.y/2,width:o.x,height:o.y},l=Pr(f),c=ei(l,t);if(void 0!==c&&(c<=u||c<=a)){var h=Dn(-i.x,-i.y),p=Mn(c);return kr(Hr(Jn(Dn(i.x,i.y),p,h,l)))}return kr(f)}(function(e){e[e.Clockwise=0]="Clockwise";e[e.CounterClockwise=1]="CounterClockwise"})(Ai||(Ai={}));function ji(e){var t=function(t,n){return e>t&&e<=n};return t(-45,45)?e:t(45,135)?e-90:t(-135,-45)?e+90:t(135,180)?e-180:e+180}function Fi(e,t){var n=e+t;return n>180?-360+n:n<=-180?360+n:n}function Ii(e,t){var n=t===Ai.Clockwise?90:-90,r=Ir(n,e.cropInteraction._uvToWorldBeforeRotate,e.image._preciseUvToWorld);e.animations.needsFrameTick=!0;e.animations.image=ar(e.animations.image,e.image._preciseUvToWorld,r);e.image._preciseUvToWorld=r;e.cropInteraction.aspectRatioConstraint=(function(e){var t=e,n=Mi.get(e);n&&Mi.forEach(function(e,r){e.x===n.y&&e.y===n.x&&(t=r)});return t})(e.cropInteraction.aspectRatioConstraint);var i,s,o,u=Ir(n,e.cropInteraction._uvToWorldBeforeRotate,e.cropInteraction.uvToWorld);e.animations.crop=ar(e.animations.crop,e.cropInteraction.uvToWorld,u);Ti(e,(i=e.cropInteraction.uvToWorld,s=Fr(i),o=Hr(i),{top:s.y-o.width/2,left:s.x-o.height/2,width:o.height,height:o.width}));wi(e);fi(e)}function qi(e,t,n,r){return e.x+r/45*t+n*Math.sign(r)}function Ri(e,t){Li(e,(function(e,t){return(t=ni(t,-44.999999999999,45-1e-12))-e})(ji(jn(e.image._preciseUvToWorld)),t))}function Ui(e,t){if(e.rotationUi.rotationBarPointer.isDown){if(t){var n=jn(e.image._preciseUvToWorld);t.logRotateEvent({angle:n})}e.rotationUi.rotationBarPointer.isDown=!1;e.animations.needsFrameTick=!0;e.animations.gridLineVisibility=hr(8);e.cropInteraction.mode=wr}}var zi=function(){return(zi=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)};function Wi(e,t){e.rotationUi.rotationBarPointer.isDown&&!t.isPrimaryButtonDownOrTouchDown&&Ui(e);if(e.rotationUi.rotationBarPointer.isDown){var n=t.pointerPhysicalPixelPos,r=ji(jn(e.image._preciseUvToWorld)),i=544*e.device.pixelRatio,s=(function(e,t,n,r,i){var s=r-n.x;if(Math.abs(s)<28)return 0;var o=(t.x-n.x)/i,u=Math.min(Math.abs(o),1)*(o<0?-44.999999999999:45-1e-12);return e+u})(r,e.rotationUi.rotationBarPointer.movePos,n,e.rotationUi.deadZoneCenterPos,i);e.rotationUi.deadZoneCenterPos=(function(e,t,n,r,i){if(t>=45-1e-12||t<=-44.999999999999)return qi(n,i,28,e);return r})(r,s,n,e.rotationUi.deadZoneCenterPos,i);Ri(e,s);e.rotationUi.rotationBarPointer.movePos=zi({},n);ai(e)}}var Xi=function(){return(Xi=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)};function Vi(e,t,n){var r=dn(e,t);return Pn(Jn(Dn(r.x,r.y),n))}function $i(e,t,n){return Rn(qn(Jn(t,Pn(n))),e)}var Ji=function(){return(Ji=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)};function Ki(e,t,n,r,i,s,o){if(-1===n)return e;var u=Ji({},e),a=r.x,f=r.y,l=zr(n),c=Ur(n);if(0===c&&0===l){a=Math.max(t.left+e.width/2,a);a=Math.min(t.left+t.width-e.width/2,a);f=Math.max(t.top+e.height/2,f);f=Math.min(t.top+t.height-e.height/2,f);var h=a-(e.left+e.width/2),p=f-(e.top+e.height/2);u.left+=h;u.top+=p}else{a=Math.max(t.left,a);a=Math.min(t.left+t.width,a);f=Math.max(t.top,f);f=Math.min(t.top+t.height,f);a-=e.left;f-=e.top;if(-1===c){a=Math.min(a,u.width-s);u.left=a+e.left;u.width=u.width-a}else if(1===c){a=Math.max(a,s);u.width=a}if(-1===l){f=Math.min(f,u.height-s);u.top=f+e.top;u.height=u.height-f}else if(1===l){f=Math.max(f,s);u.height=f}u=o?Hi(u,o,n):(function(e,t,n,r,i,s,o){var u=Pi(t.width/t.height),a=u.x/u.y,f=kr(t),l=ni(i.x,f.left,f.left+f.width),c=ni(i.y,f.top,f.top+f.height),h=1,p=1;f.width!==e.width&&(h=Math.max(h,Math.min(Math.round(l+r)-(s?f.left:f.width+f.left),n.width-t.width)));f.height!==e.height&&(p=Math.max(p,Math.min(Math.round(c+r)-(o?f.top:f.height+f.top),n.height-t.height)));for(var d=0;d<h;d++)for(var v=0;v<p;v++)if(Math.abs((f.width+d)/(f.height+v)-a)<1e-6){s&&(f.left-=d);o&&(f.top-=v);f.width+=d;f.height+=v;return f}return t})(e,u,t,i,r,-1===c,-1===l)}return kr(u)}function Qi(e,t,n){return 0!==Kn(t)&&Or($i(e,t,n),Ar)}function Gi(e,t){return(3*e+8)/Kn(t)}var Yi=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),i=0;for(t=0;t<n;t++)for(var s=arguments[t],o=0,u=s.length;o<u;o++,i++)r[i]=s[o];return r};function Zi(e,t){(function(e,t){var n,r,i=e.cropInteraction.uvToWorld;e.cropInteraction.uvToWorld=Yi(i);t();(n=e.cropInteraction.uvToWorld,r=i,n.every(function(e,t){return e===r[t]}))&&(e.cropInteraction.uvToWorld=i)})(e,function(){if(!(e.pointer.pointerDowns.length>1)){if(1===e.pointer.pointerDowns.length){if(!(e.pointer.pointerDowns[0].pointerId===t.pointerId))return}var n=t.pointerPhysicalPixelPos;if(e.pointer.preventShift){e.cropInteraction.mode!==gr.draggingView&&e.cropInteraction.mode!==gr.draggingImage||(e.pointer.offset=dn(e.pointer.movePos,n));e.pointer.preventShift=!1}var r=pn(n,e.pointer.offset);switch(e.cropInteraction.mode){case gr.disabled:(function(e,t){if(e.pointer.pointerDowns.length>0&&e.animations.transitionToViewingOriginal.isActive&&e.view.viewFitting.mode!==yr.fitCropRectInView){e.cropInteraction.mode=gr.draggingView;e.animations.transitionToViewingOriginal={startTime:void 0,isActive:!1};es(e,t)}})(e,r);break;case gr.draggingView:es(e,r);break;case gr.zoomToCrop:case gr.keyboardCropping:case gr.keyboardRotating:case gr.none:(function(e,t){var n=Jr(e.cropUiDisplay.handleHitAreaSizeCss,e.device.pixelRatio);e.cropInteraction.activeHandleIndex=(r=e.view.worldToView,i=e.cropInteraction.uvToWorld,s=t,o=n,u=Hr(Jn(r,i)),Wr(s,u,o));var r,i,s,o,u})(e,r);break;case gr.usingNineSliceCropHandles:(function(e,t,n){if(e.cropInteraction.activeHandleIndex!==mr.Center){var r=Hr(e.cropInteraction.uvToWorld),i=dn(t,e.pointer.downOffsetFromCropHandleCenter),s=$n(e.view.worldToView,i),o=(function(e,t,n){var r=Hr(e.cropInteraction.uvToWorld),i=Hr(e.image._preciseUvToWorld),s=Gi($r(e.cropUiDisplay.handleSizeCss,e.device.pixelRatio),e.view.worldToView),o=n||e.cropInteraction.aspectRatioConstraint!==Ae.None?Di(e.cropInteraction.aspectRatioConstraint,e.cropInteraction.uvToWorld,e.image.originalPixelSize):void 0;return Ki(r,i,e.cropInteraction.activeHandleIndex,t,1/Qn(e.view.worldToView,1,1),s,o)})(e,s,n);Ti(e,o);if(e.cropInteraction.shouldConstrainInImage){Ni(e,Yr(e.cropInteraction.uvToWorld,e.image._preciseUvToWorld,e.cropInteraction.aspectRatioConstraint,e.cropInteraction.activeHandleIndex));if(Dr(Hr(e.cropInteraction.uvToWorld),r))switch(e.cropInteraction.activeHandleIndex){case mr.BottomCenter:s.y>r.top+r.height&&Ti(e,r);break;case mr.TopCenter:s.y<r.top&&Ti(e,r);break;case mr.SideLeft:s.x<r.left&&Ti(e,r);break;case mr.SideRight:s.x>r.left+r.width&&Ti(e,r)}}wi(e);var u=Hr(e.cropInteraction.uvToWorld);(u.width>e.cropInteraction.rectAtStartOfResize.width||u.height>e.cropInteraction.rectAtStartOfResize.height)&&ai(e)}})(e,r,t.shiftKey);break;case gr.draggingImage:(function(e,t){e.image._preciseUvToWorld=ts(e.view.worldToView,e.image._preciseUvToWorld,e.cropInteraction.uvToWorld,e.pointer.imageUvGrabPosition,t);e.animations.image=ur();e.animations.crop=ur();wi(e)})(e,r);break;case gr.selectingFirstCorner:break;case gr.selectingSecondCorner:(function(e,t){var n=Rn(e.image._preciseUvToWorld,e.pointer.imageUvGrabPosition),r=$n(e.view.worldToView,t);e.cropInteraction.shouldConstrainInImage&&(r=(function(e,t){var n=$n(t,e);n.x=ni(n.x,0,1);n.y=ni(n.y,0,1);return Rn(t,n)})(r,e.image._preciseUvToWorld));var i=(s=n,o=r,u=Math.min(s.x,o.x),a=Math.min(s.y,o.y),f=Math.max(s.x,o.x),l=Math.max(s.y,o.y),c=Math.max(1,f-u),h=Math.max(1,l-a),kr({left:u,top:a,width:c,height:h}));var s,o,u,a,f,l,c,h;i=Hi(i,Di(e.cropInteraction.aspectRatioConstraint,Pr(i),e.image.originalPixelSize),ns(n,r));Ti(e,i);e.cropInteraction.shouldConstrainInImage&&Ni(e,Yr(e.cropInteraction.uvToWorld,e.image._preciseUvToWorld,e.cropInteraction.aspectRatioConstraint,ns(n,r)));wi(e)})(e,r)}e.pointer.movePos=r}})}function es(e,t){e.view.worldToView=Vi(t,e.pointer.movePos,e.view.worldToView);e.animations.worldToView=ur();e.view.viewFitting.mode=yr.none}function ts(e,t,n,r,i){var s=Rn(qn(Jn(e,t)),i),o=Rn(t,r),u=dn(Rn(t,s),o),a=dn(u,Gr(Jn(Dn(u.x,u.y),t),n));return 0===a.x&&0===a.y?t:Jn(Dn(a.x,a.y),t)}function ns(e,t){var n=mr.TopLeft;e.x<=t.x?n=e.y<=t.y?mr.BottomRight:mr.TopRight:e.y<=t.y&&(n=mr.BottomLeft);return n}function rs(e,t,n,r,i){void 0===i&&(i=!1);var s=Kr(e.cropInteraction.uvToWorld,Pr(vr(e.view.viewportPixelSize,e.device.pixelRatio,e.view.viewFitting.marginCssPixels))).scale,o=(function(e,t){return ni(e,t,ii)})(t,s),u=o===s;r&&r.logZoomEvent({zoomLevel:o/s});if(u){e.view.viewFitting.mode=yr.fitCropRectInView;fi(e);return{zoomIsMinimum:u}}e.view.viewFitting.mode=yr.none;var a=Pn(ri(e.view.worldToView,o,n));if(i){e.animations.needsFrameTick=!0;e.animations.worldToView=ar(e.animations.worldToView,e.view.worldToView,a)}else e.animations.worldToView=ur();e.view.worldToView=a;return{zoomIsMinimum:u}}function is(e,t,n,r){if(0!==t){var i=Hr(e.cropInteraction.uvToWorld),s=t>0,o=Gi($r(e.cropUiDisplay.handleSizeCss,e.device.pixelRatio),e.view.worldToView),u=Hr(e.cropInteraction._uvToWorldBeforeZoomToCrop),a=u.width/u.height,f=(function(e,t,n,r,i,s){var o=t!==Ae.None,u=Hr(n),a=Br(n),f=Hr(r),l=Br(r),c=mn(a,e),h=dn(l,a),p=wn(h,c),d=c.x>h.x?p.x:1,v=c.y>h.y?p.y:1,m=mn(c,Math.min(d,v)),g=mn(m,.5),y=dn({x:u.left,y:u.top},g),b=pn({x:f.left,y:f.top},l),w=pn(a,m),E=l.y===a.x&&g.x>0,S=l.x===a.y&&g.y>0,x=ni(X(y.x),f.left,b.x),T=ni(X(y.y),f.top,b.y),N=E?u.left:x,C=S?u.top:T,k={left:N,top:C,width:ni(w.x,i,f.left+l.x-N),height:ni(w.y,i,f.top+l.y-C)},L=Pr(k);return Hi(k,o?Di(t,L,l):s)})(t,e.cropInteraction.aspectRatioConstraint,e.cropInteraction.uvToWorld,e.image._preciseUvToWorld,o,a);r&&r.logZoomEvent({zoomLevel:t});e.view.viewFitting.mode=yr.fitCropRectInView;Ti(e,(function(e,t){return{top:Math.round(e.top),left:Math.round(e.left),width:t?Math.ceil(Math.max(1,e.width)):Math.floor(Math.max(1,e.width)),height:t?Math.ceil(Math.max(1,e.height)):Math.floor(Math.max(1,e.height))}})(f,s),gi.userIsZoomingToCrop);if(e.cropInteraction.shouldConstrainInImage&&s){if(ji(jn(e.image._preciseUvToWorld))>0){Ni(e,Yr(e.cropInteraction.uvToWorld,e.image._preciseUvToWorld,e.cropInteraction.aspectRatioConstraint,mr.TopRight),gi.userIsZoomingToCrop);Ni(e,Yr(e.cropInteraction.uvToWorld,e.image._preciseUvToWorld,e.cropInteraction.aspectRatioConstraint,mr.BottomLeft),gi.userIsZoomingToCrop)}else{Ni(e,Yr(e.cropInteraction.uvToWorld,e.image._preciseUvToWorld,e.cropInteraction.aspectRatioConstraint,mr.TopLeft),gi.userIsZoomingToCrop);Ni(e,Yr(e.cropInteraction.uvToWorld,e.image._preciseUvToWorld,e.cropInteraction.aspectRatioConstraint,mr.BottomRight),gi.userIsZoomingToCrop)}Dr(Hr(e.cropInteraction.uvToWorld),i)&&Ti(e,i,gi.userIsZoomingToCrop)}if(n){e.animations.needsFrameTick=!0;if(e.cropInteraction.mode!==gr.zoomToCrop){e.cropInteraction.mode=gr.zoomToCrop;e.animations.gridLineVisibility=hr(2);e.animations.outsideCropVisibility={startTime:void 0,isActive:!0}}e.animations.dismissGridLineVisibility={startTime:void 0,isActive:!0};e.animations.dismissOutsideCropVisibility={startTime:void 0,isActive:!0}}ai(e)}}function ss(e,t,n){rs(e,t,mn(e.view.viewportPixelSize,.5),n,!0)}function os(e,t,n){var r=t.deltaY,i=t.deltaMode,s=t.mousePhysicalPixelPos,o=t.ctrlKey;if(0!==r)if(!e.cropInteraction.enableZoomToCrop||!Qi(s,e.view.worldToView,e.cropInteraction.uvToWorld)||e.view.viewFitting.mode===yr.none||o&&e.view.enableZoomToView){if(e.view.enableZoomToView){rs(e,(function(e,t,n){var r=t===WheelEvent.DOM_DELTA_PIXEL?e:40*e,i=1+.1*Math.abs(r/100),s=Kn(n);return e>0?s/i:s*i})(r,i,e.view.worldToView),s,n)}}else{is(e,r/100*(r<0?.05:5/95),!0,n)}}function us(e,t){if(t.isPrimaryButtonDownOrTouchDown){var n=e.pointer.pointerDowns.length>0;e.pointer.pointerDowns=e.pointer.pointerDowns.concat({pointerId:t.pointerId,isTouch:t.isTouch});if(!n){e.cropInteraction.isKeyboardFocused=!1;var r=t.pointerPhysicalPixelPos;e.pointer.imageUvGrabPosition=$i(r,e.view.worldToView,e.image._preciseUvToWorld);var i=Hr(Jn(e.view.worldToView,e.cropInteraction.uvToWorld)),s=Jr(e.cropUiDisplay.handleHitAreaSizeCss,e.device.pixelRatio);e.cropInteraction.activeHandleIndex=Wr(r,i,s);e.cropInteraction.mode=(function(e,t,n,r){switch(e.mode){case gr.selectingFirstCorner:if(ki(e.shouldConstrainInImage,t))return gr.selectingSecondCorner;break;case gr.zoomToCrop:case gr.keyboardCropping:case gr.keyboardRotating:case gr.none:return n?r?gr.draggingView:gr.none:e.activeHandleIndex!==mr.None||Or(t,Ar)?e.activeHandleIndex===mr.Center||e.activeHandleIndex===mr.None&&e.allowDraggingImageOutsideRect&&Or(t,Ar)?gr.draggingImage:gr.usingNineSliceCropHandles:r?gr.draggingView:gr.none}return e.mode})(e.cropInteraction,e.pointer.imageUvGrabPosition,t.ctrlKey,e.view.allowDraggingView);if(e.cropInteraction.mode===gr.selectingSecondCorner){var o=$n(e.view.worldToView,r);Ti(e,kr({left:o.x,top:o.y,width:1,height:1}));wi(e)}else if(e.cropInteraction.mode===gr.usingNineSliceCropHandles){e.cropInteraction.focusedHandleIndex=e.cropInteraction.activeHandleIndex;e.cropInteraction.activeHandleIndex!==mr.None&&(e.pointer.downOffsetFromCropHandleCenter=Vr(e.cropInteraction.activeHandleIndex,i,r));e.cropInteraction.rectAtStartOfResize=Hr(e.cropInteraction.uvToWorld)}if(e.cropInteraction.mode!==gr.draggingView&&e.cropInteraction.mode!==gr.none&&e.cropInteraction.mode!==gr.disabled){e.animations.needsFrameTick=!0;e.animations.outsideCropVisibility={startTime:void 0,isActive:!0};e.animations.gridLineVisibility=hr(2)}if(e.cropInteraction.mode===gr.disabled){e.animations.transitionToViewingOriginal={startTime:void 0,isActive:!0};e.animations.needsFrameTick=!0}e.pointer.movePos=r}}}var as=function(){return(as=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)};function fs(e){switch(e){case"ArrowRight":case"ArrowLeft":case"ArrowUp":case"ArrowDown":return!0;default:return!1}}function ls(e){return"ArrowRight"===e||"ArrowLeft"===e}function cs(e){switch(e){case"ArrowRight":return Lr.Right;case"ArrowLeft":return Lr.Left;case"ArrowUp":return Lr.Up;case"ArrowDown":return Lr.Down;default:return Lr.None}}function hs(){return document.body.className.indexOf("ms-Fabric--isFocusVisible")>-1}function ps(e){return e.shiftKey&&fs(e.key)}function ds(e){return fs(e.key)||ps(e)}function vs(e){return e.shiftKey&&ls(e.key)}function ms(e){return ls(e.key)||vs(e)}function gs(e,t){var n=t.direction,r=t.handlePosition,i=t.cropShiftingValue,s=(function(e,t,n,r){var i=as({},e);switch(t){case Lr.Right:if(n===mr.TopLeft||n===mr.BottomLeft){i.left=e.width<r?e.left+e.width:e.left+r;i.width=e.width-r}else n===mr.TopRight||n===mr.BottomRight?i.width=e.width+r:n===mr.Center&&(i.left=e.left+r);break;case Lr.Left:if(n===mr.TopRight||n===mr.BottomRight)i.width=e.width-r;else if(n===mr.TopLeft||n===mr.BottomLeft){i.left=e.left-r;i.width=e.width+r}else n===mr.Center&&(i.left=e.left-r);break;case Lr.Down:if(n===mr.TopLeft||n===mr.TopRight){i.top=e.height<r?e.top+e.height:e.top+r;i.height=e.height-r}else n===mr.BottomLeft||n===mr.BottomRight?i.height=e.height+r:n===mr.Center&&(i.top=e.top+r);break;case Lr.Up:if(n===mr.BottomLeft||n===mr.BottomRight)i.height=e.height-r;else if(n===mr.TopLeft||n===mr.TopRight){i.top=e.top-r;i.height=e.height+r}else n===mr.Center&&(i.top=e.top-r)}return i=kr(i)})(Hr(e.cropInteraction.uvToWorld),n,r,i),o=kr(Hi(s,Di(e.cropInteraction.aspectRatioConstraint,Pr(s),e.image.originalPixelSize),r));if(!(function(e,t,n){return(t===Lr.Right||t===Lr.Left)&&e.width<=n||(t===Lr.Up||t===Lr.Down)&&e.height<=n})(o,n,i)){Ti(e,o);e.cropInteraction.focusedHandleIndex=r;e.cropInteraction.shouldConstrainInImage&&Ni(e,Zr(e.cropInteraction.uvToWorld,e.image._preciseUvToWorld,e.cropInteraction.aspectRatioConstraint,e.cropInteraction.focusedHandleIndex,n));wi(e);e.animations.needsFrameTick=!0;if(e.cropInteraction.mode!==gr.keyboardCropping){e.cropInteraction.mode=gr.keyboardCropping;e.animations.gridLineVisibility=hr(2);e.animations.outsideCropVisibility={startTime:void 0,isActive:!0}}e.animations.dismissGridLineVisibility={startTime:void 0,isActive:!0};e.animations.dismissOutsideCropVisibility={startTime:void 0,isActive:!0};ai(e)}}function ys(e){var t,n,r,i,s,o,u,a,f,l,c,h,p=(t=e.view.worldToView,n=e.cropInteraction.uvToWorld,r=e.view.viewportPixelSize,i=Hr(Jn(t,n)),s=i.left,o=i.top,u=i.width,a=i.height,f=r.x/2-s,l=r.y/2-o,c=f-u,h=l-a,{x:f<0?f:c>0?c:0,y:l<0?l:h>0?h:0});if(0!==p.x||0!==p.y){var d=Pn(Jn(Dn(p.x,p.y),e.view.worldToView));e.animations.needsFrameTick=!0;e.animations.worldToView=ar(e.animations.worldToView,e.view.worldToView,d);e.view.worldToView=d}}function bs(e){return e.filter(function(e){return e.isTouch}).length}function ws(e,t,n){if(0!==e.pointer.pointerDowns.length){if(e.pointer.pointerDowns.some(function(e){return e.pointerId===t})){var r,i,s,o,u,a,f=(r=e.pointer.pointerDowns,i=t,s=bs(r),o=r.filter(function(e){return e.pointerId!==i}),u=bs(o),a=u<s,1===o.length&&1===u&&a);e.pointer.pointerDowns=e.pointer.pointerDowns.filter(function(e){return e.pointerId!==t});if(f)e.pointer.preventShift=!0;else if(!(e.pointer.pointerDowns.length>0)){e.pointer.offset={x:0,y:0};if(n){var l=Hr(e.cropInteraction.uvToWorld);(c=e.cropInteraction.rectAtStartOfResize,h=l,void 0===p?c.top===h.top&&c.left===h.left&&c.width===h.width&&c.height===h.height:W(c.top,p)===W(h.top,p)&&W(c.left,p)===W(h.left,p)&&W(c.width,p)===W(h.width,p)&&W(c.height,p)===W(h.height,p))||n.logCropEvent()}var c,h,p;if(e.cropInteraction.mode!==gr.draggingView&&e.cropInteraction.mode!==gr.none&&e.cropInteraction.mode!==gr.disabled){e.animations.needsFrameTick=!0;e.animations.outsideCropVisibility={startTime:void 0,isActive:!0};e.animations.gridLineVisibility=hr(2)}e.cropInteraction.mode===gr.selectingSecondCorner&&(e.view.viewFitting.mode=yr.fitCropRectInView);if(e.cropInteraction.mode===gr.draggingView||e.cropInteraction.mode===gr.disabled){ys(e);e.cropInteraction.mode=gr.disabled}else{fi(e);e.cropInteraction.mode=wr}}}}}function Es(e,t){e.cropInteraction.aspectRatioConstraint=t;Ti(e,Bi(e.cropInteraction.uvToWorld,e.image._preciseUvToWorld,Di(t,e.cropInteraction.uvToWorld,e.image.originalPixelSize)));fi(e)}function Ss(e,t){var n,r,i,s;void 0===t&&(t=!1);var o=e.image.originalPixelSize,u=(null===(n=e.defaults.image)||void 0===n?void 0:n._preciseUvToWorld)||Mn(o.x,o.y),a=(null===(r=e.defaults.cropInteraction)||void 0===r?void 0:r.uvToWorld)||u;(function(e,t,n,r){void 0===r&&(r=!1);if(r){e.needsFrameTick=!0;e.crop=ar(e.crop,t,n)}else e.crop=ur()})(e.animations,e.cropInteraction.uvToWorld,a,t);Ni(e,a,gi.userIsRotating);Ei(e.animations,e.image._preciseUvToWorld,u,t);e.image._preciseUvToWorld=u;wi(e);e.view.viewFitting.mode=Er;t?fi(e):ai(e);Es(e,null!==(s=null===(i=e.defaults.cropInteraction)||void 0===i?void 0:i.aspectRatioConstraint)&&void 0!==s?s:Sr)}var xs=function(){return(xs=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)};function Ts(e,t){var n=t.direction,r=t.sliderShiftingValue;Ri(e,(function(e,t,n){switch(e){case Lr.Right:return t+n;case Lr.Left:return t-n;default:return t}})(n,ji(jn(e.image._preciseUvToWorld)),r));e.animations.needsFrameTick=!0;if(e.cropInteraction.mode!==gr.keyboardRotating){e.cropInteraction.mode=gr.keyboardRotating;e.animations.gridLineVisibility=hr(8);e.animations.outsideCropVisibility={startTime:void 0,isActive:!0}}e.animations.dismissGridLineVisibility={startTime:void 0,isActive:!0};e.animations.dismissOutsideCropVisibility={startTime:void 0,isActive:!0};ai(e)}var Ns=function(){return(Ns=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)};function Cs(e,t){t.resetEditsOnSizeChange&&(function(e,t){if(e.image.originalPixelSize.x!==t.x||e.image.originalPixelSize.y!==t.y){e.image.originalPixelSize=Ns({},t);Ss(e)}})(e,t.sizeInPixels);e.image.loadedPixelSize=t.sizeInPixels}function ks(e){var t=e.width,n=e.height,r=e.x,i=e.y,s=e.rotation;return Jn(Dn(r,i),Hn(s),Mn(t,n))}function Ls(e){var t=e[0]*e[4]-e[1]*e[3]<0?-1:1,n=Yn(e),r=n.x,i=n.y;return{width:Math.hypot(e[0],e[3])*t,height:Math.hypot(e[1],e[4]),rotation:jn(e),x:r,y:i}}var As=function(){return(As=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)};function Os(e,t){e.image.originalPixelSize=As({},t.originalImageSize);var n=ks(t.imageTransform);Ni(e,Pr(t.cropRectangle),gi.unspecified);Ei(e.animations,e.image._preciseUvToWorld,n);e.image._preciseUvToWorld=n;e.animations.crop=ur();wi(e);ai(e,!1);e.cropInteraction.aspectRatioConstraint=t.aspectRatioConstraint;return e}var Ms,_s,Ds={numRedSamplesPerSlice:17,numGreenSamplesPerSlice:17,numBlueSlicesPerRowIn2DLayout:2,numBlueSlicesPerColumnIn2DLayout:17},Ps=[{name:"Original",lutUrlId:"",config:void 0,locStringKey:"filter_nameOriginal",ariaLabelLocStringKey:"filter_nameOriginal"},{name:"Punch",lutUrlId:"lutUrl_punch",config:Ds,locStringKey:"filter_namePunch",ariaLabelLocStringKey:"filter_namePunch"},{name:"Golden",lutUrlId:"lutUrl_golden",config:Ds,locStringKey:"filter_nameGolden",ariaLabelLocStringKey:"filter_nameGolden"},{name:"Radiate",lutUrlId:"lutUrl_radiate",config:Ds,locStringKey:"filter_nameRadiate",ariaLabelLocStringKey:"filter_nameRadiate"},{name:"Warm Contrast",lutUrlId:"lutUrl_warmContrast",config:Ds,locStringKey:"filter_nameWarmContrast",ariaLabelLocStringKey:"filter_nameWarmContrast"},{name:"Calm",lutUrlId:"lutUrl_calm",config:Ds,locStringKey:"filter_nameCalm",ariaLabelLocStringKey:"filter_nameCalm"},{name:"Cool Light",lutUrlId:"lutUrl_coolLight",config:Ds,locStringKey:"filter_nameCoolLight",ariaLabelLocStringKey:"filter_nameCoolLight"},{name:"Vivid Cool",lutUrlId:"lutUrl_vividCool",config:Ds,locStringKey:"filter_nameVividCool",ariaLabelLocStringKey:"filter_nameVividCool"},{name:"Dramatic Cool",lutUrlId:"lutUrl_dramaticCool",config:Ds,locStringKey:"filter_nameDramaticCool",ariaLabelLocStringKey:"filter_nameDramaticCool"},{name:"BW",lutUrlId:"lutUrl_bw",config:Ds,locStringKey:"filter_nameBw",ariaLabelLocStringKey:"filter_nameBw"},{name:"BW Cool",lutUrlId:"lutUrl_bwCool",config:Ds,locStringKey:"filter_nameBwCool",ariaLabelLocStringKey:"filter_nameBwCool"},{name:"BW Warm",lutUrlId:"lutUrl_bwWarm",config:Ds,locStringKey:"filter_nameBwWarm",ariaLabelLocStringKey:"filter_nameBwWarm"},{name:"BW High Contrast",lutUrlId:"lutUrl_bwHighContrast",config:Ds,locStringKey:"filter_nameBwHighContrast",ariaLabelLocStringKey:"filter_nameBwHighContrast"},{name:"Burn",lutUrlId:"lutUrl_burn",config:Ds,locStringKey:"filter_nameBurn",ariaLabelLocStringKey:"filter_nameBurn"},{name:"Film",lutUrlId:"lutUrl_film",config:Ds,locStringKey:"filter_nameFilm",ariaLabelLocStringKey:"filter_nameFilm"},{name:"Vintage",lutUrlId:"lutUrl_vintage",config:Ds,locStringKey:"filter_nameVintage",ariaLabelLocStringKey:"filter_nameVintage"}],Hs=an("edit/handlePointerDown"),Bs=an("edit/handlePointerUp"),js=an("edit/resetEdits"),Fs={activeFilter:Ps[0],availableFilters:Ps,filterLevel:1},Is=ln({name:"filters",initialState:Fs,reducers:{setActiveFilterAndLevel:function(e,t){var n=t.payload,r=n.activeFilter,i=n.filterLevel;e.activeFilter=r;e.filterLevel=i}},extraReducers:(Ms={},Ms[js.type]=function(e,t){e.filterLevel=Fs.filterLevel;e.activeFilter=Fs.activeFilter},Ms)}),qs=Is.actions.setActiveFilterAndLevel,Rs=Is.reducer;(function(e){e.Pen="Pen";e.Highlighter="Highlighter"})(_s||(_s={}));var Us,zs,Ws,Xs,Vs={pen1:{thicknessInCssPixels:4,htmlColor:"#0078d7",inkType:_s.Pen},pen2:{thicknessInCssPixels:4,htmlColor:"#000000",inkType:_s.Pen},highlighter:{thicknessInCssPixels:16,htmlColor:"#fed430",inkType:_s.Highlighter}},$s=Object.keys(Vs)[0],Js=function(){return(Js=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)},Ks=Ps.reduce(function(e,t){e[t.name]=1;return e},{}),Qs={showAspectRatioOptions:!1,activeAdjustment:void 0,activeEditorActivity:"Crop",nextEditorActivity:"",waitingForActiveEditorActivityToComplete:!1,shouldWaitFromMarkupActivity:!1,numberOfResets:0,isViewingOriginal:!1,filterLevelsByName:Ks,activeInkBrushId:$s,showInkStylePicker:!1},Gs=ln({name:"EditorUiState",initialState:Qs,reducers:{setShowAspectRatioOptions:function(e,t){e.showAspectRatioOptions=t.payload},setActiveAdjustment:function(e,t){e.activeAdjustment=t.payload},prepareEditorActivityChange:function(e,t){if(t.payload&&e.activeEditorActivity!==t.payload){"Markup"===e.activeEditorActivity&&e.shouldWaitFromMarkupActivity&&(e.waitingForActiveEditorActivityToComplete=!0);e.nextEditorActivity=t.payload;(function(){performance.clearMarks("editorActivityPrepareMark");performance.mark("editorActivityPrepareMark")})();(function(e){performance.clearMarks(e);performance.mark(e)})(e.nextEditorActivity)}},setActiveEditorActivity:function(e,t){if(t.telemetry){var n=(function(){var e=performance.getEntriesByName("editorActivityPrepareMark");if(1===e.length){var t=performance.now()-e[0].startTime;performance.clearMarks("editorActivityPrepareMark");return t}})();n&&t.payload&&t.telemetry.logEditorActivityChangePrepareTimeEvent({fromEditorActivityName:e.activeEditorActivity,prepareTimeInMs:n,toEditorActivityName:t.payload})}if(t.payload){e.activeEditorActivity=t.payload;e.isViewingOriginal=!1;e.nextEditorActivity=""}},stopWaitingForNextEditorActivity:function(e,t){e.waitingForActiveEditorActivityToComplete=!1},setWaitingFromMarkupActivity:function(e,t){e.shouldWaitFromMarkupActivity=t.payload},setIsViewingOriginal:function(e,t){e.isViewingOriginal=t.payload},setActiveMarkupInkBrushId:function(e,t){e.activeInkBrushId=t.payload},setShowInkStylePicker:function(e,t){e.showInkStylePicker=t.payload},setUiState:function(e,t){return Js({},t.payload)},resetUiState:function(e,t){return Js({},Qs)}},extraReducers:(Us={},Us[js.type]=function(e,t){e.numberOfResets+=1;e.filterLevelsByName=Ks},Us[Hs.type]=function(e){"Adjustment"!==e.activeEditorActivity&&"Filter"!==e.activeEditorActivity||(e.isViewingOriginal=!0)},Us[Bs.type]=function(e){e.isViewingOriginal=!1},Us[qs.type]=function(e,t){var n=t.payload,r=n.activeFilter,i=n.filterLevel;e.filterLevelsByName[r.name]=null!=i?i:1},Us)}),Ys=(zs=Gs.actions).setShowAspectRatioOptions,Zs=zs.setActiveAdjustment,eo=zs.prepareEditorActivityChange,to=zs.setActiveEditorActivity,no=zs.stopWaitingForNextEditorActivity,ro=zs.setWaitingFromMarkupActivity,io=zs.setIsViewingOriginal,so=zs.setUiState,oo=zs.resetUiState,uo=zs.setActiveMarkupInkBrushId,ao=zs.setShowInkStylePicker,fo=Gs.reducer;function lo(e,t){if(t){switch(t){case"Crop":e.cropInteraction.mode=gr.none;e.cropInteraction.enableZoomToCrop=!0;e.view.enableZoomToView=!1;e.view.viewFitting.mode=yr.fitCropRectInView;break;case"Filter":case"Adjustment":e.cropInteraction.mode=gr.disabled;e.cropInteraction.enableZoomToCrop=!1;e.view.enableZoomToView=!0;break;case"Markup":e.cropInteraction.mode=gr.disabled;e.cropInteraction.enableZoomToCrop=!1;e.view.enableZoomToView=!1;e.view.viewFitting.mode=yr.fitCropRectInView}e.view.animateViewWhenViewportIsResized=!0}}function co(e,t){if(e.view.viewFitting.mode!==yr.fitCropRectInView){var n=t.direction,r=t.adjustmentCanvasShiftingValue,i=mn((function(e){switch(e){case Lr.Left:return{x:1,y:0};case Lr.Right:return{x:-1,y:0};case Lr.Down:return{x:0,y:-1};case Lr.Up:return{x:0,y:1};default:return{x:0,y:0}}})(n),r),s=Dn(i.x,i.y);e.view.worldToView=Pn(Jn(s,e.view.worldToView));e.animations.worldToView=ur();e.view.viewFitting.mode=yr.none;ys(e)}}var ho,po,vo,mo=ln({name:"transformToolsState",initialState:Nr,reducers:{setResolutionScaling:function(e,t){ci(e,t.payload)},handleImageTextureLoaded:function(e,t){Cs(e,t.payload)},setCanvasPixelSize:function(e,t){bi(e,t.payload.pixelSize,t.payload.cssSize)},handlePointerMove:function(e,t){Zi(e,t.payload)},adjustCropRect:function(e,t){gs(e,t.payload)},panView:function(e,t){co(e,t.payload)},setFocusedCropHandle:function(e,t){(function(e,t){var n=t.handlePosition,r=t.isKeyboardFocused;e.cropInteraction.focusedHandleIndex=n;e.cropInteraction.isKeyboardFocused=!!r})(e,t.payload)},handleMouseWheel:function(e,t){os(e,t.payload,t.telemetry)},handleMirrorXClick:function(e){var t=Fr(e.cropInteraction.uvToWorld).x;xi(e,Si(e.image._preciseUvToWorld,An,t))},handleMirrorYClick:function(e){var t=Fr(e.cropInteraction.uvToWorld).y;xi(e,Si(e.image._preciseUvToWorld,On,t))},setEdits:function(e,t){Os(e,t.payload)},setInitialEdits:function(e,t){(function(e,t){Os(e,t)})(e,t.payload)},setDefaultEdits:function(e,t){(function(e,t){var n=Tr();t.aspectRatioConstraint&&(n.cropInteraction.aspectRatioConstraint=t.aspectRatioConstraint);t.cropRectangle&&(n.cropInteraction.uvToWorld=Pr(t.cropRectangle));t.imageTransform&&(n.image._preciseUvToWorld=ks(t.imageTransform));e.defaults=n})(e,t.payload)},handleZoomChange:function(e,t){ss(e,t.payload,t.telemetry)},handleZoomDeltaChange:function(e,t){(function(e,t,n){if(e.cropInteraction.enableZoomToCrop)is(e,t,!0,n);else if(e.view.enableZoomToView){ss(e,Kn(e.view.worldToView)*(1-t))}})(e,t.payload,t.telemetry)},handleSetRotation:function(e,t){(function(e,t){Li(e,t-jn(e.image._preciseUvToWorld));ai(e)})(e,t.payload)},handleTouchDown:function(e,t){(function(e,t){e.view.allowDraggingView&&(e.cropInteraction.mode=gr.draggingView);e.pointer.movePos=t.center;e.pointer.imageUvGrabPosition=$i(t.center,e.view.worldToView,e.image._preciseUvToWorld);e.touch.downCenterPos=t.center;e.touch.scale=1;e.touch.isDown=!0})(e,t.payload)},handleTouchMove:function(e,t){(function(e,t,n){if(e.touch.isDown){var r=t.center,i=t.scale;if(e.cropInteraction.enableZoomToCrop&&Qi(e.touch.downCenterPos,e.view.worldToView,e.cropInteraction.uvToWorld)&&e.view.viewFitting.mode!==yr.none){var s=e.touch.scale-i;e.image._preciseUvToWorld=ts(e.view.worldToView,e.image._preciseUvToWorld,e.cropInteraction.uvToWorld,e.pointer.imageUvGrabPosition,r);is(e,s,!1,n);e.cropInteraction.mode=gr.draggingImage}else if(e.view.enableZoomToView){var o=i/e.touch.scale;e.view.worldToView=Vi(r,e.pointer.movePos,e.view.worldToView);rs(e,Kn(e.view.worldToView)*o,r,n).zoomIsMinimum&&ai(e);e.cropInteraction.mode=gr.draggingView}e.touch.scale=i;e.pointer.movePos=r}})(e,t.payload,t.telemetry)},handleTouchUp:function(e,t){(function(e,t){e.touch.isDown=!1})(e,t.payload)},recenterView:function(e,t){(function(e,t){e.view.viewFitting.mode=yr.fitCropRectInView;fi(e);t&&t.logRecenterEvent()})(e,t.telemetry)},setCropHandleSizeCss:function(e,t){(function(e,t){var n=t.handleSizeCss,r=t.handleHitAreaSizeCss;e.cropUiDisplay.handleSizeCss=n;e.cropUiDisplay.handleHitAreaSizeCss=r})(e,t.payload)},setCssToPhysicalPixelRatio:function(e,t){(function(e,t){e.device.pixelRatio=t})(e,t.payload)},setShouldConstrainCropInImage:function(e,t){(function(e,t){e.cropInteraction.shouldConstrainInImage=t;e.cropInteraction.shouldConstrainInImage&&Ni(e,ti(e.cropInteraction._uvToWorldBeforeRotate,e.image._preciseUvToWorld,e.cropInteraction.uvToWorld))})(e,t.payload)},handleFrameTick:function(e,t){mi(e,t.payload)},setViewFittingMode:function(e,t){(function(e,t){e.view.viewFitting.mode=t;fi(e)})(e,t.payload)},setViewFittingMarginCssPixels:function(e,t){(function(e,t,n){e.view.viewFitting.marginCssPixels=xs({},t);ai(e,n)})(e,t.payload.marginCssPixels,t.payload.shouldAnimate)},setAllowDraggingImageOutsideCropRect:function(e,t){(function(e,t){e.cropInteraction.allowDraggingImageOutsideRect=t})(e,t.payload)},setAllowDraggingView:function(e,t){(function(e,t){e.view.allowDraggingView=t})(e,t.payload)},setEnableZoomToView:function(e,t){(function(e,t){e.view.enableZoomToView=t})(e,t.payload)},setEnableZoomToCrop:function(e,t){(function(e,t){e.cropInteraction.enableZoomToCrop=t})(e,t.payload)},rotateCropAndImageBy90:function(e,t){Ii(e,t.payload)},startWindowSelectionMode:function(e){e.cropInteraction.mode=gr.selectingFirstCorner},handleRotationBarPointerUp:function(e,t){Ui(e,t.telemetry)},handleRotationBarPointerMove:function(e,t){Wi(e,t.payload)},handleRotationBarPointerDown:function(e,t){(function(e,t){var n=t.pointerPhysicalPixelPos,r=e.rotationUi.rotationBarPointer,i=e.device.pixelRatio;r.isDown=!0;r.movePos=Xi({},n);e.rotationUi.deadZoneCenterPos=qi(n,544*i,28,ji(jn(e.image._preciseUvToWorld)));e.cropInteraction.mode=gr.rotating;e.animations.needsFrameTick=!0;e.animations.gridLineVisibility=hr(8)})(e,t.payload)},adjustRotation:function(e,t){Ts(e,t.payload)},abortCurrentMode:function(e){if(e.cropInteraction.mode===gr.selectingFirstCorner||e.cropInteraction.mode===gr.selectingSecondCorner){e.cropInteraction.mode=wr;fi(e)}},setAspectRatioConstraint:function(e,t){Es(e,t.payload)},setSessionFullImageSize:function(e,t){(function(e,t){if(t){var n=Mn(t.x,t.y);Os(e,{imageTransform:Ls(n),cropRectangle:Hr(n),originalImageSize:t,aspectRatioConstraint:Ae.None})}})(e,t.payload)}},extraReducers:(Ws={},Ws[Hs.type]=function(e,t){us(e,t.payload)},Ws[Bs.type]=function(e,t){ws(e,t.payload.pointerId,t.telemetry)},Ws[to.type]=function(e,t){lo(e,t.payload)},Ws[so.type]=function(e,t){lo(e,t.payload.activeEditorActivity)},Ws[oo.type]=function(e,t){lo(e,Qs.activeEditorActivity)},Ws[Zs.type]=function(e){fi(e)},Ws[js.type]=function(e,t){(function(e,t){void 0===t&&(t=!1);Ss(e,t)})(e,t.payload)},Ws)}),go=(Xs=mo.actions).handleFrameTick,yo=Xs.setCanvasPixelSize,bo=(Xs.setResolutionScaling,Xs.handleImageTextureLoaded),wo=Xs.handlePointerMove,Eo=Xs.handleMouseWheel,So=Xs.handleMirrorXClick,xo=Xs.handleMirrorYClick,To=Xs.setEdits,No=Xs.setInitialEdits,Co=Xs.setDefaultEdits,ko=(Xs.handleZoomChange,Xs.handleZoomDeltaChange),Lo=(Xs.handleSetRotation,Xs.handleTouchDown),Ao=Xs.handleTouchMove,Oo=Xs.handleTouchUp,Mo=Xs.recenterView,_o=Xs.setCropHandleSizeCss,Do=Xs.setCssToPhysicalPixelRatio,Po=(Xs.setShouldConstrainCropInImage,Xs.setViewFittingMode,Xs.setViewFittingMarginCssPixels),Ho=(Xs.setAllowDraggingImageOutsideCropRect,Xs.setAllowDraggingView,Xs.setEnableZoomToView,Xs.setEnableZoomToCrop,Xs.rotateCropAndImageBy90),Bo=(Xs.startWindowSelectionMode,Xs.handleRotationBarPointerUp),jo=Xs.handleRotationBarPointerMove,Fo=Xs.handleRotationBarPointerDown,Io=Xs.abortCurrentMode,qo=Xs.setAspectRatioConstraint,Ro=Xs.adjustCropRect,Uo=Xs.adjustRotation,zo=Xs.setFocusedCropHandle,Wo=Xs.panView,Xo=Xs.setSessionFullImageSize,Vo=mo.reducer,$o={sliderMinValue:-100,sliderMaxValue:100,sliderStepValue:1,sliderValueFormat:function(e){return e.toFixed(0)},sliderDeadZoneOffset:4},Jo=$o,Ko=$o,Qo=$o,Go=$o,Yo=$o,Zo=$o,eu=$o,tu=$o,nu=$o;(function(e){e.Brightness="brightness";e.Exposure="exposure";e.Contrast="contrast";e.Highlights="highlights";e.Shadows="shadows";e.Saturation="saturation";e.Temperature="temperature";e.Tint="tint";e.Vignette="vignette"})(vo||(vo={}));var ru=((ho={})[vo.Exposure]="Exposure-Havana",ho[vo.Brightness]="Brightness-Havana",ho[vo.Contrast]="Contrast-Havana",ho[vo.Highlights]="Highlights-Havana",ho[vo.Shadows]="Shadows-Havana",ho[vo.Saturation]="Saturation-Havana",ho[vo.Temperature]="Temperature-Havana",ho[vo.Tint]="Tint-Havana",ho[vo.Vignette]="Vignette-Havana",ho),iu=((po={})[vo.Exposure]=Ko,po[vo.Brightness]=Jo,po[vo.Contrast]=Go,po[vo.Highlights]=eu,po[vo.Shadows]=tu,po[vo.Saturation]=Qo,po[vo.Temperature]=Zo,po[vo.Tint]=Yo,po[vo.Vignette]=nu,po);function su(e){return ru[e]}var ou={brightness:.5,exposure:.5,tint:.5,temperature:.5,saturation:.5,highlights:.5,shadows:.5,vibrance:.5,vignette:.5,contrast:.5,version:Oe.Latest},uu=function(){return(uu=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)};var au,fu,lu=function(){return(lu=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)},cu=ln({name:"colorAdjustments",initialState:ou,reducers:{setBrightness:function(e,t){e.brightness=t.payload},setExposure:function(e,t){e.exposure=t.payload},setTint:function(e,t){e.tint=t.payload},setTemperature:function(e,t){e.temperature=t.payload},setSaturation:function(e,t){e.saturation=t.payload},setHighlights:function(e,t){e.highlights=t.payload},setShadows:function(e,t){e.shadows=t.payload},setVibrance:function(e,t){e.vibrance=t.payload},setContrast:function(e,t){e.contrast=t.payload},setVignette:function(e,t){e.vignette=t.payload},setAllAdjustments:function(e,t){return(function(e,t){return t?uu(uu({},e),t):e})(e,t.payload)},setAdjustmentVersion:function(e,t){e.version=t.payload}},extraReducers:(au={},au[js.type]=function(e,t){return lu({},ou)},au)}),hu=(fu=cu.actions).setBrightness,pu=fu.setExposure,du=fu.setTemperature,vu=fu.setTint,mu=fu.setSaturation,gu=fu.setHighlights,yu=fu.setShadows,bu=(fu.setVibrance,fu.setContrast),wu=fu.setVignette,Eu=fu.setAllAdjustments,Su=(fu.setAdjustmentVersion,cu.reducer),xu=function(){return(xu=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)};function Tu(e){return e&&"object"==typeof e&&!Array.isArray(e)}function Nu(e,t){var n=xu(xu({},e),t);Tu(e)&&Tu(t)&&Object.keys(t).forEach(function(r){var i;if(!(r in e))throw new Error("override object has a key that does not exist in base object: "+r);if(t[r]&&e[r]&&typeof t[r]!=typeof e[r])throw new Error("override object value at key: '"+r+"' type does not match base object type at key:'"+r+"'");Tu(t[r])?n[r]=Nu(e[r],t[r]):Object.assign(n,((i={})[r]=t[r],i))});return n}var Cu,ku=Object.freeze({width:0,height:0}),Lu={ariaAnnouncementMessage:void 0,ariaAnnouncementScenario:void 0};function Au(e,t){e.ariaAnnouncementMessage=(function(e,t){if(e===t)return t+"​";return t})(e.ariaAnnouncementMessage,t)}var Ou,Mu=ln({name:"AriaAnnouncementState",initialState:Lu,reducers:{setAriaAnnouncement:function(e,t){Au(e,t.payload)},setAriaAnnouncementScenario:function(e,t){(function(e,t){e.ariaAnnouncementScenario=t})(e,t.payload)}}}),_u=(Cu=Mu.actions).setAriaAnnouncement,Du=Cu.setAriaAnnouncementScenario,Pu=Mu.reducer;(function(e){e[e.InkContent=0]="InkContent";e[e.TextContent=1]="TextContent"})(Ou||(Ou={}));var Hu=0;function Bu(){return Hu++}var ju,Fu,Iu=function(){return(Iu=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)};function qu(e){var t=Bu();return Iu(Iu({},e),{id:t})}var Ru,Uu,zu={inkBrushes:Vs,markupContentItems:[],activeMarkupToolType:"Pen"},Wu=ln({name:"MarkupSlice",initialState:zu,reducers:{setInkBrushes:function(e,t){e.inkBrushes=t.payload},setInkBrush:function(e,t){(function(e,t,n){e.inkBrushes[n]=t})(e,t.payload.inkBrush,t.payload.id);var n=t.payload.inkBrush,r=n.htmlColor,i=n.inkType,s=n.thicknessInCssPixels;t.telemetry&&t.telemetry.logInkBrushUpdateEvent({color:r,inkType:i,thicknessInCssPixels:s})},addMarkupContent:{reducer:function(e,t){e.markupContentItems.push(t.payload)},prepare:function(e){return{payload:qu(e)}}},removeMarkupContent:function(e,t){var n=new Set(t.payload);e.markupContentItems=e.markupContentItems.filter(function(e){return!n.has(e.id)})},clearAllInkContent:function(e,t){var n=e.markupContentItems.length;e.markupContentItems=e.markupContentItems.filter(function(e){return e.contentType!==Ou.InkContent});var r=n-e.markupContentItems.length;t.telemetry&&t.telemetry.logClearAllInkStrokesEvent({numberOfInkStrokesRemoved:r})},setActiveMarkupToolType:function(e,t){e.activeMarkupToolType=t.payload;t.telemetry&&t.telemetry.logMarkupToolSelectEvent({activeMarkupToolType:t.payload})},setActiveMarkupToolTypeWithoutTelemetry:function(e,t){e.activeMarkupToolType=t.payload}},extraReducers:(ju={},ju[js.type]=function(e,t){e.markupContentItems=zu.markupContentItems},ju[To.type]=function(e,t){var n=t.payload.markupContentItems;n&&(e.markupContentItems=n.map(qu))},ju)}),Xu=(Fu=Wu.actions).setInkBrushes,Vu=Fu.setInkBrush,$u=Fu.setActiveMarkupToolType,Ju=Fu.setActiveMarkupToolTypeWithoutTelemetry,Ku=Fu.addMarkupContent,Qu=Fu.removeMarkupContent,Gu=Fu.clearAllInkContent,Yu=Wu.reducer,Zu={autoEnhanceLevel:0,autoEnhanceStatus:"off"},ea={autoEnhanceLevel:.5,autoEnhanceStatus:"off"},ta=ln({name:"autoEnhance",initialState:ea,reducers:{setValue:function(e,t){e.autoEnhanceLevel=t.payload},setAutoEnhanceStatus:function(e,t){e.autoEnhanceStatus=t.payload}},extraReducers:(Ru={},Ru[js.type]=function(e,t){e.autoEnhanceLevel=ea.autoEnhanceLevel;e.autoEnhanceStatus=ea.autoEnhanceStatus},Ru)}),na=(Uu=ta.actions).setValue,ra=Uu.setAutoEnhanceStatus,ia=ta.reducer,sa=(function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){e(t,n);function r(){this.constructor=t}t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}})(),oa=(function(e){sa(t,e);function t(t){return e.call(this,"Unhandled value: "+t)||this}return t})(Error);function ua(e){switch(e){case _s.Highlighter:return"Highlighter";case _s.Pen:return"Pen";default:throw new oa(e)}}var aa=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),i=0;for(t=0;t<n;t++)for(var s=arguments[t],o=0,u=s.length;o<u;o++,i++)r[i]=s[o];return r};var fa={markup_inkToolbarPenTooltip:"Pen",markup_inkToolbarPenAriaLabel:"Pen",markup_inkToolbarPenAriaDescription:"Select and drag on image to add an ink stroke. Select this button again to change ink properties.",markup_inkToolbarEraserTooltip:"Remove ink strokes",markup_inkToolbarEraserAriaLabel:"Remove ink strokes",markup_inkToolbarEraserAriaDescription:"Select and drag over ink to remove ink strokes.",markup_inkToolbarHighlighterTooltip:"Highlighter",markup_inkToolbarHighlighterAriaLabel:"Highlighter",markup_inkToolbarHighlighterAriaDescription:"Select and drag on image to add an ink stroke. Select this button again to change ink properties.",markup_inkToolbarClearAllInkTooltip:"Clear all ink strokes",markup_inkToolbarClearAllInkAriaLabel:"Clear all ink strokes",markup_inkToolbarThickness:"Thickness",markup_clearAllInkDialogCloseButtonAriaLabel:"Close",markup_clearAllInkDialogTitle:"Clear all ink strokes?",markup_clearAllInkDialogSubText:"All ink strokes applied to the image will be permanently removed.",markup_clearAllInkDialogConfirmButtonText:"Confirm",markup_clearAllInkDialogConfirmButtonAriaLabel:"Confirm",markup_clearAllInkDialogCancelButtonText:"Cancel",markup_clearAllInkDialogCancelButtonAriaLabel:"Cancel",markup_inkToolbarBrushFormatString:"{0}: {1}, {2}: {3}",markup_inkToolbarTooltipChangeInkProperties:"Select again to change ink properties.",markup_inkThicknessSliderHeaderLabel:"Stroke Thickness",markup_inkThicknessSliderAriaLabel:"Slider to pick the thickness of the selected brush.",markup_addedInkStrokeAriaLive:"Added an ink stroke to image, {0}, {1}, thickness {2}",markup_removedInkStrokesAriaLive:"Removed {0} out of {1} ink strokes",markup_clearedAllInkStrokesAriaLive:"Cleared all ink strokes",markup_inkPenThicknessSliderAriaLabel:"Slider to adjust pen thickness.",markup_inkHighlighterThicknessSliderAriaLabel:"Slider to adjust highlighter thickness.",markup_inkToolbarAriaLandmark:"Markup Toolbar",markup_colorDarkYellow:"Dark Yellow",markup_colorLightOrange:"Light Orange",markup_colorOrange:"Orange",markup_colorRed:"Red",markup_colorDarkPurple:"Dark Purple",markup_colorPurple:"Purple",markup_colorMagenta:"Magenta",markup_colorDarkRed:"Dark Red",markup_colorLightBlue:"Light Blue",markup_colorBlue:"Blue",markup_colorDarkBlue:"Dark Blue",markup_colorLightGreen:"Light Green",markup_colorGreen:"Green",markup_colorLightGray:"Light Gray",markup_colorGray:"Gray",markup_colorBlack:"Black"},la=n(4422),ca=48,ha=56,pa=Object(i.memo)(function(e){var t=e.styles,n=Object(la.e)("EraserIcon"),r=Object(la.e)("EraserIcon"),i=Object(la.e)("EraserIcon"),o=Object(la.e)("EraserIcon"),u=Object(la.e)("EraserIcon"),a=Object(la.e)("EraserIcon"),f=Object(la.e)("EraserIcon"),l=Object(la.e)("EraserIcon"),c=Object(la.e)("EraserIcon"),h=Object(la.e)("EraserIcon"),p=Object(la.e)("EraserIcon");return s.a.createElement("svg",{className:"inkTool",width:ca+"px",height:ha+"px",viewBox:"0 0 96 108",fill:"none",style:t},s.a.createElement("g",{clipPath:"url(#"+p+")"},s.a.createElement("g",{opacity:"0.3",filter:"url(#"+n+")"},s.a.createElement("path",{d:"M69.2524 93V39H26.0524V93H69.2524Z",fill:"black"})),s.a.createElement("path",{d:"M71.6523 117V29.4C71.6523 26.749 69.5033 24.6 66.8523 24.6H28.4523C25.8014 24.6 23.6523 26.749 23.6523 29.4V117H71.6523Z",fill:"url(#"+f+")"}),s.a.createElement("path",{d:"M71.6523 117V29.4C71.6523 26.749 69.5033 24.6 66.8523 24.6H28.4523C25.8014 24.6 23.6523 26.749 23.6523 29.4V117H71.6523Z",fill:"url(#"+l+")"}),s.a.createElement("g",{opacity:"0.3",filter:"url(#"+r+")"},s.a.createElement("path",{d:"M71.6523 117V29.4C71.6523 26.749 69.5033 24.6 66.8523 24.6H28.4523C25.8014 24.6 23.6523 26.749 23.6523 29.4V117H71.6523Z",fill:"black",fillOpacity:"0.01"})),s.a.createElement("g",{filter:"url(#"+i+")"},s.a.createElement("path",{d:"M71.6523 117V29.4C71.6523 26.749 69.5033 24.6 66.8523 24.6H28.4523C25.8014 24.6 23.6523 26.749 23.6523 29.4V117H71.6523Z",fill:"black",fillOpacity:"0.01"})),s.a.createElement("g",{filter:"url(#"+o+")"},s.a.createElement("path",{d:"M71.6523 117V29.4C71.6523 26.749 69.5033 24.6 66.8523 24.6H28.4523C25.8014 24.6 23.6523 26.749 23.6523 29.4V117H71.6523Z",fill:"black",fillOpacity:"0.01"})),s.a.createElement("path",{opacity:"0.08",d:"M23.6523 29.4C23.6523 26.749 25.8014 24.6 28.4523 24.6H66.8523C69.5033 24.6 71.6523 26.749 71.6523 29.4V53.4H23.6523V29.4Z",fill:"black"}),s.a.createElement("path",{d:"M28.4523 12.6C28.4523 7.29807 32.7504 3 38.0523 3H57.2523C62.5543 3 66.8523 7.29807 66.8523 12.6V24.6H28.4523V12.6Z",fill:"url(#"+c+")"}),s.a.createElement("path",{d:"M28.7523 12.6C28.7523 7.46376 32.9161 3.3 38.0523 3.3H57.2523C62.3886 3.3 66.5523 7.46375 66.5523 12.6V24.3H28.7523V12.6Z",stroke:"url(#"+h+")",strokeOpacity:"0.16",strokeWidth:"0.6"}),s.a.createElement("g",{opacity:"0.6",filter:"url(#"+u+")"},s.a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M57.2524 10.8H42.8524V7.19998H57.2524C60.8974 7.19998 63.8523 10.1549 63.8523 13.8V24.6H60.2523V13.8C60.2523 12.1431 58.9092 10.8 57.2524 10.8Z",fill:"white"})),s.a.createElement("path",{opacity:"0.12",fillRule:"evenodd",clipRule:"evenodd",d:"M71.6523 54.6H23.6523V53.4H71.6523V54.6Z",fill:"white"}),s.a.createElement("g",{opacity:"0.1",filter:"url(#"+a+")"},s.a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M55.818 111V36.6H58.218V111H55.818Z",fill:"white"}))),s.a.createElement("defs",null,s.a.createElement("filter",{id:n,x:"18.8524",y:"31.8",width:"57.6",height:"68.4",filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},s.a.createElement("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),s.a.createElement("feBlend",{mode:"normal",in:"SourceGraphic",in2:"BackgroundImageFix",result:"shape"}),s.a.createElement("feGaussianBlur",{stdDeviation:"3.6",result:"effect1_foregroundBlur"})),s.a.createElement("filter",{id:r,x:"23.6523",y:"24.6",width:"56.4",height:"92.4",filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},s.a.createElement("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),s.a.createElement("feBlend",{mode:"normal",in:"SourceGraphic",in2:"BackgroundImageFix",result:"shape"}),s.a.createElement("feColorMatrix",{in:"SourceAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),s.a.createElement("feOffset",{dx:"8.4"}),s.a.createElement("feGaussianBlur",{stdDeviation:"4.8"}),s.a.createElement("feComposite",{in2:"hardAlpha",operator:"arithmetic",k2:"-1",k3:"1"}),s.a.createElement("feColorMatrix",{type:"matrix",values:"0 0 0 0 0.2 0 0 0 0 0.2 0 0 0 0 0.2 0 0 0 1 0"}),s.a.createElement("feBlend",{mode:"normal",in2:"shape",result:"effect1_innerShadow"})),s.a.createElement("filter",{id:i,x:"23.6523",y:"24.6",width:"50.4",height:"92.4",filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},s.a.createElement("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),s.a.createElement("feBlend",{mode:"normal",in:"SourceGraphic",in2:"BackgroundImageFix",result:"shape"}),s.a.createElement("feColorMatrix",{in:"SourceAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),s.a.createElement("feOffset",{dx:"2.4"}),s.a.createElement("feGaussianBlur",{stdDeviation:"3.6"}),s.a.createElement("feComposite",{in2:"hardAlpha",operator:"arithmetic",k2:"-1",k3:"1"}),s.a.createElement("feColorMatrix",{type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.225634 0"}),s.a.createElement("feBlend",{mode:"normal",in2:"shape",result:"effect1_innerShadow"})),s.a.createElement("filter",{id:o,x:"23.6523",y:"24.6",width:"49.2",height:"92.4",filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},s.a.createElement("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),s.a.createElement("feBlend",{mode:"normal",in:"SourceGraphic",in2:"BackgroundImageFix",result:"shape"}),s.a.createElement("feColorMatrix",{in:"SourceAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),s.a.createElement("feOffset",{dx:"1.2"}),s.a.createElement("feGaussianBlur",{stdDeviation:"4.2"}),s.a.createElement("feComposite",{in2:"hardAlpha",operator:"arithmetic",k2:"-1",k3:"1"}),s.a.createElement("feColorMatrix",{type:"matrix",values:"0 0 0 0 1 0 0 0 0 1 0 0 0 0 1 0 0 0 0.1 0"}),s.a.createElement("feBlend",{mode:"normal",in2:"shape",result:"effect1_innerShadow"})),s.a.createElement("filter",{id:u,x:"30.8524",y:"-4.80002",width:"45",height:"41.4",filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},s.a.createElement("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),s.a.createElement("feBlend",{mode:"normal",in:"SourceGraphic",in2:"BackgroundImageFix",result:"shape"}),s.a.createElement("feGaussianBlur",{stdDeviation:"6",result:"effect1_foregroundBlur"})),s.a.createElement("filter",{id:a,x:"46.218",y:"27",width:"21.6",height:"93.6",filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},s.a.createElement("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),s.a.createElement("feBlend",{mode:"normal",in:"SourceGraphic",in2:"BackgroundImageFix",result:"shape"}),s.a.createElement("feGaussianBlur",{stdDeviation:"4.8",result:"effect1_foregroundBlur"})),s.a.createElement("linearGradient",{id:f,x1:"27.2523",y1:"39.6",x2:"71.191",y2:"44.1024",gradientUnits:"userSpaceOnUse"},s.a.createElement("stop",{stopColor:"#333333"}),s.a.createElement("stop",{offset:"0.792969",stopColor:"#605A5D"})),s.a.createElement("linearGradient",{id:l,x1:"28.4523",y1:"45.6",x2:"47.4937",y2:"47.3382",gradientUnits:"userSpaceOnUse"},s.a.createElement("stop",{stopColor:"#333333"}),s.a.createElement("stop",{offset:"1",stopColor:"#605A5D",stopOpacity:"0"})),s.a.createElement("linearGradient",{id:c,x1:"47.6523",y1:"3",x2:"47.6523",y2:"24.6",gradientUnits:"userSpaceOnUse"},s.a.createElement("stop",{stopColor:"#EA9FAA"}),s.a.createElement("stop",{offset:"1",stopColor:"#FA7E90"})),s.a.createElement("linearGradient",{id:h,x1:"47.6523",y1:"3",x2:"47.6523",y2:"24.6",gradientUnits:"userSpaceOnUse"},s.a.createElement("stop",{stopColor:"white"}),s.a.createElement("stop",{offset:"1",stopColor:"white",stopOpacity:"0"})),s.a.createElement("clipPath",{id:p},s.a.createElement("rect",{width:"96",height:"126",fill:"white",transform:"translate(-0.347656 -9)"}))))}),da=Object(i.memo)(function(e){var t=e.styles,n=e.inkBrushColor,r=Object(la.e)("InkPenIcon"),i=Object(la.e)("InkPenIcon"),o=Object(la.e)("InkPenIcon"),u=Object(la.e)("InkPenIcon"),a=Object(la.e)("InkPenIcon"),f=Object(la.e)("InkPenIcon"),l=Object(la.e)("InkPenIcon");return s.a.createElement("svg",{className:"inkTool",width:ca+"px",height:ha+"px",viewBox:"0 0 96 108",fill:"none",style:t},s.a.createElement("g",{clipPath:"url(#"+r+")"},s.a.createElement("g",{opacity:"0.4",filter:"url(#"+i+")"},s.a.createElement("path",{d:"M69.6 116V60.8H26.4V116H69.6Z",fill:"black"})),s.a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M48.0003 3.1998C43.5003 3.1998 40.8003 17.5998 40.8003 17.5998H55.2003C55.2003 17.5998 52.5003 3.1998 48.0003 3.1998ZM25.9449 60.7998H70.0551C71.346 68.851 72 77.0143 72 85.2142V116H24V85.2142C24 77.0143 24.6539 68.851 25.9449 60.7998Z",fill:n}),s.a.createElement("path",{d:"M41.5543 17.6H54.4456C55.6388 17.6 56.725 18.2883 57.2345 19.3672C63.456 32.5422 67.7611 46.4942 70.055 60.8H25.9449C28.2388 46.4942 32.5439 32.5422 38.7654 19.3672C39.2749 18.2882 40.3611 17.6 41.5543 17.6Z",fill:"url(#"+u+")"}),s.a.createElement("path",{d:"M41.5543 17.6H54.4456C55.6388 17.6 56.725 18.2883 57.2345 19.3672C63.456 32.5422 67.7611 46.4942 70.055 60.8H25.9449C28.2388 46.4942 32.5439 32.5422 38.7654 19.3672C39.2749 18.2882 40.3611 17.6 41.5543 17.6Z",fill:"url(#"+a+")"}),s.a.createElement("path",{opacity:"0.2",d:"M70.0551 60.8L25.9449 60.8C24.6539 68.8512 24 77.0145 24 85.2144V116H72V85.2144C72 77.0145 71.346 68.8512 70.0551 60.8Z",fill:"url(#"+f+")"}),s.a.createElement("path",{opacity:"0.12",d:"M25.9448 60.8H70.0549C70.119 61.1997 70.1815 61.5997 70.2425 62H25.7572C25.8182 61.5997 25.8807 61.1997 25.9448 60.8Z",fill:"white"}),s.a.createElement("path",{opacity:"0.32",d:"M40.8 17.6C40.8 17.6 43.5 3.2 48 3.2C52.5 3.2 55.2 17.6 55.2 17.6H40.8Z",fill:"url(#"+l+")"}),s.a.createElement("g",{opacity:"0.4",filter:"url(#"+o+")"},s.a.createElement("path",{d:"M49.1994 21.2C49.1994 21.2 61.8773 51.2 61.8773 72.5941C61.8773 78.807 61.8773 126.104 61.8773 126.104",stroke:"white",strokeWidth:"1.2"}))),s.a.createElement("defs",null,s.a.createElement("filter",{id:i,x:"19.2",y:"53.6",width:"57.6",height:"69.6",filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},s.a.createElement("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),s.a.createElement("feBlend",{mode:"normal",in:"SourceGraphic",in2:"BackgroundImageFix",result:"shape"}),s.a.createElement("feGaussianBlur",{stdDeviation:"3.6",result:"effect1_foregroundBlur"})),s.a.createElement("filter",{id:o,x:"41.4468",y:"13.7669",width:"28.2305",height:"119.537",filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},s.a.createElement("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),s.a.createElement("feBlend",{mode:"normal",in:"SourceGraphic",in2:"BackgroundImageFix",result:"shape"}),s.a.createElement("feGaussianBlur",{stdDeviation:"3.6",result:"effect1_foregroundBlur"})),s.a.createElement("linearGradient",{id:u,x1:"27.6002",y1:"35.6",x2:"70.8002",y2:"48.8",gradientUnits:"userSpaceOnUse"},s.a.createElement("stop",{stopColor:"#333333"}),s.a.createElement("stop",{offset:"0.792969",stopColor:"#605A5D"})),s.a.createElement("linearGradient",{id:a,x1:"28.8002",y1:"42.8",x2:"46.8002",y2:"47.6",gradientUnits:"userSpaceOnUse"},s.a.createElement("stop",{stopColor:"#333333"}),s.a.createElement("stop",{offset:"1",stopColor:"#605A5D",stopOpacity:"0"})),s.a.createElement("linearGradient",{id:f,x1:"24",y1:"70.4",x2:"58.8",y2:"70.4",gradientUnits:"userSpaceOnUse"},s.a.createElement("stop",null),s.a.createElement("stop",{offset:"1",stopOpacity:"0"})),s.a.createElement("linearGradient",{id:l,x1:"56",y1:"3.2",x2:"48",y2:"17.6",gradientUnits:"userSpaceOnUse"},s.a.createElement("stop",{stopColor:"white"}),s.a.createElement("stop",{offset:"1",stopColor:"white",stopOpacity:"0"})),s.a.createElement("clipPath",{id:r},s.a.createElement("rect",{width:"96",height:"120",fill:"white"}))))}),va=Object(i.memo)(function(e){var t=e.styles,n=e.inkBrushColor,r="HighlighterIcon",i=Object(la.e)(r),o=Object(la.e)(r),u=Object(la.e)(r),a=Object(la.e)(r),f=Object(la.e)(r),l=Object(la.e)(r),c=Object(la.e)(r),h=Object(la.e)(r),p=Object(la.e)(r),d=Object(la.e)(r);return s.a.createElement("svg",{className:"inkTool",width:ca+"px",height:ha+"px",viewBox:"0 0 96 108",fill:"none",style:t},s.a.createElement("g",{clipPath:"url(#"+i+")"},s.a.createElement("g",{opacity:"0.4",filter:"url(#"+o+")"},s.a.createElement("path",{d:"M76.8 117V59.4H19.2V117H76.8Z",fill:"black"})),s.a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M28.8 42.6L30.7255 25.2699C30.9956 22.8391 33.0504 21 35.4962 21H60.5038C62.9496 21 65.0043 22.8391 65.2744 25.2699L67.2 42.6L73.7956 47.8765C77.2115 50.6092 79.2 54.7465 79.2 59.121V95.4H16.8V59.121C16.8 54.7465 18.7885 50.6092 22.2044 47.8765L28.8 42.6Z",fill:"url(#"+f+")"}),s.a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M28.8 42.6L30.7255 25.2699C30.9956 22.8391 33.0504 21 35.4962 21H60.5038C62.9496 21 65.0043 22.8391 65.2744 25.2699L67.2 42.6L73.7956 47.8765C77.2115 50.6092 79.2 54.7465 79.2 59.121V95.4H16.8V59.121C16.8 54.7465 18.7885 50.6092 22.2044 47.8765L28.8 42.6Z",fill:"url(#"+l+")"}),s.a.createElement("g",{opacity:"0.2",filter:"url(#"+u+")"},s.a.createElement("path",{d:"M55.2002 27L60.2197 57.3868L73.2 63V117",stroke:"white",strokeWidth:"1.2"})),s.a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M36 21.0002V12.6002C36 11.062 36.9773 9.6937 38.4324 9.19482L56.8216 2.88996C58.3794 2.35587 60 3.51345 60 5.16022V21.0002H36ZM79.2 61.8002H16.8V117H79.2V61.8002Z",fill:n}),s.a.createElement("rect",{opacity:"0.2",x:"16.8",y:"61.8",width:"26.4",height:"55.2",fill:"url(#"+c+")"}),s.a.createElement("rect",{opacity:"0.06",width:"26.4",height:"55.2",transform:"matrix(-1 0 0 1 79.2 61.8)",fill:"url(#"+h+")"}),s.a.createElement("path",{opacity:"0.3",d:"M36 12.6V21H60V5.15999C60 3.51321 58.3794 2.35563 56.8216 2.88972L38.4324 9.19458C36.9773 9.69347 36 11.0618 36 12.6Z",fill:"url(#"+p+")"}),s.a.createElement("path",{d:"M59.7 20.7H36.3V12.6C36.3 11.1899 37.1959 9.93568 38.5297 9.47837L56.9189 3.1735C58.282 2.70617 59.7 3.71906 59.7 5.15999V20.7Z",stroke:"url(#"+d+")",strokeOpacity:"0.3",strokeWidth:"0.6"}),s.a.createElement("g",{opacity:"0.4",filter:"url(#"+a+")"},s.a.createElement("path",{d:"M73.2 117V59.4",stroke:"white",strokeWidth:"1.2"})),s.a.createElement("line",{opacity:"0.12",x1:"16.8",y1:"62.4",x2:"79.2",y2:"62.4",stroke:"white",strokeWidth:"1.2"})),s.a.createElement("defs",null,s.a.createElement("filter",{id:o,x:"12",y:"52.2",width:"72",height:"72",filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},s.a.createElement("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),s.a.createElement("feBlend",{mode:"normal",in:"SourceGraphic",in2:"BackgroundImageFix",result:"shape"}),s.a.createElement("feGaussianBlur",{stdDeviation:"3.6",result:"effect1_foregroundBlur"})),s.a.createElement("filter",{id:u,x:"47.4082",y:"19.7022",width:"33.5918",height:"104.498",filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},s.a.createElement("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),s.a.createElement("feBlend",{mode:"normal",in:"SourceGraphic",in2:"BackgroundImageFix",result:"shape"}),s.a.createElement("feGaussianBlur",{stdDeviation:"3.6",result:"effect1_foregroundBlur"})),s.a.createElement("filter",{id:a,x:"63",y:"49.8",width:"20.4",height:"76.8",filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},s.a.createElement("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),s.a.createElement("feBlend",{mode:"normal",in:"SourceGraphic",in2:"BackgroundImageFix",result:"shape"}),s.a.createElement("feGaussianBlur",{stdDeviation:"4.8",result:"effect1_foregroundBlur"})),s.a.createElement("linearGradient",{id:f,x1:"17.4",y1:"36.5",x2:"72.6093",y2:"65.8856",gradientUnits:"userSpaceOnUse"},s.a.createElement("stop",{stopColor:"#333333"}),s.a.createElement("stop",{offset:"0.792969",stopColor:"#605A5D"})),s.a.createElement("linearGradient",{id:l,x1:"19.2",y1:"42.7",x2:"44.1733",y2:"55.8611",gradientUnits:"userSpaceOnUse"},s.a.createElement("stop",{stopColor:"#333333"}),s.a.createElement("stop",{offset:"1",stopColor:"#605A5D",stopOpacity:"0"})),s.a.createElement("linearGradient",{id:c,x1:"16.8",y1:"78.7846",x2:"35.94",y2:"78.7846",gradientUnits:"userSpaceOnUse"},s.a.createElement("stop",null),s.a.createElement("stop",{offset:"1",stopOpacity:"0"})),s.a.createElement("linearGradient",{id:h,x1:"-9.02706e-08",y1:"16.9846",x2:"19.14",y2:"16.9846",gradientUnits:"userSpaceOnUse"},s.a.createElement("stop",null),s.a.createElement("stop",{offset:"1",stopOpacity:"0"})),s.a.createElement("linearGradient",{id:p,x1:"44.9143",y1:"-1.25961",x2:"47.3195",y2:"23.1916",gradientUnits:"userSpaceOnUse"},s.a.createElement("stop",null),s.a.createElement("stop",{offset:"1",stopColor:"white",stopOpacity:"0"})),s.a.createElement("linearGradient",{id:d,x1:"48",y1:"-1.25961",x2:"48",y2:"18.774",gradientUnits:"userSpaceOnUse"},s.a.createElement("stop",{stopColor:"white"}),s.a.createElement("stop",{offset:"1",stopColor:"white",stopOpacity:"0"})),s.a.createElement("clipPath",{id:i},s.a.createElement("rect",{width:"96",height:"120",fill:"white",transform:"translate(0 -3)"}))))}),ma=n(1155),ga=n(334),ya=i.createContext(void 0);var ba=function(){var e=Object(i.useContext)(ya),t=Object(ma.e)(["theme"]).theme;return e||t||Object(ga.e)({})},wa=n(24),Ea=Object(i.memo)(function(e){var t=e.enabled,n=e.enabledColor,r=e.disabledColor,i=e.styles,o=ba(),u=null!=n?n:o.palette.black,a=null!=r?r:o.palette.neutralTertiary,f=Object(wa.F)({fill:t?u:a});return s.a.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"none",style:i},s.a.createElement("g",{className:f},s.a.createElement("path",{d:"M2 6.75C2 5.23122 3.23122 4 4.75 4L19.25 4C20.7688 4 22 5.23122 22 6.75V12.5356L21.1991 11.7347C20.9899 11.5255 20.7529 11.3612 20.5 11.2416V6.75C20.5 6.05964 19.9404 5.5 19.25 5.5L4.75 5.5C4.05964 5.5 3.5 6.05964 3.5 6.75L3.5 17.25C3.5 17.9404 4.05964 18.5 4.75 18.5H12.0149C12.0319 19.0338 12.2189 19.5632 12.576 20H4.75C3.23122 20 2 18.7688 2 17.25L2 6.75Z"}),s.a.createElement("path",{d:"M20.4919 12.4418C19.9062 11.856 18.9564 11.856 18.3706 12.4417L15.26 15.5524L19.4671 19.7595L22.5777 16.6489C23.1635 16.0631 23.1635 15.1133 22.5777 14.5275L20.4919 12.4418Z"}),s.a.createElement("path",{d:"M13.453 17.3593L14.5529 16.2595L18.76 20.4666L17.6601 21.5665C17.0743 22.1522 16.1246 22.1522 15.5388 21.5665L13.453 19.4807C12.8672 18.8949 12.8672 17.9451 13.453 17.3593Z"})))}),Sa=function(){return(Sa=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)},xa={activeInkBrushId:"pen1",brushes:[{inkBrushId:"pen1",getIcon:function(e){var t;return s.a.createElement(da,{styles:null==e?void 0:e.styles,inkBrushColor:null!==(t=null==e?void 0:e.inkBrushColor)&&void 0!==t?t:Vs.pen1.htmlColor})}},{inkBrushId:"pen2",getIcon:function(e){var t;return s.a.createElement(da,{styles:null==e?void 0:e.styles,inkBrushColor:null!==(t=null==e?void 0:e.inkBrushColor)&&void 0!==t?t:Vs.pen2.htmlColor})}},{inkBrushId:"highlighter",getIcon:function(e){var t;return s.a.createElement(va,{styles:null==e?void 0:e.styles,inkBrushColor:null!==(t=null==e?void 0:e.inkBrushColor)&&void 0!==t?t:Vs.highlighter.htmlColor})}}],eraser:{getIcon:function(e){return s.a.createElement(pa,{styles:null==e?void 0:e.styles})}},clearInk:{getIcon:function(e){return s.a.createElement(Ea,Sa({},e))}}},Ta=function(){throw new Error("Error: Components must be wrapped in a MarkupProvider")},Na={};var Ca=Object(i.createContext)({enableMarkup:!1,Canvas:Ta,canvasMethods:Na,setCanvasMethods:function(){},InkCanvasInteraction:Ta,inkConfigurations:{Pen:{cssThicknesses:[1,2,3,4,5,6],minSliderValue:1},Highlighter:{cssThicknesses:[1,2,3,4,5,6],minSliderValue:1}},localizationStrings:fa,scriptsToLoadJSBundles:[],inkBrushConfigurations:xa});function ka(e,t){var n=Object(i.useRef)(e);n.current!==e&&t&&t(n.current,e);return n.current}var La=["pen1","pen2","highlighter"];function Aa(e){var t=Se(),n=ka(e,Object(i.useCallback)(function(){t({id:"InitialInkBrushConfigIgnored",message:"Change to initialInkBrushConfigurations prop was ignored. initialInkBrushConfigurations is for initial state only. For subsequent changes use the state or reset method"})},[t]));try{(function(e){if(!e.activeInkBrushId)throw new Error("initialInkBrushConfiguration must contain a activeInkBrushId");if(!La.includes(e.activeInkBrushId))throw new Error("initialInkBrushConfiguration contains an invalid activeInkBrushId");if(!e.eraser.getIcon)throw new Error("initialInkBrushConfiguration must provide a getIcon callback for the eraser tool");if(!e.clearInk.getIcon)throw new Error("initialInkBrushConfiguration must provide a getIcon callback for the clear-ink button");e.brushes.forEach(function(e){if(!e.getIcon)throw new Error("initialInkBrushConfiguration must provide a getIcon callback for "+e.inkBrushId)});La.forEach(function(t){if(!e.brushes.find(function(e){return e.inkBrushId===t}))throw new Error("initialInkBrushConfiguration must include configuration for brushId: "+t)})})(e)}catch(e){n=xa;e instanceof Error?t({id:"InitialInkBrushConfigIgnored",message:e.message}):t({id:"InitialInkBrushConfigIgnored",message:"Change to initialInkBrushConfigurations prop was ignored. initialInkBrushConfigurations is invalid"})}return n}var Oa=function(){return(Oa=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)},Ma=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n},_a=s.a.memo(function(e){var t=e.serializedState,n=e.defaultEdits,r=e.initialEdits,o=e.initialUiState,u=Ma(e,["serializedState","defaultEdits","initialEdits","initialUiState"]),a=Object(i.useContext)(me),f=Object(i.useContext)(Ca).inkBrushConfigurations,l=Se(),c=Aa(f),h=Object(i.useRef)(n).current,p=(function(e,t){if(t){var n=Re(t),r=n.isValid,i=n.message;if(r)return t;e({id:"InitialEditsIgnored",message:"ValidationError: "+i})}})(l,r),d=Object(i.useMemo)(function(){return(function(e,t,n,r,i,s){var o=e?JSON.parse(decodeURI(e)):{},u=un({reducer:{colorAdjustments:Su,transformTools:Vo,uiState:fo,ariaAnnouncement:Pu,filters:Rs,autoEnhance:ia,markup:Yu},preloadedState:{transformTools:Nu(Nr,o.transformTools),colorAdjustments:Nu(ou,o.colorAdjustments),uiState:Nu(Qs,o.uiState),ariaAnnouncement:Nu(Lu,o.ariaAnnouncement),filters:Nu(Fs,o.filters),autoEnhance:Nu(ea,o.autoEnhance),markup:Nu(zu,o.markup)},middleware:aa(on(),s||[])});t&&u.dispatch(Co(t));if(n){u.dispatch(No(n));n.colorAdjustments&&u.dispatch(Eu(n.colorAdjustments))}if(i){var a={};i.brushes.forEach(function(e){a[e.inkBrushId]=Vs[e.inkBrushId]});u.dispatch(Xu(a));u.dispatch(uo(i.activeInkBrushId));u.dispatch(Ju(ua(a[i.activeInkBrushId].inkType)))}r&&u.dispatch(so(r));return u})(t,h,p,o,c,[(e=a,function(t){return function(t){return function(n){return t(Ue(Ue({},n),{telemetry:e}))}}})]);var e},[t,a,h,p,o,c]);Object(i.useEffect)(function(){n&&d.dispatch(Co(n))},[d,n]);return s.a.createElement(q.Provider,Oa({},u,{store:d}))});_a.displayName="ImageEditorProvider";var Da=function(){return(Da=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)},Pa=function(){throw new Error("Error: Components must be wrapped in a valid ComponentImplementationContext.Provider")},Ha=Object(i.createContext)({canvas:Pa,image:Pa,gridLines:Pa,gridLinesEffect:Pa,borderRectangle:Pa,offscreenRenderConnect:Pa,lutProvider:Pa});function Ba(e){var t=Object(i.useContext)(Ha);return s.a.createElement(t.canvas,Da({},e))}function ja(e){var t=Object(i.useContext)(Ha);return t.gridLines?s.a.createElement(t.gridLines,Da({},e)):null}function Fa(e){var t=Object(i.useContext)(Ha);return s.a.createElement(t.image,Da({},e))}function Ia(e){var t=Object(i.useContext)(Ha);return s.a.createElement(t.borderRectangle,Da({},e))}var qa=Object(i.forwardRef)(function(e,t){var n=Object(i.useContext)(Ha);return s.a.createElement(n.offscreenRenderConnect,Da({ref:t},e))}),Ra=Object(i.memo)(qa);function Ua(e){return(0|e)===e}var za,Wa=function(){return(Wa=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)};(function(e){e.RGBA="RGBA";e.RGB="RGB"})(za||(za={}));function Xa(e,t,n,r){void 0===n&&(n=za.RGBA);if(!Ua(e)||!Ua(t))throw new Error("Dimensions of ("+e+","+t+") are not integers. ImageBytes cannot be created.");if(e<1||t<1)throw new RangeError("Dimensions of ("+e+","+t+") must be non-negative. ImageBytes cannot be created.");if(r&&!Ya(e,t,n,r))throw new Error("Given byte array length is invalid. ImageBytes cannot be created.");var i;try{i=null!=r?r:new Uint8Array(e*t*Ga(n))}catch(n){if(n instanceof RangeError)throw new RangeError("Byte array length for "+e+" x "+t+" image is too big. ImageBytes cannot be created. "+n.message);throw n}return{bytes:i,width:e,height:t,format:n,id:""}}function Va(e){return!!e.bytes}function $a(e){return!!e.canvasMethods}function Ja(e){return null!==e&&void 0!==e.main}function Ka(e){return Ja(e)?e:Wa(Wa({},{main:null,blend:null,overlay:null}),{main:e})}function Qa(e){return Va(e)?""+e.id:e instanceof HTMLImageElement?""+e.src:""+e.id}function Ga(e){var t;return((t={})[za.RGB]=3,t[za.RGBA]=4,t)[e]}function Ya(e,t,n,r){return!(!Ua(e)||!Ua(t))&&r.byteLength===e*t*Ga(n)}var Za=Object(i.createContext)({image:null,setImageOverlay:function(){},offscreenRenderer:null,setOffscreenRenderer:function(){}}),ef=function(){return(ef=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)},tf=function(e){var t=e.image,n=e.children,r=Object(i.useState)(t),o=r[0],u=r[1],a=Object(i.useState)(null),f=a[0],l=a[1],c=Object(i.useContext)(Ca).enableMarkup;Object(i.useEffect)(function(){u(function(e){return c&&Ja(e)&&e.overlay?ef(ef({},Ka(t)),{overlay:e.overlay}):t})},[t,c]);var h=Object(i.useCallback)(function(e){u(function(t){return!Ja(t)&&!e||Ja(t)&&(!t.overlay&&!e||e&&t.overlay&&Qa(t.overlay)===Qa(e))?t:ef(ef({},Ka(t)),{overlay:e})})},[]);return s.a.createElement(Za.Provider,{value:{image:o,setImageOverlay:h,offscreenRenderer:f,setOffscreenRenderer:l}},n)};function nf(e,t){return e.brightness===t.brightness&&e.exposure===t.exposure&&e.saturation===t.saturation&&e.highlights===t.highlights&&e.shadows===t.shadows&&e.vibrance===t.vibrance&&e.contrast===t.contrast&&e.tint===t.tint&&e.vignette===t.vignette&&e.temperature===t.temperature&&e.version===t.version}var rf=function(e){return!!(e&&e.lutUrlId&&e.config)},sf=function(){return(sf=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)};function of(e,t){return rf(e.activeFilter)&&rf(t.activeFilter)&&e.activeFilter.config.numRedSamplesPerSlice===t.activeFilter.config.numRedSamplesPerSlice&&e.activeFilter.config.numGreenSamplesPerSlice===t.activeFilter.config.numGreenSamplesPerSlice&&e.activeFilter.config.numBlueSlicesPerRowIn2DLayout===t.activeFilter.config.numBlueSlicesPerRowIn2DLayout&&e.activeFilter.config.numBlueSlicesPerColumnIn2DLayout===t.activeFilter.config.numBlueSlicesPerColumnIn2DLayout&&e.activeFilter.lutUrlId===t.activeFilter.lutUrlId&&e.activeFilter.name===t.activeFilter.name&&e.filterLevel===t.filterLevel||!rf(e.activeFilter)&&!rf(t.activeFilter)}function uf(e){return sf({},e)}function af(e,t){return e.autoEnhanceLevel===t.autoEnhanceLevel}function ff(e,t){var n=e.markupContentItems||[],r=t.markupContentItems||[];return n.length===r.length&&n.every(function(e,t){return e.id===r[t].id})}function lf(e){return(function(e){var t=e.cropRectangle,n=e.imageTransform,r=e.originalImageSize,i=Pr(t),s=ks(n),o=!Gn(Pr(Hr(s)),i,10),u=!Gn(s,Mn(r.x,r.y),10);return o||u})(e)||(function(e){var t=!!e.colorAdjustments&&!nf(e.colorAdjustments,ou),n=!of(e,uf(Fs)),r=!af(e,Zu),i=!ff(e,zu);return t||n||r||i})(e)}var cf=function(){return(cf=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)};function hf(e,t,n,r,i,s,o,u){return{imageTransform:Ls(t),cropRectangle:Hr(e),originalImageSize:cf({},n),colorAdjustments:cf({},r),activeFilter:i.activeFilter,filterLevel:i.filterLevel,autoEnhanceLevel:"on"===s.autoEnhanceStatus?s.autoEnhanceLevel:0,version:1,aspectRatioConstraint:o,markupContentItems:u}}var pf=function(e){return e.cropInteraction.uvToWorld},df=function(e){return e.cropInteraction.mode},vf=function(e){return e.cropInteraction.aspectRatioConstraint},mf=function(e){return e.view.worldToView},gf=function(e){return e.view.viewportPixelSize},yf=function(e){return e.view.viewFitting.mode},bf=function(e){return e.device.pixelRatio},wf=function(e){return e.image._preciseUvToWorld},Ef=function(e){return!!e.image.loadedPixelSize},Sf=function(e){return e.image.originalPixelSize},xf=function(e){return e.pointer.pointerDowns.length>0},Tf=function(e){return e.animations.worldToView.animatedMatrix},Nf=Vt([wf],function(e){return Pn(e)}),Cf=Vt([Nf],function(e){return jr(e)}),kf=Vt([Sf],function(e){return e}),Lf=function(e){return e.colorAdjustments},Af=function(e){return e.filters},Of=function(e){return e.autoEnhance},Mf=function(e){return e.markup.markupContentItems},_f=Vt([pf,Nf,kf,Lf,Af,Of,vf,Mf],function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=hf.apply(void 0,e);return lf(n)});function Df(e,t){var n=(function(e,t){var n,r,i,s=e.originalImageSize,o=(null===(n=t.image)||void 0===n?void 0:n._preciseUvToWorld)||Mn(s.x,s.y),u=Pr(Hr(o)),a=(null===(r=t.cropInteraction)||void 0===r?void 0:r.uvToWorld)||Pr(Bi(u,o,Di((null===(i=t.cropInteraction)||void 0===i?void 0:i.aspectRatioConstraint)||Sr,u,s))),f=dn({x:e.cropRectangle.left,y:e.cropRectangle.top},Yn(a)),l=Dn(f.x,f.y),c=Gn(Jn(l,o),ks(e.imageTransform),10);return Gn(Jn(l,a),Pr(e.cropRectangle),10)&&c})(e,t),r=!e.colorAdjustments||nf(e.colorAdjustments,ou),i=of(e,uf(Fs)),s=af(e,Zu),o=ff(e,zu);return n&&r&&i&&s&&o}var Pf,Hf=Vt([pf,Nf,kf,Lf,Af,Of,vf,Mf,function(e){return e.defaults}],function(e,t,n,r,i,s,o,u,a){return Df(hf(e,t,n,r,i,s,o,u),a)}),Bf=Object(i.createContext)(new Set);(function(e){e.SaveAs="SaveAs";e.SaveAsOriginal="SaveAsOriginal"})(Pf||(Pf={}));var jf=new Set([Pf.SaveAs,Pf.SaveAsOriginal]),Ff=new Set,If=function(e,t,n){return t&&n?jf:Ff},qf=Vt([function(e){return e.image.loadedPixelSize},Sf,Ef],function(e,t,n){return n&&!!e&&En(e,t)}),Rf=function(){return(Rf=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)};var Uf=s.a.memo(function(e){var t,n=e.editsAreSameAsDefaults,r=e.editsWouldModifyImage,i=e.isFullSizeInputImageAvailable,o=e.onDecideEnabledSaveTypes,u=e.children,a=(t=(o||If)(n,r,i),new Set(Array.from(t)));return s.a.createElement(Bf.Provider,{value:a},u)}),zf=Object(q.connect)(function(e,t){var n=Rf(Rf({},e.transformTools),{colorAdjustments:e.colorAdjustments,filters:e.filters,autoEnhance:e.autoEnhance,markup:e.markup});return{editsAreSameAsDefaults:Hf(n),editsWouldModifyImage:_f(n),isFullSizeInputImageAvailable:qf(e.transformTools)}})(Uf),Wf=Object(i.createContext)(void 0),Xf=s.a.memo(function(e){var t=e.sessionFullImageSize,n=e.setSessionFullImageSize,r=e.resetEdits,o=e.children,u=Se(),a=ka(t,Object(i.useCallback)(function(){u({id:"SessionFullImageSizeIgnored",message:"Change to sessionFullImageSize prop was ignored. sessionFullImageSize is for initial state only."})},[u]));Object(i.useEffect)(function(){if(a){n(a);r(!1)}},[r,a,n]);return s.a.createElement(Wf.Provider,{value:a},o)}),Vf={setSessionFullImageSize:Xo,resetEdits:js},$f=Object(q.connect)(null,Vf)(Xf),Jf=s.a.memo(function(e){var t=e.image,n=e.localization,r=e.telemetryCallback,o=e.serializedState,u=e.onComponentError,a=e.defaultEdits,f=e.initialEdits,l=e.initialUiState,c=e.children,h=e.componentImplementationContext,p=e.onDecideEnabledSaveTypes,d=e.sessionFullImageSize,v=ka(f,Object(i.useCallback)(function(){u({id:"InitialEditsIgnored",message:"Change to initialEdits prop was ignored. initialEdits is for initial state only. For subsequent changes use the setEdits method, or the reset method"})},[u])),m=ka(l,Object(i.useCallback)(function(){u({id:"InitialUiStateIgnored",message:"Change to initialUiState prop was ignored. initialUiState is for initial state only. For subsequent changes use the setUiState method"})},[u]));return s.a.createElement(Ha.Provider,{value:h},s.a.createElement(Ee,{onError:u},s.a.createElement(Pe,{telemetryCallback:r},s.a.createElement(De,{localization:n},s.a.createElement(_a,{serializedState:o,defaultEdits:a,initialEdits:v,initialUiState:m},s.a.createElement(zf,{onDecideEnabledSaveTypes:p},s.a.createElement($f,{sessionFullImageSize:d},s.a.createElement(tf,{image:t},c,s.a.createElement(be,null)))))),s.a.createElement(He,null))))});Jf.displayName="ImageEditorContext";var Kf=s.a.createElement("svg",{viewBox:"0 0 18 18"},s.a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M10.5 1.5H7.5C6.67157 1.5 6 2.17157 6 3V15C6 15.8284 6.67157 16.5 7.5 16.5H10.5C11.3284 16.5 12 15.8284 12 15V3C12 2.17157 11.3284 1.5 10.5 1.5ZM7.5 0C5.84315 0 4.5 1.34315 4.5 3V15C4.5 16.6569 5.84315 18 7.5 18H10.5C12.1569 18 13.5 16.6569 13.5 15V3C13.5 1.34315 12.1569 0 10.5 0H7.5Z"})),Qf=s.a.createElement("svg",{viewBox:"0 0 18 18",transform:"rotate(90)"},s.a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M10.5 1.5H7.5C6.67157 1.5 6 2.17157 6 3V15C6 15.8284 6.67157 16.5 7.5 16.5H10.5C11.3284 16.5 12 15.8284 12 15V3C12 2.17157 11.3284 1.5 10.5 1.5ZM7.5 0C5.84315 0 4.5 1.34315 4.5 3V15C4.5 16.6569 5.84315 18 7.5 18H10.5C12.1569 18 13.5 16.6569 13.5 15V3C13.5 1.34315 12.1569 0 10.5 0H7.5Z"})),Gf=s.a.createElement("svg",{viewBox:"0 0 18 18"},s.a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12 1.5H6C5.17157 1.5 4.5 2.17157 4.5 3V15C4.5 15.8284 5.17157 16.5 6 16.5H12C12.8284 16.5 13.5 15.8284 13.5 15V3C13.5 2.17157 12.8284 1.5 12 1.5ZM6 0C4.34315 0 3 1.34315 3 3V15C3 16.6569 4.34315 18 6 18H12C13.6569 18 15 16.6569 15 15V3C15 1.34315 13.6569 0 12 0H6Z"})),Yf=s.a.createElement("svg",{viewBox:"0 0 18 18",transform:"rotate(90)"},s.a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12 1.5H6C5.17157 1.5 4.5 2.17157 4.5 3V15C4.5 15.8284 5.17157 16.5 6 16.5H12C12.8284 16.5 13.5 15.8284 13.5 15V3C13.5 2.17157 12.8284 1.5 12 1.5ZM6 0C4.34315 0 3 1.34315 3 3V15C3 16.6569 4.34315 18 6 18H12C13.6569 18 15 16.6569 15 15V3C15 1.34315 13.6569 0 12 0H6Z"})),Zf=s.a.createElement("svg",{viewBox:"0 0 18 18"},s.a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12.5 1.5H5.5C4.67157 1.5 4 2.17157 4 3V15C4 15.8284 4.67157 16.5 5.5 16.5H12.5C13.3284 16.5 14 15.8284 14 15V3C14 2.17157 13.3284 1.5 12.5 1.5ZM5.5 0C3.84315 0 2.5 1.34315 2.5 3V15C2.5 16.6569 3.84315 18 5.5 18H12.5C14.1569 18 15.5 16.6569 15.5 15V3C15.5 1.34315 14.1569 0 12.5 0H5.5Z"})),el=s.a.createElement("svg",{viewBox:"0 0 18 18",transform:"rotate(90)"},s.a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12.5 1.5H5.5C4.67157 1.5 4 2.17157 4 3V15C4 15.8284 4.67157 16.5 5.5 16.5H12.5C13.3284 16.5 14 15.8284 14 15V3C14 2.17157 13.3284 1.5 12.5 1.5ZM5.5 0C3.84315 0 2.5 1.34315 2.5 3V15C2.5 16.6569 3.84315 18 5.5 18H12.5C14.1569 18 15.5 16.6569 15.5 15V3C15.5 1.34315 14.1569 0 12.5 0H5.5Z"})),tl=s.a.createElement("svg",{viewBox:"0 0 18 18"},s.a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M13 1.5H5C4.17157 1.5 3.5 2.17157 3.5 3V15C3.5 15.8284 4.17157 16.5 5 16.5H13C13.8284 16.5 14.5 15.8284 14.5 15V3C14.5 2.17157 13.8284 1.5 13 1.5ZM5 0C3.34315 0 2 1.34315 2 3V15C2 16.6569 3.34315 18 5 18H13C14.6569 18 16 16.6569 16 15V3C16 1.34315 14.6569 0 13 0H5Z"})),nl=s.a.createElement("svg",{viewBox:"0 0 18 18",transform:"rotate(90)"},s.a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M13 1.5H5C4.17157 1.5 3.5 2.17157 3.5 3V15C3.5 15.8284 4.17157 16.5 5 16.5H13C13.8284 16.5 14.5 15.8284 14.5 15V3C14.5 2.17157 13.8284 1.5 13 1.5ZM5 0C3.34315 0 2 1.34315 2 3V15C2 16.6569 3.34315 18 5 18H13C14.6569 18 16 16.6569 16 15V3C16 1.34315 14.6569 0 13 0H5Z"})),rl=s.a.createElement("svg",{viewBox:"0 0 18 18"},s.a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M11 1.5H7C6.17157 1.5 5.5 2.17157 5.5 3V15C5.5 15.8284 6.17157 16.5 7 16.5H11C11.8284 16.5 12.5 15.8284 12.5 15V3C12.5 2.17157 11.8284 1.5 11 1.5ZM7 0C5.34315 0 4 1.34315 4 3V15C4 16.6569 5.34315 18 7 18H11C12.6569 18 14 16.6569 14 15V3C14 1.34315 12.6569 0 11 0H7Z"})),il=s.a.createElement("svg",{viewBox:"0 0 18 18",transform:"rotate(90)"},s.a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M11 1.5H7C6.17157 1.5 5.5 2.17157 5.5 3V15C5.5 15.8284 6.17157 16.5 7 16.5H11C11.8284 16.5 12.5 15.8284 12.5 15V3C12.5 2.17157 11.8284 1.5 11 1.5ZM7 0C5.34315 0 4 1.34315 4 3V15C4 16.6569 5.34315 18 7 18H11C12.6569 18 14 16.6569 14 15V3C14 1.34315 12.6569 0 11 0H7Z"})),sl=s.a.createElement("svg",{viewBox:"0 0 20 20"},s.a.createElement("path",{d:"M19.2502 11C19.6298 11 19.9436 11.2822 19.9933 11.6482L20.0002 11.75V16.75C20.0002 18.483 18.6437 19.8992 16.9346 19.9949L16.7502 20L12.0823 20.0002C12.6186 19.6147 13.0556 19.0997 13.3475 18.5011L16.7502 18.5C17.6683 18.5 18.4213 17.7929 18.4944 16.8935L18.5002 16.75V11.75C18.5002 11.3358 18.8359 11 19.2502 11ZM9.75015 7C11.5451 7 13.0002 8.45507 13.0002 10.25V16.75C13.0002 18.5449 11.5451 20 9.75015 20H3.25015C1.45523 20 0.0001508 18.5449 0.0001508 16.75V10.25C0.0001508 8.45507 1.45523 7 3.25015 7H9.75015ZM5.71776 15.3534L5.61627 15.4445L2.66355 18.3993C2.84693 18.4645 3.04439 18.5 3.25015 18.5H9.75015C9.95591 18.5 10.1534 18.4645 10.3368 18.3993L7.38403 15.4445C6.96097 15.0215 6.31009 14.9651 5.82627 15.2753L5.71776 15.3534ZM9.75015 8.5H3.25015C2.28365 8.5 1.50015 9.2835 1.50015 10.25V16.75C1.50015 16.9558 1.53566 17.1532 1.60089 17.3366L4.55561 14.3839C5.5848 13.3547 7.22681 13.3118 8.30707 14.2552L8.44469 14.3839L11.3994 17.3366C11.4646 17.1532 11.5002 16.9558 11.5002 16.75V10.25C11.5002 9.2835 10.7166 8.5 9.75015 8.5ZM9.00015 10C9.55243 10 10.0002 10.4477 10.0002 11C10.0002 11.5523 9.55243 12 9.00015 12C8.44787 12 8.00015 11.5523 8.00015 11C8.00015 10.4477 8.44787 10 9.00015 10ZM16.7502 0C18.4832 0 19.8994 1.35645 19.995 3.06558L20.0002 3.25V8.25C20.0002 8.66421 19.6644 9 19.2502 9C18.8705 9 18.5567 8.71785 18.507 8.35177L18.5002 8.25V3.25C18.5002 2.33183 17.793 1.57881 16.8937 1.5058L16.7502 1.5H11.7502C11.3359 1.5 11.0002 1.16421 11.0002 0.75C11.0002 0.370304 11.2823 0.0565091 11.6484 0.00684667L11.7502 0H16.7502ZM8.25015 0C8.66436 0 9.00015 0.335786 9.00015 0.75C9.00015 1.1297 8.718 1.44349 8.35192 1.49315L8.25015 1.5H3.25015C2.33198 1.5 1.57896 2.20711 1.50595 3.10647L1.50015 3.25L1.50011 6.65214C0.901018 6.94409 0.385711 7.38126 0 7.91785L0.0001508 3.25C0.0001508 1.51697 1.35661 0.100754 3.06573 0.00514483L3.25015 0H8.25015Z"})),ol=s.a.createElement("svg",{viewBox:"0 0 18 18"},s.a.createElement("path",{d:"M14.75 0C16.5449 0 18 1.45507 18 3.25V14.75C18 16.5449 16.5449 18 14.75 18H3.25C1.45507 18 0 16.5449 0 14.75V3.25C0 1.45507 1.45507 0 3.25 0H14.75ZM15.3305 16.4014L9.52467 10.7148C9.25962 10.4553 8.85013 10.4316 8.55879 10.644L8.4752 10.7148L2.66845 16.4011C2.8504 16.4651 3.04613 16.5 3.25 16.5H14.75C14.9535 16.5 15.1489 16.4653 15.3305 16.4014L9.52467 10.7148L15.3305 16.4014ZM14.75 1.5H3.25C2.2835 1.5 1.5 2.2835 1.5 3.25V14.75C1.5 14.9584 1.53643 15.1583 1.60326 15.3437L7.42578 9.64299C8.25887 8.82729 9.56746 8.7885 10.4458 9.52658L10.5742 9.64312L16.3964 15.3447C16.4634 15.159 16.5 14.9588 16.5 14.75V3.25C16.5 2.2835 15.7165 1.5 14.75 1.5ZM12.2521 3.5C13.4959 3.5 14.5042 4.50831 14.5042 5.75212C14.5042 6.99592 13.4959 8.00423 12.2521 8.00423C11.0083 8.00423 10 6.99592 10 5.75212C10 4.50831 11.0083 3.5 12.2521 3.5ZM12.2521 5C11.8367 5 11.5 5.33673 11.5 5.75212C11.5 6.1675 11.8367 6.50423 12.2521 6.50423C12.6675 6.50423 13.0042 6.1675 13.0042 5.75212C13.0042 5.33673 12.6675 5 12.2521 5Z"})),ul=s.a.createElement("svg",{viewBox:"0 0 18 18"},s.a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M15 1.5H3C2.17157 1.5 1.5 2.17157 1.5 3V15C1.5 15.8284 2.17157 16.5 3 16.5H15C15.8284 16.5 16.5 15.8284 16.5 15V3C16.5 2.17157 15.8284 1.5 15 1.5ZM3 0C1.34315 0 0 1.34315 0 3V15C0 16.6569 1.34315 18 3 18H15C16.6569 18 18 16.6569 18 15V3C18 1.34315 16.6569 0 15 0H3Z"})),al=s.a.createElement("svg",{viewBox:"0 0 16 16"},s.a.createElement("path",{d:"M7.99685 13.7862C8.2423 13.7862 8.4465 13.9629 8.4888 14.1958L8.4969 14.2856V15.5005C8.4969 15.7764 8.273 16 7.99685 16C7.75139 16 7.54724 15.8234 7.50491 15.5903L7.49685 15.5005V14.2856C7.49685 14.0098 7.72071 13.7862 7.99685 13.7862ZM12.7337 12.0179L12.803 12.0756L13.663 12.9348C13.8582 13.1298 13.8582 13.446 13.663 13.6411C13.4894 13.8144 13.22 13.8337 13.0251 13.6989L12.9559 13.6411L12.0958 12.782C11.9006 12.587 11.9006 12.2707 12.0958 12.0756C12.2694 11.9023 12.5388 11.883 12.7337 12.0179ZM3.89746 12.0756C4.07103 12.249 4.09031 12.5181 3.95532 12.7128L3.89746 12.782L3.03745 13.6411C2.84219 13.8361 2.5256 13.8361 2.33034 13.6411C2.15678 13.4677 2.13749 13.1986 2.27249 13.0039L2.33034 12.9348L3.19035 12.0756C3.38562 11.8806 3.7022 11.8806 3.89746 12.0756ZM8.0072 3.51284C10.4866 3.51284 12.4965 5.52061 12.4965 7.99731C12.4965 10.4741 10.4866 12.4818 8.0072 12.4818C5.52781 12.4818 3.51787 10.4741 3.51787 7.99731C3.51787 5.52061 5.52781 3.51284 8.0072 3.51284ZM15.4999 7.51538C15.776 7.51538 15.9999 7.739 15.9999 8.01483C15.9999 8.26007 15.823 8.46395 15.5898 8.5063L15.4999 8.51429H14.2836C14.0075 8.51429 13.7836 8.29073 13.7836 8.01483C13.7836 7.76965 13.9605 7.56572 14.1938 7.52343L14.2836 7.51538H15.4999ZM1.71624 7.49206C1.99238 7.49206 2.21624 7.71567 2.21624 7.99151C2.21624 8.23669 2.03936 8.44067 1.80612 8.48293L1.71624 8.49102H0.5C0.22386 8.49102 0 8.26736 0 7.99151C0 7.74631 0.17688 7.54239 0.41012 7.5001L0.5 7.49206H1.71624ZM2.9682 2.30115L3.03745 2.35893L3.89746 3.21803C4.09272 3.41307 4.09272 3.72931 3.89746 3.92436C3.72389 4.09774 3.45447 4.117 3.2596 3.98216L3.19035 3.92436L2.33034 3.06528C2.13508 2.87023 2.13508 2.55399 2.33034 2.35893C2.50391 2.18556 2.77333 2.16629 2.9682 2.30115ZM13.663 2.35893C13.8365 2.53232 13.8558 2.80146 13.7208 2.99611L13.663 3.06528L12.803 3.92436C12.6077 4.11941 12.2911 4.11941 12.0958 3.92436C11.9223 3.75099 11.903 3.48185 12.038 3.28719L12.0958 3.21803L12.9559 2.35893C13.1511 2.16388 13.4677 2.16388 13.663 2.35893ZM8.0001 0C8.2456 0 8.4498 0.176689 8.4921 0.409688L8.5001 0.499461V1.71439C8.5001 1.99023 8.2763 2.21385 8.0001 2.21385C7.75468 2.21385 7.55054 2.03717 7.5082 1.80417L7.50014 1.71439V0.499461C7.50014 0.223619 7.724 0 8.0001 0Z"})),fl=s.a.createElement("svg",{viewBox:"0 0 16 16"},s.a.createElement("path",{d:"M15.2353 0.76375C14.2155 -0.254592 12.5621 -0.254582 11.5424 0.76377L10.5071 1.79773L10.1574 1.44848C9.57382 0.865754 8.62779 0.865754 8.04425 1.44848L7.4607 2.0312C6.87718 2.61393 6.87717 3.55871 7.4607 4.14144L7.81043 4.49069L1.48156 10.8109C1.20135 11.0907 1.04392 11.4703 1.04392 11.8661V12.3649L0.0831169 14.6114C-0.271229 15.4399 0.571603 16.2745 1.3982 15.9136L3.63826 14.9357H4.11779C4.51407 14.9357 4.89413 14.7785 5.17435 14.4986L11.5032 8.17842L11.8552 8.52998C12.4387 9.11262 13.3847 9.11262 13.9683 8.52998L14.5518 7.94721C15.1354 7.36448 15.1354 6.41969 14.5518 5.83697L14.1999 5.48547L15.2353 4.45148C16.2549 3.43314 16.2549 1.78209 15.2353 0.76375ZM8.51483 5.19411L10.7989 7.47503L4.46997 13.7952C4.37657 13.8885 4.24989 13.941 4.11779 13.941H3.53415C3.46549 13.941 3.39756 13.9551 3.33465 13.9825L0.999194 15.0021L2.00003 12.6621C2.02644 12.6003 2.04006 12.5338 2.04006 12.4667V11.8661C2.04006 11.7341 2.09253 11.6076 2.18594 11.5143L8.51483 5.19411Z"})),ll=s.a.createElement("svg",{viewBox:"0 0 16 16"},s.a.createElement("path",{d:"M9.9462 0.239097C11.3059 0.578692 12.5937 1.28004 13.6569 2.34315C16.781 5.46734 16.781 10.5327 13.6569 13.6569C10.5327 16.7811 5.46734 16.7811 2.34314 13.6569C-0.781049 10.5327 -0.781048 5.46734 2.34315 2.34315C3.98115 0.705139 6.15275 -0.074067 8.29843 0.00553347C8.39082 0.00896099 8.48317 0.0139849 8.57543 0.0205977C9.03652 0.0536426 9.49532 0.126492 9.9462 0.239097ZM12.9497 12.9498C15.6834 10.2161 15.6834 5.78393 12.9497 3.05026C12.6157 2.71617 12.2562 2.42292 11.8776 2.17049L12.3536 2.64645C12.5488 2.84171 12.5488 3.15829 12.3536 3.35356C12.1583 3.54882 11.8417 3.54882 11.6464 3.35355L9.44226 1.14937C8.87302 1.03008 8.29181 0.982245 7.71296 1.00585L9.35355 2.64645C9.54881 2.84171 9.54881 3.15829 9.35355 3.35355C9.15829 3.54882 8.84171 3.54882 8.64645 3.35355L6.46284 1.16994C6.05435 1.26147 5.65247 1.38997 5.26255 1.55544L7.35355 3.64645C7.54882 3.84171 7.54882 4.15829 7.35355 4.35356C7.15829 4.54882 6.84171 4.54882 6.64645 4.35355L4.33014 2.03725C4.01204 2.2334 3.70624 2.45737 3.41621 2.70915L5.35354 4.64645C5.54881 4.84171 5.54881 5.15829 5.35355 5.35355C5.15829 5.54882 4.84171 5.54882 4.64644 5.35356L2.70911 3.41626C2.45734 3.70627 2.23338 4.01206 2.03725 4.33014L4.35355 6.64645C4.54882 6.84171 4.54882 7.15829 4.35355 7.35356C4.15829 7.54882 3.84171 7.54882 3.64645 7.35356L1.55544 5.26255C1.38997 5.65247 1.26147 6.05435 1.16994 6.46284L3.35355 8.64645C3.54882 8.84171 3.54882 9.15829 3.35355 9.35356C3.15829 9.54882 2.84171 9.54882 2.64645 9.35356L1.00585 7.71296C0.982241 8.29181 1.03008 8.87302 1.14936 9.44226L3.35355 11.6464C3.54882 11.8417 3.54882 12.1583 3.35355 12.3536C3.15829 12.5488 2.84171 12.5488 2.64645 12.3536L2.17048 11.8776C2.42291 12.2562 2.71617 12.6157 3.05025 12.9498C5.78392 15.6834 10.2161 15.6834 12.9497 12.9498Z"})),cl=s.a.createElement("svg",{viewBox:"0 0 16 16"},s.a.createElement("path",{d:"M9.5001 10.0001C9.2239 10.0001 9.0001 10.224 9.0001 10.5001C9.0001 10.7762 9.2239 11.0001 9.5001 11.0001H12.5001C12.7762 11.0001 13.0001 10.7762 13.0001 10.5001C13.0001 10.224 12.7762 10.0001 12.5001 10.0001H9.5001ZM8 16C12.4183 16 16 12.4183 16 8C16 3.58172 12.4183 0 8 0C3.58172 0 0 3.58172 0 8C0 12.4183 3.58172 16 8 16ZM8 15C6.247 15 4.6445 14.3556 3.41645 13.2908L13.2908 3.41645C14.3556 4.6445 15 6.247 15 8C15 11.866 11.866 15 8 15ZM3.50003 5.00005C3.50003 4.7239 3.72389 4.50004 4.00004 4.50004H5.00005V3.50003C5.00005 3.22389 5.22391 3.00003 5.50005 3.00003C5.7762 3.00003 6.00006 3.22389 6.00006 3.50003V4.50004H7.00006C7.27621 4.50004 7.50007 4.7239 7.50007 5.00005C7.50007 5.27619 7.27621 5.50005 7.00006 5.50005H6.00006V6.50006C6.00006 6.7762 5.7762 7.00006 5.50005 7.00006C5.22391 7.00006 5.00005 6.7762 5.00005 6.50006V5.50005H4.00004C3.72389 5.50005 3.50003 5.27619 3.50003 5.00005Z"})),hl=s.a.createElement("svg",{viewBox:"0 0 16 16"},s.a.createElement("path",{d:"M16 8C16 3.58172 12.4183 -1.56562e-07 8 -3.49691e-07C3.5817 -5.42821e-07 -1.56562e-07 3.58172 -3.49691e-07 8C-5.42821e-07 12.4183 3.5817 16 8 16C12.4183 16 16 12.4183 16 8ZM15 8C15 11.6979 12.1326 14.726 8.5 14.9824L8.5 1.01758C12.1326 1.27396 15 4.30212 15 8Z"})),pl=s.a.createElement("svg",{viewBox:"0 0 16 16"},s.a.createElement("path",{d:"M7.64645 0.146453C7.84171 -0.0488175 8.1583 -0.0488175 8.3536 0.146453C8.8853 0.678212 10.1584 2.20981 11.2998 4.04882C12.4297 5.86917 13.5 8.0985 13.5 10C13.5 11.8438 12.972 13.3521 11.9905 14.4037C11.0058 15.4587 9.6148 16 8 16C6.38524 16 4.99415 15.4587 4.00947 14.4037C3.02801 13.3521 2.5 11.8438 2.5 10C2.5 8.0985 3.5703 5.86917 4.70018 4.04882C5.84163 2.20981 7.11469 0.678212 7.64645 0.146453Z"})),dl=s.a.createElement("svg",{viewBox:"0 0 20 20"},s.a.createElement("path",{d:"M2.5 4.25C2.5 3.2835 3.2835 2.5 4.25 2.5H7.20988C5.03608 3.30902 3.30902 5.03608 2.5 7.20988V4.25ZM2.5 12.7901V15.75C2.5 16.7165 3.28351 17.5 4.25 17.5H7.20988C5.03608 16.691 3.30902 14.9639 2.5 12.7901ZM12.7901 17.5H15.75C16.7165 17.5 17.5 16.7165 17.5 15.75V12.7901C16.691 14.9639 14.9639 16.691 12.7901 17.5ZM17.5 7.20988V4.25C17.5 3.28351 16.7165 2.5 15.75 2.5H12.7901C14.9639 3.30902 16.691 5.03608 17.5 7.20988ZM4.25 1C2.45507 1 1 2.45507 1 4.25V15.75C1 17.5449 2.45507 19 4.25 19H15.75C17.5449 19 19 17.5449 19 15.75V4.25C19 2.45507 17.5449 1 15.75 1H4.25ZM16.5 10C16.5 13.5899 13.5899 16.5 10 16.5C6.41015 16.5 3.5 13.5899 3.5 10C3.5 6.41015 6.41015 3.5 10 3.5C13.5899 3.5 16.5 6.41015 16.5 10Z"})),vl=s.a.createElement("svg",{viewBox:"0 0 16 16"},s.a.createElement("path",{d:"M2.34315 2.34315C5.46734 -0.781049 10.5327 -0.781049 13.6569 2.34315C14.72 3.40625 15.4213 4.69413 15.7609 6.0538L13.3536 3.64645C13.1583 3.45118 12.8417 3.45118 12.6464 3.64645C12.4512 3.84171 12.4512 4.15829 12.6464 4.35355L15.9945 7.70157C16.0131 8.20286 15.9848 8.70555 15.9096 9.20253L13.3536 6.64645C13.1583 6.45118 12.8417 6.45118 12.6464 6.64645C12.4512 6.84171 12.4512 7.15829 12.6464 7.35355L15.6474 10.3545C15.5283 10.7423 15.3791 11.123 15.1997 11.4926L12.3536 8.64645C12.1583 8.45119 11.8417 8.45119 11.6464 8.64645C11.4512 8.84171 11.4512 9.15829 11.6464 9.35355L14.6871 12.3942C14.4819 12.7056 14.2528 13.0059 13.9996 13.2924L11.3536 10.6464C11.1583 10.4512 10.8417 10.4512 10.6465 10.6465C10.4512 10.8417 10.4512 11.1583 10.6465 11.3536L13.2925 13.9995C13.006 14.2527 12.7057 14.4819 12.3942 14.6871L9.35355 11.6464C9.15829 11.4512 8.84171 11.4512 8.64645 11.6464C8.45118 11.8417 8.45118 12.1583 8.64645 12.3536L11.4926 15.1997C11.123 15.3791 10.7424 15.5283 10.3545 15.6474L7.35355 12.6464C7.15829 12.4512 6.84171 12.4512 6.64645 12.6464C6.45118 12.8417 6.45118 13.1583 6.64645 13.3536L9.20253 15.9096C8.70555 15.9848 8.20286 16.0131 7.70157 15.9945L4.35355 12.6464C4.15829 12.4512 3.84171 12.4512 3.64645 12.6464C3.45118 12.8417 3.45118 13.1583 3.64645 13.3536L6.0538 15.7609C4.69413 15.4213 3.40625 14.72 2.34315 13.6569C-0.781049 10.5327 -0.781049 5.46734 2.34315 2.34315Z"})),ml=s.a.createElement("svg",{viewBox:"0 0 16 16"},s.a.createElement("path",{d:"M8.5 5C8.5 4.72386 8.2761 4.5 8 4.5C7.72386 4.5 7.5 4.72386 7.5 5V10.063C6.63739 10.285 6 11.0681 6 12C6 13.1046 6.89543 14 8 14C9.1046 14 10 13.1046 10 12C10 11.0681 9.3626 10.285 8.5 10.063V5Z"}),s.a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M5 3C5 1.34315 6.34315 0 8 0C9.6569 0 11 1.34315 11 3L10.9999 9.3541C11.6219 10.0589 12 10.9857 12 12C12 14.2091 10.2091 16 8 16C5.79086 16 4 14.2091 4 12C4 10.9857 4.37808 10.0589 5.00008 9.3541L5 3ZM10 3C10 1.89543 9.1046 1 8 1C6.89543 1 6 1.89543 6 3L6.00008 9.7546L5.85719 9.9004C5.32642 10.442 5 11.1824 5 12C5 13.6568 6.34315 15 8 15C9.6569 15 11 13.6568 11 12C11 11.1824 10.6736 10.442 10.1428 9.9004L9.9999 9.7546L10 3Z"})),gl=s.a.createElement("svg",{viewBox:"0 0 17 17"},s.a.createElement("path",{d:"M0.772726 15.197C0.500211 15.197 0.247849 15.0534 0.108562 14.8192C-0.0307244 14.585 -0.0363398 14.2947 0.0937875 14.0552L6.53315 2.2068C6.70191 1.89625 7.05994 1.73979 7.40252 1.82687C7.74499 1.91395 7.98485 2.22234 7.98485 2.57578V14.4243C7.98485 14.851 7.63887 15.197 7.21212 15.197H0.772726Z"}),s.a.createElement("path",{d:"M16.8914 14.8192C16.7521 15.0534 16.4998 15.197 16.2273 15.197H9.78786C9.36111 15.197 9.01514 14.851 9.01514 14.4243V2.57578C9.01514 2.22234 9.25499 1.91395 9.59746 1.82687C9.94004 1.73979 10.2981 1.89625 10.4668 2.2068L16.9062 14.0552C17.0364 14.2947 17.0307 14.585 16.8914 14.8192ZM10.5606 5.61584V13.6516H14.9278L10.5606 5.61584Z"})),yl=s.a.createElement("svg",{viewBox:"0 0 17 17"},s.a.createElement("path",{d:"M14.8192 0.108562C15.0534 0.247849 15.197 0.500211 15.197 0.772726V7.21212C15.197 7.63887 14.851 7.98485 14.4243 7.98485H2.57578C2.22234 7.98485 1.91395 7.74499 1.82687 7.40252C1.73979 7.05994 1.89625 6.70191 2.2068 6.53315L14.0552 0.0937875C14.2947 -0.0363398 14.585 -0.0307244 14.8192 0.108562ZM5.61584 6.43939H13.6516V2.07217L5.61584 6.43939Z"}),s.a.createElement("path",{d:"M15.197 16.2273C15.197 16.4998 15.0534 16.7521 14.8192 16.8914C14.585 17.0307 14.2947 17.0364 14.0552 16.9062L2.2068 10.4668C1.89625 10.2981 1.73979 9.94004 1.82687 9.59746C1.91395 9.25499 2.22234 9.01514 2.57578 9.01514H14.4243C14.851 9.01514 15.197 9.36111 15.197 9.78786V16.2273Z"})),bl=s.a.createElement("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},s.a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M6.38561 17.6144C2.69008 16.4943 0 13.0613 0 9C0 4.02944 4.02944 0 9 0C13.0613 0 16.4943 2.69008 17.6144 6.38561C21.3099 7.5057 24 10.9387 24 15C24 19.9706 19.9706 24 15 24C10.9387 24 7.5057 21.3099 6.38561 17.6144ZM6.04394 15.895C6.01488 15.6006 6 15.302 6 15C6 10.0294 10.0294 6 15 6C15.302 6 15.6006 6.01488 15.895 6.04394C14.7478 3.37164 12.0925 1.5 9 1.5C4.85786 1.5 1.5 4.85786 1.5 9C1.5 12.0925 3.37164 14.7478 6.04394 15.895ZM17.9561 8.10504C17.9571 8.11555 17.9581 8.12606 17.9591 8.13658C17.9862 8.42074 18 8.70876 18 9C18 13.9706 13.9706 18 9 18C8.69798 18 8.39942 17.9851 8.10504 17.9561C9.25223 20.6284 11.9075 22.5 15 22.5C19.1421 22.5 22.5 19.1421 22.5 15C22.5 11.9075 20.6284 9.25223 17.9561 8.10504Z"})),wl=s.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 2048 2048"},s.a.createElement("path",{d:"M345 1792q-69 0-131-28t-110-75-76-110-28-132V601q0-69 28-131t75-110 110-76 132-28h1358q69 0 131 28t110 75 76 110 28 132v846q0 69-28 131t-75 110-110 76-132 28H345zm1351-128q46 0 87-17t71-48 48-72 18-87V608q0-46-17-87t-48-71-72-48-87-18H352q-46 0-87 17t-71 48-48 72-18 87v832q0 46 17 87t48 71 72 48 87 18h1344zM512 808q-15 8-31 16t-33 8q-26 0-45-19t-19-45q0-17 9-33t26-24l128-64q14-7 29-7 27 0 45 18t19 46v640q0 26-19 45t-45 19q-26 0-45-19t-19-45V808zm896 0q-15 8-31 16t-33 8q-26 0-45-19t-19-45q0-17 9-33t26-24l128-64q14-7 29-7 27 0 45 18t19 46v640q0 26-19 45t-45 19q-26 0-45-19t-19-45V808zm-512 24q0-26 19-45t45-19q26 0 45 19t19 45q0 26-19 45t-45 19q-26 0-45-19t-19-45zm0 384q0-26 19-45t45-19q26 0 45 19t19 45q0 26-19 45t-45 19q-26 0-45-19t-19-45z"})),El=s.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 2048 2048"},s.a.createElement("path",{d:"M251 1792q-50 0-95-20t-80-55-55-80-21-96V507q0-50 20-95t55-80 80-55 96-21h1546q50 0 95 20t80 55 55 80 21 96v1034q0 50-20 95t-55 80-80 55-96 21H251zm1541-128q27 0 50-10t40-27 28-41 10-50V512q0-26-10-49t-27-41-41-28-50-10H256q-27 0-50 10t-40 27-28 41-10 50v1024q0 27 10 50t27 41 40 27 51 10h1536zM256 832V704q0-39 15-74t41-61 62-42 74-15h128q26 0 45 19t19 45q0 26-19 45t-45 19H448q-21 0-34 7t-20 21-9 31-2 37q0 16 1 32t1 32q0 20-2 37t-9 30-20 21-34 8q-26 0-45-19t-19-45zm1152-256q0-26 19-45t45-19h128q39 0 74 15t61 41 42 62 15 74v128q0 26-19 45t-45 19q-26 0-45-19t-19-45V704q0-21-7-34t-21-19-31-9-37-3q-16 0-32 1t-32 1q-20 0-37-2t-30-9-21-20-8-34zm-960 960q-39 0-74-15t-61-41-42-62-15-74v-128q0-26 19-45t45-19q26 0 45 19t19 45v128q0 21 7 34t21 20 31 9 37 2q16 0 32-1t32-1q19 0 36 2t31 9 21 20 8 34q0 26-19 45t-45 19H448zm1024 0q-26 0-45-19t-19-45q0-26 19-45t45-19h128q21 0 34-7t19-21 9-31 3-37q0-16-1-32t-1-32q0-19 2-36t9-31 20-21 34-8q26 0 45 19t19 45v128q0 39-15 74t-41 61-62 42-74 15h-128z"})),Sl=s.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 2048 2048"},s.a.createElement("path",{d:"M640 1755L19 1133l90-90 531 530L1939 275l90 90L640 1755z"})),xl=s.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 2048 2048"},s.a.createElement("path",{d:"M2048 1088H250l787 787-90 90L6 1024 947 83l90 90-787 787h1798v128z"})),Tl=s.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 2048 2048"},s.a.createElement("path",{d:"M2042 1024l-941 941-90-90 787-787H0V960h1798l-787-787 90-90 941 941z"})),Nl=s.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 2048 2048"},s.a.createElement("path",{d:"M1536 1664H697q-65 0-122-26t-99-70-67-102-25-122V512H64q-26 0-45-19T0 448q0-26 19-45t45-19h320V64q0-26 19-45t45-19q26 0 45 19t19 45v1280q0 39 15 74t41 61 62 42 74 15h1280q26 0 45 19t19 45q0 26-19 45t-45 19h-320v320q0 26-19 45t-45 19q-26 0-45-19t-19-45v-320zM640 512V384h711q63 0 120 25t99 68 68 100 26 120v711h-128V704q0-39-15-74t-41-61-62-42-74-15H640z"})),Cl=s.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 2048 2048"},s.a.createElement("path",{d:"M960 192V64q0-26 19-45t45-19q26 0 45 19t19 45v128q0 26-19 45t-45 19q-26 0-45-19t-19-45zM512 448q0 26-19 45t-45 19q-26 0-45-19L275 365q-19-19-19-45t19-45 45-19q26 0 45 19l128 128q19 19 19 45zm1216-192q26 0 45 19t19 45q0 26-19 45l-128 128q-19 19-45 19t-45-19-19-45q0-26 19-45l128-128q19-19 45-19zm-192 768v10q0 104-41 195t-112 160-163 107-196 40q-106 0-199-40t-163-109-110-163-40-200q0-106 40-199t109-163 163-110 200-40q106 0 199 40t163 109 110 163 40 200zm-512 384h8q78 0 146-31t120-84 80-122 30-147q0-77-29-146t-81-123-119-84-147-31h-8v768zM192 960q26 0 45 19t19 45q0 26-19 45t-45 19H64q-26 0-45-19t-19-45q0-26 19-45t45-19h128zm1792 0q26 0 45 19t19 45q0 26-19 45t-45 19h-128q-26 0-45-19t-19-45q0-26 19-45t45-19h128zM448 1536q26 0 45 19t19 45q0 26-19 45l-128 128q-19 19-45 19t-45-19-19-45q0-26 19-45l128-128q19-19 45-19zm1344 192q0 26-19 45t-45 19q-26 0-45-19l-128-128q-19-19-19-45t19-45 45-19q26 0 45 19l128 128q19 19 19 45zm-704 128v128q0 26-19 45t-45 19q-26 0-45-19t-19-45v-128q0-26 19-45t45-19q26 0 45 19t19 45z"})),kl=s.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 2048 2048"},s.a.createElement("path",{d:"M1600 0q26 0 45 19t19 45v1093q0 51-20 96t-55 79-80 55-96 21h-22q-11 0-22 1h-45q-22 0-44-1v389q0 52-21 97t-56 80-81 54-98 20q-53 0-99-20t-81-55-55-81-21-100v-384H635q-50 0-95-20t-80-55-55-80-21-96V64q0-26 19-45t45-19h1152zM512 128v768h1024V128h-128v320q0 26-19 45t-45 19q-26 0-45-19t-19-45V128h-128v192q0 26-19 45t-45 19q-26 0-45-19t-19-45V128H512zm1024 896H512v128q0 54 37 91t91 37h192q26 0 45 19t19 45v448q0 27 10 50t27 41 40 27 51 10q27 0 50-10t40-27 28-41 10-50v-448q0-41 28-53t72-12q26 0 54 1t57 2q39 0 74-7t61-32q38-38 38-91v-128z"})),Ll=s.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 2048 2048"},s.a.createElement("path",{d:"M2047 194q0 41-14 73t-43 62L574 1820q-11 12-25 21t-29 18l-194 98q-26 13-57 13-42 0-76-25l-84 84q-19 19-45 19t-45-19-19-45q0-26 19-45l84-84q-13-16-19-36t-6-40q0-31 13-57l98-195q14-30 39-53L1720 57q29-27 61-41t73-14q40 0 75 15t61 41 41 61 16 75zm-128 0q0-27-18-45t-46-19q-15 0-28 6t-25 17-22 21-21 22l93 94 20-20q11-11 22-23t18-25 7-28zm-155 188l-98-98L316 1567q-3 3-7 8t-6 10l-97 194 63 63 194-97q4-2 9-6t9-7L1764 382zm-36 1538q26 0 45 19t19 45q0 26-19 45t-45 19H704q-26 0-45-19t-19-45q0-26 19-45t45-19h1024z"}));var Al=n(2183);function Ol(e){return{activeSection:{backgroundColor:e.palette.neutralPrimary},container:{},inactiveSection:{backgroundColor:e.palette.neutralTertiaryAlt},line:{},lineContainer:{},root:{},slideBox:{margin:"0px -12px",padding:"0px 12px","&:hover":{".ms-Slider-active":{backgroundColor:e.palette.neutralPrimary},".ms-Slider-inactive":{backgroundColor:e.palette.neutralTertiaryAlt},".ms-Slider-thumb":{border:"none"}},"&:active":{".ms-Slider-active":{backgroundColor:e.palette.neutralPrimary},".ms-Slider-inactive":{backgroundColor:e.palette.neutralTertiaryAlt},".ms-Slider-thumb":{border:"none"}}},thumb:{border:"none",background:e.palette.neutralPrimary},titleLabel:{},valueLabel:{},zeroTick:{display:"none"}}}function Ml(e){return function(t){var n="adjustment_"+t;return{key:t,text:e[n],ariaLabel:e[n]}}}var _l=n(185);Object(_l.n)([{rawString:".sliderHeaderContainer_9dab0d57{position:relative;height:42px;font-size:14px;line-height:42px;letter-spacing:0}"}]);var Dl="sliderHeaderContainer_9dab0d57";Object(_l.n)([{rawString:".headerContainer_f63b6e20{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.headerContainer_f63b6e20 .name_f63b6e20{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-margin-end:auto;margin-inline-end:auto}"}]);var Pl="headerContainer_f63b6e20",Hl="name_f63b6e20",Bl=n(537),jl=function(){return(jl=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)},Fl=function(e){var t=e.value,n=e.valueFormatter,r=e.name,o=e.hideValue,u=void 0!==o&&o,a=e.iconName,f=e.styles,l=ba().palette.neutralPrimary,c=Object(i.useMemo)(function(){var e={root:{fill:l,fontSize:"16px",height:"16px",width:"16px",lineHeight:"16px",marginInlineEnd:"8px"}};return Object(wa.b)(e,f)},[l,f]);return s.a.createElement("div",{className:Pl},s.a.createElement("span",{className:Hl},!!a&&s.a.createElement(Bl.e,{iconName:a,styles:c}),!!r&&r),s.a.createElement("span",{style:jl({},u&&{display:"none"})},n?n(t):t))};Object(_l.n)([{rawString:".valueWrapper_61cd23c6{position:absolute}"}]);var Il="valueWrapper_61cd23c6",ql=n(536),Rl=function(e){var t=e.value,n=e.maxValue,r=e.minValue,o=e.valueFormatter,u=e.styles,a=ba(),f=Object(i.useMemo)(function(){var e=Object(ql.e)(a),i=(function(e,t,n){return 100*Tn(t,n,e)})(t,r,n);return e?{right:i+"%",transform:"translate(50%)"}:{left:i+"%",transform:"translate(-50%)"}},[n,r,a,t]);return s.a.createElement("span",{className:Object(wa.F)(Il,u),style:f},o?o(t):t)};var Ul=function(){return(Ul=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)},zl=s.a.memo(function(e){var t=e.layout,n=e.headerProps,r=e.styles,i="Labeled"===t;return s.a.createElement("div",{className:Dl,style:null==r?void 0:r.container},i?s.a.createElement(Fl,Ul({},n)):s.a.createElement(Rl,Ul({},n,{styles:null==r?void 0:r.valueHeader})))}),Wl=n(4109),Xl=n.n(Wl);function Vl(e,t,n,r){var i;if(e<-r){i=xn(0,.5,Tn(t,-r,e))}else if(e>r){i=xn(.5,1,Tn(r,n,e))}else i=.5;return i}var $l=Number.POSITIVE_INFINITY,Jl=s.a.memo(function(e){var t=e.adjustment,n=e.layout,r=e.setNormalizedValue,o=e.normalizedValue,u=e.styles,a=iu[t],f=a.sliderMinValue,l=a.sliderMaxValue,c=a.sliderStepValue,h=a.sliderDeadZoneOffset,p=a.sliderValueFormat,d=su(t),v=Object(i.useContext)(_e),m=v.strings,g=v.localizeNumber,y=Ml(m)(t),b=y.text,w=y.ariaLabel,E=Object(i.useContext)(me).logAdjustmentEvent,S=ba(),x=Object(ql.e)(S),T=Object(i.useRef)(null),N=f-h,C=l+h,k=(function(e){var t=Object(i.useState)(!0),n=t[0],r=t[1],s=Object(i.useState)(!1),o=s[0],u=s[1],a=Object(i.useRef)(!1),f=Object(i.useMemo)(function(){return e?new Xl.a(e,{recognizers:[[Xl.a.Pan,{direction:Xl.a.DIRECTION_VERTICAL}]],touchAction:"pan-y"}):null},[e]),l=Object(i.useCallback)(function(e){if(e instanceof TouchEvent){r(!1);u(!1);a.current=!1}},[]);Object(i.useEffect)(function(){if(f&&e){var t=function(e){"touch"===e.pointerType&&(a.current=!0)},n=function(){r(!1)};f.on("panstart",t);e.addEventListener("touchend",l);e.addEventListener("touchstart",n);return function(){f.off("panstart",t);e.removeEventListener("touchend",l);e.removeEventListener("touchstart",n)}}},[l,f,e]);Object(i.useEffect)(function(){var e=0;o&&(e=window.setTimeout(function(){a.current||r(!0)},100));return function(){window.clearTimeout(e)}},[o]);return{shouldUpdateSlider:n,setSliderAdjustmentTriggered:u,cleanupTouchAction:l}})(T.current),L=k.shouldUpdateSlider,A=k.setSliderAdjustmentTriggered,O=k.cleanupTouchAction,M=Object(i.useCallback)(function(e){A(!0);if(L){var n=Vl(e,N,C,h);E({adjustment:t,value:n});r(n)}},[r,E,t,N,C,h,A,L]);Object(i.useEffect)(function(){var e=function(e){if(ds(e)){var t=cs(e.key);if(.5===o&&t!==Lr.None){var n=Vl(t===Lr.Right&&!x||t===Lr.Up||t===Lr.Left&&x?h+.1:-h-.1,N,C,h);r(n)}}},t=T.current;if(t){t.addEventListener("keydown",e);return function(){t.removeEventListener("keydown",e)}}},[o,T,r,C,N,h,x]);var _=Object(i.useMemo)(function(){return(function(e,t,n,r){var i;if(e<.5){i=xn(t,-r,Tn(0,.5,e))}else if(e>.5){i=xn(r,n,Tn(.5,1,e))}else i=0;return i})(o,N,C,h)},[N,C,o,h]),D={value:Object(i.useMemo)(function(){return(function(e,t,n){return Math.round(xn(t,n,e))})(o,f,l)},[o,f,l]),maxValue:l,minValue:f,valueFormatter:p,name:b,iconName:d,styles:null==u?void 0:u.icon},P=Object(i.useMemo)(function(){var e=Ol(S);return Object(wa.b)(e,(null==u?void 0:u.getSliderStyles)&&(null==u?void 0:u.getSliderStyles(S,_)))},[u,S,_]),H=Object(i.useMemo)(function(){var e=null==u?void 0:u.getSliderHeaderStyles;return"function"==typeof e?e(S):e},[u,S]);return s.a.createElement(s.a.Fragment,null,s.a.createElement(zl,{headerProps:D,layout:n,styles:H}),s.a.createElement("div",{ref:T},s.a.createElement(Al.e,{min:N,max:C,step:L?c:$l,value:_,showValue:!1,originFromZero:!0,onChanged:O,onChange:M,styles:P,ariaLabel:w,ariaValueText:g})))});Object(_l.n)([{rawString:".actionsPaneContainer_0f4047fc{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between}.actionsPaneBody_0f4047fc{-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;overflow-y:auto;padding:0 16px}"}]);var Kl="actionsPaneContainer_0f4047fc",Ql="actionsPaneBody_0f4047fc",Gl=function(){return(Gl=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)},Yl=Object(i.memo)(function(e){var t=e.header,n=e.children,r=e.footer,i=e.size,o=e.containerId,u=e.styles,a=void 0===u?{}:u;return s.a.createElement("div",{id:o,className:Object(wa.F)(Kl,a.container,Gl({},i))},t&&s.a.createElement("div",{className:Object(wa.F)(a.header)},t),s.a.createElement("div",{className:Object(wa.F)(Ql,a.body)},n),r&&s.a.createElement("div",{className:Object(wa.F)(a.footer)},r))});Object(_l.n)([{rawString:".sectionHeader_7b43c21b{font-size:16px;font-weight:500;line-height:42px;margin:25px 0 6px 0}.sectionFooter_7b43c21b{height:38px}"}]);var Zl="sectionHeader_7b43c21b",ec="sectionFooter_7b43c21b",tc=Object(i.memo)(function(e){var t,n,r,o,u,a,f,l,c,h,p,d=Object(i.useContext)(_e).strings;return s.a.createElement(Yl,{size:e.size,styles:e.styles,header:e.header,footer:e.footer},s.a.createElement("section",{"aria-label":d.adjustment_lightAriaLandmark},s.a.createElement("div",{className:Zl,style:null===(t=e.styles)||void 0===t?void 0:t.sectionHeader},d.adjustment_light),s.a.createElement(Jl,{adjustment:vo.Brightness,layout:"Labeled",styles:null===(n=e.styles)||void 0===n?void 0:n.adjustmentSlider,normalizedValue:e.brightness,setNormalizedValue:e.setBrightness}),s.a.createElement(Jl,{adjustment:vo.Exposure,layout:"Labeled",styles:null===(r=e.styles)||void 0===r?void 0:r.adjustmentSlider,normalizedValue:e.exposure,setNormalizedValue:e.setExposure}),s.a.createElement(Jl,{adjustment:vo.Contrast,layout:"Labeled",styles:null===(o=e.styles)||void 0===o?void 0:o.adjustmentSlider,normalizedValue:e.contrast,setNormalizedValue:e.setContrast}),s.a.createElement(Jl,{adjustment:vo.Highlights,layout:"Labeled",styles:null===(u=e.styles)||void 0===u?void 0:u.adjustmentSlider,normalizedValue:e.highlights,setNormalizedValue:e.setHighlights}),s.a.createElement(Jl,{adjustment:vo.Shadows,layout:"Labeled",styles:null===(a=e.styles)||void 0===a?void 0:a.adjustmentSlider,normalizedValue:e.shadows,setNormalizedValue:e.setShadows}),s.a.createElement(Jl,{adjustment:vo.Vignette,layout:"Labeled",styles:null===(f=e.styles)||void 0===f?void 0:f.adjustmentSlider,normalizedValue:e.vignette,setNormalizedValue:e.setVignette})),s.a.createElement("section",{"aria-label":d.adjustment_colorAriaLandmark},s.a.createElement("div",{className:Zl,style:null===(l=e.styles)||void 0===l?void 0:l.sectionHeader},d.adjustment_color),s.a.createElement(Jl,{adjustment:vo.Saturation,layout:"Labeled",styles:null===(c=e.styles)||void 0===c?void 0:c.adjustmentSlider,normalizedValue:e.saturation,setNormalizedValue:e.setSaturation}),s.a.createElement(Jl,{adjustment:vo.Temperature,layout:"Labeled",styles:null===(h=e.styles)||void 0===h?void 0:h.adjustmentSlider,normalizedValue:e.temperature,setNormalizedValue:e.setTemperature}),s.a.createElement(Jl,{adjustment:vo.Tint,layout:"Labeled",styles:null===(p=e.styles)||void 0===p?void 0:p.adjustmentSlider,normalizedValue:e.tint,setNormalizedValue:e.setTint}),s.a.createElement("div",{className:ec})))}),nc={setBrightness:hu,setExposure:pu,setSaturation:mu,setHighlights:gu,setShadows:yu,setContrast:bu,setTemperature:du,setTint:vu,setVignette:wu},rc=Object(q.connect)(function(e){var t=e.colorAdjustments;return{brightness:t.brightness,exposure:t.exposure,saturation:t.saturation,highlights:t.highlights,shadows:t.shadows,contrast:t.contrast,temperature:t.temperature,tint:t.tint,vignette:t.vignette,key:e.uiState.numberOfResets}},nc)(tc),ic=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),i=0;for(t=0;t<n;t++)for(var s=arguments[t],o=0,u=s.length;o<u;o++,i++)r[i]=s[o];return r};function sc(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return e.replace(/{(\d+)}/g,function(n,r){if(void 0===t[r])throw new Error("Argument at index "+r+" is undefined. String is "+e+". Max index provided was "+(t.length-1)+".");return t[r]})}function oc(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var i=n.map(function(e){return t(e)});return sc.apply(void 0,ic([e],i))}var uc=n(2989);Object(_l.n)([{rawString:".display_09eb8103{position:absolute;z-index:2;-webkit-transform:translateX(-50%);transform:translateX(-50%);border-radius:2px;font-size:14px;line-height:20px;padding:4px 8px;pointer-events:none;text-align:center;opacity:0}.visible_09eb8103{opacity:1;-webkit-transition:opacity .25s;transition:opacity .25s}"}]);var ac="display_09eb8103",fc="visible_09eb8103",lc=function(){return(lc=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)},cc=s.a.memo(function(e){var t=e.children,n=e.visible,r=void 0!==n&&n,i=e.style,u=void 0===i?{}:i,a=ba(),f=Object(o.e)(ac,r&&fc),l=Object(uc.e)(a.palette.white);return s.a.createElement("div",{className:f,style:lc({color:""+a.palette.neutralPrimary,backgroundColor:"rgba("+(null==l?void 0:l.r)+", "+(null==l?void 0:l.g)+", "+(null==l?void 0:l.b)+", 0.6)"},u),"data-test-id":"aspect_ratio_display","aria-hidden":r?"false":"true"},t)}),hc=s.a.memo(function(e){var t=e.aspectRatioDisplay,n=e.position,r=e.visible,o=Object(i.useContext)(_e),u=o.localizeNumber,a=o.strings,f=Object(i.useMemo)(function(){return r?oc(a.aspectRatio_ratioLabelFormatString,u,t.x,t.y):""},[t,u,a,r]),l=Object(i.useMemo)(function(){return r?oc(a.aspectRatio_ratioAriaLabelFormatString,u,t.x,t.y):""},[t,u,a,r]);return s.a.createElement(cc,{style:{top:n.y,left:n.x,transform:"translateX(-50%)"},visible:r},s.a.createElement("span",{"aria-label":l},f))}),pc=Vt([pf],function(e){return Pi(_i(e))}),dc=Vt([vf,pc],function(e,t){if(e!==Ae.None&&e!==Ae.Original){var n=Mi.get(e);if(n)return n}return t}),vc=Vt([pf,mf,Tf,bf],function(e,t,n,r){return Hr(Jn(Mn(1/r),n||t,e))}),mc=Vt([vc],function(e){return{x:e.left+e.width/2,y:e.top+8}});var gc=Vt([yf,Ef,pc,pf,function(e){return e.animations.crop.isActive}],function(e,t,n,r,i){var s,o,u=_i(r);return e!==yr.none&&!i&&t&&(s=u,o=n,Math.abs(o.x/o.y-s)<.01)}),yc=Object(q.connect)(function(e){return{aspectRatioDisplay:dc(e.transformTools),position:mc(e.transformTools),visible:gc(e.transformTools)}},{})(hc),bc=n(4967),wc=n(4258),Ec={auto:!0,scroll:!0,hidden:!0};function Sc(e){var t=getComputedStyle(e);return Ec[t.overflow]||Ec[t.overflowY]||Ec[t.overflowX]}function xc(e,t){if(e){var n=(function(e){for(var t=null==e?void 0:e.parentElement;t;){if(Sc(t))return t;t=t.parentElement}return null})(e);if(n){var r=e.getBoundingClientRect(),i=n.getBoundingClientRect();if(t&&Mr(r,i))return;n.scrollTo(e.offsetLeft+r.width/2-i.width/2,e.offsetTop+r.height/2-i.height/2)}}}var Tc=n(377),Nc=n(690);var Cc=s.a.memo(function(e){var t=e.nextEditorActivity,n=e.waitingForActiveEditorActivityToComplete,r=e.setActiveEditorActivity;Object(i.useEffect)(function(){n||""===t||r(t)},[t,r,n]);return null}),kc={setActiveEditorActivity:to},Lc=Object(q.connect)(function(e){return{nextEditorActivity:e.uiState.nextEditorActivity,waitingForActiveEditorActivityToComplete:e.uiState.waitingForActiveEditorActivityToComplete}},kc)(Cc),Ac=function(){return(Ac=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)},Oc=s.a.memo(function(e){var t=e.activePivot,n=e.pivotItems,r=e.styles,o=e.showHeaderText,u=void 0===o||o,a=e.onChange,f=Object(i.useContext)(me).logWarningEvent,l=Object(i.useContext)(_e).strings,c=Object(i.useState)(null),h=c[0],p=c[1],d=Object(i.useRef)({}),v=Object(i.useCallback)(function(e,n){if(e){e.props.itemKey||f({id:"InvalidPivotKey",message:"Missing pivot key on ControlPivot click. Current active pivot is "+t});a(e.props.itemKey,n)}},[a,f,t]),m=(function(e,t,n){var r=ba();return Object(i.useCallback)(function(i){if(!i)return null;var o=i.itemCount,u=i.itemIcon,a=i.headerText,f=t?t.props.styles:e,l=Object(Tc.e)()(f,{theme:r});return s.a.createElement("span",{ref:function(e){n.current&&i.itemKey&&(n.current[i.itemKey]=e)},className:l.linkContent},void 0!==u&&s.a.createElement("span",{className:l.icon},s.a.createElement(Nc.e,{iconName:u})),void 0!==a&&s.a.createElement("span",{className:l.text}," ",i.headerText),void 0!==o&&s.a.createElement("span",{className:l.count}," (",o,")"))},[n,t,e,r])})(r,h,d);(function(e,t){Object(i.useEffect)(function(){var n,r;t.current&&xc(null===(r=null===(n=t.current[e])||void 0===n?void 0:n.parentElement)||void 0===r?void 0:r.parentElement,!0)},[e,t])})(t,d);return s.a.createElement(s.a.Fragment,null,s.a.createElement(Lc,null),s.a.createElement(bc.e,{ref:p,selectedKey:t,onLinkClick:v,headersOnly:!0,styles:r},n.map(function(e){var t=u?l[e.localizationKey]:"";return s.a.createElement(wc.e,Ac({key:e.itemKey},e,{headerText:t,ariaLabel:l[e.localizationKey],onRenderItemLink:m}))})))}),Mc={onChange:eo},_c=Object(q.connect)(function(e){return{activePivot:e.uiState.activeEditorActivity}},Mc)(Oc),Dc=Vt([function(e){return e.animations.gridLineVisibility.numGridLines},df],function(e,t){return(function(e,t){if(e)return e;switch(t){case gr.keyboardRotating:case gr.rotating:return 8;case gr.usingNineSliceCropHandles:case gr.selectingSecondCorner:case gr.draggingImage:case gr.keyboardCropping:case gr.zoomToCrop:return 2;default:return 0}})(e,t)}),Pc=Vt([function(e){return nr(e.animations.gridLineVisibility,e.animations.currentTime,100)},function(e){return nr(e.animations.dismissGridLineVisibility,e.animations.currentTime,400)},function(e){return xf(e)||e.rotationUi.rotationBarPointer.isDown},mf,pf,df],function(e,t,n,r,i,s){return di(n,r,i,e,t,s)}),Hc=function(){return(Hc=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)},Bc=s.a.memo(function(e){return s.a.createElement(Fa,Hc({image:null},e))});function jc(e){return function(t){var n=t;return n=n.split("@").join("_"+e)}}var Fc=(function(){function e(e){void 0===e&&(e=[]);this._effects=[];this._effects=e}e.prototype.getShaderProgramName=function(){return this._effects.reduce(function(e,t){return e+" "+t.getName()},"image")};e.prototype.getUniformNames=function(){var e=[];this._effects.forEach(function(t,n){e=e.concat(t.getUniformNames(jc(n)))});return e};e.prototype.getSamplerNames=function(){var e=[];this._effects.forEach(function(t,n){t.getSamplerNames&&(e=e.concat(t.getSamplerNames(jc(n))))});return e};e.prototype.getEffects=function(){return this._effects};e.prototype.registerEffect=function(e){this.unRegisterEffect(e);this._effects.push(e)};e.prototype.unRegisterEffect=function(e){this._effects=this._effects.filter(function(t){return t!==e})};e.prototype.getHeaderCode=function(){var e=this._effects.reduce(function(e,t,n){t.getFunctions(jc(n)).forEach(function(t){e[t]=""});return e},{});return"// functions -- \n"+Object.keys(e).join("\n\n")+this._effects.reduce(function(e,t,n){return e+t.getHeaderCode(jc(n))},"// shader effects -- \n")};e.prototype.getBodyCode=function(){return this._effects.reduce(function(e,t,n){return e+t.getShaderFunctionBody(jc(n))},"// shader effects -- \n")};e.prototype.onBeforeBabylonRender=function(e){this._effects.forEach(function(t,n){t.onBeforeBabylonRender(e,jc(n))})};e.prototype.onBeforeGlRender=function(e,t){this._effects.forEach(function(n,r){n.onBeforeGlRender(e,t,jc(r))})};return e})(),Ic="\n#ifndef GAMMALINEARSPACE\n#define GAMMALINEARSPACE\n\nconst float LinearEncodePowerApprox = 2.2;\nconst float GammaEncodePowerApprox = 1.0 / LinearEncodePowerApprox;\n\nvec3 toLinearSpace(vec3 color)\n{\n    return pow(color, vec3(LinearEncodePowerApprox));\n}\n\nvec3 toGammaSpace(vec3 color)\n{\n    return pow(color, vec3(GammaEncodePowerApprox));\n}\n#endif\n",qc=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),i=0;for(t=0;t<n;t++)for(var s=arguments[t],o=0,u=s.length;o<u;o++,i++)r[i]=s[o];return r},Rc="textureSampler",Uc="uv",zc="uScreenPixelPos",Wc="uTransform",Xc="uTransformInverse",Vc="uDisplaySize",$c="uColorOverrideLevel",Jc="uColorOverride",Kc="secondaryBlendTextureSampler",Qc="uSecondaryBlend",Gc="secondaryOverlayTextureSampler",Yc="uOverlayTextureAlpha",Zc="uIsRenderingForExport",eh="position",th=[Jc,$c,Vc,Rc,zc,Wc,Xc,Uc,Kc,Qc,Gc,Yc,Zc],nh=[eh],rh=[Rc,Kc,Gc];var ih=function(e,t){return"\n    #ifdef GL_ES\n    precision highp float;\n    #endif\n    varying highp vec2 "+zc+";\n    uniform sampler2D "+Rc+";\n    uniform vec4 "+Jc+";\n    uniform float "+$c+";\n    uniform mat3 "+Wc+";\n    uniform mat3 "+Xc+";\n    uniform vec2 "+Vc+";\n    uniform float "+Zc+";\n    varying vec3 uvPosition;\n\n    "+e+"\n\n    "+Ic+"\n\n    #ifdef ENABLE_SECONDARY_BLEND\n      uniform sampler2D "+Kc+";\n      uniform float "+Qc+";\n    #endif\n\n    #ifdef ENABLE_SECONDARY_OVERLAY\n      uniform sampler2D "+Gc+";\n      uniform float "+Yc+";\n    #endif\n\n    vec4 getTextureColor(vec2 uv){\n      #ifdef ENABLE_SECONDARY_BLEND\n        return mix(texture2D("+Rc+", uv),texture2D("+Kc+", uv),"+Qc+");\n      #else\n        return texture2D("+Rc+", uv);\n      #endif\n    }\n\n    void main(void) {\n\n        float finalAlphaMultiply = 1.;\n        vec3 "+Uc+" = uvPosition;\n        gl_FragColor = getTextureColor("+Uc+".xy);\n        gl_FragColor = mix(gl_FragColor,"+Jc+","+$c+");\n\n        // effect 'body' code is inserted here.\n        // effect can can modify the above variables.\n        "+t+"\n\n      #ifdef ENABLE_SECONDARY_OVERLAY\n        vec4 overlayColor = texture2D("+Gc+", "+Uc+".xy);\n\n        float overlayBlendedAlpha = overlayColor.a + gl_FragColor.a * (1. - overlayColor.a);\n        vec4 overlayBlendedColor = vec4((overlayColor.rgb * overlayColor.a + gl_FragColor.rgb * gl_FragColor.a * (1. - overlayColor.a)) / overlayBlendedAlpha, overlayBlendedAlpha);\n        gl_FragColor = mix(gl_FragColor, overlayBlendedColor, "+Yc+");\n\n        #endif\n\n      gl_FragColor.a *= finalAlphaMultiply;\n    }\n  "},sh=function(e,t){var n=Object(i.useMemo)(function(){return(function(e){return"\n    #ifdef GL_ES\n    precision highp float;\n    #endif\n\n    attribute vec4 "+eh+";\n    varying highp vec2 "+zc+";\n    uniform vec2 "+Vc+";\n    uniform mat3 "+Wc+";\n    uniform mat3 "+Xc+";\n    varying vec3 uvPosition;\n\n    void main(void) {\n      "+(e?"vec3 pos = vec3("+eh+".x* 0.5 + 0.5, "+eh+".y* 0.5 + 0.5, 1.0) * "+Wc+";":"vec3 pos = vec3("+eh+".x, "+eh+".y, 1.0) * "+Wc+";")+"\n\n      "+zc+" = pos.xy;\n      uvPosition = vec3("+zc+".x, "+zc+".y,1.0) * "+Xc+";\n\n      //convert to GL coordinates.\n      pos.x = (pos.x / "+Vc+".x) * 2.0 - 1.0;\n      pos.y = (-pos.y /"+Vc+".y) * 2.0 + 1.0;\n\n      gl_Position = vec4(pos.x,pos.y,0.0,1.0);\n    }\n  "})(e)},[e]),r=Object(i.useState)(ih("","")),s=r[0],o=r[1],u=Object(i.useState)(""),a=u[0],f=u[1],l=Object(i.useState)(th),c=l[0],h=l[1],p=Object(i.useState)(rh),d=p[0],v=p[1],m=Object(i.useMemo)(function(){return nh},[]),g=t.getShaderProgramName();Object(i.useLayoutEffect)(function(){if(a!==g){f(t.getShaderProgramName());h(qc(t.getUniformNames(),th));o(ih(t.getHeaderCode(),t.getBodyCode()));v(qc(t.getSamplerNames(),rh))}},[t,a,g]);return[g,n,s,m,d,c]},oh="\nfloat shadowLevel(vec2 shadowPos, mat3 handleTransform, mat3 cropTransform) {\n  #define shadowSamples 15\n  float angle = 0.;\n  float total = 0.;\n  float fSamples = float(shadowSamples);\n\n  for(int i = 0; i < shadowSamples; i++) {\n    float normalizedRadius = sqrt(float(i + 1) / fSamples);\n    float r = 5. * normalizedRadius;\n    vec2 sampleDir = vec2(cos(angle), sin(angle));\n    total += handleShape(shadowPos + sampleDir * r, handleTransform, cropTransform);\n    angle += 2.39996;\n  }\n\n  return total / fSamples;\n}\n",uh="\nfloat inTransform(mat3 posToUv, vec2 pixelPos){\n  vec3 uv = vec3(pixelPos, 1.) * posToUv;\n  if(uv.x < 0. || uv.x > 1. || uv.y < 0. || uv.y > 1.) {\n    return 0.;\n  }\n  return 1.;\n}\n",ah="\nfloat handleShape(in vec2 pixelPos, mat3 handleTransform, mat3 cropTransform) {\n  float inCrop = inTransform(cropTransform, pixelPos);\n  float inHandleRect = inTransform(handleTransform, pixelPos);\n  return clamp(inHandleRect - inCrop, 0., 1.);\n}\n",fh="\nvec4 cropHandle(in vec4 elbowColor, in vec2 pixelPos, mat3 handleTransform, mat3 cropTransform, float shadowSize) {\n  vec4 fragColor = vec4(0.);\n  vec2 shadowOffset = vec2(0., 3.);\n  vec4 shadowColor = vec4(vec3(0.), 0.33);\n\n  float inHandle = handleShape(pixelPos, handleTransform, cropTransform);\n  if(inHandle >= 1. ) { //if we are in the shape, no need to calculate the shadow.\n      return mix(fragColor, elbowColor, elbowColor.a);\n  } else {\n    vec2 shadowPos = pixelPos - shadowOffset;\n    float shadowBlend = shadowLevel(shadowPos, handleTransform, cropTransform);\n    return mix(fragColor, shadowColor, shadowBlend);\n  }\n}\n",lh=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),i=0;for(t=0;t<n;t++)for(var s=arguments[t],o=0,u=s.length;o<u;o++,i++)r[i]=s[o];return r},ch=(function(){function e(){this._visible=!1;this._shadowSize=3;this._cropTransform=[1,0,0,0,1,0];this._handleTransform=[1,0,0,0,1,0]}e.prototype.setVisible=function(e){this._visible=e};e.prototype.setShadowSize=function(e){this._shadowSize=e};e.prototype.setCropTransform=function(e){this._cropTransform=e};e.prototype.setHandleTransform=function(e){this._handleTransform=e};e.prototype.getName=function(){return"CropHandleElbowShapeShader"};e.prototype.getUniformNames=function(e){return[e("uVisible@"),e("uShadowSize@"),e("uCropTransformInverse@"),e("uHandleTransformInverse@")]};e.prototype.getFunctions=function(){return[uh,ah,oh,fh]};e.prototype.getHeaderCode=function(e){return e("//CropHandleElbowShape effect---\n        uniform float uVisible@;\n        uniform float uShadowSize@;\n        uniform mat3 uCropTransformInverse@;\n        uniform mat3 uHandleTransformInverse@;\n    ")};e.prototype.getShaderFunctionBody=function(e){return e("//CropHandleElbowShape effect---\n        gl_FragColor = cropHandle(gl_FragColor,"+zc+".xy,uHandleTransformInverse@,uCropTransformInverse@,uShadowSize@);\n        gl_FragColor.a = gl_FragColor.a * uVisible@;\n        ")};e.prototype.onBeforeBabylonRender=function(e,t){e.setFloat(t("uVisible@"),this._visible?1:0);e.setFloat(t("uShadowSize@"),this._shadowSize);e.setMatrix3x3(t("uCropTransformInverse@"),new Float32Array(lh(qn(this._cropTransform),[0,0,1])));e.setMatrix3x3(t("uHandleTransformInverse@"),new Float32Array(lh(qn(this._handleTransform),[0,0,1])))};e.prototype.onBeforeGlRender=function(e,t,n){e.uniform1f(e.getUniformLocation(t,n("uVisible@")),this._visible?1:0);e.uniform1f(e.getUniformLocation(t,n("uShadowSize@")),this._shadowSize);e.uniformMatrix3fv(e.getUniformLocation(t,n("uCropTransformInverse@")),!1,new Float32Array(lh(qn(this._cropTransform),[0,0,1])));e.uniformMatrix3fv(e.getUniformLocation(t,n("uHandleTransformInverse@")),!1,new Float32Array(lh(qn(this._handleTransform),[0,0,1])))};return e})(),hh=s.a.createContext({textures:{main:null,blend:null,overlay:null}});function ph(e){var t=Object(i.useContext)(hh).registry;Object(i.useLayoutEffect)(function(){if(t){var n="function"==typeof e?e():e;t.registerEffect(n);return function(){t&&t.unRegisterEffect(n)}}},[e,t])}var dh=(function(){function e(){this._needsRender=!1;this._isRendering=!1;this._renderers=new Map}e.prototype.register=function(e,t,n){this._renderers.set(e,{func:t,zIndex:n});this._needsRender=!0};e.prototype.unregister=function(e){this._renderers.delete(e);this._needsRender=!0};e.prototype.requestRender=function(){this._needsRender=!0};e.prototype.startRendering=function(){if(!this._isRendering){this._isRendering=!0;this._renderNextFrame()}};e.prototype.stopRendering=function(){this._isRendering=!1};e.prototype.renderNow=function(){this._render()};e.prototype._render=function(){var e=[];this._renderers.forEach(function(t){e.push(t)});e.sort(function(e,t){return e.zIndex-t.zIndex});e.forEach(function(e){return e.func()})};e.prototype._renderNextFrame=function(){var e=this;if(this._isRendering){if(this._needsRender){this._render();this._needsRender=!1}window.requestAnimationFrame(function(){e._renderNextFrame()})}};return e})(),vh=Object(i.createContext)({renderList:new dh}),mh=s.a.memo(function(e){var t=Object(i.useMemo)(function(){return{renderList:new dh}},[]);Object(i.useEffect)(function(){t.renderList.startRendering();return function(){t.renderList.stopRendering()}},[t]);return s.a.createElement(vh.Provider,{value:t},e.children)}),gh=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),i=0;for(t=0;t<n;t++)for(var s=arguments[t],o=0,u=s.length;o<u;o++,i++)r[i]=s[o];return r};function yh(e,t){var n=Object(i.useContext)(vh).renderList;Object(i.useLayoutEffect)(function(){if(n){var r=Bu();n.register(r,e,t);return function(){n.unregister(r)}}},[n,e,t]);Object(i.useLayoutEffect)(function(){n&&n.requestRender()},[n])}function bh(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=Object(i.useContext)(vh).renderList;Object(i.useLayoutEffect)(function(){n&&n.requestRender()},gh([n],e))}function wh(e){void 0===e&&(e=[0,0,0,0,0,0]);var t=Object(i.useContext)(vh).renderList,n=e[0],r=e[1],s=e[2],o=e[3],u=e[4],a=e[5];Object(i.useLayoutEffect)(function(){t&&t.requestRender()},[t,n,r,s,o,u,a])}var Eh=function(e){var t=e.visible,n=e.shadowSize,r=e.cropTransform,s=e.handleTransform,o=Object(i.useMemo)(function(){return new ch},[]);o.setVisible(t);o.setShadowSize(n);o.setCropTransform(r);o.setHandleTransform(s);bh(t);ph(o);return null},Sh=[0,0,0,1],xh=[1,0,0,1],Th=[0,0,0,0],Nh=function(e){if(e){var t=Object(uc.e)(e);return t&&[t.r/255,t.g/255,t.b/255,t.a||1]}};function Ch(e){return Object(i.useMemo)(function(){var t=Nh(e),n=Th;t&&(n=[t[0],t[1],t[2],1]);return n},[e])}var kh=function(e){var t=e.cropTransform,n=e.handlePos,r=e.cropHandlePhysicalPixelSize,i=e.zIndex,o=e.cssToPhysicalPixelRatio,u=e.canvasSize,a=e.visible,f=e.isFocused,l=Ch(ba().palette.neutralDark),c=3*(o=o||1),h=(function(e,t,n,r){var i=Xr(e),s=Wn(r),o=Xn(r),u=dn(Rn(r,i),pn(mn(s,xn(n,t-n,i.x)),mn(o,xn(n,t-n,i.y)))),a=jn(r);return ks({x:u.x,y:u.y,width:t,height:t,rotation:a})})(n,r,Math.round(3*o),t),p=Zn(h,2*c),d=Zn(h,Math.round(4*o));return s.a.createElement(s.a.Fragment,null,s.a.createElement(Bc,{zIndex:i,color:l,transform:p},s.a.createElement(Eh,{shadowSize:c,visible:a,cropTransform:t,handleTransform:h})),f&&s.a.createElement(Ia,{canvasSize:u,transform:d,zIndex:i+1}))};var Lh=Vt([Tf,mf,function(e){return e.animations.crop.animatedMatrix||pf(e)}],function(e,t,n){return Jn(e||t,n)}),Ah={setCssToPhysicalPixelRatio:Do,setCropHandleSizeCss:_o},Oh=Object(q.connect)(function(e){var t=e.transformTools,n=t.device.pixelRatio,r=t.view.viewportPixelSize,i=t.cropInteraction,s=i.mode,o=i.focusedHandleIndex,u=i.isKeyboardFocused,a=t.cropUiDisplay.handleSizeCss,f=t.pointer.movePos,l=t.image.loadedPixelSize;return{cropTransform:Lh(e.transformTools),canvasPixelSize:r,numCropGridLines:Dc(e.transformTools),cropGridLinesVisibilityValue:Pc(e.transformTools),cropUiMode:s,cropHandlePhysicalPixelSize:$r(a,n),cssToPhysicalPixelRatio:n,pointerPos:f,focusedHandle:o,isKeyboardFocused:u,visible:!!l}},Ah)(function(e){var t=e.cropHandlePhysicalPixelSize,n=e.canvasPixelSize,r=e.cropTransform,o=e.cropUiMode,u=e.numCropGridLines,a=e.cropGridLinesVisibilityValue,f=e.pointerPos,l=e.focusedHandle,c=e.isKeyboardFocused,h=e.visible,p=e.cssToPhysicalPixelRatio,d=Ch(ba().palette.neutralPrimary),v=o!==gr.draggingView&&o!==gr.selectingFirstCorner&&o!==gr.selectingSecondCorner,m=s.a.createElement(s.a.Fragment,null),g=s.a.createElement(s.a.Fragment,null);if(o===gr.selectingFirstCorner){var y={left:0,top:f.y,width:n.x,height:1};m=s.a.createElement(Bc,{zIndex:2,color:d,transform:Pr(y)});var b={left:f.x,top:0,width:1,height:n.y};g=s.a.createElement(Bc,{zIndex:2,color:d,transform:Pr(b)})}var w=Object(i.useMemo)(function(){return Hr(r)},[r]);return(function(e){var t=Object(i.useState)(!1),n=t[0],r=t[1],s=Object(i.useRef)(e);s.current=e;Object(i.useLayoutEffect)(function(){if(e){var t=window.requestAnimationFrame(function(){setTimeout(function(){r(s.current)})});return function(){window.cancelAnimationFrame(t)}}},[e]);return e&&n})(h)?s.a.createElement(s.a.Fragment,null,[mr.TopLeft,mr.TopCenter,mr.TopRight,mr.SideLeft,mr.SideRight,mr.BottomLeft,mr.BottomCenter,mr.BottomRight].map(function(e){var i="cropHandle"+e;return s.a.createElement(kh,{key:i,handlePos:e,isFocused:e===l&&c,cropHandlePhysicalPixelSize:t,cropTransform:r,canvasSize:n,zIndex:2,cssToPhysicalPixelRatio:p,visible:v})}),o!==gr.selectingFirstCorner&&s.a.createElement(Ia,{canvasSize:n,transform:r,zIndex:2}),m,g,s.a.createElement(ja,{cropRect:w,linesCount:u,alpha:a,canvasSize:n})):null}),Mh=n(1617),_h=n(395);Object(_l.n)([{rawString:".spinner_cc592d97{height:100%;width:100%;opacity:.8;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;position:absolute;z-index:200}"}]);var Dh="spinner_cc592d97",Ph=Object(i.memo)(function(e){var t=e.loading,n=ba();return t?s.a.createElement(Mh.e,{className:Dh,style:{background:n.palette.white},size:_h.e.large}):null});Ph.displayName="LoadingSpinner";var Hh=Object(q.connect)(function(e){return{loading:e.uiState.waitingForActiveEditorActivityToComplete}})(Ph),Bh=s.a.memo(function(e){var t=e.handleSizeCss,n=e.handleHitAreaSizeCss,r=e.setCropHandleSizeCss;Object(i.useLayoutEffect)(function(){r({handleSizeCss:t,handleHitAreaSizeCss:n})},[r,t,n]);return null}),jh={setCropHandleSizeCss:_o},Fh=Object(q.connect)(void 0,jh)(Bh),Ih=Vt([pf],function(e){var t=gn(Br(e));return{width:t.x,height:t.y}}),qh=Vt([Ih],function(e){return e.width}),Rh=Vt([Ih],function(e){return e.height}),Uh=Vt([pf,mf],function(e,t){return Hr(Jn(t,e))});Object(_l.n)([{rawString:".ms-Fabric--isFocusVisible .cropUIRectangle_60ad306f{visibility:visible}.cropUIRectangle_60ad306f{position:absolute;justify-self:center}.cropUIRectangle_60ad306f:focus{outline:0}.cropUIRectangle_60ad306f:focus-visible{outline:3px solid #fff}"}]);var zh="cropUIRectangle_60ad306f";function Wh(e,t){e&&("function"==typeof e?e(t):e.current=t)}Object(_l.n)([{rawString:".cropRectCorner_aeba7ec3{position:absolute;-ms-touch-action:none;touch-action:none}.cropRectCorner_aeba7ec3:focus{outline:0}"}]);var Xh="cropRectCorner_aeba7ec3";function Vh(e,t,n){var r=t.getBoundingClientRect();return{x:Math.floor((e.x-r.left)*n),y:Math.floor((e.y-r.top)*n)}}function $h(e,t,n){if(e){return pn(t,{x:e.offsetLeft*n,y:e.offsetTop*n})}return t}function Jh(e){Object(i.useEffect)(function(){if(e){var t=function(e){e.preventDefault();return!1};e.addEventListener("contextmenu",t);return function(){return e.removeEventListener("contextmenu",t)}}},[e])}var Kh=function(e,t,n,r,s,o,u){var a=Object(i.useRef)(0);Object(i.useEffect)(function(){if(t){var i=function(t){if(s(t)){t.altKey&&t.preventDefault();t.stopPropagation();if(o(t))u(t);else if(a.current<e){a.current+=1;n(t)}else r(t)}},f=function(){a.current=0};t.addEventListener("keydown",i);t.addEventListener("keyup",f);return function(){t.removeEventListener("keydown",i);t.removeEventListener("keyup",f)}}},[t,r,n,a,e,s,o,u])};function Qh(e,t,n){Object(i.useEffect)(function(){var r=function(r){if(t){var i=Vh({x:r.clientX,y:r.clientY},t,e);if(r.cancelable){r.preventDefault();n&&n({mousePhysicalPixelPos:i,deltaY:r.deltaY,deltaMode:r.deltaMode,ctrlKey:r.ctrlKey})}}};t&&t.addEventListener("wheel",r,{passive:!1});return function(){t&&t.removeEventListener("wheel",r)}},[t,n,e])}var Gh={initiatingButtonId:0,heldButtonsFlags:1};function Yh(e,t){return e===t.initiatingButtonId}function Zh(e,t){return!!((e||0)&t.heldButtonsFlags)}function ep(e){return void 0===(t=e.button)||Yh(t,Gh);var t}function tp(e){return void 0===(t=e.buttons)||Zh(t,Gh);var t}function np(e){return"touch"===e.pointerType||(t=Gh,Zh(e.buttons,t));var t}function rp(e,t,n,r,i,s,o,u){(function(e,t){e.current&&window.cancelAnimationFrame(e.current);e.current=window.requestAnimationFrame(t)})(r,function(){return ip(e,t,n,i,s,o,u)})}function ip(e,t,n,r,i,s,o){r({pointerPhysicalPixelPos:Vh({x:e.clientX,y:e.clientY},n,t),isPrimaryButtonDownOrTouchDown:i,ctrlKey:e.ctrlKey,shiftKey:e.shiftKey,isTouch:"touch"===s,pointerId:o})}var sp=function(){},op=function(e,t,n,r,s){void 0===n&&(n=sp);void 0===r&&(r=sp);void 0===s&&(s=sp);var o=Object(i.useRef)(),u=Object(i.useRef)(new Set);Object(i.useEffect)(function(){if(e){var i=function(t){try{u.current.delete(t);e.releasePointerCapture(t)}catch(e){}},a=function(r){if(r.isPrimary||"touch"===r.pointerType){var i=np(r);i&&(function(t){e.setPointerCapture(t);u.current.add(t)})(r.pointerId);ip(r,t,e,n,i,r.pointerType,r.pointerId)}},f=function(n){(n.isPrimary||"touch"===n.pointerType)&&rp(n,t,e,o,r,np(n),n.pointerType,n.pointerId)},l=function(n,r){if(n.isPrimary||"touch"===n.pointerType){r||i(n.pointerId);ip(n,t,e,s,!1,n.pointerType,n.pointerId)}},c=function(e){l(e,!1)},h=function(e){l(e,!0)};e.addEventListener("pointerdown",a);e.addEventListener("pointermove",f);e.addEventListener("pointerup",c);e.addEventListener("lostpointercapture",h);return function(){e.removeEventListener("pointerdown",a);e.removeEventListener("pointermove",f);e.removeEventListener("pointerup",c);e.removeEventListener("lostpointercapture",h);(function(){for(var e=0,t=Array.from(u.current);e<t.length;e++){var n=t[e];i(n)}})()}}},[n,r,s,e,t])};function up(e,t,n,r,s,o){var u=Object(i.useMemo)(function(){return t?new Xl.a(t,{recognizers:[[Xl.a.Pinch],[Xl.a.Tap,{taps:2,event:"doubletap"}]],touchAction:"compute"}):null},[t]);Object(i.useEffect)(function(){if(t&&u){var i=function(r){n&&n({center:Vh(r.center,t,e),scale:r.scale})},a=function(n){r&&r({center:Vh(n.center,t,e),scale:n.scale})},f=function(n){s&&s({center:Vh(n.center,t,e),scale:n.scale})},l=function(n){o&&o({center:Vh(n.center,t,e),scale:n.scale})};u.on("pinchstart",i);u.on("pinchmove",a);u.on("pinchend",f);u.on("doubletap",l);return function(){u.off("pinchstart",i);u.off("pinchmove",a);u.off("pinchend",f);u.off("doubletap",l)}}},[t,n,r,s,o,e,u])}function ap(e,t,n,r,s,o,u,a,f,l,c,h,p,d,v,m,g){var y=Object(i.useCallback)(function(n){if(l&&e){n.pointerPhysicalPixelPos=$h(e,n.pointerPhysicalPixelPos,t);l(n)}},[e,l,t]),b=Object(i.useCallback)(function(n){if(c&&e){n.pointerPhysicalPixelPos=$h(e,n.pointerPhysicalPixelPos,t);c(n)}},[e,c,t]),w=Object(i.useCallback)(function(n){if(h&&e){n.pointerPhysicalPixelPos=$h(e,n.pointerPhysicalPixelPos,t);h(n)}},[e,h,t]),E=Object(i.useCallback)(function(n){if(p&&e){n.mousePhysicalPixelPos=$h(e,n.mousePhysicalPixelPos,t);p(n);a({type:"Zoom",zoom:r})}},[p,e,t,a,r]),S=Object(i.useCallback)(function(n){if(d&&e){n.center=$h(e,n.center,t);d(n)}},[t,e,d]),x=Object(i.useCallback)(function(n){if(v&&e){n.center=$h(e,n.center,t);v(n)}},[t,e,v]),T=Object(i.useCallback)(function(n){if(m&&e){n.center=$h(e,n.center,t);m(n);a({type:"CropImageDimension",cropDimension:ku})}},[t,e,m,a]),N=Object(i.useCallback)(function(n){if(g&&e){n.center=$h(e,n.center,t);g(n)}},[t,e,g]),C=Object(i.useCallback)(function(e){var t=cs(e.key);u({direction:t,handlePosition:n,cropShiftingValue:1});fp(n,s,o,a)},[u,n,a,s,o]),k=Object(i.useCallback)(function(e){var t=cs(e.key);u({direction:t,handlePosition:n,cropShiftingValue:10});fp(n,s,o,a)},[u,n,a,s,o]),L=Object(i.useCallback)(function(e){var t=cs(e.key);u({direction:t,handlePosition:n,cropShiftingValue:50});fp(n,s,o,a)},[u,n,a,s,o]);Object(i.useEffect)(function(){if(e){var t=function(e){e.stopPropagation();"focus"===e.type&&(hs()?f({handlePosition:n,isKeyboardFocused:!0}):f({handlePosition:n,isKeyboardFocused:!1}))};e.addEventListener("focus",t);return function(){e.removeEventListener("focus",t)}}},[e,n,u,f]);Kh(10,e,C,k,ds,ps,L);op(e,t,y,b,w);Qh(t,e,E);Jh(e);up(t,e,S,x,T,N)}function fp(e,t,n,r){e===mr.Center?r({type:"CropImageMove",cropTopLeftCornerFromImageOrigin:n}):r({type:"CropImageDimension",cropDimension:t})}var lp=Object(i.forwardRef)(function(e,t){var n=e.handlePosition,r=e.ariaLabel,o=e.style,u=e.cssToPhysicalPixelRatio,a=e.currentZoom,f=e.cropDimension,l=e.cropTopLeftCornerFromImageOrigin,c=e.handleCropRectAdjustment,h=e.setAriaAnnouncementScenario,p=e.setFocusedCropHandle,d=e.onPointerDown,v=e.onPointerMove,m=e.onPointerUp,g=e.onWheel,y=e.onTouchDown,b=e.onTouchMove,w=e.onTouchUp,E=e.onDoubleTap,S=Object(i.useContext)(_e).strings,x=Object(i.useState)(null),T=x[0],N=x[1];Object(i.useEffect)(function(){Wh(t,T)},[t,T]);ap(T,u,n,a,f,l,c,h,p,d,v,m,g,y,b,w,E);return s.a.createElement("div",{ref:N,"data-is-focusable":!0,"aria-label":r,title:S.crop_cornerTooltip,role:"button",className:Xh,tabIndex:0,style:o,"data-test-id":"crop-corner-handle-"+n})});lp.displayName="CropRectCorner";function cp(e,t){return sc(e,t.x.toString(),t.y.toString())}var hp=function(){return(hp=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)},pp=s.a.memo(function(e){var t=e.cropUIRectangle,n=e.cssToPhysicalPixelRatio,r=e.cursor,o=e.currentZoom,u=e.cropDimension,a=e.cropTopLeftCornerFromImageOrigin,f=e.handleCropRectAdjustment,l=e.setAriaAnnouncementScenario,c=e.setFocusedCropHandle,h=e.onPointerDown,p=e.onPointerMove,d=e.onPointerUp,v=e.onWheel,m=e.onTouchDown,g=e.onTouchMove,y=e.onTouchUp,b=e.onDoubleTap,w=Object(i.useContext)(_e).strings,E=(function(e){var t=Object(i.useContext)(_e).strings;return Object(i.useMemo)(function(){return cp(t.crop_topLeftCornerAriaLabel,e)},[t,e])})(a),S=(function(e,t){var n=Object(i.useContext)(_e).strings;return Object(i.useMemo)(function(){var r={x:e.x+t.width,y:e.y};return cp(n.crop_topRightCornerAriaLabel,r)},[n,e,t])})(a,u),x=(function(e,t){var n=Object(i.useContext)(_e).strings;return Object(i.useMemo)(function(){var r={x:e.x,y:e.y+t.height};return cp(n.crop_bottomLeftCornerAriaLabel,r)},[n,e,t])})(a,u),T=(function(e,t){var n=Object(i.useContext)(_e).strings;return Object(i.useMemo)(function(){var r={x:e.x+t.width,y:e.y+t.height};return cp(n.crop_bottomRightCornerAriaLabel,r)},[n,e,t])})(a,u),N=Object(i.useState)(null),C=N[0],k=N[1];ap(C,n,mr.Center,o,u,a,f,l,c,h,p,d,v,m,g,y,b);var L={handleCropRectAdjustment:f,setAriaAnnouncementScenario:l,setFocusedCropHandle:c,onPointerDown:h,onPointerMove:p,onPointerUp:d,onWheel:v,cssToPhysicalPixelRatio:n,currentZoom:o,cropDimension:u,cropTopLeftCornerFromImageOrigin:a},A={cursor:r,width:30,height:30};return s.a.createElement(s.a.Fragment,null,s.a.createElement("div",{className:zh,style:{width:t.width/n,height:t.height/n,top:t.top/n,marginLeft:t.left/n,marginRight:t.left/n,cursor:r},"data-is-focusable":!0,"data-test-id":"cropUIRectangle",ref:k,"aria-label":w.crop_rectangleAriaLabel,title:w.crop_rectangleTooltip,role:"img",tabIndex:0}),s.a.createElement(lp,hp({handlePosition:mr.TopLeft,ariaLabel:E,style:hp(hp({},A),{top:t.top/n,left:t.left/n})},L)),s.a.createElement(lp,hp({handlePosition:mr.TopRight,ariaLabel:S,style:hp(hp({},A),{top:t.top/n,left:(t.left+t.width)/n-30})},L)),s.a.createElement(lp,hp({handlePosition:mr.BottomLeft,ariaLabel:x,style:hp(hp({},A),{left:t.left/n,top:(t.top+t.height)/n-30})},L)),s.a.createElement(lp,hp({handlePosition:mr.BottomRight,ariaLabel:T,style:hp(hp({},A),{left:(t.left+t.width)/n-30,top:(t.top+t.height)/n-30})},L)))});var dp=Vt([df,function(e){return e.cropInteraction.shouldConstrainInImage},mf,Nf,xf,function(e){return e.pointer.movePos},function(e){return e.cropInteraction.activeHandleIndex},function(e){return e.view.allowDraggingView}],function(e,t,n,r,i,s,o,u){switch(e){case gr.selectingFirstCorner:return ki(t,Rn(qn(Jn(n,r)),s))?"crosshair":"not-allowed";case gr.selectingSecondCorner:return"crosshair";case gr.draggingView:return"grabbing";case gr.disabled:return i?"grabbing":"grab";case gr.usingNineSliceCropHandles:default:return(function(e,t,n,r){switch(e){case mr.TopLeft:case mr.BottomRight:return"nwse-resize";case mr.BottomLeft:case mr.TopRight:return"nesw-resize";case mr.SideLeft:case mr.SideRight:return"ew-resize";case mr.TopCenter:case mr.BottomCenter:return"ns-resize";case mr.Center:default:return n||r?t?"grabbing":"grab":"default"}})(o,i,Qi(s,n,r),u)}}),vp=Vt([mf],function(e){return Kn(e)}),mp=Vt([pf,wf],function(e,t){var n=Hr(t),r={x:n.left,y:n.top};return yn(dn(Yn(e),r))}),gp={handleCropRectAdjustment:Ro,setAriaAnnouncementScenario:Du,setFocusedCropHandle:zo,onPointerMove:wo,onPointerDown:Hs,onPointerUp:Bs,onWheel:Eo,onTouchDown:Lo,onTouchMove:Ao,onTouchUp:Oo,onDoubleTap:Mo},yp=Object(q.connect)(function(e){var t=e.transformTools.device.pixelRatio,n=dp(e.transformTools),r=vp(e.transformTools),i=Ih(e.transformTools);return{cropUIRectangle:Uh(e.transformTools),cssToPhysicalPixelRatio:t,cursor:n,currentZoom:r,cropDimension:i,cropTopLeftCornerFromImageOrigin:mp(e.transformTools)}},gp)(pp),bp={handlePointerMove:wo,handlePointerDown:Hs,handlePointerUp:Bs,handleMouseWheel:Eo,handleTouchDown:Lo,handleTouchMove:Ao,handleTouchUp:Oo,handleDoubleTap:Mo,handleFrameTick:go,abortCurrentMode:Io,setAriaAnnouncementScenario:Du},wp=Object(q.connect)(function(e){var t=e.transformTools,n=t.animations,r=n.needsFrameTick,i=n.image.animatedMatrix,s=t.device.pixelRatio,o=t.view,u=o.viewportPixelSize,a=o.viewportCssSize,f=Nf(e.transformTools),l=Cf(e.transformTools),c=i||f,h=vp(e.transformTools);return{imageTransformValues:c,imagePixelSize:l,canvasPixelSize:u,canvasCssSize:a,cursorStyle:dp(e.transformTools),cssToPhysicalPixelRatio:s,needsFrameTick:r,currentZoom:h}},bp)(function(e){var t=e.handlePointerDown,n=e.handlePointerMove,r=e.handlePointerUp,o=e.handleMouseWheel,u=e.handleTouchDown,a=e.handleTouchMove,f=e.handleTouchUp,l=e.handleDoubleTap,c=e.handleFrameTick,h=e.abortCurrentMode,p=e.setAriaAnnouncementScenario,d=e.cssToPhysicalPixelRatio,v=e.needsFrameTick,m=e.canvasPixelSize,g=e.canvasCssSize,y=e.cursorStyle,b=e.backgroundColor,w=e.currentZoom,E=e.children,S=Ch(ba().palette.neutralLighterAlt),x=Object(i.useCallback)(function(e){o(e);p({type:"Zoom",zoom:w})},[o,p,w]);Object(i.useEffect)(function(){var e=0,t=function(){e=window.requestAnimationFrame(t);c((new Date).getTime())};if(v){e=window.requestAnimationFrame(t);return function(){window.cancelAnimationFrame(e)}}},[v,c]);Object(i.useEffect)(function(){var e=function(e){"Esc"!==e.key&&"Escape"!==e.key||h()};document.addEventListener("keydown",e);return function(){document.removeEventListener("keydown",e)}},[h]);return s.a.createElement(mh,null,s.a.createElement(Ba,{width:m.x,height:m.y,color:b||S,cssWidth:g.width,cssHeight:g.height,cursor:y,onPointerDown:t,onPointerMove:n,onPointerUp:r,onWheel:x,onTouchDown:u,onTouchMove:a,onTouchUp:f,onDoubleTap:l,cssToPhysicalPixelRatio:d,isAnimating:v},E))}),Ep=Vt([Nf,mf,Tf,function(e){return e.animations.image.animatedMatrix}],function(e,t,n,r){return Jn(n||t,r||e)});var Sp,xp,Tp=function(){return(Tp=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)},Np={onMainTextureLoaded:bo,onOverlayTextureLoaded:no},Cp=Object(q.connect)(function(e,t){var n=t.children;return{transform:Ep(e.transformTools),children:n}},Np)((Sp=I.MainImage,xp=function(e){var t,n=Object(i.useContext)(Ha);t=e.image,Object(i.useLayoutEffect)(function(){if(t){performance.clearMarks(I.MainImage);performance.mark(I.MainImage)}},[t]);return s.a.createElement(n.image,Da({},e))},Object(i.forwardRef)(function(e,t){var n=(function(e,t){var n=Object(i.useContext)(me).logPageLoadTimeEvent,r=Object(i.useRef)({x:0,y:0});return Object(i.useCallback)(function(i){t&&t(i);if(r.current!==i.sizeInPixels){var s=window.requestAnimationFrame(function(){setTimeout(function(){n({pageLoadTimeMs:ge(e),component:e})})});r.current=i.sizeInPixels;return function(){window.cancelAnimationFrame(s)}}},[t,n,r,e])})(Sp,e.onMainTextureLoaded);return s.a.createElement(xp,Tp({},e,{onMainTextureLoaded:n,ref:t}))}))),kp=function(){return(kp=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)},Lp=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n},Ap={getEdits:function(){},resetEdits:function(){},setEdits:function(){}};var Op={resetEdits:js,setEdits:To,setAllAdjustments:Eu},Mp=Object(q.connect)(function(e){return{imageMatrix:Nf(e.transformTools),cropMatrix:e.transformTools.cropInteraction.uvToWorld,originalImageSize:e.transformTools.image.originalPixelSize,adjustments:e.colorAdjustments,filters:e.filters,autoEnhance:e.autoEnhance,aspectRatioConstraint:e.transformTools.cropInteraction.aspectRatioConstraint,markupContentItems:e.markup.markupContentItems}},Op)(function(e){var t=e.imageMatrix,n=e.cropMatrix,r=e.originalImageSize,s=e.adjustments,o=e.filters,u=e.autoEnhance,a=e.aspectRatioConstraint,f=e.markupContentItems,l=e.resetEdits,c=e.setEdits,h=e.setAllAdjustments,p=e.onEditsChanged,d=e.forwardedRef,v=Object(i.useMemo)(function(){return hf(n,t,r,s,o,u,a,f)},[t,n,r,s,o,u,a,f]),m=Se();Object(i.useEffect)(function(){p&&p()},[v,p]);var g=Object(i.useCallback)(function(e){var t=Re(e),n=t.isValid,r=t.message;if(n){var i=e.colorAdjustments,s=Lp(e,["colorAdjustments"]);c(s);i&&h(i)}else m({id:"SetEditsIgnored",message:"ValidationError: "+r})},[c,h,m]);Object(i.useImperativeHandle)(d,function(){return{getEdits:function(){return v},resetEdits:function(){return l(!1)},setEdits:g}},[v,l,g]);return null}),_p=Object(i.forwardRef)(function(e,t){return s.a.createElement(Mp,kp({},e,{forwardedRef:t}))}),Dp=function(){return(Dp=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)},Pp={getUiState:function(){},resetUiState:function(){},setUiState:function(){}};var Hp={setUiState:so,resetUiState:oo},Bp=Object(q.connect)(function(e){return{uiState:e.uiState}},Hp)(function(e){var t=e.uiState,n=e.resetUiState,r=e.setUiState,s=e.onUiStateChanged,o=e.forwardedRef,u=Object(i.useRef)(t);Object(i.useEffect)(function(){u.current=t;s&&s()},[t,s]);Object(i.useImperativeHandle)(o,function(){return{getUiState:function(){return Dp({},u.current)},resetUiState:n,setUiState:r}},[n,r]);return null}),jp=Object(i.forwardRef)(function(e,t){return s.a.createElement(Bp,Dp({},e,{forwardedRef:t}))}),Fp=s.a.memo(function(e){var t=e.cropWidth,n=e.cropHeight,r=e.position,o=e.visible,u=(function(e,t){var n=Object(i.useContext)(_e).strings,r=e.toString(),s=t.toString(),o=sc(n.editor_imageDimensionLabelFormatString,r,s),u=sc(n.editor_imageDimensionAriaLabelFormatString,r,s);return{imageDimension:o,imageDimensionAriaLabel:u}})(t,n),a=u.imageDimension,f=u.imageDimensionAriaLabel;return s.a.createElement(cc,{style:{top:r.y,left:r.x,transform:"translateX(-50%)"},visible:o},s.a.createElement("span",{"aria-label":f},a))});var Ip=Vt([Ef,df],function(e,t){return e&&t!==gr.none&&t!==gr.disabled}),qp=Vt([vc],function(e){return{x:e.left+e.width/2,y:e.top+e.height+-36}}),Rp=Object(q.connect)(function(e){return{cropWidth:qh(e.transformTools),cropHeight:Rh(e.transformTools),position:qp(e.transformTools),visible:Ip(e.transformTools)}})(Fp);function Up(e,t,n){return t?{width:e.x/n+"px",height:e.y/n+"px"}:{width:"100%",height:"100%"}}var zp=function(){return(zp=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)};function Wp(e,t,n){var r=n===window.devicePixelRatio,s=Object(i.useRef)(),o=!s.current||!r,u=Object(i.useCallback)(function(){if(e){var r=o?(function(e,t){var n=e.getBoundingClientRect();return{x:Math.floor(n.width*t),y:Math.floor(n.height*t)}})(e,n):s.current;r&&t({pixelSize:r,cssSize:Up(r,o,n)})}},[s,t,n,e,o]),a=Object(i.useCallback)(function(e){s.current=zp({},e);u()},[s,u]);(function(e,t){var n=Object(i.useCallback)(function(n){if(e){var r=n.find(function(t){return t.target===e});if(r&&r.devicePixelContentBoxSize&&r.devicePixelContentBoxSize[0]){var i=r.devicePixelContentBoxSize[0].inlineSize,s=r.devicePixelContentBoxSize[0].blockSize;t({x:i,y:s})}}},[t,e]);Object(i.useEffect)(function(){try{if(window.ResizeObserver&&e){var t=new ResizeObserver(n);t.observe(e,{box:"device-pixel-content-box"});return function(){t.disconnect()}}}catch(e){}},[e,n])})(e,a);return u}var Xp=s.a.memo(function(e){var t=e.setCanvasPixelSize,n=e.setCssToPhysicalPixelRatio,r=e.cssToPhysicalPixelRatio,o=e.canvasSize,u=e.activePivot,a=e.children,f=Object(i.useState)(null),l=f[0],c=f[1],h=r||window.devicePixelRatio||1;Object(i.useLayoutEffect)(function(){n(h)},[h,n]);var p=Wp(l,t,h);Object(i.useLayoutEffect)(function(){p()},[o,u,p]);return s.a.createElement("div",{style:{position:"relative",height:"100%",width:"100%"},ref:c},a)});Xp.displayName="SetCanvasSize";var Vp=function(){return(Vp=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)},$p={setCanvasPixelSize:yo,setCssToPhysicalPixelRatio:Do},Jp=Object(q.connect)(function(e){return{activePivot:e.uiState.activeEditorActivity}},$p)(function(e){return s.a.createElement(Xp,Vp({},e))}),Kp=function(e){return s.a.createElement(Jp,Vp({},e))};Kp.displayName="SetCanvasSizeConnect";var Qp=s.a.memo(function(e){var t=e.activeEditorActivity,n=e.match,r=e.children;return(Array.isArray(n)?n.some(function(e){return e===t}):n===t)?s.a.createElement(s.a.Fragment,null,r):null}),Gp=Object(q.connect)(function(e){return{activeEditorActivity:e.uiState.activeEditorActivity}},null)(Qp),Yp=function(){return(Yp=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)},Zp={setAriaAnnouncement:_u},ed=Object(q.connect)(function(e){var t=_f(Yp(Yp({},Nr),{colorAdjustments:e.colorAdjustments,filters:e.filters,autoEnhance:e.autoEnhance,markup:e.markup})),n=e.uiState.isViewingOriginal,r=!e.transformTools.animations.transitionToViewingOriginal.isActive,i=e.transformTools.cropInteraction.mode===gr.draggingView;return{visible:n&&t&&r&&!i}},Zp)(function(e){var t=e.visible,n=e.gutterSize,r=void 0===n?32:n,o=e.setAriaAnnouncement,u=Object(i.useContext)(_e).strings,a={bottom:r+"px",left:"50%",transform:"translateX(-50%)"};Object(i.useEffect)(function(){t&&o(u.editor_viewingOriginalAriaLive)},[t,o,u]);return s.a.createElement(cc,{visible:t,style:a},u.editor_viewingOriginal)});Object(_l.n)([{rawString:".EditorCommandBarStack_e8ecbb5e{padding:0 12px;overflow:hidden;height:44px}.CommandBarBeginningStackItem_e8ecbb5e{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.CommandBarMiddleStackItem_e8ecbb5e{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}.CommandBarEndStackItem_e8ecbb5e{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.CommandBarEndStackItem_e8ecbb5e>*{margin:0 4px}.MobileCommandBarStack_e8ecbb5e{padding:0 12px;overflow:hidden;height:56px}.MobileCommandBarEndStackItem_e8ecbb5e{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end;-webkit-box-align:center;-ms-flex-align:center;align-items:center;margin:0}"}]);var td,nd="EditorCommandBarStack_e8ecbb5e",rd="CommandBarBeginningStackItem_e8ecbb5e",id="CommandBarMiddleStackItem_e8ecbb5e",sd="CommandBarEndStackItem_e8ecbb5e",od="MobileCommandBarStack_e8ecbb5e",ud="MobileCommandBarEndStackItem_e8ecbb5e";(function(e){e[e.Small=0]="Small";e[e.Medium=1]="Medium";e[e.Large=2]="Large"})(td||(td={}));var ad=n(2782),fd=n(1154),ld=n(1608),cd=n(1115),hd=function(){return(hd=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)};function pd(e){return{root:{color:e.palette.themePrimary,fill:e.palette.themePrimary},rootHovered:{backgroundColor:e.palette.neutralLight},rootPressed:{backgroundColor:e.palette.neutralQuaternaryAlt},rootDisabled:{fill:e.palette.neutralTertiary},icon:{width:"16px",height:"16px"}}}function dd(e){return{backgroundColor:e.palette.themeSecondary,color:e.palette.white,border:"none"}}var vd={root:{fontSize:"18px",width:"18px",height:"18px",lineHeight:"18px"}};var md=n(1865).ReactReduxContext;function gd(){if(!md._currentValue)throw new Error("useStore must used within a Redux store. Ensure you have a ImageEditorContext defined.");return md._currentValue.store}function yd(){var e=Object(i.useContext)(Ca).enableMarkup,t=Object(i.useContext)(me).logMarkupSummaryEvent,n=gd();return Object(i.useCallback)(function(){if(e){var r=n.getState().markup;t({strokeCount:(null==r?void 0:r.markupContentItems.length)||0})}},[e,t,n])}function bd(e){var t=Object(i.useContext)(me).logCancelEvent,n=yd();return Object(i.useCallback)(function(){n();t({});e()},[t,e,n])}var wd=Object(i.memo)(function(e){var t=e.onCancel,n=e.styles,r=e.iconProps,o=ba(),u=Object(i.useContext)(_e).strings,a=Object(i.useMemo)(function(){return Object(wa.b)(pd(o),n)},[o,n]),f=bd(t);return s.a.createElement(s.a.Fragment,null,r?s.a.createElement(ld.e,{key:"Cancel",iconProps:r,styles:a,ariaLabel:u.toolbar_cancelAriaLabel,title:u.toolbar_cancelTooltip,role:"button",onClick:f}):s.a.createElement(cd.e,{key:"Cancel",text:"Cancel",styles:a,onClick:f,ariaLabel:u.toolbar_cancelAriaLabel,title:u.toolbar_cancelTooltip}))}),Ed=function(){return(Ed=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)},Sd=Object(i.memo)(function(e){var t=e.stackResponseMode,n=e.styles,r={color:ba().palette.neutralPrimaryAlt,lineHeight:"43px"};return s.a.createElement(s.a.Fragment,null,t>=td.Medium&&s.a.createElement("div",{style:Ed(Ed({},r),n)},"|"))}),xd=n(1122);function Td(e,t,n){var r=Object(i.useContext)(me).logEditResetEvent,s=Object(i.useContext)(Za).setImageOverlay;return Object(i.useCallback)(function(){r();e(!0);s(null);t(n)},[r,e,n,t,s])}var Nd=function(){return(Nd=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)},Cd=Object(i.memo)(function(e){var t=e.stackResponseMode,n=e.resetDisabled,r=e.resetEdits,o=e.setAriaAnnouncement,u=e.styles,a=ba(),f=Object(i.useContext)(_e).strings,l=Object(i.useMemo)(function(){return Object(wa.b)((function(e){return{root:{color:e.palette.neutralPrimary,height:"32px"},rootDisabled:{color:e.palette.neutralTertiary},rootHovered:{color:e.palette.neutralPrimary,backgroundColor:e.palette.neutralLight},rootPressed:{color:e.palette.neutralPrimary,backgroundColor:e.palette.neutralQuaternaryAlt},icon:{color:e.palette.themePrimary}}})(a),u)},[a,u]),c=Td(r,o,f.toolbar_imageResetFinishedAriaLive);return s.a.createElement(xd.e,{key:"Reset",text:t>td.Medium?f.toolbar_imageReset:void 0,styles:l,ariaLabel:f.toolbar_imageResetAriaLabel,title:f.toolbar_imageResetTooltip,iconProps:{iconName:"History"},onClick:c,disabled:n,role:"button","data-test-id":"reset",allowDisabledFocus:!0})}),kd={resetEdits:js,setAriaAnnouncement:_u},Ld=Object(q.connect)(function(e){return{resetDisabled:Hf(Nd(Nd({},e.transformTools),{colorAdjustments:e.colorAdjustments,filters:e.filters,autoEnhance:e.autoEnhance,markup:e.markup}))}},kd)(Cd),Ad=Object(i.memo)(function(e){var t=e.stackResponseMode,n=e.zoomDisabled,r=e.currentZoom,o=e.setAriaAnnouncementScenario,u=e.handleZoomDeltaChange,a=e.styles,f=ba(),l=Object(i.useContext)(_e).strings,c=Object(i.useMemo)(function(){return Object(wa.b)(pd(f),a)},[f,a]),h=Object(i.useCallback)(function(){u(-.05);o({type:"Zoom",zoom:r})},[r,o,u]),p=Object(i.useCallback)(function(){u(5/95);o({type:"Zoom",zoom:r})},[r,o,u]);return s.a.createElement(s.a.Fragment,null,t>td.Small&&s.a.createElement(s.a.Fragment,null,s.a.createElement(ld.e,{key:"ZoomIn",iconProps:{iconName:"ZoomIn"},styles:c,ariaLabel:l.toolbar_zoomInAriaLabel,title:l.toolbar_zoomInTooltip,role:"button",onClick:h,disabled:n,"data-test-id":"zoom-in"}),s.a.createElement(ld.e,{key:"ZoomOut",iconProps:{iconName:"ZoomOut"},styles:c,ariaLabel:l.toolbar_zoomOutAriaLabel,title:l.toolbar_zoomOutTooltip,role:"button",onClick:p,disabled:n,"data-test-id":"zoom-out"})))}),Od={handleZoomDeltaChange:ko,setAriaAnnouncementScenario:Du},Md=Object(q.connect)(function(e){return{currentZoom:vp(e.transformTools),zoomDisabled:!e.transformTools.cropInteraction.enableZoomToCrop&&!e.transformTools.view.enableZoomToView}},Od)(Ad),_d=n(1616);function Dd(e){var t=Object(i.useContext)(me).logSaveEvent,n=gd(),r=yd(),s=Object(i.useCallback)(function(i){return function(){var s,o=n.getState().filters;r();t({saveType:i,filterName:null===(s=null==o?void 0:o.activeFilter)||void 0===s?void 0:s.name,filterIntensity:null==o?void 0:o.filterLevel});e(i)}},[t,e,n,r]);return{onSaveOriginal:Object(i.useMemo)(function(){return s(Pf.SaveAsOriginal)},[s]),onSaveAsCopy:Object(i.useMemo)(function(){return s(Pf.SaveAs)},[s])}}var Pd=Object(i.memo)(function(e){var t=e.onSave,n=e.styles,r=Object(i.useContext)(_e).strings,o=ba(),u=Dd(t),a=u.onSaveOriginal,f=u.onSaveAsCopy,l=Object(i.useMemo)(function(){return Object(wa.b)((function(e){return{root:hd(hd({},dd(e)),{margin:"0px 4px"}),rootDisabled:{backgroundColor:e.palette.neutralQuaternaryAlt,color:e.palette.neutralTertiary},rootHovered:dd(e),rootPressed:dd(e),rootExpanded:dd(e)}})(o),n)},[o,n]),c=Object(i.useContext)(Bf),h=!c.has(Pf.SaveAsOriginal),p=!c.has(Pf.SaveAs);return s.a.createElement(_d.e,{text:r.toolbar_imageSave,title:r.toolbar_imageSaveTooltip,styles:l,"data-test-id":"save_menu",menuProps:{items:[{key:"SaveOriginal",text:r.toolbar_imageSaveAsOriginal,ariaLabel:r.toolbar_imageSaveAsOriginalAriaLabel,title:r.toolbar_imageSaveAsOriginalTooltip,iconProps:{iconName:"Save"},onClick:a,disabled:h},{key:"SaveCopy",text:r.toolbar_imageSaveAsCopy,ariaLabel:r.toolbar_imageSaveAsCopyAriaLabel,title:r.toolbar_imageSaveAsCopyTooltip,iconProps:{iconName:"SaveAs"},onClick:f,disabled:p}]},disabled:h&&p,allowDisabledFocus:!0})});Object(_l.n)([{rawString:".zoomDisplay_757e858e{padding:0 4px;line-height:24px}"}]);var Hd,Bd="zoomDisplay_757e858e",jd=function(){return(jd=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)},Fd=s.a.memo(function(e){var t=e.currentZoom,n=e.styles,r=Object(i.useContext)(_e),o=r.localizePercentage,u=r.strings,a=ba(),f=u;return s.a.createElement("span",{className:Bd,style:jd({color:a.palette.neutralPrimaryAlt},n),"aria-label":f.toolbar_zoomLevelAriaLabel},o(t))}),Id=Object(q.connect)(function(e){return{currentZoom:vp(e.transformTools)}})(Fd),qd=function(){return(qd=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)},Rd=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n},Ud=((Hd={})[td.Large]=315,Hd[td.Medium]=282,Hd[td.Small]=162,Hd),zd=s.a.memo(function(e){var t=e.componentSize,n=e.customItems,r=e.onSave,o=e.onCancel,u=e.controlPivot,a=Object(i.useState)(null),f=a[0],l=a[1],c=Object(i.useState)(td.Large),h=c[0],p=c[1],d=ba(),v=Ud[h];Object(i.useLayoutEffect)(function(){f&&(f.clientWidth>850?p(td.Large):f.clientWidth>785?p(td.Medium):p(td.Small))},[f,t]);return s.a.createElement("div",{ref:l},s.a.createElement(ad.e,{className:nd,horizontal:!0,styles:{root:{backgroundColor:d.palette.neutralLighter,borderBottom:d.palette.neutralQuaternary+" solid 1px"}}},s.a.createElement(ad.e.Item,{className:rd,styles:{root:{width:v}},grow:!u},s.a.createElement(Pd,{onSave:r}),null==n?void 0:n.map(function(e){var t=e.key,n=Rd(e,["key"]);return s.a.createElement(fd.e,qd({key:t},n))})),u&&s.a.createElement(ad.e.Item,{grow:!0,disableShrink:!0,className:id},u),s.a.createElement(ad.e.Item,{className:sd,styles:{root:{width:v}},grow:!u},s.a.createElement(Ld,{stackResponseMode:h}),s.a.createElement(Sd,{stackResponseMode:h}),s.a.createElement(Id,null),s.a.createElement(Md,{stackResponseMode:h}),s.a.createElement(wd,{onCancel:o,iconProps:{iconName:"cancel"}}))))});zd.displayName="EditorCommandBar";function Wd(e){return{count:{},icon:{color:e.palette.themePrimary,svg:{width:"1em",height:"1em",fill:"currentcolor"},i:{height:"100%",display:"flex",alignItems:"center"},fontSize:"16px"},link:{height:"34px",lineHeight:"34px","&:hover":{backgroundColor:e.palette.neutralLight},"&:active":{backgroundColor:e.palette.neutralQuaternaryAlt}},linkContent:{height:"100%",display:"flex"},linkIsSelected:{height:"34px",lineHeight:"34px","&:hover":{backgroundColor:e.palette.neutralLight},color:e.palette.neutralPrimary},root:{"button:hover i":{color:e.palette.themeDarkAlt},display:"flex"},text:{marginInlineStart:"4px"}}}var Xd=function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(e){try{a(r.next(e))}catch(e){s(e)}}function u(e){try{a(r.throw(e))}catch(e){s(e)}}function a(e){e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(o,u);var t}a((r=r.apply(e,t||[])).next())})},Vd=function(e,t){var n,r,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function u(s){return function(u){return(function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&s[0]?r.return:s[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,s[1])).done)return i;(r=0,i)&&(s=[2&s[0],i.value]);switch(s[0]){case 0:case 1:i=s;break;case 4:o.label++;return{value:s[1],done:!1};case 5:o.label++;r=s[1];s=[0];continue;case 7:s=o.ops.pop();o.trys.pop();continue;default:if(!(i=o.trys,i=i.length>0&&i[i.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1];i=s;break}if(i&&o.label<i[2]){o.label=i[2];o.ops.push(s);break}i[2]&&o.ops.pop();o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e];r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}})([s,u])}}};function $d(){var e=this,t=Object(i.useContext)(Za),n=t.image,r=t.offscreenRenderer,s=(function(e){var t=Object(i.useContext)(Wf),n=Se();return Object(i.useCallback)(function(){var r=Ja(e)?e.main:e;if(!r||!!r&&!!t&&!En(t,{x:r.width,y:r.height})){n({id:"SaveFailed",message:"Full size image has not loaded."});return!0}return!1},[n,e,t])})(n);return{getEditedImage:Object(i.useCallback)(function(t){void 0===t&&(t=n);return Xd(e,void 0,void 0,function(){return Vd(this,function(e){return s()?[2,null]:r?[2,r.getEditedImage(t)]:[2,null]})})},[s,n,r]),getEditedImageBytes:Object(i.useCallback)(function(t){void 0===t&&(t=n);return Xd(e,void 0,void 0,function(){return Vd(this,function(e){return s()?[2,null]:r?[2,r.getEditedImageBytes(t)]:[2,null]})})},[s,n,r])}}var Jd=function(e){var t=$d(),n=t.getEditedImage,r=t.getEditedImageBytes,s=Object(i.useRef)(Ap),o=Object(i.useRef)(Pp);Object(i.useImperativeHandle)(e,function(){return{getEdits:function(){return s.current.getEdits()},setEdits:function(e){return s.current.setEdits(e)},getEditedImage:n,getEditedImageBytes:r,resetEdits:function(){s.current.resetEdits()},getUiState:function(){return o.current.getUiState()},setUiState:function(e){return o.current.setUiState(e)},resetUiState:function(){return o.current.resetUiState()}}},[n,r]);return{editOperationsRef:s,editUiStateRef:o}};Object(_l.n)([{rawString:".dismissButton_23822781{margin-top:16px;margin-bottom:8px;border:none}"}]);var Kd="dismissButton_23822781",Qd=Object(i.memo)(function(e){var t=e.styles,n=e.setShowAspectRatioOptions,r=ba(),o=Object(i.useContext)(_e).strings,u=Object(i.useCallback)(function(){n(!1)},[n]);return s.a.createElement(cd.e,{className:Kd,text:o.footer_done,onClick:u,theme:r,styles:t})});Qd.displayName="DesktopDismissAspectRatioOptionsButton";var Gd={setShowAspectRatioOptions:Ys},Yd=Object(q.connect)(null,Gd)(Qd);Object(_l.n)([{rawString:".actionsStackContainer_7d1b69c4{position:absolute;bottom:0;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;width:100%}"}]);var Zd="actionsStackContainer_7d1b69c4",ev=Object(i.memo)(function(e){var t=e.children,n=e.styles,r=void 0===n?{}:n;return s.a.createElement("div",{className:Zd,style:r.container},t)}),tv=null;function nv(e,t,n){var r=(function(){if(!tv){var e=document.createElement("canvas");tv=e.getContext("2d")}return tv})(),i=0;if(r){r.font=t+"px "+n;var s=r.measureText(e);i=Math.ceil(s.width)}return i}var rv=function(){return(rv=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)};function iv(e){return{backgroundColor:"transparent",color:e.palette.neutralPrimaryAlt,fill:e.palette.neutralPrimaryAlt}}function sv(e){var t=iv(e);return{root:rv(rv({},t),{padding:"10px",width:"auto",height:"auto"}),rootPressed:rv(rv({},t),{color:e.palette.neutralTertiary,fill:e.palette.neutralTertiary}),rootHovered:rv({},t),rootDisabled:{backgroundColor:"transparent",i:{color:e.palette.neutralQuaternaryAlt}}}}var ov={root:{fontSize:"18px",width:"18px",height:"18px",lineHeight:"18px",margin:"0px"}},uv={height:"16px",lineHeight:"16px",margin:"0px",fontWeight:"500"},av=function(e){return{backgroundColor:e.palette.neutralPrimaryAlt,color:e.palette.white}};function fv(e){var t=Object(ql.e)(e),n={border:"none",backgroundColor:"transparent"};return{label:rv({},uv),root:rv(rv(rv({},av(e)),n),{height:"28px",margin:"14px 8px 14px 16px",marginRight:t?"16px":"8px",color:e.palette.neutralPrimaryAlt,minWidth:"52px",padding:"6px 8px 6px 8px"}),rootPressed:rv(rv({},n),{color:e.palette.neutralTertiary}),rootHovered:rv(rv({},n),{color:e.palette.neutralPrimaryAlt}),rootDisabled:rv(rv({},n),{color:e.palette.neutralQuaternary})}}var lv=function(e,t){var n=(function(e){var t=iv(e);return rv(rv({},t),{padding:"8px 0px",minWidth:"unset",width:"auto",height:"auto"})})(e);return{label:{fontWeight:"500",fontSize:t+"px",display:"inline-block",lineHeight:"100%",margin:Object(ql.e)(e)?"0px 8px 0px 0px":"0px 0px 0px 8px"},root:n,rootPressed:rv(rv({},n),{color:e.palette.neutralTertiary,fill:e.palette.neutralTertiary}),rootHovered:rv({},n),rootDisabled:{backgroundColor:"transparent",i:{color:e.palette.neutralQuaternaryAlt}}}};function cv(e){var t=iv(e),n=Object(ql.e)(e);return{icon:{fontSize:"18px",width:"18px",height:"16px",margin:"4px 3px"},root:rv(rv({},t),{marginRight:n?"4px":"16px",marginLeft:n?"16px":"4px",marginBottom:"16px",marginTop:"16px",width:"auto",height:"auto",padding:"0px"}),rootPressed:rv(rv({},t),{color:e.palette.neutralTertiary,fill:e.palette.neutralTertiary}),rootHovered:rv({},t),rootDisabled:rv(rv({},t),{backgroundColor:"transparent",i:{color:e.palette.neutralQuaternaryAlt}})}}var hv=n(2781);Object(_l.n)([{rawString:".tileContainer_4021c949{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:center;-ms-flex-align:center;align-items:center;min-width:80px;margin-top:8px}.tileContainer_4021c949 .tile_4021c949{position:relative;background-color:transparent;border-radius:4px;width:100%;height:100%}.tileContainer_4021c949 .tile_4021c949 :active{border-radius:4px}.tileContainer_4021c949 .tileName_4021c949{font-size:12px}.ms-Fabric--isFocusHidden .tileContainer_4021c949 .tile_4021c949 button{outline:0}.ms-Fabric--isFocusVisible .tileContainer_4021c949 .tile_4021c949 button:focus{outline:auto}"}]);var pv="tileContainer_4021c949",dv="tile_4021c949",vv="tileName_4021c949",mv=function(){return(mv=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)};var gv={container:{borderRadius:"4px",overflow:"hidden"},body:{display:"flex",flexDirection:"column"},footer:{margin:"8px 16px"}},yv=Object(wa.b)(gv,{body:{position:"relative",justifyContent:"flex-end",alignItems:"center"}});function bv(e,t){return{container:{marginTop:"4px"},background:{width:("Landscape"===e.orientation?124:107)+"px",height:("Landscape"===e.orientation?108:94)+"px",backgroundColor:t.palette.neutralLighterAlt,activeBackgroundOverride:{backgroundColor:t.palette.neutralQuaternary},disabledBackgroundOverride:{color:t.palette.neutralQuaternaryAlt,fill:t.palette.neutralQuaternaryAlt}},icon:{fontSize:"26px",height:"26px",width:"26px",color:t.palette.black,fill:t.palette.black},name:{fontSize:"14px",marginTop:"16px",margin:"16px 8px 0px 8px",fontWeight:400,color:t.palette.black,wordBreak:"break-word",activeNameOverride:{color:t.palette.black,fontWeight:500},disabledNameOverride:{color:t.palette.neutralQuaternaryAlt}}}}function wv(e,t){var n=Object(ql.e)(t),r=bv(e,t);return mv(mv({},r),{container:mv(mv({},r.container),{flexBasis:"100%",marginTop:"0px"}),background:mv(mv({},r.background),{width:"100%",height:"64px"}),name:mv(mv({},r.name),{margin:n?"0px 11px 0px 0px":"0px 0px 0px 11px"})})}function Ev(e,t){var n=bv(e,t);return{background:mv(mv({},n.background),{width:"89px",height:"216px",border:"2px solid "+t.palette.black,disabledBackgroundOverride:{color:t.palette.neutralQuaternaryAlt,border:"2px solid "+t.palette.neutralQuaternaryAlt},textAlign:"center"}),icon:mv({},n.icon),name:mv(mv({},n.name),{marginTop:"7px",padding:"5px"})}}var Sv=function(e,t){return{activeSection:{height:"32px",backgroundColor:e.palette.black,borderRadius:"0"},container:{margin:"3px 0px 16px"},inactiveSection:{backgroundColor:"transparent"},line:{},lineContainer:{},root:{},slideBox:{height:"32px",borderRadius:"100px",backgroundColor:e.palette.black+"1A",padding:"0px 16px",margin:"0px",boxShadow:"inset 0px -2px 2px "+e.palette.white+"1A, inset 0px 2px 2px "+e.palette.white+"80","&:hover":{".ms-Slider-active":{backgroundColor:e.palette.black},".ms-Slider-inactive":{backgroundColor:"transparent"},".ms-Slider-thumb":{border:"4px solid "+e.palette.black},".ms-Slider-zeroTick":{backgroundColor:e.palette.black}},"&:active":{".ms-Slider-active":{backgroundColor:e.palette.black},".ms-Slider-inactive":{backgroundColor:"transparent"},".ms-Slider-thumb":{border:"4px solid "+e.palette.black},".ms-Slider-zeroTick":{backgroundColor:e.palette.black}}},thumb:{width:"32px",height:"32px",background:e.palette.white,border:"4px solid "+e.palette.black,boxSizing:"border-box",top:"calc(50% - 32px/2)",borderRadius:"24px"},titleLabel:{},valueLabel:{},zeroTick:{width:"32px",height:"32px",backgroundColor:e.palette.black,borderRadius:"24px",top:"calc(50% - 32px/2)",transform:Lv(32,e),display:"block"}}},xv={root:{fontSize:"24px",width:"24px",height:"24px"}};function Tv(e){return mv(mv({},gv),{adjustmentSlider:{getSliderStyles:Sv,icon:xv,getSliderHeaderStyles:function(){return{container:{fontSize:"16px",lineHeight:"24px",display:"grid"}}}},sectionHeader:{lineHeight:"24px",margin:"16px 0px 9px 16px",color:e.palette.neutralDark}})}function Nv(e){var t=(function(e){return{backgroundColor:"transparent",color:e.palette.neutralPrimaryAlt,fill:e.palette.neutralPrimaryAlt,margin:"0px 12px"}})(e);return{root:mv(mv({},t),{padding:"11px",width:"auto",height:"auto"}),rootHovered:t,rootPressed:mv(mv({},t),{color:e.palette.neutralSecondary,fill:e.palette.neutralSecondary})}}var Cv={root:{fontSize:"18px",width:"18px",height:"18px",lineHeight:"18px",margin:"0px"}},kv={root:{minWidth:"75px",marginBottom:"8px",marginTop:"8px",height:"40px",padding:"12px 20px",borderRadius:"100px",border:"none"}};function Lv(e,t){return Object(ql.e)(t)?"translateX("+e/2+"px)":"translateX("+-e/2+"px)"}var Av=function(){return(Av=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)};function Ov(e,t,n,r){return Av(Av(Av(Av({},r),e&&r.highlightBackgroundOverride),t&&r.activeBackgroundOverride),n&&r.disabledBackgroundOverride)}function Mv(e,t,n){return Av(Av(Av({},n),e&&Av(Av({},Dv),null==n?void 0:n.activeNameOverride)),t&&(null==n?void 0:n.disabledNameOverride))}var _v,Dv={fontWeight:"bold"};function Pv(e){return{background:{width:"48px",height:"48px",activeBackgroundOverride:{backgroundColor:e.palette.neutralQuaternary},highlightBackgroundOverride:{backgroundColor:e.palette.themeLighter}},icon:{fontSize:"20px",width:"20px",height:"20px",color:e.palette.neutralPrimaryAlt,fill:e.palette.neutralPrimaryAlt},name:{marginTop:"6px",activeNameOverride:{color:e.palette.black},padding:"0 5px",textAlign:"center",wordBreak:"break-word",wordWrap:"break-word"}}}function Hv(e){var t=Pv(e);return Av({},t)}function Bv(e){var t=Pv(e);return Av(Av({},t),{container:{marginTop:"64px"},background:Av({},t.background),name:Av(Av({},t.name),{activeNameOverride:{color:e.palette.black,fontWeight:500},padding:0,height:"36px",lineHeight:"12px",fontWeight:400})})}function jv(e){return{image:{borderRadius:"4px",marginTop:"0px",marginBottom:"0px"},container:{marginTop:"64px",marginBottom:"0px",minWidth:"80px"},name:{activeNameOverride:{color:e.palette.black,fontWeight:500},marginTop:"6px",padding:0,fontWeight:400,textAlign:"center",height:"36px",lineHeight:"12px"},icon:{fontSize:"18px",width:"18px",height:"18px"}}}function Fv(e){var t=jv(e);return Av(Av({},t),{image:Av(Av({},t.image),{width:"76px",height:"76px",marginTop:"0px"}),container:Av(Av({},t.container),{minWidth:"92px",marginTop:"80px"})})}(function(e){e[e.BelowTile=0]="BelowTile";e[e.InsideTileBesideIcon=1]="InsideTileBesideIcon";e[e.InsideTileBelowIcon=2]="InsideTileBelowIcon"})(_v||(_v={}));var Iv,qv=Object(i.forwardRef)(function(e,t){var n=e.name,r=e.ariaLabel,o=e.namePosition,u=void 0===o?_v.BelowTile:o,a=e.iconName,f=e.tileStyles,l=e.isHighlighted,c=e.isActive,h=e.isDisabled,p=void 0!==h&&h,d=e.role,v=void 0===d?"button":d,m=e.tabIndex,g=void 0===m?0:m,y=e.onClick,b=Object(i.useCallback)(function(e){y(n,e)},[n,y]),w=Object(i.useState)(null),E=w[0],S=w[1];Object(i.useLayoutEffect)(function(){if(E){E.tabIndex=g;E.setAttribute("role",v)}},[E,v,g]);var x=Object(i.useMemo)(function(){return s.a.createElement("span",{className:vv,style:Mv(c,p,f.name),"aria-hidden":"true"},n)},[c,p,n,f.name]),T=Object(i.useMemo)(function(){return u===_v.InsideTileBesideIcon?s.a.createElement("div",{style:{display:"flex",alignItems:"center"}},s.a.createElement(Bl.e,{iconName:a,style:f.icon}),x):s.a.createElement(s.a.Fragment,null,s.a.createElement(Bl.e,{iconName:a,style:f.icon}),u===_v.InsideTileBelowIcon&&x)},[a,f,x,u]);Object(i.useImperativeHandle)(t,function(){return{focus:function(){return null==E?void 0:E.focus()}}},[E]);return s.a.createElement("div",{className:pv,style:f.container},s.a.createElement(hv.e,{className:dv,style:Ov(l,c,p,f.background),isFluentStyling:!0,background:T,onClick:p?void 0:b,ariaLabel:r,linkRef:S}),u===_v.BelowTile&&x)});function Rv(e,t){return function(n){var r=(function(e){return new Map([[Ae.Original,{key:"original",text:e.aspectRatio_original,ariaLabel:e.aspectRatio_originalAriaLabel}],[Ae.Square,{key:"square",text:e.aspectRatio_square,ariaLabel:e.aspectRatio_squareAriaLabel}],[Ae.None,{key:"freeForm",text:e.aspectRatio_freeform,ariaLabel:e.aspectRatio_freeformAriaLabel}]])})(e);return r.has(n)?r.get(n):(function(e,t,n,r){if(!Mi.has(e))throw new Error(e+" does not exist in the aspects map");var i=Mi.get(e),s=i.x,o=i.y,u=oc(t,r,s,o);return{key:u,text:u,ariaLabel:oc(n,r,s,o)}})(n,e.aspectRatio_ratioLabelFormatString,e.aspectRatio_ratioAriaLabelFormatString,t)}}var Uv=((Iv={})[Ae.None]="FreeformAspect-Havana",Iv[Ae.Original]="OriginalAspect-Havana",Iv[Ae.Square]="SquareAspect-Havana",Iv[Ae.NineBySixteen]="NineBySixteenAspect-Havana",Iv[Ae.SixteenByNine]="SixteenByNineAspect-Havana",Iv[Ae.FourByFive]="FourByFiveAspect-Havana",Iv[Ae.FiveByFour]="FiveByFourAspect-Havana",Iv[Ae.ThreeByFour]="ThreeByFourAspect-Havana",Iv[Ae.FourByThree]="FourByThreeAspect-Havana",Iv[Ae.TwoByThree]="TwoByThreeAspect-Havana",Iv[Ae.ThreeByTwo]="ThreeByTwoAspect-Havana",Iv[Ae.OneByTwo]="OneByTwoAspect-Havana",Iv[Ae.TwoByOne]="TwoByOneAspect-Havana",Iv);function zv(e){return Uv[e]}function Wv(){return Object.values(Ae)}var Xv=function(e){return function(t){return e===t}};function Vv(e){return e===Ae.None?_v.InsideTileBesideIcon:_v.InsideTileBelowIcon}function $v(e,t,n){var r=Object(i.useContext)(me).logFlipEvent,s=Object(i.useContext)(_e).strings;return Object(i.useCallback)(function(){r({axis:t});e();n("X"===t?s.flip_horizontalFinishedAriaLive:s.flip_verticalFinishedAriaLive)},[r,e,t,n,s])}var Jv=function(e,t,n,r,s){var o=(function(e,t,n){var r=Object(i.useContext)(me).logRotateEvent,s=Object(i.useContext)(_e).strings;return[Object(i.useCallback)(function(){r({angle:Fi(t,90)});e(Ai.Clockwise);n(s.rotate_right90FinishedAriaLive)},[r,e,t,n,s]),Object(i.useCallback)(function(){r({angle:Fi(t,-90)});e(Ai.CounterClockwise);n(s.rotate_left90FinishedAriaLive)},[r,e,t,n,s])]})(t,e,s);return{handleRotateCropRectAndImageBy90ClockwiseWithTelemetry:o[0],handleRotateCropRectAndImageBy90CounterClockwiseWithTelemetry:o[1],handleMirrorXWithTelemetry:$v(n,"X",s),handleMirrorYWithTelemetry:$v(r,"Y",s)}};Object(_l.n)([{rawString:".rotateAspectFlipBarContainer_94111356{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;-ms-flex-item-align:center;align-self:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;margin-left:12px;margin-right:12px;margin-bottom:8px;max-width:700px;width:calc(100% - 24px)}.rotateButtonsContainer_94111356{display:-webkit-box;display:-ms-flexbox;display:flex}.aspectRatioButtonContainer_94111356{-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}.aspectRatioButton_94111356{background-color:transparent;border:none}.mirrorButtonsContainer_94111356{display:-webkit-box;display:-ms-flexbox;display:flex}"}]);var Kv="rotateButtonsContainer_94111356",Qv="aspectRatioButtonContainer_94111356",Gv="aspectRatioButton_94111356",Yv="mirrorButtonsContainer_94111356",Zv=s.a.memo(function(e){var t=e.styles,n=e.icons,r=e.rotationAngle,o=e.aspectRatioConstraint,u=e.rotateCropAndImageBy90,a=e.handleMirrorXClick,f=e.handleMirrorYClick,l=e.setShowAspectRatioOptions,c=e.setAriaAnnouncement,h=Object(i.useContext)(_e),p=h.localizeNumber,d=h.strings,v=Object(i.useRef)(null),m=Object(i.useState)(null),g=m[0],y=m[1],b=Object(i.useState)(null),w=b[0],E=b[1],S=Object(i.useState)(null),x=S[0],T=S[1],N=ba(),C=N.fonts.medium.fontFamily,k=Jv(r,u,a,f,c),L=k.handleRotateCropRectAndImageBy90ClockwiseWithTelemetry,A=k.handleRotateCropRectAndImageBy90CounterClockwiseWithTelemetry,O=k.handleMirrorXWithTelemetry,M=k.handleMirrorYWithTelemetry,_=Object(i.useMemo)(function(){return Rv(d,p)(o)},[o,d,p]),D=Object(i.useCallback)(function(){l(!0)},[l]);Object(i.useEffect)(function(){var e;hs()&&document.activeElement&&(null===(e=v.current)||void 0===e||e.focus())},[]);var P=Object(i.useMemo)(function(){var e=14;if(x&&g&&w&&C){var t=x.clientWidth-(g.clientWidth+w.clientWidth+18+8);e=(function(e,t,n,r){for(var i=n,s=nv(e,i,r);s>t;)s=nv(e,i-=.5,r);return i})(_.text,t,14,C)}return e},[x,g,w,C,_.text]),H=t&&t.icon,B=t&&t.iconButton,j=t&&t.aspectRatioButton?t.aspectRatioButton(N,P):B,F=t&&t.container;return s.a.createElement("div",{style:F,ref:T},s.a.createElement("div",{className:Kv,ref:y},s.a.createElement(ld.e,{iconProps:{iconName:n.rotate90CounterClockwise,styles:H},title:d.rotate_left90,ariaLabel:d.rotate_left90AriaLabel,onClick:A,styles:B}),s.a.createElement(ld.e,{iconProps:{iconName:n.rotate90Clockwise,styles:H},title:d.rotate_right90,ariaLabel:d.rotate_right90AriaLabel,onClick:L,styles:B})),s.a.createElement("div",{role:"list",className:Qv},s.a.createElement(cd.e,{styles:j,className:Gv,text:_.text,ariaLabel:_.ariaLabel,iconProps:{iconName:zv(o),styles:H},title:d.aspectRatio_tooltip,onClick:D,"data-test-id":"aspect-ratio-button",componentRef:v,role:"listitem"})),s.a.createElement("div",{className:Yv,ref:E},s.a.createElement(ld.e,{iconProps:{iconName:n.flipHorizontally,styles:H},title:d.flip_horizontal,ariaLabel:d.flip_horizontalAriaLabel,onClick:O,styles:B}),s.a.createElement(ld.e,{iconProps:{iconName:n.flipVertically,styles:H},title:d.flip_vertical,ariaLabel:d.flip_verticalAriaLabel,onClick:M,styles:B})))});Zv.displayName="Rotate90AspectFlipBar";var em=Vt([Nf],function(e){return jn(e)}),tm=Vt([em],function(e){return ji(e)}),nm={rotateCropAndImageBy90:Ho,handleMirrorXClick:So,handleMirrorYClick:xo,setShowAspectRatioOptions:Ys,setAriaAnnouncement:_u},rm=Object(q.connect)(function(e){return{aspectRatioConstraint:e.transformTools.cropInteraction.aspectRatioConstraint,rotationAngle:em(e.transformTools)}},nm)(Zv);Object(_l.n)([{rawString:".RotationBarRoot_d52148bd{position:relative;display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-preferred-size:100%;flex-basis:100%;-ms-touch-action:none;touch-action:none;overflow:hidden;cursor:w-resize}.ms-Fabric--isFocusHidden .RotationBarRoot_d52148bd{outline:0}.ms-Fabric--isFocusVisible .RotationBarRoot_d52148bd:focus{outline:auto}"}]);var im="RotationBarRoot_d52148bd";Object(_l.n)([{rawString:".TicksManager_a7a3a373{position:absolute;-webkit-transform:translateX(-50%);transform:translateX(-50%);left:50%}"}]);var sm="TicksManager_a7a3a373",om=Object(i.memo)(function(e){var t=e.boundingSize,n=e.angle,r=e.styles,o=e.layout,u=e.children,a=r.root,f=r.tickRoot,l=r.zeroTick,c=o.numTicks,h=(l.width?l.width:f.width)+l.strokeWidth,p=2*c*(f.width+f.distanceBetween)+h,d=Math.min(a.maxWidth,t.width-2*a.sidePadding),v=Object(i.useMemo)(function(){var e=h/2+f.distanceBetween+f.width/2,t=f.distanceBetween+f.width;return Math.abs(n)<1?-e*n:-(e+(Math.abs(n)-1)*t)*Math.sign(n)},[n,f,h]);return s.a.createElement("div",{className:sm},s.a.createElement("svg",{width:p,height:a.height,viewBox:"0 0 "+p+" "+a.height},s.a.createElement("defs",null,s.a.createElement("linearGradient",{id:"fadeGradient"},s.a.createElement("stop",{offset:"0",stopColor:"black"}),s.a.createElement("stop",{offset:o.fadeDistance,stopColor:"white"}),s.a.createElement("stop",{offset:1-o.fadeDistance,stopColor:"white"}),s.a.createElement("stop",{offset:"1",stopColor:"black"})),s.a.createElement("mask",{id:"fade"},s.a.createElement("rect",{width:d,height:a.height,x:(p-d)/2,fill:"url(#fadeGradient)"})),s.a.createElement("mask",{id:"colorize"},s.a.createElement("rect",{width:d,height:a.height,x:(p-d)/2,fill:f.color}),s.a.createElement("rect",{width:Math.abs(v),height:a.height,x:p/2+h/2-(n>0?-v+h:0),fill:"white"}))),s.a.createElement("g",{mask:"url(#fade)",fill:f.activeColor,stroke:f.activeColor},s.a.createElement("g",{mask:"url(#colorize)"},s.a.createElement("g",{"data-testid":"ticksParent",transform:"translate("+v+",0)"},u)))))});Object(_l.n)([{rawString:".CenterAnchorContainer_22a2596f{position:absolute;left:50%;-webkit-transform:translateX(-50%);transform:translateX(-50%)}"}]);var um="CenterAnchorContainer_22a2596f",am=function(){return(am=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)},fm=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n},lm=Object(i.memo)(function(e){var t=e.styles,n=t.centerAnchor,r=n.width,i=n.height,o=n.rx,u=n.ry,a=n.color,f=fm(n,["width","height","rx","ry","color"]);return s.a.createElement("div",{className:um},s.a.createElement("svg",{width:r||t.tickRoot.width,height:t.root.height,viewBox:"0 0 "+(r||t.tickRoot.width)+" "+t.root.height,fill:"none"},s.a.createElement("rect",am({key:"centerAnchor"},f,{x:0,y:(t.root.height-i)/2,width:8,height:i,rx:o,ry:u,fill:a}))))}),cm=function(){return(cm=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)},hm=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n},pm=Object(i.memo)(function(e){var t=e.styles,n=e.layout,r=t.root,o=t.tickRoot,u=t.majorTick,a=t.minorTick,f=t.zeroTick,l=n.numTicks,c=n.majorTickInterval,h=(f.width?f.width:o.width)+f.strokeWidth,p=Object(i.useCallback)(function(e){var t=f.strokeWidth,n=(f.width,f.height),i=f.rx,o=f.ry,u=hm(f,["strokeWidth","width","height","rx","ry"]);return s.a.createElement("rect",cm({key:"zeroTick"},u,{x:e+t/2,y:(r.height-n)/2,width:h-t,height:n,rx:i,ry:o,fill:"transparent",strokeWidth:t}))},[r,f,h]),d=Object(i.useCallback)(function(e,t){var n=u.height,i=u.rx,a=u.ry,f=hm(u,["height","rx","ry"]),l=o.width;return s.a.createElement("rect",cm({key:t,strokeWidth:0},f,{x:e,y:(r.height-n)/2,width:l,height:n,rx:i,ry:a}))},[u,r,o]),v=Object(i.useCallback)(function(e,t){var n=hm(a,[]),i=o.width;return s.a.createElement("circle",cm({key:t,strokeWidth:0},n,{r:i/2,cx:e+2,cy:r.height/2}))},[a,r,o]);return s.a.createElement(s.a.Fragment,null,Array(2*l+1).fill(0).map(function(e,t){var n=t*(o.distanceBetween+o.width);t>l&&(n+=h-o.width);return t===l?p(n):(l-t)%c==0?d(n,t):v(n,t)}))});function dm(e){var t=Object(i.useContext)(_e).localizeNumber;return Object(i.useMemo)(function(){return t(W(ji(e),1))},[e,t])}var vm=function(){return(vm=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)},mm=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n},gm=s.a.memo(function(e){var t=e.boundingSize,n=e.angle,r=e.styles,o=e.layout,u=e.cssToPhysicalPixelRatio,a=e.handleRotationBarPointerDown,f=e.handleRotationBarPointerMove,l=e.handleRotationBarPointerUp,c=e.handleRotationAdjustment,h=Object(i.useState)(null),p=h[0],d=h[1],v=Object(i.useContext)(_e).strings,m=r.root,g=m.sidePadding,y=mm(m,["sidePadding"]),b=dm(n),w=Object(i.useCallback)(function(e){var t=cs(e.key);c({direction:t,sliderShiftingValue:.1})},[c]),E=Object(i.useCallback)(function(e){var t=cs(e.key);c({direction:t,sliderShiftingValue:1})},[c]),S=Object(i.useCallback)(function(e){var t=cs(e.key);c({direction:t,sliderShiftingValue:5})},[c]);op(p,u,a,f,l);Kh(10,p,w,E,ms,vs,S);return s.a.createElement("div",{className:im,style:vm(vm({},y),{padding:"0px "+g+"px"}),ref:d,"aria-label":v.rotate_sliderAriaLabel,title:v.rotate_sliderTooltip,tabIndex:0,role:"slider","aria-valuenow":parseInt(b),"aria-valuemin":-45,"aria-valuemax":45,"aria-valuetext":""+b+v.rotate_degree},s.a.createElement(om,{boundingSize:t,angle:n,styles:r,layout:o},s.a.createElement(pm,{styles:r,layout:o})),s.a.createElement(lm,{styles:r}))}),ym=Vt([gf,bf],function(e,t){return{width:e.x/t,height:e.y/t}}),bm={handleRotationBarPointerUp:Bo,handleRotationBarPointerMove:jo,handleRotationBarPointerDown:Fo,handleRotationAdjustment:Uo},wm=Object(q.connect)(function(e,t){var n=e.transformTools.device.pixelRatio;return{boundingSize:(null==t?void 0:t.boundingSize)||ym(e.transformTools),angle:tm(e.transformTools),cssToPhysicalPixelRatio:n}},bm)(gm),Em={numTicks:45,majorTickInterval:5,fadeDistance:.1};function Sm(e){return{tickRoot:{width:4,distanceBetween:8,color:e.palette.neutralSecondary,activeColor:e.palette.black},minorTick:{},majorTick:{height:12,rx:2,ry:2},zeroTick:{width:6,height:10,rx:4,ry:4,strokeWidth:2},centerAnchor:{width:8,height:24,rx:4,ry:4,color:e.palette.black},root:{maxWidth:700,sidePadding:10,height:32}}}Object(_l.n)([{rawString:".RotationAngleDisplayContainer_8a0e54d3{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;width:100%;pointer-events:none}.RotationAngleDisplay_8a0e54d3{padding:0 5px;text-align:center;font-size:16px}.RotationAngleDegree_8a0e54d3{width:0}"}]);var xm="RotationAngleDisplayContainer_8a0e54d3",Tm="RotationAngleDisplay_8a0e54d3",Nm="RotationAngleDegree_8a0e54d3",Cm=s.a.memo(function(e){var t=e.rotationAngle,n=e.styles,r=void 0===n?{}:n,o=Object(i.useContext)(_e).strings,u=dm(t);return s.a.createElement("div",{className:xm,style:r.container,"aria-label":""+u+o.rotate_degree},s.a.createElement("span",{className:Tm,style:r.angleDisplay},u),s.a.createElement("span",{className:Nm,style:r.angleDegree},o.rotate_degree))});Cm.displayName="RotationAngleDisplay";var km=Object(q.connect)(function(e){return{rotationAngle:em(e.transformTools)}})(Cm),Lm=Object(i.memo)(function(e){var t=e.styles,n=e.componentStyles,r=e.rotate90AspectFlipBarIcons,i=ba();return s.a.createElement(ev,{styles:{container:null==t?void 0:t.transformToolsContainer}},s.a.createElement(km,{styles:n&&n.rotationAngleDisplay}),s.a.createElement("div",{style:n&&n.rotationBarRoot},s.a.createElement(wm,{styles:Sm(i),layout:Em})),s.a.createElement(rm,{styles:n&&n.rotate90AspectFlipBar,icons:r}))});Lm.displayName="TransformToolsActionStack";Object(_l.n)([{rawString:".scrollBoxWrapper_dce3aece{overflow:scroll;-ms-overflow-style:none;overflow:-moz-scrollbars-none;scrollbar-width:none}.scrollBoxWrapper_dce3aece::-webkit-scrollbar{display:none}.scrollBox_dce3aece{display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;-ms-flex-wrap:nowrap;flex-wrap:nowrap}"}]);var Am="scrollBoxWrapper_dce3aece",Om="scrollBox_dce3aece",Mm=function(){return(Mm=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)},_m=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n},Dm=Object(i.forwardRef)(function(e,t){var n=e.direction,r=e.initialScrollLeft,o=void 0===r?0:r,u=e.initialScrollTop,a=void 0===u?0:u,f=e.children,l=e.scrollBoxRef,c=e.scrollBoxStyles,h=_m(e,["direction","initialScrollLeft","initialScrollTop","children","scrollBoxRef","scrollBoxStyles"]),p=Object(i.useState)(null),d=p[0],v=p[1],m=Object(i.useState)(!1),g=m[0],y=m[1],b=Object(i.useRef)(),w=Object(i.useRef)(),E=Object(i.useRef)(),S=Object(i.useRef)(),x=Object(i.useMemo)(function(){return Mm(Mm({},"vertical"===n?{overflowX:"hidden"}:void 0),"horizontal"===n?{overflowY:"hidden"}:void 0)},[n]),T=Object(i.useMemo)(function(){return(function(e){var t=e.direction;return"vertical"===t?{flexDirection:"column"}:"horizontal"===t?{flexDirection:"row"}:{flexWrap:"wrap"}})({direction:n})},[n]);Object(i.useEffect)(function(){Wh(t,d)},[t,d]);Object(i.useLayoutEffect)(function(){if(d){d.scrollTop=null!=a?a:0;d.scrollLeft=null!=o?o:0}},[o,a,d]);Object(i.useEffect)(function(){if(d){var e=function(e){y(!0);b.current=e.screenX;w.current=d.scrollLeft;E.current=e.screenY;S.current=d.scrollTop},t=function(e){e.preventDefault();e.stopPropagation();if(void 0!==b.current&&void 0!==w.current){var t=b.current-e.screenX;d.scrollLeft=w.current+t}if(void 0!==E.current&&void 0!==S.current){var n=E.current-e.screenY;d.scrollTop=S.current+n}},n=function(){if(g&&void 0!==b.current){b.current=void 0;w.current=void 0}if(g&&void 0!==E){E.current=void 0;S.current=void 0}y(!1)};if(!d.ontouchstart){d.addEventListener("mousedown",e);d.addEventListener("mousemove",t);d.addEventListener("mouseup",n);d.addEventListener("mouseleave",n);return function(){d.removeEventListener("mousedown",e);d.removeEventListener("mousemove",t);d.removeEventListener("mouseup",n);d.removeEventListener("mouseleave",n)}}}},[b,g,w,E,S,d]);var N=Array.isArray(f)?f:[null!=f?f:null];return s.a.createElement("div",Mm({className:Am,style:x,ref:v},h),s.a.createElement("div",{className:Om,role:"list",style:Mm(Mm({pointerEvents:g?"none":void 0},T),c),ref:l},N.map(function(e,t){return s.a.createElement("div",{key:"scroll-box-item-"+t},e)})))});Dm.displayName="ScrollContainer";var Pm=function(){return(Pm=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)},Hm=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n},Bm=function(e){var t=e.children,n=Hm(e,["children"]),r=Object(i.useState)(null),o=r[0],u=r[1],a=Object(i.useState)(),f=a[0],l=a[1],c=Object(i.useRef)(!0),h=Object(i.useMemo)(function(){return s.a.Children.toArray(t).map(function(){return Object(i.createRef)()})},[t]);Object(i.useLayoutEffect)(function(){if(0!==h.length){var e=h[0].current,t=h.slice(-1)[0].current,n=function(e){if(e&&o){var t=(null==e?void 0:e.getBoundingClientRect()).width;return(o.clientWidth-t)/2}};l({left:n(e),right:n(t)})}},[h,o]);Object(i.useLayoutEffect)(function(){var e,n;if(0!==h.length&&f&&void 0!==f.left&&void 0!==f.right){var r=s.a.Children.toArray(t).findIndex(function(e){return s.a.isValidElement(e)&&e.props.isActive});null===(n=null===(e=h[r])||void 0===e?void 0:e.current)||void 0===n||n.scrollIntoView({inline:"center",behavior:c.current?"auto":"smooth"});c.current=!1}},[t,h,f]);return s.a.createElement("div",{ref:u,style:{overflow:"hidden"}},s.a.createElement(Dm,Pm({},n,{scrollBoxStyles:{paddingLeft:null==f?void 0:f.left,paddingRight:null==f?void 0:f.right}}),s.a.Children.toArray(t).map(function(e,t){return s.a.createElement("div",{ref:h[t],key:t},e)})))};Object(_l.n)([{rawString:".scrollBoxContainer_28f2b9ed{position:relative;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}"}]);var jm="scrollBoxContainer_28f2b9ed",Fm=function(){return(Fm=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)},Im={margin:"0px 32px"};function qm(e,t){return{root:Fm({position:"absolute",zIndex:3,height:"100%",width:32,i:{color:e.palette.neutralPrimary}},"start"===t?{left:"-32px"}:{right:"-32px"}),rootHovered:{backgroundColor:"transparent",i:{color:e.palette.neutralPrimaryAlt}},rootPressed:{backgroundColor:"transparent",i:{color:e.palette.neutralSecondary}}}}function Rm(e,t,n){Object(i.useEffect)(function(){var r=n||window.ResizeObserver;if(r&&e){var i=new r(t);i.observe(e);return function(){i.disconnect()}}},[n,e,t])}var Um,zm=function(){return(zm=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)},Wm=function(e){var t=ba(),n=Object(i.useRef)(null),r=Object(i.useState)(null),o=r[0],u=r[1],a=Object(i.useState)(null),f=a[0],l=a[1],c=(function(e,t,n){var r=Object(i.useState)(!1),s=r[0],o=r[1],u=Object(i.useState)(!1),a=u[0],f=u[1],l=Object(i.useCallback)(function(){if(e&&t){var n=e.getBoundingClientRect(),r=t.getBoundingClientRect();return{x:n.left-r.left,y:n.top-r.top,width:n.width,height:n.height}}},[e,t]),c=Object(i.useCallback)(function(){var e=l();e&&t&&o(e.x<0&&e.width!==t.clientWidth)},[t,l]),h=Object(i.useCallback)(function(){var e=l();e&&t&&f(e.x+e.width>t.clientWidth&&e.width!==t.clientWidth)},[t,l]),p=Object(i.useCallback)(function(){c();h()},[c,h]);Object(i.useEffect)(function(){p()},[e,t,p]);var d=Object(i.useCallback)(function(e){var r=l();if(t&&r&&n){n.scrollTo?n.scrollTo({left:e*t.clientWidth-r.x}):n.scrollLeft=e*t.clientWidth-r.x;p()}},[t,n,p,l]);Rm(t,p);return{showPanLeft:s,showPanRight:a,onPanLeftClick:Object(i.useCallback)(function(){return d(-1)},[d]),onPanRightClick:Object(i.useCallback)(function(){return d(1)},[d]),onScroll:Object(i.useCallback)(function(){return p()},[p])}})(f,o,n.current),h=c.showPanLeft,p=c.showPanRight,d=c.onPanLeftClick,v=c.onPanRightClick,m=c.onScroll;return s.a.createElement("div",{className:jm,style:Im,ref:u},h&&s.a.createElement(ld.e,{iconProps:{iconName:"ChevronLeft"},styles:qm(t,"start"),onClick:d,tabIndex:-1}),s.a.createElement(Dm,zm({},e,{direction:"horizontal",scrollBoxRef:l,onScroll:m,ref:n})),p&&s.a.createElement(ld.e,{iconProps:{iconName:"ChevronRight"},styles:qm(t,"end"),onClick:v,tabIndex:-1}))};function Xm(e,t,n,r){void 0===n&&(n=0);void 0===r&&(r="center");var s=Object(i.useState)(e.indexOf(t)),o=s[0],u=s[1],a=Object(i.useCallback)(function(t){var i=0,s=n>0?Math.ceil(e.length/n):1,a=n>0?Math.ceil((o+1)/n):1,f=e.length-n*(s-1),l=Math.floor((n-f)/2);switch(t.key){case"ArrowLeft":i=-1;break;case"ArrowRight":i=1;break;case"ArrowDown":if("center"===r&&a===s-1&&f<n){i=n-l;n>0&&o%n<l&&(i+=l-o%n)}else i=n;break;case"ArrowUp":i="center"===r&&a===s&&f<n?-n+l:-n;break;default:i=0}if(i){t.preventDefault();u(ni(o+i,0,e.length-1))}},[o,e,n,r]);return{keyboardFocusedIndex:o,setKeyboardFocusedIndex:u,onKeyDown:a}}function Vm(e,t,n){var r=Object(i.useContext)(me).logAspectRatioEvent,s=Object(i.useContext)(_e).strings;return Object(i.useCallback)(function(i){r({aspectRatio:i});e(i);t(sc(s.aspectRatio_changedAriaLive,n(i).ariaLabel))},[r,e,t,s,n])}function $m(e,t,n,r,i,o,u,a,f,l,c){return e.map(function(e,h){var p=n(e),d=p.key,v=p.text,m=p.ariaLabel;return s.a.createElement(qv,{key:d,name:v,iconName:r(e),tileStyles:"function"==typeof t?t(e):t,isActive:!!o&&o(e),isHighlighted:!!u&&u(e),onClick:function(){return i(e,h)},ariaLabel:m,ref:function(e){f&&f.current&&(f.current[h]=e)},role:l,tabIndex:a?a(e):void 0,namePosition:"function"==typeof c?c(e):c})})}(function(e){e[e.Default=0]="Default";e[e.AutoCenterSelected=1]="AutoCenterSelected";e[e.ChevronPanning=2]="ChevronPanning"})(Um||(Um={}));var Jm=Object(i.memo)(function(e){var t=e.activeAspectRatio,n=e.setAspectRatioConstraint,r=e.setAriaAnnouncement,o=e.scrollContainerType,u=e.aspectRatioTilesStyles,a=Object(i.useContext)(_e),f=a.localizeNumber,l=a.strings,c=Object(i.useMemo)(function(){return Wv()},[]),h=Object(i.useRef)(new Array(c.length)),p=Xm(c,t),d=p.keyboardFocusedIndex,v=p.setKeyboardFocusedIndex,m=p.onKeyDown,g=Vm(n,r,Rv(l,f)),y=Object(i.useCallback)(function(e,t){g(e);v(t)},[v,g]),b=$m(c,u,Rv(l,f),zv,y,Xv(t),void 0,(function(e){return function(t){return e===t?0:-1}})(c[d]),h,"listitem");Object(i.useEffect)(function(){window.requestAnimationFrame(function(){var e=h.current[d];e&&e.focus()})},[d,h]);switch(o){case Um.AutoCenterSelected:return s.a.createElement(Bm,{direction:"horizontal"},b);case Um.ChevronPanning:return s.a.createElement(Wm,{style:{outline:"none"},onKeyDown:m},b);case Um.Default:default:return s.a.createElement(Dm,{direction:"horizontal"},b)}});Jm.displayName="AspectRatioActionsBar";var Km=function(){return(Km=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)},Qm={container:{position:"relative",bottom:"8px"}},Gm={container:Km(Km({},Qm.container),{height:"16px",bottom:"5px"})},Ym={container:{marginBottom:"8px",alignItems:"center"}},Zm={display:"flex",flexGrow:1,alignSelf:"center",justifyContent:"center",margin:"0px 12px 8px 12px",maxWidth:"700px",width:"calc(100% - 24px)"},eg=Object(i.memo)(function(e){var t=e.visible,n=e.showAspectRatioOptions,r=e.activeAspectRatio,i=e.buttonStyles,o=e.setAspectRatioConstraint,u=e.setAriaAnnouncement,a=ba(),f=(function(e){return{root:{backgroundColor:"transparent",color:e.palette.neutralPrimary,fill:e.palette.neutralPrimary,width:"fit-content",display:"flex",alignSelf:"center",margin:"0px 4px",span:{fontWeight:400},i:{color:e.palette.neutralPrimary,fill:e.palette.neutralPrimary}},rootHovered:{backgroundColor:e.palette.neutralLight},rootPressed:{backgroundColor:e.palette.neutralQuaternaryAlt},rootDisabled:{backgroundColor:"transparent",color:e.palette.neutralTertiary,i:{color:e.palette.neutralTertiary,fill:e.palette.neutralTertiary}}}})(a);return t?s.a.createElement(ev,{styles:Ym},!n&&s.a.createElement(Lm,{componentStyles:{rotationAngleDisplay:Qm,rotationBarRoot:{display:"flex",justifyContent:"center",marginBottom:"16px"},rotate90AspectFlipBar:{iconButton:f,icon:vd,container:Zm}},rotate90AspectFlipBarIcons:{rotate90CounterClockwise:"Rotate90CounterClockwise",rotate90Clockwise:"Rotate90Clockwise",flipHorizontally:"Switch",flipVertically:"Sort"}}),n&&s.a.createElement("div",{style:{width:"fit-content",maxWidth:"100%",display:"flex",flexDirection:"column"}},s.a.createElement(Jm,{activeAspectRatio:r,setAspectRatioConstraint:o,setAriaAnnouncement:u,scrollContainerType:Um.ChevronPanning,aspectRatioTilesStyles:Hv(a)}),s.a.createElement(Yd,{styles:Object(wa.b)(f,i)}))):null}),tg=Vt([gf,bf,function(e){return e.view.viewFitting.marginCssPixels}],function(e,t,n){return vr(e,t,n)}),ng=Vt([tg,mf,pf,Ef,yf],function(e,t,n,r,i){return r&&(i===yr.fitCropRectInView||!(function(e,t,n){var r=kr(Hr(Jn(t,n)));return r.top+r.height>e.top+e.height})(e,t,n))}),rg={setAspectRatioConstraint:qo,setAriaAnnouncement:_u},ig=Object(q.connect)(function(e){var t=e.transformTools.cropInteraction.aspectRatioConstraint,n=e.uiState.showAspectRatioOptions;return{visible:ng(e.transformTools),showAspectRatioOptions:n,activeAspectRatio:t}},rg)(eg);Object(_l.n)([{rawString:".ms-Fabric--isFocusVisible .nonCropUI_b831d4aa{visibility:visible}.nonCropUI_b831d4aa{position:absolute;width:100%;height:100%;top:0}.nonCropUI_b831d4aa:focus{outline:0}.nonCropUI_b831d4aa:focus-visible{outline:3px solid #fff;outline-offset:-3px}"}]);var sg="nonCropUI_b831d4aa";var og=s.a.memo(function(e){var t=e.cursor,n=e.cssToPhysicalPixelRatio,r=e.hasNonCropEdits,o=e.onPointerDown,u=e.onPointerMove,a=e.onPointerUp,f=e.onWheel,l=e.onTouchDown,c=e.onTouchMove,h=e.onTouchUp,p=e.onDoubleTap,d=e.setIsViewingOriginal,v=e.panView,m=e.panViewTopLeftCornerFromCropOrigin,g=e.setAriaAnnouncementScenario,y=Object(i.useContext)(_e).strings,b=Object(i.useState)(null),w=b[0],E=b[1],S=Object(i.useCallback)(function(e){e.isPrimaryButtonDownOrTouchDown&&u(e)},[u]);op(w,n,o,S,a);up(n,w,l,c,h,p);Qh(n,w,f);Jh(w);(function(e,t){Object(i.useEffect)(function(){if(e){var n=function(e){e.code in t&&t[e.code](!0)},r=function(e){e.code in t&&t[e.code](!1)};e.addEventListener("keydown",n);e.addEventListener("keyup",r);return function(){e.removeEventListener("keydown",n);e.removeEventListener("keyup",r)}}},[e,t])})(w,Object(i.useMemo)(function(){return{Space:d}},[d]));(function(e,t,n,r){var s=Object(i.useCallback)(function(e){var i=cs(e.key);t({direction:i,adjustmentCanvasShiftingValue:1});r({type:"PanView",panViewTopLeftCornerFromCropOrigin:n})},[t,r,n]),o=Object(i.useCallback)(function(e){var i=cs(e.key);t({direction:i,adjustmentCanvasShiftingValue:10});r({type:"PanView",panViewTopLeftCornerFromCropOrigin:n})},[t,r,n]),u=Object(i.useCallback)(function(e){var i=cs(e.key);t({direction:i,adjustmentCanvasShiftingValue:50});r({type:"PanView",panViewTopLeftCornerFromCropOrigin:n})},[t,r,n]);Kh(10,e,s,o,ds,ps,u)})(w,v,m,g);var x=r?y.nonCrop_imageAriaLabelWithEdits:y.nonCrop_imageAriaLabelWithoutEdits;return s.a.createElement(s.a.Fragment,null,s.a.createElement("div",{ref:E,className:sg,style:{cursor:t},"data-is-focusable":!0,title:r?y.nonCrop_imageTooltip:void 0,"aria-label":x,role:"img",tabIndex:0,"data-test-id":"nonCrop_canvas"}))}),ug=Vt([mf,pf],function(e,t){return yn(mn(Yn(Jn(e,t)),-1))}),ag=function(){return(ag=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)},fg={onPointerMove:wo,onPointerDown:Hs,onPointerUp:Bs,onWheel:Eo,onTouchDown:Lo,onTouchMove:Ao,onTouchUp:Oo,onDoubleTap:Mo,setIsViewingOriginal:io,panView:Wo,setAriaAnnouncementScenario:Du},lg=Object(q.connect)(function(e){return{cssToPhysicalPixelRatio:e.transformTools.device.pixelRatio,cursor:dp(e.transformTools),hasNonCropEdits:_f(ag(ag({},Nr),{colorAdjustments:e.colorAdjustments,filters:e.filters,autoEnhance:e.autoEnhance,markup:e.markup})),panViewTopLeftCornerFromCropOrigin:ug(e.transformTools)}},fg)(og);Object(_l.n)([{rawString:".layout_desktop_46fde051{width:100%;height:100%;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.content_container_46fde051{display:grid;width:100%;height:calc(100% - 44px);grid-template-columns:1fr auto auto;grid-template-rows:1fr}.canvas_container_46fde051{position:relative}"}]);var cg="layout_desktop_46fde051",hg="content_container_46fde051",pg="canvas_container_46fde051",dg=s.a.memo(function(e){var t=e.cssPixelMarginByActivity,n=e.activeEditorActivity,r=e.setViewFittingMarginCssPixels;Object(i.useLayoutEffect)(function(){r({marginCssPixels:t[n]||dr(0),shouldAnimate:!0})},[r,n,t]);return null}),vg={setViewFittingMarginCssPixels:Po},mg=Object(q.connect)(function(e){return{activeEditorActivity:e.uiState.activeEditorActivity}},vg)(dg),gg=(function(){function e(e,t){this._levelUniformName=e;this._mapNormalizedToShaderValue=t;this._level=0}e.prototype.onBeforeBabylonRender=function(e){e.setFloat(this._levelUniformName,this._mapNormalizedToShaderValue(this._level))};e.prototype.onBeforeGlRender=function(e,t){var n=e.getUniformLocation(t,this._levelUniformName);e.uniform1f(n,this._mapNormalizedToShaderValue(this._level))};e.prototype.setLevel=function(e){this._level=e};e.prototype.getLevel=function(){return this._level};return e})();var yg=(function(){function e(e,t,n){this._name=e;this._defineIdentifierName=t;this._shaderInputProvider=n}e.prototype.getName=function(){return this._name};e.prototype.getUniformNames=function(e){return[]};e.prototype.getFunctions=function(){return[]};e.prototype.getHeaderCode=function(e){return"\n#define "+this._defineIdentifierName};e.prototype.getShaderFunctionBody=function(e){return""};e.prototype.onBeforeBabylonRender=function(e,t){this._shaderInputProvider.onBeforeBabylonRender(e,t)};e.prototype.onBeforeGlRender=function(e,t,n){this._shaderInputProvider.onBeforeGlRender(e,t,n)};return e})(),bg=(function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){e(t,n);function r(){this.constructor=t}t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}})(),wg=(function(e){bg(t,e);function t(t,n,r){var i=e.call(this,t,n,r)||this;i.name=t;i.defineIdentifierName=n;i.shaderInputProvider=r;return i}t.prototype.getLevel=function(){return this.shaderInputProvider.getLevel()};t.prototype.setLevel=function(e){return this.shaderInputProvider.setLevel(e)};return t})(yg),Eg=function(e,t){var n=e.levelUniformName,r=e.mapNormalizedToShaderValue,s=e.defName,o=Object(i.useMemo)(function(){return new gg(n,r)},[n,r]),u=Object(i.useMemo)(function(){return new wg(e.defName,s,o)},[s,o,e]);o.setLevel(ni(t,0,1));bh(t);ph(u)},Sg=[.04,1,4],xg={defName:"BRIGHTNESS",levelUniformName:"uBrightnessLevel",mapNormalizedToShaderValue:function(e){return pi(Sg,e)}},Tg=function(){return xg},Ng=Object(q.connect)(function(e){return{level:e.colorAdjustments.brightness}})(function(e){var t=e.level,n=Tg();Eg(n,t);return null}),Cg=(function(){function e(){this._devicePixelRatio=1;this._checkerboardSize=15;this._lightCheckerColor=1;this._darkCheckerColor=.95}e.prototype.setDevicePixelRatio=function(e){this._devicePixelRatio=e};e.prototype.setCheckerboardSize=function(e){e&&(this._checkerboardSize=e)};e.prototype.setLightCheckerColor=function(e){e&&(this._lightCheckerColor=e)};e.prototype.setDarkCheckerColor=function(e){e&&(this._darkCheckerColor=e)};e.prototype.getName=function(){return"CheckerboardShader"};e.prototype.getUniformNames=function(e){return[e("uCheckerboardSize@"),e("uLightCheckerColor@"),e("uDarkCheckerColor@")]};e.prototype.getFunctions=function(e){return[]};e.prototype.getHeaderCode=function(e){return e("\n        //Checkerboard effect---\n        uniform float uCheckerboardSize@;\n        uniform float uLightCheckerColor@;\n        uniform float uDarkCheckerColor@;\n        ")};e.prototype.getShaderFunctionBody=function(e){return e("\n            //Checkerboard effect---\n            float total = step(uCheckerboardSize@, mod("+zc+".x, uCheckerboardSize@ * 2.0)) + step(uCheckerboardSize@, mod("+zc+".y, uCheckerboardSize@ * 2.0));\n            float baseCheckerboardColor = mix(uDarkCheckerColor@,uLightCheckerColor@,sign(mod(total, 2.0 )));\n            vec4 checkerBlendedColor = mix(vec4(baseCheckerboardColor,baseCheckerboardColor,baseCheckerboardColor,1.0),gl_FragColor, gl_FragColor.a);\n\n            // Checkerboard is hidden when there's a colorOverride. For example, the default transparent placeholder image should be shown without a checkerboard effect.\n            vec4 checkerboardColor = mix(checkerBlendedColor,"+Jc+","+$c+");\n            gl_FragColor = mix(checkerboardColor, gl_FragColor, "+Zc+");\n        ")};e.prototype.onBeforeBabylonRender=function(e,t){e.setFloat(t("uCheckerboardSize@"),this._checkerboardSize*this._devicePixelRatio);e.setFloat(t("uLightCheckerColor@"),this._lightCheckerColor);e.setFloat(t("uDarkCheckerColor@"),this._darkCheckerColor)};e.prototype.onBeforeGlRender=function(e,t,n){e.uniform1f(e.getUniformLocation(t,n("uCheckerboardSize@")),this._checkerboardSize*this._devicePixelRatio);e.uniform1f(e.getUniformLocation(t,n("uLightCheckerColor@")),this._lightCheckerColor);e.uniform1f(e.getUniformLocation(t,n("uDarkCheckerColor@")),this._darkCheckerColor)};return e})(),kg=Object(q.connect)(function(e){return{devicePixelRatio:e.transformTools.device.pixelRatio}})(function(e){var t=e.devicePixelRatio,n=e.checkerboardSize,r=e.lightCheckerColor,s=e.darkCheckerColor,o=Object(i.useMemo)(function(){return new Cg},[]);o.setDevicePixelRatio(t);bh(t);o.setCheckerboardSize(n);bh(n);o.setLightCheckerColor(r);bh(r);o.setDarkCheckerColor(s);bh(s);ph(o);return null});function Lg(e){return{x:e[0],y:e[1],z:e[2],w:e[3]}}var Ag=(function(){function e(e,t,n){this._negativeVectorUniformName=e;this._neutralVectorUniformName=t;this._positiveVectorUniformName=n;this._negativeVector=[0,0,0,0];this._neutralVector=[0,0,0,0];this._positiveVector=[0,0,0,0]}e.prototype.onBeforeBabylonRender=function(e){e.setVector4(this._negativeVectorUniformName,Lg(this._negativeVector));e.setVector4(this._neutralVectorUniformName,Lg(this._neutralVector));e.setVector4(this._positiveVectorUniformName,Lg(this._positiveVector))};e.prototype.onBeforeGlRender=function(e,t){var n=e.getUniformLocation(t,this._negativeVectorUniformName);e.uniform4fv(n,this._negativeVector);var r=e.getUniformLocation(t,this._neutralVectorUniformName);e.uniform4fv(r,this._neutralVector);var i=e.getUniformLocation(t,this._positiveVectorUniformName);e.uniform4fv(i,this._positiveVector)};e.prototype.setData=function(e,t,n){this._negativeVector=e;this._neutralVector=t;this._positiveVector=n};return e})();function Og(e,t){return{r:e.r-t.r,g:e.g-t.g,b:e.b-t.b,a:e.a-t.a}}var Mg=Hg(0);function _g(e,t,n,r){e=ni(e,0,360);t=ni(t,-100,100);n=ni(n,-100,100);r=ni(r,-100,100);var i,s,o=(function(e,t){var n=e,r=Dg(t);if((r*=.5)<0){r*=-1;n=(e+180)%360}return[n,r]})(e,t),u=(function(e,t,n){var r,i,s,o=ni(e,0,359),u=ni(t/100,0,1),a=ni(n/100,0,1);if(0===u){r=a;i=a;s=a}else{o/=60;var f=Math.floor(o),l=o-f,c=a*(1-u),h=a*(1-u*l),p=a*(1-u*(1-l));switch(f){case 0:r=a;i=p;s=c;break;case 1:r=h;i=a;s=c;break;case 2:r=c;i=a;s=p;break;case 3:r=c;i=h;s=a;break;case 4:r=p;i=c;s=a;break;default:r=a;i=c;s=h}}1;return{r:r,g:i,b:s,a:1}})(o[0],o[1],(function(e){return 50+.25*Dg(e)})(r));(u=(i=2,{r:(s=u).r*i,g:s.g*i,b:s.b*i,a:s.a*i})).a=(function(e){return 1+.01*e})(n);return u}function Dg(e){return Math.sign(e)*e*e/100}function Pg(e,t){var n,r,i=_g(e.hue,e.density,e.saturation,e.value);return r=t,{r:(n=i).r*r.r,g:n.g*r.g,b:n.b*r.b,a:n.a*r.a}}function Hg(e){return{hue:30,density:0,saturation:0,value:e}}function Bg(e){return[e.r,e.g,e.b,e.a]}var jg=function(){return(jg=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)},Fg=[-65,0,100],Ig={negativeVectorUniformName:"vCameraColorCurveNegative",neutralVectorUniformName:"vCameraColorCurveNeutral",positiveVectorUniformName:"vCameraColorCurvePositive"},qg=jg(jg({defName:"COLORCURVES"},Ig),{createColorCurveVectors:function(e,t,n){return(function(e,t,n){var r=_g(30,0,0,e),i=Pg(Hg(t),r),s=Pg(Mg,r),o=Pg(Hg(n),r),u=Og(i,s),a=s;return{negativeVector:Bg(Og(s,o)),neutralVector:Bg(a),positiveVector:Bg(u)}})(xn(-100,100,e),pi(Fg,t),xn(-100,100,n))},getUniformNames:function(){return Object.values(Ig)}}),Rg=function(){return qg},Ug=s.a.memo(function(e){var t,n=e.exposureNormalizedSliderLevel,r=e.highlightsNormalizedSliderLevel,s=e.shadowsNormalizedSliderLevel,o=Rg(),u=(t=o,Object(i.useMemo)(function(){var e=new Ag(t.negativeVectorUniformName,t.neutralVectorUniformName,t.positiveVectorUniformName);return[e,new yg(t.defName,t.defName,e)]},[t])),a=u[0],f=u[1],l=o.createColorCurveVectors(n,r,s),c=l.negativeVector,h=l.neutralVector,p=l.positiveVector;a.setData(c,h,p);bh(n,r,s);ph(f);return null});var zg=Object(q.connect)(function(e){return{exposureNormalizedSliderLevel:e.colorAdjustments.exposure,highlightsNormalizedSliderLevel:e.colorAdjustments.highlights,shadowsNormalizedSliderLevel:e.colorAdjustments.shadows}})(Ug),Wg={defName:"CONTRAST",highLevelValuesUniformName:"uContrastHighValues",lowLevelValuesUniformName:"uContrastLowValues",mapNormalizedToShaderValue:Nn(-1,1),getContrastValues:function(e){return{lowLevelValues:{x:2*e,y:1-e,z:0},highLevelValues:{x:2*-e,y:1+3*e,z:-e}}}},Xg=function(){return Wg},Vg=s.a.memo(function(e){var t=e.level,n=Xg(),r=Object(i.useMemo)(function(){var e=Xg(),t=new Jg(e.lowLevelValuesUniformName,e.highLevelValuesUniformName);return[t,new yg(e.defName,e.defName,t)]},[]),s=r[0],o=r[1],u=n.getContrastValues(n.mapNormalizedToShaderValue(t)),a=u.highLevelValues,f=u.lowLevelValues;s.setLevels(a,f);bh(t);ph(o);return null});var $g,Jg=(function(){function e(e,t){this._lowLevelValuesUniformName=e;this._highLevelValuesUniformName=t;this._lowLevelValues={x:0,y:0,z:0};this._highLevelValues={x:0,y:0,z:0}}e.prototype.onBeforeBabylonRender=function(e){e.setVector3(this._lowLevelValuesUniformName,this._lowLevelValues);e.setVector3(this._highLevelValuesUniformName,this._highLevelValues)};e.prototype.onBeforeGlRender=function(e,t){var n=e.getUniformLocation(t,this._lowLevelValuesUniformName);e.uniform3f(n,this._lowLevelValues.x,this._lowLevelValues.y,this._lowLevelValues.z);var r=e.getUniformLocation(t,this._highLevelValuesUniformName);e.uniform3f(r,this._highLevelValues.x,this._highLevelValues.y,this._highLevelValues.z)};e.prototype.setLevels=function(e,t){this._lowLevelValues=e;this._highLevelValues=t};return e})(),Kg=Object(q.connect)(function(e){return{level:e.colorAdjustments.contrast}})(Vg),Qg=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),i=0;for(t=0;t<n;t++)for(var s=arguments[t],o=0,u=s.length;o<u;o++,i++)r[i]=s[o];return r},Gg=(function(){function e(){this._transform=[1,0,0,0,1,0];this._level=1;this._outsideVisibility=.3}e.prototype.setTransform=function(e){this._transform=e};e.prototype.setLevel=function(e){this._level=e};e.prototype.setOutsideLightness=function(e){this._outsideVisibility=e};e.prototype.getName=function(){return"CropMaskShader"};e.prototype.getUniformNames=function(e){return[e("uCropTransform@"),e("uCropTransformInverse@"),e("uLevel@"),e("uOutsideVisibility@")]};e.prototype.getFunctions=function(e){return[]};e.prototype.getHeaderCode=function(e){return e("\n        //CropMask effect---\n        uniform mat3 uCropTransform@;\n        uniform mat3 uCropTransformInverse@;\n        uniform float uLevel@;\n        uniform float uOutsideVisibility@;\n        ")};e.prototype.getShaderFunctionBody=function(e){return e("\n            //CropMask effect---\n            vec3 normalizedPos@ = vec3("+zc+".x,"+zc+".y,1.0) * uCropTransformInverse@;\n\n            float isOutsideCropRegion = 1. - step(0.0, normalizedPos@.x) * step(0.0, normalizedPos@.y) * step(0.0, 1.0 - normalizedPos@.x) * step(0.0, 1.0 - normalizedPos@.y);\n            float applyCropMask = mix(isOutsideCropRegion, 0., "+Zc+");\n\n            finalAlphaMultiply = mix(finalAlphaMultiply, uOutsideVisibility@, applyCropMask);\n        ")};e.prototype.onBeforeBabylonRender=function(e,t){e.setMatrix3x3(t("uCropTransform@"),new Float32Array(Qg(this._transform,[0,0,1])));e.setMatrix3x3(t("uCropTransformInverse@"),new Float32Array(Qg(qn(this._transform),[0,0,1])));e.setFloat(t("uLevel@"),this._level);e.setFloat(t("uOutsideVisibility@"),this._outsideVisibility)};e.prototype.onBeforeGlRender=function(e,t,n){var r=e.getUniformLocation(t,n("uCropTransform@"));e.uniformMatrix3fv(r,!1,new Float32Array(Qg(this._transform,[0,0,1])));var i=qn(this._transform),s=e.getUniformLocation(t,n("uCropTransformInverse@"));e.uniformMatrix3fv(s,!1,new Float32Array(Qg(i,[0,0,1])));var o=e.getUniformLocation(t,n("uLevel@"));e.uniform1f(o,this._level);e.uniform1f(e.getUniformLocation(t,n("uOutsideVisibility@")),this._outsideVisibility)};return e})(),Yg=Vt([function(e){return nr(e.animations.outsideCropVisibility,e.animations.currentTime,100)},function(e){return nr(e.animations.dismissOutsideCropVisibility,e.animations.currentTime,400)},xf,df,function(e){return e.activeEditorActivity}],function(e,t,n,r,i){return vi(n,e,t,r,i)}),Zg=function(){return(Zg=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)},ey=Object(q.connect)(function(e){var t=e.transformTools.cropInteraction.mode;return{transform:Lh(e.transformTools),level:t===gr.selectingFirstCorner?0:1,outsideVisibilityValue:Yg(Zg(Zg({},e.transformTools),e.uiState))}})(function(e){var t=e.transform,n=e.level,r=e.outsideVisibilityValue,s=Object(i.useMemo)(function(){return new Gg},[]);s.setTransform(t);s.setLevel(n);s.setOutsideLightness(r);wh(t);bh(n);ph(s);return null}),ty=Object(q.connect)(function(e){return{transform:Lh(e.transformTools),numGridLines:Dc(e.transformTools),lineAlpha:Pc(e.transformTools)}})(function(e){var t=Object(i.useContext)(Ha);return t.gridLinesEffect?s.a.createElement(t.gridLinesEffect,Da({},e)):null}),ny=Object(i.createContext)({textures:{},urlsById:{},loadUrls:function(){}});(function(e){e[e.main=0]="main";e[e.lut=1]="lut";e[e.blend=2]="blend";e[e.overlay=3]="overlay"})($g||($g={}));var ry=(function(){function e(){this._level=0;this._configuration={numRedSamplesPerSlice:0,numGreenSamplesPerSlice:0,numBlueSlicesPerRowIn2DLayout:0,numBlueSlicesPerColumnIn2DLayout:0}}e.prototype.setLevel=function(e){this._level=e};e.prototype.getLevel=function(){return this._level};e.prototype.setTexture=function(e){this._texture=e};e.prototype.getTexture=function(){return this._texture};e.prototype.setConfiguration=function(e){this._configuration=e};e.prototype.getConfiguration=function(){return this._configuration};e.prototype.getBlueSlicesIn2DLayout=function(){return{x:this._configuration.numBlueSlicesPerRowIn2DLayout,y:this._configuration.numBlueSlicesPerColumnIn2DLayout}};e.prototype.calculateTextureSize=function(){return e=this.getBlueSlicesIn2DLayout(),t={x:this._configuration.numRedSamplesPerSlice,y:this._configuration.numGreenSamplesPerSlice},{x:e.x*t.x,y:e.y*t.y};var e,t};e.prototype.getUniformNames=function(e){return[e("level@"),e("uBlueSlicesIn2DLayout@"),e("uTexSize@")]};e.prototype.getSamplerNames=function(e){return[e("lookup2D@")]};e.prototype.getName=function(){return"LutShader"};e.prototype.getFunctions=function(e){return["\nvec4 getColorInLookupTable(in vec4 color, in sampler2D lookupTable, in vec2 blueSlicesIn2DLayout, in vec2 texSize) {\n    color = clamp(color, 0., 1.);\n\n    mediump float unboundBlueSlice = color.b * (blueSlicesIn2DLayout.x * blueSlicesIn2DLayout.y - 1.);\n\n    // Find the nearest lower bound quad location\n    mediump vec2 lowerBoundBlueSlice;\n    lowerBoundBlueSlice.y = floor(floor(unboundBlueSlice) / blueSlicesIn2DLayout.x);\n    lowerBoundBlueSlice.x = floor(unboundBlueSlice) - (lowerBoundBlueSlice.y * blueSlicesIn2DLayout.x);\n\n    // Find the nearest upper bound quad location\n    mediump vec2 upperBoundBlueSlice;\n    upperBoundBlueSlice.y = floor(ceil(unboundBlueSlice) / blueSlicesIn2DLayout.x);\n    upperBoundBlueSlice.x = ceil(unboundBlueSlice) - (upperBoundBlueSlice.y * blueSlicesIn2DLayout.x);\n\n    // Within the slices, find the position of the rg values in UV space\n    highp vec2 texPos1 = (lowerBoundBlueSlice / blueSlicesIn2DLayout) + vec2(0.5, 0.5) / texSize + (((vec2(1., 1.) / blueSlicesIn2DLayout) - vec2(1., 1.) / texSize) * color.rg);\n    highp vec2 texPos2 = (upperBoundBlueSlice / blueSlicesIn2DLayout) + vec2(0.5, 0.5) / texSize + (((vec2(1., 1.) / blueSlicesIn2DLayout) - vec2(1., 1.) / texSize) * color.rg);\n\n    // Get the two colors that we will interpolate in the LUT texture\n    lowp vec4 newColor1 = texture2D(lookupTable, texPos1);\n    lowp vec4 newColor2 = texture2D(lookupTable, texPos2);\n\n    // Interpolate between the two depending on our blue channel\n    lowp vec4 newColor = mix(newColor1, newColor2, fract(unboundBlueSlice));\n    return newColor;\n}"]};e.prototype.getHeaderCode=function(e){return e("\n//look up table effect---\n        uniform float level@;\n        uniform sampler2D lookup2D@;\n        uniform vec2 uBlueSlicesIn2DLayout@;\n        uniform vec2 uTexSize@;\n        ")};e.prototype.getShaderFunctionBody=function(e){return e("\n//look up table effect---\n        vec4 tempColor@ = getColorInLookupTable(gl_FragColor, lookup2D@, uBlueSlicesIn2DLayout@, uTexSize@);\n        gl_FragColor.rgb = mix(gl_FragColor.rgb,tempColor@.rgb, level@);\n        ")};e.prototype.onBeforeBabylonRender=function(e,t){e.setFloat(t("level@"),this._level);this._texture&&e.setTexture(t("lookup2D@"),this._texture);e.setVector2(t("uBlueSlicesIn2DLayout@"),this.getBlueSlicesIn2DLayout());e.setVector2(t("uTexSize@"),this.calculateTextureSize())};e.prototype.onBeforeGlRender=function(e,t,n){var r=e.getUniformLocation(t,n("level@"));e.uniform1f(r,this._level);if(this._texture){var i=e.getUniformLocation(t,n("lookup2D@"));e.uniform1i(i,$g.lut);e.activeTexture((function(e,t){switch(t){case $g.main:return e.TEXTURE0;case $g.lut:return e.TEXTURE1;case $g.blend:return e.TEXTURE2;case $g.overlay:return e.TEXTURE3;default:throw new oa(t)}})(e,$g.lut));e.bindTexture(e.TEXTURE_2D,this._texture)}var s=e.getUniformLocation(t,n("uBlueSlicesIn2DLayout@"));e.uniform2fv(s,[this.getBlueSlicesIn2DLayout().x,this.getBlueSlicesIn2DLayout().y]);var o=e.getUniformLocation(t,n("uTexSize@")),u=this.calculateTextureSize();e.uniform2fv(o,[u.x,u.y])};return e})(),iy=Vt([function(e){return e.animations.transitionToViewingOriginal.isActive},function(e){return e.isViewingOriginal},df],function(e,t,n){return t&&!e&&n!==gr.draggingView}),sy=function(){return(sy=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)},oy=Object(q.connect)(function(e){var t=e.filters.activeFilter;return{level:e.filters.filterLevel,activeFilter:t,disabled:iy(sy(sy({},e.transformTools),e.uiState))}})(function(e){var t=e.level,n=e.activeFilter,r=e.disabled,s=Object(i.useContext)(ny),o=s.textures,u=s.urlsById,a=s.loadUrls,f=Object(i.useMemo)(function(){return new ry},[]),l=rf(n);0===Object.keys(u).length&&l&&t>0&&a();var c=u[n.lutUrlId],h=l&&c?o[c]:void 0,p=h?h.parts[0].texture:void 0,d=p&&!r?t:0;f.setLevel(d);l&&n.config&&f.setConfiguration(n.config);f.setTexture(p);bh(d,n,p);ph(f);return null}),uy={defName:"MASTER",levelUniformName:"uMasterLevel",mapNormalizedToShaderValue:function(e){return e}},ay=function(){return uy},fy=function(){return(fy=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)},ly=Object(q.connect)(function(e){return{level:iy(fy(fy({},e.transformTools),e.uiState))?0:1}})(function(e){var t=e.level,n=ay();Eg(n,t);return null}),cy={defName:"SATURATION",levelUniformName:"uSaturationLevel",mapNormalizedToShaderValue:Nn(-1,1)},hy=function(){return cy},py=s.a.memo(function(e){var t=e.saturationNormalizedSliderLevel,n=hy();Eg(n,t);return null}),dy=Object(q.connect)(function(e){return{saturationNormalizedSliderLevel:e.colorAdjustments.saturation}})(py),vy={defName:"VIBRANCE",levelUniformName:"uVibranceLevel",mapNormalizedToShaderValue:Nn(-1,1)},my=function(){return vy},gy=Object(q.connect)(function(e){return{level:e.colorAdjustments.vibrance}})(function(e){var t=e.level,n=my();Eg(n,t);return null}),yy=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),i=0;for(t=0;t<n;t++)for(var s=arguments[t],o=0,u=s.length;o<u;o++,i++)r[i]=s[o];return r},by=(function(){function e(){this._transform=[1,0,0,0,1,0];this._level=0}e.prototype.setTransform=function(e){this._transform=e};e.prototype.getTransform=function(){return this._transform};e.prototype.setLevel=function(e){this._level=e};e.prototype.getName=function(){return"VignetteShader"};e.prototype.getUniformNames=function(e){return[e("uCropTransform@"),e("uCropTransformInverse@"),e("uLevel@")]};e.prototype.getFunctions=function(e){return[]};e.prototype.getHeaderCode=function(e){return e("\n          //Vignette effect---\n          uniform mat3 uCropTransform@;\n          uniform mat3 uCropTransformInverse@;\n          uniform float uLevel@;\n        ")};e.prototype.getShaderFunctionBody=function(e){return e("\n        //Vignette effect---\n        vec3 normalizedPos@ = vec3("+zc+".x, "+zc+".y,1.0) * uCropTransformInverse@;\n\n        float shouldMix@ = step(0.0, normalizedPos@.x) * step(0.0, normalizedPos@.y) * step(0.0, 1.0 - normalizedPos@.x) * step(0.0, 1.0 - normalizedPos@.y);\n        float dist@ = distance(normalizedPos@.xy, vec2(0.5));\n        float vignetteSize@ = 0.5;\n        float gradient@ = smoothstep(0.8, vignetteSize@ * 0.799, dist@ * (abs(uLevel@ * 0.525) + vignetteSize@));\n\n        vec3 color@ = gl_FragColor.rgb;\n\n        // white\n        if(uLevel@ < 0.) {\n          color@ = mix(vec3(1.), gl_FragColor.rgb, gradient@);\n        }\n\n        // black\n        if(uLevel@ > 0.) {\n          color@ = mix(vec3(0.), gl_FragColor.rgb, gradient@);\n        }\n\n        gl_FragColor.rgb = mix(gl_FragColor.rgb, color@, shouldMix@);\n      ")};e.prototype.onBeforeBabylonRender=function(e,t){e.setMatrix3x3(t("uCropTransform@"),new Float32Array(yy(this._transform,[0,0,1])));e.setMatrix3x3(t("uCropTransformInverse@"),new Float32Array(yy(qn(this._transform),[0,0,1])));e.setFloat(t("uLevel@"),this._level)};e.prototype.onBeforeGlRender=function(e,t,n){var r=e.getUniformLocation(t,n("uCropTransform@"));e.uniformMatrix3fv(r,!1,new Float32Array(yy(this._transform,[0,0,1])));var i=qn(this._transform),s=e.getUniformLocation(t,n("uCropTransformInverse@"));e.uniformMatrix3fv(s,!1,new Float32Array(yy(i,[0,0,1])));var o=e.getUniformLocation(t,n("uLevel@"));e.uniform1f(o,this._level)};return e})(),wy={mapNormalizedToShaderValue:Nn(-.7,.7)},Ey=Object(q.connect)(function(e){return{transform:Lh(e.transformTools),level:e.colorAdjustments.vignette}})(function(e){var t=e.transform,n=e.level,r=Object(i.useMemo)(function(){return new by},[]),s=wy.mapNormalizedToShaderValue;r.setTransform(t);r.setLevel(s(n));wh(t);bh(n);ph(r);return null}),Sy=[3.2404542,-1.5371385,-.4985314,-.969266,1.8760108,.041556,.0556434,-.2040259,1.0572252],xy=function(e,t,n){return{r:Sy[0]*e+Sy[1]*t+Sy[2]*n,g:Sy[3]*e+Sy[4]*t+Sy[5]*n,b:Sy[6]*e+Sy[7]*t+Sy[8]*n}},Ty=[{u:.18006,v:.26352,slope:-.24341,recipTemp:0},{u:.18066,v:.26589,slope:-.25479,recipTemp:1e-5},{u:.18133,v:.26846,slope:-.26876,recipTemp:2e-5},{u:.18208,v:.27119,slope:-.28539,recipTemp:1/33333},{u:.18293,v:.27407,slope:-.3047,recipTemp:4e-5},{u:.18388,v:.27709,slope:-.32675,recipTemp:5e-5},{u:.18494,v:.28021,slope:-.35156,recipTemp:1/16667},{u:.18611,v:.28342,slope:-.37915,recipTemp:1/14286},{u:.1874,v:.28668,slope:-.40955,recipTemp:8e-5},{u:.1888,v:.28997,slope:-.44278,recipTemp:1/11111},{u:.19032,v:.29326,slope:-.47888,recipTemp:1e-4},{u:.19462,v:.30141,slope:-.58204,recipTemp:1/8e3},{u:.19962,v:.30921,slope:-.70471,recipTemp:1/6667},{u:.20525,v:.31647,slope:-.84901,recipTemp:1/5714},{u:.21142,v:.32312,slope:-1.0182,recipTemp:2e-4},{u:.21807,v:.32909,slope:-1.2168,recipTemp:1/4444},{u:.22511,v:.33439,slope:-1.4512,recipTemp:1/4e3},{u:.23247,v:.33904,slope:-1.7298,recipTemp:1/3636},{u:.2401,v:.34308,slope:-2.0637,recipTemp:1/3333},{u:.24792,v:.34655,slope:-2.4681,recipTemp:1/3077},{u:.25591,v:.34951,slope:-2.9641,recipTemp:1/2857},{u:.264,v:.352,slope:-3.5814,recipTemp:1/2677},{u:.27218,v:.35407,slope:-4.3633,recipTemp:4e-4},{u:.28039,v:.35577,slope:-5.3762,recipTemp:1/2353},{u:.28863,v:.35714,slope:-6.7262,recipTemp:1/2222},{u:.29685,v:.35823,slope:-8.5955,recipTemp:1/2105},{u:.30505,v:.35907,slope:-11.324,recipTemp:5e-4},{u:.3132,v:.35968,slope:-15.628,recipTemp:1/1905},{u:.32129,v:.36011,slope:-23.325,recipTemp:1/1818},{u:.32931,v:.36038,slope:-40.77,recipTemp:1/1739},{u:.33724,v:.36051,slope:-116.45,recipTemp:1/1667}],Ny=function(e,t){var n=(function(e,t){for(var n=1/e,r=1;r<Ty.length&&!(n<Ty[r].recipTemp);r++);r===Ty.length&&r--;var i=Ty[r-1],s=Ty[r],o=Tn(i.recipTemp,s.recipTemp,n),u=xn(i.slope/Math.sqrt(1+i.slope*i.slope),s.slope/Math.sqrt(1+s.slope*s.slope),o),a=xn(i.u,s.u,o),f=xn(i.v,s.v,o),l=t/Math.sqrt(1+u*u),c=a+l,h=f+u*l;if(h>-.1*c+.4){var p=(-.1*c+.4-h)/(-.1*(c-a)+f-h);c=xn(c,a,p);h=xn(h,f,p)}return{y:1,u:c,v:h}})(e,t);return(function(e,t,n){var r=0,i=0;if(e>=1e-7){r=6*t*e/(4*n);i=e*(6*(4-t)-60*n)/(12*n)}return[r,e,i]})(n.y,n.u,n.v)},Cy={defName:"WHITE_BALANCE",mapSliderValueToTint:function(e){return[.003256,1.25*(e=xn(-1,1,e))/100+.003256]},whiteBalanceGainUniformName:"uWhiteBalanceGain",mapSliderValueToKelvinTemperature:function(e){var t=6502.078125;(e=xn(-1,1,e))>0?t=xn(6502.078125,1e4,e):e<0&&(t=xn(6502.078125,4e3,-e));return[t,6502.078125]},mapTemperatureAndTintToRBGains:function(e,t,n,r){var i=ni(e,1667,Number.MAX_VALUE),s=Ny(i,n),o=Ny(t,r),u=xy.apply(void 0,s),a=xy.apply(void 0,o);return[a.r/a.g/(u.r/u.g),a.b/a.g/(u.b/u.g)]}},ky=function(){return Cy},Ly=(function(){function e(e){this._whiteBalanceGainUniformName=e;this._whiteBalanceGainVector={r:1,g:1,b:1}}e.prototype.onBeforeBabylonRender=function(e){e.setColor3(this._whiteBalanceGainUniformName,this._whiteBalanceGainVector)};e.prototype.onBeforeGlRender=function(e,t){var n=e.getUniformLocation(t,this._whiteBalanceGainUniformName);e.uniform3f(n,this._whiteBalanceGainVector.r,this._whiteBalanceGainVector.g,this._whiteBalanceGainVector.b)};e.prototype.setGains=function(e,t){this._whiteBalanceGainVector={r:e,g:1,b:t}};return e})(),Ay=s.a.memo(function(e){var t=e.tintLevel,n=e.temperatureLevel,r=ky(),s=r.mapSliderValueToTint,o=r.mapSliderValueToKelvinTemperature,u=r.mapTemperatureAndTintToRBGains,a=r.whiteBalanceGainUniformName,f=r.defName,l=o(n),c=l[0],h=l[1],p=s(t),d=u(c,h,p[0],p[1]),v=d[0],m=d[1],g=(function(e,t){return Object(i.useMemo)(function(){var n=new Ly(e);return[n,new yg(t,t,n)]},[e,t])})(a,f),y=g[0],b=g[1];y.setGains(v,m);bh(t,n);ph(b);return null});var Oy=Object(q.connect)(function(e){return{tintLevel:e.colorAdjustments.tint,temperatureLevel:e.colorAdjustments.temperature}})(Ay),My=(function(){function e(){this._zoomLevel=1}e.prototype.setZoomLevel=function(e){this._zoomLevel=e};e.prototype.getName=function(){return"ZoomToPixelsShader"};e.prototype.getUniformNames=function(e){return[e("uZoomLevel@")]};e.prototype.getFunctions=function(){return[]};e.prototype.getHeaderCode=function(e){return e(" //ZoomToPixels effect---\n    uniform float uZoomLevel@;")};e.prototype.getShaderFunctionBody=function(e){return e("//ZoomToPixels effect---\n        if(uZoomLevel@ > 1.0 && "+Zc+" == 0.){\n            vec2 screenTranslationInPixels@ = (vec3(0.0,0.0,1.0) * "+Wc+").xy;\n            vec2 zoomVec2@ = vec2(uZoomLevel@);\n            vec2 pixelPosOffset@ = mod(screenTranslationInPixels@, zoomVec2@);\n            vec2 pixelPosRounded@ = floor(("+zc+"- pixelPosOffset@)/zoomVec2@ )*uZoomLevel@ + 0.5*zoomVec2@;\n            vec3 uv@ = vec3(pixelPosRounded@.x + pixelPosOffset@.x, pixelPosRounded@.y + pixelPosOffset@.y,1.0) * "+Xc+";\n            gl_FragColor = getTextureColor(uv@.xy);\n\n            // Texture may not be set so use the color override to show that instead (these are set in ShadersBase.ts)\n            gl_FragColor = mix(gl_FragColor,"+Jc+","+$c+");\n\n            //modify the uv so that subsequent effect code will use this uv value when sampling textures.\n            "+Uc+".xy = uv@.xy;\n        }\n        ")};e.prototype.onBeforeBabylonRender=function(e,t){e.setFloat(t("uZoomLevel@"),this._zoomLevel)};e.prototype.onBeforeGlRender=function(e,t,n){var r=e.getUniformLocation(t,n("uZoomLevel@"));e.uniform1f(r,this._zoomLevel)};return e})(),_y=s.a.memo(function(e){var t=e.zoomLevel,n=Object(i.useMemo)(function(){return new My},[]);n.setZoomLevel(t);bh(t);ph(n);return null});_y.displayName="ZoomToPixelsEffect";var Dy=Object(q.connect)(function(e){return{zoomLevel:vp(e.transformTools)}})(_y),Py=Object(i.createContext)({enableAdjustments:!1,enableFilters:!1,enableAutoEnhance:!1,enableMarkup:!1}),Hy=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),i=0;for(t=0;t<n;t++)for(var s=arguments[t],o=0,u=s.length;o<u;o++,i++)r[i]=s[o];return r},By=ky(),jy=Tg(),Fy=hy(),Iy=my(),qy=Xg(),Ry=Rg(),Uy=ay(),zy=Hy([By.whiteBalanceGainUniformName,jy.levelUniformName,Fy.levelUniformName,Iy.levelUniformName,qy.highLevelValuesUniformName,qy.lowLevelValuesUniformName,Uy.levelUniformName],Ry.getUniformNames()),Wy="\n#ifdef "+By.defName+"\n  uniform vec3 "+By.whiteBalanceGainUniformName+";\n#endif\n#ifdef "+jy.defName+"\n  uniform float "+jy.levelUniformName+";\n#endif\n#ifdef "+Fy.defName+"\n  uniform float "+Fy.levelUniformName+";\n  const float SATURATION_RED_K = 9437.0 / 32768.0;\n  const float SATURATION_GREEN_K = 1.0 - SATURATION_RED_K;\n#endif\n#ifdef "+Iy.defName+"\n  uniform float "+Iy.levelUniformName+";\n#endif\n#ifdef "+qy.defName+"\n  uniform vec3 "+qy.lowLevelValuesUniformName+";\n  uniform vec3 "+qy.highLevelValuesUniformName+";\n\n  float TransformChannelContrast(in float channelLevel, in vec3 low, in vec3 high) {\n    vec3 levels = mix(low, high, step(channelLevel, 0.5));\n    return ((levels.x * channelLevel + levels.y) * channelLevel) + levels.z;\n  }\n#endif\n#ifdef "+Ry.defName+"\n  uniform vec4 "+Ry.negativeVectorUniformName+";\n  uniform vec4 "+Ry.neutralVectorUniformName+";\n  uniform vec4 "+Ry.positiveVectorUniformName+";\n#endif\n#ifdef "+Uy.defName+"\n  uniform float "+Uy.levelUniformName+";\n#endif\n\n  struct Adjustments {\n    vec3 whiteBalanceGain;\n    float brightness;\n    float saturation;\n    float vibrance;\n    vec3 contrastLowLevels;\n    vec3 contrastHighLevels;\n    vec4 colorCurvesNeutralVector;\n    vec4 colorCurvesPositiveVector;\n    vec4 colorCurvesNegativeVector;\n  };\n\n  \n#ifndef RGB2HSV\n#define RGB2HSV\nvec3 rgb2hsv( in vec3 c )\n{\n    vec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\n    vec4 p = mix(vec4(c.bg, K.wz), vec4(c.gb, K.xy), step(c.b, c.g));\n    vec4 q = mix(vec4(p.xyw, c.r), vec4(c.r, p.yzx), step(p.x, c.r));\n    float d = q.x - min(q.w, q.y);\n    float e = 1.0e-10;\n    return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), d / (q.x + e), q.x);\n}\n#endif\n\n  \n#ifndef HSV2RGB\n#define HSV2RGB\nvec3  hsv2rgb( in vec3 c )\n{\n    vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n    vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n    return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\n#endif\n\n  "+Ic+"\n  \n#ifndef GETLUMINANCE\n#define GETLUMINANCE\n\nconst vec3 LuminanceEncodeApprox = vec3(0.2126, 0.7152, 0.0722);\nfloat getLuminance(vec3 color)\n{\n    return clamp(dot(color, LuminanceEncodeApprox), 0., 1.);\n}\n#endif\n\n\n  vec4 ApplyAdjustments(in Adjustments adj, in vec4 c) {\n    vec4 result = c.rgba;\n\n    #ifdef "+By.defName+"\n      // Apply White Balance (Gamma Space)\n      result.rgb *= adj.whiteBalanceGain.rgb;\n    #endif\n\n    result.rgb = toLinearSpace(result.rgb);\n\n    #ifdef "+jy.defName+"\n      // Apply Brightness (Linear Space)\n      result.rgb *= adj.brightness;\n    #endif\n\n    #ifdef "+Fy.defName+"\n      // Apply Saturation (Linear Space)\n      float saturatedR = result.r + (result.r - result.g) * SATURATION_GREEN_K * adj.saturation;\n      float saturatedG = result.g + (result.g - result.r) * SATURATION_RED_K   * adj.saturation;\n      float saturatedB = result.b + (result.b - SATURATION_RED_K * result.r - SATURATION_GREEN_K * result.g) * adj.saturation;\n      result.rgb = clamp(vec3(saturatedR, saturatedG, saturatedB), vec3(0.0), vec3(1.0));\n    #endif\n\n    #ifdef "+Iy.defName+"\n      // Apply Vibrance (Linear Space)\n      float average = (result.r + result.g + result.b) / 3.0;\n      float mx = max(result.r, max(result.g, result.b));\n      float amt = (mx - average) * (adj.vibrance * -3.0);\n      result.rgb = mix(result.rgb, vec3(mx), amt);\n    #endif\n\n    result.rgb = toGammaSpace(result.rgb);\n\n    #ifdef "+Ry.defName+"\n      // Apply Color Curves (Gamma Space)\n      // https://github.com/BabylonJS/Babylon.js/blob/6adcf34c72f322949fe04b9ccbe3fc5faf7206a1/src/Shaders/ShadersInclude/imageProcessingFunctions.fx\n      float luma = getLuminance(result.rgb);\n      vec2 curveMix = clamp(vec2(luma * 3.0 - 1.5, luma * -3.0 + 1.5), vec2(0.0), vec2(1.0));\n      vec4 colorCurve = adj.colorCurvesNeutralVector + curveMix.x * adj.colorCurvesPositiveVector - curveMix.y * adj.colorCurvesNegativeVector;\n      result.rgb *= colorCurve.rgb;\n      result.rgb = mix(vec3(luma), result.rgb, colorCurve.a);\n    #endif\n\n    result = clamp(result, 0.0, 1.0);\n\n    #ifdef "+qy.defName+"\n      // Apply Contrast (Gamma Space)\n      // Assumption: Value is clamped. Otherwise high contrast levels cause strange colors with high brightness/exposure\n      result.r = TransformChannelContrast(result.r, adj.contrastLowLevels, adj.contrastHighLevels);\n      result.g = TransformChannelContrast(result.g, adj.contrastLowLevels, adj.contrastHighLevels);\n      result.b = TransformChannelContrast(result.b, adj.contrastLowLevels, adj.contrastHighLevels);\n    #endif\n\n    result = clamp(result, 0.0, 1.0);\n    return result;\n  }\n",Xy="\n  Adjustments adj;\n\n  #ifdef "+By.defName+"\n    adj.whiteBalanceGain = "+By.whiteBalanceGainUniformName+";\n  #endif\n\n  #ifdef "+jy.defName+"\n    adj.brightness = "+jy.levelUniformName+";\n  #endif\n\n  #ifdef "+Fy.defName+"\n    adj.saturation = "+Fy.levelUniformName+";\n  #endif\n\n  #ifdef "+Iy.defName+"\n    adj.vibrance = "+Iy.levelUniformName+";\n  #endif\n\n  #ifdef "+qy.defName+"\n    adj.contrastLowLevels = "+qy.lowLevelValuesUniformName+";\n    adj.contrastHighLevels = "+qy.highLevelValuesUniformName+";\n  #endif\n\n  #ifdef "+Ry.defName+"\n    adj.colorCurvesNeutralVector = "+Ry.neutralVectorUniformName+";\n    adj.colorCurvesPositiveVector = "+Ry.positiveVectorUniformName+";\n    adj.colorCurvesNegativeVector = "+Ry.negativeVectorUniformName+";\n  #endif\n\n  #ifdef "+Uy.defName+"\n    float shouldApplyAdjustments = mix("+Uy.levelUniformName+", 1., "+Zc+");\n    gl_FragColor = mix(gl_FragColor, ApplyAdjustments(adj, gl_FragColor), shouldApplyAdjustments);\n  #else\n    gl_FragColor = ApplyAdjustments(adj, gl_FragColor);\n  #endif\n",Vy=(function(){function e(){}e.prototype.getName=function(){return"AdjustmentsShader"};e.prototype.getUniformNames=function(e){return zy};e.prototype.getFunctions=function(){return[]};e.prototype.getHeaderCode=function(e){return Wy};e.prototype.getShaderFunctionBody=function(e){return Xy};e.prototype.onBeforeBabylonRender=function(e,t){};e.prototype.onBeforeGlRender=function(e,t,n){};return e})(),$y=function(e){var t=e.children;ph(Object(i.useMemo)(function(){return new Vy},[]));return s.a.createElement(s.a.Fragment,null,t)},Jy=s.a.memo(function(){var e=Object(i.useContext)(Py),t=e.enableAdjustments,n=e.enableFilters;return s.a.createElement(s.a.Fragment,null,s.a.createElement(Dy,null),n&&s.a.createElement(oy,null),t&&s.a.createElement(s.a.Fragment,null,s.a.createElement($y,null,s.a.createElement(Oy,null),s.a.createElement(Ng,null),s.a.createElement(Kg,null),s.a.createElement(gy,null),s.a.createElement(zg,null),s.a.createElement(dy,null),s.a.createElement(ly,null)),s.a.createElement(Ey,null)),s.a.createElement(kg,null),s.a.createElement(ey,null),s.a.createElement(ty,null))}),Ky=Object(q.connect)(function(e){return{filters:e.filters.availableFilters}})(function(e){var t=Object(i.useContext)(Ha);return s.a.createElement(t.lutProvider,Da({},e))}),Qy=0,Gy=100,Yy=1,Zy=function(e){return e.toFixed(0)},eb=function(){return(eb=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)},tb=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n},nb=Object(i.memo)(function(e){var t,n=e.filterLevel,r=e.setFilterLevel,o=e.layout,u=e.headerName,a=e.ariaLabel,f=e.style,l=tb(e,["filterLevel","setFilterLevel","layout","headerName","ariaLabel","style"]),c=ba(),h=Qy,p=Gy,d=Yy,v=Zy,m=Object(i.useContext)(_e).localizeNumber,g=Object(i.useCallback)(function(e){var t=Tn(h,p,e);r(t)},[h,p,r]),y=Object(i.useMemo)(function(){return xn(h,p,n)},[n,h,p]),b=Object(i.useMemo)(function(){var e=Ol(c);return Object(wa.b)(e,(null==f?void 0:f.getSliderStyles)&&(null==f?void 0:f.getSliderStyles(c,y)))},[f,c,y]),w={value:y,valueFormatter:v,maxValue:p,minValue:h,name:u};return s.a.createElement("div",{style:null==f?void 0:f.container},s.a.createElement(zl,{headerProps:w,layout:o,styles:null===(t=null==f?void 0:f.getSliderHeaderStyles)||void 0===t?void 0:t.call(f,c)}),s.a.createElement(Al.e,eb({},l,{min:h,max:p,step:d,value:y,styles:b,showValue:!1,originFromZero:!0,onChange:g,ariaLabel:a,ariaValueText:m})))});Object(_l.n)([{rawString:".imageTileContainer_bf9f830f{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:center;-ms-flex-align:center;align-items:center;margin-bottom:8px;width:-webkit-min-content;width:-moz-min-content;width:min-content}.imageTileContainer_bf9f830f .tile_bf9f830f{position:relative;background-color:transparent;background-size:cover;background-repeat:no-repeat;background-position:center;height:93px;width:93px;border-radius:3px;margin:8px 0}.imageTileContainer_bf9f830f .tile_bf9f830f .background_bf9f830f{position:absolute;top:0;height:100%;width:100%;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;opacity:0;font-size:23px;border-radius:3px}.imageTileContainer_bf9f830f .tileName_bf9f830f{font-size:12px;line-height:14px;text-align:center;word-break:break-word;word-wrap:break-word}.tileIcon_bf9f830f{fill:#fff;font-size:24px;width:24px;height:24px}.ms-Fabric--isFocusHidden .imageTileContainer_bf9f830f .ms-Tile-link{outline:0;height:100%}.ms-Fabric--isFocusVisible .imageTileContainer_bf9f830f .ms-Tile-link:focus{outline:auto}"}]);var rb="imageTileContainer_bf9f830f",ib="tile_bf9f830f",sb="background_bf9f830f",ob="tileName_bf9f830f",ub="tileIcon_bf9f830f",ab=function(){return(ab=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)};function fb(e){return{width:"100%",height:"100%",backgroundColor:e.palette.neutralQuaternary,color:e.palette.black,activeBackgroundOverride:{opacity:1}}}function lb(e,t,n,r){return ab(ab(ab(ab({},r),e&&(null==r?void 0:r.highlightImageOverride)),t&&(null==r?void 0:r.activeImageOverride)),n&&(null==r?void 0:r.disabledImageOverride))}var cb=n(1673),hb=n(308),pb=function(){return(pb=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)},db=Object(i.forwardRef)(function(e,t){var n=e.image,r=e.imageTileStyles,o=e.name,u=e.ariaLabel,a=e.isHighlighted,f=e.isActive,l=e.isDisabled,c=void 0!==l&&l,h=e.role,p=void 0===h?"button":h,d=e.tabIndex,v=void 0===d?0:d,m=e.containerRef,g=e.onClick,y=e.onKeyDown,b=ba(),w=Object(i.useState)(null),E=w[0],S=w[1],x=Object(i.useCallback)(function(e){g(o,e)},[o,g]);Object(i.useLayoutEffect)(function(){if(E){E.tabIndex=v;E.setAttribute("role",p)}},[E,p,v]);Object(i.useImperativeHandle)(t,function(){return{focus:function(){return null==E?void 0:E.focus()}}},[E]);var T=Object(i.useMemo)(function(){return s.a.createElement(s.a.Fragment,null,s.a.createElement("div",{className:sb,style:Ov(a,f,c,pb(pb({},fb(b)),null==r?void 0:r.background))},s.a.createElement(Nc.e,{iconName:"ActiveFilterCheckmark-Havana",className:ub,style:null==r?void 0:r.icon})),!n&&s.a.createElement(cb.e,{theme:b,shimmerElements:[{type:hb.e.line,width:93,height:93}]}))},[n,r,f,c,a,b]),N=Object(i.useMemo)(function(){return s.a.createElement("span",{className:ob,style:Mv(f,c,null==r?void 0:r.name),"aria-hidden":"true"},o)},[null==r?void 0:r.name,f,c,o]);return s.a.createElement("div",{className:rb,style:null==r?void 0:r.container,ref:m,"data-test-id":n?"image-tile-image-loaded":"image-tile-image-loading"},s.a.createElement(hv.e,{style:pb({backgroundImage:f?"":"url("+n+")"},lb(a,f,c,null==r?void 0:r.image)),className:ib,background:T,onClick:c?void 0:x,ariaLabel:u,linkRef:S,onKeyDown:y,"data-test-id":"imageTile-"+u}),N)}),vb=function(){return(vb=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)};function mb(e,t,n,r,o,u,a,f,l,c){var h=Object(i.useContext)(_e).strings;return Object(i.useCallback)(function(i,p){var d,v=n.find(function(e){return i.name===e.name});return s.a.createElement(db,{key:i.name,image:null!==(d=null==v?void 0:v.src)&&void 0!==d?d:"",onClick:function(){o(i,p);u(sc(h.filter_changedAriaLive,h[i.ariaLabelLocStringKey]))},isActive:e.name===i.name,isHighlighted:!1,name:h[i.locStringKey],ariaLabel:h[i.ariaLabelLocStringKey],imageTileStyles:vb(vb({},a),{image:vb({width:r,height:r},null==a?void 0:a.image),container:null==a?void 0:a.container}),tabIndex:(null==f?void 0:f.name)===i.name?0:-1,onKeyDown:l,containerRef:t[p],ref:function(e){c&&c.current&&(c.current[p]=e)},role:"listitem"})},[n,e.name,h,a,r,null==f?void 0:f.name,l,t,o,u,c])}var gb=function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(e){try{a(r.next(e))}catch(e){s(e)}}function u(e){try{a(r.throw(e))}catch(e){s(e)}}function a(e){e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(o,u);var t}a((r=r.apply(e,t||[])).next())})},yb=function(e,t){var n,r,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function u(s){return function(u){return(function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&s[0]?r.return:s[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,s[1])).done)return i;(r=0,i)&&(s=[2&s[0],i.value]);switch(s[0]){case 0:case 1:i=s;break;case 4:o.label++;return{value:s[1],done:!1};case 5:o.label++;r=s[1];s=[0];continue;case 7:s=o.ops.pop();o.trys.pop();continue;default:if(!(i=o.trys,i=i.length>0&&i[i.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1];i=s;break}if(i&&o.label<i[2]){o.label=i[2];o.ops.push(s);break}i[2]&&o.ops.pop();o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e];r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}})([s,u])}}};function bb(e,t){var n=!1;return{promise:gb(this,void 0,void 0,function(){var r,i,s,o,u,a;return yb(this,function(f){switch(f.label){case 0:r=[];i=0,s=e;f.label=1;case 1:if(!(i<s.length))return[3,5];o=s[i];if(n)return[3,3];a=(u=r).push;return[4,t(o)];case 2:a.apply(u,[f.sent()]);return[3,4];case 3:return[3,5];case 4:i++;return[3,1];case 5:return[2,r]}})}),cancel:function(){n=!0}}}var wb=function(e){return new Promise(function(t){window.setTimeout(function(){t(!0)},e)})},Eb=function(e,t,n){var r=void 0,i=e.getEffects().find(function(e){return e.getName()===n});if(i){r=i.getLevel();i.setLevel(t)}return function(){i&&i.setLevel(null!=r?r:0)}};var Sb=function(e,t,n,r,i,s){var o=void 0,u=void 0,a=void 0,f=e.getEffects().find(function(e){return"LutShader"===e.getName()});try{if(f){o=f.getLevel();u=f.getTexture();a=f.getConfiguration();(function(e,t,n,r,i){if(rf(r)&&i){var s=t[n[r.lutUrlId]];if(!s||1!==s.parts.length)throw new Error("support is only available for filters from list of default filters");e.setTexture(s.parts[0].texture);e.setConfiguration(r.config);e.setLevel(i)}else e.setLevel(0)})(f,i,s,t,n)}}catch(e){r({id:"FilterTextureNotFound",message:"Failed to apply the default filter during offscreen render: "+e+" "})}return function(){if(f&&a){f.setLevel(null!=o?o:0);f.setTexture(u);f.setConfiguration(a)}}},xb=function(e,t,n,r,i,s,o){var u=(function(e,t){return Eb(e,t,"ENABLE_SECONDARY_BLEND")})(e,r),a=Sb(e,t,n,s,o.lutTextures,o.lutUrlsById),f=(function(e,t){return Eb(e,t,"ENABLE_SECONDARY_OVERLAY")})(e,i);return function(){u();a();f()}},Tb=function(){return(Tb=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)},Nb=function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(e){try{a(r.next(e))}catch(e){s(e)}}function u(e){try{a(r.throw(e))}catch(e){s(e)}}function a(e){e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(o,u);var t}a((r=r.apply(e,t||[])).next())})},Cb=function(e,t){var n,r,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function u(s){return function(u){return(function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&s[0]?r.return:s[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,s[1])).done)return i;(r=0,i)&&(s=[2&s[0],i.value]);switch(s[0]){case 0:case 1:i=s;break;case 4:o.label++;return{value:s[1],done:!1};case 5:o.label++;r=s[1];s=[0];continue;case 7:s=o.ops.pop();o.trys.pop();continue;default:if(!(i=o.trys,i=i.length>0&&i[i.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1];i=s;break}if(i&&o.label<i[2]){o.label=i[2];o.ops.push(s);break}i[2]&&o.ops.pop();o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e];r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}})([s,u])}}};function kb(e,t,n,r,s,o){var u=this,a=Object(i.useState)([]),f=a[0],l=a[1],c=Object(i.useContext)(Za),h=c.image,p=c.offscreenRenderer,d=Se();Object(i.useEffect)(function(){var i=!1,a=bb(e,function(e){return Nb(u,void 0,void 0,function(){var u,a,f,l;return Cb(this,function(c){switch(c.label){case 0:u=void 0;a=(function(e){return Ja(e)?Wa(Wa({},e),{overlay:null}):Wa(Wa({},{main:null,blend:null,overlay:null}),{main:e})})(h);if(!p||!a)return[3,4];f=function(t,n){return xb(t,e,1,0,0,d,n)};return[4,wb(0)];case 1:c.sent();return i?[3,4]:[4,p.getEditedImage(a,Tb({},(v=Ls(t),m=Hr(n),g={width:Math.floor(s*r),height:Math.floor(o*r)},y=g.width/m.width,b=g.height/m.height,w=Math.max(y,b),E={left:0,top:0,width:g.width,height:g.height},{imageTransform:{width:v.width*w,height:v.height*w,x:E.width-(E.width/2+w*m.width/2)-m.left*w+v.x*w,y:E.height-(E.height/2+w*m.height/2)-m.top*w+v.y*w,rotation:v.rotation},cropRectangle:E})),f)];case 2:l=c.sent();return[4,wb(0)];case 3:c.sent();u=null==l?void 0:l.toDataURL();c.label=4;case 4:return[2,{name:e.name,src:u}]}var v,m,g,y,b,w,E})})}),f=a.promise,c=a.cancel;Nb(u,void 0,void 0,function(){var e;return Cb(this,function(t){switch(t.label){case 0:t.trys.push([0,2,,3]);return[4,f];case 1:e=t.sent();i||l(e);return[3,3];case 2:t.sent();l([]);return[3,3];case 3:return[2]}})});return function(){c();i=!0}},[e,n,r,d,o,h,t,p,s]);return f}Object(_l.n)([{rawString:".bodyContainer_0ff96503{display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;padding:24px 0}.bodyContainer_0ff96503 .rowContainer_0ff96503{width:100%}.bodyContainer_0ff96503 .row_0ff96503{width:100%;display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between}.bodyContainer_0ff96503 .lastRowWithFewerItems_0ff96503{-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}.bodyContainer_0ff96503 .lastRowWithFewerItems_0ff96503>*{margin-left:9px;margin-right:9px}"}]);var Lb="bodyContainer_0ff96503",Ab="rowContainer_0ff96503",Ob="row_0ff96503",Mb="lastRowWithFewerItems_0ff96503",_b=Object(i.memo)(function(e){var t=e.availableFilters,n=e.activeFilter,r=e.filterLevelsByName,o=e.setActiveFilterAndLevel,u=e.setAriaAnnouncement,a=e.size,f=e.styles,l=e.header,c=e.footer,h=e.imageTransformValues,p=e.cropTransformValues,d=e.cssToPhysicalPixelRatio,v=e.children,m=Object(i.useState)(t.length),g=m[0],y=m[1],b=Object(i.useMemo)(function(){return t.map(function(){return Object(i.createRef)()})},[t]),w=Object(i.useRef)(new Array(t.length)),E=Xm(t,n,g),S=E.keyboardFocusedIndex,x=E.setKeyboardFocusedIndex,T=E.onKeyDown,N=Object(i.useContext)(_e).strings,C=N,k=Object(i.useCallback)(function(e){o({activeFilter:n,filterLevel:e})},[n,o]),L=Object(i.useCallback)(function(e,t){o({activeFilter:e,filterLevel:r[e.name]});x(t)},[r,x,o]);Object(i.useLayoutEffect)(function(){for(var e,t,n,r=0;r<b.length;r++){var i=null===(t=null===(e=b[r])||void 0===e?void 0:e.current)||void 0===t?void 0:t.getBoundingClientRect();if(n&&i&&n.top<i.top){y(r);return}n=i}y(b.length)},[b]);Object(i.useLayoutEffect)(function(){var e;w.current&&(null===(e=w.current[S])||void 0===e||e.focus())},[S]);var A=kb(t,h,p,d,93,93),O=mb(n,b,A,93,L,u,null==f?void 0:f.imageTile,t[S],T,w),M=t.map(O).map(function(e,n){return s.a.createElement("div",{ref:b[n],key:t[n].name,style:null==f?void 0:f.filterTile},e)}).reduce(function(e,t){g&&e[e.length-1].length&&e[e.length-1].length===g&&e.push([]);e[e.length-1].push(t);return e},[[]]).map(function(e,t,i){var o=i.length-1===t&&e.length!==i[0].length;return s.a.createElement("div",{key:t,className:Ab},s.a.createElement("div",{className:Ob+" "+(o?Mb:"")},e),(function(e){return rf(n)&&!!e.find(function(e){return e.props.children.props.isActive})})(e)&&s.a.createElement(nb,{key:n.name,style:null==f?void 0:f.slider,filterLevel:r[n.name],setFilterLevel:k,layout:"Labeled",headerName:C.filter_intensitySliderHeader,ariaLabel:sc(C.filter_intensitySliderAriaLabelFormatString,C[n.ariaLabelLocStringKey])}))});return s.a.createElement(Yl,{size:a,styles:f,header:l,footer:c},v,s.a.createElement("section",{"aria-label":N.filter_filtersAriaLandmark},s.a.createElement("div",{className:Lb,style:null==f?void 0:f.bodyContainer,role:"list"},M)))}),Db={setActiveFilterAndLevel:qs,setAriaAnnouncement:_u},Pb=Object(q.connect)(function(e){var t=e.filters;return{availableFilters:t.availableFilters,activeFilter:t.activeFilter,filterLevelsByName:e.uiState.filterLevelsByName,cropTransformValues:e.transformTools.cropInteraction.uvToWorld,imageTransformValues:e.transformTools.image._preciseUvToWorld,cssToPhysicalPixelRatio:e.transformTools.device.pixelRatio}},Db)(_b);Object(_l.n)([{rawString:".right_pane_0897155f{width:390px;overflow-y:auto}"}]);var Hb,Bb="right_pane_0897155f",jb=function(){return(jb=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)},Fb=Object(i.memo)(function(e){var t=e.theme,n=e.styles,r=e.className,i=e.children,o={backgroundColor:t.palette.neutralLighterAlt,borderLeft:t.palette.neutralQuaternary+" 1px solid"},u=jb(jb({},o),n);return s.a.createElement("div",{className:Bb+" "+r,style:u},i)});(function(e){e.Desktop="Desktop";e.Mobile="Mobile";e.DuoDouble="DuoDouble";e.DuoSingle="DuoSingle"})(Hb||(Hb={}));var Ib={flexBasis:"100%",margin:"10px 0px",padding:"0px 16px"};function qb(e){if(e)switch(e.type){case Hb.DuoDouble:return{filterTile:{marginTop:"16px"},footer:{margin:"8px 16px"},bodyContainer:{margin:"0px -16px",padding:"0 "+("Landscape"===e.orientation?38:24)+"px"},slider:{getSliderStyles:Sv,getSliderHeaderStyles:function(){return{container:{fontSize:"16px",lineHeight:"24px",display:"grid",marginTop:"13px"}}}},imageTile:{container:{marginBottom:"0px"},image:{margin:"0px"},name:{marginTop:"8px",fontSize:"12px",height:"36px",lineHeight:"12px",fontWeight:400,activeNameOverride:{fontWeight:500}}}};case Hb.Desktop:return{filterTile:{margin:"0 8px"},slider:{container:Ib},imageTile:{container:{width:"93px"}}}}}Object(_l.n)([{rawString:".autoEnhanceContainer_73d266df{margin:30px 16px 0 16px}.autoEnhanceButton_73d266df{width:100%}"}]);var Rb="autoEnhanceContainer_73d266df",Ub="autoEnhanceButton_73d266df",zb={root:{height:"48px",border:"none"},rootHovered:{border:"none"},rootPressed:{border:"none"},textContainer:{flexGrow:0},label:{fontSize:"18px",lineHeight:"20px",fontWeight:"400"}};function Wb(e,t){if(t)return zb;var n={root:{color:e.palette.black,backgroundColor:e.palette.neutralQuaternaryAlt},rootHovered:{color:e.palette.black,backgroundColor:e.palette.neutralQuaternaryAlt,opacity:.9},rootPressed:{color:e.palette.neutralSecondary,backgroundColor:e.palette.neutralLighter},rootDisabled:{color:e.palette.neutralTertiary,backgroundColor:e.palette.neutralLighter}};return Object(wa.b)(zb,n)}var Xb=function(){return(Xb=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)};var Vb=Object(i.memo)(function(e){var t,n=e.value,r=e.autoEnhanceStatus,o=e.styles,u=e.setValue,a=e.setAutoEnhanceStatus,f=e.setAriaAnnouncement,l=e.onRequestAutoEnhance,c=Object(i.useContext)(_e),h=c.strings,p=c.localizeNumber,d=h,v=Object(i.useState)(!1),m=v[0],g=v[1],y=(function(e,t){var n=ba();return Object(i.useMemo)(function(){return"on"===e?Xb(Xb({},Wb(n,!0)),null==t?void 0:t.autoEnhanceAppliedButton):Xb(Xb({},Wb(n,!1)),null==t?void 0:t.autoEnhanceNotAppliedButton)},[e,t,n])})(r,o),b=Ja(t=Object(i.useContext)(Za).image)&&!!t.blend,w=!b&&"requested"===r,E=Object(i.useMemo)(function(){return xn(Qy,Gy,n)},[n]);(function(e,t,n,r,s){var o=Object(i.useContext)(_e),u=o.strings,a=o.localizeNumber,f=u,l=Object(i.useRef)(n);l.current=n;Object(i.useLayoutEffect)(function(){if(e&&t){r("on");s(sc(f.autoEnhance_appliedAriaLive,a(l.current)))}},[e,f.autoEnhance_appliedAriaLive,a,s,r,t])})(b&&"requested"===r,m,E,a,f);var S=Object(i.useCallback)(function(){if(b){var e="on"===r;a(e?"off":"on");f(e?d.autoEnhance_removedAriaLive:sc(d.autoEnhance_appliedAriaLive,p(E)))}else{g(!0);a("requested");f(d.autoEnhance_generatingAriaLive);null==l||l()}},[b,r,a,f,d,p,E,l]);return s.a.createElement("div",{className:Rb,style:null==o?void 0:o.bodyContainer},s.a.createElement(_d.e,{text:d.autoEnhance_name,className:Ub,styles:y,iconProps:{iconName:"AutoEnhanceOn",styles:null==o?void 0:o.icon},disabled:w,allowDisabledFocus:!0,onClick:S}),"on"===r&&s.a.createElement(nb,{key:"autoEnhance",style:null==o?void 0:o.slider,filterLevel:n,setFilterLevel:u,layout:"Labeled",disabled:w,headerName:d.autoEnhance_intensitySliderHeader,ariaLabel:d.autoEnhance_intensitySliderAriaLabel}))}),$b={setValue:na,setAutoEnhanceStatus:ra,setAriaAnnouncement:_u},Jb=Object(q.connect)(function(e){var t=e.autoEnhance;return{value:t.autoEnhanceLevel,autoEnhanceStatus:t.autoEnhanceStatus}},$b)(Vb);function Kb(e,t){var n=e[t];if(!n)throw new Error("Could not find ink brush with id "+t);return{inkBrush:n,id:t}}function Qb(e){return e.toString(16).padStart(2,"0")}function Gb(e){return[{localizedName:e.markup_colorDarkYellow,hexColor:"#fed430"},{localizedName:e.markup_colorLightOrange,hexColor:"#fbae17"},{localizedName:e.markup_colorOrange,hexColor:"#f36323"},{localizedName:e.markup_colorRed,hexColor:"#e3182d"},{localizedName:e.markup_colorDarkPurple,hexColor:"#5b318d"},{localizedName:e.markup_colorPurple,hexColor:"#914bb8"},{localizedName:e.markup_colorMagenta,hexColor:"#cf1278"},{localizedName:e.markup_colorDarkRed,hexColor:"#c10051"},{localizedName:e.markup_colorLightBlue,hexColor:"#3eccfd"},{localizedName:e.markup_colorBlue,hexColor:"#0078d7"},{localizedName:e.markup_colorDarkBlue,hexColor:"#0051ba"},{localizedName:e.markup_colorLightGreen,hexColor:"#7ec400"},{localizedName:e.markup_colorGreen,hexColor:"#00b44b"},{localizedName:e.markup_colorLightGray,hexColor:"#ebebeb"},{localizedName:e.markup_colorGray,hexColor:"#b6b6b6"},{localizedName:e.markup_colorBlack,hexColor:"#000000"}]}function Yb(e){return Gb(e).map(function(e,t){var n=++t;return{index:n,id:n.toString(),label:e.localizedName,color:e.hexColor}})}function Zb(e,t){var n=t.cssThicknesses,r=n.indexOf(e),i=Math.round(n.length/2);return-1===r?i:r}function ew(e){return function(t){var n;return""+(e.minSliderValue+t*(null!==(n=e.step)&&void 0!==n?n:1))}}function tw(e,t,n,r){var i,s=(function(e,t){var n=Gb(e).find(function(e){return e.hexColor.toLowerCase()===t.toLowerCase()});if(!n)throw new Error("No matching color option for hex value "+t);return n.localizedName})(e,"#"+Qb((i=t.drawingAttributes.color).r)+Qb(i.g)+Qb(i.b)),o=(function(e,t){switch(t){case _s.Pen:return e.markup_inkToolbarPenAriaLabel;case _s.Highlighter:return e.markup_inkToolbarHighlighterAriaLabel;default:throw new oa(t)}})(e,n.inkType),u=Zb(t.drawingAttributes.height,r),a=ew(r)(u);return sc(e.markup_addedInkStrokeAriaLive,o,s,a)}var nw=function(){return(nw=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)},rw=Object(i.memo)(function(e){var t=e.addInkContent,n=e.setAriaAnnouncement,r=e.inkBrush,o=Object(i.useContext)(Ca),u=o.InkCanvasInteraction,a=o.localizationStrings,f=o.inkConfigurations,l=Object(i.useCallback)(function(e){t(e);var i=tw(a,e,r,f[r.inkType]);n(i)},[t,r,f,a,n]);return s.a.createElement(u,nw({},e,{addInkContent:l}))}),iw={addInkContent:Ku,setAriaAnnouncement:_u},sw=Object(q.connect)(function(e){return{cssToPhysicalPixelRatio:e.transformTools.device.pixelRatio,imageViewTransform:Ep(e.transformTools)}},iw)(rw),ow=n(1623),uw=n(321),aw=n(121);Object(_l.n)([{rawString:".toolbar_d9f462e1{border-radius:8px 8px 0 0;padding:0 16px;-webkit-box-shadow:0 0 12px #000;box-shadow:0 0 12px #000;display:-webkit-box;display:-ms-flexbox;display:flex;height:-webkit-fit-content;height:-moz-fit-content;height:fit-content;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;pointer-events:auto;width:-webkit-fit-content;width:-moz-fit-content;width:fit-content;z-index:100;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.toolbar_d9f462e1 .focusZone_d9f462e1{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.inkToolbarTooltip_d9f462e1{-webkit-box-shadow:0 0 12px #000;box-shadow:0 0 12px #000;border:none;border-radius:4px;padding:6px}.toolbarButton_d9f462e1 .toolbarIcon_d9f462e1{-webkit-box-align:center;-ms-flex-align:center;align-items:center;border-radius:4px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;position:relative;-webkit-transition:-webkit-transition .15s ease-in-out;transition:-webkit-transition .15s ease-in-out;transition:transition .15s ease-in-out;transition:transition .15s ease-in-out,-webkit-transition .15s ease-in-out}"}]);var fw="toolbar_d9f462e1",lw="focusZone_d9f462e1",cw="inkToolbarTooltip_d9f462e1",hw="toolbarButton_d9f462e1",pw="toolbarIcon_d9f462e1",dw=n(1627),vw=n(695);var mw=Object(i.memo)(function(e){var t=e.iconComponent,n=e.onClick,r=e.tooltipContent,u=e.ariaLabel,a=e.ariaDescription,f=e.hasFocus,l=e.buttonId,c=e.disabled,h=e.inkToolbarToolsStyles,p=e.inkToolbarButtonStyles,d=ba(),v=(function(e,t){var n,r,i,s,o={toolbarButton:{},activeToolbarIcon:{backgroundColor:e.palette.neutralQuaternary},toolbarIcon:{width:"40px",height:"40px","&:hover":(n={backgroundColor:e.palette.neutralQuaternary},n[".inkTool"]={top:"-4px"},n),"&:active":(r={backgroundColor:e.palette.neutralTertiaryAlt},r[".inkTool"]={top:"-4px"},r)},activeSVGIcon:(i={},i[".inkTool"]={top:"-4px"},i),SVGIcon:(s={},s[".inkTool"]={top:"5px",position:"absolute",transition:"top 0.05s ease-in-out"},s)};return Object(wa.b)(o,t)})(d,h),m=v.toolbarButton,g=v.activeToolbarIcon,y=v.toolbarIcon,b=v.activeSVGIcon,w=v.SVGIcon,E=Object(wa.F)(m),S=Object(wa.F)(y,f?g:void 0,w,f?b:void 0),x=Object(la.e)("tooltip"),T={gapSpace:15,beakWidth:12,styles:{beak:{background:d.palette.neutralLight},beakCurtain:{background:d.palette.neutralLight},calloutMain:{background:d.palette.neutralLight}}},N=Object(i.useMemo)(function(){var e={root:{backgroundColor:"inherit",border:"none",height:ha+"px",margin:"0",minWidth:ca+"px",overflow:"hidden",padding:"0",width:ca+"px",alignSelf:"center"},rootHovered:{backgroundColor:"inherit"},rootPressed:{backgroundColor:"inherit"},rootDisabled:{backgroundColor:"inherit"}};return Object(wa.b)(e,p)},[p]),C=s.a.createElement(cd.e,{id:l,styles:N,className:Object(o.e)(E,hw),onClick:n,role:"radio","aria-checked":f,ariaLabel:u,ariaDescription:a,disabled:c},s.a.createElement("span",{"aria-hidden":!0,className:Object(o.e)(S,pw),role:"presentation"},t));return c||!r?C:s.a.createElement(dw.e,{content:r,id:x,calloutProps:T,delay:vw.e.long,className:cw,tooltipProps:{styles:{subText:{fontWeight:600,textAlign:"center"}}}},C)}),gw=function(){return(gw=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)},yw=Object(i.memo)(function(e){var t=e.inkToolbarToolsStyles,n=e.getIcon,r=e.activeMarkupToolType,o=e.setActiveMarkupToolType,u=e.inkToolbarButtonStyles,a=e.showTooltip,f=e.iconSize,l=Object(i.useContext)(Ca).localizationStrings,c=Object(i.useCallback)(function(){o("Eraser")},[o]),h="Eraser"===r;return s.a.createElement(mw,{inkToolbarToolsStyles:t,iconComponent:n({isActive:h,styles:gw({},f)}),onClick:c,tooltipContent:a?l.markup_inkToolbarEraserTooltip:void 0,ariaLabel:l.markup_inkToolbarEraserAriaLabel,ariaDescription:l.markup_inkToolbarEraserAriaDescription,hasFocus:h,inkToolbarButtonStyles:u})}),bw=function(){return(bw=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)},ww=Object(i.memo)(function(e){var t=e.inkBrush,n=e.buttonId,r=e.locStrings,i=e.hasFocus,o=e.getIcon,u=e.inkToolbarToolsStyles,a=e.inkToolbarButtonStyles,f=e.iconSize,l=e.onClick,c=e.getDisplayThickness,h=e.getTooltipContent,p=e.getAriaLabel;return s.a.createElement(mw,{iconComponent:o({styles:bw({},f),inkBrushColor:t.htmlColor,isActive:i}),onClick:l,tooltipContent:null==h?void 0:h(r,r.markup_inkToolbarHighlighterTooltip,t.htmlColor,c(t.thicknessInCssPixels,t.inkType),i),ariaLabel:p(r,r.markup_inkToolbarHighlighterAriaLabel,t.htmlColor,c(t.thicknessInCssPixels,t.inkType)),ariaDescription:r.markup_inkToolbarHighlighterAriaDescription,hasFocus:i,buttonId:n,inkToolbarToolsStyles:u,inkToolbarButtonStyles:a})}),Ew=function(){return(Ew=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)},Sw=Object(i.memo)(function(e){var t=e.inkBrush,n=e.buttonId,r=e.locStrings,i=e.hasFocus,o=e.getIcon,u=e.iconSize,a=e.inkToolbarToolsStyles,f=e.inkToolbarButtonStyles,l=e.onClick,c=e.getDisplayThickness,h=e.getTooltipContent,p=e.getAriaLabel;return s.a.createElement(mw,{iconComponent:o({styles:Ew({},u),inkBrushColor:t.htmlColor,isActive:i}),onClick:l,tooltipContent:null==h?void 0:h(r,r.markup_inkToolbarPenTooltip,t.htmlColor,c(t.thicknessInCssPixels,t.inkType),i),ariaLabel:p(r,r.markup_inkToolbarPenAriaLabel,t.htmlColor,c(t.thicknessInCssPixels,t.inkType)),ariaDescription:r.markup_inkToolbarPenAriaDescription,hasFocus:i,buttonId:n,inkToolbarToolsStyles:a,inkToolbarButtonStyles:f})}),xw=function(){return(xw=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)},Tw=Object(i.memo)(function(e){var t=e.inkBrush,n=e.inkBrushId,r=e.locStrings,o=e.hasFocus,u=e.brushMarkupToolType,a=e.iconSize,f=e.inkToolbarToolsStyles,l=e.inkToolbarButtonStyles,c=e.getIcon,h=e.getDisplayThickness,p=e.getTooltipContent,d=e.getAriaLabel,v=e.setActiveMarkupInkBrushId,m=e.setActiveMarkupToolType,g=e.onClick,y=Object(la.e)(n),b=Object(i.useCallback)(function(){if(!o){v(n);m(u)}null==g||g(y,o)},[o,g,y,v,n,m,u]);return s.a.createElement(Nw,{inkBrush:t,buttonId:y,locStrings:r,hasFocus:o,onClick:b,getDisplayThickness:h,getAriaLabel:d,getTooltipContent:p,inkToolbarToolsStyles:f,inkToolbarButtonStyles:l,iconSize:a,getIcon:c})}),Nw=function(e){switch(e.inkBrush.inkType){case _s.Pen:return s.a.createElement(Sw,xw({},e));case _s.Highlighter:return s.a.createElement(ww,xw({},e));default:throw new oa(e.inkBrush.inkType)}},Cw=Object(i.memo)(function(e){var t=e.brushInkPropertiesLabel,n=e.changeInkPropertiesLabel;return s.a.createElement(s.a.Fragment,null,s.a.createElement("span",null,t),s.a.createElement("br",null),s.a.createElement("span",null,n))}),kw=Object(i.memo)(function(e){var t=e.inkBrushes,n=e.activeInkBrushId,r=e.activeMarkupToolType,o=e.inkBrushConfigurations,u=e.showTooltip,a=void 0===u||u,f=e.iconSize,l=e.inkToolbarToolsStyles,c=e.inkToolbarButtonStyles,h=e.setActiveMarkupInkBrushId,p=e.setActiveMarkupToolType,d=e.setInkBrush,v=e.onClickOnBrush,m=Object(i.useContext)(Ca),g=m.localizationStrings,y=m.inkConfigurations,b=Object(i.useCallback)(function(e,t){var n=y[t],r=Zb(e,n);return+ew(n)(r)},[y]),w=function(e,t){return n===e&&r===t};return s.a.createElement(s.a.Fragment,null,Object.entries(t).map(function(e){var t=e[0],n=e[1],r=ua(n.inkType),i=o.brushes.find(function(e){return e.inkBrushId===t});if(!i)throw new Error("inkBrushConfig not found for "+t);return s.a.createElement(Tw,{inkBrush:n,inkBrushId:t,locStrings:g,inkConfiguration:y[n.inkType],brushMarkupToolType:r,hasFocus:w(t,r),getDisplayThickness:b,getTooltipContent:a?Aw:void 0,getAriaLabel:Lw,setActiveMarkupInkBrushId:h,setActiveMarkupToolType:p,setInkBrush:d,key:t,inkToolbarToolsStyles:l,inkToolbarButtonStyles:c,iconSize:f,getIcon:i.getIcon,onClick:v})}))});function Lw(e,t,n,r){for(var i="",s=0,o=Yb(e);s<o.length;s++){var u=o[s],a=u.label;u.color===n&&a&&(i=a)}if(""===i)throw new Error("Unrecognized color");return sc(e.markup_inkToolbarBrushFormatString,t,i,e.markup_inkToolbarThickness,r.toString())}function Aw(e,t,n,r,i){var o=Lw(e,t,n,r),u=e.markup_inkToolbarTooltipChangeInkProperties;return i?s.a.createElement(Cw,{brushInkPropertiesLabel:o,changeInkPropertiesLabel:u}):o}var Ow,Mw=n(2473),_w=n(3771),Dw=n(2849),Pw=Object(i.memo)(function(e){var t=e.hideDialog,n=e.dialogStyles,r=e.onConfirm,o=e.onCancel,u=Object(i.useContext)(Ca).localizationStrings,a=ba(),f={type:Mw.e.close,title:u.markup_clearAllInkDialogTitle,closeButtonAriaLabel:u.markup_clearAllInkDialogCloseButtonAriaLabel,subText:u.markup_clearAllInkDialogSubText},l=Object(i.useMemo)(function(){var e={main:{backgroundColor:a.palette.neutralLighterAlt}};return Object(wa.b)(e,null==n?void 0:n.dialog)},[null==n?void 0:n.dialog,a]);return s.a.createElement(_w.e,{hidden:t,onDismiss:o,dialogContentProps:f,modalProps:{styles:l}},s.a.createElement(Dw.e,{styles:null==n?void 0:n.dialogFooter},s.a.createElement(_d.e,{onClick:r,text:u.markup_clearAllInkDialogConfirmButtonText,ariaLabel:u.markup_clearAllInkDialogConfirmButtonAriaLabel,styles:null==n?void 0:n.confirmButton}),s.a.createElement(cd.e,{onClick:o,text:u.markup_clearAllInkDialogCancelButtonText,ariaLabel:u.markup_clearAllInkDialogCancelButtonAriaLabel,styles:null==n?void 0:n.cancelButton})))}),Hw=n(4421),Bw=function(){return(Bw=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)},jw=Object(i.memo)(function(e){var t=e.inkToolbarTools,n=e.inkToolbarButton,r=e.dialog,o=e.clearAllInkIcon,u=e.enableClearAllInk,a=e.showTooltip,f=e.clearAllInkContent,l=e.setAriaAnnouncement,c=e.getIcon,h=Object(i.useContext)(Ca).localizationStrings,p=Object(Hw.e)(!0),d=p[0],v=p[1].toggle;return s.a.createElement(s.a.Fragment,null,s.a.createElement(mw,{inkToolbarToolsStyles:t,inkToolbarButtonStyles:n,iconComponent:c(Bw({enabled:u},o)),onClick:v,tooltipContent:a?h.markup_inkToolbarClearAllInkTooltip:void 0,ariaLabel:h.markup_inkToolbarClearAllInkAriaLabel,hasFocus:!1,disabled:!u}),u&&s.a.createElement(Pw,{onConfirm:function(){f();l(h.markup_clearedAllInkStrokesAriaLive);v()},onCancel:v,hideDialog:d,dialogStyles:r}))}),Fw=n(1533),Iw=n(1896);n(2548),n(2546),n(4088),n(2472);(function(e){e[e.Unshaded=0]="Unshaded";e[e.Shade1=1]="Shade1";e[e.Shade2=2]="Shade2";e[e.Shade3=3]="Shade3";e[e.Shade4=4]="Shade4";e[e.Shade5=5]="Shade5";e[e.Shade6=6]="Shade6";e[e.Shade7=7]="Shade7";e[e.Shade8=8]="Shade8"})(Ow||(Ow={}));function qw(e,t,n){var r=t||{width:0,height:0},s=Object(i.useState)(r),o=s[0],u=s[1],a=Object(i.useCallback)(function(e){var t=e[0].contentRect,n=t.width,r=t.height;u({width:n,height:r})},[u]);Object(i.useLayoutEffect)(function(){if(e){var t=e.offsetWidth,n=e.offsetHeight;u({width:t,height:n})}},[e]);Rm(e,a,n);return o}function Rw(e,t,n,r,i){return e+","+(i+n/2)+" "+e+","+(i-n/2)+" "+t+","+(i-r/2)+" "+t+","+(i+r/2)}var Uw={width:336,height:30},zw=Object(i.memo)(function(e){var t=e.previewSize,n=e.thickness,r=e.flipHorizontally,i=void 0!==r&&r,o=n*(i?2:.6),u=n*(i?.6:2),a=t.width,f=Math.floor(t.height/2);return s.a.createElement("polygon",{points:Rw(0,a,o,u,f),strokeWidth:"1"})}),Ww=Object(i.memo)(function(e){var t=e.previewSize,n=e.thickness,r=e.flipHorizontally,i=void 0!==r&&r,o=e.opacity,u=void 0===o?1:o,a=e.yScale,f=void 0===a?1:a,l=e.hidePathStroke,c=n*(i?2.25:.25),h=n*(i?.25:2.25),p=void 0===l||l?"transparent":void 0,d=c*f,v=h*f,m=c/2,g=t.width-h/2,y=Math.floor(t.height/2);return s.a.createElement(s.a.Fragment,null,s.a.createElement("path",{key:"trapezoidLeft "+u+","+f,d:"M "+(m+1)+","+(y+d/2)+" a1,1 0 0,1 0, "+-d,stroke:p,strokeWidth:"1",opacity:u}),s.a.createElement("polygon",{key:"trapezoid "+u+","+f,points:Rw(m,g,d,v,y),strokeWidth:"1",opacity:u}),s.a.createElement("path",{key:"trapezoidRight "+u+","+f,d:"M "+(g-1)+","+(y+v/2)+" a1,1 0 0,0 0, "+-v,stroke:p,strokeWidth:"1",opacity:u}))});Object(_l.n)([{rawString:".strokePreviewContainer_8a3f6c72{display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-wrap:nowrap;flex-wrap:nowrap;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}"}]);var Xw="strokePreviewContainer_8a3f6c72",Vw=function(){return(Vw=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)},$w=function(e,t){var n=Object(uc.e)(e.palette.white),r=Object(uc.e)(t);return!(!n||!r)&&(function(e,t){function n(e){return e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4)}var r=.2126*n(e.r/Iw.t)+.7152*n(e.g/Iw.t)+.0722*n(e.b/Iw.t);r+=.05;var i=.2126*n(t.r/Iw.t)+.7152*n(t.g/Iw.t)+.0722*n(t.b/Iw.t);return r/(i+=.05)>1?r/i:i/r})(n,r)<1.2},Jw=Object(i.memo)(function(e){var t,n=e.thickness,r=e.inkBrushHtmlColor,o=e.inkBrushInkType,u=e.className,a=void 0===u?void 0:u,f=e.flipHorizontally,l=void 0!==f&&f,c=ba(),h=Object(i.useState)(null),p=h[0],d=h[1],v=qw(p).width,m=Object(i.useMemo)(function(){return Vw(Vw({},Uw),{width:v})},[v]),g=Object(i.useMemo)(function(){return $w(c,r)},[c,r]),y=Object(i.useMemo)(function(){var e={previewSize:m,thickness:n,flipHorizontally:l};switch(o){case _s.Highlighter:return s.a.createElement(zw,Vw({},e));case _s.Pen:return s.a.createElement(Ww,Vw({},e,{hidePathStroke:!g}));default:throw new oa(o)}},[m,n,l,o,g]),b=Object(i.useMemo)(function(){var e;return g?null===(e=null==c?void 0:c.palette)||void 0===e?void 0:e.neutralSecondary:void 0},[g,null===(t=null==c?void 0:c.palette)||void 0===t?void 0:t.neutralSecondary]);return s.a.createElement("div",{ref:d,className:Xw},s.a.createElement("svg",{className:a,height:m.height,width:m.width,fill:r,style:{stroke:b}},y))}),Kw=n(4275),Qw=n(4868);Object(_l.n)([{rawString:".inkStylePicker_089b0c64{display:inline-block;padding:8px 0 4px;border-radius:8px;width:336px}.inkStylePickerChild_089b0c64{margin-bottom:4px}.inkSwatchColorPickerContainer_089b0c64{clear:both;display:block;text-align:center}"}]);var Gw="inkStylePicker_089b0c64",Yw="inkStylePickerChild_089b0c64",Zw="inkSwatchColorPickerContainer_089b0c64",eE=function(){return(eE=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)},tE=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};function nE(e,t,n,r){void 0===r&&(r=!1);var i=eE({backgroundColor:e.palette.neutralQuaternary,border:"1px solid "+e.palette.neutralTertiary,borderRadius:"50%"},Object(wa.b)(null==n?void 0:n.colorCellFocused)),s=null!=n?n:{},o=s.colorCellSize,u=s.colorCellSvgRadius,a=tE(s,["colorCellSize","colorCellSvgRadius"]),f={colorCell:{padding:"0px",borderRadius:"50%",height:"auto",width:"auto"},colorCellSVG:!r&&eE({border:"1px solid transparent","&:hover":{backgroundColor:e.palette.neutralQuaternary,border:"1px solid "+e.palette.neutralTertiary,borderRadius:"50%"},"&:active":{backgroundColor:e.palette.neutralTertiaryAlt,border:"1px solid "+e.palette.neutralTertiary,borderRadius:"50%"}},t&&i),colorCellSVGCircle:{strokeOpacity:"0.2",stroke:e.palette.black},colorCellSize:30,colorCellSvgRadius:12};return eE(eE({},Object(wa.b)(f,a)),{colorCellSize:null!=o?o:30,colorCellSvgRadius:null!=u?u:12})}var rE={padding:"0 16px"},iE=function(){return(iE=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)},sE=Object(i.memo)(function(e){var t=e.colorOptions,n=e.selectedHTMLColor,r=e.colorPickerGridCellButtonIdPrefix,i=e.styles,o=e.doNotContainWithinFocusZone,u=e.disabled,a=void 0!==u&&u,f=e.setSelectedHtmlColor,l=ba(),c=function(e){if(!e)throw Error("Color of cell must not be falsy.");return e},h=function(e){var t=c(e.color),r=nE(l,n===t,null==i?void 0:i.colorPickerGridCellStyles,a),o=r.colorCellSVG,u=r.colorCellSVGCircle,f=r.colorCellSize,h=r.colorCellSvgRadius;return s.a.createElement("svg",{className:Object(wa.F)(o),width:f,height:f,viewBox:"0 0 "+f+" "+f,fill:a?"inherit":e.color},s.a.createElement("circle",{className:Object(wa.F)(u),cx:"50%",cy:"50%",r:h}))};return s.a.createElement("div",{className:Zw,style:null==i?void 0:i.container},s.a.createElement(Qw.e,{id:"inkColorPicker",columnCount:Math.min(t.length,8),colorCells:t,styles:iE({tableCell:{padding:"0px .1em",button:{margin:"0px"}}},null==i?void 0:i.colorPicker),onRenderColorCell:function(e){var t;if(!e)throw Error("ColorPicker did not receive color options to display.");var o=c(e.color),u=nE(l,n===o,null==i?void 0:i.colorPickerGridCellStyles,a).colorCell;return s.a.createElement(Kw.e,{item:e,id:r+"-"+e.id,label:e.label,index:e.index,key:e.id,role:"gridcell",className:Object(wa.F)(u,a&&(null===(t=null==i?void 0:i.colorPickerGridCellStyles)||void 0===t?void 0:t.colorCellDisabled)),onRenderItem:h,onClick:function(){return f(o)},selected:!a&&n===o,disabled:a})},isControlled:!0,doNotContainWithinFocusZone:o}))}),oE=function(){return(oE=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)},uE=s.a.memo(function(e){var t,n=e.inkConfiguration,r=e.inkBrushThicknessInCssPixels,u=e.layout,a=e.headerName,f=e.ariaLabel,l=e.onThicknessSliderChanged,c=e.sliderRef,h=e.disabled,p=void 0!==h&&h,d=e.styles,v=n.cssThicknesses.length-1,m=Object(i.useMemo)(function(){return Zb(r,n)},[r,n]),g=Object(i.useContext)(_e).localizeNumber,y=ew(n),b=ba(),w={value:m,maxValue:v,minValue:0,name:a,hideValue:p,valueFormatter:y},E=!!(null==d?void 0:d.sliderHeader),S=Object(i.useMemo)(function(){var e,t=Ol(b),n=oE(oE({},t),{valueLabel:{width:"20px",margin:"0",textAlign:"end"},slideBox:Object(wa.F)(t.slideBox,{margin:"0 1em 0 0",padding:"0"}),line:p&&{display:"none"}});return Object(wa.b)(n,null===(e=null==d?void 0:d.getSliderStyles)||void 0===e?void 0:e.call(d,b,m))},[b,p,d,m]),x=oE(oE({},null==d?void 0:d.sliderHeader),{container:oE(oE({},p&&{opacity:"0.25"}),null===(t=null==d?void 0:d.sliderHeader)||void 0===t?void 0:t.container)});return s.a.createElement("div",{className:Object(o.e)(Yw)},E&&s.a.createElement(zl,{headerProps:w,layout:u,styles:x}),s.a.createElement(Al.e,{min:0,max:v,value:m,showValue:!E,styles:S,ariaLabel:f,ref:c,ariaValueText:function(e){return g(+y(e))},onChange:l,valueFormat:y,snapToStep:!0,disabled:p,originFromZero:!0}))}),aE=function(){return(aE=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)},fE=Object(i.memo)(function(e){var t=e.styles,n=e.colorOptions,r=e.inkBrush,o=r.thicknessInCssPixels,u=r.htmlColor,a=r.inkType,f=e.inkBrushIdForInkStyleChange,l=e.inkConfiguration,c=e.colorPickerGridCellButtonIdPrefix,h=e.doNotContainColorPickerWithinFocusZone,p=e.sliderRef,d=e.disabled,v=void 0!==d&&d,m=e.setInkBrush,g=ba(),y=Object(ql.e)(g),b=Object(i.useContext)(Ca).localizationStrings,w=Object(i.useCallback)(function(e,t,n){var r,i,s,o,u,a={inkBrush:{thicknessInCssPixels:(r=e,i=l,s=i.cssThicknesses,o=s[r],u=s[Math.round(s.length/2)],-1===o?u:o),htmlColor:t,inkType:n},id:f};m(a)},[l,f,m]),E=Object(i.useCallback)(function(e){w(e,u,a)},[u,a,w]),S=Object(i.useCallback)(function(e){w(Zb(o,l),e,a)},[l,a,o,w]),x=Object(i.useMemo)(function(){return Object(wa.F)(rE,null==t?void 0:t.contentWrapper)},[null==t?void 0:t.contentWrapper]);return s.a.createElement("div",{className:Gw,style:aE({backgroundColor:g.palette.neutralLighter},null==t?void 0:t.containerStyles)},s.a.createElement("div",{className:x},s.a.createElement(Jw,{thickness:Zb(o,l)+1,inkBrushHtmlColor:v?g.palette.white:u,inkBrushInkType:a,flipHorizontally:y,className:Object(wa.F)(Yw,v&&{opacity:"0.4"})}),s.a.createElement(uE,{inkConfiguration:l,inkBrushThicknessInCssPixels:o,layout:"Labeled",headerName:b.markup_inkThicknessSliderHeaderLabel,ariaLabel:lE(a,b),onThicknessSliderChanged:E,sliderRef:p,styles:null==t?void 0:t.sliderStyles,disabled:v}),s.a.createElement(sE,{colorPickerGridCellButtonIdPrefix:c,styles:null==t?void 0:t.inkColorPickerStyles,doNotContainWithinFocusZone:h,colorOptions:n,selectedHTMLColor:u,setSelectedHtmlColor:S,disabled:v})))});function lE(e,t){switch(e){case _s.Highlighter:return t.markup_inkHighlighterThicknessSliderAriaLabel;case _s.Pen:return t.markup_inkPenThicknessSliderAriaLabel;default:throw new oa(e)}}var cE=Object(i.memo)(function(e){var t=e.onCloseMenu,n=e.directionalHint,r=e.elementIdForContextMenuPosition,o=e.openTriggerContainerId,u=e.hostId,a=e.inkBrush,f=e.inkBrushIdForInkStyleChange,l=e.localizationStrings,c=e.inkConfiguration,h=e.isStylePickerDisabled,p=void 0!==h&&h,d=e.styles,v=e.setInkBrush,m=Object(la.e)(f+"ContextualMenu"),g=Object(la.e)("buttonGridCell"),y=Object(i.useRef)(null),b={style:{backgroundColor:"transparent"},direction:uw.e.bidirectional,componentRef:y,isCircularNavigation:!0},w=Object(i.useRef)(null),E=s.a.createElement(fE,{colorPickerGridCellButtonIdPrefix:g,doNotContainColorPickerWithinFocusZone:!0,sliderRef:w,styles:d,colorOptions:Yb(l),inkConfiguration:c,inkBrush:a,inkBrushIdForInkStyleChange:f,setInkBrush:v,key:f,disabled:p}),S=[{key:"MenuComponent-"+r,onRender:function(){return E}}];Object(i.useEffect)(function(){var e=function(e){var n,i=document.getElementById(r),s=document.getElementById(m);o&&(n=document.getElementById(o));var u=null==i?void 0:i.contains(e.target),a=!(null==s?void 0:s.contains(e.target)),f=null==n?void 0:n.contains(e.target);u||!a||f||t()},n=function(e,t){e.preventDefault();var n=document.getElementById(t);n&&y.current&&y.current.focusElement(n)},i=function(e){var i;if("Escape"===e.key){null===(i=document.getElementById(r))||void 0===i||i.focus();t()}if("Tab"===e.key&&document.activeElement&&document.activeElement.id.startsWith(g))if(e.shiftKey){var s=w.current&&w.current._id;s&&n(e,s)}else{var o=w.current&&w.current._id;o&&n(e,o)}},s=function(){t()};window.addEventListener("pointerdown",e,!0);window.addEventListener("keydown",i,!0);window.addEventListener("resize",s,!0);return function(){window.removeEventListener("pointerdown",e,!0);window.removeEventListener("keydown",i,!0);window.removeEventListener("resize",s,!0)}},[m,r,t,g,o]);return s.a.createElement(Fw.e,{directionalHint:n,calloutProps:{styles:null==d?void 0:d.callout,layerProps:{hostId:u}},focusZoneProps:b,gapSpace:8,id:m,items:S,target:"#"+r,isBeakVisible:!1,useTargetAsMinWidth:!0,shouldFocusOnMount:!0,alignTargetEdge:!0})}),hE=function(){return(hE=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)},pE=Object(i.memo)(function(e){var t,n,r,o,u,a=e.inkBrushes,f=e.activeInkBrushId,l=e.inkToolBarStyles,c=e.activeMarkupToolType,h=e.enableClearAllInk,p=e.showStylePickerInFullWidth,d=void 0===p||p,v=e.showInkStylePicker,m=e.stylePickerHostId,g=e.clearAllInkContent,y=e.setAriaAnnouncement,b=e.setActiveMarkupInkBrushId,w=e.setActiveMarkupToolType,E=e.setInkBrush,S=e.setShowInkStylePicker,x=ba(),T=d?{containerStyles:{display:"flex",justifyContent:" center",width:"100%",backgroundColor:"transparent"},callout:{root:{width:"100%",borderBottom:"1px solid "+x.palette.neutralLight},calloutMain:{borderRadius:"12px 12px 0 0"}}}:{callout:{root:{backgroundColor:"transparent"},calloutMain:{backgroundColor:"transparent"}}},N=Object(i.useContext)(Ca),C=N.localizationStrings,k=N.inkBrushConfigurations,L=N.inkConfigurations,A=Object(i.useState)(),O=A[0],M=A[1],_=a[f],D=Object(la.e)("inkStylePickerContainer"),P=Object(i.useState)(D),H=P[0],B=P[1],j=Object(i.useCallback)(function(e,t){M(e);t&&S(!v);d||B(e)},[S,v,d]),F=Object(i.useCallback)(function(){S(!1)},[S]);return s.a.createElement("div",{className:fw,style:hE({backgroundColor:x.palette.neutralLight},null==l?void 0:l.container),"aria-label":C.markup_inkToolbarAriaLandmark,role:"region"},s.a.createElement(ow.e,{direction:uw.e.domOrder,isCircularNavigation:!0,role:"toolbar",className:lw},v&&s.a.createElement(ad.e,{id:D},s.a.createElement(cE,{inkBrush:a[f],elementIdForContextMenuPosition:H,inkBrushIdForInkStyleChange:f,directionalHint:aw.e.topCenter,localizationStrings:C,inkConfiguration:L[_.inkType],onCloseMenu:F,setInkBrush:E,styles:hE(hE({},T),null==l?void 0:l.inkStylePicker),openTriggerContainerId:O,hostId:m,isStylePickerDisabled:!(u=c,Object.keys(_s).includes(u))})),s.a.createElement(ad.e,{horizontal:!0},s.a.createElement(kw,{inkBrushes:a,activeMarkupToolType:c,activeInkBrushId:f,setActiveMarkupInkBrushId:b,setActiveMarkupToolType:w,setInkBrush:E,inkToolbarToolsStyles:null==l?void 0:l.inkToolbarTools,inkToolbarButtonStyles:null==l?void 0:l.inkToolbarButton,iconSize:null==l?void 0:l.inkToolbarIconSize,inkBrushConfigurations:k,onClickOnBrush:j,showTooltip:!d}),s.a.createElement(yw,{inkToolbarToolsStyles:null==l?void 0:l.inkToolbarTools,activeMarkupToolType:c,setActiveMarkupToolType:w,getIcon:k.eraser.getIcon,inkToolbarButtonStyles:null==l?void 0:l.inkToolbarButton,iconSize:null==l?void 0:l.inkToolbarIconSize,showTooltip:!d}),s.a.createElement(jw,{inkToolbarTools:null===(t=null==l?void 0:l.clearAllInk)||void 0===t?void 0:t.inkToolbarTools,inkToolbarButton:null===(n=null==l?void 0:l.clearAllInk)||void 0===n?void 0:n.inkToolbarButton,enableClearAllInk:h,clearAllInkContent:g,setAriaAnnouncement:y,dialog:null===(r=null==l?void 0:l.clearAllInk)||void 0===r?void 0:r.dialog,getIcon:k.clearInk.getIcon,clearAllInkIcon:null===(o=null==l?void 0:l.clearAllInk)||void 0===o?void 0:o.clearAllInkIcon,showTooltip:!d}))))}),dE=function(){return(dE=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)},vE=Object(i.memo)(function(e){var t=e.inkToolBarStyles;return s.a.createElement(cc,{style:dE({borderRadius:"8px",padding:"0"},null==t?void 0:t.canvasContainer),visible:!0},s.a.createElement(pE,dE({},e)))}),mE=Vt([Mf],function(e){return e.some(function(e){return e.contentType===Ou.InkContent})}),gE={setActiveMarkupInkBrushId:uo,setActiveMarkupToolType:$u,setInkBrush:Vu,setShowInkStylePicker:ao,clearAllInkContent:Gu,setAriaAnnouncement:_u},yE=Object(q.connect)(function(e){return{activeMarkupToolType:e.markup.activeMarkupToolType,enableClearAllInk:mE({markup:e.markup}),showInkStylePicker:e.uiState.showInkStylePicker}},gE)(vE),bE=Object(i.memo)(function(e){var t=e.inkBrushes,n=e.activeInkBrushId,r=e.showStylePickerInFullWidth,i=e.styles,o=Kb(t,n);return s.a.createElement(s.a.Fragment,null,s.a.createElement(yE,{inkToolBarStyles:null==i?void 0:i.toolbar,inkBrushes:t,activeInkBrushId:n,showStylePickerInFullWidth:r}),s.a.createElement(sw,{inkBrush:o.inkBrush}))}),wE=Object(q.connect)(function(e){return{inkBrushes:e.markup.inkBrushes,activeInkBrushId:e.uiState.activeInkBrushId}})(bE);function EE(e,t,n){void 0===n&&(n={left:0,top:0,width:t.x,height:t.y});if(e){var r=e({x:n.width,y:n.height},(function(e,t){return Pr({left:-t.left,top:-t.top,width:e.x,height:e.y})})(t,n));r&&(r.id=Bu().toString());return null!=r?r:void 0}}function SE(e,t,n){var r=Object(i.useRef)(e),s=Object(i.useContext)(Ca).localizationStrings,o=Object(i.useCallback)(function(e){var i,o,u,a=(i=s,o=e.length,u=r.current.length,sc(i.markup_removedInkStrokesAriaLive,o.toString(),u.toString()));t(e);n(a)},[s,r,t,n]);r.current=e;return o}var xE=function(){return(xE=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)},TE=Object(i.memo)(function(e){var t,n=e.originalImagePixelSize,r=e.markupContentItems,o=e.setAriaAnnouncement,u=e.removeMarkupContent,a=e.shouldSetMarkupOverlayWithFinalContent,f=e.setShouldUpdateImageOverlay,l=Object(i.useContext)(Ca),c=l.Canvas,h=l.canvasMethods,p=r.length>0;t=Object(i.useContext)(Za).setImageOverlay,Object(i.useEffect)(function(){t(null)},[t]);(function(e,t){Object(i.useEffect)(function(){e(t)},[t,e])})(f,p);(function(e,t,n,r){var s=Object(i.useContext)(Za).setImageOverlay,o=Object(i.useContext)(Ca).setCanvasMethods,u=Object(i.useRef)(function(){});Object(i.useEffect)(function(){u.current=function(){if(n){if(!e)throw new Error("canvasMethods are undefined. Could not update image overlay.");s({width:t.x,height:t.y,canvasMethods:e,renderCanvas:EE,id:Bu().toString()})}else s(null)}},[e,n,t,o,s]);Object(i.useEffect)(function(){if(r){u.current();o(Na)}},[o,r])})(h,n,p,a);var d=SE(r,u,o);return s.a.createElement(c,xE({},e,{removeMarkupContent:d}))});function NE(e,t){var n=t<12?3:2,r=Math.max(t/2+n,4);return"url(data:image/svg+xml;base64,"+window.btoa((function(e,t,n){var r=2*t+2*n;return"\n    <svg\n      height='"+r+"'\n      width='"+r+"'\n      xmlns='http://www.w3.org/2000/svg'\n      viewBox='0 0 "+r+" "+r+"'\n    >\n      <circle\n        cx='50%'\n        cy='50%'\n        r='"+t+"'\n        stroke='white'\n        stroke-width='"+Math.max(1.5,Math.ceil(.2*t))+"'\n        fill='"+e+"'\n        shape-rendering='geometricPrecision'\n      />\n    </svg>"})(e,r,10))+") "+(r+10)+" "+(r+10)}function CE(e,t){var n=Math.max(10,t),r=n/2,i=n/5;return"url(data:image/svg+xml;base64,"+window.btoa((function(e,t){var n=t/2;return"<svg\n      height='"+t+"'\n      width='"+n+"'\n      xmlns='http://www.w3.org/2000/svg'\n      viewBox='0 0 "+n+" "+t+"'\n    >\n      <rect\n        height='"+t+"'\n        width='"+n+"'\n        cx='50%'\n        cy='50%'\n        stroke='white'\n        stroke-width='"+Math.min(.1*t,1.5)+"'\n        fill='"+e+"'\n      />\n    </svg>"})(e,n))+") "+(r-i)+" "+r}var kE,LE=window.btoa("<svg width='48' height='47' viewBox='0 0 48 47' fill='none' xmlns='http://www.w3.org/2000/svg'>\n<g filter='url(#filter0_dd)'>\n  <circle cx='24' cy='20' r='16' fill='white' fill-opacity='0.8'/>\n</g>\n<defs>\n  <filter id='filter0_dd' x='0.8' y='2.38419e-07' width='46.4' height='46.4' filterUnits='userSpaceOnUse' color-interpolation-filters='sRGB'>\n    <feFlood flood-opacity='0' result='BackgroundImageFix'/>\n    <feColorMatrix in='SourceAlpha' type='matrix' values='0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0'/>\n    <feOffset dy='3.2'/>\n    <feGaussianBlur stdDeviation='3.6'/>\n    <feColorMatrix type='matrix' values='0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.13 0'/>\n    <feBlend mode='normal' in2='BackgroundImageFix' result='effect1_dropShadow'/>\n    <feColorMatrix in='SourceAlpha' type='matrix' values='0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0'/>\n    <feOffset dy='0.6'/>\n    <feGaussianBlur stdDeviation='0.9'/>\n    <feColorMatrix type='matrix' values='0 \n0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.1 0'/>\n    <feBlend mode='normal' in2='effect1_dropShadow' result='effect2_dropShadow'/>\n    <feBlend mode='normal' in='SourceGraphic' in2='effect2_dropShadow' result='shape'/>\n  </filter>\n</defs>\n</svg>"),AE=Vt([function(e,t){return e.activeMarkupToolType},function(e,t){return e.inkBrushes},function(e,t){return t}],function(e,t,n){var r=Kb(t,n).inkBrush,i=r.thicknessInCssPixels,s=r.htmlColor;switch(e){case"Pen":return NE(s,i)+", url(./cursors/penCursorFallback.cur), crosshair";case"Highlighter":return CE(s,i)+", url(./cursors/penCursorFallback.cur), crosshair";case"Eraser":return"url(data:image/svg+xml;base64,"+LE+") 24 20, url(./cursors/eraserCursorFallback.cur), default";default:throw new oa(e)}}),OE={removeMarkupContent:Qu,setActiveMarkupToolType:$u,setAriaAnnouncement:_u,setShouldUpdateImageOverlay:ro},ME=Object(q.connect)(function(e){var t=e.transformTools,n=t.view,r=n.viewportPixelSize,i=n.viewportCssSize,s=t.image.originalPixelSize,o=t.device.pixelRatio;return{cropViewTransform:Lh(e.transformTools),imageViewTransform:Ep(e.transformTools),originalImagePixelSize:s,cssToPhysicalPixelRatio:o,width:r.x,height:r.y,cssWidth:i.width,cssHeight:i.height,markupContentItems:e.markup.markupContentItems,shouldSetMarkupOverlayWithFinalContent:""!==e.uiState.nextEditorActivity&&"Markup"===e.uiState.activeEditorActivity,activeMarkupToolType:e.markup.activeMarkupToolType,cursor:AE(e.markup,e.uiState.activeInkBrushId)}},OE)(TE),_E=Object(i.memo)(function(e){var t=e.styles,n=e.showStylePickerInFullWidth,r=void 0!==n&&n;return Object(i.useContext)(Py).enableMarkup?s.a.createElement(s.a.Fragment,null,s.a.createElement(ME,null),s.a.createElement(wE,{styles:t,showStylePickerInFullWidth:r})):null}),DE={defName:"ENABLE_SECONDARY_BLEND",levelUniformName:Qc,mapNormalizedToShaderValue:function(e){return e}},PE=function(){return(PE=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)},HE=Object(q.connect)(function(e){var t=e.autoEnhance,n=t.autoEnhanceLevel,r=t.autoEnhanceStatus;return{alpha:iy(PE(PE({},e.transformTools),e.uiState))||"on"!==r?0:n}})(function(e){var t=e.alpha,n=void 0===t?0:t;Object(i.useContext)(hh).textures.blend||(n=0);Eg(DE,n);return null}),BE={defName:"ENABLE_SECONDARY_OVERLAY",levelUniformName:Yc,mapNormalizedToShaderValue:function(e){return e}},jE=function(e){var t=e.alpha,n=void 0===t?1:t;Object(i.useContext)(hh).textures.overlay||(n=0);Eg(BE,n);return null},FE=Object(i.memo)(function(e){var t=e.disable,n=Object(i.useContext)(Za).image,r=!t&&Ja(n)&&n.overlay?1:0;return s.a.createElement(jE,{alpha:r})}),IE=function(){return(IE=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)},qE=Object(q.connect)(function(e){return{disable:iy(IE(IE({},e.transformTools),e.uiState))}})(FE),RE={toolbar:{canvasContainer:{bottom:"0",left:"50%"}}},UE=function(){return(UE=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)},zE=((kE={}).Crop={top:42,left:42,right:42,bottom:162},kE.Markup=UE(UE({},dr(0)),{bottom:56}),kE),WE=Object(i.memo)(Object(i.forwardRef)(function(e,t){var n=e.componentSize,r=e.onSave,o=e.onClose,u=e.pivotItems,a=e.onEditsChanged,f=e.onUiStateChanged,l=e.cssToPhysicalPixelRatio,c=e.layout,h=ba(),p=Jd(t),d=p.editOperationsRef,v=p.editUiStateRef,m=Object(i.useContext)(Za),g=m.image,y=m.setOffscreenRenderer,b=Object(i.useContext)(Py).enableAutoEnhance;return s.a.createElement("div",{className:cg},s.a.createElement("div",{role:"banner"},u.length>1&&s.a.createElement(zd,{componentSize:n,onSave:r,onCancel:o,controlPivot:s.a.createElement(_c,{pivotItems:u,styles:Wd(h)})}),u.length<=1&&s.a.createElement(zd,{componentSize:n,onSave:r,onCancel:o})),s.a.createElement("div",{className:hg},s.a.createElement("div",{className:pg,role:"main"},s.a.createElement(Hh,null),s.a.createElement(Kp,{canvasSize:n,cssToPhysicalPixelRatio:l},s.a.createElement(wp,null,s.a.createElement(Gp,{match:"Crop"},s.a.createElement(Fh,{handleSizeCss:28,handleHitAreaSizeCss:50}),s.a.createElement(Oh,null)),s.a.createElement(Cp,{image:g,color:Th,zIndex:1},s.a.createElement(Ky,null,s.a.createElement(Ra,{ref:y}),s.a.createElement(Jy,null),s.a.createElement(HE,null),s.a.createElement(qE,null))),s.a.createElement(Gp,{match:"Markup"},s.a.createElement(_E,{styles:RE})))),s.a.createElement(Gp,{match:"Adjustment"},s.a.createElement(lg,null),s.a.createElement(ed,null)),s.a.createElement(Gp,{match:"Filter"},s.a.createElement(lg,null),s.a.createElement(ed,null)),s.a.createElement(Gp,{match:"Crop"},s.a.createElement(yp,null),s.a.createElement(ig,null),s.a.createElement(yc,null),s.a.createElement(Rp,null))),s.a.createElement(Gp,{match:"Adjustment"},s.a.createElement(Fb,{theme:h},s.a.createElement(rc,null))),s.a.createElement(Gp,{match:"Filter"},s.a.createElement(Fb,{theme:h},s.a.createElement(Pb,{styles:qb(c)},b&&s.a.createElement(Jb,null))))),s.a.createElement(_p,{ref:d,onEditsChanged:a}),s.a.createElement(jp,{ref:v,onUiStateChanged:f}),s.a.createElement(mg,{cssPixelMarginByActivity:zE}))}));Object(_l.n)([{rawString:".aspectRatioContainer_29990fec{margin-bottom:8px}.rotateFlipContainer_29990fec{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1}"}]);var XE="aspectRatioContainer_29990fec",VE="rotateFlipContainer_29990fec";Object(_l.n)([{rawString:".aspectRatioContainer_44f6ccb5{margin:0 -16px;display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;padding:0 16px}"}]);var $E="aspectRatioContainer_44f6ccb5",JE=Object(i.memo)(function(e){var t=e.panelStyle,n=e.aspectRatioConstraint,r=e.setAspectRatioConstraint,o=e.setAriaAnnouncement,u=Object(i.useContext)(_e),a=u.localizeNumber,f=u.strings,l=Vm(r,o,Rv(f,a)),c=Object(i.useCallback)(function(e){l(e)},[l]),h=Object(i.useCallback)(function(e){return e===Ae.None?t.freeformButton:t.tile},[t]);return s.a.createElement("div",{className:$E},$m(Wv(),h,Rv(f,a),zv,c,Xv(n),void 0,void 0,void 0,void 0,Vv))});Object(_l.n)([{rawString:".RotationBarContainer_aefad19a{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;margin-top:5px}.RotateFlipButtons_aefad19a{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-flow:row nowrap;flex-flow:row nowrap;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;margin-top:12px}"}]);var KE="RotationBarContainer_aefad19a",QE="RotateFlipButtons_aefad19a",GE=s.a.memo(function(e){var t=e.panelStyle,n=e.rotationAngle,r=e.rotateCropAndImageBy90,o=e.handleMirrorXClick,u=e.handleMirrorYClick,a=e.setAriaAnnouncement,f=Object(i.useContext)(_e).strings,l=ba(),c=Object(i.useState)(null),h=c[0],p=c[1],d=qw(h,{width:500,height:35}),v=Jv(n,r,o,u,a),m=v.handleRotateCropRectAndImageBy90ClockwiseWithTelemetry,g=v.handleRotateCropRectAndImageBy90CounterClockwiseWithTelemetry,y=v.handleMirrorXWithTelemetry,b=v.handleMirrorYWithTelemetry;return s.a.createElement(s.a.Fragment,null,s.a.createElement(Cm,{rotationAngle:n,styles:{container:{height:"16px"}}}),s.a.createElement("div",{className:KE,ref:p},s.a.createElement(wm,{styles:Sm(l),layout:Em,boundingSize:d})),s.a.createElement("div",{className:QE},s.a.createElement(ld.e,{iconProps:{iconName:"Rotate90CounterClockwise",styles:t.icon},title:f.rotate_left90,ariaLabel:f.rotate_left90AriaLabel,onClick:g,styles:t.iconButton}),s.a.createElement(ld.e,{iconProps:{iconName:"Rotate90Clockwise",styles:t.icon},title:f.rotate_right90,ariaLabel:f.rotate_right90AriaLabel,onClick:m,styles:t.iconButton}),s.a.createElement(ld.e,{iconProps:{iconName:"FlipHorizontal-Havana",styles:t.icon},title:f.flip_horizontal,ariaLabel:f.flip_horizontalAriaLabel,onClick:y,styles:t.iconButton}),s.a.createElement(ld.e,{iconProps:{iconName:"FlipVertical-Havana",styles:t.icon},title:f.flip_vertical,ariaLabel:f.flip_verticalAriaLabel,onClick:b,styles:t.iconButton})))}),YE=Object(i.createContext)({type:Hb.DuoDouble,hingeStartOffset:0,hingeGap:0,orientation:"Portrait",isOrderInverted:!1}),ZE=Object(i.memo)(function(e){var t=e.size,n=e.styles,r=e.header,o=e.footer,u=e.aspectRatioConstraint,a=e.setAspectRatioConstraint,f=e.rotationAngle,l=e.rotateCropAndImageBy90,c=e.handleMirrorXClick,h=e.handleMirrorYClick,p=e.setAriaAnnouncement,d=Object(i.useContext)(YE),v=ba(),m=Object(i.useMemo)(function(){return(function(e,t){return{icon:Cv,iconButton:Nv(t),tile:bv(e,t),tileButton:Ev(e,t),freeformButton:wv(e,t)}})(d,v)},[d,v]);return s.a.createElement(Yl,{size:t,styles:n,header:r,footer:o},s.a.createElement("div",{className:XE,style:{marginTop:("Landscape"===d.orientation?16:7)+"px"}},s.a.createElement(JE,{panelStyle:m,aspectRatioConstraint:u,setAspectRatioConstraint:a,setAriaAnnouncement:p})),s.a.createElement("div",{className:VE,style:{margin:"0px "+("Landscape"===d.orientation?0:106)+"px"}},s.a.createElement(GE,{panelStyle:m,rotationAngle:f,rotateCropAndImageBy90:l,handleMirrorXClick:c,handleMirrorYClick:h,setAriaAnnouncement:p})))}),eS={setAspectRatioConstraint:qo,rotateCropAndImageBy90:Ho,handleMirrorXClick:So,handleMirrorYClick:xo,setAriaAnnouncement:_u},tS=Object(q.connect)(function(e){return{aspectRatioConstraint:e.transformTools.cropInteraction.aspectRatioConstraint,rotationAngle:em(e.transformTools)}},eS)(ZE),nS=function(e){var t=e.duoLayoutData,n=e.children;return s.a.createElement(YE.Provider,{value:t},n)},rS=Object(i.memo)(function(e){var t=e.onBack,n=Object(i.useContext)(_e).strings,r=ba(),o=Object(ql.e)(r),u=bd(t),a=o?"Forward-Havana":"Back-Havana";return s.a.createElement(ld.e,{key:"Cancel",styles:cv(r),theme:ba(),iconProps:{iconName:a},ariaLabel:n.toolbar_cancelAriaLabel,title:n.toolbar_cancelTooltip,role:"button",onClick:u})}),iS=function(){return(iS=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)},sS=Object(i.memo)(function(e){var t=e.resetDisabled,n=e.resetEdits,r=e.setAriaAnnouncement,o=Object(i.useContext)(_e).strings,u=Td(n,r,o.toolbar_imageResetFinishedAriaLive),a=ba();return s.a.createElement(s.a.Fragment,null,s.a.createElement(cd.e,{key:"Reset",styles:fv(a),text:o.toolbar_imageReset,ariaLabel:o.toolbar_imageResetAriaLabel,title:o.toolbar_imageResetTooltip,onClick:u,disabled:t,role:"button",theme:a,allowDisabledFocus:!0}))}),oS={resetEdits:js,setAriaAnnouncement:_u},uS=Object(q.connect)(function(e){var t=iS(iS({},e.transformTools),{colorAdjustments:e.colorAdjustments,filters:e.filters,autoEnhance:e.autoEnhance,markup:e.markup});return{resetDisabled:Hf(t)}},oS)(sS),aS=Object(i.memo)(function(e){var t=e.onSave,n=e.styles,r=Object(i.useContext)(_e).strings,o=Dd(t).onSaveOriginal,u=ba(),a=!Object(i.useContext)(Bf).has(Pf.SaveAsOriginal),f=Object(i.useMemo)(function(){return Object(wa.b)((function(e){var t=Object(ql.e)(e);return{label:rv({},uv),root:rv(rv({},av(e)),{height:"28px",borderRadius:"160px",minWidth:"63px",marginRight:t?"0px":"4px",marginLeft:t?"4px":"8px",marginBottom:"14px",marginTop:"14px",padding:"6px 16px",border:"none"}),rootHovered:rv({},av(e)),rootPressed:{color:e.palette.white,border:"none",backgroundColor:e.palette.neutralLighter},rootDisabled:{color:e.palette.neutralQuaternary,backgroundColor:"transparent",border:"none"}}})(u),n)},[u,n]);return s.a.createElement(s.a.Fragment,null,s.a.createElement(cd.e,{text:r.toolbar_imageSave,title:r.toolbar_imageSaveTooltip,styles:f,disabled:a,onClick:o,role:"button",theme:u,allowDisabledFocus:!0}))}),fS=s.a.memo(function(e){var t=e.onSave,n=e.onBack,r=e.style,i=ba();return s.a.createElement(ad.e,{className:od,horizontal:!0,theme:i},s.a.createElement(ad.e.Item,{grow:!0,className:rd},s.a.createElement(rS,{onBack:n})),s.a.createElement(ad.e.Item,{grow:!0,className:ud},s.a.createElement(uS,null),s.a.createElement(aS,{onSave:t,styles:null==r?void 0:r.saveButton})))});fS.displayName="MobileEditorCommandBar";var lS=function(){return(lS=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)};function cS(e,t,n,r){var i=(function(e,t,n){return{height:t+"px",lineHeight:n+"px",color:e.palette.black,width:"100%",marginInlineEnd:0,fontWeight:"500",borderRadius:"20px",margin:"0px"}})(e,t,n);return{count:{},icon:{display:"none"},link:lS(lS({},i),{"&:hover":{backgroundColor:e.palette.neutralLighterAlt},"&:active":{backgroundColor:e.palette.neutralLighterAlt},"&:after":{height:"0px"}}),linkContent:{},linkIsSelected:lS(lS({},i),{backgroundColor:e.palette.neutralQuaternary,"&::before":{display:"none"},"&:hover":{backgroundColor:e.palette.neutralQuaternary},"&:active":{backgroundColor:e.palette.neutralQuaternary},"&:after":{height:"0px"}}),root:{display:"flex",justifyContent:"space-evenly",backgroundColor:r,borderRadius:"20px"},text:{marginInlineStart:"0"}}}Object(_l.n)([{rawString:".layout_duo_21dae3f4{width:100%;height:100%;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;display:-webkit-box;display:-ms-flexbox;display:flex}.content_container_21dae3f4{display:grid;width:100%;height:calc(100% - 44px);grid-template-columns:1fr auto auto;grid-template-rows:1fr}.canvas_container_21dae3f4{position:relative}"}]);var hS="layout_duo_21dae3f4",pS={type:Hb.Desktop},dS=Object(i.createContext)({layout:pS}),vS=function(){return(vS=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)},mS={width:96,height:108},gS={width:32,height:32};var yS,bS=function(){return(bS=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)},wS=Object(i.memo)(function(e){var t,n=e.size,r=e.styles,o=e.header,u=e.footer,a=Kb(e.inkBrushes,e.activeInkBrushId),f=Object(la.e)("markupActionPane"),l="Landscape"===(null===(t=Object(i.useContext)(dS).layout)||void 0===t?void 0:t.orientation),c=ba(),h=Object(i.useMemo)(function(){return(function(e,t){var n,r={"&:active":{backgroundColor:e.palette.neutralLight},"&:hover":{backgroundColor:e.palette.neutralLight}};return{container:{backgroundColor:"transparent"},inkToolbarIconSize:mS,clearAllInk:{inkToolbarTools:{toolbarIcon:vS({width:"54px",height:"54px"},r)},inkToolbarButton:{root:{height:"54px",width:"54px",minWidth:"54px"}},clearAllInkIcon:{styles:vS({},gS),disabledColor:e.palette.neutralQuaternary}},inkToolbarTools:{activeToolbarIcon:{backgroundColor:e.palette.neutralLighter},toolbarIcon:vS({height:"88px",width:"88px"},r),SVGIcon:(n={},n[".inkTool"]={top:"19px"},n)},inkToolbarButton:{root:{height:mS.height+"px",width:mS.width+"px",minWidth:mS.width+"px"}},inkStylePicker:{contentWrapper:{width:"calc(100% - 56px)",paddingLeft:"28px",paddingRight:"28px"},sliderStyles:{getSliderStyles:Sv,sliderHeader:{container:{fontSize:"16px",lineHeight:"24px",display:"grid"}}},inkColorPickerStyles:{container:{padding:0},colorPicker:{root:{width:"100%"},tableCell:{height:t?"82px":"72px",textAlign:"center",padding:"1px"}},colorPickerGridCellStyles:{colorCellSize:51,colorCellSvgRadius:20,colorCellFocused:{backgroundColor:"transparent",border:"1px solid "+e.palette.neutralSecondary,"&:active":{backgroundColor:"transparent",border:"1px solid "+e.palette.neutralSecondary,borderRadius:"50%"},"&:hover":{backgroundColor:"transparent",border:"1px solid "+e.palette.neutralSecondary,borderRadius:"50%"}},colorCellDisabled:{backgroundColor:"transparent"}}}}}})(c,l)},[l,c]);return s.a.createElement(Yl,{size:n,styles:r,header:o,footer:u,containerId:f},s.a.createElement(pE,bS({},e,{inkToolBarStyles:h,stylePickerHostId:f,showInkStylePicker:!0})),s.a.createElement(sw,{inkBrush:a.inkBrush}))}),ES={setActiveMarkupInkBrushId:uo,setActiveMarkupToolType:$u,setInkBrush:Vu,setShowInkStylePicker:ao,clearAllInkContent:Gu,setAriaAnnouncement:_u},SS=Object(q.connect)(function(e){return{inkBrushes:e.markup.inkBrushes,activeInkBrushId:e.uiState.activeInkBrushId,activeMarkupToolType:e.markup.activeMarkupToolType,enableClearAllInk:mE({markup:e.markup}),showInkStylePicker:e.uiState.showInkStylePicker}},ES)(wS),xS=((yS={}).Crop={top:24,bottom:24,left:24,right:24},yS),TS=Object(i.memo)(Object(i.forwardRef)(function(e,t){var n=e.layout,r=e.componentSize,o=e.onSave,u=e.onClose,a=e.pivotItems,f=e.onEditsChanged,l=e.onUiStateChanged,c=e.cssToPhysicalPixelRatio,h=ba(),p=Jd(t),d=p.editOperationsRef,v=p.editUiStateRef,m=Object(i.useContext)(Za),g=m.image,y=m.setOffscreenRenderer,b=Object(i.useMemo)(function(){if(n){var e=n;return{header:s.a.createElement(fS,{onSave:o,onBack:u,style:{saveButton:kv}}),footer:s.a.createElement(_c,{pivotItems:a,styles:cS(h,40,24,"transparent")}),styles:(function(e,t){var n,r,i=e.hingeStartOffset,s=e.orientation,o=e.hingeGap,u=e.isOrderInverted;if("Landscape"===s){var a=i,f=o,l=t.width-a-f,c="row";if(u){a=(n=[l,a])[0],l=n[1];c="row-reverse"}return{mainContainerStyle:{flexDirection:c},canvasContainerStyle:{width:a+"px",height:"100%",flexShrink:0,flexBasis:"auto",position:"relative"},hingeStyle:{minWidth:f+"px",flexShrink:0,flexBasis:"auto"},paneSize:{width:l,height:t.height}}}var h=i,p=o,d=t.height-h-p,v="column";if(u){h=(r=[d,h])[0],d=r[1];v="column-reverse"}return{mainContainerStyle:{flexDirection:v},canvasContainerStyle:{height:h+"px",width:"100%",flexShrink:0,flexBasis:"auto",position:"relative"},hingeStyle:{minHeight:p+"px",flexShrink:0,flexBasis:"auto"},paneSize:{width:t.width,height:d}}})(e,r)}}},[o,u,r,n,a,h]);return s.a.createElement(nS,{duoLayoutData:n},s.a.createElement("div",{className:hS,style:null==b?void 0:b.styles.mainContainerStyle},s.a.createElement("div",{style:null==b?void 0:b.styles.canvasContainerStyle},s.a.createElement(Kp,{canvasSize:r,cssToPhysicalPixelRatio:c},s.a.createElement(wp,{backgroundColor:Nh(h.semanticColors.bodyBackground)},s.a.createElement(Gp,{match:"Crop"},s.a.createElement(Fh,{handleSizeCss:16,handleHitAreaSizeCss:29}),s.a.createElement(Oh,null)),s.a.createElement(Cp,{image:g,color:Th,zIndex:1},s.a.createElement(Ky,null,s.a.createElement(Ra,{ref:y}),s.a.createElement(Jy,null),s.a.createElement(qE,null))),s.a.createElement(Gp,{match:"Markup"},s.a.createElement(ME,null)))),s.a.createElement(Gp,{match:"Crop"},s.a.createElement(yp,null),s.a.createElement(yc,null),s.a.createElement(Rp,null)),s.a.createElement(Gp,{match:"Adjustment"},s.a.createElement(lg,null),s.a.createElement(ed,{gutterSize:16})),s.a.createElement(Gp,{match:"Filter"},s.a.createElement(lg,null),s.a.createElement(ed,{gutterSize:16}))),s.a.createElement("div",{style:null==b?void 0:b.styles.hingeStyle}),s.a.createElement(Gp,{match:"Crop"},s.a.createElement(tS,{size:null==b?void 0:b.styles.paneSize,header:null==b?void 0:b.header,footer:null==b?void 0:b.footer,styles:gv})),s.a.createElement(Gp,{match:"Adjustment"},s.a.createElement(rc,{size:null==b?void 0:b.styles.paneSize,header:null==b?void 0:b.header,footer:null==b?void 0:b.footer,styles:Tv(h)})),s.a.createElement(Gp,{match:"Filter"},s.a.createElement(Pb,{size:null==b?void 0:b.styles.paneSize,header:null==b?void 0:b.header,footer:null==b?void 0:b.footer,styles:qb(n)})),s.a.createElement(Gp,{match:"Markup"},s.a.createElement(SS,{size:null==b?void 0:b.styles.paneSize,header:null==b?void 0:b.header,footer:null==b?void 0:b.footer,styles:yv})),s.a.createElement(_p,{ref:d,onEditsChanged:f}),s.a.createElement(jp,{ref:v,onUiStateChanged:l}),s.a.createElement(mg,{cssPixelMarginByActivity:xS})))})),NS={margin:"0px 16px",display:"flex",height:"40px",flexGrow:1,justifyContent:"center"},CS={marginBottom:"0.5rem"},kS={container:CS},LS=Object(i.memo)(function(e){var t=e.showAspectRatioOptions,n=e.activeAspectRatio,r=e.setAspectRatioConstraint,i=e.setAriaAnnouncement,o=e.styles,u=ba(),a=null==o?void 0:o.getAspectRatioTilesStyles,f=a?a(u):Bv(u);return s.a.createElement(ev,{styles:kS},!t&&s.a.createElement(Gp,{match:"Crop"},s.a.createElement(Lm,{componentStyles:{rotationAngleDisplay:Gm,rotationBarRoot:{display:"flex",justifyContent:"center",margin:"0px 16px 12px 16px"},rotate90AspectFlipBar:{container:NS,iconButton:sv(u),icon:ov,aspectRatioButton:lv}},rotate90AspectFlipBarIcons:{rotate90CounterClockwise:"Rotate90CounterClockwise",rotate90Clockwise:"Rotate90Clockwise",flipHorizontally:"FlipHorizontal-Havana",flipVertically:"FlipVertical-Havana"},styles:o})),t&&s.a.createElement(Jm,{activeAspectRatio:n,setAspectRatioConstraint:r,scrollContainerType:Um.AutoCenterSelected,setAriaAnnouncement:i,aspectRatioTilesStyles:f}))}),AS={setAspectRatioConstraint:qo,setAriaAnnouncement:_u},OS=Object(q.connect)(function(e){return{showAspectRatioOptions:e.uiState.showAspectRatioOptions,activeAspectRatio:e.transformTools.cropInteraction.aspectRatioConstraint}},AS)(LS);Object(_l.n)([{rawString:".layout_mobile_9d5f99c9{width:100%;height:100%;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;display:grid;grid-template-rows:1fr auto}.canvas_container_9d5f99c9{position:relative;width:100%;height:100%}"}]);var MS="layout_mobile_9d5f99c9",_S="canvas_container_9d5f99c9";Object(_l.n)([{rawString:".crop_commandBar_container_e5947ab7{position:absolute;z-index:3;width:100%}.adjustments_commandBar_container_e5947ab7{position:absolute;z-index:3;width:100%;background:rgba(0,0,0,.4)}"}]);var DS="crop_commandBar_container_e5947ab7",PS="adjustments_commandBar_container_e5947ab7",HS=Object(i.memo)(function(e){var t=e.activePivot,n=e.onSave,r=e.onBack,i=e.style;return s.a.createElement("div",{className:"Crop"===t?DS:PS,role:"banner"},s.a.createElement(fS,{onSave:n,onBack:r,style:i}))}),BS=Object(q.connect)(function(e){return{activePivot:e.uiState.activeEditorActivity}})(HS);Object(_l.n)([{rawString:".mobileActionStackBar_6472d122{padding:.5rem 1rem;text-align:center}"}]);var jS="mobileActionStackBar_6472d122",FS=Object(i.memo)(function(e){var t=e.children,n=e.styles;return s.a.createElement("div",{className:jS,style:n},t)});FS.displayName="MobileActionStackBar";Object(_l.n)([{rawString:".footerButton_5925a347{border:0;font-size:1.1rem}.pivotContainer_5925a347{overflow-x:auto;position:relative;-ms-overflow-style:none;overflow:-moz-scrollbars-none;scrollbar-width:none}.pivotContainer_5925a347::-webkit-scrollbar{display:none}"}]);var IS="footerButton_5925a347",qS="pivotContainer_5925a347",RS={actionStackBar:{display:"table",minWidth:"calc(100% - 2rem)"}},US=Object(i.memo)(function(e){var t=e.showAspectRatioOptions,n=e.setShowAspectRatioOptions,r=e.pivotItems,o=e.pivotStyles,u=e.footerButtonStyle,a=ba(),f=Object(i.useContext)(_e).strings,l=Object(i.useCallback)(function(){n(!1)},[n]),c=Object(i.useMemo)(function(){return Object(wa.b)(u,{label:{fontSize:"16px",fontWeight:"500"}})},[u]),h=t?{borderTop:"solid 1px #292929"}:{};return s.a.createElement("div",{className:qS,style:h},s.a.createElement(FS,{styles:RS.actionStackBar},t?s.a.createElement(cd.e,{text:f.footer_done,onClick:l,theme:a,className:IS,styles:c}):s.a.createElement(_c,{pivotItems:r,styles:o})))});US.displayName="TransformToolMobileFooter";var zS={setShowAspectRatioOptions:Ys},WS=Object(q.connect)(function(e){return{showAspectRatioOptions:e.uiState.showAspectRatioOptions}},zS)(US),XS=function(){return(XS=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)},VS=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n},$S=Object(i.memo)(function(e){var t,n=e.setActiveAdjustment,r=e.activeAdjustment,o=e.getTileStyles,u=VS(e,["setActiveAdjustment","activeAdjustment","getTileStyles"]),a=Object(i.useContext)(_e).strings,f=ba(),l=o?o(f):Bv(f),c=$m(Object.values(vo),l,Ml(a),su,n,(function(e){return function(t){return e===t}})(r),(t=u,function(e){return.5!==t[e]}));return s.a.createElement(Bm,{direction:"horizontal",style:XS(XS({},CS),{overflowY:"hidden"})},c)});$S.displayName="AdjustmentActionsBar";var JS,KS={setActiveAdjustment:Zs},QS=Object(q.connect)(function(e){var t=e.colorAdjustments;return{brightness:t.brightness,exposure:t.exposure,saturation:t.saturation,highlights:t.highlights,shadows:t.shadows,contrast:t.contrast,temperature:t.temperature,tint:t.tint,vignette:t.vignette,activeAdjustment:e.uiState.activeAdjustment}},KS)($S),GS=function(){return{activeSection:{},container:{position:"absolute",width:"calc(100% - 56px)",transform:"translate(-50%,28px)",right:"50%",left:"50%",height:"16px"},slideBox:{margin:"0px",padding:"0px"}}},YS={height:"16px",fontSize:"12px",lineHeight:"16px",position:"absolute",width:"calc(100% - 56px)",transform:"translate(-50%,8px)",left:"50%",right:"50%"},ZS={getSliderHeaderStyles:function(){return{container:YS}},getSliderStyles:GS},ex=Object(i.memo)(function(e){var t=e.adjustmentValue,n=e.activeAdjustment,r=e.setAdjustmentValue,i=e.styles,o=i||ZS;return s.a.createElement("div",null,s.a.createElement(Jl,{adjustment:n,layout:"ValueOnly",normalizedValue:t,setNormalizedValue:r,styles:o}))});ex.displayName="MobileAdjustmentsSlider";var tx=((JS={})[vo.Exposure]=pu,JS[vo.Brightness]=hu,JS[vo.Contrast]=bu,JS[vo.Highlights]=gu,JS[vo.Shadows]=yu,JS[vo.Saturation]=mu,JS[vo.Temperature]=du,JS[vo.Tint]=vu,JS[vo.Vignette]=wu,JS),nx=Object(q.connect)(function(e,t){return{adjustmentValue:e.colorAdjustments[t.activeAdjustment],key:e.uiState.numberOfResets}},function(e,t){return Object(Ut.t)({setAdjustmentValue:tx[t.activeAdjustment]},e)})(ex),rx=Object(i.memo)(function(e){var t=e.activeAdjustment,n=e.pivotItems,r=e.pivotStyles,i=e.getTileStyles,o=e.sliderStyles;return s.a.createElement(s.a.Fragment,null,t&&s.a.createElement(nx,{activeAdjustment:t,styles:o}),s.a.createElement(QS,{getTileStyles:i}),s.a.createElement("div",{className:qS},s.a.createElement(FS,{styles:RS.actionStackBar},s.a.createElement(_c,{pivotItems:n,styles:r}))))});rx.displayName="AdjustmentMobileFooter";var ix=Object(q.connect)(function(e){return{activeAdjustment:e.uiState.activeAdjustment}})(rx),sx=function(){return(sx=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)},ox=Object(i.memo)(function(e){var t=e.availableFilters,n=e.imageTransformValues,r=e.cropTransformValues,o=e.cssToPhysicalPixelRatio,u=e.activeFilter,a=e.setActiveFilter,f=e.setAriaAnnouncement,l=e.getTileStyles,c=Object(i.useMemo)(function(){return t.map(function(){return Object(i.createRef)()})},[t]),h=ba(),p=l?l(h):jv(h),d=mb(u,c,kb(t,n,r,o,48,48),48,a,f,p);return s.a.createElement(Bm,{direction:"horizontal",style:sx(sx({},CS),{overflowY:"hidden"})},t.map(d))});ox.displayName="FiltersActionsBar";var ux={setAriaAnnouncement:_u},ax=Object(q.connect)(function(e){return{availableFilters:e.filters.availableFilters,cropTransformValues:e.transformTools.cropInteraction.uvToWorld,imageTransformValues:e.transformTools.image._preciseUvToWorld,cssToPhysicalPixelRatio:e.transformTools.device.pixelRatio}},ux)(ox),fx={flexBasis:"100%"},lx=Object(i.memo)(function(e){var t=e.showIntensitySlider,n=e.filterLevelsByName,r=e.activeFilter,o=e.setActiveFilterAndLevel,u=e.pivotItems,a=e.pivotStyles,f=e.getTileStyles,l=e.sliderStyles,c=Object(i.useContext)(_e).strings,h=Object(i.useCallback)(function(e){o({activeFilter:r,filterLevel:e})},[o,r]),p=Object(i.useCallback)(function(e){o({activeFilter:e,filterLevel:n[e.name]})},[n,o]),d=l?l.getSliderHeaderStyles:function(){return{container:YS}},v=l?l.getSliderStyles:GS;return s.a.createElement(s.a.Fragment,null,t&&s.a.createElement(nb,{key:r.name,filterLevel:n[r.name],setFilterLevel:h,layout:"ValueOnly",style:{container:fx,getSliderHeaderStyles:d,getSliderStyles:v},headerName:c.filter_intensitySliderHeader,ariaLabel:sc(c.filter_intensitySliderAriaLabelFormatString,c[r.ariaLabelLocStringKey])}),s.a.createElement(ax,{activeFilter:r,setActiveFilter:p,getTileStyles:f}),s.a.createElement("div",{className:qS},s.a.createElement(FS,{styles:RS.actionStackBar},s.a.createElement(_c,{pivotItems:u,styles:a}))))});lx.displayName="FilterMobileFooter";var cx={setActiveFilterAndLevel:qs},hx=Object(q.connect)(function(e){var t=e.filters.activeFilter;return{showIntensitySlider:rf(t),filterLevelsByName:e.uiState.filterLevelsByName,activeFilter:t}},cx)(lx),px=Object(i.memo)(function(e){var t=e.pivotItems,n=e.pivotStyles;return s.a.createElement("div",{className:qS},s.a.createElement(FS,{styles:RS.actionStackBar},s.a.createElement(_c,{pivotItems:t,styles:n})))});px.displayName="MarkupMobileFooter";var dx=function(){return(dx=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)},vx={width:20,height:20};function mx(e){var t={"&:active":{backgroundColor:e.palette.neutralLight},"&:hover":{backgroundColor:e.palette.neutralLighter}};return{toolbar:{canvasContainer:{bottom:"0",left:"50%",width:"100%",display:"flex",justifyContent:"center"},container:{backgroundColor:e.palette.white,width:"100%",padding:0},clearAllInk:{inkToolbarButton:{root:{height:"40px",width:"40px",minWidth:"40px"}},inkToolbarTools:{activeToolbarIcon:{backgroundColor:e.palette.neutralLighter},toolbarIcon:dx({width:"40px",height:"40px"},t)},clearAllInkIcon:{styles:dx({},vx),disabledColor:e.palette.neutralQuaternary}},inkToolbarTools:{activeToolbarIcon:{backgroundColor:e.palette.neutralLighter},toolbarIcon:dx({},t)},inkStylePicker:{contentWrapper:{width:"100%",paddingLeft:"28px",paddingRight:"28px"},inkColorPickerStyles:{colorPicker:{root:{width:"100%"}}},sliderStyles:{getSliderStyles:gx}}}}}function gx(e,t){return{valueLabel:{width:"auto"}}}var yx,bx=function(e){var t=e.componentSize,n=e.cssToPhysicalPixelRatio,r=Object(i.useContext)(Za),o=r.image,u=r.setOffscreenRenderer,a=ba();return s.a.createElement(Kp,{canvasSize:t,cssToPhysicalPixelRatio:n},s.a.createElement(wp,{backgroundColor:Nh(a.semanticColors.bodyBackground)},s.a.createElement(Gp,{match:"Crop"},s.a.createElement(Fh,{handleSizeCss:16,handleHitAreaSizeCss:29}),s.a.createElement(Oh,null)),s.a.createElement(Cp,{image:o,color:Th,zIndex:1},s.a.createElement(Ky,null,s.a.createElement(Ra,{ref:u}),s.a.createElement(Jy,null),s.a.createElement(qE,null))),s.a.createElement(Gp,{match:"Markup"},s.a.createElement(_E,{styles:mx(a),showStylePickerInFullWidth:!0}))))},wx=function(){return(wx=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)},Ex=((yx={}).Crop={top:80,left:24,right:24,bottom:149},yx.Adjustment=wx(wx({},dr(0)),{top:56}),yx.Filter=wx(wx({},dr(0)),{top:56}),yx.Markup=wx(wx({},dr(0)),{top:56,bottom:73}),yx),Sx=Object(i.memo)(Object(i.forwardRef)(function(e,t){var n=e.componentSize,r=e.onSave,o=e.onClose,u=e.pivotItems,a=e.onEditsChanged,f=e.onUiStateChanged,l=e.cssToPhysicalPixelRatio,c=e.actionsStackStyles,h=e.getAdjustmentTileStyle,p=e.adjustmentSliderStyle,d=e.getFilterTileStyle,v=e.filterSliderStyle,m=e.footerButtonStyle,g=e.pivotLinkHeight,y=e.pivotLinkLineHeight,b=e.commandBarStyle,w=ba(),E=Jd(t),S=E.editOperationsRef,x=E.editUiStateRef,T=Object(i.useMemo)(function(){return cS(w,g,y,w.palette.neutralLighterAlt)},[w,g,y]);return s.a.createElement("div",{className:MS},s.a.createElement(BS,{onSave:r,onBack:o,style:b}),s.a.createElement("div",{className:_S,role:"main"},s.a.createElement(bx,{componentSize:n,cssToPhysicalPixelRatio:l}),s.a.createElement(Gp,{match:"Crop"},s.a.createElement(yp,null),s.a.createElement(yc,null),s.a.createElement(Rp,null)),s.a.createElement(OS,{styles:c}),s.a.createElement(Gp,{match:"Adjustment"},s.a.createElement(lg,null),s.a.createElement(ed,{gutterSize:16})),s.a.createElement(Gp,{match:"Filter"},s.a.createElement(lg,null),s.a.createElement(ed,{gutterSize:16}))),s.a.createElement(Gp,{match:"Crop"},s.a.createElement(WS,{pivotItems:u,pivotStyles:T,footerButtonStyle:m})),s.a.createElement(Gp,{match:"Adjustment"},s.a.createElement(ix,{pivotItems:u,pivotStyles:T,getTileStyles:h,sliderStyles:p})),s.a.createElement(Gp,{match:"Filter"},s.a.createElement(hx,{pivotItems:u,pivotStyles:T,getTileStyles:d,sliderStyles:v})),s.a.createElement(Gp,{match:"Markup"},s.a.createElement(px,{pivotItems:u,pivotStyles:T})),s.a.createElement(_p,{ref:S,onEditsChanged:a}),s.a.createElement(jp,{ref:x,onUiStateChanged:f}),s.a.createElement(mg,{cssPixelMarginByActivity:Ex}))}));var xx={position:"absolute",top:-1,width:1,height:1,margin:-1,padding:0,border:0,overflow:"hidden"},Tx=s.a.memo(function(e){var t=e.message;return s.a.createElement(s.a.Fragment,null,s.a.createElement("div",{role:"status","aria-live":"assertive","aria-atomic":"true",style:xx},t))});var Nx=s.a.memo(function(e){var t=e.cropWidth,n=e.cropHeight,r=e.cropTopLeftCornerFromImageOrigin,o=e.panViewTopLeftCornerFromCropOrigin,u=e.currentZoom,a=e.ariaAnnouncementScenario,f=e.ariaAnnouncementMessage,l=e.setAriaAnnouncement,c=e.setAriaAnnouncementScenario;(function(e,t,n,r,s){var o=Object(i.useContext)(_e).strings;Object(i.useEffect)(function(){if("CropImageDimension"===(null==s?void 0:s.type)){s.cropDimension.width===n&&s.cropDimension.height===r||e(sc(o.editor_imageDimensionAriaLive,n.toString(),r.toString()));t(void 0)}},[e,t,s,n,r,o])})(l,c,t,n,a);(function(e,t,n,r){var s=Object(i.useContext)(_e).strings;Object(i.useEffect)(function(){if("CropImageMove"===(null==r?void 0:r.type)){var i=En(n,r.cropTopLeftCornerFromImageOrigin),o=n.x.toString(),u=n.y.toString();e(sc(i?s.crop_rectangleCannotMoveInCurrentDirectionAriaLive:s.crop_rectanglePositionAriaLive,o,u));t(void 0)}},[r,n,e,t,s])})(l,c,r,a);(function(e,t,n,r){var s=Object(i.useContext)(_e).strings;Object(i.useEffect)(function(){if("Zoom"===(null==r?void 0:r.type)){var i=Math.round(100*r.zoom),o=Math.round(100*n);if(i!==o){var u=sc(s.editor_zoomPercentAriaLive,o.toString());e(u)}t(void 0)}},[r,n,s,e,t])})(l,c,u,a);(function(e,t,n,r){var s=Object(i.useContext)(_e).strings;Object(i.useEffect)(function(){if("PanView"===(null==r?void 0:r.type)){var i=n.x.toString(),o=n.y.toString();e(sc(s.nonCrop_panViewPositionAriaLive,i,o));t(void 0)}},[r,n,e,t,s])})(l,c,o,a);return s.a.createElement(Tx,{message:f})}),Cx={setAriaAnnouncement:_u,setAriaAnnouncementScenario:Du},kx=Object(q.connect)(function(e){var t=e.ariaAnnouncement,n=t.ariaAnnouncementScenario,r=t.ariaAnnouncementMessage;return{cropWidth:qh(e.transformTools),cropHeight:Rh(e.transformTools),cropTopLeftCornerFromImageOrigin:mp(e.transformTools),panViewTopLeftCornerFromCropOrigin:ug(e.transformTools),currentZoom:vp(e.transformTools),ariaAnnouncementScenario:n,ariaAnnouncementMessage:r}},Cx)(Nx),Lx=function(e){var t=e.enableAdjustments,n=e.enableFilters,r=e.enableAutoEnhance,i=e.enableMarkup,o=e.children;return s.a.createElement(Py.Provider,{value:{enableAdjustments:!!t,enableFilters:!!n,enableAutoEnhance:!!r,enableMarkup:!!i}},o)};function Ax(){return n.ee([1],5048)}var Ox=Object(q.connect)(function(e){return{activeEditorActivity:e.uiState.activeEditorActivity}})(function(e){var t=e.activeEditorActivity,n=Object(i.useRef)(t),r=Object(i.useContext)(me).logEditorActivityEvent;Object(i.useLayoutEffect)(function(){var e,i=window.requestAnimationFrame(function(){e=setTimeout(function(){var e=(function(e){var t=performance.getEntriesByName(e);if(1===t.length){var n=performance.now()-t[0].startTime;performance.clearMarks(e);return n}performance.clearMarks(e)})(t);e&&r({editorActivityName:t,previousEditorActivityName:n.current,loadTimeInMs:e});n.current=t})});return function(){clearTimeout(e);window.cancelAnimationFrame(i)}},[t,r]);return s.a.createElement(s.a.Fragment,null)}),Mx=function(){return(Mx=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)};function _x(e){var t=Bv(e);return Mx(Mx({},t),{container:{minWidth:"92px",marginTop:"80px"},background:Mx(Mx({},t.background),{width:"76px",height:"76px",marginTop:"0px"}),icon:{fontSize:"26px",width:"26px",height:"26px",color:e.palette.neutralPrimaryAlt,fill:e.palette.neutralPrimaryAlt}})}var Dx={transformToolsContainer:{left:"50%",transform:"translate(-50%, 0)",width:"calc(100% - 128px)"},getAspectRatioTilesStyles:_x},Px={root:{height:"40px"}},Hx={getSliderStyles:function(e,t){var n=Sv(e);return mv(mv({},n),{container:{margin:"auto",position:"absolute",transform:"translate(-50%,32px)",left:"50%",right:"50%",width:"calc(100% - 128px)"},slideBox:Object(wa.F)(n.slideBox,{padding:"0px"})})},getSliderHeaderStyles:function(e){return{container:{zIndex:1,position:"absolute",width:"calc(100% - 128px)",transform:"translate(-50%, -18px)",left:"50%",right:"50%"},valueHeader:{width:"42px",height:"42px",borderRadius:"50%",backgroundColor:e.palette.white+"CC",textAlign:"center",border:"1px solid "+e.palette.black+"33",boxSizing:"border-box",fontSize:"16px",color:e.palette.neutralPrimaryAlt}}}},Bx={saveButton:kv},jx=function(){return(jx=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)},Fx=Object(i.forwardRef)(function(e,t){var n=e.image,r=e.componentSize,o=e.onSave,u=e.localization,a=e.telemetryCallback,f=e.onError,l=e.onClose,c=e.onEditsChanged,h=e.onUiStateChanged,p=e.componentImplementationContext,d=e.defaultEdits,v=e.initialEdits,m=e.initialUiState,g=e.serializedState,y=e.layout,b=void 0===y?{type:Hb.Desktop}:y,w=e.enableAdjustments,E=e.enableFilters,S=e.enableAutoEnhance,x=e.cssToPhysicalPixelRatio,T=e.onDecideEnabledSaveTypes,N=e.sessionFullImageSize,C=e.children;Object(i.useEffect)(function(){performance.mark(I.Editor)},[]);var k=ba();Object(i.useMemo)(function(){return Object(wa.U)({icons:{"OneByTwoAspect-Havana":Kf,"TwoByOneAspect-Havana":Qf,"TwoByThreeAspect-Havana":Gf,"ThreeByTwoAspect-Havana":Yf,"ThreeByFourAspect-Havana":Zf,"FourByThreeAspect-Havana":el,"FourByFiveAspect-Havana":tl,"FiveByFourAspect-Havana":nl,"NineBySixteenAspect-Havana":rl,"SixteenByNineAspect-Havana":il,"FreeformAspect-Havana":sl,"OriginalAspect-Havana":ol,"SquareAspect-Havana":ul,"Brightness-Havana":al,"Highlights-Havana":ll,"Exposure-Havana":cl,"Contrast-Havana":hl,"Saturation-Havana":fl,"Shadows-Havana":vl,"Tint-Havana":pl,"Vignette-Havana":dl,"Temperature-Havana":ml,"FlipHorizontal-Havana":gl,"FlipVertical-Havana":yl,"ImageFilter-Havana":bl,"FitPageRoundedEdge-Havana":El,"ActualSizeRoundedEdge-Havana":wl,"ActiveFilterCheckmark-Havana":Sl,"Back-Havana":xl,"Forward-Havana":Tl,"Crop-Windows":Nl,"Adjustments-Windows":Cl,"Filters-Windows":kl,"Markup-Windows":Ll}})},[]);var L=Object(i.useContext)(Ca).enableMarkup;(function(e,t,n){var r=Object(i.useContext)(Ca).scriptsToLoadJSBundles;Object(i.useEffect)(function(){t&&t===e&&Ax()},[t,e]);Object(i.useEffect)(function(){n&&n===e&&r.forEach(function(e){e()})},[n,e,r])})(!0,null!=E&&E,L);var A,O=Object(i.useMemo)(function(){return(function(e,t,n){var r=[{itemIcon:"Crop",itemKey:"Crop",localizationKey:"pivot_crop"}];e&&r.push({itemIcon:"Equalizer",itemKey:"Adjustment",localizationKey:"pivot_adjustment"});t&&r.push({itemIcon:"ImageFilter-Havana",itemKey:"Filter",localizationKey:"pivot_filter"});n&&r.push({itemIcon:"Brush",itemKey:"Markup",localizationKey:"pivot_markup"});return r})(w,E,L)},[w,E,L]),M=k.semanticColors.bodyBackground,_={layout:b,componentSize:r,onSave:o,onClose:l,pivotItems:O,onEditsChanged:c,onUiStateChanged:h,cssToPhysicalPixelRatio:x};switch(b.type){case Hb.Desktop:A=s.a.createElement(WE,jx({ref:t},_));break;case Hb.Mobile:A=s.a.createElement(Sx,jx({ref:t},_,{pivotLinkHeight:32,pivotLinkLineHeight:16}));break;case Hb.DuoDouble:A=s.a.createElement(TS,jx({ref:t},_));break;case Hb.DuoSingle:A=s.a.createElement(Sx,jx({ref:t},_,{actionsStackStyles:Dx,getAdjustmentTileStyle:_x,adjustmentSliderStyle:Hx,getFilterTileStyle:Fv,filterSliderStyle:Hx,footerButtonStyle:Px,pivotLinkHeight:40,pivotLinkLineHeight:24,commandBarStyle:Bx}))}return s.a.createElement("div",{style:{width:r.width,height:r.height,backgroundColor:M}},s.a.createElement(Lx,{enableAdjustments:w,enableFilters:E,enableAutoEnhance:S,enableMarkup:L},s.a.createElement(Jf,{image:n,localization:u,telemetryCallback:a,onComponentError:f,componentImplementationContext:p,defaultEdits:d,initialEdits:v,initialUiState:m,serializedState:g,sessionFullImageSize:N,onDecideEnabledSaveTypes:T},A,C,s.a.createElement(Ox,null),s.a.createElement(kx,null))))});Fx.displayName="ImageEditor";var Ix=n(163),qx=function(e,t){var n=this;this.getTexture=function(e,t,r,i,s,o){void 0===i&&(i=!1);if(!(e instanceof HTMLImageElement)||e.complete&&e.currentSrc){var u=Qa(e),a=n._loadableTexturesMap.has(u)&&n._loadableTexturesMap.get(u);if(a){a.refCount++;a.isLoaded?a.texture&&t({height:a.loadedHeight,width:a.loadedWidth,id:a.id,texture:a.texture}):a.onReadyCallbacksList.push(t)}else{var f=n._loadableTexturesMap;f.set(u,{id:u,isLoaded:!1,onReadyCallbacksList:[t],refCount:1});n._textureLoadFn(e,function(e,t,n){var r=f.get(u);if(r){r.loadedHeight=n;r.loadedWidth=t;r.isLoaded=!0;r.texture=e;r.onReadyCallbacksList.forEach(function(r){r&&r({id:u,height:n,width:t,texture:e})})}},function(e){s(e)},r,i,o)}}else s({id:"ImageNotLoaded",message:"The image is not yet loaded"})};this.dispose=function(){n._loadableTexturesMap.forEach(function(e){e.texture&&n._textureUnloadFn(e.texture)});n._loadableTexturesMap.clear()};this.releaseTexture=function(e,t){void 0===t&&(t=!1);var r=n._loadableTexturesMap.get(e);if(r)if(t||r.refCount<=1){r.texture&&n._textureUnloadFn(r.texture);n._loadableTexturesMap.delete(e)}else r.refCount--};this._textureLoadFn=e;this._textureUnloadFn=t;this._loadableTexturesMap=new Map},Rx=(function(){function e(e,t){this.width=e;this.height=t}e.prototype.toString=function(){return"{W: "+this.width+", H: "+this.height+"}"};e.prototype.getClassName=function(){return"Size"};e.prototype.getHashCode=function(){var e=0|this.width;return e=397*e^(0|this.height)};e.prototype.copyFrom=function(e){this.width=e.width;this.height=e.height};e.prototype.copyFromFloats=function(e,t){this.width=e;this.height=t;return this};e.prototype.set=function(e,t){return this.copyFromFloats(e,t)};e.prototype.multiplyByFloats=function(t,n){return new e(this.width*t,this.height*n)};e.prototype.clone=function(){return new e(this.width,this.height)};e.prototype.equals=function(e){return!!e&&(this.width===e.width&&this.height===e.height)};Object.defineProperty(e.prototype,"surface",{get:function(){return this.width*this.height},enumerable:!1,configurable:!0});e.Zero=function(){return new e(0,0)};e.prototype.add=function(t){return new e(this.width+t.width,this.height+t.height)};e.prototype.subtract=function(t){return new e(this.width-t.width,this.height-t.height)};e.Lerp=function(t,n,r){return new e(t.width+(n.width-t.width)*r,t.height+(n.height-t.height)*r)};return e})(),Ux=(function(){function e(e){this._wrapU=1;this._wrapV=1;this.wrapR=1;this.anisotropicFilteringLevel=4;this.delayLoadState=0;this._texture=null;this._engine=null;this._cachedSize=Rx.Zero();this._cachedBaseSize=Rx.Zero();this._initialSamplingMode=2;this._texture=e;this._texture&&(this._engine=this._texture.getEngine())}Object.defineProperty(e.prototype,"wrapU",{get:function(){return this._wrapU},set:function(e){this._wrapU=e},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"wrapV",{get:function(){return this._wrapV},set:function(e){this._wrapV=e},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"coordinatesMode",{get:function(){return 0},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"isCube",{get:function(){return!!this._texture&&this._texture.isCube},set:function(e){this._texture&&(this._texture.isCube=e)},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"is3D",{get:function(){return!!this._texture&&this._texture.is3D},set:function(e){this._texture&&(this._texture.is3D=e)},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"is2DArray",{get:function(){return!!this._texture&&this._texture.is2DArray},set:function(e){this._texture&&(this._texture.is2DArray=e)},enumerable:!1,configurable:!0});e.prototype.getClassName=function(){return"ThinTexture"};e.prototype.isReady=function(){if(4===this.delayLoadState){this.delayLoad();return!1}return!!this._texture&&this._texture.isReady};e.prototype.delayLoad=function(){};e.prototype.getInternalTexture=function(){return this._texture};e.prototype.getSize=function(){if(this._texture){if(this._texture.width){this._cachedSize.width=this._texture.width;this._cachedSize.height=this._texture.height;return this._cachedSize}if(this._texture._size){this._cachedSize.width=this._texture._size;this._cachedSize.height=this._texture._size;return this._cachedSize}}return this._cachedSize};e.prototype.getBaseSize=function(){if(!this.isReady()||!this._texture){this._cachedBaseSize.width=0;this._cachedBaseSize.height=0;return this._cachedBaseSize}if(this._texture._size){this._cachedBaseSize.width=this._texture._size;this._cachedBaseSize.height=this._texture._size;return this._cachedBaseSize}this._cachedBaseSize.width=this._texture.baseWidth;this._cachedBaseSize.height=this._texture.baseHeight;return this._cachedBaseSize};Object.defineProperty(e.prototype,"samplingMode",{get:function(){return this._texture?this._texture.samplingMode:this._initialSamplingMode},enumerable:!1,configurable:!0});e.prototype.updateSamplingMode=function(e){this._texture&&this._engine&&this._engine.updateTextureSamplingMode(e,this._texture)};e.prototype.releaseInternalTexture=function(){if(this._texture){this._texture.dispose();this._texture=null}};e.prototype.dispose=function(){if(this._texture){this.releaseInternalTexture();this._engine=null}};return e})(),zx=(function(){function e(){}e.ALPHA_COMBINE=2;e.TEXTURE_CLAMP_ADDRESSMODE=0;e.TEXTURE_DEFAULT_ANISOTROPIC_FILTERING_LEVEL=4;e.TEXTUREFORMAT_RGB=4;e.TEXTUREFORMAT_RGBA=5;e.TEXTURETYPE_UNSIGNED_BYTE=0;e.TEXTURE_TRILINEAR_SAMPLINGMODE=3;e.MATERIAL_LineListDrawMode=4;e.MATERIAL_LineLoopDrawMode=5;return e})(),Wx=function(e,t){return(Wx=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)};var Xx=function(){return(Xx=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)},Vx=(function(e){(function(e,t){Wx(e,t);function n(){this.constructor=e}e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)})(t,e);function t(n,r){var i=e.call(this,null)||this;r=Xx(Xx({},t.DefaultOptions),r);i._generateMipMaps=r.generateMipMaps;i._samplingMode=r.samplingMode;i._engine=r.engine;i.element=n;i.anisotropicFilteringLevel=1;i._createInternalTexture();return i}t.prototype._createInternalTexture=function(){var e,t;e=this.element.width;t=this.element.height;var n=this._engine;n&&(this._texture=n.createDynamicTexture(e,t,this._generateMipMaps,this._samplingMode));this.update()};t.prototype.update=function(){var e=this._engine;if(null!=this._texture&&null!=e){var t=this.element;e.updateDynamicTexture(this._texture,t,!0,!1)}};t.DefaultOptions={generateMipMaps:!1,samplingMode:zx.TEXTURE_TRILINEAR_SAMPLINGMODE,engine:null};return t})(Ux),$x=function(e,t){return($x=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)};function Jx(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");$x(e,t);function n(){this.constructor=e}e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var Kx=function(){return(Kx=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)};function Qx(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(e){try{a(r.next(e))}catch(e){s(e)}}function u(e){try{a(r.throw(e))}catch(e){s(e)}}function a(e){e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(o,u);var t}a((r=r.apply(e,t||[])).next())})}function Gx(e,t){var n,r,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function u(s){return function(u){return(function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&s[0]?r.return:s[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,s[1])).done)return i;(r=0,i)&&(s=[2&s[0],i.value]);switch(s[0]){case 0:case 1:i=s;break;case 4:o.label++;return{value:s[1],done:!1};case 5:o.label++;r=s[1];s=[0];continue;case 7:s=o.ops.pop();o.trys.pop();continue;default:if(!(i=o.trys,i=i.length>0&&i[i.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1];i=s;break}if(i&&o.label<i[2]){o.label=i[2];o.ops.push(s);break}i[2]&&o.ops.pop();o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e];r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}})([s,u])}}}Object.create;Object.create;var Yx=(function(){function e(){this.references=0;this.capacity=0;this.is32Bits=!1;this.uniqueId=e._Counter++}Object.defineProperty(e.prototype,"underlyingResource",{get:function(){return null},enumerable:!1,configurable:!0});e._Counter=0;return e})(),Zx=(function(){function e(){}e.Slice=function(e,t,n){return e.slice?e.slice(t,n):Array.prototype.slice.call(e,t,n)};e.SliceToArray=function(e,t,n){return Array.isArray(e)?e.slice(t,n):Array.prototype.slice.call(e,t,n)};return e})(),eT=(function(){function e(e,t,n,r,i,s,o,u){void 0===r&&(r=0);void 0===i&&(i=!1);void 0===s&&(s=!1);void 0===o&&(o=!1);this._isAlreadyOwned=!1;e.getScene?this._engine=e.getScene().getEngine():this._engine=e;this._updatable=n;this._instanced=s;this._divisor=u||1;if(t instanceof Yx){this._data=null;this._buffer=t}else{this._data=t;this._buffer=null}this.byteStride=o?r:r*Float32Array.BYTES_PER_ELEMENT;i||this.create()}e.prototype.createVertexBuffer=function(e,t,n,r,i,s,o){void 0===s&&(s=!1);var u=s?t:t*Float32Array.BYTES_PER_ELEMENT,a=r?s?r:r*Float32Array.BYTES_PER_ELEMENT:this.byteStride;return new tT(this._engine,this,e,this._updatable,!0,a,void 0===i?this._instanced:i,u,n,void 0,void 0,!0,this._divisor||o)};e.prototype.isUpdatable=function(){return this._updatable};e.prototype.getData=function(){return this._data};e.prototype.getBuffer=function(){return this._buffer};e.prototype.getStrideSize=function(){return this.byteStride/Float32Array.BYTES_PER_ELEMENT};e.prototype.create=function(e){void 0===e&&(e=null);if((e||!this._buffer)&&(e=e||this._data))if(this._buffer){if(this._updatable){this._engine.updateDynamicVertexBuffer(this._buffer,e);this._data=e}}else if(this._updatable){this._buffer=this._engine.createDynamicVertexBuffer(e);this._data=e}else this._buffer=this._engine.createVertexBuffer(e)};e.prototype._rebuild=function(){this._buffer=null;this.create(this._data)};e.prototype.update=function(e){this.create(e)};e.prototype.updateDirectly=function(e,t,n,r){void 0===r&&(r=!1);if(this._buffer&&this._updatable){this._engine.updateDynamicVertexBuffer(this._buffer,e,r?t:t*Float32Array.BYTES_PER_ELEMENT,n?n*this.byteStride:void 0);this._data=null}};e.prototype._increaseReferences=function(){this._buffer&&(this._isAlreadyOwned?this._buffer.references++:this._isAlreadyOwned=!0)};e.prototype.dispose=function(){this._buffer&&this._engine._releaseBuffer(this._buffer)&&(this._buffer=null)};return e})(),tT=(function(){function e(t,n,r,i,s,o,u,a,f,l,c,h,p,d){void 0===c&&(c=!1);void 0===h&&(h=!1);void 0===p&&(p=1);void 0===d&&(d=!1);if(n instanceof eT){this._buffer=n;this._ownsBuffer=d;d&&this._buffer._increaseReferences()}else{this._buffer=new eT(t,n,i,o,s,u,h);this._ownsBuffer=!0}this.uniqueId=e._Counter++;this._kind=r;if(null==l){var v=this.getData();this.type=e.FLOAT;v instanceof Int8Array?this.type=e.BYTE:v instanceof Uint8Array?this.type=e.UNSIGNED_BYTE:v instanceof Int16Array?this.type=e.SHORT:v instanceof Uint16Array?this.type=e.UNSIGNED_SHORT:v instanceof Int32Array?this.type=e.INT:v instanceof Uint32Array&&(this.type=e.UNSIGNED_INT)}else this.type=l;var m=e.GetTypeByteLength(this.type);if(h){this._size=f||(o?o/m:e.DeduceStride(r));this.byteStride=o||this._buffer.byteStride||this._size*m;this.byteOffset=a||0}else{this._size=f||o||e.DeduceStride(r);this.byteStride=o?o*m:this._buffer.byteStride||this._size*m;this.byteOffset=(a||0)*m}this.normalized=c;this._instanced=void 0!==u&&u;this._instanceDivisor=u?p:0;this._computeHashCode()}Object.defineProperty(e.prototype,"instanceDivisor",{get:function(){return this._instanceDivisor},set:function(e){this._instanceDivisor=e;this._instanced=0!=e;this._computeHashCode()},enumerable:!1,configurable:!0});e.prototype._computeHashCode=function(){this.hashCode=(this.type-5120<<0)+((this.normalized?1:0)<<3)+(this._size<<4)+((this._instanced?1:0)<<6)+(this.byteStride<<12)};e.prototype._rebuild=function(){this._buffer&&this._buffer._rebuild()};e.prototype.getKind=function(){return this._kind};e.prototype.isUpdatable=function(){return this._buffer.isUpdatable()};e.prototype.getData=function(){return this._buffer.getData()};e.prototype.getFloatData=function(t,n){var r=this.getData();if(!r)return null;var i=this.getSize()*e.GetTypeByteLength(this.type),s=t*this.getSize();if(this.type!==e.FLOAT||this.byteStride!==i){var o=[];this.forEach(s,function(e){return o.push(e)});return o}if(!(r instanceof Array||r instanceof Float32Array)||0!==this.byteOffset||r.length!==s){if(r instanceof Array){var u=this.byteOffset/4;return Zx.Slice(r,u,u+s)}if(r instanceof ArrayBuffer)return new Float32Array(r,this.byteOffset,s);u=r.byteOffset+this.byteOffset;if(n){var a=new Float32Array(s),f=new Float32Array(r.buffer,u,s);a.set(f);return a}var l=u%4;l&&(u=Math.max(0,u-l));return new Float32Array(r.buffer,u,s)}return n?Zx.Slice(r):r};e.prototype.getBuffer=function(){return this._buffer.getBuffer()};e.prototype.getStrideSize=function(){return this.byteStride/e.GetTypeByteLength(this.type)};e.prototype.getOffset=function(){return this.byteOffset/e.GetTypeByteLength(this.type)};e.prototype.getSize=function(t){void 0===t&&(t=!1);return t?this._size*e.GetTypeByteLength(this.type):this._size};e.prototype.getIsInstanced=function(){return this._instanced};e.prototype.getInstanceDivisor=function(){return this._instanceDivisor};e.prototype.create=function(e){this._buffer.create(e)};e.prototype.update=function(e){this._buffer.update(e)};e.prototype.updateDirectly=function(e,t,n){void 0===n&&(n=!1);this._buffer.updateDirectly(e,t,void 0,n)};e.prototype.dispose=function(){this._ownsBuffer&&this._buffer.dispose()};e.prototype.forEach=function(t,n){e.ForEach(this._buffer.getData(),this.byteOffset,this.byteStride,this._size,this.type,t,this.normalized,n)};e.DeduceStride=function(t){switch(t){case e.UVKind:case e.UV2Kind:case e.UV3Kind:case e.UV4Kind:case e.UV5Kind:case e.UV6Kind:return 2;case e.NormalKind:case e.PositionKind:return 3;case e.ColorKind:case e.MatricesIndicesKind:case e.MatricesIndicesExtraKind:case e.MatricesWeightsKind:case e.MatricesWeightsExtraKind:case e.TangentKind:return 4;default:throw new Error("Invalid kind '"+t+"'")}};e.GetTypeByteLength=function(t){switch(t){case e.BYTE:case e.UNSIGNED_BYTE:return 1;case e.SHORT:case e.UNSIGNED_SHORT:return 2;case e.INT:case e.UNSIGNED_INT:case e.FLOAT:return 4;default:throw new Error("Invalid type '"+t+"'")}};e.ForEach=function(t,n,r,i,s,o,u,a){if(t instanceof Array)for(var f=n/4,l=r/4,c=0;c<o;c+=i){for(var h=0;h<i;h++)a(t[f+h],c+h);f+=l}else{var p=t instanceof ArrayBuffer?new DataView(t):new DataView(t.buffer,t.byteOffset,t.byteLength),d=e.GetTypeByteLength(s);for(c=0;c<o;c+=i){var v=n;for(h=0;h<i;h++){a(e._GetFloatValue(p,s,v,u),c+h);v+=d}n+=r}}};e._GetFloatValue=function(t,n,r,i){switch(n){case e.BYTE:var s=t.getInt8(r);i&&(s=Math.max(s/127,-1));return s;case e.UNSIGNED_BYTE:s=t.getUint8(r);i&&(s/=255);return s;case e.SHORT:s=t.getInt16(r,!0);i&&(s=Math.max(s/32767,-1));return s;case e.UNSIGNED_SHORT:s=t.getUint16(r,!0);i&&(s/=65535);return s;case e.INT:return t.getInt32(r,!0);case e.UNSIGNED_INT:return t.getUint32(r,!0);case e.FLOAT:return t.getFloat32(r,!0);default:throw new Error("Invalid component type "+n)}};e._Counter=0;e.BYTE=5120;e.UNSIGNED_BYTE=5121;e.SHORT=5122;e.UNSIGNED_SHORT=5123;e.INT=5124;e.UNSIGNED_INT=5125;e.FLOAT=5126;e.PositionKind="position";e.NormalKind="normal";e.TangentKind="tangent";e.UVKind="uv";e.UV2Kind="uv2";e.UV3Kind="uv3";e.UV4Kind="uv4";e.UV5Kind="uv5";e.UV6Kind="uv6";e.ColorKind="color";e.MatricesIndicesKind="matricesIndices";e.MatricesWeightsKind="matricesWeights";e.MatricesIndicesExtraKind="matricesIndicesExtra";e.MatricesWeightsExtraKind="matricesWeightsExtra";return e})(),nT=(function(){function e(e,t,n,r){this.x=e;this.y=t;this.width=n;this.height=r}e.prototype.toGlobal=function(t,n){return new e(this.x*t,this.y*n,this.width*t,this.height*n)};e.prototype.toGlobalToRef=function(e,t,n){n.x=this.x*e;n.y=this.y*t;n.width=this.width*e;n.height=this.height*t;return this};e.prototype.clone=function(){return new e(this.x,this.y,this.width,this.height)};return e})(),rT=(function(){function e(e,t,n,r){void 0===t&&(t=!1);this.initialize(e,t,n,r)}e.prototype.initialize=function(e,t,n,r){void 0===t&&(t=!1);this.mask=e;this.skipNextObservers=t;this.target=n;this.currentTarget=r;return this};return e})(),iT=function(e,t,n){void 0===n&&(n=null);this.callback=e;this.mask=t;this.scope=n;this._willBeUnregistered=!1;this.unregisterOnNextCall=!1},sT=((function(){function e(){}e.prototype.dispose=function(){if(this._observers&&this._observables)for(var e=0;e<this._observers.length;e++)this._observables[e].remove(this._observers[e]);this._observers=null;this._observables=null};e.Watch=function(t,n,r,i){void 0===r&&(r=-1);void 0===i&&(i=null);var s=new e;s._observers=new Array;s._observables=t;for(var o=0,u=t;o<u.length;o++){var a=u[o].add(n,r,!1,i);a&&s._observers.push(a)}return s}})(),(function(){function e(e){this._observers=new Array;this._eventState=new rT(0);e&&(this._onObserverAdded=e)}e.FromPromise=function(t,n){var r=new e;t.then(function(e){r.notifyObservers(e)}).catch(function(e){if(!n)throw e;n.notifyObservers(e)});return r};Object.defineProperty(e.prototype,"observers",{get:function(){return this._observers},enumerable:!1,configurable:!0});e.prototype.add=function(e,t,n,r,i){void 0===t&&(t=-1);void 0===n&&(n=!1);void 0===r&&(r=null);void 0===i&&(i=!1);if(!e)return null;var s=new iT(e,t,r);s.unregisterOnNextCall=i;n?this._observers.unshift(s):this._observers.push(s);this._onObserverAdded&&this._onObserverAdded(s);return s};e.prototype.addOnce=function(e){return this.add(e,void 0,void 0,void 0,!0)};e.prototype.remove=function(e){if(!e)return!1;if(-1!==this._observers.indexOf(e)){this._deferUnregister(e);return!0}return!1};e.prototype.removeCallback=function(e,t){for(var n=0;n<this._observers.length;n++){var r=this._observers[n];if(!r._willBeUnregistered&&(r.callback===e&&(!t||t===r.scope))){this._deferUnregister(r);return!0}}return!1};e.prototype._deferUnregister=function(e){var t=this;e.unregisterOnNextCall=!1;e._willBeUnregistered=!0;setTimeout(function(){t._remove(e)},0)};e.prototype._remove=function(e){if(!e)return!1;var t=this._observers.indexOf(e);if(-1!==t){this._observers.splice(t,1);return!0}return!1};e.prototype.makeObserverTopPriority=function(e){this._remove(e);this._observers.unshift(e)};e.prototype.makeObserverBottomPriority=function(e){this._remove(e);this._observers.push(e)};e.prototype.notifyObservers=function(e,t,n,r,i){void 0===t&&(t=-1);if(!this._observers.length)return!0;var s=this._eventState;s.mask=t;s.target=n;s.currentTarget=r;s.skipNextObservers=!1;s.lastReturnValue=e;s.userInfo=i;for(var o=0,u=this._observers;o<u.length;o++){var a=u[o];if(!a._willBeUnregistered){if(a.mask&t){a.scope?s.lastReturnValue=a.callback.apply(a.scope,[e,s]):s.lastReturnValue=a.callback(e,s);a.unregisterOnNextCall&&this._deferUnregister(a)}if(s.skipNextObservers)return!1}}return!0};e.prototype.notifyObserversWithPromise=function(e,t,n,r,i){var s=this;void 0===t&&(t=-1);var o=Promise.resolve(e);if(!this._observers.length)return o;var u=this._eventState;u.mask=t;u.target=n;u.currentTarget=r;u.skipNextObservers=!1;u.userInfo=i;this._observers.forEach(function(n){if(!u.skipNextObservers&&!n._willBeUnregistered&&n.mask&t){o=n.scope?o.then(function(t){u.lastReturnValue=t;return n.callback.apply(n.scope,[e,u])}):o.then(function(t){u.lastReturnValue=t;return n.callback(e,u)});n.unregisterOnNextCall&&s._deferUnregister(n)}});return o.then(function(){return e})};e.prototype.notifyObserver=function(e,t,n){void 0===n&&(n=-1);if(!e._willBeUnregistered){var r=this._eventState;r.mask=n;r.skipNextObservers=!1;e.callback(t,r);e.unregisterOnNextCall&&this._deferUnregister(e)}};e.prototype.hasObservers=function(){return this._observers.length>0};e.prototype.clear=function(){this._observers=new Array;this._onObserverAdded=null};e.prototype.clone=function(){var t=new e;t._observers=this._observers.slice(0);return t};e.prototype.hasSpecificMask=function(e){void 0===e&&(e=-1);for(var t=0,n=this._observers;t<n.length;t++){var r=n[t];if(r.mask&e||r.mask===e)return!0}return!1};return e})());function oT(){return"undefined"!=typeof window}function uT(){return"undefined"!=typeof navigator}function aT(e){for(var t="",n=e.firstChild;n;){3===n.nodeType&&(t+=n.textContent);n=n.nextSibling}return t}var fT,lT={IsWindowObjectExist:oT,IsNavigatorAvailable:uT,IsDocumentAvailable:function(){return"undefined"!=typeof document},GetDOMTextContent:aT},cT=(function(){function e(){}e._CheckLimit=function(t,n){var r=e._LogLimitOutputs[t];if(r)r.current++;else{r={limit:n,current:1};e._LogLimitOutputs[t]=r}return r.current<=r.limit};e._GenerateLimitMessage=function(t,n){var r=e._LogLimitOutputs[t];if(r&&e.MessageLimitReached&&r.current===r.limit)switch(n){case 0:e.Log(e.MessageLimitReached.replace(/%LIMIT%/g,""+r.limit).replace(/%TYPE%/g,"log"));break;case 1:e.Warn(e.MessageLimitReached.replace(/%LIMIT%/g,""+r.limit).replace(/%TYPE%/g,"warning"));break;case 2:e.Error(e.MessageLimitReached.replace(/%LIMIT%/g,""+r.limit).replace(/%TYPE%/g,"error"))}};e._AddLogEntry=function(t){e._LogCache=t+e._LogCache;e.OnNewCacheEntry&&e.OnNewCacheEntry(t)};e._FormatMessage=function(e){var t=function(e){return e<10?"0"+e:""+e},n=new Date;return"["+t(n.getHours())+":"+t(n.getMinutes())+":"+t(n.getSeconds())+"]: "+e};e._LogDisabled=function(e,t){};e._LogEnabled=function(t,n){if(void 0===n||e._CheckLimit(t,n)){var r=e._FormatMessage(t);console.log("BJS - "+r);var i="<div style='color:white'>"+r+"</div><br>";e._AddLogEntry(i);e._GenerateLimitMessage(t,0)}};e._WarnDisabled=function(e,t){};e._WarnEnabled=function(t,n){if(void 0===n||e._CheckLimit(t,n)){var r=e._FormatMessage(t);console.warn("BJS - "+r);var i="<div style='color:orange'>"+t+"</div><br>";e._AddLogEntry(i);e._GenerateLimitMessage(t,1)}};e._ErrorDisabled=function(e,t){};e._ErrorEnabled=function(t,n){if(void 0===n||e._CheckLimit(t,n)){var r=e._FormatMessage(t);e.errorsCount++;console.error("BJS - "+r);var i="<div style='color:red'>"+r+"</div><br>";e._AddLogEntry(i);e._GenerateLimitMessage(t,2)}};Object.defineProperty(e,"LogCache",{get:function(){return e._LogCache},enumerable:!1,configurable:!0});e.ClearLogCache=function(){e._LogCache="";e._LogLimitOutputs={};e.errorsCount=0};Object.defineProperty(e,"LogLevels",{set:function(t){(t&e.MessageLogLevel)===e.MessageLogLevel?e.Log=e._LogEnabled:e.Log=e._LogDisabled;(t&e.WarningLogLevel)===e.WarningLogLevel?e.Warn=e._WarnEnabled:e.Warn=e._WarnDisabled;(t&e.ErrorLogLevel)===e.ErrorLogLevel?e.Error=e._ErrorEnabled:e.Error=e._ErrorDisabled},enumerable:!1,configurable:!0});e.NoneLogLevel=0;e.MessageLogLevel=1;e.WarningLogLevel=2;e.ErrorLogLevel=4;e.AllLogLevel=7;e.MessageLimitReached="Too many %TYPE%s (%LIMIT%), no more %TYPE%s will be reported for this message.";e._LogCache="";e._LogLimitOutputs={};e.errorsCount=0;e.Log=e._LogEnabled;e.Warn=e._WarnEnabled;e.Error=e._ErrorEnabled;return e})(),hT=function(e,t){return-1!==e.indexOf(t,e.length-t.length)},pT=function(e,t){return!!e&&0===e.indexOf(t)},dT=function(e){for(var t,n,r,i,s,o,u,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",f="",l=0,c=ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e);l<c.length;){i=(t=c[l++])>>2;s=(3&t)<<4|(n=l<c.length?c[l++]:Number.NaN)>>4;o=(15&n)<<2|(r=l<c.length?c[l++]:Number.NaN)>>6;u=63&r;isNaN(n)?o=u=64:isNaN(r)&&(u=64);f+=a.charAt(i)+a.charAt(s)+a.charAt(o)+a.charAt(u)}return f},vT=function(e){return atob(e)},mT=function(e){for(var t=vT(e),n=t.length,r=new Uint8Array(new ArrayBuffer(n)),i=0;i<n;i++)r[i]=t.charCodeAt(i);return r.buffer},gT=(function(){function e(){this.children=[]}e.prototype.isValid=function(e){return!0};e.prototype.process=function(e,t){var n="";if(this.line){var r=this.line,i=t.processor;if(i){i.lineProcessor&&(r=i.lineProcessor(r,t.isFragment,t.processingContext));if(i.attributeProcessor&&pT(this.line,"attribute"))r=i.attributeProcessor(this.line,e,t.processingContext);else if(i.varyingProcessor&&pT(this.line,"varying"))r=i.varyingProcessor(this.line,t.isFragment,e,t.processingContext);else if(i.uniformProcessor&&i.uniformRegexp&&i.uniformRegexp.test(this.line))t.lookForClosingBracketForUniformBuffer||(r=i.uniformProcessor(this.line,t.isFragment,e,t.processingContext));else if(i.uniformBufferProcessor&&i.uniformBufferRegexp&&i.uniformBufferRegexp.test(this.line)){if(!t.lookForClosingBracketForUniformBuffer){r=i.uniformBufferProcessor(this.line,t.isFragment,t.processingContext);t.lookForClosingBracketForUniformBuffer=!0}}else if(i.textureProcessor&&i.textureRegexp&&i.textureRegexp.test(this.line))r=i.textureProcessor(this.line,t.isFragment,e,t.processingContext);else if((i.uniformProcessor||i.uniformBufferProcessor)&&pT(this.line,"uniform")&&!t.lookForClosingBracketForUniformBuffer){if(/uniform\s+(?:(?:highp)?|(?:lowp)?)\s*(\S+)\s+(\S+)\s*;/.test(this.line))i.uniformProcessor&&(r=i.uniformProcessor(this.line,t.isFragment,e,t.processingContext));else if(i.uniformBufferProcessor){r=i.uniformBufferProcessor(this.line,t.isFragment,t.processingContext);t.lookForClosingBracketForUniformBuffer=!0}}if(t.lookForClosingBracketForUniformBuffer&&-1!==this.line.indexOf("}")){t.lookForClosingBracketForUniformBuffer=!1;i.endOfUniformBufferProcessor&&(r=i.endOfUniformBufferProcessor(this.line,t.isFragment,t.processingContext))}}n+=r+"\r\n"}this.children.forEach(function(r){n+=r.process(e,t)});this.additionalDefineKey&&(e[this.additionalDefineKey]=this.additionalDefineValue||"true");return n};return e})(),yT=(function(){function e(){}Object.defineProperty(e.prototype,"currentLine",{get:function(){return this._lines[this.lineIndex]},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"canRead",{get:function(){return this.lineIndex<this._lines.length-1},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"lines",{set:function(e){this._lines=[];for(var t=0,n=e;t<n.length;t++){var r=n[t];if("#"!==r[0])for(var i=r.split(";"),s=0;s<i.length;s++){var o=i[s];(o=o.trim())&&this._lines.push(o+(s!==i.length-1?";":""))}else this._lines.push(r)}},enumerable:!1,configurable:!0});return e})(),bT=(function(e){Jx(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.process=function(e,t){for(var n=0;n<this.children.length;n++){var r=this.children[n];if(r.isValid(e))return r.process(e,t)}return""};return t})(gT),wT=(function(e){Jx(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.isValid=function(e){return this.testExpression.isTrue(e)};return t})(gT),ET=(function(){function e(){}e.prototype.isTrue=function(e){return!0};e.postfixToInfix=function(t){for(var n=[],r=0,i=t;r<i.length;r++){var s=i[r];if(void 0===e._OperatorPriority[s])n.push(s);else{var o=n[n.length-1],u=n[n.length-2];n.length-=2;n.push("("+u+s+o+")")}}return n[n.length-1]};e.infixToPostfix=function(t){for(var n=[],r=-1,i=function(){if(""!==(f=f.trim())){n.push(f);f=""}},s=function(t){r<e._Stack.length-1&&(e._Stack[++r]=t)},o=function(){return e._Stack[r]},u=function(){return-1===r?"!!INVALID EXPRESSION!!":e._Stack[r--]},a=0,f="";a<t.length;){var l=t.charAt(a),c=a<t.length-1?t.substr(a,2):"";if("("===l){f="";s(l)}else if(")"===l){i();for(;-1!==r&&"("!==o();)n.push(u());u()}else if(e._OperatorPriority[c]>1){i();for(;-1!==r&&e._OperatorPriority[o()]>=e._OperatorPriority[c];)n.push(u());s(c);a++}else f+=l;a++}i();for(;-1!==r;)"("===o()?u():n.push(u());return n};e._OperatorPriority={")":0,"(":1,"||":2,"&&":3};e._Stack=["","","","","","","","","","","","","","","","","","","",""];return e})(),ST=(function(e){Jx(t,e);function t(t,n){void 0===n&&(n=!1);var r=e.call(this)||this;r.define=t;r.not=n;return r}t.prototype.isTrue=function(e){var t=void 0!==e[this.define];this.not&&(t=!t);return t};return t})(ET),xT=(function(e){Jx(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.isTrue=function(e){return this.leftOperand.isTrue(e)||this.rightOperand.isTrue(e)};return t})(ET),TT=(function(e){Jx(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.isTrue=function(e){return this.leftOperand.isTrue(e)&&this.rightOperand.isTrue(e)};return t})(ET),NT=(function(e){Jx(t,e);function t(t,n,r){var i=e.call(this)||this;i.define=t;i.operand=n;i.testValue=r;return i}t.prototype.isTrue=function(e){var t=e[this.define];void 0===t&&(t=this.define);var n=!1,r=parseInt(t),i=parseInt(this.testValue);switch(this.operand){case">":n=r>i;break;case"<":n=r<i;break;case"<=":n=r<=i;break;case">=":n=r>=i;break;case"==":n=r===i}return n};return t})(ET);function CT(e){return e+" needs to be imported before as it contains a side-effect required by your code."}(function(e){e[e.GLSL=0]="GLSL";e[e.WGSL=1]="WGSL"})(fT||(fT={}));var kT=/defined\s*?\((.+?)\)/g,LT=/defined\s*?\[(.+?)\]/g,AT=(function(){function e(){}e.Initialize=function(e){e.processor&&e.processor.initializeShaders&&e.processor.initializeShaders(e.processingContext)};e.Process=function(e,t,n,r){var i,s=this;(null===(i=t.processor)||void 0===i?void 0:i.preProcessShaderCode)&&(e=t.processor.preProcessShaderCode(e));this._ProcessIncludes(e,t,function(e){var i=s._ProcessShaderConversion(e,t,r);n(i)})};e.PreProcess=function(e,t,n,r){var i,s=this;(null===(i=t.processor)||void 0===i?void 0:i.preProcessShaderCode)&&(e=t.processor.preProcessShaderCode(e));this._ProcessIncludes(e,t,function(e){var i=s._ApplyPreProcessing(e,t,r);n(i)})};e.Finalize=function(e,t,n){return n.processor&&n.processor.finalizeShaders?n.processor.finalizeShaders(e,t,n.processingContext):{vertexCode:e,fragmentCode:t}};e._ProcessPrecision=function(e,t){var n;if(null===(n=t.processor)||void 0===n?void 0:n.noPrecision)return e;var r=t.shouldUseHighPrecisionShader;-1===e.indexOf("precision highp float")?e=r?"precision highp float;\n"+e:"precision mediump float;\n"+e:r||(e=e.replace("precision highp float","precision mediump float"));return e};e._ExtractOperation=function(e){var t=/defined\((.+)\)/.exec(e);if(t&&t.length)return new ST(t[1].trim(),"!"===e[0]);for(var n="",r=0,i=0,s=["==",">=","<=","<",">"];i<s.length;i++){n=s[i];if((r=e.indexOf(n))>-1)break}if(-1===r)return new ST(e);var o=e.substring(0,r).trim(),u=e.substring(r+n.length).trim();return new NT(o,n,u)};e._BuildSubExpression=function(e){e=e.replace(kT,"defined[$1]");for(var t=[],n=0,r=ET.infixToPostfix(e);n<r.length;n++){var i=r[n];if("||"!==i&&"&&"!==i)t.push(i);else if(t.length>=2){var s=t[t.length-1],o=t[t.length-2];t.length-=2;var u="&&"==i?new TT:new xT;"string"==typeof s&&(s=s.replace(LT,"defined($1)"));"string"==typeof o&&(o=o.replace(LT,"defined($1)"));u.leftOperand="string"==typeof o?this._ExtractOperation(o):o;u.rightOperand="string"==typeof s?this._ExtractOperation(s):s;t.push(u)}}var a=t[t.length-1];"string"==typeof a&&(a=a.replace(LT,"defined($1)"));return"string"==typeof a?this._ExtractOperation(a):a};e._BuildExpression=function(e,t){var n=new wT,r=e.substring(0,t),i=e.substring(t);i=i.substring(0,(i.indexOf("//")+1||i.length+1)-1).trim();n.testExpression="#ifdef"===r?new ST(i):"#ifndef"===r?new ST(i,!0):this._BuildSubExpression(i);return n};e._MoveCursorWithinIf=function(e,t,n){for(var r=e.currentLine;this._MoveCursor(e,n);){var i=(r=e.currentLine).substring(0,5).toLowerCase();if("#else"===i){var s=new gT;t.children.push(s);this._MoveCursor(e,s);return}if("#elif"===i){var o=this._BuildExpression(r,5);t.children.push(o);n=o}}};e._MoveCursor=function(e,t){for(;e.canRead;){e.lineIndex++;var n=e.currentLine,r=/(#ifdef)|(#else)|(#elif)|(#endif)|(#ifndef)|(#if)/.exec(n);if(r&&r.length){switch(r[0]){case"#ifdef":var i=new bT;t.children.push(i);var s=this._BuildExpression(n,6);i.children.push(s);this._MoveCursorWithinIf(e,i,s);break;case"#else":case"#elif":return!0;case"#endif":return!1;case"#ifndef":i=new bT;t.children.push(i);s=this._BuildExpression(n,7);i.children.push(s);this._MoveCursorWithinIf(e,i,s);break;case"#if":i=new bT,s=this._BuildExpression(n,3);t.children.push(i);i.children.push(s);this._MoveCursorWithinIf(e,i,s)}}else{var o=new gT;o.line=n;t.children.push(o);if("#"===n[0]&&"d"===n[1]){var u=n.replace(";","").split(" ");o.additionalDefineKey=u[1];3===u.length&&(o.additionalDefineValue=u[2])}}}return!1};e._EvaluatePreProcessors=function(e,t,n){var r=new gT,i=new yT;i.lineIndex=-1;i.lines=e.split("\n");this._MoveCursor(i,r);return r.process(t,n)};e._PreparePreProcessors=function(e,t){for(var n,r={},i=0,s=e.defines;i<s.length;i++){var o=s[i].replace("#define","").replace(";","").trim().split(" ");r[o[0]]=o.length>1?o[1]:""}(null===(n=e.processor)||void 0===n?void 0:n.shaderLanguage)===fT.GLSL&&(r.GL_ES="true");r.__VERSION__=e.version;r[e.platformName]="true";t._getGlobalDefines(r);return r};e._ProcessShaderConversion=function(e,t,n){var r=this._ProcessPrecision(e,t);if(!t.processor)return r;if(t.processor.shaderLanguage===fT.GLSL&&-1!==r.indexOf("#version 3"))return r.replace("#version 300 es","");var i=t.defines,s=this._PreparePreProcessors(t,n);t.processor.preProcessor&&(r=t.processor.preProcessor(r,i,t.isFragment,t.processingContext));r=this._EvaluatePreProcessors(r,s,t);t.processor.postProcessor&&(r=t.processor.postProcessor(r,i,t.isFragment,t.processingContext,n));n._features.needShaderCodeInlining&&(r=n.inlineShaderCode(r));return r};e._ApplyPreProcessing=function(e,t,n){var r,i,s=e,o=t.defines,u=this._PreparePreProcessors(t,n);(null===(r=t.processor)||void 0===r?void 0:r.preProcessor)&&(s=t.processor.preProcessor(s,o,t.isFragment,t.processingContext));s=this._EvaluatePreProcessors(s,u,t);(null===(i=t.processor)||void 0===i?void 0:i.postProcessor)&&(s=t.processor.postProcessor(s,o,t.isFragment,t.processingContext,n));n._features.needShaderCodeInlining&&(s=n.inlineShaderCode(s));return s};e._ProcessIncludes=function(t,n,r){for(var i=this,s=/#include\s?<(.+)>(\((.*)\))*(\[(.*)\])*/g,o=s.exec(t),u=new String(t),a=!1;null!=o;){var f=o[1];if(-1!==f.indexOf("__decl__")){f=f.replace(/__decl__/,"");n.supportsUniformBuffers&&(f=(f=f.replace(/Vertex/,"Ubo")).replace(/Fragment/,"Ubo"));f+="Declaration"}if(!n.includesShadersStore[f]){var l=n.shadersRepository+"ShadersInclude/"+f+".fx";e._FileToolsLoadFile(l,function(e){n.includesShadersStore[f]=e;i._ProcessIncludes(u,n,r)});return}var c=n.includesShadersStore[f];if(o[2])for(var h=o[3].split(","),p=0;p<h.length;p+=2){var d=new RegExp(h[p],"g"),v=h[p+1];c=c.replace(d,v)}if(o[4]){var m=o[5];if(-1!==m.indexOf("..")){var g=m.split(".."),y=parseInt(g[0]),b=parseInt(g[1]),w=c.slice(0);c="";isNaN(b)&&(b=n.indexParameters[g[1]]);for(var E=y;E<b;E++){n.supportsUniformBuffers||(w=w.replace(/light\{X\}.(\w*)/g,function(e,t){return t+"{X}"}));c+=w.replace(/\{X\}/g,E.toString())+"\n"}}else{n.supportsUniformBuffers||(c=c.replace(/light\{X\}.(\w*)/g,function(e,t){return t+"{X}"}));c=c.replace(/\{X\}/g,m)}}u=u.replace(o[0],c);a=a||c.indexOf("#include<")>=0||c.indexOf("#include <")>=0;o=s.exec(t)}a?this._ProcessIncludes(u.toString(),n,r):r(u)};e._FileToolsLoadFile=function(e,t,n,r,i,s){throw CT("FileTools")};return e})(),OT=(function(){function e(){}e.GetShadersRepository=function(t){void 0===t&&(t=fT.GLSL);return t===fT.GLSL?e.ShadersRepository:e.ShadersRepositoryWGSL};e.GetShadersStore=function(t){void 0===t&&(t=fT.GLSL);return t===fT.GLSL?e.ShadersStore:e.ShadersStoreWGSL};e.GetIncludesShadersStore=function(t){void 0===t&&(t=fT.GLSL);return t===fT.GLSL?e.IncludesShadersStore:e.IncludesShadersStoreWGSL};e.ShadersRepository="src/Shaders/";e.ShadersStore={};e.IncludesShadersStore={};e.ShadersRepositoryWGSL="src/ShadersWGSL/";e.ShadersStoreWGSL={};e.IncludesShadersStoreWGSL={};return e})(),MT=(function(){function e(t,n,r,i,s,o,u,a,f,l,c,h){var p,d,v=this;void 0===i&&(i=null);void 0===o&&(o=null);void 0===u&&(u=null);void 0===a&&(a=null);void 0===f&&(f=null);void 0===c&&(c="");void 0===h&&(h=fT.GLSL);this.name=null;this.defines="";this.onCompiled=null;this.onError=null;this.onBind=null;this.uniqueId=0;this.onCompileObservable=new sT;this.onErrorObservable=new sT;this._onBindObservable=null;this._wasPreviouslyReady=!1;this._bonesComputationForcedToCPU=!1;this._uniformBuffersNames={};this._multiTarget=!1;this._samplers={};this._isReady=!1;this._compilationError="";this._allFallbacksProcessed=!1;this._uniforms={};this._key="";this._fallbacks=null;this._vertexSourceCodeOverride="";this._fragmentSourceCodeOverride="";this._transformFeedbackVaryings=null;this._pipelineContext=null;this._vertexSourceCode="";this._fragmentSourceCode="";this._rawVertexSourceCode="";this._rawFragmentSourceCode="";this.name=t;this._key=c;var m,g,y=null;if(n.attributes){var b=n;this._engine=r;this._attributesNames=b.attributes;this._uniformsNames=b.uniformsNames.concat(b.samplers);this._samplerList=b.samplers.slice();this.defines=b.defines;this.onError=b.onError;this.onCompiled=b.onCompiled;this._fallbacks=b.fallbacks;this._indexParameters=b.indexParameters;this._transformFeedbackVaryings=b.transformFeedbackVaryings||null;this._multiTarget=!!b.multiTarget;this._shaderLanguage=null!==(p=b.shaderLanguage)&&void 0!==p?p:fT.GLSL;if(b.uniformBuffersNames){this._uniformBuffersNamesList=b.uniformBuffersNames.slice();for(var w=0;w<b.uniformBuffersNames.length;w++)this._uniformBuffersNames[b.uniformBuffersNames[w]]=w}y=null!==(d=b.processFinalCode)&&void 0!==d?d:null}else{this._engine=s;this.defines=null==o?"":o;this._uniformsNames=r.concat(i);this._samplerList=i?i.slice():[];this._attributesNames=n;this._uniformBuffersNamesList=[];this._shaderLanguage=h;this.onError=f;this.onCompiled=a;this._indexParameters=l;this._fallbacks=u}this._attributeLocationByName={};this.uniqueId=e._uniqueIdSeed++;var E=oT()?this._engine.getHostDocument():null;t.vertexSource?m="source:"+t.vertexSource:t.vertexElement?(m=E?E.getElementById(t.vertexElement):null)||(m=t.vertexElement):m=t.vertex||t;t.fragmentSource?g="source:"+t.fragmentSource:t.fragmentElement?(g=E?E.getElementById(t.fragmentElement):null)||(g=t.fragmentElement):g=t.fragment||t;this._processingContext=this._engine._getShaderProcessingContext(this._shaderLanguage);var S={defines:this.defines.split("\n"),indexParameters:this._indexParameters,isFragment:!1,shouldUseHighPrecisionShader:this._engine._shouldUseHighPrecisionShader,processor:this._engine._getShaderProcessor(this._shaderLanguage),supportsUniformBuffers:this._engine.supportsUniformBuffers,shadersRepository:OT.GetShadersRepository(this._shaderLanguage),includesShadersStore:OT.GetIncludesShadersStore(this._shaderLanguage),version:(100*this._engine.version).toString(),platformName:this._engine.shaderPlatformName,processingContext:this._processingContext,isNDCHalfZRange:this._engine.isNDCHalfZRange,useReverseDepthBuffer:this._engine.useReverseDepthBuffer},x=[void 0,void 0],T=function(){if(x[0]&&x[1]){S.isFragment=!0;var e=x[0],n=x[1];AT.Process(n,S,function(n){y&&(n=y("fragment",n));var r=AT.Finalize(e,n,S);v._useFinalCode(r.vertexCode,r.fragmentCode,t)},v._engine)}};this._loadShader(m,"Vertex","",function(e){AT.Initialize(S);AT.Process(e,S,function(t){v._rawVertexSourceCode=e;y&&(t=y("vertex",t));x[0]=t;T()},v._engine)});this._loadShader(g,"Fragment","Pixel",function(e){v._rawFragmentSourceCode=e;x[1]=e;T()})}Object.defineProperty(e,"ShadersRepository",{get:function(){return OT.ShadersRepository},set:function(e){OT.ShadersRepository=e},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"onBindObservable",{get:function(){this._onBindObservable||(this._onBindObservable=new sT);return this._onBindObservable},enumerable:!1,configurable:!0});e.prototype._useFinalCode=function(e,t,n){if(n){var r=n.vertexElement||n.vertex||n.spectorName||n,i=n.fragmentElement||n.fragment||n.spectorName||n;this._vertexSourceCode=(this._shaderLanguage===fT.WGSL?"//":"")+"#define SHADER_NAME vertex:"+r+"\n"+e;this._fragmentSourceCode=(this._shaderLanguage===fT.WGSL?"//":"")+"#define SHADER_NAME fragment:"+i+"\n"+t}else{this._vertexSourceCode=e;this._fragmentSourceCode=t}this._prepareEffect()};Object.defineProperty(e.prototype,"key",{get:function(){return this._key},enumerable:!1,configurable:!0});e.prototype.isReady=function(){try{return this._isReadyInternal()}catch(e){return!1}};e.prototype._isReadyInternal=function(){return!!this._isReady||!!this._pipelineContext&&this._pipelineContext.isReady};e.prototype.getEngine=function(){return this._engine};e.prototype.getPipelineContext=function(){return this._pipelineContext};e.prototype.getAttributesNames=function(){return this._attributesNames};e.prototype.getAttributeLocation=function(e){return this._attributes[e]};e.prototype.getAttributeLocationByName=function(e){return this._attributeLocationByName[e]};e.prototype.getAttributesCount=function(){return this._attributes.length};e.prototype.getUniformIndex=function(e){return this._uniformsNames.indexOf(e)};e.prototype.getUniform=function(e){return this._uniforms[e]};e.prototype.getSamplers=function(){return this._samplerList};e.prototype.getUniformNames=function(){return this._uniformsNames};e.prototype.getUniformBuffersNames=function(){return this._uniformBuffersNamesList};e.prototype.getIndexParameters=function(){return this._indexParameters};e.prototype.getCompilationError=function(){return this._compilationError};e.prototype.allFallbacksProcessed=function(){return this._allFallbacksProcessed};e.prototype.executeWhenCompiled=function(e){var t=this;if(this.isReady())e(this);else{this.onCompileObservable.add(function(t){e(t)});this._pipelineContext&&!this._pipelineContext.isAsync||setTimeout(function(){t._checkIsReady(null)},16)}};e.prototype._checkIsReady=function(e){var t=this;try{if(this._isReadyInternal())return}catch(t){this._processCompilationErrors(t,e);return}setTimeout(function(){t._checkIsReady(e)},16)};e.prototype._loadShader=function(e,t,n,r){if("undefined"!=typeof HTMLElement&&e instanceof HTMLElement){r(aT(e))}else if("source:"!==e.substr(0,7))if("base64:"!==e.substr(0,7)){var i=OT.GetShadersStore(this._shaderLanguage);if(i[e+t+"Shader"])r(i[e+t+"Shader"]);else if(n&&i[e+n+"Shader"])r(i[e+n+"Shader"]);else{var s;s="."===e[0]||"/"===e[0]||e.indexOf("http")>-1?e:OT.GetShadersRepository(this._shaderLanguage)+e;this._engine._loadFile(s+"."+t.toLowerCase()+".fx",r)}}else{r(window.atob(e.substr(7)))}else r(e.substr(7))};Object.defineProperty(e.prototype,"vertexSourceCode",{get:function(){var e,t;return this._vertexSourceCodeOverride&&this._fragmentSourceCodeOverride?this._vertexSourceCodeOverride:null!==(t=null===(e=this._pipelineContext)||void 0===e?void 0:e._getVertexShaderCode())&&void 0!==t?t:this._vertexSourceCode},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"fragmentSourceCode",{get:function(){var e,t;return this._vertexSourceCodeOverride&&this._fragmentSourceCodeOverride?this._fragmentSourceCodeOverride:null!==(t=null===(e=this._pipelineContext)||void 0===e?void 0:e._getFragmentShaderCode())&&void 0!==t?t:this._fragmentSourceCode},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"rawVertexSourceCode",{get:function(){return this._rawVertexSourceCode},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"rawFragmentSourceCode",{get:function(){return this._rawFragmentSourceCode},enumerable:!1,configurable:!0});e.prototype._rebuildProgram=function(e,t,n,r){var i=this;this._isReady=!1;this._vertexSourceCodeOverride=e;this._fragmentSourceCodeOverride=t;this.onError=function(e,t){r&&r(t)};this.onCompiled=function(){var e=i.getEngine().scenes;if(e)for(var t=0;t<e.length;t++)e[t].markAllMaterialsAsDirty(63);i._pipelineContext._handlesSpectorRebuildCallback(n)};this._fallbacks=null;this._prepareEffect()};e.prototype._prepareEffect=function(){var e=this,t=this._attributesNames,n=this.defines,r=this._pipelineContext;this._isReady=!1;try{var i=this._engine;this._pipelineContext=i.createPipelineContext(this._processingContext);this._pipelineContext._name=this._key;var s=this._rebuildProgram.bind(this);this._vertexSourceCodeOverride&&this._fragmentSourceCodeOverride?i._preparePipelineContext(this._pipelineContext,this._vertexSourceCodeOverride,this._fragmentSourceCodeOverride,!0,this._rawVertexSourceCode,this._rawFragmentSourceCode,s,null,this._transformFeedbackVaryings,this._key):i._preparePipelineContext(this._pipelineContext,this._vertexSourceCode,this._fragmentSourceCode,!1,this._rawVertexSourceCode,this._rawFragmentSourceCode,s,n,this._transformFeedbackVaryings,this._key);i._executeWhenRenderingStateIsCompiled(this._pipelineContext,function(){e._attributes=[];e._pipelineContext._fillEffectInformation(e,e._uniformBuffersNames,e._uniformsNames,e._uniforms,e._samplerList,e._samplers,t,e._attributes);if(t)for(var n=0;n<t.length;n++){var s=t[n];e._attributeLocationByName[s]=e._attributes[n]}i.bindSamplers(e);e._compilationError="";e._isReady=!0;e.onCompiled&&e.onCompiled(e);e.onCompileObservable.notifyObservers(e);e.onCompileObservable.clear();e._fallbacks&&e._fallbacks.unBindMesh();r&&e.getEngine()._deletePipelineContext(r)});this._pipelineContext.isAsync&&this._checkIsReady(r)}catch(e){this._processCompilationErrors(e,r)}};e.prototype._getShaderCodeAndErrorLine=function(e,t,n){var r=n?/FRAGMENT SHADER ERROR: 0:(\d+?):/:/VERTEX SHADER ERROR: 0:(\d+?):/,i=null;if(t&&e){var s=t.match(r);if(s&&2===s.length){var o=parseInt(s[1]),u=e.split("\n",-1);u.length>=o&&(i="Offending line ["+o+"] in "+(n?"fragment":"vertex")+" code: "+u[o-1])}}return[e,i]};e.prototype._processCompilationErrors=function(t,n){var r,i,s,o,u;void 0===n&&(n=null);this._compilationError=t.message;var a=this._attributesNames,f=this._fallbacks;cT.Error("Unable to compile effect:");cT.Error("Uniforms: "+this._uniformsNames.map(function(e){return" "+e}));cT.Error("Attributes: "+a.map(function(e){return" "+e}));cT.Error("Defines:\r\n"+this.defines);if(e.LogShaderCodeOnCompilationError){var l=null,c=null,h=null;if(null===(s=this._pipelineContext)||void 0===s?void 0:s._getVertexShaderCode()){h=(r=this._getShaderCodeAndErrorLine(this._pipelineContext._getVertexShaderCode(),this._compilationError,!1))[0],l=r[1];if(h){cT.Error("Vertex code:");cT.Error(h)}}if(null===(o=this._pipelineContext)||void 0===o?void 0:o._getFragmentShaderCode()){h=(i=this._getShaderCodeAndErrorLine(null===(u=this._pipelineContext)||void 0===u?void 0:u._getFragmentShaderCode(),this._compilationError,!0))[0],c=i[1];if(h){cT.Error("Fragment code:");cT.Error(h)}}l&&cT.Error(l);c&&cT.Error(c)}cT.Error("Error: "+this._compilationError);if(n){this._pipelineContext=n;this._isReady=!0;this.onError&&this.onError(this,this._compilationError);this.onErrorObservable.notifyObservers(this)}if(f){this._pipelineContext=null;if(f.hasMoreFallbacks){this._allFallbacksProcessed=!1;cT.Error("Trying next fallback.");this.defines=f.reduce(this.defines,this);this._prepareEffect()}else{this._allFallbacksProcessed=!0;this.onError&&this.onError(this,this._compilationError);this.onErrorObservable.notifyObservers(this);this.onErrorObservable.clear();this._fallbacks&&this._fallbacks.unBindMesh()}}else this._allFallbacksProcessed=!0};Object.defineProperty(e.prototype,"isSupported",{get:function(){return""===this._compilationError},enumerable:!1,configurable:!0});e.prototype._bindTexture=function(e,t){this._engine._bindTexture(this._samplers[e],t,e)};e.prototype.setTexture=function(e,t){this._engine.setTexture(this._samplers[e],this._uniforms[e],t,e)};e.prototype.setDepthStencilTexture=function(e,t){this._engine.setDepthStencilTexture(this._samplers[e],this._uniforms[e],t,e)};e.prototype.setTextureArray=function(e,t){var n=e+"Ex";if(-1===this._samplerList.indexOf(n+"0")){for(var r=this._samplerList.indexOf(e),i=1;i<t.length;i++){var s=n+(i-1).toString();this._samplerList.splice(r+i,0,s)}for(var o=0,u=0,a=this._samplerList;u<a.length;u++){var f=a[u];this._samplers[f]=o;o+=1}}this._engine.setTextureArray(this._samplers[e],this._uniforms[e],t,e)};e.prototype.setTextureFromPostProcess=function(e,t){this._engine.setTextureFromPostProcess(this._samplers[e],t,e)};e.prototype.setTextureFromPostProcessOutput=function(e,t){this._engine.setTextureFromPostProcessOutput(this._samplers[e],t,e)};e.prototype.bindUniformBuffer=function(t,n){var r=this._uniformBuffersNames[n];if(!(void 0===r||e._baseCache[r]===t&&this._engine._features.useUBOBindingCache)){e._baseCache[r]=t;this._engine.bindUniformBufferBase(t,r,n)}};e.prototype.bindUniformBlock=function(e,t){this._engine.bindUniformBlock(this._pipelineContext,e,t)};e.prototype.setInt=function(e,t){this._pipelineContext.setInt(e,t);return this};e.prototype.setInt2=function(e,t,n){this._pipelineContext.setInt2(e,t,n);return this};e.prototype.setInt3=function(e,t,n,r){this._pipelineContext.setInt3(e,t,n,r);return this};e.prototype.setInt4=function(e,t,n,r,i){this._pipelineContext.setInt4(e,t,n,r,i);return this};e.prototype.setIntArray=function(e,t){this._pipelineContext.setIntArray(e,t);return this};e.prototype.setIntArray2=function(e,t){this._pipelineContext.setIntArray2(e,t);return this};e.prototype.setIntArray3=function(e,t){this._pipelineContext.setIntArray3(e,t);return this};e.prototype.setIntArray4=function(e,t){this._pipelineContext.setIntArray4(e,t);return this};e.prototype.setFloatArray=function(e,t){this._pipelineContext.setArray(e,t);return this};e.prototype.setFloatArray2=function(e,t){this._pipelineContext.setArray2(e,t);return this};e.prototype.setFloatArray3=function(e,t){this._pipelineContext.setArray3(e,t);return this};e.prototype.setFloatArray4=function(e,t){this._pipelineContext.setArray4(e,t);return this};e.prototype.setArray=function(e,t){this._pipelineContext.setArray(e,t);return this};e.prototype.setArray2=function(e,t){this._pipelineContext.setArray2(e,t);return this};e.prototype.setArray3=function(e,t){this._pipelineContext.setArray3(e,t);return this};e.prototype.setArray4=function(e,t){this._pipelineContext.setArray4(e,t);return this};e.prototype.setMatrices=function(e,t){this._pipelineContext.setMatrices(e,t);return this};e.prototype.setMatrix=function(e,t){this._pipelineContext.setMatrix(e,t);return this};e.prototype.setMatrix3x3=function(e,t){this._pipelineContext.setMatrix3x3(e,t);return this};e.prototype.setMatrix2x2=function(e,t){this._pipelineContext.setMatrix2x2(e,t);return this};e.prototype.setFloat=function(e,t){this._pipelineContext.setFloat(e,t);return this};e.prototype.setBool=function(e,t){this._pipelineContext.setInt(e,t?1:0);return this};e.prototype.setVector2=function(e,t){this._pipelineContext.setVector2(e,t);return this};e.prototype.setFloat2=function(e,t,n){this._pipelineContext.setFloat2(e,t,n);return this};e.prototype.setVector3=function(e,t){this._pipelineContext.setVector3(e,t);return this};e.prototype.setFloat3=function(e,t,n,r){this._pipelineContext.setFloat3(e,t,n,r);return this};e.prototype.setVector4=function(e,t){this._pipelineContext.setVector4(e,t);return this};e.prototype.setFloat4=function(e,t,n,r,i){this._pipelineContext.setFloat4(e,t,n,r,i);return this};e.prototype.setColor3=function(e,t){this._pipelineContext.setColor3(e,t);return this};e.prototype.setColor4=function(e,t,n){this._pipelineContext.setColor4(e,t,n);return this};e.prototype.setDirectColor4=function(e,t){this._pipelineContext.setDirectColor4(e,t);return this};e.prototype.dispose=function(){this._pipelineContext&&this._pipelineContext.dispose();this._engine._releaseEffect(this)};e.RegisterShader=function(e,t,n,r){void 0===r&&(r=fT.GLSL);t&&(OT.GetShadersStore(r)[e+"PixelShader"]=t);n&&(OT.GetShadersStore(r)[e+"VertexShader"]=n)};e.ResetCache=function(){e._baseCache={}};e.LogShaderCodeOnCompilationError=!0;e._uniqueIdSeed=0;e._baseCache={};e.ShadersStore=OT.ShadersStore;e.IncludesShadersStore=OT.IncludesShadersStore;return e})(),_T=(function(){function e(e,t){void 0===t&&(t=!0);this.effect=null;this.defines=null;this.drawContext=e.createDrawContext();t&&(this.materialContext=e.createMaterialContext())}e.IsWrapper=function(e){return void 0===e.getPipelineContext};e.GetEffect=function(e){return void 0===e.getPipelineContext?e.effect:e};e.prototype.setEffect=function(e,t){this.effect=e;void 0!==t&&(this.defines=t)};return e})(),DT="\nattribute vec2 position;\nuniform vec2 scale;\n\nvarying vec2 vUV;\nconst vec2 madd=vec2(0.5,0.5);\nvoid main(void) {\nvUV=(position*madd+madd)*scale;\ngl_Position=vec4(position,0.0,1.0);\n}";OT.ShadersStore.postprocessVertexShader=DT;var PT,HT=(function(){function e(t,n){var r,i=this;void 0===n&&(n=e._DefaultOptions);this.engine=t;this._fullscreenViewport=new nT(0,0,1,1);n=Kx(Kx({},e._DefaultOptions),n);this._vertexBuffers=((r={})[tT.PositionKind]=new tT(t,n.positions,tT.PositionKind,!1,!1,2),r);this._indexBuffer=t.createIndexBuffer(n.indices);this._onContextRestoredObserver=t.onContextRestoredObservable.add(function(){i._indexBuffer=t.createIndexBuffer(n.indices);for(var e in i._vertexBuffers){i._vertexBuffers[e]._rebuild()}})}e.prototype.setViewport=function(e){void 0===e&&(e=this._fullscreenViewport);this.engine.setViewport(e)};e.prototype.bindBuffers=function(e){this.engine.bindBuffers(this._vertexBuffers,this._indexBuffer,e)};e.prototype.applyEffectWrapper=function(e){this.engine.depthCullingState.depthTest=!1;this.engine.stencilState.stencilTest=!1;this.engine.enableEffect(e._drawWrapper);this.bindBuffers(e.effect);e.onApplyObservable.notifyObservers({})};e.prototype.restoreStates=function(){this.engine.depthCullingState.depthTest=!0;this.engine.stencilState.stencilTest=!0};e.prototype.draw=function(){this.engine.drawElementsType(0,0,6)};e.prototype.isRenderTargetTexture=function(e){return void 0!==e.renderList};e.prototype.render=function(e,t){void 0===t&&(t=null);if(e.effect.isReady()){this.setViewport();var n=null===t?null:this.isRenderTargetTexture(t)?t.renderTarget:t;n&&this.engine.bindFramebuffer(n);this.applyEffectWrapper(e);this.draw();n&&this.engine.unBindFramebuffer(n);this.restoreStates()}};e.prototype.dispose=function(){var e=this._vertexBuffers[tT.PositionKind];if(e){e.dispose();delete this._vertexBuffers[tT.PositionKind]}this._indexBuffer&&this.engine._releaseBuffer(this._indexBuffer);if(this._onContextRestoredObserver){this.engine.onContextRestoredObservable.remove(this._onContextRestoredObserver);this._onContextRestoredObserver=null}};e._DefaultOptions={positions:[1,1,-1,1,-1,-1,1,-1],indices:[0,1,2,0,2,3]};return e})(),BT=(function(){function e(e){var t,n=this;this.onApplyObservable=new sT;var r=e.uniformNames||[];if(e.vertexShader)t={fragmentSource:e.fragmentShader,vertexSource:e.vertexShader,spectorName:e.name||"effectWrapper"};else{r.push("scale");t={fragmentSource:e.fragmentShader,vertex:"postprocess",spectorName:e.name||"effectWrapper"};this.onApplyObservable.add(function(){n.effect.setFloat2("scale",1,1)})}var i=e.defines?e.defines.join("\n"):"";this._drawWrapper=new _T(e.engine);if(e.useShaderStore){t.fragment=t.fragmentSource;t.vertex||(t.vertex=t.vertexSource);delete t.fragmentSource;delete t.vertexSource;this.effect=e.engine.createEffect(t.spectorName,e.attributeNames||["position"],r,e.samplerNames,i,void 0,e.onCompiled,void 0,void 0,e.shaderLanguage)}else{this.effect=new MT(t,e.attributeNames||["position"],r,e.samplerNames,e.engine,i,void 0,e.onCompiled,void 0,void 0,void 0,e.shaderLanguage);this._onContextRestoredObserver=e.engine.onContextRestoredObservable.add(function(){n.effect._pipelineContext=null;n.effect._wasPreviouslyReady=!1;n.effect._prepareEffect()})}}Object.defineProperty(e.prototype,"effect",{get:function(){return this._drawWrapper.effect},set:function(e){this._drawWrapper.effect=e},enumerable:!1,configurable:!0});e.prototype.dispose=function(){if(this._onContextRestoredObserver){this.effect.getEngine().onContextRestoredObservable.remove(this._onContextRestoredObserver);this._onContextRestoredObserver=null}this.effect.dispose()};return e})(),jT=(function(){function e(){}Object.defineProperty(e,"LastCreatedEngine",{get:function(){return 0===this.Instances.length?null:this.Instances[this.Instances.length-1]},enumerable:!1,configurable:!0});Object.defineProperty(e,"LastCreatedScene",{get:function(){return this._LastCreatedScene},enumerable:!1,configurable:!0});e.Instances=new Array;e._LastCreatedScene=null;e.UseFallbackTexture=!0;e.FallbackTexture="";return e})(),FT=(function(){function e(e){void 0===e&&(e=!0);this._isDepthTestDirty=!1;this._isDepthMaskDirty=!1;this._isDepthFuncDirty=!1;this._isCullFaceDirty=!1;this._isCullDirty=!1;this._isZOffsetDirty=!1;this._isFrontFaceDirty=!1;e&&this.reset()}Object.defineProperty(e.prototype,"isDirty",{get:function(){return this._isDepthFuncDirty||this._isDepthTestDirty||this._isDepthMaskDirty||this._isCullFaceDirty||this._isCullDirty||this._isZOffsetDirty||this._isFrontFaceDirty},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"zOffset",{get:function(){return this._zOffset},set:function(e){if(this._zOffset!==e){this._zOffset=e;this._isZOffsetDirty=!0}},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"zOffsetUnits",{get:function(){return this._zOffsetUnits},set:function(e){if(this._zOffsetUnits!==e){this._zOffsetUnits=e;this._isZOffsetDirty=!0}},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"cullFace",{get:function(){return this._cullFace},set:function(e){if(this._cullFace!==e){this._cullFace=e;this._isCullFaceDirty=!0}},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"cull",{get:function(){return this._cull},set:function(e){if(this._cull!==e){this._cull=e;this._isCullDirty=!0}},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"depthFunc",{get:function(){return this._depthFunc},set:function(e){if(this._depthFunc!==e){this._depthFunc=e;this._isDepthFuncDirty=!0}},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"depthMask",{get:function(){return this._depthMask},set:function(e){if(this._depthMask!==e){this._depthMask=e;this._isDepthMaskDirty=!0}},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"depthTest",{get:function(){return this._depthTest},set:function(e){if(this._depthTest!==e){this._depthTest=e;this._isDepthTestDirty=!0}},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"frontFace",{get:function(){return this._frontFace},set:function(e){if(this._frontFace!==e){this._frontFace=e;this._isFrontFaceDirty=!0}},enumerable:!1,configurable:!0});e.prototype.reset=function(){this._depthMask=!0;this._depthTest=!0;this._depthFunc=null;this._cullFace=null;this._cull=null;this._zOffset=0;this._zOffsetUnits=0;this._frontFace=null;this._isDepthTestDirty=!0;this._isDepthMaskDirty=!0;this._isDepthFuncDirty=!1;this._isCullFaceDirty=!1;this._isCullDirty=!1;this._isZOffsetDirty=!0;this._isFrontFaceDirty=!1};e.prototype.apply=function(e){if(this.isDirty){if(this._isCullDirty){this.cull?e.enable(e.CULL_FACE):e.disable(e.CULL_FACE);this._isCullDirty=!1}if(this._isCullFaceDirty){e.cullFace(this.cullFace);this._isCullFaceDirty=!1}if(this._isDepthMaskDirty){e.depthMask(this.depthMask);this._isDepthMaskDirty=!1}if(this._isDepthTestDirty){this.depthTest?e.enable(e.DEPTH_TEST):e.disable(e.DEPTH_TEST);this._isDepthTestDirty=!1}if(this._isDepthFuncDirty){e.depthFunc(this.depthFunc);this._isDepthFuncDirty=!1}if(this._isZOffsetDirty){if(this.zOffset||this.zOffsetUnits){e.enable(e.POLYGON_OFFSET_FILL);e.polygonOffset(this.zOffset,this.zOffsetUnits)}else e.disable(e.POLYGON_OFFSET_FILL);this._isZOffsetDirty=!1}if(this._isFrontFaceDirty){e.frontFace(this.frontFace);this._isFrontFaceDirty=!1}}};return e})(),IT=(function(){function e(){this.reset()}e.prototype.reset=function(){this.enabled=!1;this.mask=255;this.func=e.ALWAYS;this.funcRef=1;this.funcMask=255;this.opStencilFail=e.KEEP;this.opDepthFail=e.KEEP;this.opStencilDepthPass=e.REPLACE};Object.defineProperty(e.prototype,"stencilFunc",{get:function(){return this.func},set:function(e){this.func=e},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"stencilFuncRef",{get:function(){return this.funcRef},set:function(e){this.funcRef=e},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"stencilFuncMask",{get:function(){return this.funcMask},set:function(e){this.funcMask=e},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"stencilOpStencilFail",{get:function(){return this.opStencilFail},set:function(e){this.opStencilFail=e},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"stencilOpDepthFail",{get:function(){return this.opDepthFail},set:function(e){this.opDepthFail=e},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"stencilOpStencilDepthPass",{get:function(){return this.opStencilDepthPass},set:function(e){this.opStencilDepthPass=e},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"stencilMask",{get:function(){return this.mask},set:function(e){this.mask=e},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"stencilTest",{get:function(){return this.enabled},set:function(e){this.enabled=e},enumerable:!1,configurable:!0});e.ALWAYS=519;e.KEEP=7680;e.REPLACE=7681;return e})(),qT=(function(){function e(){this._blendFunctionParameters=new Array(4);this._blendEquationParameters=new Array(2);this._blendConstants=new Array(4);this._isBlendConstantsDirty=!1;this._alphaBlend=!1;this._isAlphaBlendDirty=!1;this._isBlendFunctionParametersDirty=!1;this._isBlendEquationParametersDirty=!1;this.reset()}Object.defineProperty(e.prototype,"isDirty",{get:function(){return this._isAlphaBlendDirty||this._isBlendFunctionParametersDirty},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"alphaBlend",{get:function(){return this._alphaBlend},set:function(e){if(this._alphaBlend!==e){this._alphaBlend=e;this._isAlphaBlendDirty=!0}},enumerable:!1,configurable:!0});e.prototype.setAlphaBlendConstants=function(e,t,n,r){if(this._blendConstants[0]!==e||this._blendConstants[1]!==t||this._blendConstants[2]!==n||this._blendConstants[3]!==r){this._blendConstants[0]=e;this._blendConstants[1]=t;this._blendConstants[2]=n;this._blendConstants[3]=r;this._isBlendConstantsDirty=!0}};e.prototype.setAlphaBlendFunctionParameters=function(e,t,n,r){if(this._blendFunctionParameters[0]!==e||this._blendFunctionParameters[1]!==t||this._blendFunctionParameters[2]!==n||this._blendFunctionParameters[3]!==r){this._blendFunctionParameters[0]=e;this._blendFunctionParameters[1]=t;this._blendFunctionParameters[2]=n;this._blendFunctionParameters[3]=r;this._isBlendFunctionParametersDirty=!0}};e.prototype.setAlphaEquationParameters=function(e,t){if(this._blendEquationParameters[0]!==e||this._blendEquationParameters[1]!==t){this._blendEquationParameters[0]=e;this._blendEquationParameters[1]=t;this._isBlendEquationParametersDirty=!0}};e.prototype.reset=function(){this._alphaBlend=!1;this._blendFunctionParameters[0]=null;this._blendFunctionParameters[1]=null;this._blendFunctionParameters[2]=null;this._blendFunctionParameters[3]=null;this._blendEquationParameters[0]=null;this._blendEquationParameters[1]=null;this._blendConstants[0]=null;this._blendConstants[1]=null;this._blendConstants[2]=null;this._blendConstants[3]=null;this._isAlphaBlendDirty=!0;this._isBlendFunctionParametersDirty=!1;this._isBlendEquationParametersDirty=!1;this._isBlendConstantsDirty=!1};e.prototype.apply=function(e){if(this.isDirty){if(this._isAlphaBlendDirty){this._alphaBlend?e.enable(e.BLEND):e.disable(e.BLEND);this._isAlphaBlendDirty=!1}if(this._isBlendFunctionParametersDirty){e.blendFuncSeparate(this._blendFunctionParameters[0],this._blendFunctionParameters[1],this._blendFunctionParameters[2],this._blendFunctionParameters[3]);this._isBlendFunctionParametersDirty=!1}if(this._isBlendEquationParametersDirty){e.blendEquationSeparate(this._blendEquationParameters[0],this._blendEquationParameters[1]);this._isBlendEquationParametersDirty=!1}if(this._isBlendConstantsDirty){e.blendColor(this._blendConstants[0],this._blendConstants[1],this._blendConstants[2],this._blendConstants[3]);this._isBlendConstantsDirty=!1}}};return e})(),RT=(function(){function e(){this.samplingMode=-1;this._useMipMaps=!0;this._cachedWrapU=null;this._cachedWrapV=null;this._cachedWrapR=null;this._cachedAnisotropicFilteringLevel=null;this._comparisonFunction=0}Object.defineProperty(e.prototype,"wrapU",{get:function(){return this._cachedWrapU},set:function(e){this._cachedWrapU=e},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"wrapV",{get:function(){return this._cachedWrapV},set:function(e){this._cachedWrapV=e},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"wrapR",{get:function(){return this._cachedWrapR},set:function(e){this._cachedWrapR=e},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"anisotropicFilteringLevel",{get:function(){return this._cachedAnisotropicFilteringLevel},set:function(e){this._cachedAnisotropicFilteringLevel=e},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"comparisonFunction",{get:function(){return this._comparisonFunction},set:function(e){this._comparisonFunction=e},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"useMipMaps",{get:function(){return this._useMipMaps},set:function(e){this._useMipMaps=e},enumerable:!1,configurable:!0});e.prototype.setParameters=function(e,t,n,r,i,s){void 0===e&&(e=1);void 0===t&&(t=1);void 0===n&&(n=1);void 0===r&&(r=1);void 0===i&&(i=2);void 0===s&&(s=0);this._cachedWrapU=e;this._cachedWrapV=t;this._cachedWrapR=n;this._cachedAnisotropicFilteringLevel=r;this.samplingMode=i;this._comparisonFunction=s;return this};e.prototype.compareSampler=function(e){return this._cachedWrapU===e._cachedWrapU&&this._cachedWrapV===e._cachedWrapV&&this._cachedWrapR===e._cachedWrapR&&this._cachedAnisotropicFilteringLevel===e._cachedAnisotropicFilteringLevel&&this.samplingMode===e.samplingMode&&this._comparisonFunction===e._comparisonFunction&&this._useMipMaps===e._useMipMaps};return e})();(function(e){e[e.Unknown=0]="Unknown";e[e.Url=1]="Url";e[e.Temp=2]="Temp";e[e.Raw=3]="Raw";e[e.Dynamic=4]="Dynamic";e[e.RenderTarget=5]="RenderTarget";e[e.MultiRenderTarget=6]="MultiRenderTarget";e[e.Cube=7]="Cube";e[e.CubeRaw=8]="CubeRaw";e[e.CubePrefiltered=9]="CubePrefiltered";e[e.Raw3D=10]="Raw3D";e[e.Raw2DArray=11]="Raw2DArray";e[e.DepthStencil=12]="DepthStencil";e[e.CubeRawRGBD=13]="CubeRawRGBD";e[e.Depth=14]="Depth"})(PT||(PT={}));var UT=(function(e){Jx(t,e);function t(n,r,i){void 0===i&&(i=!1);var s=e.call(this)||this;s.isReady=!1;s.isCube=!1;s.is3D=!1;s.is2DArray=!1;s.isMultiview=!1;s.url="";s.generateMipMaps=!1;s.samples=0;s.type=-1;s.format=-1;s.onLoadedObservable=new sT;s.onErrorObservable=new sT;s.onRebuildCallback=null;s.width=0;s.height=0;s.depth=0;s.baseWidth=0;s.baseHeight=0;s.baseDepth=0;s.invertY=!1;s._invertVScale=!1;s._associatedChannel=-1;s._source=PT.Unknown;s._buffer=null;s._bufferView=null;s._bufferViewArray=null;s._bufferViewArrayArray=null;s._size=0;s._extension="";s._files=null;s._workingCanvas=null;s._workingContext=null;s._cachedCoordinatesMode=null;s._isDisabled=!1;s._compression=null;s._sphericalPolynomial=null;s._sphericalPolynomialPromise=null;s._sphericalPolynomialComputed=!1;s._lodGenerationScale=0;s._lodGenerationOffset=0;s._useSRGBBuffer=!1;s._lodTextureHigh=null;s._lodTextureMid=null;s._lodTextureLow=null;s._isRGBD=!1;s._linearSpecularLOD=!1;s._irradianceTexture=null;s._hardwareTexture=null;s._references=1;s._gammaSpace=null;s._engine=n;s._source=r;s._uniqueId=t._Counter++;i||(s._hardwareTexture=n._createHardwareTexture());return s}Object.defineProperty(t.prototype,"useMipMaps",{get:function(){return this.generateMipMaps},set:function(e){this.generateMipMaps=e},enumerable:!1,configurable:!0});Object.defineProperty(t.prototype,"uniqueId",{get:function(){return this._uniqueId},enumerable:!1,configurable:!0});t.prototype.getEngine=function(){return this._engine};Object.defineProperty(t.prototype,"source",{get:function(){return this._source},enumerable:!1,configurable:!0});t.prototype.incrementReferences=function(){this._references++};t.prototype.updateSize=function(e,t,n){void 0===n&&(n=1);this._engine.updateTextureDimensions(this,e,t,n);this.width=e;this.height=t;this.depth=n;this.baseWidth=e;this.baseHeight=t;this.baseDepth=n;this._size=e*t*n};t.prototype._rebuild=function(){var e,t=this;this.isReady=!1;this._cachedCoordinatesMode=null;this._cachedWrapU=null;this._cachedWrapV=null;this._cachedWrapR=null;this._cachedAnisotropicFilteringLevel=null;if(this.onRebuildCallback){var n=this.onRebuildCallback(this),r=function(e){e._swapAndDie(t,!1);t.isReady=n.isReady};n.isAsync?n.proxy.then(r):r(n.proxy)}else{var i;switch(this.source){case PT.Temp:break;case PT.Url:i=this._engine.createTexture(null!==(e=this._originalUrl)&&void 0!==e?e:this.url,!this.generateMipMaps,this.invertY,null,this.samplingMode,function(){i._swapAndDie(t,!1);t.isReady=!0},null,this._buffer,void 0,this.format,this._extension,void 0,void 0,void 0,this._useSRGBBuffer);return;case PT.Raw:(i=this._engine.createRawTexture(this._bufferView,this.baseWidth,this.baseHeight,this.format,this.generateMipMaps,this.invertY,this.samplingMode,this._compression,this.type))._swapAndDie(this,!1);this.isReady=!0;break;case PT.Raw3D:(i=this._engine.createRawTexture3D(this._bufferView,this.baseWidth,this.baseHeight,this.baseDepth,this.format,this.generateMipMaps,this.invertY,this.samplingMode,this._compression,this.type))._swapAndDie(this,!1);this.isReady=!0;break;case PT.Raw2DArray:(i=this._engine.createRawTexture2DArray(this._bufferView,this.baseWidth,this.baseHeight,this.baseDepth,this.format,this.generateMipMaps,this.invertY,this.samplingMode,this._compression,this.type))._swapAndDie(this,!1);this.isReady=!0;break;case PT.Dynamic:(i=this._engine.createDynamicTexture(this.baseWidth,this.baseHeight,this.generateMipMaps,this.samplingMode))._swapAndDie(this,!1);this._engine.updateDynamicTexture(this,this._engine.getRenderingCanvas(),this.invertY,void 0,void 0,!0);break;case PT.Cube:i=this._engine.createCubeTexture(this.url,null,this._files,!this.generateMipMaps,function(){i._swapAndDie(t,!1);t.isReady=!0},null,this.format,this._extension,!1,0,0,null,void 0,this._useSRGBBuffer);return;case PT.CubeRaw:(i=this._engine.createRawCubeTexture(this._bufferViewArray,this.width,this.format,this.type,this.generateMipMaps,this.invertY,this.samplingMode,this._compression))._swapAndDie(this,!1);this.isReady=!0;break;case PT.CubeRawRGBD:return;case PT.CubePrefiltered:(i=this._engine.createPrefilteredCubeTexture(this.url,null,this._lodGenerationScale,this._lodGenerationOffset,function(e){e&&e._swapAndDie(t,!1);t.isReady=!0},null,this.format,this._extension))._sphericalPolynomial=this._sphericalPolynomial;return}}};t.prototype._swapAndDie=function(e,t){var n;void 0===t&&(t=!0);null===(n=this._hardwareTexture)||void 0===n||n.setUsage(e._source,this.generateMipMaps,this.isCube,this.width,this.height);e._hardwareTexture=this._hardwareTexture;t&&(e._isRGBD=this._isRGBD);if(this._lodTextureHigh){e._lodTextureHigh&&e._lodTextureHigh.dispose();e._lodTextureHigh=this._lodTextureHigh}if(this._lodTextureMid){e._lodTextureMid&&e._lodTextureMid.dispose();e._lodTextureMid=this._lodTextureMid}if(this._lodTextureLow){e._lodTextureLow&&e._lodTextureLow.dispose();e._lodTextureLow=this._lodTextureLow}if(this._irradianceTexture){e._irradianceTexture&&e._irradianceTexture.dispose();e._irradianceTexture=this._irradianceTexture}var r,i=this._engine.getLoadedTexturesCache();-1!==(r=i.indexOf(this))&&i.splice(r,1);-1===(r=i.indexOf(e))&&i.push(e)};t.prototype.dispose=function(){this._references--;this.onLoadedObservable.clear();this.onErrorObservable.clear();if(0===this._references){this._engine._releaseTexture(this);this._hardwareTexture=null}};t._Counter=0;return t})(RT),zT=(function(){function e(){this.shaderLanguage=fT.GLSL}e.prototype.postProcessor=function(e,t,n,r,i){if(!i.getCaps().drawBuffersExtension){e=e.replace(/#extension.+GL_EXT_draw_buffers.+(enable|require)/g,"")}return e};return e})(),WT=(function(){function e(){this.shaderLanguage=fT.GLSL}e.prototype.attributeProcessor=function(e){return e.replace("attribute","in")};e.prototype.varyingProcessor=function(e,t){return e.replace("varying",t?"in":"out")};e.prototype.postProcessor=function(e,t,n,r,i){var s=-1!==e.search(/#extension.+GL_EXT_draw_buffers.+require/);e=(e=e.replace(/#extension.+(GL_OVR_multiview2|GL_OES_standard_derivatives|GL_EXT_shader_texture_lod|GL_EXT_frag_depth|GL_EXT_draw_buffers).+(enable|require)/g,"")).replace(/texture2D\s*\(/g,"texture(");if(n)e=(e=(e=(e=(e=(e=(e=e.replace(/texture2DLodEXT\s*\(/g,"textureLod(")).replace(/textureCubeLodEXT\s*\(/g,"textureLod(")).replace(/textureCube\s*\(/g,"texture(")).replace(/gl_FragDepthEXT/g,"gl_FragDepth")).replace(/gl_FragColor/g,"glFragColor")).replace(/gl_FragData/g,"glFragData")).replace(/void\s+?main\s*\(/g,(s?"":"out vec4 glFragColor;\n")+"void main(");else{if(-1!==t.indexOf("#define MULTIVIEW"))return"#extension GL_OVR_multiview2 : require\nlayout (num_views = 2) in;\n"+e}return e};return e})(),XT=(function(e){Jx(t,e);function t(t){var n=e.call(this)||this;n._buffer=t;return n}Object.defineProperty(t.prototype,"underlyingResource",{get:function(){return this._buffer},enumerable:!1,configurable:!0});return t})(Yx),VT=(function(){function e(){this._valueCache={};this.vertexCompilationError=null;this.fragmentCompilationError=null;this.programLinkError=null;this.programValidationError=null}Object.defineProperty(e.prototype,"isAsync",{get:function(){return this.isParallelCompiled},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"isReady",{get:function(){return!!this.program&&(!this.isParallelCompiled||this.engine._isRenderingStateCompiled(this))},enumerable:!1,configurable:!0});e.prototype._handlesSpectorRebuildCallback=function(e){e&&this.program&&e(this.program)};e.prototype._fillEffectInformation=function(e,t,n,r,i,s,o,u){var a,f=this.engine;if(f.supportsUniformBuffers)for(var l in t)e.bindUniformBlock(l,t[l]);this.engine.getUniforms(this,n).forEach(function(e,t){r[n[t]]=e});this._uniforms=r;for(a=0;a<i.length;a++){if(null==e.getUniform(i[a])){i.splice(a,1);a--}}i.forEach(function(e,t){s[e]=t});for(var c=0,h=f.getAttributes(this,o);c<h.length;c++){var p=h[c];u.push(p)}};e.prototype.dispose=function(){this._uniforms={}};e.prototype._cacheMatrix=function(e,t){var n=this._valueCache[e],r=t.updateFlag;if(void 0!==n&&n===r)return!1;this._valueCache[e]=r;return!0};e.prototype._cacheFloat2=function(e,t,n){var r=this._valueCache[e];if(!r||2!==r.length){r=[t,n];this._valueCache[e]=r;return!0}var i=!1;if(r[0]!==t){r[0]=t;i=!0}if(r[1]!==n){r[1]=n;i=!0}return i};e.prototype._cacheFloat3=function(e,t,n,r){var i=this._valueCache[e];if(!i||3!==i.length){i=[t,n,r];this._valueCache[e]=i;return!0}var s=!1;if(i[0]!==t){i[0]=t;s=!0}if(i[1]!==n){i[1]=n;s=!0}if(i[2]!==r){i[2]=r;s=!0}return s};e.prototype._cacheFloat4=function(e,t,n,r,i){var s=this._valueCache[e];if(!s||4!==s.length){s=[t,n,r,i];this._valueCache[e]=s;return!0}var o=!1;if(s[0]!==t){s[0]=t;o=!0}if(s[1]!==n){s[1]=n;o=!0}if(s[2]!==r){s[2]=r;o=!0}if(s[3]!==i){s[3]=i;o=!0}return o};e.prototype.setInt=function(e,t){var n=this._valueCache[e];void 0!==n&&n===t||this.engine.setInt(this._uniforms[e],t)&&(this._valueCache[e]=t)};e.prototype.setInt2=function(e,t,n){this._cacheFloat2(e,t,n)&&(this.engine.setInt2(this._uniforms[e],t,n)||(this._valueCache[e]=null))};e.prototype.setInt3=function(e,t,n,r){this._cacheFloat3(e,t,n,r)&&(this.engine.setInt3(this._uniforms[e],t,n,r)||(this._valueCache[e]=null))};e.prototype.setInt4=function(e,t,n,r,i){this._cacheFloat4(e,t,n,r,i)&&(this.engine.setInt4(this._uniforms[e],t,n,r,i)||(this._valueCache[e]=null))};e.prototype.setIntArray=function(e,t){this._valueCache[e]=null;this.engine.setIntArray(this._uniforms[e],t)};e.prototype.setIntArray2=function(e,t){this._valueCache[e]=null;this.engine.setIntArray2(this._uniforms[e],t)};e.prototype.setIntArray3=function(e,t){this._valueCache[e]=null;this.engine.setIntArray3(this._uniforms[e],t)};e.prototype.setIntArray4=function(e,t){this._valueCache[e]=null;this.engine.setIntArray4(this._uniforms[e],t)};e.prototype.setArray=function(e,t){this._valueCache[e]=null;this.engine.setArray(this._uniforms[e],t)};e.prototype.setArray2=function(e,t){this._valueCache[e]=null;this.engine.setArray2(this._uniforms[e],t)};e.prototype.setArray3=function(e,t){this._valueCache[e]=null;this.engine.setArray3(this._uniforms[e],t)};e.prototype.setArray4=function(e,t){this._valueCache[e]=null;this.engine.setArray4(this._uniforms[e],t)};e.prototype.setMatrices=function(e,t){if(t){this._valueCache[e]=null;this.engine.setMatrices(this._uniforms[e],t)}};e.prototype.setMatrix=function(e,t){this._cacheMatrix(e,t)&&(this.engine.setMatrices(this._uniforms[e],t.toArray())||(this._valueCache[e]=null))};e.prototype.setMatrix3x3=function(e,t){this._valueCache[e]=null;this.engine.setMatrix3x3(this._uniforms[e],t)};e.prototype.setMatrix2x2=function(e,t){this._valueCache[e]=null;this.engine.setMatrix2x2(this._uniforms[e],t)};e.prototype.setFloat=function(e,t){var n=this._valueCache[e];void 0!==n&&n===t||this.engine.setFloat(this._uniforms[e],t)&&(this._valueCache[e]=t)};e.prototype.setVector2=function(e,t){this._cacheFloat2(e,t.x,t.y)&&(this.engine.setFloat2(this._uniforms[e],t.x,t.y)||(this._valueCache[e]=null))};e.prototype.setFloat2=function(e,t,n){this._cacheFloat2(e,t,n)&&(this.engine.setFloat2(this._uniforms[e],t,n)||(this._valueCache[e]=null))};e.prototype.setVector3=function(e,t){this._cacheFloat3(e,t.x,t.y,t.z)&&(this.engine.setFloat3(this._uniforms[e],t.x,t.y,t.z)||(this._valueCache[e]=null))};e.prototype.setFloat3=function(e,t,n,r){this._cacheFloat3(e,t,n,r)&&(this.engine.setFloat3(this._uniforms[e],t,n,r)||(this._valueCache[e]=null))};e.prototype.setVector4=function(e,t){this._cacheFloat4(e,t.x,t.y,t.z,t.w)&&(this.engine.setFloat4(this._uniforms[e],t.x,t.y,t.z,t.w)||(this._valueCache[e]=null))};e.prototype.setFloat4=function(e,t,n,r,i){this._cacheFloat4(e,t,n,r,i)&&(this.engine.setFloat4(this._uniforms[e],t,n,r,i)||(this._valueCache[e]=null))};e.prototype.setColor3=function(e,t){this._cacheFloat3(e,t.r,t.g,t.b)&&(this.engine.setFloat3(this._uniforms[e],t.r,t.g,t.b)||(this._valueCache[e]=null))};e.prototype.setColor4=function(e,t,n){this._cacheFloat4(e,t.r,t.g,t.b,n)&&(this.engine.setFloat4(this._uniforms[e],t.r,t.g,t.b,n)||(this._valueCache[e]=null))};e.prototype.setDirectColor4=function(e,t){this._cacheFloat4(e,t.r,t.g,t.b,t.a)&&(this.engine.setFloat4(this._uniforms[e],t.r,t.g,t.b,t.a)||(this._valueCache[e]=null))};e.prototype._getVertexShaderCode=function(){return this.vertexShader?this.engine._getShaderSource(this.vertexShader):null};e.prototype._getFragmentShaderCode=function(){return this.fragmentShader?this.engine._getShaderSource(this.fragmentShader):null};return e})(),$T=(function(){function e(){}e.SetMatrixPrecision=function(t){e.MatrixTrackPrecisionChange=!1;if(t&&!e.MatrixUse64Bits&&e.MatrixTrackedMatrices)for(var n=0;n<e.MatrixTrackedMatrices.length;++n){var r=e.MatrixTrackedMatrices[n],i=r._m;r._m=new Array(16);for(var s=0;s<16;++s)r._m[s]=i[s]}e.MatrixUse64Bits=t;e.MatrixCurrentType=e.MatrixUse64Bits?Array:Float32Array;e.MatrixTrackedMatrices=null};e.MatrixUse64Bits=!1;e.MatrixTrackPrecisionChange=!0;e.MatrixCurrentType=Float32Array;e.MatrixTrackedMatrices=[];return e})(),JT=(function(){function e(e,t){void 0===e&&(e=null);this._MSAARenderBuffer=null;this._context=t;if(!e&&!(e=t.createTexture()))throw new Error("Unable to create webGL texture");this.set(e)}Object.defineProperty(e.prototype,"underlyingResource",{get:function(){return this._webGLTexture},enumerable:!1,configurable:!0});e.prototype.setUsage=function(e,t,n,r,i){};e.prototype.set=function(e){this._webGLTexture=e};e.prototype.reset=function(){this._webGLTexture=null;this._MSAARenderBuffer=null};e.prototype.release=function(){if(this._MSAARenderBuffer){this._context.deleteRenderbuffer(this._MSAARenderBuffer);this._MSAARenderBuffer=null}this._webGLTexture&&this._context.deleteTexture(this._webGLTexture);this.reset()};return e})(),KT=(function(){function e(e){void 0===e&&(e=!0);this._isStencilTestDirty=!1;this._isStencilMaskDirty=!1;this._isStencilFuncDirty=!1;this._isStencilOpDirty=!1;this.useStencilGlobalOnly=!1;e&&this.reset()}Object.defineProperty(e.prototype,"isDirty",{get:function(){return this._isStencilTestDirty||this._isStencilMaskDirty||this._isStencilFuncDirty||this._isStencilOpDirty},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"func",{get:function(){return this._func},set:function(e){if(this._func!==e){this._func=e;this._isStencilFuncDirty=!0}},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"funcRef",{get:function(){return this._funcRef},set:function(e){if(this._funcRef!==e){this._funcRef=e;this._isStencilFuncDirty=!0}},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"funcMask",{get:function(){return this._funcMask},set:function(e){if(this._funcMask!==e){this._funcMask=e;this._isStencilFuncDirty=!0}},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"opStencilFail",{get:function(){return this._opStencilFail},set:function(e){if(this._opStencilFail!==e){this._opStencilFail=e;this._isStencilOpDirty=!0}},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"opDepthFail",{get:function(){return this._opDepthFail},set:function(e){if(this._opDepthFail!==e){this._opDepthFail=e;this._isStencilOpDirty=!0}},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"opStencilDepthPass",{get:function(){return this._opStencilDepthPass},set:function(e){if(this._opStencilDepthPass!==e){this._opStencilDepthPass=e;this._isStencilOpDirty=!0}},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"mask",{get:function(){return this._mask},set:function(e){if(this._mask!==e){this._mask=e;this._isStencilMaskDirty=!0}},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"enabled",{get:function(){return this._enabled},set:function(e){if(this._enabled!==e){this._enabled=e;this._isStencilTestDirty=!0}},enumerable:!1,configurable:!0});e.prototype.reset=function(){var e;this.stencilMaterial=void 0;null===(e=this.stencilGlobal)||void 0===e||e.reset();this._isStencilTestDirty=!0;this._isStencilMaskDirty=!0;this._isStencilFuncDirty=!0;this._isStencilOpDirty=!0};e.prototype.apply=function(e){var t;if(e){var n=!this.useStencilGlobalOnly&&!!(null===(t=this.stencilMaterial)||void 0===t?void 0:t.enabled);this.enabled=n?this.stencilMaterial.enabled:this.stencilGlobal.enabled;this.func=n?this.stencilMaterial.func:this.stencilGlobal.func;this.funcRef=n?this.stencilMaterial.funcRef:this.stencilGlobal.funcRef;this.funcMask=n?this.stencilMaterial.funcMask:this.stencilGlobal.funcMask;this.opStencilFail=n?this.stencilMaterial.opStencilFail:this.stencilGlobal.opStencilFail;this.opDepthFail=n?this.stencilMaterial.opDepthFail:this.stencilGlobal.opDepthFail;this.opStencilDepthPass=n?this.stencilMaterial.opStencilDepthPass:this.stencilGlobal.opStencilDepthPass;this.mask=n?this.stencilMaterial.mask:this.stencilGlobal.mask;if(this.isDirty){if(this._isStencilTestDirty){this.enabled?e.enable(e.STENCIL_TEST):e.disable(e.STENCIL_TEST);this._isStencilTestDirty=!1}if(this._isStencilMaskDirty){e.stencilMask(this.mask);this._isStencilMaskDirty=!1}if(this._isStencilFuncDirty){e.stencilFunc(this.func,this.funcRef,this.funcMask);this._isStencilFuncDirty=!1}if(this._isStencilOpDirty){e.stencilOp(this.opStencilFail,this.opDepthFail,this.opStencilDepthPass);this._isStencilOpDirty=!1}}}};return e})(),QT=function(){},GT=(function(){function e(t,n,r,i){var s=this;this.forcePOTTextures=!1;this.isFullscreen=!1;this.cullBackFaces=null;this.renderEvenInBackground=!0;this.preventCacheWipeBetweenFrames=!1;this.validateShaderPrograms=!1;this._useReverseDepthBuffer=!1;this.isNDCHalfZRange=!1;this.hasOriginBottomLeft=!0;this.disableUniformBuffers=!1;this.onDisposeObservable=new sT;this._frameId=0;this._uniformBuffers=new Array;this._storageBuffers=new Array;this._webGLVersion=1;this._windowIsBackground=!1;this._highPrecisionShadersAllowed=!0;this._badOS=!1;this._badDesktopOS=!1;this._renderingQueueLaunched=!1;this._activeRenderLoops=new Array;this.onContextLostObservable=new sT;this.onContextRestoredObservable=new sT;this._contextWasLost=!1;this._doNotHandleContextLost=!1;this.disableVertexArrayObjects=!1;this._colorWrite=!0;this._colorWriteChanged=!0;this._depthCullingState=new FT;this._stencilStateComposer=new KT;this._stencilState=new IT;this._alphaState=new qT;this._alphaMode=1;this._alphaEquation=0;this._internalTexturesCache=new Array;this._renderTargetWrapperCache=new Array;this._activeChannel=0;this._currentTextureChannel=-1;this._boundTexturesCache={};this._compiledEffects={};this._vertexAttribArraysEnabled=[];this._uintIndicesCurrentlySet=!1;this._currentBoundBuffer=new Array;this._currentFramebuffer=null;this._dummyFramebuffer=null;this._currentBufferPointers=new Array;this._currentInstanceLocations=new Array;this._currentInstanceBuffers=new Array;this._vaoRecordInProgress=!1;this._mustWipeVertexAttributes=!1;this._nextFreeTextureSlots=new Array;this._maxSimultaneousTextures=0;this._activeRequests=new Array;this._transformTextureUrl=null;this.hostInformation={isMobile:!1};this.premultipliedAlpha=!0;this.onBeforeTextureInitObservable=new sT;this._isWebGPU=!1;this._snapshotRenderingEnabled=!1;this._snapshotRenderingMode=0;this._viewportCached={x:0,y:0,z:0,w:0};this._unpackFlipYCached=null;this.enableUnpackFlipYCached=!0;this._boundUniforms={};var o=null;r=r||{};this._stencilStateComposer.stencilGlobal=this._stencilState;$T.SetMatrixPrecision(!!r.useHighPrecisionMatrix);if(t){i=i||r.adaptToDeviceRatio||!1;if(t.getContext){o=t;this._renderingCanvas=o;void 0!==n&&(r.antialias=n);void 0===r.deterministicLockstep&&(r.deterministicLockstep=!1);void 0===r.lockstepMaxSteps&&(r.lockstepMaxSteps=4);void 0===r.timeStep&&(r.timeStep=1/60);void 0===r.preserveDrawingBuffer&&(r.preserveDrawingBuffer=!1);void 0===r.audioEngine&&(r.audioEngine=!0);void 0!==r.audioEngineOptions&&void 0!==r.audioEngineOptions.audioContext&&(this._audioContext=r.audioEngineOptions.audioContext);void 0!==r.audioEngineOptions&&void 0!==r.audioEngineOptions.audioDestination&&(this._audioDestination=r.audioEngineOptions.audioDestination);void 0===r.stencil&&(r.stencil=!0);!1===r.premultipliedAlpha&&(this.premultipliedAlpha=!1);void 0===r.xrCompatible&&(r.xrCompatible=!0);this._doNotHandleContextLost=!!r.doNotHandleContextLost;if(navigator&&navigator.userAgent){this._checkForMobile=function(){var e=navigator.userAgent;s.hostInformation.isMobile=-1!==e.indexOf("Mobile")||-1!==e.indexOf("Mac")&&void 0!==document&&"ontouchend"in document};this._checkForMobile();oT()&&window.addEventListener("resize",this._checkForMobile);for(var u=navigator.userAgent,a=0,f=e.ExceptionList;a<f.length;a++){var l=f[a],c=l.key,h=l.targets;if(new RegExp(c).test(u)){if(l.capture&&l.captureConstraint){var p=l.capture,d=l.captureConstraint,v=new RegExp(p).exec(u);if(v&&v.length>0){if(parseInt(v[v.length-1])>=d)continue}}for(var m=0,g=h;m<g.length;m++){switch(g[m]){case"uniformBuffer":this.disableUniformBuffers=!0;break;case"vao":this.disableVertexArrayObjects=!0}}}}}if(!this._doNotHandleContextLost){this._onContextLost=function(e){e.preventDefault();s._contextWasLost=!0;cT.Warn("WebGL context lost.");s.onContextLostObservable.notifyObservers(s)};this._onContextRestored=function(){s._restoreEngineAfterContextLost(s._initGLContext.bind(s))};o.addEventListener("webglcontextlost",this._onContextLost,!1);o.addEventListener("webglcontextrestored",this._onContextRestored,!1);r.powerPreference="high-performance"}this._badDesktopOS=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);this._badDesktopOS&&(r.xrCompatible=!1);if(!r.disableWebGL2Support)try{this._gl=o.getContext("webgl2",r)||o.getContext("experimental-webgl2",r);if(this._gl){this._webGLVersion=2;this._shaderPlatformName="WEBGL2";if(!this._gl.deleteQuery){this._webGLVersion=1;this._shaderPlatformName="WEBGL1"}}}catch(e){}if(!this._gl){if(!o)throw new Error("The provided canvas is null or undefined.");try{this._gl=o.getContext("webgl",r)||o.getContext("experimental-webgl",r)}catch(e){throw new Error("WebGL not supported")}}if(!this._gl)throw new Error("WebGL not supported")}else{this._gl=t;this._renderingCanvas=this._gl.canvas;if(this._gl.renderbufferStorageMultisample){this._webGLVersion=2;this._shaderPlatformName="WEBGL2"}else this._shaderPlatformName="WEBGL1";var y=this._gl.getContextAttributes();y&&(r.stencil=y.stencil)}this._gl.pixelStorei(this._gl.UNPACK_COLORSPACE_CONVERSION_WEBGL,this._gl.NONE);void 0!==r.useHighPrecisionFloats&&(this._highPrecisionShadersAllowed=r.useHighPrecisionFloats);var b=oT()&&window.devicePixelRatio||1,w=r.limitDeviceRatio||b;this._hardwareScalingLevel=i?1/Math.min(w,b):1;this.resize();this._isStencilEnable=!!r.stencil;this._initGLContext();this._initFeatures();for(var E=0;E<this._caps.maxVertexAttribs;E++)this._currentBufferPointers[E]=new QT;this._shaderProcessor=this.webGLVersion>1?new WT:new zT;this._badOS=/iPad/i.test(navigator.userAgent)||/iPhone/i.test(navigator.userAgent);this._creationOptions=r;console.log("Babylon.js v"+e.Version+" - "+this.description)}}Object.defineProperty(e,"NpmPackage",{get:function(){return"babylonjs@5.0.0-alpha.49"},enumerable:!1,configurable:!0});Object.defineProperty(e,"Version",{get:function(){return"5.0.0-alpha.49"},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"description",{get:function(){var e=this.name+this.webGLVersion;this._caps.parallelShaderCompile&&(e+=" - Parallel shader compilation");return e},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"name",{get:function(){return"WebGL"},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"version",{get:function(){return this._webGLVersion},enumerable:!1,configurable:!0});Object.defineProperty(e,"ShadersRepository",{get:function(){return MT.ShadersRepository},set:function(e){MT.ShadersRepository=e},enumerable:!1,configurable:!0});e.prototype._getShaderProcessor=function(e){return this._shaderProcessor};Object.defineProperty(e.prototype,"useReverseDepthBuffer",{get:function(){return this._useReverseDepthBuffer},set:function(e){if(e!==this._useReverseDepthBuffer){this._useReverseDepthBuffer=e;this._depthCullingState.depthFunc=e?518:515}},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"frameId",{get:function(){return this._frameId},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"supportsUniformBuffers",{get:function(){return this.webGLVersion>1&&!this.disableUniformBuffers},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"_shouldUseHighPrecisionShader",{get:function(){return!(!this._caps.highPrecisionShaderSupported||!this._highPrecisionShadersAllowed)},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"needPOTTextures",{get:function(){return this._webGLVersion<2||this.forcePOTTextures},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"activeRenderLoops",{get:function(){return this._activeRenderLoops},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"doNotHandleContextLost",{get:function(){return this._doNotHandleContextLost},set:function(e){this._doNotHandleContextLost=e},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"_supportsHardwareTextureRescaling",{get:function(){return!1},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"framebufferDimensionsObject",{set:function(e){this._framebufferDimensionsObject=e},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"currentViewport",{get:function(){return this._cachedViewport},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"emptyTexture",{get:function(){this._emptyTexture||(this._emptyTexture=this.createRawTexture(new Uint8Array(4),1,1,5,!1,!1,1));return this._emptyTexture},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"emptyTexture3D",{get:function(){this._emptyTexture3D||(this._emptyTexture3D=this.createRawTexture3D(new Uint8Array(4),1,1,1,5,!1,!1,1));return this._emptyTexture3D},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"emptyTexture2DArray",{get:function(){this._emptyTexture2DArray||(this._emptyTexture2DArray=this.createRawTexture2DArray(new Uint8Array(4),1,1,1,5,!1,!1,1));return this._emptyTexture2DArray},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"emptyCubeTexture",{get:function(){if(!this._emptyCubeTexture){var e=new Uint8Array(4),t=[e,e,e,e,e,e];this._emptyCubeTexture=this.createRawCubeTexture(t,1,5,0,!1,!1,1)}return this._emptyCubeTexture},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"isWebGPU",{get:function(){return this._isWebGPU},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"shaderPlatformName",{get:function(){return this._shaderPlatformName},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"snapshotRendering",{get:function(){return this._snapshotRenderingEnabled},set:function(e){this._snapshotRenderingEnabled=!1},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"snapshotRenderingMode",{get:function(){return this._snapshotRenderingMode},set:function(e){this._snapshotRenderingMode=e},enumerable:!1,configurable:!0});e.prototype.snapshotRenderingReset=function(){this.snapshotRendering=!1};e._createCanvas=function(e,t){if("undefined"==typeof document)return new OffscreenCanvas(e,t);var n=document.createElement("canvas");n.width=e;n.height=t;return n};e.prototype.createCanvas=function(t,n){return e._createCanvas(t,n)};e.prototype.createCanvasImage=function(){return document.createElement("img")};e.prototype._restoreEngineAfterContextLost=function(e){var t=this;setTimeout(function(){return Qx(t,void 0,void 0,function(){var t,n,r,i,s;return Gx(this,function(o){switch(o.label){case 0:this._dummyFramebuffer=null;t=this._depthCullingState.depthTest;n=this._depthCullingState.depthFunc;r=this._depthCullingState.depthMask;i=this._stencilState.stencilTest;return[4,e()];case 1:o.sent();this._rebuildEffects();null===(s=this._rebuildComputeEffects)||void 0===s||s.call(this);this._rebuildInternalTextures();this._rebuildRenderTargetWrappers();this._rebuildBuffers();this.wipeCaches(!0);this._depthCullingState.depthTest=t;this._depthCullingState.depthFunc=n;this._depthCullingState.depthMask=r;this._stencilState.stencilTest=i;cT.Warn(this.name+" context successfully restored.");this.onContextRestoredObservable.notifyObservers(this);this._contextWasLost=!1;return[2]}})})},0)};e.prototype._sharedInit=function(e,t,n){this._renderingCanvas=e};e.prototype._getShaderProcessingContext=function(e){return null};e.prototype._rebuildInternalTextures=function(){for(var e=0,t=this._internalTexturesCache.slice();e<t.length;e++){t[e]._rebuild()}};e.prototype._rebuildRenderTargetWrappers=function(){for(var e=0,t=this._renderTargetWrapperCache.slice();e<t.length;e++){t[e]._rebuild()}};e.prototype._rebuildEffects=function(){for(var e in this._compiledEffects){var t=this._compiledEffects[e];t._pipelineContext=null;t._wasPreviouslyReady=!1;t._prepareEffect()}MT.ResetCache()};e.prototype.areAllEffectsReady=function(){for(var e in this._compiledEffects){if(!this._compiledEffects[e].isReady())return!1}return!0};e.prototype._rebuildBuffers=function(){for(var e=0,t=this._uniformBuffers;e<t.length;e++){t[e]._rebuild()}for(var n=0,r=this._storageBuffers;n<r.length;n++){r[n]._rebuild()}};e.prototype._initGLContext=function(){this._caps={maxTexturesImageUnits:this._gl.getParameter(this._gl.MAX_TEXTURE_IMAGE_UNITS),maxCombinedTexturesImageUnits:this._gl.getParameter(this._gl.MAX_COMBINED_TEXTURE_IMAGE_UNITS),maxVertexTextureImageUnits:this._gl.getParameter(this._gl.MAX_VERTEX_TEXTURE_IMAGE_UNITS),maxTextureSize:this._gl.getParameter(this._gl.MAX_TEXTURE_SIZE),maxSamples:this._webGLVersion>1?this._gl.getParameter(this._gl.MAX_SAMPLES):1,maxCubemapTextureSize:this._gl.getParameter(this._gl.MAX_CUBE_MAP_TEXTURE_SIZE),maxRenderTextureSize:this._gl.getParameter(this._gl.MAX_RENDERBUFFER_SIZE),maxVertexAttribs:this._gl.getParameter(this._gl.MAX_VERTEX_ATTRIBS),maxVaryingVectors:this._gl.getParameter(this._gl.MAX_VARYING_VECTORS),maxFragmentUniformVectors:this._gl.getParameter(this._gl.MAX_FRAGMENT_UNIFORM_VECTORS),maxVertexUniformVectors:this._gl.getParameter(this._gl.MAX_VERTEX_UNIFORM_VECTORS),parallelShaderCompile:this._gl.getExtension("KHR_parallel_shader_compile")||void 0,standardDerivatives:this._webGLVersion>1||null!==this._gl.getExtension("OES_standard_derivatives"),maxAnisotropy:1,astc:this._gl.getExtension("WEBGL_compressed_texture_astc")||this._gl.getExtension("WEBKIT_WEBGL_compressed_texture_astc"),bptc:this._gl.getExtension("EXT_texture_compression_bptc")||this._gl.getExtension("WEBKIT_EXT_texture_compression_bptc"),s3tc:this._gl.getExtension("WEBGL_compressed_texture_s3tc")||this._gl.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc"),s3tc_srgb:this._gl.getExtension("WEBGL_compressed_texture_s3tc_srgb")||this._gl.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc_srgb"),pvrtc:this._gl.getExtension("WEBGL_compressed_texture_pvrtc")||this._gl.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),etc1:this._gl.getExtension("WEBGL_compressed_texture_etc1")||this._gl.getExtension("WEBKIT_WEBGL_compressed_texture_etc1"),etc2:this._gl.getExtension("WEBGL_compressed_texture_etc")||this._gl.getExtension("WEBKIT_WEBGL_compressed_texture_etc")||this._gl.getExtension("WEBGL_compressed_texture_es3_0"),textureAnisotropicFilterExtension:this._gl.getExtension("EXT_texture_filter_anisotropic")||this._gl.getExtension("WEBKIT_EXT_texture_filter_anisotropic")||this._gl.getExtension("MOZ_EXT_texture_filter_anisotropic"),uintIndices:this._webGLVersion>1||null!==this._gl.getExtension("OES_element_index_uint"),fragmentDepthSupported:this._webGLVersion>1||null!==this._gl.getExtension("EXT_frag_depth"),highPrecisionShaderSupported:!1,timerQuery:this._gl.getExtension("EXT_disjoint_timer_query_webgl2")||this._gl.getExtension("EXT_disjoint_timer_query"),supportOcclusionQuery:this._webGLVersion>1,canUseTimestampForTimerQuery:!1,drawBuffersExtension:!1,maxMSAASamples:1,colorBufferFloat:!!(this._webGLVersion>1&&this._gl.getExtension("EXT_color_buffer_float")),textureFloat:!!(this._webGLVersion>1||this._gl.getExtension("OES_texture_float")),textureHalfFloat:!!(this._webGLVersion>1||this._gl.getExtension("OES_texture_half_float")),textureHalfFloatRender:!1,textureFloatLinearFiltering:!1,textureFloatRender:!1,textureHalfFloatLinearFiltering:!1,vertexArrayObject:!1,instancedArrays:!1,textureLOD:!!(this._webGLVersion>1||this._gl.getExtension("EXT_shader_texture_lod")),blendMinMax:!1,multiview:this._gl.getExtension("OVR_multiview2"),oculusMultiview:this._gl.getExtension("OCULUS_multiview"),depthTextureExtension:!1,canUseGLInstanceID:this._webGLVersion>1,canUseGLVertexID:this._webGLVersion>1,supportComputeShaders:!1,supportSRGBBuffers:!1};this._glVersion=this._gl.getParameter(this._gl.VERSION);var e=this._gl.getExtension("WEBGL_debug_renderer_info");if(null!=e){this._glRenderer=this._gl.getParameter(e.UNMASKED_RENDERER_WEBGL);this._glVendor=this._gl.getParameter(e.UNMASKED_VENDOR_WEBGL)}this._glVendor||(this._glVendor="Unknown vendor");this._glRenderer||(this._glRenderer="Unknown renderer");36193!==this._gl.HALF_FLOAT_OES&&(this._gl.HALF_FLOAT_OES=36193);34842!==this._gl.RGBA16F&&(this._gl.RGBA16F=34842);34836!==this._gl.RGBA32F&&(this._gl.RGBA32F=34836);35056!==this._gl.DEPTH24_STENCIL8&&(this._gl.DEPTH24_STENCIL8=35056);if(this._caps.timerQuery){1===this._webGLVersion&&(this._gl.getQuery=this._caps.timerQuery.getQueryEXT.bind(this._caps.timerQuery));this._caps.canUseTimestampForTimerQuery=this._gl.getQuery(this._caps.timerQuery.TIMESTAMP_EXT,this._caps.timerQuery.QUERY_COUNTER_BITS_EXT)>0}this._caps.maxAnisotropy=this._caps.textureAnisotropicFilterExtension?this._gl.getParameter(this._caps.textureAnisotropicFilterExtension.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0;this._caps.textureFloatLinearFiltering=!(!this._caps.textureFloat||!this._gl.getExtension("OES_texture_float_linear"));this._caps.textureFloatRender=!(!this._caps.textureFloat||!this._canRenderToFloatFramebuffer());this._caps.textureHalfFloatLinearFiltering=!!(this._webGLVersion>1||this._caps.textureHalfFloat&&this._gl.getExtension("OES_texture_half_float_linear"));this._caps.astc&&(this._gl.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR=this._caps.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR);this._caps.bptc&&(this._gl.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT=this._caps.bptc.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT);if(this._caps.s3tc_srgb){this._gl.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=this._caps.s3tc_srgb.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;this._gl.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=this._caps.s3tc_srgb.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}this._webGLVersion>1&&5131!==this._gl.HALF_FLOAT_OES&&(this._gl.HALF_FLOAT_OES=5131);this._caps.textureHalfFloatRender=this._caps.textureHalfFloat&&this._canRenderToHalfFloatFramebuffer();if(this._webGLVersion>1){this._caps.drawBuffersExtension=!0;this._caps.maxMSAASamples=this._gl.getParameter(this._gl.MAX_SAMPLES)}else{var t=this._gl.getExtension("WEBGL_draw_buffers");if(null!==t){this._caps.drawBuffersExtension=!0;this._gl.drawBuffers=t.drawBuffersWEBGL.bind(t);this._gl.DRAW_FRAMEBUFFER=this._gl.FRAMEBUFFER;for(var n=0;n<16;n++)this._gl["COLOR_ATTACHMENT"+n+"_WEBGL"]=t["COLOR_ATTACHMENT"+n+"_WEBGL"]}}if(this._webGLVersion>1)this._caps.depthTextureExtension=!0;else{var r=this._gl.getExtension("WEBGL_depth_texture");if(null!=r){this._caps.depthTextureExtension=!0;this._gl.UNSIGNED_INT_24_8=r.UNSIGNED_INT_24_8_WEBGL}}if(this.disableVertexArrayObjects)this._caps.vertexArrayObject=!1;else if(this._webGLVersion>1)this._caps.vertexArrayObject=!0;else{var i=this._gl.getExtension("OES_vertex_array_object");if(null!=i){this._caps.vertexArrayObject=!0;this._gl.createVertexArray=i.createVertexArrayOES.bind(i);this._gl.bindVertexArray=i.bindVertexArrayOES.bind(i);this._gl.deleteVertexArray=i.deleteVertexArrayOES.bind(i)}}if(this._webGLVersion>1)this._caps.instancedArrays=!0;else{var s=this._gl.getExtension("ANGLE_instanced_arrays");if(null!=s){this._caps.instancedArrays=!0;this._gl.drawArraysInstanced=s.drawArraysInstancedANGLE.bind(s);this._gl.drawElementsInstanced=s.drawElementsInstancedANGLE.bind(s);this._gl.vertexAttribDivisor=s.vertexAttribDivisorANGLE.bind(s)}else this._caps.instancedArrays=!1}if(this._gl.getShaderPrecisionFormat){var o=this._gl.getShaderPrecisionFormat(this._gl.VERTEX_SHADER,this._gl.HIGH_FLOAT),u=this._gl.getShaderPrecisionFormat(this._gl.FRAGMENT_SHADER,this._gl.HIGH_FLOAT);o&&u&&(this._caps.highPrecisionShaderSupported=0!==o.precision&&0!==u.precision)}if(this._webGLVersion>1)this._caps.blendMinMax=!0;else{var a=this._gl.getExtension("EXT_blend_minmax");if(null!=a){this._caps.blendMinMax=!0;this._gl.MAX=a.MAX_EXT;this._gl.MIN=a.MIN_EXT}}if(this._webGLVersion>1)this._caps.supportSRGBBuffers=!0;else{var f=this._gl.getExtension("EXT_sRGB");if(null!=f){this._caps.supportSRGBBuffers=!0;this._gl.SRGB=f.SRGB_EXT;this._gl.SRGB8=f.SRGB_ALPHA_EXT;this._gl.SRGB8_ALPHA8=f.SRGB_ALPHA_EXT}}this._depthCullingState.depthTest=!0;this._depthCullingState.depthFunc=this._gl.LEQUAL;this._depthCullingState.depthMask=!0;this._maxSimultaneousTextures=this._caps.maxCombinedTexturesImageUnits;for(var l=0;l<this._maxSimultaneousTextures;l++)this._nextFreeTextureSlots.push(l)};e.prototype._initFeatures=function(){this._features={forceBitmapOverHTMLImageElement:!1,supportRenderAndCopyToLodForFloatTextures:1!==this._webGLVersion,supportDepthStencilTexture:1!==this._webGLVersion,supportShadowSamplers:1!==this._webGLVersion,uniformBufferHardCheckMatrix:!1,allowTexturePrefiltering:1!==this._webGLVersion,trackUbosInFrame:!1,checkUbosContentBeforeUpload:!1,supportCSM:1!==this._webGLVersion,basisNeedsPOT:1===this._webGLVersion,support3DTextures:1!==this._webGLVersion,needTypeSuffixInShaderConstants:1!==this._webGLVersion,supportMSAA:1!==this._webGLVersion,supportSSAO2:1!==this._webGLVersion,supportExtendedTextureFormats:1!==this._webGLVersion,supportSwitchCaseInShader:1!==this._webGLVersion,supportSyncTextureRead:!0,needsInvertingBitmap:!0,useUBOBindingCache:!0,needShaderCodeInlining:!1,_collectUbosUpdatedInFrame:!1}};Object.defineProperty(e.prototype,"webGLVersion",{get:function(){return this._webGLVersion},enumerable:!1,configurable:!0});e.prototype.getClassName=function(){return"ThinEngine"};Object.defineProperty(e.prototype,"isStencilEnable",{get:function(){return this._isStencilEnable},enumerable:!1,configurable:!0});e.prototype._prepareWorkingCanvas=function(){if(!this._workingCanvas){this._workingCanvas=this.createCanvas(1,1);var e=this._workingCanvas.getContext("2d");e&&(this._workingContext=e)}};e.prototype.resetTextureCache=function(){for(var e in this._boundTexturesCache)this._boundTexturesCache.hasOwnProperty(e)&&(this._boundTexturesCache[e]=null);this._currentTextureChannel=-1};e.prototype.getInfo=function(){return this.getGlInfo()};e.prototype.getGlInfo=function(){return{vendor:this._glVendor,renderer:this._glRenderer,version:this._glVersion}};e.prototype.setHardwareScalingLevel=function(e){this._hardwareScalingLevel=e;this.resize()};e.prototype.getHardwareScalingLevel=function(){return this._hardwareScalingLevel};e.prototype.getLoadedTexturesCache=function(){return this._internalTexturesCache};e.prototype.getCaps=function(){return this._caps};e.prototype.stopRenderLoop=function(e){if(e){var t=this._activeRenderLoops.indexOf(e);t>=0&&this._activeRenderLoops.splice(t,1)}else this._activeRenderLoops=[]};e.prototype._renderLoop=function(){if(!this._contextWasLost){var e=!0;!this.renderEvenInBackground&&this._windowIsBackground&&(e=!1);if(e){this.beginFrame();for(var t=0;t<this._activeRenderLoops.length;t++){(0,this._activeRenderLoops[t])()}this.endFrame()}}this._activeRenderLoops.length>0?this._frameHandler=this._queueNewFrame(this._boundRenderFunction,this.getHostWindow()):this._renderingQueueLaunched=!1};e.prototype.getRenderingCanvas=function(){return this._renderingCanvas};e.prototype.getAudioContext=function(){return this._audioContext};e.prototype.getAudioDestination=function(){return this._audioDestination};e.prototype.getHostWindow=function(){return oT()?this._renderingCanvas&&this._renderingCanvas.ownerDocument&&this._renderingCanvas.ownerDocument.defaultView?this._renderingCanvas.ownerDocument.defaultView:window:null};e.prototype.getRenderWidth=function(e){void 0===e&&(e=!1);return!e&&this._currentRenderTarget?this._currentRenderTarget.width:this._framebufferDimensionsObject?this._framebufferDimensionsObject.framebufferWidth:this._gl.drawingBufferWidth};e.prototype.getRenderHeight=function(e){void 0===e&&(e=!1);return!e&&this._currentRenderTarget?this._currentRenderTarget.height:this._framebufferDimensionsObject?this._framebufferDimensionsObject.framebufferHeight:this._gl.drawingBufferHeight};e.prototype._queueNewFrame=function(t,n){return e.QueueNewFrame(t,n)};e.prototype.runRenderLoop=function(e){if(-1===this._activeRenderLoops.indexOf(e)){this._activeRenderLoops.push(e);if(!this._renderingQueueLaunched){this._renderingQueueLaunched=!0;this._boundRenderFunction=this._renderLoop.bind(this);this._frameHandler=this._queueNewFrame(this._boundRenderFunction,this.getHostWindow())}}};e.prototype.clear=function(e,t,n,r){void 0===r&&(r=!1);var i=this.stencilStateComposer.useStencilGlobalOnly;this.stencilStateComposer.useStencilGlobalOnly=!0;this.applyStates();this.stencilStateComposer.useStencilGlobalOnly=i;var s=0;if(t&&e){this._gl.clearColor(e.r,e.g,e.b,void 0!==e.a?e.a:1);s|=this._gl.COLOR_BUFFER_BIT}if(n){if(this.useReverseDepthBuffer){this._depthCullingState.depthFunc=this._gl.GEQUAL;this._gl.clearDepth(0)}else this._gl.clearDepth(1);s|=this._gl.DEPTH_BUFFER_BIT}if(r){this._gl.clearStencil(0);s|=this._gl.STENCIL_BUFFER_BIT}this._gl.clear(s)};e.prototype._viewport=function(e,t,n,r){if(e!==this._viewportCached.x||t!==this._viewportCached.y||n!==this._viewportCached.z||r!==this._viewportCached.w){this._viewportCached.x=e;this._viewportCached.y=t;this._viewportCached.z=n;this._viewportCached.w=r;this._gl.viewport(e,t,n,r)}};e.prototype.setViewport=function(e,t,n){var r=t||this.getRenderWidth(),i=n||this.getRenderHeight(),s=e.x||0,o=e.y||0;this._cachedViewport=e;this._viewport(s*r,o*i,r*e.width,i*e.height)};e.prototype.beginFrame=function(){};e.prototype.endFrame=function(){this._badOS&&this.flushFramebuffer();this._frameId++};e.prototype.resize=function(e){void 0===e&&(e=!1);var t,n;if(oT()){t=this._renderingCanvas?this._renderingCanvas.clientWidth||this._renderingCanvas.width:window.innerWidth;n=this._renderingCanvas?this._renderingCanvas.clientHeight||this._renderingCanvas.height:window.innerHeight}else{t=this._renderingCanvas?this._renderingCanvas.width:100;n=this._renderingCanvas?this._renderingCanvas.height:100}this.setSize(t/this._hardwareScalingLevel,n/this._hardwareScalingLevel,e)};e.prototype.setSize=function(e,t,n){void 0===n&&(n=!1);if(!this._renderingCanvas)return!1;e|=0;t|=0;if(!n&&this._renderingCanvas.width===e&&this._renderingCanvas.height===t)return!1;this._renderingCanvas.width=e;this._renderingCanvas.height=t;return!0};e.prototype.bindFramebuffer=function(e,t,n,r,i,s,o){var u,a,f,l,c;void 0===t&&(t=0);void 0===s&&(s=0);void 0===o&&(o=0);var h=e;this._currentRenderTarget&&this.unBindFramebuffer(this._currentRenderTarget);this._currentRenderTarget=e;this._bindUnboundFramebuffer(h._MSAAFramebuffer?h._MSAAFramebuffer:h._framebuffer);var p=this._gl;e.is2DArray?p.framebufferTextureLayer(p.FRAMEBUFFER,p.COLOR_ATTACHMENT0,null===(u=e.texture._hardwareTexture)||void 0===u?void 0:u.underlyingResource,s,o):e.isCube&&p.framebufferTexture2D(p.FRAMEBUFFER,p.COLOR_ATTACHMENT0,p.TEXTURE_CUBE_MAP_POSITIVE_X+t,null===(a=e.texture._hardwareTexture)||void 0===a?void 0:a.underlyingResource,s);var d=e._depthStencilTexture;if(d){var v=e._depthStencilTextureWithStencil?p.DEPTH_STENCIL_ATTACHMENT:p.DEPTH_ATTACHMENT;e.is2DArray?p.framebufferTextureLayer(p.FRAMEBUFFER,v,null===(f=d._hardwareTexture)||void 0===f?void 0:f.underlyingResource,s,o):e.isCube?p.framebufferTexture2D(p.FRAMEBUFFER,v,p.TEXTURE_CUBE_MAP_POSITIVE_X+t,null===(l=d._hardwareTexture)||void 0===l?void 0:l.underlyingResource,s):p.framebufferTexture2D(p.FRAMEBUFFER,v,p.TEXTURE_2D,null===(c=d._hardwareTexture)||void 0===c?void 0:c.underlyingResource,s)}if(this._cachedViewport&&!i)this.setViewport(this._cachedViewport,n,r);else{if(!n){n=e.width;s&&(n/=Math.pow(2,s))}if(!r){r=e.height;s&&(r/=Math.pow(2,s))}this._viewport(0,0,n,r)}this.wipeCaches()};e.prototype.setState=function(e,t,n,r,i,s,o){var u,a;void 0===t&&(t=0);void 0===r&&(r=!1);void 0===o&&(o=0);(this._depthCullingState.cull!==e||n)&&(this._depthCullingState.cull=e);var f=null===(a=null!==(u=this.cullBackFaces)&&void 0!==u?u:i)||void 0===a||a?this._gl.BACK:this._gl.FRONT;(this._depthCullingState.cullFace!==f||n)&&(this._depthCullingState.cullFace=f);this.setZOffset(t);this.setZOffsetUnits(o);var l=r?this._gl.CW:this._gl.CCW;(this._depthCullingState.frontFace!==l||n)&&(this._depthCullingState.frontFace=l);this._stencilStateComposer.stencilMaterial=s};e.prototype.setZOffset=function(e){this._depthCullingState.zOffset=this.useReverseDepthBuffer?-e:e};e.prototype.getZOffset=function(){var e=this._depthCullingState.zOffset;return this.useReverseDepthBuffer?-e:e};e.prototype.setZOffsetUnits=function(e){this._depthCullingState.zOffsetUnits=this.useReverseDepthBuffer?-e:e};e.prototype.getZOffsetUnits=function(){var e=this._depthCullingState.zOffsetUnits;return this.useReverseDepthBuffer?-e:e};e.prototype._bindUnboundFramebuffer=function(e){if(this._currentFramebuffer!==e){this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,e);this._currentFramebuffer=e}};e.prototype._currentFrameBufferIsDefaultFrameBuffer=function(){return null===this._currentFramebuffer};e.prototype.generateMipmaps=function(e){this._bindTextureDirectly(this._gl.TEXTURE_2D,e,!0);this._gl.generateMipmap(this._gl.TEXTURE_2D);this._bindTextureDirectly(this._gl.TEXTURE_2D,null)};e.prototype.unBindFramebuffer=function(e,t,n){var r;void 0===t&&(t=!1);var i=e;this._currentRenderTarget=null;var s=this._gl;if(i._MSAAFramebuffer){if(e.isMulti){this.unBindMultiColorAttachmentFramebuffer(e,t,n);return}s.bindFramebuffer(s.READ_FRAMEBUFFER,i._MSAAFramebuffer);s.bindFramebuffer(s.DRAW_FRAMEBUFFER,i._framebuffer);s.blitFramebuffer(0,0,e.width,e.height,0,0,e.width,e.height,s.COLOR_BUFFER_BIT,s.NEAREST)}!(null===(r=e.texture)||void 0===r?void 0:r.generateMipMaps)||t||e.isCube||this.generateMipmaps(e.texture);if(n){i._MSAAFramebuffer&&this._bindUnboundFramebuffer(i._framebuffer);n()}this._bindUnboundFramebuffer(null)};e.prototype.flushFramebuffer=function(){this._gl.flush()};e.prototype.restoreDefaultFramebuffer=function(){this._currentRenderTarget?this.unBindFramebuffer(this._currentRenderTarget):this._bindUnboundFramebuffer(null);this._cachedViewport&&this.setViewport(this._cachedViewport);this.wipeCaches()};e.prototype._resetVertexBufferBinding=function(){this.bindArrayBuffer(null);this._cachedVertexBuffers=null};e.prototype.createVertexBuffer=function(e){return this._createVertexBuffer(e,this._gl.STATIC_DRAW)};e.prototype._createVertexBuffer=function(e,t){var n=this._gl.createBuffer();if(!n)throw new Error("Unable to create vertex buffer");var r=new XT(n);this.bindArrayBuffer(r);e instanceof Array?this._gl.bufferData(this._gl.ARRAY_BUFFER,new Float32Array(e),this._gl.STATIC_DRAW):this._gl.bufferData(this._gl.ARRAY_BUFFER,e,this._gl.STATIC_DRAW);this._resetVertexBufferBinding();r.references=1;return r};e.prototype.createDynamicVertexBuffer=function(e){return this._createVertexBuffer(e,this._gl.DYNAMIC_DRAW)};e.prototype._resetIndexBufferBinding=function(){this.bindIndexBuffer(null);this._cachedIndexBuffer=null};e.prototype.createIndexBuffer=function(e,t){var n=this._gl.createBuffer(),r=new XT(n);if(!n)throw new Error("Unable to create index buffer");this.bindIndexBuffer(r);var i=this._normalizeIndexData(e);this._gl.bufferData(this._gl.ELEMENT_ARRAY_BUFFER,i,t?this._gl.DYNAMIC_DRAW:this._gl.STATIC_DRAW);this._resetIndexBufferBinding();r.references=1;r.is32Bits=4===i.BYTES_PER_ELEMENT;return r};e.prototype._normalizeIndexData=function(e){if(e instanceof Uint16Array)return e;if(this._caps.uintIndices){if(e instanceof Uint32Array)return e;for(var t=0;t<e.length;t++)if(e[t]>=65535)return new Uint32Array(e);return new Uint16Array(e)}return new Uint16Array(e)};e.prototype.bindArrayBuffer=function(e){this._vaoRecordInProgress||this._unbindVertexArrayObject();this.bindBuffer(e,this._gl.ARRAY_BUFFER)};e.prototype.bindUniformBlock=function(e,t,n){var r=e.program,i=this._gl.getUniformBlockIndex(r,t);this._gl.uniformBlockBinding(r,i,n)};e.prototype.bindIndexBuffer=function(e){this._vaoRecordInProgress||this._unbindVertexArrayObject();this.bindBuffer(e,this._gl.ELEMENT_ARRAY_BUFFER)};e.prototype.bindBuffer=function(e,t){if(this._vaoRecordInProgress||this._currentBoundBuffer[t]!==e){this._gl.bindBuffer(t,e?e.underlyingResource:null);this._currentBoundBuffer[t]=e}};e.prototype.updateArrayBuffer=function(e){this._gl.bufferSubData(this._gl.ARRAY_BUFFER,0,e)};e.prototype._vertexAttribPointer=function(e,t,n,r,i,s,o){var u=this._currentBufferPointers[t];if(u){var a=!1;if(u.active){if(u.buffer!==e){u.buffer=e;a=!0}if(u.size!==n){u.size=n;a=!0}if(u.type!==r){u.type=r;a=!0}if(u.normalized!==i){u.normalized=i;a=!0}if(u.stride!==s){u.stride=s;a=!0}if(u.offset!==o){u.offset=o;a=!0}}else{a=!0;u.active=!0;u.index=t;u.size=n;u.type=r;u.normalized=i;u.stride=s;u.offset=o;u.buffer=e}if(a||this._vaoRecordInProgress){this.bindArrayBuffer(e);this._gl.vertexAttribPointer(t,n,r,i,s,o)}}};e.prototype._bindIndexBufferWithCache=function(e){if(null!=e&&this._cachedIndexBuffer!==e){this._cachedIndexBuffer=e;this.bindIndexBuffer(e);this._uintIndicesCurrentlySet=e.is32Bits}};e.prototype._bindVertexBuffersAttributes=function(e,t,n){var r=t.getAttributesNames();this._vaoRecordInProgress||this._unbindVertexArrayObject();this.unbindAllAttributes();for(var i=0;i<r.length;i++){var s=t.getAttributeLocation(i);if(s>=0){var o=r[i],u=null;n&&(u=n[o]);u||(u=e[o]);if(!u)continue;this._gl.enableVertexAttribArray(s);this._vaoRecordInProgress||(this._vertexAttribArraysEnabled[s]=!0);var a=u.getBuffer();if(a){this._vertexAttribPointer(a,s,u.getSize(),u.type,u.normalized,u.byteStride,u.byteOffset);if(u.getIsInstanced()){this._gl.vertexAttribDivisor(s,u.getInstanceDivisor());if(!this._vaoRecordInProgress){this._currentInstanceLocations.push(s);this._currentInstanceBuffers.push(a)}}}}}};e.prototype.recordVertexArrayObject=function(e,t,n,r){var i=this._gl.createVertexArray();this._vaoRecordInProgress=!0;this._gl.bindVertexArray(i);this._mustWipeVertexAttributes=!0;this._bindVertexBuffersAttributes(e,n,r);this.bindIndexBuffer(t);this._vaoRecordInProgress=!1;this._gl.bindVertexArray(null);return i};e.prototype.bindVertexArrayObject=function(e,t){if(this._cachedVertexArrayObject!==e){this._cachedVertexArrayObject=e;this._gl.bindVertexArray(e);this._cachedVertexBuffers=null;this._cachedIndexBuffer=null;this._uintIndicesCurrentlySet=null!=t&&t.is32Bits;this._mustWipeVertexAttributes=!0}};e.prototype.bindBuffersDirectly=function(e,t,n,r,i){if(this._cachedVertexBuffers!==e||this._cachedEffectForVertexBuffers!==i){this._cachedVertexBuffers=e;this._cachedEffectForVertexBuffers=i;var s=i.getAttributesCount();this._unbindVertexArrayObject();this.unbindAllAttributes();for(var o=0,u=0;u<s;u++)if(u<n.length){var a=i.getAttributeLocation(u);if(a>=0){this._gl.enableVertexAttribArray(a);this._vertexAttribArraysEnabled[a]=!0;this._vertexAttribPointer(e,a,n[u],this._gl.FLOAT,!1,r,o)}o+=4*n[u]}}this._bindIndexBufferWithCache(t)};e.prototype._unbindVertexArrayObject=function(){if(this._cachedVertexArrayObject){this._cachedVertexArrayObject=null;this._gl.bindVertexArray(null)}};e.prototype.bindBuffers=function(e,t,n,r){if(this._cachedVertexBuffers!==e||this._cachedEffectForVertexBuffers!==n){this._cachedVertexBuffers=e;this._cachedEffectForVertexBuffers=n;this._bindVertexBuffersAttributes(e,n,r)}this._bindIndexBufferWithCache(t)};e.prototype.unbindInstanceAttributes=function(){for(var e,t=0,n=this._currentInstanceLocations.length;t<n;t++){var r=this._currentInstanceBuffers[t];if(e!=r&&r.references){e=r;this.bindArrayBuffer(r)}var i=this._currentInstanceLocations[t];this._gl.vertexAttribDivisor(i,0)}this._currentInstanceBuffers.length=0;this._currentInstanceLocations.length=0};e.prototype.releaseVertexArrayObject=function(e){this._gl.deleteVertexArray(e)};e.prototype._releaseBuffer=function(e){e.references--;if(0===e.references){this._deleteBuffer(e);return!0}return!1};e.prototype._deleteBuffer=function(e){this._gl.deleteBuffer(e.underlyingResource)};e.prototype.updateAndBindInstancesBuffer=function(e,t,n){this.bindArrayBuffer(e);t&&this._gl.bufferSubData(this._gl.ARRAY_BUFFER,0,t);if(void 0!==n[0].index)this.bindInstancesBuffer(e,n,!0);else for(var r=0;r<4;r++){var i=n[r];if(!this._vertexAttribArraysEnabled[i]){this._gl.enableVertexAttribArray(i);this._vertexAttribArraysEnabled[i]=!0}this._vertexAttribPointer(e,i,4,this._gl.FLOAT,!1,64,16*r);this._gl.vertexAttribDivisor(i,1);this._currentInstanceLocations.push(i);this._currentInstanceBuffers.push(e)}};e.prototype.bindInstancesBuffer=function(e,t,n){void 0===n&&(n=!0);this.bindArrayBuffer(e);var r=0;if(n)for(var i=0;i<t.length;i++){r+=4*(s=t[i]).attributeSize}for(i=0;i<t.length;i++){var s;void 0===(s=t[i]).index&&(s.index=this._currentEffect.getAttributeLocationByName(s.attributeName));if(!(s.index<0)){if(!this._vertexAttribArraysEnabled[s.index]){this._gl.enableVertexAttribArray(s.index);this._vertexAttribArraysEnabled[s.index]=!0}this._vertexAttribPointer(e,s.index,s.attributeSize,s.attributeType||this._gl.FLOAT,s.normalized||!1,r,s.offset);this._gl.vertexAttribDivisor(s.index,void 0===s.divisor?1:s.divisor);this._currentInstanceLocations.push(s.index);this._currentInstanceBuffers.push(e)}}};e.prototype.disableInstanceAttributeByName=function(e){if(this._currentEffect){var t=this._currentEffect.getAttributeLocationByName(e);this.disableInstanceAttribute(t)}};e.prototype.disableInstanceAttribute=function(e){for(var t,n=!1;-1!==(t=this._currentInstanceLocations.indexOf(e));){this._currentInstanceLocations.splice(t,1);this._currentInstanceBuffers.splice(t,1);n=!0;t=this._currentInstanceLocations.indexOf(e)}if(n){this._gl.vertexAttribDivisor(e,0);this.disableAttributeByIndex(e)}};e.prototype.disableAttributeByIndex=function(e){this._gl.disableVertexAttribArray(e);this._vertexAttribArraysEnabled[e]=!1;this._currentBufferPointers[e].active=!1};e.prototype.draw=function(e,t,n,r){this.drawElementsType(e?0:1,t,n,r)};e.prototype.drawPointClouds=function(e,t,n){this.drawArraysType(2,e,t,n)};e.prototype.drawUnIndexed=function(e,t,n,r){this.drawArraysType(e?0:1,t,n,r)};e.prototype.drawElementsType=function(e,t,n,r){this.applyStates();this._reportDrawCall();var i=this._drawMode(e),s=this._uintIndicesCurrentlySet?this._gl.UNSIGNED_INT:this._gl.UNSIGNED_SHORT,o=this._uintIndicesCurrentlySet?4:2;r?this._gl.drawElementsInstanced(i,n,s,t*o,r):this._gl.drawElements(i,n,s,t*o)};e.prototype.drawArraysType=function(e,t,n,r){this.applyStates();this._reportDrawCall();var i=this._drawMode(e);r?this._gl.drawArraysInstanced(i,t,n,r):this._gl.drawArrays(i,t,n)};e.prototype._drawMode=function(e){switch(e){case 0:return this._gl.TRIANGLES;case 2:return this._gl.POINTS;case 1:return this._gl.LINES;case 3:return this._gl.POINTS;case 4:return this._gl.LINES;case 5:return this._gl.LINE_LOOP;case 6:return this._gl.LINE_STRIP;case 7:return this._gl.TRIANGLE_STRIP;case 8:return this._gl.TRIANGLE_FAN;default:return this._gl.TRIANGLES}};e.prototype._reportDrawCall=function(){};e.prototype._releaseEffect=function(e){if(this._compiledEffects[e._key]){delete this._compiledEffects[e._key];this._deletePipelineContext(e.getPipelineContext())}};e.prototype._deletePipelineContext=function(e){var t=e;if(t&&t.program){t.program.__SPECTOR_rebuildProgram=null;this._gl.deleteProgram(t.program)}};e.prototype._getGlobalDefines=function(e){if(!e){var t="";this.isNDCHalfZRange&&(t+="#define IS_NDC_HALF_ZRANGE");if(this.useReverseDepthBuffer){t&&(t+="\n");t+="#define USE_REVERSE_DEPTHBUFFER"}return t}this.isNDCHalfZRange?e.IS_NDC_HALF_ZRANGE="":delete e.IS_NDC_HALF_ZRANGE;this.useReverseDepthBuffer?e.USE_REVERSE_DEPTHBUFFER="":delete e.USE_REVERSE_DEPTHBUFFER};e.prototype.createEffect=function(e,t,n,r,i,s,o,u,a,f){var l;void 0===f&&(f=fT.GLSL);var c=e.vertexElement||e.vertex||e.vertexToken||e.vertexSource||e,h=e.fragmentElement||e.fragment||e.fragmentToken||e.fragmentSource||e,p=this._getGlobalDefines(),d=null!==(l=null!=i?i:t.defines)&&void 0!==l?l:"";p&&(d+=p);var v=c+"+"+h+"@"+d;if(this._compiledEffects[v]){var m=this._compiledEffects[v];o&&m.isReady()&&o(m);return m}var g=new MT(e,t,n,r,this,i,s,o,u,a,v,f);this._compiledEffects[v]=g;return g};e._ConcatenateShader=function(e,t,n){void 0===n&&(n="");return n+(t?t+"\n":"")+e};e.prototype._compileShader=function(t,n,r,i){return this._compileRawShader(e._ConcatenateShader(t,r,i),n)};e.prototype._compileRawShader=function(e,t){for(var n=this._gl;n.getError()!=n.NO_ERROR;);var r=n.createShader("vertex"===t?n.VERTEX_SHADER:n.FRAGMENT_SHADER);if(!r)throw new Error("Something went wrong while creating a gl "+t+" shader object. gl error="+n.getError()+", gl isContextLost="+n.isContextLost()+", _contextWasLost="+this._contextWasLost);n.shaderSource(r,e);n.compileShader(r);return r};e.prototype._getShaderSource=function(e){return this._gl.getShaderSource(e)};e.prototype.createRawShaderProgram=function(e,t,n,r,i){void 0===i&&(i=null);r=r||this._gl;var s=this._compileRawShader(t,"vertex"),o=this._compileRawShader(n,"fragment");return this._createShaderProgram(e,s,o,r,i)};e.prototype.createShaderProgram=function(e,t,n,r,i,s){void 0===s&&(s=null);i=i||this._gl;var o=this._webGLVersion>1?"#version 300 es\n#define WEBGL2 \n":"",u=this._compileShader(t,"vertex",r,o),a=this._compileShader(n,"fragment",r,o);return this._createShaderProgram(e,u,a,i,s)};e.prototype.inlineShaderCode=function(e){return e};e.prototype.createPipelineContext=function(e){var t=new VT;t.engine=this;this._caps.parallelShaderCompile&&(t.isParallelCompiled=!0);return t};e.prototype.createMaterialContext=function(){};e.prototype.createDrawContext=function(){};e.prototype._createShaderProgram=function(e,t,n,r,i){void 0===i&&(i=null);var s=r.createProgram();e.program=s;if(!s)throw new Error("Unable to create program");r.attachShader(s,t);r.attachShader(s,n);r.linkProgram(s);e.context=r;e.vertexShader=t;e.fragmentShader=n;e.isParallelCompiled||this._finalizePipelineContext(e);return s};e.prototype._finalizePipelineContext=function(e){var t=e.context,n=e.vertexShader,r=e.fragmentShader,i=e.program;if(!t.getProgramParameter(i,t.LINK_STATUS)){if(!this._gl.getShaderParameter(n,this._gl.COMPILE_STATUS)){if(s=this._gl.getShaderInfoLog(n)){e.vertexCompilationError=s;throw new Error("VERTEX SHADER "+s)}}if(!this._gl.getShaderParameter(r,this._gl.COMPILE_STATUS)){var s;if(s=this._gl.getShaderInfoLog(r)){e.fragmentCompilationError=s;throw new Error("FRAGMENT SHADER "+s)}}if(o=t.getProgramInfoLog(i)){e.programLinkError=o;throw new Error(o)}}if(this.validateShaderPrograms){t.validateProgram(i);if(!t.getProgramParameter(i,t.VALIDATE_STATUS)){var o;if(o=t.getProgramInfoLog(i)){e.programValidationError=o;throw new Error(o)}}}t.deleteShader(n);t.deleteShader(r);e.vertexShader=void 0;e.fragmentShader=void 0;if(e.onCompiled){e.onCompiled();e.onCompiled=void 0}};e.prototype._preparePipelineContext=function(e,t,n,r,i,s,o,u,a,f){var l=e;l.program=r?this.createRawShaderProgram(l,t,n,void 0,a):this.createShaderProgram(l,t,n,u,void 0,a);l.program.__SPECTOR_rebuildProgram=o};e.prototype._isRenderingStateCompiled=function(e){var t=e;if(this._gl.getProgramParameter(t.program,this._caps.parallelShaderCompile.COMPLETION_STATUS_KHR)){this._finalizePipelineContext(t);return!0}return!1};e.prototype._executeWhenRenderingStateIsCompiled=function(e,t){var n=e;if(n.isParallelCompiled){var r=n.onCompiled;n.onCompiled=r?function(){r();t()}:t}else t()};e.prototype.getUniforms=function(e,t){for(var n=new Array,r=e,i=0;i<t.length;i++)n.push(this._gl.getUniformLocation(r.program,t[i]));return n};e.prototype.getAttributes=function(e,t){for(var n=[],r=e,i=0;i<t.length;i++)try{n.push(this._gl.getAttribLocation(r.program,t[i]))}catch(e){n.push(-1)}return n};e.prototype.enableEffect=function(e){if((e=null!==e&&_T.IsWrapper(e)?e.effect:e)&&e!==this._currentEffect){this._stencilStateComposer.stencilMaterial=void 0;e=e;this.bindSamplers(e);this._currentEffect=e;e.onBind&&e.onBind(e);e._onBindObservable&&e._onBindObservable.notifyObservers(e)}};e.prototype.setInt=function(e,t){if(!e)return!1;this._gl.uniform1i(e,t);return!0};e.prototype.setInt2=function(e,t,n){if(!e)return!1;this._gl.uniform2i(e,t,n);return!0};e.prototype.setInt3=function(e,t,n,r){if(!e)return!1;this._gl.uniform3i(e,t,n,r);return!0};e.prototype.setInt4=function(e,t,n,r,i){if(!e)return!1;this._gl.uniform4i(e,t,n,r,i);return!0};e.prototype.setIntArray=function(e,t){if(!e)return!1;this._gl.uniform1iv(e,t);return!0};e.prototype.setIntArray2=function(e,t){if(!e||t.length%2!=0)return!1;this._gl.uniform2iv(e,t);return!0};e.prototype.setIntArray3=function(e,t){if(!e||t.length%3!=0)return!1;this._gl.uniform3iv(e,t);return!0};e.prototype.setIntArray4=function(e,t){if(!e||t.length%4!=0)return!1;this._gl.uniform4iv(e,t);return!0};e.prototype.setArray=function(e,t){if(!e)return!1;if(t.length<1)return!1;this._gl.uniform1fv(e,t);return!0};e.prototype.setArray2=function(e,t){if(!e||t.length%2!=0)return!1;this._gl.uniform2fv(e,t);return!0};e.prototype.setArray3=function(e,t){if(!e||t.length%3!=0)return!1;this._gl.uniform3fv(e,t);return!0};e.prototype.setArray4=function(e,t){if(!e||t.length%4!=0)return!1;this._gl.uniform4fv(e,t);return!0};e.prototype.setMatrices=function(e,t){if(!e)return!1;this._gl.uniformMatrix4fv(e,!1,t);return!0};e.prototype.setMatrix3x3=function(e,t){if(!e)return!1;this._gl.uniformMatrix3fv(e,!1,t);return!0};e.prototype.setMatrix2x2=function(e,t){if(!e)return!1;this._gl.uniformMatrix2fv(e,!1,t);return!0};e.prototype.setFloat=function(e,t){if(!e)return!1;this._gl.uniform1f(e,t);return!0};e.prototype.setFloat2=function(e,t,n){if(!e)return!1;this._gl.uniform2f(e,t,n);return!0};e.prototype.setFloat3=function(e,t,n,r){if(!e)return!1;this._gl.uniform3f(e,t,n,r);return!0};e.prototype.setFloat4=function(e,t,n,r,i){if(!e)return!1;this._gl.uniform4f(e,t,n,r,i);return!0};e.prototype.applyStates=function(){this._depthCullingState.apply(this._gl);this._stencilStateComposer.apply(this._gl);this._alphaState.apply(this._gl);if(this._colorWriteChanged){this._colorWriteChanged=!1;var e=this._colorWrite;this._gl.colorMask(e,e,e,e)}};e.prototype.setColorWrite=function(e){if(e!==this._colorWrite){this._colorWriteChanged=!0;this._colorWrite=e}};e.prototype.getColorWrite=function(){return this._colorWrite};Object.defineProperty(e.prototype,"depthCullingState",{get:function(){return this._depthCullingState},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"alphaState",{get:function(){return this._alphaState},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"stencilState",{get:function(){return this._stencilState},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"stencilStateComposer",{get:function(){return this._stencilStateComposer},enumerable:!1,configurable:!0});e.prototype.clearInternalTexturesCache=function(){this._internalTexturesCache=[]};e.prototype.wipeCaches=function(e){if(!this.preventCacheWipeBetweenFrames||e){this._currentEffect=null;this._viewportCached.x=0;this._viewportCached.y=0;this._viewportCached.z=0;this._viewportCached.w=0;this._unbindVertexArrayObject();if(e){this._currentProgram=null;this.resetTextureCache();this._stencilStateComposer.reset();this._depthCullingState.reset();this._depthCullingState.depthFunc=this._gl.LEQUAL;this._alphaState.reset();this._alphaMode=1;this._alphaEquation=0;this._colorWrite=!0;this._colorWriteChanged=!0;this._unpackFlipYCached=null;this._gl.pixelStorei(this._gl.UNPACK_COLORSPACE_CONVERSION_WEBGL,this._gl.NONE);this._gl.pixelStorei(this._gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,0);this._mustWipeVertexAttributes=!0;this.unbindAllAttributes()}this._resetVertexBufferBinding();this._cachedIndexBuffer=null;this._cachedEffectForVertexBuffers=null;this.bindIndexBuffer(null)}};e.prototype._getSamplingParameters=function(e,t){var n=this._gl,r=n.NEAREST,i=n.NEAREST;switch(e){case 11:r=n.LINEAR;i=t?n.LINEAR_MIPMAP_NEAREST:n.LINEAR;break;case 3:r=n.LINEAR;i=t?n.LINEAR_MIPMAP_LINEAR:n.LINEAR;break;case 8:r=n.NEAREST;i=t?n.NEAREST_MIPMAP_LINEAR:n.NEAREST;break;case 4:r=n.NEAREST;i=t?n.NEAREST_MIPMAP_NEAREST:n.NEAREST;break;case 5:r=n.NEAREST;i=t?n.LINEAR_MIPMAP_NEAREST:n.LINEAR;break;case 6:r=n.NEAREST;i=t?n.LINEAR_MIPMAP_LINEAR:n.LINEAR;break;case 7:r=n.NEAREST;i=n.LINEAR;break;case 1:r=n.NEAREST;i=n.NEAREST;break;case 9:r=n.LINEAR;i=t?n.NEAREST_MIPMAP_NEAREST:n.NEAREST;break;case 10:r=n.LINEAR;i=t?n.NEAREST_MIPMAP_LINEAR:n.NEAREST;break;case 2:r=n.LINEAR;i=n.LINEAR;break;case 12:r=n.LINEAR;i=n.NEAREST}return{min:i,mag:r}};e.prototype._createTexture=function(){var e=this._gl.createTexture();if(!e)throw new Error("Unable to create texture");return e};e.prototype._createHardwareTexture=function(){return new JT(this._createTexture(),this._gl)};e.prototype._getUseSRGBBuffer=function(e,t){return e&&this._caps.supportSRGBBuffers&&(this.webGLVersion>1||this.isWebGPU||t)};e.prototype._createTextureBase=function(t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m){var g=this;void 0===s&&(s=3);void 0===o&&(o=null);void 0===u&&(u=null);void 0===l&&(l=null);void 0===c&&(c=null);void 0===h&&(h=null);void 0===p&&(p=null);var y="data:"===(t=t||"").substr(0,5),b="blob:"===t.substr(0,5),w=y&&-1!==t.indexOf(";base64,"),E=c||new UT(this,PT.Url),S=t;!this._transformTextureUrl||w||c||l||(t=this._transformTextureUrl(t));S!==t&&(E._originalUrl=S);var x=t.lastIndexOf("."),T=p||(x>-1?t.substring(x).toLowerCase():""),N=null;T.indexOf("?")>-1&&(T=T.split("?")[0]);for(var C=0,k=e._TextureLoaders;C<k.length;C++){var L=k[C];if(L.canLoad(T,d)){N=L;break}}i&&i._addPendingData(E);E.url=t;E.generateMipMaps=!n;E.samplingMode=s;E.invertY=r;E._useSRGBBuffer=this._getUseSRGBBuffer(!!m,n);this._doNotHandleContextLost||(E._buffer=l);var A=null;o&&!c&&(A=E.onLoadedObservable.add(o));c||this._internalTexturesCache.push(E);var O=function(e,r){i&&i._removePendingData(E);if(t===S){A&&E.onLoadedObservable.remove(A);jT.UseFallbackTexture&&g._createTextureBase(jT.FallbackTexture,n,E.invertY,i,s,null,u,a,f,l,E);e=(e||"Unknown error")+(jT.UseFallbackTexture?" - Fallback texture was used":"");E.onErrorObservable.notifyObservers({message:e,exception:r});u&&u(e,r)}else{cT.Warn("Failed to load "+t+", falling back to "+S);g._createTextureBase(S,n,E.invertY,i,s,o,u,a,f,l,E,h,p,d,v,m)}};if(N){var M=function(e){N.loadData(e,E,function(e,t,n,r,o,u){u?O("TextureLoader failed to load data"):a(E,T,i,{width:e,height:t},E.invertY,!n,r,function(){o();return!1},s)},v)};l?l instanceof ArrayBuffer?M(new Uint8Array(l)):ArrayBuffer.isView(l)?M(l):u&&u("Unable to load: only ArrayBuffer or ArrayBufferView is supported",null):this._loadFile(t,function(e){return M(new Uint8Array(e))},void 0,i?i.offlineProvider:void 0,!0,function(e,t){O("Unable to load "+(e&&e.responseURL,t))})}else{var _=function(e){b&&!g._doNotHandleContextLost&&(E._buffer=e);a(E,T,i,e,E.invertY,n,!1,f,s)};!y||w?l&&("string"==typeof l.decoding||l.close)?_(l):e._FileToolsLoadImage(t,_,O,i?i.offlineProvider:null,d,E.invertY&&this._features.needsInvertingBitmap?{imageOrientation:"flipY"}:void 0):"string"==typeof l||l instanceof ArrayBuffer||ArrayBuffer.isView(l)||l instanceof Blob?e._FileToolsLoadImage(l,_,O,i?i.offlineProvider:null,d,E.invertY&&this._features.needsInvertingBitmap?{imageOrientation:"flipY"}:void 0):l&&_(l)}return E};e.prototype.createTexture=function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){var v=this;void 0===i&&(i=3);void 0===s&&(s=null);void 0===o&&(o=null);void 0===u&&(u=null);void 0===a&&(a=null);void 0===f&&(f=null);void 0===l&&(l=null);return this._createTextureBase(e,t,n,r,i,s,o,this._prepareWebGLTexture.bind(this),function(e,t,n,i,s,o){var u=v._gl,a=n.width===e&&n.height===t,l=f?v._getInternalFormat(f,s._useSRGBBuffer):".jpg"!==i||s._useSRGBBuffer?s._useSRGBBuffer?u.SRGB8_ALPHA8:u.RGBA:u.RGB,c=f?v._getInternalFormat(f):".jpg"!==i||s._useSRGBBuffer?u.RGBA:u.RGB;s._useSRGBBuffer&&1===v.webGLVersion&&(c=l);if(a){u.texImage2D(u.TEXTURE_2D,0,l,c,u.UNSIGNED_BYTE,n);return!1}var h=v._caps.maxTextureSize;if(n.width>h||n.height>h||!v._supportsHardwareTextureRescaling){v._prepareWorkingCanvas();if(!v._workingCanvas||!v._workingContext)return!1;v._workingCanvas.width=e;v._workingCanvas.height=t;v._workingContext.drawImage(n,0,0,n.width,n.height,0,0,e,t);u.texImage2D(u.TEXTURE_2D,0,l,c,u.UNSIGNED_BYTE,v._workingCanvas);s.width=e;s.height=t;return!1}var p=new UT(v,PT.Temp);v._bindTextureDirectly(u.TEXTURE_2D,p,!0);u.texImage2D(u.TEXTURE_2D,0,l,c,u.UNSIGNED_BYTE,n);v._rescaleTexture(p,s,r,l,function(){v._releaseTexture(p);v._bindTextureDirectly(u.TEXTURE_2D,s,!0);o()});return!0},u,a,f,l,c,h,d)};e._FileToolsLoadImage=function(e,t,n,r,i,s){throw CT("FileTools")};e.prototype._rescaleTexture=function(e,t,n,r,i){};e.prototype.createRawTexture=function(e,t,n,r,i,s,o,u,a){void 0===u&&(u=null);void 0===a&&(a=0);throw CT("Engine.RawTexture")};e.prototype.createRawCubeTexture=function(e,t,n,r,i,s,o,u){void 0===u&&(u=null);throw CT("Engine.RawTexture")};e.prototype.createRawTexture3D=function(e,t,n,r,i,s,o,u,a,f){void 0===a&&(a=null);void 0===f&&(f=0);throw CT("Engine.RawTexture")};e.prototype.createRawTexture2DArray=function(e,t,n,r,i,s,o,u,a,f){void 0===a&&(a=null);void 0===f&&(f=0);throw CT("Engine.RawTexture")};e.prototype._unpackFlipY=function(e){if(this._unpackFlipYCached!==e){this._gl.pixelStorei(this._gl.UNPACK_FLIP_Y_WEBGL,e?1:0);this.enableUnpackFlipYCached&&(this._unpackFlipYCached=e)}};e.prototype._getUnpackAlignement=function(){return this._gl.getParameter(this._gl.UNPACK_ALIGNMENT)};e.prototype._getTextureTarget=function(e){return e.isCube?this._gl.TEXTURE_CUBE_MAP:e.is3D?this._gl.TEXTURE_3D:e.is2DArray||e.isMultiview?this._gl.TEXTURE_2D_ARRAY:this._gl.TEXTURE_2D};e.prototype.updateTextureSamplingMode=function(e,t,n){void 0===n&&(n=!1);var r=this._getTextureTarget(t),i=this._getSamplingParameters(e,t.generateMipMaps||n);this._setTextureParameterInteger(r,this._gl.TEXTURE_MAG_FILTER,i.mag,t);this._setTextureParameterInteger(r,this._gl.TEXTURE_MIN_FILTER,i.min);if(n){t.generateMipMaps=!0;this._gl.generateMipmap(r)}this._bindTextureDirectly(r,null);t.samplingMode=e};e.prototype.updateTextureDimensions=function(e,t,n,r){void 0===r&&(r=1)};e.prototype.updateTextureWrappingMode=function(e,t,n,r){void 0===n&&(n=null);void 0===r&&(r=null);var i=this._getTextureTarget(e);if(null!==t){this._setTextureParameterInteger(i,this._gl.TEXTURE_WRAP_S,this._getTextureWrapMode(t),e);e._cachedWrapU=t}if(null!==n){this._setTextureParameterInteger(i,this._gl.TEXTURE_WRAP_T,this._getTextureWrapMode(n),e);e._cachedWrapV=n}if((e.is2DArray||e.is3D)&&null!==r){this._setTextureParameterInteger(i,this._gl.TEXTURE_WRAP_R,this._getTextureWrapMode(r),e);e._cachedWrapR=r}this._bindTextureDirectly(i,null)};e.prototype._setupDepthStencilTexture=function(e,t,n,r,i,s){void 0===s&&(s=1);var o=t.width||t,u=t.height||t,a=t.layers||0;e.baseWidth=o;e.baseHeight=u;e.width=o;e.height=u;e.is2DArray=a>0;e.depth=a;e.isReady=!0;e.samples=s;e.generateMipMaps=!1;e.samplingMode=r?2:1;e.type=0;e._comparisonFunction=i;var f=this._gl,l=this._getTextureTarget(e),c=this._getSamplingParameters(e.samplingMode,!1);f.texParameteri(l,f.TEXTURE_MAG_FILTER,c.mag);f.texParameteri(l,f.TEXTURE_MIN_FILTER,c.min);f.texParameteri(l,f.TEXTURE_WRAP_S,f.CLAMP_TO_EDGE);f.texParameteri(l,f.TEXTURE_WRAP_T,f.CLAMP_TO_EDGE);if(0===i){f.texParameteri(l,f.TEXTURE_COMPARE_FUNC,515);f.texParameteri(l,f.TEXTURE_COMPARE_MODE,f.NONE)}else{f.texParameteri(l,f.TEXTURE_COMPARE_FUNC,i);f.texParameteri(l,f.TEXTURE_COMPARE_MODE,f.COMPARE_REF_TO_TEXTURE)}};e.prototype._uploadCompressedDataToTextureDirectly=function(e,t,n,r,i,s,o){void 0===s&&(s=0);void 0===o&&(o=0);var u=this._gl,a=u.TEXTURE_2D;e.isCube&&(a=u.TEXTURE_CUBE_MAP_POSITIVE_X+s);if(e._useSRGBBuffer)switch(t){case 36492:t=u.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT;break;case 37808:t=u.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR;break;case 33776:this._caps.s3tc_srgb?t=u.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT:e._useSRGBBuffer=!1;break;case 33779:this._caps.s3tc_srgb?t=u.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT:e._useSRGBBuffer=!1;break;default:e._useSRGBBuffer=!1}this._gl.compressedTexImage2D(a,o,t,n,r,0,i)};e.prototype._uploadDataToTextureDirectly=function(e,t,n,r,i,s){void 0===n&&(n=0);void 0===r&&(r=0);void 0===s&&(s=!1);var o=this._gl,u=this._getWebGLTextureType(e.type),a=this._getInternalFormat(e.format),f=void 0===i?this._getRGBABufferInternalSizedFormat(e.type,e.format,e._useSRGBBuffer):this._getInternalFormat(i,e._useSRGBBuffer);this._unpackFlipY(e.invertY);var l=o.TEXTURE_2D;e.isCube&&(l=o.TEXTURE_CUBE_MAP_POSITIVE_X+n);var c=Math.round(Math.log(e.width)*Math.LOG2E),h=Math.round(Math.log(e.height)*Math.LOG2E),p=s?e.width:Math.pow(2,Math.max(c-r,0)),d=s?e.height:Math.pow(2,Math.max(h-r,0));o.texImage2D(l,r,f,p,d,0,a,u,t)};e.prototype.updateTextureData=function(e,t,n,r,i,s,o,u){void 0===o&&(o=0);void 0===u&&(u=0);var a=this._gl,f=this._getWebGLTextureType(e.type),l=this._getInternalFormat(e.format);this._unpackFlipY(e.invertY);var c=a.TEXTURE_2D;e.isCube&&(c=a.TEXTURE_CUBE_MAP_POSITIVE_X+o);a.texSubImage2D(c,u,n,r,i,s,l,f,t)};e.prototype._uploadArrayBufferViewToTexture=function(e,t,n,r){void 0===n&&(n=0);void 0===r&&(r=0);var i=this._gl,s=e.isCube?i.TEXTURE_CUBE_MAP:i.TEXTURE_2D;this._bindTextureDirectly(s,e,!0);this._uploadDataToTextureDirectly(e,t,n,r);this._bindTextureDirectly(s,null,!0)};e.prototype._prepareWebGLTextureContinuation=function(e,t,n,r,i){var s=this._gl;if(s){var o=this._getSamplingParameters(i,!n);s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,o.mag);s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,o.min);n||r||s.generateMipmap(s.TEXTURE_2D);this._bindTextureDirectly(s.TEXTURE_2D,null);t&&t._removePendingData(e);e.onLoadedObservable.notifyObservers(e);e.onLoadedObservable.clear()}};e.prototype._prepareWebGLTexture=function(t,n,r,i,s,o,u,a,f){var l=this;void 0===f&&(f=3);var c=this.getCaps().maxTextureSize,h=Math.min(c,this.needPOTTextures?e.GetExponentOfTwo(i.width,c):i.width),p=Math.min(c,this.needPOTTextures?e.GetExponentOfTwo(i.height,c):i.height),d=this._gl;if(d)if(t._hardwareTexture){this._bindTextureDirectly(d.TEXTURE_2D,t,!0);this._unpackFlipY(void 0===s||!!s);t.baseWidth=i.width;t.baseHeight=i.height;t.width=h;t.height=p;t.isReady=!0;a(h,p,i,n,t,function(){l._prepareWebGLTextureContinuation(t,r,o,u,f)})||this._prepareWebGLTextureContinuation(t,r,o,u,f)}else r&&r._removePendingData(t)};e.prototype._setupFramebufferDepthAttachments=function(e,t,n,r,i){void 0===i&&(i=1);var s=this._gl;if(e&&t)return this._createRenderBuffer(n,r,i,s.DEPTH_STENCIL,s.DEPTH24_STENCIL8,s.DEPTH_STENCIL_ATTACHMENT);if(t){var o=s.DEPTH_COMPONENT16;this._webGLVersion>1&&(o=s.DEPTH_COMPONENT32F);return this._createRenderBuffer(n,r,i,o,o,s.DEPTH_ATTACHMENT)}return e?this._createRenderBuffer(n,r,i,s.STENCIL_INDEX8,s.STENCIL_INDEX8,s.STENCIL_ATTACHMENT):null};e.prototype._createRenderBuffer=function(e,t,n,r,i,s,o){void 0===o&&(o=!0);var u=this._gl,a=u.createRenderbuffer();u.bindRenderbuffer(u.RENDERBUFFER,a);n>1&&u.renderbufferStorageMultisample?u.renderbufferStorageMultisample(u.RENDERBUFFER,n,i,e,t):u.renderbufferStorage(u.RENDERBUFFER,r,e,t);u.framebufferRenderbuffer(u.FRAMEBUFFER,s,u.RENDERBUFFER,a);o&&u.bindRenderbuffer(u.RENDERBUFFER,null);return a};e.prototype._releaseTexture=function(e){var t;this._deleteTexture(null===(t=e._hardwareTexture)||void 0===t?void 0:t.underlyingResource);this.unbindAllTextures();var n=this._internalTexturesCache.indexOf(e);-1!==n&&this._internalTexturesCache.splice(n,1);e._lodTextureHigh&&e._lodTextureHigh.dispose();e._lodTextureMid&&e._lodTextureMid.dispose();e._lodTextureLow&&e._lodTextureLow.dispose();e._irradianceTexture&&e._irradianceTexture.dispose()};e.prototype._releaseRenderTargetWrapper=function(e){var t=this._renderTargetWrapperCache.indexOf(e);-1!==t&&this._renderTargetWrapperCache.splice(t,1)};e.prototype._deleteTexture=function(e){e&&this._gl.deleteTexture(e)};e.prototype._setProgram=function(e){if(this._currentProgram!==e){this._gl.useProgram(e);this._currentProgram=e}};e.prototype.bindSamplers=function(e){var t=e.getPipelineContext();this._setProgram(t.program);for(var n=e.getSamplers(),r=0;r<n.length;r++){var i=e.getUniform(n[r]);i&&(this._boundUniforms[r]=i)}this._currentEffect=null};e.prototype._activateCurrentTexture=function(){if(this._currentTextureChannel!==this._activeChannel){this._gl.activeTexture(this._gl.TEXTURE0+this._activeChannel);this._currentTextureChannel=this._activeChannel}};e.prototype._bindTextureDirectly=function(e,t,n,r){var i,s;void 0===n&&(n=!1);void 0===r&&(r=!1);var o=!1,u=t&&t._associatedChannel>-1;n&&u&&(this._activeChannel=t._associatedChannel);if(this._boundTexturesCache[this._activeChannel]!==t||r){this._activateCurrentTexture();if(t&&t.isMultiview){console.error(e,t);throw"_bindTextureDirectly called with a multiview texture!"}this._gl.bindTexture(e,null!==(s=null===(i=null==t?void 0:t._hardwareTexture)||void 0===i?void 0:i.underlyingResource)&&void 0!==s?s:null);this._boundTexturesCache[this._activeChannel]=t;t&&(t._associatedChannel=this._activeChannel)}else if(n){o=!0;this._activateCurrentTexture()}u&&!n&&this._bindSamplerUniformToChannel(t._associatedChannel,this._activeChannel);return o};e.prototype._bindTexture=function(e,t,n){if(void 0!==e){t&&(t._associatedChannel=e);this._activeChannel=e;var r=t?this._getTextureTarget(t):this._gl.TEXTURE_2D;this._bindTextureDirectly(r,t)}};e.prototype.unbindAllTextures=function(){for(var e=0;e<this._maxSimultaneousTextures;e++){this._activeChannel=e;this._bindTextureDirectly(this._gl.TEXTURE_2D,null);this._bindTextureDirectly(this._gl.TEXTURE_CUBE_MAP,null);if(this.webGLVersion>1){this._bindTextureDirectly(this._gl.TEXTURE_3D,null);this._bindTextureDirectly(this._gl.TEXTURE_2D_ARRAY,null)}}};e.prototype.setTexture=function(e,t,n,r){if(void 0!==e){t&&(this._boundUniforms[e]=t);this._setTexture(e,n)}};e.prototype._bindSamplerUniformToChannel=function(e,t){var n=this._boundUniforms[e];if(n&&n._currentState!==t){this._gl.uniform1i(n,t);n._currentState=t}};e.prototype._getTextureWrapMode=function(e){switch(e){case 1:return this._gl.REPEAT;case 0:return this._gl.CLAMP_TO_EDGE;case 2:return this._gl.MIRRORED_REPEAT}return this._gl.REPEAT};e.prototype._setTexture=function(e,t,n,r,i){void 0===n&&(n=!1);void 0===r&&(r=!1);void 0===i&&(i="");if(!t){if(null!=this._boundTexturesCache[e]){this._activeChannel=e;this._bindTextureDirectly(this._gl.TEXTURE_2D,null);this._bindTextureDirectly(this._gl.TEXTURE_CUBE_MAP,null);if(this.webGLVersion>1){this._bindTextureDirectly(this._gl.TEXTURE_3D,null);this._bindTextureDirectly(this._gl.TEXTURE_2D_ARRAY,null)}}return!1}if(t.video){this._activeChannel=e;t.update()}else if(4===t.delayLoadState){t.delayLoad();return!1}var s;s=r?t.depthStencilTexture:t.isReady()?t.getInternalTexture():t.isCube?this.emptyCubeTexture:t.is3D?this.emptyTexture3D:t.is2DArray?this.emptyTexture2DArray:this.emptyTexture;!n&&s&&(s._associatedChannel=e);var o=!0;if(this._boundTexturesCache[e]===s){n||this._bindSamplerUniformToChannel(s._associatedChannel,e);o=!1}this._activeChannel=e;var u=this._getTextureTarget(s);o&&this._bindTextureDirectly(u,s,n);if(s&&!s.isMultiview){if(s.isCube&&s._cachedCoordinatesMode!==t.coordinatesMode){s._cachedCoordinatesMode=t.coordinatesMode;var a=3!==t.coordinatesMode&&5!==t.coordinatesMode?1:0;t.wrapU=a;t.wrapV=a}if(s._cachedWrapU!==t.wrapU){s._cachedWrapU=t.wrapU;this._setTextureParameterInteger(u,this._gl.TEXTURE_WRAP_S,this._getTextureWrapMode(t.wrapU),s)}if(s._cachedWrapV!==t.wrapV){s._cachedWrapV=t.wrapV;this._setTextureParameterInteger(u,this._gl.TEXTURE_WRAP_T,this._getTextureWrapMode(t.wrapV),s)}if(s.is3D&&s._cachedWrapR!==t.wrapR){s._cachedWrapR=t.wrapR;this._setTextureParameterInteger(u,this._gl.TEXTURE_WRAP_R,this._getTextureWrapMode(t.wrapR),s)}this._setAnisotropicLevel(u,s,t.anisotropicFilteringLevel)}return!0};e.prototype.setTextureArray=function(e,t,n,r){if(void 0!==e&&t){this._textureUnits&&this._textureUnits.length===n.length||(this._textureUnits=new Int32Array(n.length));for(var i=0;i<n.length;i++){var s=n[i].getInternalTexture();if(s){this._textureUnits[i]=e+i;s._associatedChannel=e+i}else this._textureUnits[i]=-1}this._gl.uniform1iv(t,this._textureUnits);for(var o=0;o<n.length;o++)this._setTexture(this._textureUnits[o],n[o],!0)}};e.prototype._setAnisotropicLevel=function(e,t,n){var r=this._caps.textureAnisotropicFilterExtension;11!==t.samplingMode&&3!==t.samplingMode&&2!==t.samplingMode&&(n=1);if(r&&t._cachedAnisotropicFilteringLevel!==n){this._setTextureParameterFloat(e,r.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(n,this._caps.maxAnisotropy),t);t._cachedAnisotropicFilteringLevel=n}};e.prototype._setTextureParameterFloat=function(e,t,n,r){this._bindTextureDirectly(e,r,!0,!0);this._gl.texParameterf(e,t,n)};e.prototype._setTextureParameterInteger=function(e,t,n,r){r&&this._bindTextureDirectly(e,r,!0,!0);this._gl.texParameteri(e,t,n)};e.prototype.unbindAllAttributes=function(){if(this._mustWipeVertexAttributes){this._mustWipeVertexAttributes=!1;for(var e=0;e<this._caps.maxVertexAttribs;e++)this.disableAttributeByIndex(e)}else{e=0;for(var t=this._vertexAttribArraysEnabled.length;e<t;e++)e>=this._caps.maxVertexAttribs||!this._vertexAttribArraysEnabled[e]||this.disableAttributeByIndex(e)}};e.prototype.releaseEffects=function(){for(var e in this._compiledEffects){var t=this._compiledEffects[e].getPipelineContext();this._deletePipelineContext(t)}this._compiledEffects={}};e.prototype.dispose=function(){var e;this.stopRenderLoop();this.onBeforeTextureInitObservable&&this.onBeforeTextureInitObservable.clear();if(this._emptyTexture){this._releaseTexture(this._emptyTexture);this._emptyTexture=null}if(this._emptyCubeTexture){this._releaseTexture(this._emptyCubeTexture);this._emptyCubeTexture=null}this._dummyFramebuffer&&this._gl.deleteFramebuffer(this._dummyFramebuffer);this.releaseEffects();null===(e=this.releaseComputeEffects)||void 0===e||e.call(this);this.unbindAllAttributes();this._boundUniforms=[];if(oT()&&this._renderingCanvas){if(!this._doNotHandleContextLost){this._renderingCanvas.removeEventListener("webglcontextlost",this._onContextLost);this._renderingCanvas.removeEventListener("webglcontextrestored",this._onContextRestored)}window.removeEventListener("resize",this._checkForMobile)}this._workingCanvas=null;this._workingContext=null;this._currentBufferPointers=[];this._renderingCanvas=null;this._currentProgram=null;this._boundRenderFunction=null;MT.ResetCache();for(var t=0,n=this._activeRequests;t<n.length;t++){n[t].abort()}this.onDisposeObservable.notifyObservers(this);this.onDisposeObservable.clear()};e.prototype.attachContextLostEvent=function(e){this._renderingCanvas&&this._renderingCanvas.addEventListener("webglcontextlost",e,!1)};e.prototype.attachContextRestoredEvent=function(e){this._renderingCanvas&&this._renderingCanvas.addEventListener("webglcontextrestored",e,!1)};e.prototype.getError=function(){return this._gl.getError()};e.prototype._canRenderToFloatFramebuffer=function(){return this._webGLVersion>1?this._caps.colorBufferFloat:this._canRenderToFramebuffer(1)};e.prototype._canRenderToHalfFloatFramebuffer=function(){return this._webGLVersion>1?this._caps.colorBufferFloat:this._canRenderToFramebuffer(2)};e.prototype._canRenderToFramebuffer=function(e){for(var t=this._gl;t.getError()!==t.NO_ERROR;);var n=!0,r=t.createTexture();t.bindTexture(t.TEXTURE_2D,r);t.texImage2D(t.TEXTURE_2D,0,this._getRGBABufferInternalSizedFormat(e),1,1,0,t.RGBA,this._getWebGLTextureType(e),null);t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST);t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST);var i=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,i);t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,r,0);var s=t.checkFramebufferStatus(t.FRAMEBUFFER);if(n=(n=n&&s===t.FRAMEBUFFER_COMPLETE)&&t.getError()===t.NO_ERROR){t.clear(t.COLOR_BUFFER_BIT);n=n&&t.getError()===t.NO_ERROR}if(n){t.bindFramebuffer(t.FRAMEBUFFER,null);var o=t.RGBA,u=t.UNSIGNED_BYTE,a=new Uint8Array(4);t.readPixels(0,0,1,1,o,u,a);n=n&&t.getError()===t.NO_ERROR}t.deleteTexture(r);t.deleteFramebuffer(i);t.bindFramebuffer(t.FRAMEBUFFER,null);for(;!n&&t.getError()!==t.NO_ERROR;);return n};e.prototype._getWebGLTextureType=function(e){if(1===this._webGLVersion){switch(e){case 1:return this._gl.FLOAT;case 2:return this._gl.HALF_FLOAT_OES;case 0:return this._gl.UNSIGNED_BYTE;case 8:return this._gl.UNSIGNED_SHORT_4_4_4_4;case 9:return this._gl.UNSIGNED_SHORT_5_5_5_1;case 10:return this._gl.UNSIGNED_SHORT_5_6_5}return this._gl.UNSIGNED_BYTE}switch(e){case 3:return this._gl.BYTE;case 0:return this._gl.UNSIGNED_BYTE;case 4:return this._gl.SHORT;case 5:return this._gl.UNSIGNED_SHORT;case 6:return this._gl.INT;case 7:return this._gl.UNSIGNED_INT;case 1:return this._gl.FLOAT;case 2:return this._gl.HALF_FLOAT;case 8:return this._gl.UNSIGNED_SHORT_4_4_4_4;case 9:return this._gl.UNSIGNED_SHORT_5_5_5_1;case 10:return this._gl.UNSIGNED_SHORT_5_6_5;case 11:return this._gl.UNSIGNED_INT_2_10_10_10_REV;case 12:return this._gl.UNSIGNED_INT_24_8;case 13:return this._gl.UNSIGNED_INT_10F_11F_11F_REV;case 14:return this._gl.UNSIGNED_INT_5_9_9_9_REV;case 15:return this._gl.FLOAT_32_UNSIGNED_INT_24_8_REV}return this._gl.UNSIGNED_BYTE};e.prototype._getInternalFormat=function(e,t){void 0===t&&(t=!1);var n=t?this._gl.SRGB8_ALPHA8:this._gl.RGBA;switch(e){case 0:n=this._gl.ALPHA;break;case 1:n=this._gl.LUMINANCE;break;case 2:n=this._gl.LUMINANCE_ALPHA;break;case 6:n=this._gl.RED;break;case 7:n=this._gl.RG;break;case 4:n=t?this._gl.SRGB:this._gl.RGB;break;case 5:n=t?this._gl.SRGB8_ALPHA8:this._gl.RGBA}if(this._webGLVersion>1)switch(e){case 8:n=this._gl.RED_INTEGER;break;case 9:n=this._gl.RG_INTEGER;break;case 10:n=this._gl.RGB_INTEGER;break;case 11:n=this._gl.RGBA_INTEGER}return n};e.prototype._getRGBABufferInternalSizedFormat=function(e,t,n){void 0===n&&(n=!1);if(1===this._webGLVersion){if(void 0!==t)switch(t){case 0:return this._gl.ALPHA;case 1:return this._gl.LUMINANCE;case 2:return this._gl.LUMINANCE_ALPHA;case 4:return n?this._gl.SRGB:this._gl.RGB}return this._gl.RGBA}switch(e){case 3:switch(t){case 6:return this._gl.R8_SNORM;case 7:return this._gl.RG8_SNORM;case 4:return this._gl.RGB8_SNORM;case 8:return this._gl.R8I;case 9:return this._gl.RG8I;case 10:return this._gl.RGB8I;case 11:return this._gl.RGBA8I;default:return this._gl.RGBA8_SNORM}case 0:switch(t){case 6:return this._gl.R8;case 7:return this._gl.RG8;case 4:return n?this._gl.SRGB8:this._gl.RGB8;case 5:return n?this._gl.SRGB8_ALPHA8:this._gl.RGBA8;case 8:return this._gl.R8UI;case 9:return this._gl.RG8UI;case 10:return this._gl.RGB8UI;case 11:return this._gl.RGBA8UI;case 0:return this._gl.ALPHA;case 1:return this._gl.LUMINANCE;case 2:return this._gl.LUMINANCE_ALPHA;default:return this._gl.RGBA8}case 4:switch(t){case 8:return this._gl.R16I;case 9:return this._gl.RG16I;case 10:return this._gl.RGB16I;case 11:default:return this._gl.RGBA16I}case 5:switch(t){case 8:return this._gl.R16UI;case 9:return this._gl.RG16UI;case 10:return this._gl.RGB16UI;case 11:default:return this._gl.RGBA16UI}case 6:switch(t){case 8:return this._gl.R32I;case 9:return this._gl.RG32I;case 10:return this._gl.RGB32I;case 11:default:return this._gl.RGBA32I}case 7:switch(t){case 8:return this._gl.R32UI;case 9:return this._gl.RG32UI;case 10:return this._gl.RGB32UI;case 11:default:return this._gl.RGBA32UI}case 1:switch(t){case 6:return this._gl.R32F;case 7:return this._gl.RG32F;case 4:return this._gl.RGB32F;case 5:default:return this._gl.RGBA32F}case 2:switch(t){case 6:return this._gl.R16F;case 7:return this._gl.RG16F;case 4:return this._gl.RGB16F;case 5:default:return this._gl.RGBA16F}case 10:return this._gl.RGB565;case 13:return this._gl.R11F_G11F_B10F;case 14:return this._gl.RGB9_E5;case 8:return this._gl.RGBA4;case 9:return this._gl.RGB5_A1;case 11:switch(t){case 5:return this._gl.RGB10_A2;case 11:return this._gl.RGB10_A2UI;default:return this._gl.RGB10_A2}}return n?this._gl.SRGB8_ALPHA8:this._gl.RGBA8};e.prototype._getRGBAMultiSampleBufferFormat=function(e){return 1===e?this._gl.RGBA32F:2===e?this._gl.RGBA16F:this._gl.RGBA8};e.prototype._loadFile=function(t,n,r,i,s,o){var u=this,a=e._FileToolsLoadFile(t,n,r,i,s,o);this._activeRequests.push(a);a.onCompleteObservable.add(function(e){u._activeRequests.splice(u._activeRequests.indexOf(e),1)});return a};e._FileToolsLoadFile=function(e,t,n,r,i,s){throw CT("FileTools")};e.prototype.readPixels=function(e,t,n,r,i,s){void 0===i&&(i=!0);void 0===s&&(s=!0);var o=i?4:3,u=i?this._gl.RGBA:this._gl.RGB,a=new Uint8Array(r*n*o);s&&this.flushFramebuffer();this._gl.readPixels(e,t,n,r,u,this._gl.UNSIGNED_BYTE,a);return Promise.resolve(a)};Object.defineProperty(e,"IsSupportedAsync",{get:function(){return Promise.resolve(this.isSupported())},enumerable:!1,configurable:!0});Object.defineProperty(e,"IsSupported",{get:function(){return this.isSupported()},enumerable:!1,configurable:!0});e.isSupported=function(){if(null!==this._HasMajorPerformanceCaveat)return!this._HasMajorPerformanceCaveat;if(null===this._IsSupported)try{var e=this._createCanvas(1,1),t=e.getContext("webgl")||e.getContext("experimental-webgl");this._IsSupported=null!=t&&!!window.WebGLRenderingContext}catch(e){this._IsSupported=!1}return this._IsSupported};Object.defineProperty(e,"HasMajorPerformanceCaveat",{get:function(){if(null===this._HasMajorPerformanceCaveat)try{var e=this._createCanvas(1,1),t=e.getContext("webgl",{failIfMajorPerformanceCaveat:!0})||e.getContext("experimental-webgl",{failIfMajorPerformanceCaveat:!0});this._HasMajorPerformanceCaveat=!t}catch(e){this._HasMajorPerformanceCaveat=!1}return this._HasMajorPerformanceCaveat},enumerable:!1,configurable:!0});e.CeilingPOT=function(e){e--;e|=e>>1;e|=e>>2;e|=e>>4;e|=e>>8;e|=e>>16;return++e};e.FloorPOT=function(e){e|=e>>1;e|=e>>2;e|=e>>4;e|=e>>8;return(e|=e>>16)-(e>>1)};e.NearestPOT=function(t){var n=e.CeilingPOT(t),r=e.FloorPOT(t);return n-t>t-r?r:n};e.GetExponentOfTwo=function(t,n,r){void 0===r&&(r=2);var i;switch(r){case 1:i=e.FloorPOT(t);break;case 2:i=e.NearestPOT(t);break;case 3:default:i=e.CeilingPOT(t)}return Math.min(i,n)};e.QueueNewFrame=function(e,t){if(!oT())return"undefined"!=typeof requestAnimationFrame?requestAnimationFrame(e):setTimeout(e,16);t||(t=window);return t.requestPostAnimationFrame?t.requestPostAnimationFrame(e):t.requestAnimationFrame?t.requestAnimationFrame(e):t.msRequestAnimationFrame?t.msRequestAnimationFrame(e):t.webkitRequestAnimationFrame?t.webkitRequestAnimationFrame(e):t.mozRequestAnimationFrame?t.mozRequestAnimationFrame(e):t.oRequestAnimationFrame?t.oRequestAnimationFrame(e):window.setTimeout(e,16)};e.prototype.getHostDocument=function(){return this._renderingCanvas&&this._renderingCanvas.ownerDocument?this._renderingCanvas.ownerDocument:document};e.prototype.getFontOffset=function(e){var t=document.createElement("span");t.innerHTML="Hg";t.setAttribute("style","font: "+e+" !important");var n=document.createElement("div");n.style.display="inline-block";n.style.width="1px";n.style.height="0px";n.style.verticalAlign="bottom";var r=document.createElement("div");r.style.whiteSpace="nowrap";r.appendChild(t);r.appendChild(n);document.body.appendChild(r);var i=0,s=0;try{s=n.getBoundingClientRect().top-t.getBoundingClientRect().top;n.style.verticalAlign="baseline";i=n.getBoundingClientRect().top-t.getBoundingClientRect().top}finally{document.body.removeChild(r)}return{ascent:i,height:s,descent:s-i}};e.ExceptionList=[{key:"Chrome/63.0",capture:"63\\.0\\.3239\\.(\\d+)",captureConstraint:108,targets:["uniformBuffer"]},{key:"Firefox/58",capture:null,captureConstraint:null,targets:["uniformBuffer"]},{key:"Firefox/59",capture:null,captureConstraint:null,targets:["uniformBuffer"]},{key:"Chrome/72.+?Mobile",capture:null,captureConstraint:null,targets:["vao"]},{key:"Chrome/73.+?Mobile",capture:null,captureConstraint:null,targets:["vao"]},{key:"Chrome/74.+?Mobile",capture:null,captureConstraint:null,targets:["vao"]},{key:"Mac OS.+Chrome/71",capture:null,captureConstraint:null,targets:["vao"]},{key:"Mac OS.+Chrome/72",capture:null,captureConstraint:null,targets:["vao"]}];e._TextureLoaders=[];e.CollisionsEpsilon=.001;e._IsSupported=null;e._HasMajorPerformanceCaveat=null;return e})(),YT=function(e,t){return e?e.getClassName&&"Mesh"===e.getClassName()?null:e.getClassName&&"SubMesh"===e.getClassName()?e.clone(t):e.clone?e.clone():null:null};var ZT=(function(){function e(){}e.DeepCopy=function(e,t,n,r){for(var i=0,s=(function(e){var t=[];do{Object.getOwnPropertyNames(e).forEach(function(e){-1===t.indexOf(e)&&t.push(e)})}while(e=Object.getPrototypeOf(e));return t})(e);i<s.length;i++){var o=s[i];if(("_"!==o[0]||r&&-1!==r.indexOf(o))&&!(hT(o,"Observable")||n&&-1!==n.indexOf(o))){var u=e[o],a=typeof u;if("function"!==a)try{if("object"===a)if(u instanceof Array){t[o]=[];if(u.length>0)if("object"==typeof u[0])for(var f=0;f<u.length;f++){var l=YT(u[f],t);-1===t[o].indexOf(l)&&t[o].push(l)}else t[o]=u.slice(0)}else t[o]=YT(u,t);else t[o]=u}catch(e){cT.Warn(e.message)}}}};return e})(),eN=(function(){function e(){}Object.defineProperty(e,"Now",{get:function(){return lT.IsWindowObjectExist()&&window.performance&&window.performance.now?window.performance.now():Date.now()},enumerable:!1,configurable:!0});return e})();var tN,nN=(function(){function e(){this._xhr="undefined"!=typeof _native&&_native.XMLHttpRequest?new _native.XMLHttpRequest:new XMLHttpRequest}e.prototype._injectCustomRequestHeaders=function(){for(var t in e.CustomRequestHeaders){var n=e.CustomRequestHeaders[t];n&&this._xhr.setRequestHeader(t,n)}};Object.defineProperty(e.prototype,"onprogress",{get:function(){return this._xhr.onprogress},set:function(e){this._xhr.onprogress=e},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"readyState",{get:function(){return this._xhr.readyState},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"status",{get:function(){return this._xhr.status},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"statusText",{get:function(){return this._xhr.statusText},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"response",{get:function(){return this._xhr.response},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"responseURL",{get:function(){return this._xhr.responseURL},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"responseText",{get:function(){return this._xhr.responseText},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"responseType",{get:function(){return this._xhr.responseType},set:function(e){this._xhr.responseType=e},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"timeout",{get:function(){return this._xhr.timeout},set:function(e){this._xhr.timeout=e},enumerable:!1,configurable:!0});e.prototype.addEventListener=function(e,t,n){this._xhr.addEventListener(e,t,n)};e.prototype.removeEventListener=function(e,t,n){this._xhr.removeEventListener(e,t,n)};e.prototype.abort=function(){this._xhr.abort()};e.prototype.send=function(t){e.CustomRequestHeaders&&this._injectCustomRequestHeaders();this._xhr.send(t)};e.prototype.open=function(t,n){for(var r=0,i=e.CustomRequestModifiers;r<i.length;r++){(0,i[r])(this._xhr,n)}n=(n=n.replace("file:http:","http:")).replace("file:https:","https:");return this._xhr.open(t,n,!0)};e.prototype.setRequestHeader=function(e,t){this._xhr.setRequestHeader(e,t)};e.prototype.getResponseHeader=function(e){return this._xhr.getResponseHeader(e)};e.CustomRequestHeaders={};e.CustomRequestModifiers=new Array;return e})(),rN=(function(){function e(){}e.FilesToLoad={};return e})(),iN=(function(){function e(){}e.ExponentialBackoff=function(e,t){void 0===e&&(e=3);void 0===t&&(t=500);return function(n,r,i){return 0!==r.status||i>=e||-1!==n.indexOf("file:")?-1:Math.pow(2,i)*t}};return e})(),sN=(function(e){Jx(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t._setPrototypeOf=Object.setPrototypeOf||function(e,t){e.__proto__=t;return e};return t})(Error),oN=(function(){function e(){}e.SetImmediate=function(e){oT()&&window.setImmediate?window.setImmediate(e):setTimeout(e,1)};return e})(),uN=new RegExp(/^data:([^,]+\/[^,]+)?;base64,/i),aN=(function(e){Jx(t,e);function t(n,r){var i=e.call(this,n)||this;i.name="LoadFileError";sN._setPrototypeOf(i,t.prototype);r instanceof nN?i.request=r:i.file=r;return i}return t})(sN),fN=(function(e){Jx(t,e);function t(n,r){var i=e.call(this,n)||this;i.request=r;i.name="RequestFileError";sN._setPrototypeOf(i,t.prototype);return i}return t})(sN),lN=(function(e){Jx(t,e);function t(n,r){var i=e.call(this,n)||this;i.file=r;i.name="ReadFileError";sN._setPrototypeOf(i,t.prototype);return i}return t})(sN),cN={DefaultRetryStrategy:iN.ExponentialBackoff(),BaseUrl:"",CorsBehavior:"anonymous",PreprocessUrl:function(e){return e}},hN=function(e){return e=e.replace(/#/gm,"%23")},pN=function(e,t){if((!e||0!==e.indexOf("data:"))&&cN.CorsBehavior)if("string"==typeof cN.CorsBehavior||cN.CorsBehavior instanceof String)t.crossOrigin=cN.CorsBehavior;else{var n=cN.CorsBehavior(e);n&&(t.crossOrigin=n)}},dN=function(e,t,n,r,i,s){var o,u;void 0===i&&(i="");var a=!1;if(e instanceof ArrayBuffer||ArrayBuffer.isView(e))if("undefined"!=typeof Blob){u=URL.createObjectURL(new Blob([e],{type:i}));a=!0}else u="data:"+i+";base64,"+dT(e);else if(e instanceof Blob){u=URL.createObjectURL(e);a=!0}else{u=hN(e);u=cN.PreprocessUrl(e)}var f=jT.LastCreatedEngine;if("undefined"==typeof Image||null!==(o=null==f?void 0:f._features.forceBitmapOverHTMLImageElement)&&void 0!==o&&o){mN(u,function(r){f.createImageBitmap(new Blob([r],{type:i}),Kx({premultiplyAlpha:"none"},s)).then(function(e){t(e);a&&URL.revokeObjectURL(u)}).catch(function(t){n&&n("Error while trying to load image: "+e,t)})},void 0,r||void 0,!0,function(t,r){if(n){var i=u||e.toString();n("Error while trying to load image: "+(0===i.indexOf("http")||i.length<64?i:i.slice(0,64)+"..."),r)}});return null}var l=new Image;pN(u,l);var c=function(){l.removeEventListener("load",c);l.removeEventListener("error",h);t(l);a&&l.src&&URL.revokeObjectURL(l.src)},h=function(t){l.removeEventListener("load",c);l.removeEventListener("error",h);if(n){var r=e.toString();n("Error while trying to load image: "+(r.length<32?r:r.slice(0,32)+"..."),t)}a&&l.src&&URL.revokeObjectURL(l.src)};l.addEventListener("load",c);l.addEventListener("error",h);var p=function(){l.src=u};if("data:"!==u.substr(0,5)&&r&&r.enableTexturesOffline)r.open(function(){r&&r.loadImage(u,l)},p);else{if(-1!==u.indexOf("file:")){var d=decodeURIComponent(u.substring(5).toLowerCase());if(rN.FilesToLoad[d]){try{var v;try{v=URL.createObjectURL(rN.FilesToLoad[d])}catch(e){v=URL.createObjectURL(rN.FilesToLoad[d])}l.src=v;a=!0}catch(e){l.src=""}return l}}p()}return l},vN=function(e,t,n,r,i){var s=new FileReader,o={onCompleteObservable:new sT,abort:function(){return s.abort()}};s.onloadend=function(e){return o.onCompleteObservable.notifyObservers(o)};i&&(s.onerror=function(t){i(new lN("Unable to read "+e.name,e))});s.onload=function(e){t(e.target.result)};n&&(s.onprogress=n);r?s.readAsArrayBuffer(e):s.readAsText(e);return o},mN=function(e,t,n,r,i,s,o){if(e.name)return vN(e,t,n,i,s?function(e){s(void 0,e)}:void 0);var u=e;if(-1!==u.indexOf("file:")){var a=decodeURIComponent(u.substring(5).toLowerCase());0===a.indexOf("./")&&(a=a.substring(2));var f=rN.FilesToLoad[a];if(f)return vN(f,t,n,i,s?function(e){return s(void 0,new aN(e.message,e.file))}:void 0)}if(bN(u)){var l={onCompleteObservable:new sT,abort:function(){return function(){}}};try{t(i?wN(u):EN(u))}catch(e){s?s(void 0,e):cT.Error(e.message||"Failed to parse the Data URL")}oN.SetImmediate(function(){l.onCompleteObservable.notifyObservers(l)});return l}return gN(u,function(e,n){t(e,n?n.responseURL:void 0)},n,r,i,s?function(e){s(e.request,new aN(e.message,e.request))}:void 0,o)},gN=function(e,t,n,r,i,s,o){e=hN(e);e=cN.PreprocessUrl(e);var u=cN.BaseUrl+e,a=!1,f={onCompleteObservable:new sT,abort:function(){return a=!0}},l=function(){var e=new nN,r=null;f.abort=function(){a=!0;e.readyState!==(XMLHttpRequest.DONE||4)&&e.abort();if(null!==r){clearTimeout(r);r=null}};var l=function(t){var n=t.message||"Unknown error";s?s(new fN(n,e)):cT.Error(n)},c=function(h){e.open("GET",u);if(o)try{o(e)}catch(e){l(e);return}i&&(e.responseType="arraybuffer");n&&e.addEventListener("progress",n);var p=function(){e.removeEventListener("loadend",p);f.onCompleteObservable.notifyObservers(f);f.onCompleteObservable.clear()};e.addEventListener("loadend",p);var d=function(){if(!a&&e.readyState===(XMLHttpRequest.DONE||4)){e.removeEventListener("readystatechange",d);if(e.status>=200&&e.status<300||0===e.status&&(!oT()||yN())){try{t(i?e.response:e.responseText,e)}catch(e){l(e)}return}var n=cN.DefaultRetryStrategy;if(n){var o=n(u,e,h);if(-1!==o){e.removeEventListener("loadend",p);e=new nN;r=setTimeout(function(){return c(h+1)},o);return}}var f=new fN("Error status: "+e.status+" "+e.statusText+" - Unable to load "+u,e);s&&s(f)}};e.addEventListener("readystatechange",d);e.send()};c(0)};if(r&&r.enableSceneOffline){var c=function(e){e&&e.status>400?s&&s(e):l()};r.open(function(){r&&r.loadFile(cN.BaseUrl+e,function(e){a||t(e);f.onCompleteObservable.notifyObservers(f)},n?function(e){a||n(e)}:void 0,c,i)},c)}else l();return f},yN=function(){return"undefined"!=typeof location&&"file:"===location.protocol},bN=function(e){return uN.test(e)},wN=function(e){return mT(e.split(",")[1])},EN=function(e){return vT(e.split(",")[1])},SN={DecodeBase64UrlToBinary:wN,DecodeBase64UrlToString:EN,DefaultRetryStrategy:cN.DefaultRetryStrategy,BaseUrl:cN.BaseUrl,CorsBehavior:cN.CorsBehavior,PreprocessUrl:cN.PreprocessUrl,IsBase64DataUrl:bN,IsFileURL:yN,LoadFile:mN,LoadImage:dN,ReadFile:vN,RequestFile:gN,SetCorsBehavior:pN};Object.defineProperty(SN,"DefaultRetryStrategy",{get:function(){return cN.DefaultRetryStrategy},set:function(e){cN.DefaultRetryStrategy=e}});Object.defineProperty(SN,"BaseUrl",{get:function(){return cN.BaseUrl},set:function(e){cN.BaseUrl=e}});Object.defineProperty(SN,"PreprocessUrl",{get:function(){return cN.PreprocessUrl},set:function(e){cN.PreprocessUrl=e}});Object.defineProperty(SN,"CorsBehavior",{get:function(){return cN.CorsBehavior},set:function(e){cN.CorsBehavior=e}});(function(){GT._FileToolsLoadImage=dN;GT._FileToolsLoadFile=mN;AT._FileToolsLoadFile=mN})();(function(e){e[e.Pending=0]="Pending";e[e.Fulfilled=1]="Fulfilled";e[e.Rejected=2]="Rejected"})(tN||(tN={}));var xN=function(){this.count=0;this.target=0;this.results=[]},TN=(function(){function e(e){var t=this;this._state=tN.Pending;this._children=new Array;this._rejectWasConsumed=!1;if(e)try{e(function(e){t._resolve(e)},function(e){t._reject(e)})}catch(e){this._reject(e)}}Object.defineProperty(e.prototype,"_result",{get:function(){return this._resultValue},set:function(e){this._resultValue=e;this._parent&&void 0===this._parent._result&&(this._parent._result=e)},enumerable:!1,configurable:!0});e.prototype.catch=function(e){return this.then(void 0,e)};e.prototype.then=function(t,n){var r=this,i=new e;i._onFulfilled=t;i._onRejected=n;this._children.push(i);i._parent=this;this._state!==tN.Pending&&setTimeout(function(){r._state===tN.Fulfilled||r._rejectWasConsumed?i._resolve(r._result):i._reject(r._reason)});return i};e.prototype._moveChildren=function(e){var t,n=this;(t=this._children).push.apply(t,e.splice(0,e.length));this._children.forEach(function(e){e._parent=n});if(this._state===tN.Fulfilled)for(var r=0,i=this._children;r<i.length;r++){i[r]._resolve(this._result)}else if(this._state===tN.Rejected)for(var s=0,o=this._children;s<o.length;s++){o[s]._reject(this._reason)}};e.prototype._resolve=function(e){try{this._state=tN.Fulfilled;var t=null;this._onFulfilled&&(t=this._onFulfilled(e));if(null!=t)if(void 0!==t._state){var n=t;n._parent=this;n._moveChildren(this._children);e=n._result}else e=t;this._result=e;for(var r=0,i=this._children;r<i.length;r++){i[r]._resolve(e)}this._children.length=0;delete this._onFulfilled;delete this._onRejected}catch(e){this._reject(e,!0)}};e.prototype._reject=function(e,t){void 0===t&&(t=!1);this._state=tN.Rejected;this._reason=e;if(this._onRejected&&!t)try{this._onRejected(e);this._rejectWasConsumed=!0}catch(t){e=t}for(var n=0,r=this._children;n<r.length;n++){var i=r[n];this._rejectWasConsumed?i._resolve(null):i._reject(e)}this._children.length=0;delete this._onFulfilled;delete this._onRejected};e.resolve=function(t){var n=new e;n._resolve(t);return n};e._RegisterForFulfillment=function(e,t,n){e.then(function(e){t.results[n]=e;t.count++;t.count===t.target&&t.rootPromise._resolve(t.results);return null},function(e){t.rootPromise._state!==tN.Rejected&&t.rootPromise._reject(e)})};e.all=function(t){var n=new e,r=new xN;r.target=t.length;r.rootPromise=n;if(t.length)for(var i=0;i<t.length;i++)e._RegisterForFulfillment(t[i],r,i);else n._resolve([]);return n};e.race=function(t){var n=new e;if(t.length)for(var r=0,i=t;r<i.length;r++){i[r].then(function(e){if(n){n._resolve(e);n=null}return null},function(e){if(n){n._reject(e);n=null}})}return n};return e})(),NN=(function(){function e(){}e.Apply=function(e){void 0===e&&(e=!1);if(e||"undefined"==typeof Promise){window.Promise=TN}};return e})(),CN={};var kN=(function(){function e(){}e.Instantiate=function(e){if(this.RegisteredExternalClasses&&this.RegisteredExternalClasses[e])return this.RegisteredExternalClasses[e];var t=CN[e];if(t)return t;cT.Warn(e+" not found, you may have missed an import.");for(var n=e.split("."),r=window||this,i=0,s=n.length;i<s;i++)r=r[n[i]];return"function"!=typeof r?null:r};e.RegisteredExternalClasses={};return e})();function LN(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})}var AN=(function(){function e(){}Object.defineProperty(e,"BaseUrl",{get:function(){return cN.BaseUrl},set:function(e){cN.BaseUrl=e},enumerable:!1,configurable:!0});Object.defineProperty(e,"DefaultRetryStrategy",{get:function(){return cN.DefaultRetryStrategy},set:function(e){cN.DefaultRetryStrategy=e},enumerable:!1,configurable:!0});Object.defineProperty(e,"CorsBehavior",{get:function(){return cN.CorsBehavior},set:function(e){cN.CorsBehavior=e},enumerable:!1,configurable:!0});Object.defineProperty(e,"UseFallbackTexture",{get:function(){return jT.UseFallbackTexture},set:function(e){jT.UseFallbackTexture=e},enumerable:!1,configurable:!0});Object.defineProperty(e,"RegisteredExternalClasses",{get:function(){return kN.RegisteredExternalClasses},set:function(e){kN.RegisteredExternalClasses=e},enumerable:!1,configurable:!0});Object.defineProperty(e,"fallbackTexture",{get:function(){return jT.FallbackTexture},set:function(e){jT.FallbackTexture=e},enumerable:!1,configurable:!0});e.FetchToRef=function(e,t,n,r,i,s){var o=4*((Math.abs(e)*n%n|0)+(Math.abs(t)*r%r|0)*n);s.r=i[o]/255;s.g=i[o+1]/255;s.b=i[o+2]/255;s.a=i[o+3]/255};e.Mix=function(e,t,n){return e*(1-n)+t*n};e.Instantiate=function(e){return kN.Instantiate(e)};e.Slice=function(e,t,n){return Zx.Slice(e,t,n)};e.SliceToArray=function(e,t,n){return Zx.SliceToArray(e,t,n)};e.SetImmediate=function(e){oN.SetImmediate(e)};e.IsExponentOfTwo=function(e){var t=1;do{t*=2}while(t<e);return t===e};e.FloatRound=function(t){return Math.fround?Math.fround(t):(e._tmpFloatArray[0]=t,e._tmpFloatArray[0])};e.GetFilename=function(e){var t=e.lastIndexOf("/");return t<0?e:e.substring(t+1)};e.GetFolderPath=function(e,t){void 0===t&&(t=!1);var n=e.lastIndexOf("/");return n<0?t?e:"":e.substring(0,n+1)};e.ToDegrees=function(e){return 180*e/Math.PI};e.ToRadians=function(e){return e*Math.PI/180};e.MakeArray=function(e,t){return!0===t||void 0!==e&&null!=e?Array.isArray(e)?e:[e]:null};e.GetPointerPrefix=function(e){var t="pointer";oT()&&!window.PointerEvent&&uT()&&!navigator.pointerEnabled&&(t="mouse");!e._badDesktopOS||e._badOS||document&&"ontouchend"in document||(t="mouse");return t};e.SetCorsBehavior=function(e,t){pN(e,t)};e.CleanUrl=function(e){return e=e.replace(/#/gm,"%23")};Object.defineProperty(e,"PreprocessUrl",{get:function(){return cN.PreprocessUrl},set:function(e){cN.PreprocessUrl=e},enumerable:!1,configurable:!0});e.LoadImage=function(e,t,n,r,i,s){return dN(e,t,n,r,i,s)};e.LoadFile=function(e,t,n,r,i,s){return mN(e,t,n,r,i,s)};e.LoadFileAsync=function(e,t){void 0===t&&(t=!0);return new Promise(function(n,r){mN(e,function(e){n(e)},void 0,void 0,t,function(e,t){r(t)})})};e.LoadScript=function(e,t,n,r){if(oT()){var i=document.getElementsByTagName("head")[0],s=document.createElement("script");s.setAttribute("type","text/javascript");s.setAttribute("src",e);r&&(s.id=r);s.onload=function(){t&&t()};s.onerror=function(t){n&&n("Unable to load script '"+e+"'",t)};i.appendChild(s)}};e.LoadScriptAsync=function(e,t){var n=this;return new Promise(function(t,r){n.LoadScript(e,function(){t()},function(e,t){r(t)})})};e.ReadFileAsDataURL=function(e,t,n){var r=new FileReader,i={onCompleteObservable:new sT,abort:function(){return r.abort()}};r.onloadend=function(e){i.onCompleteObservable.notifyObservers(i)};r.onload=function(e){t(e.target.result)};r.onprogress=n;r.readAsDataURL(e);return i};e.ReadFile=function(e,t,n,r,i){return vN(e,t,n,r,i)};e.FileAsURL=function(e){var t=new Blob([e]);return(window.URL||window.webkitURL).createObjectURL(t)};e.Format=function(e,t){void 0===t&&(t=2);return e.toFixed(t)};e.DeepCopy=function(e,t,n,r){ZT.DeepCopy(e,t,n,r)};e.IsEmpty=function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0};e.RegisterTopRootEvents=function(e,t){for(var n=0;n<t.length;n++){var r=t[n];e.addEventListener(r.name,r.handler,!1);try{window.parent&&window.parent.addEventListener(r.name,r.handler,!1)}catch(e){}}};e.UnregisterTopRootEvents=function(e,t){for(var n=0;n<t.length;n++){var r=t[n];e.removeEventListener(r.name,r.handler);try{e.parent&&e.parent.removeEventListener(r.name,r.handler)}catch(e){}}};e.DumpFramebuffer=function(t,n,r,i,s,o){void 0===s&&(s="image/png");return Qx(this,void 0,void 0,function(){var u,a;return Gx(this,function(f){switch(f.label){case 0:return[4,r.readPixels(0,0,t,n)];case 1:u=f.sent();a=new Uint8Array(u.buffer);e.DumpData(t,n,a,i,s,o,!0);return[2]}})})};e.DumpData=function(t,n,r,i,s,o,u,a,f){void 0===s&&(s="image/png");void 0===u&&(u=!1);void 0===a&&(a=!1);e._ScreenshotCanvas||(e._ScreenshotCanvas=document.createElement("canvas"));e._ScreenshotCanvas.width=t;e._ScreenshotCanvas.height=n;var l=e._ScreenshotCanvas.getContext("2d");if(l){if(r instanceof Float32Array){for(var c=new Uint8Array(r.length),h=r.length;h--;){var p=r[h];c[h]=p<0?0:p>1?1:Math.round(255*p)}r=c}var d=l.createImageData(t,n);d.data.set(r);l.putImageData(d,0,0);var v=e._ScreenshotCanvas;if(u){var m=document.createElement("canvas");m.width=t;m.height=n;var g=m.getContext("2d");if(!g)return;g.translate(0,n);g.scale(1,-1);g.drawImage(e._ScreenshotCanvas,0,0);v=m}a?e.ToBlob(v,function(e){var t=new FileReader;t.onload=function(e){var t=e.target.result;i&&i(t)};t.readAsArrayBuffer(e)},s,f):e.EncodeScreenshotCanvasData(i,s,o,v,f)}};e.DumpDataAsync=function(t,n,r,i,s,o,u,a){void 0===i&&(i="image/png");void 0===o&&(o=!1);void 0===u&&(u=!1);return new Promise(function(f){e.DumpData(t,n,r,function(e){return f(e)},i,s,o,u,a)})};e.ToBlob=function(e,t,n,r){void 0===n&&(n="image/png");e.toBlob||(e.toBlob=function(e,t,n){var r=this;setTimeout(function(){for(var i=atob(r.toDataURL(t,n).split(",")[1]),s=i.length,o=new Uint8Array(s),u=0;u<s;u++)o[u]=i.charCodeAt(u);e(new Blob([o]))})});e.toBlob(function(e){t(e)},n,r)};e.EncodeScreenshotCanvasData=function(t,n,r,i,s){void 0===n&&(n="image/png");if(t){t((null!=i?i:e._ScreenshotCanvas).toDataURL(n,s))}else this.ToBlob(null!=i?i:e._ScreenshotCanvas,function(t){if("download"in document.createElement("a")){if(!r){var n=new Date,i=(n.getFullYear()+"-"+(n.getMonth()+1)).slice(2)+"-"+n.getDate()+"_"+n.getHours()+"-"+("0"+n.getMinutes()).slice(-2);r="screenshot_"+i+".png"}e.Download(t,r)}else{var s=URL.createObjectURL(t),o=window.open("");if(!o)return;var u=o.document.createElement("img");u.onload=function(){URL.revokeObjectURL(s)};u.src=s;o.document.body.appendChild(u)}},n,s)};e.Download=function(e,t){if(navigator&&navigator.msSaveBlob)navigator.msSaveBlob(e,t);else{var n=window.URL.createObjectURL(e),r=document.createElement("a");document.body.appendChild(r);r.style.display="none";r.href=n;r.download=t;r.addEventListener("click",function(){r.parentElement&&r.parentElement.removeChild(r)});r.click();window.URL.revokeObjectURL(n)}};e.BackCompatCameraNoPreventDefault=function(e){return"boolean"==typeof e[0]?e[0]:"boolean"==typeof e[1]&&e[1]};e.CreateScreenshot=function(e,t,n,r,i){void 0===i&&(i="image/png");throw CT("ScreenshotTools")};e.CreateScreenshotAsync=function(e,t,n,r){void 0===r&&(r="image/png");throw CT("ScreenshotTools")};e.CreateScreenshotUsingRenderTarget=function(e,t,n,r,i,s,o,u){void 0===i&&(i="image/png");void 0===s&&(s=1);void 0===o&&(o=!1);throw CT("ScreenshotTools")};e.CreateScreenshotUsingRenderTargetAsync=function(e,t,n,r,i,s,o){void 0===r&&(r="image/png");void 0===i&&(i=1);void 0===s&&(s=!1);throw CT("ScreenshotTools")};e.RandomId=function(){return LN()};e.IsBase64=function(e){return bN(e)};e.DecodeBase64=function(e){return wN(e)};e.GetAbsoluteUrl=function(e){var t=document.createElement("a");t.href=e;return t.href};Object.defineProperty(e,"errorsCount",{get:function(){return cT.errorsCount},enumerable:!1,configurable:!0});e.Log=function(e){cT.Log(e)};e.Warn=function(e){cT.Warn(e)};e.Error=function(e){cT.Error(e)};Object.defineProperty(e,"LogCache",{get:function(){return cT.LogCache},enumerable:!1,configurable:!0});e.ClearLogCache=function(){cT.ClearLogCache()};Object.defineProperty(e,"LogLevels",{set:function(e){cT.LogLevels=e},enumerable:!1,configurable:!0});Object.defineProperty(e,"PerformanceLogLevel",{set:function(t){if((t&e.PerformanceUserMarkLogLevel)!==e.PerformanceUserMarkLogLevel)if((t&e.PerformanceConsoleLogLevel)!==e.PerformanceConsoleLogLevel){e.StartPerformanceCounter=e._StartPerformanceCounterDisabled;e.EndPerformanceCounter=e._EndPerformanceCounterDisabled}else{e.StartPerformanceCounter=e._StartPerformanceConsole;e.EndPerformanceCounter=e._EndPerformanceConsole}else{e.StartPerformanceCounter=e._StartUserMark;e.EndPerformanceCounter=e._EndUserMark}},enumerable:!1,configurable:!0});e._StartPerformanceCounterDisabled=function(e,t){};e._EndPerformanceCounterDisabled=function(e,t){};e._StartUserMark=function(t,n){void 0===n&&(n=!0);if(!e._performance){if(!oT())return;e._performance=window.performance}n&&e._performance.mark&&e._performance.mark(t+"-Begin")};e._EndUserMark=function(t,n){void 0===n&&(n=!0);if(n&&e._performance.mark){e._performance.mark(t+"-End");e._performance.measure(t,t+"-Begin",t+"-End")}};e._StartPerformanceConsole=function(t,n){void 0===n&&(n=!0);if(n){e._StartUserMark(t,n);console.time&&console.time(t)}};e._EndPerformanceConsole=function(t,n){void 0===n&&(n=!0);if(n){e._EndUserMark(t,n);console.timeEnd(t)}};Object.defineProperty(e,"Now",{get:function(){return eN.Now},enumerable:!1,configurable:!0});e.GetClassName=function(e,t){void 0===t&&(t=!1);var n=null;if(!t&&e.getClassName)n=e.getClassName();else{if(e instanceof Object){n=(t?e:Object.getPrototypeOf(e)).constructor.__bjsclassName__}n||(n=typeof e)}return n};e.First=function(e,t){for(var n=0,r=e;n<r.length;n++){var i=r[n];if(t(i))return i}return null};e.getFullClassName=function(e,t){void 0===t&&(t=!1);var n=null,r=null;if(!t&&e.getClassName)n=e.getClassName();else{if(e instanceof Object){var i=t?e:Object.getPrototypeOf(e);n=i.constructor.__bjsclassName__;r=i.constructor.__bjsmoduleName__}n||(n=typeof e)}return n?(null!=r?r+".":"")+n:null};e.DelayAsync=function(e){return new Promise(function(t){setTimeout(function(){t()},e)})};e.IsSafari=function(){return!!uT()&&/^((?!chrome|android).)*safari/i.test(navigator.userAgent)};e.UseCustomRequestHeaders=!1;e.CustomRequestHeaders=nN.CustomRequestHeaders;e._tmpFloatArray=new Float32Array(1);e.GetDOMTextContent=aT;e.NoneLogLevel=cT.NoneLogLevel;e.MessageLogLevel=cT.MessageLogLevel;e.WarningLogLevel=cT.WarningLogLevel;e.ErrorLogLevel=cT.ErrorLogLevel;e.AllLogLevel=cT.AllLogLevel;e.IsWindowObjectExist=oT;e.PerformanceNoneLogLevel=0;e.PerformanceUserMarkLogLevel=1;e.PerformanceConsoleLogLevel=2;e.StartPerformanceCounter=e._StartPerformanceCounterDisabled;e.EndPerformanceCounter=e._EndPerformanceCounterDisabled;return e})();(function(){function e(e,t,n,r){void 0===r&&(r=0);this.iterations=e;this.index=r-1;this._done=!1;this._fn=t;this._successCallback=n}e.prototype.executeNext=function(){if(!this._done)if(this.index+1<this.iterations){++this.index;this._fn(this)}else this.breakLoop()};e.prototype.breakLoop=function(){this._done=!0;this._successCallback()};e.Run=function(t,n,r,i){void 0===i&&(i=0);var s=new e(t,n,r,i);s.executeNext();return s};e.SyncAsyncForLoop=function(t,n,r,i,s,o){void 0===o&&(o=0);return e.Run(Math.ceil(t/n),function(e){s&&s()?e.breakLoop():setTimeout(function(){for(var i=0;i<n;++i){var o=e.index*n+i;if(o>=t)break;r(o);if(s&&s()){e.breakLoop();break}}e.executeNext()},o)},i)}})();jT.FallbackTexture="data:image/jpg;base64,/9j/4AAQSkZJRgABAQEAYABgAAD/4QBmRXhpZgAATU0AKgAAAAgABAEaAAUAAAABAAAAPgEbAAUAAAABAAAARgEoAAMAAAABAAIAAAExAAIAAAAQAAAATgAAAAAAAABgAAAAAQAAAGAAAAABcGFpbnQubmV0IDQuMC41AP/bAEMABAIDAwMCBAMDAwQEBAQFCQYFBQUFCwgIBgkNCw0NDQsMDA4QFBEODxMPDAwSGBITFRYXFxcOERkbGRYaFBYXFv/bAEMBBAQEBQUFCgYGChYPDA8WFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFv/AABEIAQABAAMBIgACEQEDEQH/xAAfAAABBQEBAQEBAQAAAAAAAAAAAQIDBAUGBwgJCgv/xAC1EAACAQMDAgQDBQUEBAAAAX0BAgMABBEFEiExQQYTUWEHInEUMoGRoQgjQrHBFVLR8CQzYnKCCQoWFxgZGiUmJygpKjQ1Njc4OTpDREVGR0hJSlNUVVZXWFlaY2RlZmdoaWpzdHV2d3h5eoOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4eLj5OXm5+jp6vHy8/T19vf4+fr/xAAfAQADAQEBAQEBAQEBAAAAAAAAAQIDBAUGBwgJCgv/xAC1EQACAQIEBAMEBwUEBAABAncAAQIDEQQFITEGEkFRB2FxEyIygQgUQpGhscEJIzNS8BVictEKFiQ04SXxFxgZGiYnKCkqNTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqCg4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2dri4+Tl5ufo6ery8/T19vf4+fr/2gAMAwEAAhEDEQA/APH6KKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FCiiigD6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++gooooA+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gUKKKKAPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76CiiigD5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BQooooA+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/voKKKKAPl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FCiiigD6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++gooooA+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gUKKKKAPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76CiiigD5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BQooooA+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/voKKKKAPl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FCiiigD6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++gooooA+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gUKKKKAPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76P//Z";NN.Apply();GT.prototype.updateRawTexture=function(e,t,n,r,i,s){void 0===i&&(i=null);void 0===s&&(s=0);if(e){var o=this._getRGBABufferInternalSizedFormat(s,n),u=this._getInternalFormat(n),a=this._getWebGLTextureType(s);this._bindTextureDirectly(this._gl.TEXTURE_2D,e,!0);this._unpackFlipY(void 0===r||!!r);if(!this._doNotHandleContextLost){e._bufferView=t;e.format=n;e.type=s;e.invertY=r;e._compression=i}e.width%4!=0&&this._gl.pixelStorei(this._gl.UNPACK_ALIGNMENT,1);i&&t?this._gl.compressedTexImage2D(this._gl.TEXTURE_2D,0,this.getCaps().s3tc[i],e.width,e.height,0,t):this._gl.texImage2D(this._gl.TEXTURE_2D,0,o,e.width,e.height,0,u,a,t);e.generateMipMaps&&this._gl.generateMipmap(this._gl.TEXTURE_2D);this._bindTextureDirectly(this._gl.TEXTURE_2D,null);e.isReady=!0}};GT.prototype.createRawTexture=function(e,t,n,r,i,s,o,u,a,f){void 0===u&&(u=null);void 0===a&&(a=0);void 0===f&&(f=0);var l=new UT(this,PT.Raw);l.baseWidth=t;l.baseHeight=n;l.width=t;l.height=n;l.format=r;l.generateMipMaps=i;l.samplingMode=o;l.invertY=s;l._compression=u;l.type=a;this._doNotHandleContextLost||(l._bufferView=e);this.updateRawTexture(l,e,r,s,u,a);this._bindTextureDirectly(this._gl.TEXTURE_2D,l,!0);var c=this._getSamplingParameters(o,i);this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MAG_FILTER,c.mag);this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MIN_FILTER,c.min);i&&this._gl.generateMipmap(this._gl.TEXTURE_2D);this._bindTextureDirectly(this._gl.TEXTURE_2D,null);this._internalTexturesCache.push(l);return l};GT.prototype.createRawCubeTexture=function(e,t,n,r,i,s,o,u){void 0===u&&(u=null);var a=this._gl,f=new UT(this,PT.CubeRaw);f.isCube=!0;f.format=n;f.type=r;this._doNotHandleContextLost||(f._bufferViewArray=e);var l=this._getWebGLTextureType(r),c=this._getInternalFormat(n);c===a.RGB&&(c=a.RGBA);if(l!==a.FLOAT||this._caps.textureFloatLinearFiltering)if(l!==this._gl.HALF_FLOAT_OES||this._caps.textureHalfFloatLinearFiltering)if(l!==a.FLOAT||this._caps.textureFloatRender){if(l===a.HALF_FLOAT&&!this._caps.colorBufferFloat){i=!1;cT.Warn("Render to half float textures is not supported. Mipmap generation forced to false.")}}else{i=!1;cT.Warn("Render to float textures is not supported. Mipmap generation forced to false.")}else{i=!1;o=1;cT.Warn("Half float texture filtering is not supported. Mipmap generation and sampling mode are forced to false and TEXTURE_NEAREST_SAMPLINGMODE, respectively.")}else{i=!1;o=1;cT.Warn("Float texture filtering is not supported. Mipmap generation and sampling mode are forced to false and TEXTURE_NEAREST_SAMPLINGMODE, respectively.")}var h=t,p=h;f.width=h;f.height=p;!this.needPOTTextures||AN.IsExponentOfTwo(f.width)&&AN.IsExponentOfTwo(f.height)||(i=!1);e&&this.updateRawCubeTexture(f,e,n,r,s,u);this._bindTextureDirectly(this._gl.TEXTURE_CUBE_MAP,f,!0);e&&i&&this._gl.generateMipmap(this._gl.TEXTURE_CUBE_MAP);var d=this._getSamplingParameters(o,i);a.texParameteri(a.TEXTURE_CUBE_MAP,a.TEXTURE_MAG_FILTER,d.mag);a.texParameteri(a.TEXTURE_CUBE_MAP,a.TEXTURE_MIN_FILTER,d.min);a.texParameteri(a.TEXTURE_CUBE_MAP,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE);a.texParameteri(a.TEXTURE_CUBE_MAP,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE);this._bindTextureDirectly(a.TEXTURE_CUBE_MAP,null);f.generateMipMaps=i;f.samplingMode=o;return f};GT.prototype.updateRawCubeTexture=function(e,t,n,r,i,s,o){void 0===s&&(s=null);void 0===o&&(o=0);e._bufferViewArray=t;e.format=n;e.type=r;e.invertY=i;e._compression=s;var u=this._gl,a=this._getWebGLTextureType(r),f=this._getInternalFormat(n),l=this._getRGBABufferInternalSizedFormat(r),c=!1;if(f===u.RGB){f=u.RGBA;c=!0}this._bindTextureDirectly(u.TEXTURE_CUBE_MAP,e,!0);this._unpackFlipY(void 0===i||!!i);e.width%4!=0&&u.pixelStorei(u.UNPACK_ALIGNMENT,1);for(var h=0;h<6;h++){var p=t[h];if(s)u.compressedTexImage2D(u.TEXTURE_CUBE_MAP_POSITIVE_X+h,o,this.getCaps().s3tc[s],e.width,e.height,0,p);else{c&&(p=ON(p,e.width,e.height,r));u.texImage2D(u.TEXTURE_CUBE_MAP_POSITIVE_X+h,o,l,e.width,e.height,0,f,a,p)}}(!this.needPOTTextures||AN.IsExponentOfTwo(e.width)&&AN.IsExponentOfTwo(e.height))&&e.generateMipMaps&&0===o&&this._gl.generateMipmap(this._gl.TEXTURE_CUBE_MAP);this._bindTextureDirectly(this._gl.TEXTURE_CUBE_MAP,null);e.isReady=!0};GT.prototype.createRawCubeTextureFromUrl=function(e,t,n,r,i,s,o,u,a,f,l,c){var h=this;void 0===a&&(a=null);void 0===f&&(f=null);void 0===l&&(l=3);void 0===c&&(c=!1);var p=this._gl,d=this.createRawCubeTexture(null,n,r,i,!s,c,l,null);null==t||t._addPendingData(d);d.url=e;this._internalTexturesCache.push(d);this._loadFile(e,function(e){(function(e){var n=d.width,s=o(e);if(s){if(u){var f=h._getWebGLTextureType(i),l=h._getInternalFormat(r),v=h._getRGBABufferInternalSizedFormat(i),m=!1;if(l===p.RGB){l=p.RGBA;m=!0}h._bindTextureDirectly(p.TEXTURE_CUBE_MAP,d,!0);h._unpackFlipY(!1);for(var g=u(s),y=0;y<g.length;y++)for(var b=n>>y,w=0;w<6;w++){var E=g[y][w];m&&(E=ON(E,b,b,i));p.texImage2D(w,y,v,b,b,0,l,f,E)}h._bindTextureDirectly(p.TEXTURE_CUBE_MAP,null)}else h.updateRawCubeTexture(d,s,r,i,c);d.isReady=!0;null==t||t._removePendingData(d);a&&a()}})(e)},void 0,null==t?void 0:t.offlineProvider,!0,function(e,n){null==t||t._removePendingData(d);f&&e&&f(e.status+" "+e.statusText,n)});return d};function ON(e,t,n,r){var i,s=1;if(1===r)i=new Float32Array(t*n*4);else if(2===r){i=new Uint16Array(t*n*4);s=15360}else i=7===r?new Uint32Array(t*n*4):new Uint8Array(t*n*4);for(var o=0;o<t;o++)for(var u=0;u<n;u++){var a=3*(u*t+o),f=4*(u*t+o);i[f+0]=e[a+0];i[f+1]=e[a+1];i[f+2]=e[a+2];i[f+3]=s}return i}function MN(e){return function(t,n,r,i,s,o,u,a,f,l){void 0===f&&(f=null);void 0===l&&(l=0);var c=e?this._gl.TEXTURE_3D:this._gl.TEXTURE_2D_ARRAY,h=e?PT.Raw3D:PT.Raw2DArray,p=new UT(this,h);p.baseWidth=n;p.baseHeight=r;p.baseDepth=i;p.width=n;p.height=r;p.depth=i;p.format=s;p.type=l;p.generateMipMaps=o;p.samplingMode=a;e?p.is3D=!0:p.is2DArray=!0;this._doNotHandleContextLost||(p._bufferView=t);e?this.updateRawTexture3D(p,t,s,u,f,l):this.updateRawTexture2DArray(p,t,s,u,f,l);this._bindTextureDirectly(c,p,!0);var d=this._getSamplingParameters(a,o);this._gl.texParameteri(c,this._gl.TEXTURE_MAG_FILTER,d.mag);this._gl.texParameteri(c,this._gl.TEXTURE_MIN_FILTER,d.min);o&&this._gl.generateMipmap(c);this._bindTextureDirectly(c,null);this._internalTexturesCache.push(p);return p}}GT.prototype.createRawTexture2DArray=MN(!1);GT.prototype.createRawTexture3D=MN(!0);function _N(e){return function(t,n,r,i,s,o){void 0===s&&(s=null);void 0===o&&(o=0);var u=e?this._gl.TEXTURE_3D:this._gl.TEXTURE_2D_ARRAY,a=this._getWebGLTextureType(o),f=this._getInternalFormat(r),l=this._getRGBABufferInternalSizedFormat(o,r);this._bindTextureDirectly(u,t,!0);this._unpackFlipY(void 0===i||!!i);if(!this._doNotHandleContextLost){t._bufferView=n;t.format=r;t.invertY=i;t._compression=s}t.width%4!=0&&this._gl.pixelStorei(this._gl.UNPACK_ALIGNMENT,1);s&&n?this._gl.compressedTexImage3D(u,0,this.getCaps().s3tc[s],t.width,t.height,t.depth,0,n):this._gl.texImage3D(u,0,l,t.width,t.height,t.depth,0,f,a,n);t.generateMipMaps&&this._gl.generateMipmap(u);this._bindTextureDirectly(u,null);t.isReady=!0}}GT.prototype.updateRawTexture2DArray=_N(!1);GT.prototype.updateRawTexture3D=_N(!0);GT.prototype.setAlphaConstants=function(e,t,n,r){this._alphaState.setAlphaBlendConstants(e,t,n,r)};GT.prototype.setAlphaMode=function(e,t){void 0===t&&(t=!1);if(this._alphaMode!==e){switch(e){case 0:this._alphaState.alphaBlend=!1;break;case 7:this._alphaState.setAlphaBlendFunctionParameters(this._gl.ONE,this._gl.ONE_MINUS_SRC_ALPHA,this._gl.ONE,this._gl.ONE);this._alphaState.alphaBlend=!0;break;case 8:this._alphaState.setAlphaBlendFunctionParameters(this._gl.ONE,this._gl.ONE_MINUS_SRC_ALPHA,this._gl.ONE,this._gl.ONE_MINUS_SRC_ALPHA);this._alphaState.alphaBlend=!0;break;case 2:this._alphaState.setAlphaBlendFunctionParameters(this._gl.SRC_ALPHA,this._gl.ONE_MINUS_SRC_ALPHA,this._gl.ONE,this._gl.ONE);this._alphaState.alphaBlend=!0;break;case 6:this._alphaState.setAlphaBlendFunctionParameters(this._gl.ONE,this._gl.ONE,this._gl.ZERO,this._gl.ONE);this._alphaState.alphaBlend=!0;break;case 1:this._alphaState.setAlphaBlendFunctionParameters(this._gl.SRC_ALPHA,this._gl.ONE,this._gl.ZERO,this._gl.ONE);this._alphaState.alphaBlend=!0;break;case 3:this._alphaState.setAlphaBlendFunctionParameters(this._gl.ZERO,this._gl.ONE_MINUS_SRC_COLOR,this._gl.ONE,this._gl.ONE);this._alphaState.alphaBlend=!0;break;case 4:this._alphaState.setAlphaBlendFunctionParameters(this._gl.DST_COLOR,this._gl.ZERO,this._gl.ONE,this._gl.ONE);this._alphaState.alphaBlend=!0;break;case 5:this._alphaState.setAlphaBlendFunctionParameters(this._gl.SRC_ALPHA,this._gl.ONE_MINUS_SRC_COLOR,this._gl.ONE,this._gl.ONE);this._alphaState.alphaBlend=!0;break;case 9:this._alphaState.setAlphaBlendFunctionParameters(this._gl.CONSTANT_COLOR,this._gl.ONE_MINUS_CONSTANT_COLOR,this._gl.CONSTANT_ALPHA,this._gl.ONE_MINUS_CONSTANT_ALPHA);this._alphaState.alphaBlend=!0;break;case 10:this._alphaState.setAlphaBlendFunctionParameters(this._gl.ONE,this._gl.ONE_MINUS_SRC_COLOR,this._gl.ONE,this._gl.ONE_MINUS_SRC_ALPHA);this._alphaState.alphaBlend=!0;break;case 11:this._alphaState.setAlphaBlendFunctionParameters(this._gl.ONE,this._gl.ONE,this._gl.ONE,this._gl.ONE);this._alphaState.alphaBlend=!0;break;case 12:this._alphaState.setAlphaBlendFunctionParameters(this._gl.DST_ALPHA,this._gl.ONE,this._gl.ZERO,this._gl.ZERO);this._alphaState.alphaBlend=!0;break;case 13:this._alphaState.setAlphaBlendFunctionParameters(this._gl.ONE_MINUS_DST_COLOR,this._gl.ONE_MINUS_SRC_COLOR,this._gl.ONE_MINUS_DST_ALPHA,this._gl.ONE_MINUS_SRC_ALPHA);this._alphaState.alphaBlend=!0;break;case 14:this._alphaState.setAlphaBlendFunctionParameters(this._gl.ONE,this._gl.ONE_MINUS_SRC_ALPHA,this._gl.ONE,this._gl.ONE_MINUS_SRC_ALPHA);this._alphaState.alphaBlend=!0;break;case 15:this._alphaState.setAlphaBlendFunctionParameters(this._gl.ONE,this._gl.ONE,this._gl.ONE,this._gl.ZERO);this._alphaState.alphaBlend=!0;break;case 16:this._alphaState.setAlphaBlendFunctionParameters(this._gl.ONE_MINUS_DST_COLOR,this._gl.ONE_MINUS_SRC_COLOR,this._gl.ZERO,this._gl.ONE);this._alphaState.alphaBlend=!0}t||(this.depthCullingState.depthMask=0===e);this._alphaMode=e}};GT.prototype.getAlphaMode=function(){return this._alphaMode};GT.prototype.setAlphaEquation=function(e){if(this._alphaEquation!==e){switch(e){case 0:this._alphaState.setAlphaEquationParameters(this._gl.FUNC_ADD,this._gl.FUNC_ADD);break;case 1:this._alphaState.setAlphaEquationParameters(this._gl.FUNC_SUBTRACT,this._gl.FUNC_SUBTRACT);break;case 2:this._alphaState.setAlphaEquationParameters(this._gl.FUNC_REVERSE_SUBTRACT,this._gl.FUNC_REVERSE_SUBTRACT);break;case 3:this._alphaState.setAlphaEquationParameters(this._gl.MAX,this._gl.MAX);break;case 4:this._alphaState.setAlphaEquationParameters(this._gl.MIN,this._gl.MIN);break;case 5:this._alphaState.setAlphaEquationParameters(this._gl.MIN,this._gl.FUNC_ADD)}this._alphaEquation=e}};GT.prototype.getAlphaEquation=function(){return this._alphaEquation};GT.prototype.updateDynamicIndexBuffer=function(e,t,n){void 0===n&&(n=0);this._currentBoundBuffer[this._gl.ELEMENT_ARRAY_BUFFER]=null;this.bindIndexBuffer(e);var r;r=t instanceof Uint16Array||t instanceof Uint32Array?t:e.is32Bits?new Uint32Array(t):new Uint16Array(t);this._gl.bufferData(this._gl.ELEMENT_ARRAY_BUFFER,r,this._gl.DYNAMIC_DRAW);this._resetIndexBufferBinding()};GT.prototype.updateDynamicVertexBuffer=function(e,t,n,r){this.bindArrayBuffer(e);void 0===n&&(n=0);var i=t.length||t.byteLength;if(void 0===r||r>=i&&0===n)t instanceof Array?this._gl.bufferSubData(this._gl.ARRAY_BUFFER,n,new Float32Array(t)):this._gl.bufferSubData(this._gl.ARRAY_BUFFER,n,t);else if(t instanceof Array)this._gl.bufferSubData(this._gl.ARRAY_BUFFER,0,new Float32Array(t).subarray(n,n+r));else{t=t instanceof ArrayBuffer?new Uint8Array(t,n,r):new Uint8Array(t.buffer,t.byteOffset+n,r);this._gl.bufferSubData(this._gl.ARRAY_BUFFER,0,t)}this._resetVertexBufferBinding()};GT.prototype.createDynamicTexture=function(e,t,n,r){var i=new UT(this,PT.Dynamic);i.baseWidth=e;i.baseHeight=t;if(n){e=this.needPOTTextures?GT.GetExponentOfTwo(e,this._caps.maxTextureSize):e;t=this.needPOTTextures?GT.GetExponentOfTwo(t,this._caps.maxTextureSize):t}i.width=e;i.height=t;i.isReady=!1;i.generateMipMaps=n;i.samplingMode=r;this.updateTextureSamplingMode(r,i);this._internalTexturesCache.push(i);return i};GT.prototype.updateDynamicTexture=function(e,t,n,r,i,s){void 0===r&&(r=!1);void 0===s&&(s=!1);if(e){var o=this._gl,u=o.TEXTURE_2D,a=this._bindTextureDirectly(u,e,!0,s);this._unpackFlipY(void 0===n?e.invertY:n);r&&o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,1);var f=this._getWebGLTextureType(e.type),l=this._getInternalFormat(i||e.format),c=this._getRGBABufferInternalSizedFormat(e.type,l);o.texImage2D(u,0,c,l,f,t);e.generateMipMaps&&o.generateMipmap(u);a||this._bindTextureDirectly(u,null);r&&o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,0);e.isReady=!0}};function DN(e){var t=e.getParameter(e.MAX_TEXTURE_SIZE);return"number"==typeof t&&t||2048}function PN(e,t,n){return(function(e,t,n){return Math.min(n/e,n/t)})(e,t,DN(n))<1}function HN(e,t){if(t<=0)throw new RangeError("Invalid max Size");for(var n=[],r=0,i=0;i<e.height;){for(;r<e.width;){n.push({left:e.left+r,top:e.top+i,width:Math.min(e.width-r,t),height:Math.min(e.height-i,t)});r+=t}r=0;i+=t}return n}function BN(e,t){return $a(e)?e.renderCanvas(e.canvasMethods.getHTMLCanvas,{x:e.width,y:e.height},t):t.width===e.width&&t.height===e.height&&0===t.left&&0===t.top?e:Va(e)?(function(e,t){if(!Ya(e.width,e.height,e.format,e.bytes))throw Error("Error: Could not extract subImage from invalid ImageBytes array");var n=e.format,r=Ga(n),i=new Uint8Array(t.width*t.height*r),s=(e.width-t.width)*r,o=t.width*r,u=0,a=(t.top*e.width+t.left)*r,f=e.bytes;for(;u<i.length;){i.set(f.subarray(a,a+o),u);u+=o;a+=o+s}return{bytes:i,format:n,width:t.width,height:t.height,id:jN(e,t)}})(e,t):(function(e,t){var n=document.createElement("canvas");n.width=t.width;n.height=t.height;n.id=jN(e,t);var r=n.getContext("2d");if(!r)return;r.drawImage(e,t.left,t.top,t.width,t.height,0,0,t.width,t.height);return n})(e,t)}function jN(e,t){return Qa(e)+(t.left+"_")+t.top+"_"+t.width+"_"+t.height}function FN(e,t,n,r,i){var s=DN(n._gl),o={top:0,left:0,width:e.width,height:e.height},u=[];try{u=HN(o,s).reduce(function(s,o){var u=BN(e,o);if(!u)throw new Error("Failed to create sub texture");var a=(function(e,t,n,r){if(Va(e))return(function(e,t,n,r){if(PN(e.width,e.height,n._gl)){r({id:"ImageTooBig",message:"The supplied image size of "+e.width+"x"+e.height+" exceeds gl.MAX_TEXTURE_SIZE of "+DN(n._gl)});return}var i=e.format===za.RGB?zx.TEXTUREFORMAT_RGB:zx.TEXTUREFORMAT_RGBA;return n.createRawTexture(e.bytes,e.width,e.height,i,t,!1,zx.TEXTURE_TRILINEAR_SAMPLINGMODE,null,zx.TEXTURETYPE_UNSIGNED_BYTE)})(e,t,n,r);if(e instanceof HTMLImageElement)return(function(e,t,n,r){return n.createTexture(null,!t,!1,null,void 0,null,function(e){r({id:"CreateTextureFailed",message:"Babylon engine.createTexture failed with message: "+e})},e)})(e,t,n,r);if(e instanceof HTMLCanvasElement)return(function(e,t,n,r){var i,s=(function(e){var t=e.width,n=e.height,r=document.createElement("canvas");r.width=t;r.height=n;var i=r.getContext("2d");if(i){i.scale(1,-1);i.drawImage(e,0,0,t,n,0,0,e.width,-1*e.height);return r}})(e);if(s){var o=new Vx(s,{generateMipMaps:t,engine:n,samplingMode:zx.TEXTURE_TRILINEAR_SAMPLINGMODE}),u=null!==(i=o.getInternalTexture())&&void 0!==i?i:void 0;u||r({id:"CreateTextureFailed",message:"Failed to create HtmlElementTexture"});return u}r({id:"CreateTextureFailed",message:"Failed to flip canvas"})})(e,t,n,r);return})(u,t,n,i);if(a){var f=new Ux(null);f._texture=a;f.wrapR=zx.TEXTURE_CLAMP_ADDRESSMODE;f.wrapU=zx.TEXTURE_CLAMP_ADDRESSMODE;f.wrapV=zx.TEXTURE_CLAMP_ADDRESSMODE;f.anisotropicFilteringLevel=r;s.push({texture:f,rect:o});if($a(e)){var l=e.canvasMethods,c=l.restoreHTMLCanvas,h=l.clearHTMLCanvas;c&&c();h&&h()}}return s},[])}catch(e){i({id:"CreateTextureFailed",message:(null==e?void 0:e.message)||"sub texture extraction failed."})}return{width:e.width,height:e.height,parts:u}}function IN(e){return 2===(null==e?void 0:e.webGLVersion)}var qN=(function(){function e(e){this.cache={};this.engine=e}e.prototype.getEffectWrapper=function(e,t,n,r,i,s){if(this.cache[e])return this.cache[e].effectWrapperPromise;var o=new BT({engine:this.engine,vertexShader:t,fragmentShader:n,samplerNames:i,attributeNames:r,uniformNames:s,name:e}),u=new Promise(function(e,t){o.effect.onError=function(e,n){t(n)};o.effect.executeWhenCompiled(function(){return e(o)})});this.cache[e]={effectWrapper:o,effectWrapperPromise:u};return u};return e})(),RN=function(e){var t=(null==e?void 0:e._gl)?DN(null==e?void 0:e._gl):void 0,n=Object(i.useMemo)(function(){if(e){return new qx(function(t,n,r,i,s,o){void 0===s&&(s=!0);void 0===o&&(o=zx.TEXTURE_DEFAULT_ANISOTROPIC_FILTERING_LEVEL);var u=FN(t,s=!!IN(e)&&s,e,o,r);u?n(u,u.width,u.height):r({id:"CreateTextureFailed",message:"loadTexture failed to create a texture"})},function(e){e.parts.forEach(function(e){e.texture.dispose()})})}},[e]);(function(e){var t=Object(i.useContext)(me).logMaxTextureSizeEvent;Object(i.useEffect)(function(){e&&t({value:e})},[t,e])})(t);Object(i.useEffect)(function(){return function(){return null==n?void 0:n.dispose()}},[n]);return n},UN=s.a.createContext({canvasContextIsValid:!1}),zN=s.a.memo(function(e){var t=e.children,n=e.width,r=e.height,o=e.cssWidth,u=e.cssHeight,a=e.tabIndex,f=e.onPointerDown,l=e.onPointerMove,c=e.onPointerUp,h=e.onWheel,p=e.onTouchDown,d=e.onTouchMove,v=e.onTouchUp,m=e.onDoubleTap,g=e.cssToPhysicalPixelRatio,y=e.color,b=e.isAnimating,w=Object(i.useState)(null),E=w[0],S=w[1];op(E,g,f,l,c);Jh(E);Qh(g,E,h);up(g,E,p,d,v,m);var x=(function(e){var t=Object(i.useRef)(),n=Object(i.useRef)();Object(i.useLayoutEffect)(function(){if(e){var r=new GT(e,!1,{alpha:!0,antialias:!1,stencil:!1,depth:!1}),i=new HT(r);r.setAlphaMode(zx.ALPHA_COMBINE);r.setViewport({x:0,y:0,width:1,height:1});t.current=r;n.current=i}return function(){var e;null===(e=t.current)||void 0===e||e.dispose();t.current=void 0;n.current=void 0}},[e]);return[t.current,n.current]})(E),T=x[0],N=x[1],C=RN(T),k=(function(e){var t=Object(i.useRef)();Object(i.useLayoutEffect)(function(){e&&(t.current=new qN(e))},[e]);return t.current})(T),L=Object(i.useMemo)(function(){return{canvasContextIsValid:!0,canvas:E||void 0,textures:C,engine:T,effectRenderer:N,effectWrapperManager:k}},[E,C,T,N,k]),A=e.cursor||"default";yh(Object(i.useCallback)(function(){T&&y&&T.clear({r:y[0],g:y[1],b:y[2],a:y[3]},!0,!0)},[T,y]),-1);var O=Object(i.useContext)(vh).renderList;Object(i.useLayoutEffect)(function(){if(E){E.width=n;E.height=r;O.renderNow()}},[n,r,E,O]);return s.a.createElement(UN.Provider,{value:L},s.a.createElement("canvas",{"data-test-id":b?"canvas-animating":"canvas-idle",tabIndex:a,"aria-hidden":void 0===a||a<0,ref:S,style:{cursor:A,width:o,height:u,touchAction:"none",display:"block",position:"absolute",outline:"none"}}),t)}),WN=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),i=0;for(t=0;t<n;t++)for(var s=arguments[t],o=0,u=s.length;o<u;o++,i++)r[i]=s[o];return r};function XN(e,t,n,r,i,s,o,u){void 0===u&&(u=!1);var a=null==i?void 0:i.main;a&&0!==a.parts.length?a.parts.forEach(function(f,l){var c,h,p,d,v=Jn(e,Dn(f.rect.left/a.width,f.rect.top/a.height),Mn(f.rect.width/a.width,f.rect.height/a.height));VN(v,t,u,n,r,{main:f.texture,blend:(null===(h=null===(c=null==i?void 0:i.blend)||void 0===c?void 0:c.parts[l])||void 0===h?void 0:h.texture)||null,overlay:(null===(d=null===(p=null==i?void 0:i.overlay)||void 0===p?void 0:p.parts[l])||void 0===d?void 0:d.texture)||null},s,o)}):VN(e,t,u,n,r,void 0,s,o)}var VN=function(e,t,n,r,i,s,o,u){var a,f;if((null==i?void 0:i.effect.isReady())&&i&&o&&u&&In(e)){var l=i.effect;u.applyEffectWrapper(i);l.setFloat2(Vc,(null===(a=o.getRenderingCanvas())||void 0===a?void 0:a.width)||0,(null===(f=o.getRenderingCanvas())||void 0===f?void 0:f.height)||0);l.setMatrix3x3(Wc,new Float32Array(WN(e,[0,0,1])));l.setMatrix3x3(Xc,new Float32Array(WN(qn(e),[0,0,1])));l.setFloat(Zc,n?1:0);if(null==s?void 0:s.main){l.setTexture(Rc,s.main);(null==s?void 0:s.blend)&&l.setTexture(Kc,s.blend);(null==s?void 0:s.overlay)&&l.setTexture(Gc,s.overlay);l.setFloat($c,0)}else{var c=r||Sh;l.setVector4(Jc,Lg(c));l.setFloat($c,1)}t.onBeforeBabylonRender(l);u.render(i)}};function $N(e,t,n,r,s,o){var u=Object(i.useState)(void 0),a=u[0],f=u[1],l=(function(){var e=Object(i.useState)(!0),t=e[0],n=e[1];Object(i.useEffect)(function(){n(!1)},[]);return t})(),c=Object(i.useContext)(UN).effectWrapperManager;Object(i.useEffect)(function(){l||c&&c.getEffectWrapper(e,t,n,r,s,o).then(f,function(e){throw new Error(e)})},[e,t,n,s,r,o,c,l]);return a}function JN(e,t,n,r,s,o,u){void 0===r&&(r=!1);void 0===s&&(s=!1);var a=Object(i.useState)(void 0),f=a[0],l=a[1],c=Se(),h=Object(i.useCallback)(function(e){if((null==f?void 0:f.id)!==e.id){f&&s&&(null==n||n.releaseTexture(f.id));l(e);o&&o({x:e.width,y:e.height});u&&u()}},[f,s,o,u,n]);Object(i.useLayoutEffect)(function(){e&&n&&n.getTexture(e,h,t,r,c)},[e,t,n,h,c,r]);return(null==f?void 0:f.texture)||null}var KN=["a_lineData"],QN=["u_lineAlpha"],GN=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),i=0;for(t=0;t<n;t++)for(var s=arguments[t],o=0,u=s.length;o<u;o++,i++)r[i]=s[o];return r},YN=["u_FillColor"],ZN=["a_VerticesData"];var eC=function(e,t){e.width=t.x;e.height=t.y};function tC(e,t,n,r){n();nC(e,t);r.renderNow()}var nC=function(e,t){e.width=t.x;e.height=t.y};function rC(e,t,n,r){var i=[null,function(){}];if(n&&e){var s;n.getTexture(e,function(e){s=e},t,!0,r);s&&s.texture&&(i=[s.texture,function(){s&&n.releaseTexture(s.id)}])}return i}function iC(e,t,n){var r={main:null,blend:null,overlay:null},i=[],s=Ka(e);if(s.main){var o=rC(s.main,$g.main,t,n),u=o[0],a=o[1];if(u){r.main=u;i.push(a)}}if(s.blend){var f=rC(s.blend,$g.blend,t,n),l=f[0],c=f[1];if(l){r.blend=l;i.push(c)}}if(s.overlay){var h=rC(s.overlay,$g.overlay,t,n),p=h[0],d=h[1];if(p){r.overlay=p;i.push(d)}}return[r,function(){i.forEach(function(e){return e()})}]}var sC=function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(e){try{a(r.next(e))}catch(e){s(e)}}function u(e){try{a(r.throw(e))}catch(e){s(e)}}function a(e){e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(o,u);var t}a((r=r.apply(e,t||[])).next())})},oC=function(e,t){var n,r,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function u(s){return function(u){return(function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&s[0]?r.return:s[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,s[1])).done)return i;(r=0,i)&&(s=[2&s[0],i.value]);switch(s[0]){case 0:case 1:i=s;break;case 4:o.label++;return{value:s[1],done:!1};case 5:o.label++;r=s[1];s=[0];continue;case 7:s=o.ops.pop();o.trys.pop();continue;default:if(!(i=o.trys,i=i.length>0&&i[i.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1];i=s;break}if(i&&o.label<i[2]){o.label=i[2];o.ops.push(s);break}i[2]&&o.ops.pop();o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e];r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}})([s,u])}}};function uC(e){return sC(this,void 0,void 0,function(){var t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S;return oC(this,function(x){switch(x.label){case 0:t=e.image,n=e.renderList,r=e.canvas,i=e.renderImage,s=e.textures,o=e.customEdits,u=e.errorCallback,a=e.glContext,f=e.waitForRenderingToBeReady,l=e.setEffectLevels,c=e.restoreOverlayCanvas;h=e.cropTransformValues,p=e.imageTransformValues;d=iC(t,s,u),v=d[0],m=d[1];null==c||c();if(!r||!(null==v?void 0:v.main))return[2,null];g={x:r.width,y:r.height};if(o){h=Pr(o.cropRectangle);p=ks(o.imageTransform)}return[4,f()];case 1:x.sent();y=Hr(h);eC(r,{x:y.width,y:y.height});if(a&&(b=(function(e,t,n,r){var i=n.drawingBufferWidth,s=n.drawingBufferHeight,o=Hr(e),u=o.width,a=o.height;Ua(u)&&Ua(a)||r({id:"InvalidInput",message:"Expected integer input values for getTransformsToFitOutputImageInCanvas(). Received cropRectangle values of (width: "+u+", height: "+a+")."});var f=Math.min(i/u,s/a);if(f<1){r({id:"ImageTooBig",message:"Output image was resized because it exceeds max canvas drawing buffer size (width: "+i+", height: "+s+"), use getEditedImageBytes to get the full image data"});return{scaledCropTransform:Jn(Mn(f),e),scaledImageTransform:Jn(Mn(f),t)}}})(h,p,a,u))){h=b.scaledCropTransform;p=b.scaledImageTransform;y=Hr(h);eC(r,{x:y.width,y:y.height})}w=Jn(Dn(-y.left,-y.top),p);E=Jn(Dn(-y.left,-y.top),h);i(w,v,E,l);S=(function(e){var t=document.createElement("canvas");t.width=e.width;t.height=e.height;var n=t.getContext("2d");null==n||n.drawImage(e,0,0);return t})(r);tC(r,g,m,n);S||u({id:"CreateEditedImageFailed",message:"Could not create edited image in HTMLCanvasElement format."});return[2,S]}})})}var aC=function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(e){try{a(r.next(e))}catch(e){s(e)}}function u(e){try{a(r.throw(e))}catch(e){s(e)}}function a(e){e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(o,u);var t}a((r=r.apply(e,t||[])).next())})},fC=function(e,t){var n,r,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function u(s){return function(u){return(function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&s[0]?r.return:s[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,s[1])).done)return i;(r=0,i)&&(s=[2&s[0],i.value]);switch(s[0]){case 0:case 1:i=s;break;case 4:o.label++;return{value:s[1],done:!1};case 5:o.label++;r=s[1];s=[0];continue;case 7:s=o.ops.pop();o.trys.pop();continue;default:if(!(i=o.trys,i=i.length>0&&i[i.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1];i=s;break}if(i&&o.label<i[2]){o.label=i[2];o.ops.push(s);break}i[2]&&o.ops.pop();o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e];r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}})([s,u])}}};function lC(e){return aC(this,void 0,void 0,function(){var t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E;return fC(this,function(S){switch(S.label){case 0:t=e.image,n=e.renderList,r=e.canvas,i=e.renderImage,s=e.textures,o=e.customEdits,u=e.errorCallback,a=e.glContext,f=e.waitForRenderingToBeReady,l=e.setEffectLevels,c=e.restoreOverlayCanvas;h=e.cropTransformValues,p=e.imageTransformValues;d=iC(t,s,u),v=d[0],m=d[1];null==c||c();if(!r||!(null==v?void 0:v.main)||!a)return[2,null];g={x:r.width,y:r.height};if(o){h=Pr(o.cropRectangle);p=ks(o.imageTransform)}return[4,f()];case 1:S.sent();y=(function(e,t){var n=Ln(e);return n=Si(n,On,Fr(t).y)})(p,h);b=Hr(h);w=HN(b,2048);E=Xa(b.width,b.height,za.RGBA);try{w.forEach(function(e){eC(r,{x:e.width,y:e.height});var t=Jn(Dn(-e.left,-e.top),y),n=Jn(Dn(-e.left,-e.top),Dn(-b.left,-b.top),h);i(t,v,n,l);var s=(function(e){var t=e.drawingBufferWidth,n=e.drawingBufferHeight,r=Xa(t,n,za.RGBA);e.pixelStorei(e.PACK_ALIGNMENT,1);e.readPixels(0,0,t,n,e.RGBA,e.UNSIGNED_BYTE,r.bytes);return r})(a);if(!s)throw new Error("Error: Could not create edited image in ImageBytes format.");var o,u,f,c=(o=e,u=-b.top,f=-b.left,Cr(Cr({},o),{top:o.top+u,left:o.left+f}));c.top=b.height-c.top-c.height;(function(e,t,n){if(!Mr({top:t.y,left:t.x,width:e.width,height:e.height},{top:0,left:0,width:n.width,height:n.height}))throw new RangeError("Src of "+e.width+"x"+e.height+" at ("+t.x+","+t.y+") is not within dst "+n.width+"x"+n.height+" to be copied.");if(!Ya(e.width,e.height,e.format,e.bytes)||!Ya(n.width,n.height,n.format,n.bytes))throw Error("Byte array does not have a valid length.");for(var r=e.bytes,i=n.bytes,s=Ga(e.format),o=e.width*s,u=(n.width-e.width)*s,a=0,f=(t.y*n.width+t.x)*s,l=e.bytes.byteLength;a<l;){i.set(r.subarray(a,a+o),f);a+=o;f+=o+u}})(s,{x:c.left,y:c.top},E)});tC(r,g,m,n);return[2,E]}catch(e){u({id:"CreateEditedImageFailed",message:e.message});tC(r,g,m,n);return[2,null]}return[2]}})})}var cC=function(){return(cC=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)};var hC=function(){return(hC=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)},pC=function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(e){try{a(r.next(e))}catch(e){s(e)}}function u(e){try{a(r.throw(e))}catch(e){s(e)}}function a(e){e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(o,u);var t}a((r=r.apply(e,t||[])).next())})},dC=function(e,t){var n,r,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function u(s){return function(u){return(function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&s[0]?r.return:s[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,s[1])).done)return i;(r=0,i)&&(s=[2&s[0],i.value]);switch(s[0]){case 0:case 1:i=s;break;case 4:o.label++;return{value:s[1],done:!1};case 5:o.label++;r=s[1];s=[0];continue;case 7:s=o.ops.pop();o.trys.pop();continue;default:if(!(i=o.trys,i=i.length>0&&i[i.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1];i=s;break}if(i&&o.label<i[2]){o.label=i[2];o.ops.push(s);break}i[2]&&o.ops.pop();o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e];r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}})([s,u])}}};function vC(e,t,n,r,s,o){var u=this,a=Object(i.useContext)(me).logFailedToGetEditedImageEvent,f=Object(i.useContext)(vh).renderList,l=Object(i.useContext)(Za).setImageOverlay,c=Object(i.useContext)(Ca).canvasMethods,h=Object(i.useContext)(Za).image,p=Object(i.useRef)(h);p.current=h;var d=Se(),v=gd(),m=Object(i.useCallback)(function(){return Ja(p.current)?p.current.overlay:null},[]),g=Object(i.useCallback)(function(e,t){var n=(function(e,t,n){var r=Ka(e),i=t.getHTMLCanvas?{width:n.x,height:n.y,canvasMethods:cC(cC({},t),{clearHTMLCanvas:function(){}}),renderCanvas:EE,id:Bu().toString()}:void 0;i&&(r=cC(cC({},r),{overlay:i}));return r})(e,c,t);n.overlay&&l(n.overlay);return n},[c,l]),y=Object(i.useCallback)(function(e){l(e)},[l]);Object(i.useImperativeHandle)(s,function(){var i={renderList:f,canvas:e,textures:t,renderImage:n,glContext:o,waitForRenderingToBeReady:r};return{getEditedImageBytes:function(e,t,n){return pC(u,void 0,void 0,function(){var r,s,u,f,l,h,p,b,w;return dC(this,function(E){switch(E.label){case 0:r=null;if(!o)return[3,2];s=v.getState();u=s.transformTools,f=u.cropInteraction.uvToWorld,l=u.image,h=l._preciseUvToWorld,p=l.originalPixelSize;b=m();w=g(e,p);return[4,lC(hC(hC({},i),{image:w,cropTransformValues:f,imageTransformValues:h,customEdits:t,errorCallback:d,setEffectLevels:n,restoreOverlayCanvas:c.restoreHTMLCanvas}))];case 1:r=E.sent();y(b);E.label=2;case 2:r||a();return[2,r]}})})},getEditedImage:function(t,n,r){return pC(u,void 0,void 0,function(){var s,o,u,f,l,h,p,b,w;return dC(this,function(E){switch(E.label){case 0:s=null;if(!e)return[3,2];o=v.getState();u=o.transformTools,f=u.cropInteraction.uvToWorld,l=u.image,h=l._preciseUvToWorld,p=l.originalPixelSize;b=m();w=g(t,p);return[4,uC(hC(hC({},i),{image:w,cropTransformValues:f,imageTransformValues:h,customEdits:n,errorCallback:d,setEffectLevels:r,restoreOverlayCanvas:c.restoreHTMLCanvas}))];case 1:s=E.sent();y(b);E.label=2;case 2:s||a();return[2,s]}})})}}},[f,e,t,n,o,r,v,m,g,d,y,c,a])}function mC(){var e=Object(i.useContext)(Py).enableFilters,t=Object(i.useContext)(ny),n=t.textures,r=t.urlsById,s=t.loadUrls,o=!e||0!==Object.keys(n).length&&0!==Object.keys(r).length;return(function(e,t){var n=Object(i.useRef)(function(){}),r=Object(i.useState)(function(){return new Promise(function(e){return n.current=e})})[0];Object(i.useEffect)(function(){e&&n.current()},[e]);return Object(i.useCallback)(function(){t&&t();return r},[t,r])})(o,o?void 0:s)}var gC=Object(i.forwardRef)(function(e,t){var n=Object(i.useContext)(UN),r=n.canvasContextIsValid,s=n.canvas,o=n.engine,u=n.effectRenderer,a=n.textures;if(!r)throw new SyntaxError("Invalid BabylonCanvasComponentContext.  The BabylonOffscreenImageRenderConnectImpl component must be used within an BabylonCanvas component");var f=Object(i.useContext)(hh).registry;if(!f)throw new SyntaxError("Invalid ImageEffectContext.  The BabylonOffscreenImageRenderConnect component must be used within an BabylonImage component");var l=sh(!0,f),c=$N(l[0],l[1],l[2],l[3],l[4],l[5]),h=Object(i.useContext)(ny),p=Object(i.useRef)(h);p.current=h;var d=mC();if(!gd().getState().transformTools)throw new Error("Invalid redux store in BabylonOffscreenImageRenderConnect, must contain ITransformToolsState");vC(s,a,Object(i.useCallback)(function(e,t,n,r){var i=void 0,s=(function(e,t){var n=void 0,r=e.getEffects().find(function(e){return"VignetteShader"===e.getName()});if(r&&t){n=r.getTransform();r.setTransform(t)}return function(){r&&n&&r.setTransform(n)}})(f,n);r&&(i=r(f,{lutTextures:p.current.textures,lutUrlsById:p.current.urlsById}));XN(e,f,xh,c,t,o,u,!0);s();i&&i()},[f,c,o,u]),d,t,null==o?void 0:o._gl);return null}),yC=function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(e){try{a(r.next(e))}catch(e){s(e)}}function u(e){try{a(r.throw(e))}catch(e){s(e)}}function a(e){e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(o,u);var t}a((r=r.apply(e,t||[])).next())})},bC=function(e,t){var n,r,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function u(s){return function(u){return(function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&s[0]?r.return:s[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,s[1])).done)return i;(r=0,i)&&(s=[2&s[0],i.value]);switch(s[0]){case 0:case 1:i=s;break;case 4:o.label++;return{value:s[1],done:!1};case 5:o.label++;r=s[1];s=[0];continue;case 7:s=o.ops.pop();o.trys.pop();continue;default:if(!(i=o.trys,i=i.length>0&&i[i.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1];i=s;break}if(i&&o.label<i[2]){o.label=i[2];o.ops.push(s);break}i[2]&&o.ops.pop();o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e];r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}})([s,u])}}},wC=function(e){return yC(void 0,void 0,void 0,function(){return bC(this,function(t){return[2,new Promise(function(t,n){var r=new Image;r.onload=function(){t(r)};r.onerror=function(e){n(e)};r.decoding=r.decoding||"auto";r.crossOrigin="Anonymous";r.src=e})]})})},EC=function(){return(EC=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)},SC=function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(e){try{a(r.next(e))}catch(e){s(e)}}function u(e){try{a(r.throw(e))}catch(e){s(e)}}function a(e){e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(o,u);var t}a((r=r.apply(e,t||[])).next())})},xC=function(e,t){var n,r,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function u(s){return function(u){return(function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&s[0]?r.return:s[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,s[1])).done)return i;(r=0,i)&&(s=[2&s[0],i.value]);switch(s[0]){case 0:case 1:i=s;break;case 4:o.label++;return{value:s[1],done:!1};case 5:o.label++;r=s[1];s=[0];continue;case 7:s=o.ops.pop();o.trys.pop();continue;default:if(!(i=o.trys,i=i.length>0&&i[i.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1];i=s;break}if(i&&o.label<i[2]){o.label=i[2];o.ops.push(s);break}i[2]&&o.ops.pop();o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e];r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}})([s,u])}}};function TC(e,t){var n=Object(i.useContext)(Py).enableFilters,r=Se(),s=Object(i.useState)({}),o=s[0],u=s[1],a=Object(i.useCallback)(function(){Ax().then(function(e){var t=e.defaultLutUrlDictionary;u(t)}).catch(function(e){return r({id:"CodeSplitFailed",message:"Failed to load LUT data URLs"})})},[r]),f=(function(e,t,n,r){var s=this,o=Object(i.useState)({}),u=o[0],a=o[1],f=Se(),l=Object(i.useCallback)(function(e){return SC(s,void 0,void 0,function(){var n;return xC(this,function(r){switch(r.label){case 0:return[4,wC(e)];case 1:n=r.sent();return[2,new Promise(function(r,i){if(t){t.getTexture(n,function(t){r(EC(EC({},t),{url:e}))},$g.lut,!1,function(e){f(e);i()},1)}})]}})})},[f,t]),c=Object(i.useCallback)(function(e){return null==t?void 0:t.releaseTexture(e)},[t]);Object(i.useEffect)(function(){if(e&&n.length>0){var t=!0,i=[],o=bb(n,function(e){return SC(s,void 0,void 0,function(){var n;return xC(this,function(s){switch(s.label){case 0:s.trys.push([0,3,,4]);return rf(e)&&r[e.lutUrlId]?[4,l(r[e.lutUrlId])]:[3,2];case 1:n=s.sent();if(t){i.push(n.id);return[2,n]}c(n.id);s.label=2;case 2:return[3,4];case 3:s.sent();return[3,4];case 4:return[2]}})})}),u=o.promise,f=o.cancel;u.then(function(e){if(t){var n={};e.forEach(function(e){return e&&(n[e.url]=e.texture)});a(n)}},function(){});return function(){f();t=!1;i.forEach(function(e){return c(e)});i=[];a({})}}},[n,e,l,c,r]);return u})(n,e,t,o);return Object(i.useMemo)(function(){return{textures:f,urlsById:o,loadUrls:a}},[f,o,a])}var NC={canvas:zN,image:function(e){var t=e.children,n=e.zIndex,r=e.color,o=e.transform,u=e.image,a=e.onMainTextureLoaded,f=e.onOverlayTextureLoaded,l=e.imageEffectsRegistry,c=Object(i.useContext)(UN),h=c.engine,p=c.effectRenderer,d=c.textures,v=(function(e){return Object(i.useMemo)(function(){return e||new Fc},[e])})(l),m=Object(i.useRef)([1,0,0,0,1,0]);m.current=Ln(o);var g=sh(!0,v),y=$N(g[0],g[1],g[2],g[3],g[4],g[5]),b=IN(h),w=(function(e,t,n,r,s){var o=Object(i.useContext)(Wf),u=Ka(t),a=Object(i.useCallback)(function(e){null==r||r({sizeInPixels:e,resetEditsOnSizeChange:!o})},[r,o]),f=JN(u.main,$g.main,e,!!n.main,!0,a),l=JN(u.blend,$g.blend,e,!!n.blend,!0),c=JN(u.overlay,$g.overlay,e,!!n.overlay,!0,void 0,s),h=Object(i.useMemo)(function(){return{main:f,blend:l,overlay:c}},[f,l,c]);bh(h);return h})(d,u,{main:b,blend:b,overlay:!1},a,f);yh((function(e,t,n,r,s,o,u){return Object(i.useCallback)(function(){XN(e.current,t,n,r,s,o,u)},[e,t,n,r,s,o,u])})(m,v,r,y,w,h,p),n);wh(o);return s.a.createElement(hh.Provider,{value:{registry:v,textures:w}},t)},gridLines:function(e){var t=e.linesCount,n=e.cropRect,r=e.alpha,s=e.canvasSize,o=Object(i.useContext)(UN).engine,u=$N("gridLines","\n  attribute vec3 a_lineData;\n\n  varying float distanceFromBeginningOfTheLine;\n  varying vec2 vPos;\n\n  void main(void) {\n      vPos =  a_lineData.xy;\n      distanceFromBeginningOfTheLine = a_lineData.z;\n      gl_Position = vec4(a_lineData.xy, 0., 1.);\n  }","\n  varying vec2 vPos;\n  varying float distanceFromBeginningOfTheLine;\n\n  uniform float u_lineAlpha;\n\n  void main(void)\n  {\n      float lineAlt = step(mod(distanceFromBeginningOfTheLine, 8.0 * 2.0), 8.0);\n      vec3 currentLineCurrentPixelColor = mix(vec3(1.0,1.0,1.0), vec3(0.8,0.8,0.8), lineAlt);\n      vec4 targetColorWithAlpha = vec4(currentLineCurrentPixelColor, u_lineAlpha * 0.75);\n      gl_FragColor = targetColorWithAlpha;\n  }",KN,void 0,QN),a=Object(i.useState)(),f=a[0],l=a[1],c=Object(i.useState)(),h=c[0],p=c[1],d=2*t,v=Object(i.useMemo)(function(){return e=n,t=s.x,r=s.y,{height:e.height/r*2,top:2*-e.top/r+1,width:e.width/t*2,left:e.left/t*2-1};var e,t,r},[n,s]),m=Object(i.useMemo)(function(){return new Float32Array(6*d)},[d]);Object(i.useLayoutEffect)(function(){for(var e=v.width/(t+1),r=v.height/(t+1),i=0;i<t;i++){var s=6*i*2,o=e*(i+1),u=r*(i+1);m[s+0]=v.left+o;m[s+1]=v.top;m[s+2]=0;m[s+3]=v.left+o;m[s+4]=v.top-v.height;m[s+5]=n.height;m[s+6]=v.left;m[s+7]=v.top-u;m[s+8]=0;m[s+9]=v.left+v.width;m[s+10]=v.top-u;m[s+11]=n.width}},[v,n,t,m]);Object(i.useLayoutEffect)(function(){var e,t=void 0,n=void 0,r=new Float32Array(6*d);if(o&&u){t=((e={}).a_lineData=new tT(o,r,"a_lineData",!0,!1,3,!1),e);if(o.webGLVersion>=2){n=o.recordVertexArrayObject(t,null,u.effect);o.bindVertexArrayObject(n,null)}else o.bindBuffers(t,null,u.effect);l(t);p(n)}return function(){n&&(null==o||o.releaseVertexArrayObject(n));t&&t.a_lineData.dispose()}},[o,u,t,d]);yh(Object(i.useCallback)(function(){if(o&&u&&f&&m){o.enableEffect(u.effect);f.a_lineData.update(m);h?o.bindVertexArrayObject(h,null):o.bindBuffers(f,null,u.effect);u.effect.setFloat("u_lineAlpha",r);o.drawArraysType(zx.MATERIAL_LineListDrawMode,0,2*d)}},[f,o,m,u,r,h,d]),Number.MAX_VALUE);(function(e){void 0===e&&(e={height:0,width:0,top:0,left:0});var t=Object(i.useContext)(vh).renderList;Object(i.useLayoutEffect)(function(){t&&t.requestRender()},[t,e.height,e.width,e.top,e.left])})(n);return null},gridLinesEffect:void 0,borderRectangle:function(e){var t=e.transform,n=e.canvasSize,r=e.zIndex,s=Ch(ba().palette.neutralDark),o=(function(e,t,n,r){var s=Object(i.useState)(),o=s[0],u=s[1],a=Object(i.useState)(),f=a[0],l=a[1],c=Object(i.useMemo)(function(){return new Float32Array(2*n)},[n]),h=Object(i.useContext)(UN).engine,p=$N(e,"\n  attribute vec2 a_VerticesData;\n  void main(void) {\n      gl_Position = vec4(a_VerticesData.xy, 0., 1.);\n  }","\n  uniform vec4 u_FillColor;\n  void main(void) {\n      gl_FragColor = u_FillColor;\n  }",ZN,void 0,YN);Object(i.useEffect)(function(){var e,t=new Float32Array(2*n);if(h&&p){var r=((e={}).a_VerticesData=new tT(h,t,"a_VerticesData",!0,!1,2,!1),e);if(h.webGLVersion>=2){var i=h.recordVertexArrayObject(r,null,p.effect);h.bindVertexArrayObject(i,null);l(i);u(r);return function(){h.releaseVertexArrayObject(i);r.a_VerticesData.dispose()}}h.bindBuffers(r,null,p.effect);u(r);return function(){r.a_VerticesData.dispose()}}},[h,p,n]);return[Object(i.useCallback)(function(e){c.set(e)},[c]),Object(i.useCallback)(function(){if(h&&p&&o&&c){var e=p.effect;h.enableEffect(e);o.a_VerticesData.update(c);f?h.bindVertexArrayObject(f,null):h.bindBuffers(o,null,p.effect);e.setFloat4.apply(e,GN(["u_FillColor"],r));h.drawArraysType(t,0,n)}},[h,p,c,t,n,o,f,r])]})("BorderRectangle",zx.MATERIAL_LineLoopDrawMode,4,s),u=o[0],a=o[1],f=Object(i.useMemo)(function(){return Jn(Dn(-1,1),Mn(2/n.x,-2/n.y),Zn(t,.5))},[t,n]);wh(f);Object(i.useLayoutEffect)(function(){var e=Vn(f).reduce(function(e,t){e.push(t.x,t.y);return e},[]);u(e)},[n,f,u]);yh(a,r);return null},offscreenRenderConnect:gC,lutProvider:Object(i.memo)(function(e){var t=e.filters,n=e.children,r=TC(Object(i.useContext)(UN).textures,t);return s.a.createElement(ny.Provider,{value:r},n)})},CC=Object(wa.E)({palette:{themePrimary:"#2899f5",themeLighterAlt:"#02060a",themeLighter:"#092c47",themeLight:"#043862",themeTertiary:"#004c87",themeSecondary:"#007bd4",themeDarkAlt:"#3aa0f3",themeDark:"#6cb8f6",themeDarker:"#82c7ff",neutralLighterAlt:"#1b1a19",neutralLighter:"#252423",neutralLight:"#292827",neutralQuaternaryAlt:"#323130",neutralQuaternary:"#3b3a39",neutralTertiaryAlt:"#484644",neutralTertiary:"#797775",neutralSecondary:"#a19f9d",neutralPrimaryAlt:"#c8c6c4",neutralPrimary:"#f3f2f1",neutralDark:"#faf9f8",black:"#ffffff",white:"#000000"}}),kC={themePrimary:"#0086f0",themeLighterAlt:"#02060a",themeLighter:"#092c47",themeLight:"#043862",themeTertiary:"#004c87",themeSecondary:"#0078d4",themeDarkAlt:"#1890f1",themeDark:"#3aa0f3",themeDarker:"#6cb8f6",neutralLighterAlt:"#141414",neutralLighter:"#212121",neutralLight:"#292929",neutralQuaternaryAlt:"#303030",neutralQuaternary:"#404040",neutralTertiaryAlt:"#6e6e6e",neutralTertiary:"#acacac",neutralSecondary:"#c8c8c8",neutralPrimaryAlt:"#e1e1e1",neutralPrimary:"#f1f1f1",neutralDark:"#f8f8f8",black:"#ffffff",white:"#000000"},LC=Object(wa.E)({palette:kC}),AC=(Object(wa.E)({palette:kC,defaultFontStyle:{fontFamily:"Roboto"}}),n(4518)),OC=n(1771),MC=n(77),_C=n(2611),DC=function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(e){try{a(r.next(e))}catch(e){s(e)}}function u(e){try{a(r.throw(e))}catch(e){s(e)}}function a(e){e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(o,u);var t}a((r=r.apply(e,t||[])).next())})},PC=function(e,t){var n,r,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function u(s){return function(u){return(function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&s[0]?r.return:s[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,s[1])).done)return i;(r=0,i)&&(s=[2&s[0],i.value]);switch(s[0]){case 0:case 1:i=s;break;case 4:o.label++;return{value:s[1],done:!1};case 5:o.label++;r=s[1];s=[0];continue;case 7:s=o.ops.pop();o.trys.pop();continue;default:if(!(i=o.trys,i=i.length>0&&i[i.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1];i=s;break}if(i&&o.label<i[2]){o.label=i[2];o.ops.push(s);break}i[2]&&o.ops.pop();o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e];r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}})([s,u])}}};function HC(e){var t=this,n=Object(i.useState)(null),r=n[0],s=n[1],o=Object(i.useCallback)(function(e){DC(t,void 0,void 0,function(){var t;return PC(this,function(n){switch(n.label){case 0:return e?[4,wC(e)]:[3,2];case 1:t=n.sent();s(t);n.label=2;case 2:return[2]}})})},[]);Object(i.useEffect)(function(){o(e)},[o,e]);return[r,o]}var BC=Object(i.createContext)({fabricCanvas:null,setFabricCanvas:function(e){}}),jC=Object(i.createContext)({fabric:null,loadFabric:function(){}});var FC=function(e){var t=e.children,n=(function(){var e=Object(i.useState)(null),t=e[0],n=e[1],r=Object(i.useRef)(null),s=Object(i.useContext)(jC).fabric;return[t,Object(i.useCallback)(function(e){var t;if(s)if(e){var i=new s.Canvas(e,{enableRetinaScaling:!1,stopContextMenu:!0});r.current=i;i.renderOnAddRemove=!1;n(i);var o=i.getElement().parentElement;o&&(o.style.position="absolute")}else{null===(t=r.current)||void 0===t||t.dispose();r.current=null;n(null)}},[s])]})(),r=n[0],o=n[1];return s.a.createElement(BC.Provider,{value:{fabricCanvas:r,setFabricCanvas:o}},t)};var IC=Object(i.createContext)({wetInkCanvas:void 0,setWetInkCanvas:function(e){}}),qC=function(e){var t=e.children,n=Object(i.useState)(),r=n[0],o=n[1];return s.a.createElement(IC.Provider,{value:{wetInkCanvas:r,setWetInkCanvas:o}},t)};function RC(e,t,n){var r=Hr(n);t.clipPath=new e.Rect(r)}function UC(e,t,n){if(Or(e,n)){var r=Vn(Pr(n)),i=r[0],s=r[1],o=r[2],u=r[3],a=[{lineStart:i,lineEnd:s},{lineStart:s,lineEnd:o},{lineStart:o,lineEnd:u},{lineStart:u,lineEnd:i}],f=Math.min.apply(Math,a.map(function(n){var r,i=n.lineStart,s=n.lineEnd;return null!==(r=qr(e,t,i,s))&&void 0!==r?r:1}));return{x:e.x+(t.x-e.x)*f,y:e.y+(t.y-e.y)*f}}}var zC=function(e){return e.util.createClass(e.PencilBrush,{color:"rgb(255, 255, 255)",opacity:0,width:32,initialize:function(e,t,n,r){this.canvas=e;this.width=t;this._points=[];this.bounds=n;this.removeMarkupContent=r},_render:function(){},_finalizeAndAddPath:function(){this._resetShadow();this.canvas.clearContext(this.canvas.contextTop);this.canvas.requestRenderAll();this.previousPoint=null},getIdsAtBrushLocation:function(t){var n=[],r=this.width/2,i=this.canvas.getObjects(),s=(function(e,t){for(var n=Math.asin(1.5/t),r=[],i=0;i<2*Math.PI;i+=n)r.push({x:e.x+t*Math.cos(i),y:e.y+t*Math.sin(i)});return r})(t,r),o=new e.Circle({radius:r,top:t.y-r,left:t.x-r,fill:"rgba(255,0,255,0)"});o.setCoords();for(var u=0,a=i;u<a.length;u++){var f=a[u];f&&f.visible&&((f.isContainedWithinObject(o)||f.intersectsWithObject(o)&&this.objectCollidesWithPoints(f,s))&&n.push(f.id))}return n},objectCollidesWithPoints:function(e,t){for(var n=0,r=t;n<r.length;n++){var i=r[n];if(!this.canvas.isTargetTransparent(e,i.x,i.y))return!0}return!1},getPointsToEraseBetween:function(e,t){var n=Or(e,this.bounds),r=Or(t,this.bounds);if(n){if(r)return[t,e];var i=UC(e,t,this.bounds);if(i)return[i,e]}else if(r){var s=UC(t,e,this.bounds);if(s)return[t,s]}},erase:function(e){var t=this;Or(e,this.bounds)&&this.eraseIdsFromCanvas(this.getIdsAtBrushLocation(e));if(this.previousPoint){var n=this.getPointsToEraseBetween(e,this.previousPoint);if(n){window.requestAnimationFrame(function(){t.eraseIdsFromCanvas(t.getIdsBetweenPoints(n[0],n[1]))})}}},getIdsBetweenPoints:function(t,n){var r=[],i=Math.hypot(n.x-t.x,n.y-t.y);if(i>this.width){var s=Math.atan2(n.y-t.y,n.x-t.x),o=vn(dn(n,t)),u={x:-1*o.y*this.width/2,y:o.x*this.width/2},a=new e.Rect({width:i,height:this.width,left:t.x-u.x,top:t.y-u.y,angle:180*s/Math.PI,fill:"rgba(255,255,0,0)"});a.setCoords();for(var f=[],l=0,c=this.canvas.getObjects();l<c.length;l++){if((v=c[l])&&v.id&&v.visible){if(v.isContainedWithinObject(a)){r.push(v.id);continue}if(v.intersectsWithObject(a)){f.push(v);continue}}}if(f.length>0)for(var h=(function(e,t,n,r){void 0===r&&(r=1);for(var i=[],s=hn(dn(e,t)),o=vn(dn(t,e)),u=-1*o.y*n/2,a=o.x*n/2,f=0;f<s;f+=r){i.push({x:e.x+f*o.x+u,y:e.y+f*o.y+a});i.push({x:e.x+f*o.x-u,y:e.y+f*o.y-a})}return i})(t,n,this.width),p=0,d=f;p<d.length;p++){var v;(v=d[p]).id&&this.objectCollidesWithPoints(v,h)&&r.push(v.id)}}return r},eraseIdsFromCanvas:function(e){e.length>0&&this.removeMarkupContent(e)},onMouseDown:function(e,t){if(this.canvas._isMainEvent(t.e)){this.previousPoint=e;this.erase(e)}},onMouseMove:function(e,t){if(this.canvas._isMainEvent(t.e)&&(!this.limitedToCanvasSize||!this._isOutSideCanvas(e))){if(tp(t.e)){if(this._captureDrawingPath(e)&&this._points.length>1){if(this.needsFullRender()){this.canvas.clearContext(this.canvas.contextTop);this._render()}else this.erase(e);this.previousPoint=e}}else{this._finalizeAndAddPath();this.canvas._isCurrentlyDrawing=!1}}}})};function WC(e,t,n){var r=Object(i.useContext)(BC).fabricCanvas,s=Object(i.useContext)(jC).fabric;Object(i.useEffect)(function(){if(r&&s){r.isDrawingMode=(function(e){switch(e){case"Eraser":case"Highlighter":case"Pen":return!0;default:throw new oa(e)}})(e);if("Eraser"===e){var i=Hr(t);r.freeDrawingBrush=new(zC(s))(r,32,i,n);r.freeDrawingCursor="inherit";r.defaultCursor="inherit"}}},[t,r,e,n,s])}function XC(e,t,n){var r=e.util.qrDecompose(n),i=new e.Point(r.translateX,r.translateY);t.flipX=!1;t.flipY=!1;t.set(r);t.setPositionByOrigin(i,"center","center");t.setCoords()}function VC(e,t,n){if(t.id){XC(e,t,er(Jn(n,t.fabricToViewTransform)))}}var $C=function(){return($C=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)};function JC(e,t,n,r,i){r&&t.getObjects().forEach(function(t){VC(e,t,r)});n&&t.setDimensions({width:n.x,height:n.y},{backstoreOnly:!0});i?RC(e,t,i):r&&RC(e,t,r);t.renderAll()}var KC=function(){return(KC=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)},QC=Object(i.memo)(function(e){var t,n=e.cropViewTransform,r=e.imageViewTransform,o=e.width,u=e.height,a=e.cssWidth,f=e.cssHeight,l=e.styles,c=e.activeMarkupToolType,h=e.markupContentItems,p=e.removeMarkupContent,d=e.convertToFabricContent,v=Object(i.useContext)(BC).setFabricCanvas;t=Object(i.useContext)(jC).loadFabric,Object(i.useLayoutEffect)(function(){t()},[t]);(function(e,t,n,r,s){var o=Object(i.useContext)(BC).fabricCanvas,u=Object(i.useContext)(jC).fabric;Object(i.useLayoutEffect)(function(){if(null==o?void 0:o.getContext()){null==o||o.setDimensions({width:e,height:t},{backstoreOnly:!0});null==o||o.setDimensions({width:n,height:r},{cssOnly:!0});null==o||o.renderAll()}},[e,t,n,r,o]);Object(i.useEffect)(function(){if(u&&(null==o?void 0:o.getContext())){RC(u,o,s);o.renderAll()}},[s,u,o])})(o,u,a,f,n);WC(c,n,p);(function(e,t){var n=Object(i.useContext)(BC).fabricCanvas,r=Object(i.useRef)(null),s=Object(i.useContext)(jC).fabric;Object(i.useLayoutEffect)(function(){r.current=new Set},[n]);Object(i.useLayoutEffect)(function(){if((null==n?void 0:n.getContext())&&r.current&&s){for(var i=[],o=new Set(r.current),u=0,a=e;u<a.length;u++){var f=a[u];o.delete(f.id);if(!r.current.has(f.id)){i.push(f);r.current.add(f.id)}}for(var l=0,c=Array.from(o);l<c.length;l++){var h=c[l];r.current.delete(h)}var p=t?i.map(t):i;(function(e,t,n){e.util.enlivenObjects(n,function(e){e.forEach(function(e){t.add(e)});t.requestRenderAll()},"fabric")})(s,n,p);(function(e,t){for(var n=0,r=e.getObjects();n<r.length;n++){var i=r[n];if(i&&i.id&&t.has(i.id)){t.delete(i.id);e.remove(i)}if(t.size<1)break}e.requestRenderAll()})(n,o)}},[t,s,n,e])})(h,d);(function(e){var t=Object(i.useContext)(BC).fabricCanvas,n=Object(i.useContext)(jC).fabric;Object(i.useLayoutEffect)(function(){t&&n&&t.getObjects().forEach(function(t){VC(n,t,e)})},[n,t,e])})(r);(function(e,t){var n=Object(i.useContext)(BC).fabricCanvas,r=Object(i.useContext)(Ca).setCanvasMethods,s=Object(i.useContext)(jC).fabric,o=Object(i.useRef)(n);n&&(o.current=n);var u=Object(i.useRef)(void 0);Object(i.useEffect)(function(){r(function(e){return $C($C({},e),{getHTMLCanvas:function(e,t){if(o.current&&s){var n=o.current.getElement();if(n){if(e||t){u.current={x:o.current.getWidth(),y:o.current.getHeight()};JC(s,o.current,e,t);n=o.current.getElement()}return n}}return null},clearHTMLCanvas:function(){var e;null===(e=o.current)||void 0===e||e.clear()}})});return function(){o.current=null}},[s,r]);Object(i.useEffect)(function(){r(function(n){return $C($C({},n),{restoreHTMLCanvas:function(){if(o.current&&s){o.current.getElement()&&JC(s,o.current,u.current,e,t)}}})});return function(){o.current=null}},[t,s,e,r])})(r,n);return s.a.createElement("canvas",{ref:v,style:KC({},l)})});function GC(e,t){e.output=t}function YC(e,t,n){GC(e,t);GC(t,n)}function ZC(e,t,n,r){GC(e,t);YC(t,n,r)}function ek(e){return{x:e.offsetX,y:e.offsetY,pressure:e.pressure,tiltX:e.tiltX,tiltY:e.tiltY,timestamp:e.timeStamp}}function tk(e){return{x:e.offsetX,y:e.offsetY,pressure:.5,tiltX:e.tiltX,tiltY:e.tiltY,timestamp:e.timeStamp}}var nk=(function(){function e(){}e.prototype.onPointerDown=function(e){this.output.beginStroke(tk(e))};e.prototype.onPointerMove=function(e){this.output.addPoint(tk(e))};e.prototype.onPointerUp=function(e){this.output.endStroke(tk(e))};return e})(),rk=(function(){function e(){}e.prototype.onPointerDown=function(e){this.output.beginStroke(ek(e))};e.prototype.onPointerMove=function(e){this.output.addPoint(ek(e))};e.prototype.onPointerUp=function(e){this.output.endStroke(ek(e))};return e})();function ik(){return!(-1!==navigator.userAgent.indexOf("Firefox"))}function sk(){return ik()?new rk:new nk}var ok=(function(){function e(){}e.prototype.beginStroke=function(e){this.output.beginStroke(e);this.point=e};e.prototype.addPoint=function(e){if(this.point.x!==e.x||this.point.y!==e.y){this.output.addPoint(e);this.point=e}};e.prototype.endStroke=function(e){this.output.endStroke(e)};return e})(),uk=(function(){function e(){}e.prototype.beginStroke=function(e){this.out1={x:e.x,y:e.y};this.out2=this.out1;this.output.beginStroke(e)};e.prototype.addPoint=function(e){this.output.addPoint(this.filter(e))};e.prototype.endStroke=function(e){this.output.endStroke(this.filter(e))};e.prototype.filter=function(e){var t={x:ak(e.x,this.out1.x,this.out2.x),y:ak(e.y,this.out1.y,this.out2.y)};this.out2=this.out1;this.out1=t;return{x:t.x,y:t.y,pressure:e.pressure,tiltX:e.tiltX,tiltY:e.tiltY,timestamp:e.timestamp}};return e})();function ak(e,t,n){return(1-1.33- -.5)*e+1.33*t+-.5*n}function fk(e,t,n,r){var i=(e+t)/2,s=(t+n)/2,o=(n+r)/2,u=(i+s)/2,a=(s+o)/2;return[e,i,u,(u+a)/2,a,o,r]}function lk(e,t,n,r){return[(n-e)/6+t,(t-r)/6+n]}var ck=(function(){function e(){this.began=!1}e.prototype.beginStroke=function(e){this.output.beginStroke(e);this.cp=[e,e,e,e];this.began=!0};e.prototype.addPoint=function(e){var t=this.push(e),n=t[0],r=t[1];this.began?this.began=!1:this.output.addSegment(n,r,this.cp[2])};e.prototype.endStroke=function(e){this.addPoint(e);var t=this.push(e),n=t[0],r=t[1];this.output.endStroke(n,r,this.cp[2])};e.prototype.push=function(e){this.cp.shift();this.cp.push(e);return t=this.cp[0],n=this.cp[1],r=this.cp[2],i=this.cp[3],s=lk(t.x,n.x,r.x,i.x),o=s[0],u=s[1],a=lk(t.y,n.y,r.y,i.y),f=a[0],l=a[1],c=hk(n.pressure,r.pressure),h=c[0],p=c[1],d=hk(n.tiltX,r.tiltX),v=d[0],m=d[1],g=hk(n.tiltY,r.tiltY),y=g[0],b=g[1],w=hk(n.timestamp,r.timestamp),E=w[0],S=w[1],[{x:o,y:f,pressure:h,tiltX:v,tiltY:y,timestamp:E},{x:u,y:l,pressure:p,tiltX:m,tiltY:b,timestamp:S}];var t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S};return e})();function hk(e,t){var n=(t-e)/3;return[e+n,t-n]}function pk(e,t){var n=(function(e,t){return{x:e.x-t.x,y:e.y-t.y}})(e,t);return(function(e,t){return e.x*t.x+e.y*t.y})(n,n)}var dk=(function(){function e(e){this.flatness=e*e}e.prototype.beginStroke=function(e){this.output.beginStroke(e);this.beginPoint=e};e.prototype.addSegment=function(e,t,n){vk(this.beginPoint,e,t,n,this.flatness,this.output);this.output.addPoint(n);this.beginPoint=n};e.prototype.endStroke=function(e,t,n){vk(this.beginPoint,e,t,n,this.flatness,this.output);this.output.endStroke(n)};return e})();function vk(e,t,n,r,i,s){var o=(function(e,t,n,r){var i=fk(e.x,t.x,n.x,r.x),s=i[0],o=i[1],u=i[2],a=i[3],f=i[4],l=i[5],c=i[6],h=fk(e.y,t.y,n.y,r.y),p=h[0],d=h[1],v=h[2],m=h[3],g=h[4],y=h[5],b=h[6],w=fk(e.pressure,t.pressure,n.pressure,r.pressure),E=w[0],S=w[1],x=w[2],T=w[3],N=w[4],C=w[5],k=w[6],L=fk(e.tiltX,t.tiltX,n.tiltX,r.tiltX),A=L[0],O=L[1],M=L[2],_=L[3],D=L[4],P=L[5],H=L[6],B=fk(e.tiltY,t.tiltY,n.tiltY,r.tiltY),j=B[0],F=B[1],I=B[2],q=B[3],R=B[4],U=B[5],z=B[6],W=fk(e.timestamp,t.timestamp,n.timestamp,r.timestamp);return[{x:s,y:p,pressure:E,tiltX:A,tiltY:j,timestamp:W[0]},{x:o,y:d,pressure:S,tiltX:O,tiltY:F,timestamp:W[1]},{x:u,y:v,pressure:x,tiltX:M,tiltY:I,timestamp:W[2]},{x:a,y:m,pressure:T,tiltX:_,tiltY:q,timestamp:W[3]},{x:f,y:g,pressure:N,tiltX:D,tiltY:R,timestamp:W[4]},{x:l,y:y,pressure:C,tiltX:P,tiltY:U,timestamp:W[5]},{x:c,y:b,pressure:k,tiltX:H,tiltY:z,timestamp:W[6]}]})(e,t,n,r),u=o[0],a=o[1],f=o[2],l=o[3],c=o[4],h=o[5],p=o[6];if(!((function(e,t,n){var r=pk(t,e);if(0===r)return pk(n,e);var i=(n.x-t.x)*(t.y-e.y)-(t.x-e.x)*(n.y-t.y);return i*i/r})(u,p,l)<=i)){vk(u,a,f,l,i,s);s.addPoint(l);vk(l,c,h,p,i,s)}}var mk=(function(){function e(e){this.pointerToStroke=sk();this.deduper=new ok;this.jitter=new uk;this.fitter=new ck;this.flattener=new dk(e);(function(e,t,n,r,i){YC(e,t,n);YC(n,r,i)})(this.pointerToStroke,this.deduper,this.jitter,this.fitter,this.flattener)}e.prototype.onPointerDown=function(e){GC(this.flattener,this.output);this.pointerToStroke.onPointerDown(e)};e.prototype.onPointerMove=function(e){this.pointerToStroke.onPointerMove(e)};e.prototype.onPointerUp=function(e){this.pointerToStroke.onPointerUp(e)};return e})(),gk=(function(){function e(e){var t=this;this.onPointerDown=function(e){t.output.onPointerDown(e)};this.onTouchStart=function(e){t.output.onTouchStart(e)};this.element=e}e.prototype.activate=function(){this.element.addEventListener("pointerdown",this.onPointerDown,!0);this.element.addEventListener("touchstart",this.onTouchStart,!0)};e.prototype.deactivate=function(){this.element.removeEventListener("pointerdown",this.onPointerDown,!0);this.element.removeEventListener("touchstart",this.onTouchStart,!0)};return e})(),yk=(function(){function e(){this.active=!1}e.prototype.onMouseDown=function(e){this.output.onMouseDown(e);this.active=!0};e.prototype.onMouseMove=function(e){this.active&&this.output.onMouseMove(e)};e.prototype.onMouseUp=function(e){this.active=!1;this.output.onMouseUp(e)};return e})(),bk=(function(){function e(e){var t=this;this.onMouseDown=function(e){t.output.onMouseDown(e)};this.onMouseMove=function(e){t.output.onMouseMove(e)};this.onMouseUp=function(e){t.output.onMouseUp(e)};this.element=e}e.prototype.activate=function(){this.element.addEventListener("mousedown",this.onMouseDown);this.element.addEventListener("mousemove",this.onMouseMove);this.element.addEventListener("mouseup",this.onMouseUp)};e.prototype.deactivate=function(){this.element.removeEventListener("mousedown",this.onMouseDown);this.element.removeEventListener("mousemove",this.onMouseMove);this.element.removeEventListener("mouseup",this.onMouseUp)};return e})();function wk(e){e.preventDefault();e.stopPropagation()}var Ek=(function(){function e(){}e.prototype.onMouseDown=function(e){this.output.onMouseDown(e);wk(e)};e.prototype.onMouseMove=function(e){this.output.onMouseMove(e);wk(e)};e.prototype.onMouseUp=function(e){this.output.onMouseUp(e);wk(e)};return e})(),Sk=(function(){function e(e){YC(this.head=new bk(e),new Ek,this.tail=new yk)}e.prototype.activate=function(){this.head.activate()};e.prototype.deactivate=function(){this.head.deactivate()};Object.defineProperty(e.prototype,"output",{set:function(e){this.tail.output=e},enumerable:!1,configurable:!0});return e})();function xk(e){return{offsetX:e.offsetX,offsetY:e.offsetY,pressure:.5,tiltX:0,tiltY:0,timeStamp:e.timeStamp,pointerType:"mouse"}}var Tk=(function(){function e(){}e.prototype.onMouseDown=function(e){this.output.onPointerDown(xk(e))};e.prototype.onMouseMove=function(e){this.output.onPointerMove(xk(e))};e.prototype.onMouseUp=function(e){this.output.onPointerUp(xk(e))};return e})(),Nk=(function(){function e(){this.activePointerId=-1}e.prototype.onPointerDown=function(e){if(-1===this.activePointerId){this.activePointerId=e.pointerId;this.output.onPointerDown(e)}};e.prototype.onPointerMove=function(e){this.activePointerId===e.pointerId&&this.output.onPointerMove(e)};e.prototype.onPointerUp=function(e){if(this.activePointerId===e.pointerId){this.output.onPointerUp(e);this.activePointerId=-1}};return e})();var Ck=(function(){function e(){}e.prototype.onPointerDown=function(e){this.output.onPointerDown(e)};e.prototype.onPointerMove=function(e){var t=this;(function(e){if("getCoalescedEvents"in e){var t=e.getCoalescedEvents();if(t.length>=1)return t}return[e]})(e).forEach(function(e){t.output.onPointerMove(e)})};e.prototype.onPointerUp=function(e){this.output.onPointerUp(e)};return e})(),kk=(function(){function e(e){var t=this;this.onPointerDown=function(e){t.output.onPointerDown(e)};this.onPointerMove=function(e){t.output.onPointerMove(e)};this.onPointerUp=function(e){t.output.onPointerUp(e)};this.element=e}e.prototype.activate=function(){this.element.addEventListener("pointerdown",this.onPointerDown);this.element.addEventListener("pointermove",this.onPointerMove);this.element.addEventListener("pointerup",this.onPointerUp)};e.prototype.deactivate=function(){this.element.removeEventListener("pointerdown",this.onPointerDown);this.element.removeEventListener("pointermove",this.onPointerMove);this.element.removeEventListener("pointerup",this.onPointerUp)};return e})(),Lk=(function(){function e(){}e.prototype.onPointerDown=function(e){this.output.onPointerDown(e);wk(e)};e.prototype.onPointerMove=function(e){this.output.onPointerMove(e);wk(e)};e.prototype.onPointerUp=function(e){this.output.onPointerUp(e);wk(e)};return e})(),Ak=(function(){function e(e){ZC(this.head=new kk(e),new Lk,new Nk,this.tail=new Ck)}e.prototype.activate=function(){this.head.activate()};e.prototype.deactivate=function(){this.head.deactivate()};Object.defineProperty(e.prototype,"output",{set:function(e){this.tail.output=e},enumerable:!1,configurable:!0});return e})();var Ok=(function(){function e(){this.wasPenDown=!1}e.prototype.onPointerDown=function(e){this.wasPenDown=(function(e){return"pen"===e.pointerType})(e)};e.prototype.onTouchStart=function(e){this.wasPenDown&&wk(e)};return e})();var Mk=(function(){function e(){this.activeIdentifier=-1}e.prototype.onTouchStart=function(e,t){if(-1===this.activeIdentifier){this.activeIdentifier=t.identifier;this.output.onTouchStart(e,t)}};e.prototype.onTouchMove=function(e,t){this.activeIdentifier===t.identifier&&this.output.onTouchMove(e,t)};e.prototype.onTouchEnd=function(e,t){if(this.activeIdentifier===t.identifier){this.output.onTouchEnd(e,t);this.activeIdentifier=-1}};return e})(),_k=(function(){function e(){}e.prototype.onTouchStart=function(e){for(var t=0;t<e.changedTouches.length;t+=1)this.output.onTouchStart(e,e.changedTouches[t])};e.prototype.onTouchMove=function(e){for(var t=0;t<e.changedTouches.length;t+=1)this.output.onTouchMove(e,e.changedTouches[t])};e.prototype.onTouchEnd=function(e){for(var t=0;t<e.changedTouches.length;t+=1)this.output.onTouchEnd(e,e.changedTouches[t])};return e})(),Dk=(function(){function e(e){var t=this;this.onTouchStart=function(e){t.output.onTouchStart(e)};this.onTouchMove=function(e){t.output.onTouchMove(e)};this.onTouchEnd=function(e){t.output.onTouchEnd(e)};this.element=e}e.prototype.activate=function(){this.element.addEventListener("touchstart",this.onTouchStart);this.element.addEventListener("touchmove",this.onTouchMove);this.element.addEventListener("touchend",this.onTouchEnd)};e.prototype.deactivate=function(){this.element.removeEventListener("touchstart",this.onTouchStart);this.element.removeEventListener("touchmove",this.onTouchMove);this.element.removeEventListener("touchend",this.onTouchEnd)};return e})(),Pk=(function(){function e(){}e.prototype.onTouchStart=function(e){this.output.onTouchStart(e);wk(e)};e.prototype.onTouchMove=function(e){this.output.onTouchMove(e);wk(e)};e.prototype.onTouchEnd=function(e){this.output.onTouchEnd(e);wk(e)};return e})(),Hk=(function(){function e(e){ZC(this.head=new Dk(e),new Pk,new _k,this.tail=new Mk)}e.prototype.activate=function(){this.head.activate()};e.prototype.deactivate=function(){this.head.deactivate()};Object.defineProperty(e.prototype,"output",{set:function(e){this.tail.output=e},enumerable:!1,configurable:!0});return e})();function Bk(e){return 180*e/Math.PI}function jk(e,t){var n=t.target.getBoundingClientRect();return{offsetX:t.clientX-n.left,offsetY:t.clientY-n.top,pressure:t.force,tiltX:Bk(Math.atan(Math.cos(t.azimuthAngle)/Math.tan(t.altitudeAngle))),tiltY:Bk(Math.atan(Math.sin(t.azimuthAngle)/Math.tan(t.altitudeAngle))),timeStamp:e.timeStamp,pointerType:"touch"}}var Fk=(function(){function e(){}e.prototype.onTouchStart=function(e,t){this.output.onPointerDown(jk(e,t))};e.prototype.onTouchMove=function(e,t){this.output.onPointerMove(jk(e,t))};e.prototype.onTouchEnd=function(e,t){this.output.onPointerUp(jk(e,t))};return e})(),Ik={type:0},qk={width:4,height:4,color:{r:0,g:0,b:0,a:1},effect:Ik,tip:"ellipse",rasterOperation:"copy"};function Rk(e){return{width:e.width,height:e.height,color:e.color,effect:e.effect,tip:e.tip,rasterOperation:e.rasterOperation}}var Uk=(function(){function e(e){this.attributes=Rk(void 0!==e?e:qk)}e.prototype.setWidth=function(e){this.attributes.width=e;return this};e.prototype.setHeight=function(e){this.attributes.height=e;return this};e.prototype.setColor=function(e){this.attributes.color=e;return this};e.prototype.setEffect=function(e){this.attributes.effect=e;return this};e.prototype.setTip=function(e){this.attributes.tip=e;return this};e.prototype.setRasterOperation=function(e){this.attributes.rasterOperation=e;return this};e.prototype.build=function(){return Rk(this.attributes)};return e})(),zk=(function(){function e(){this.offsetX=0;this.offsetY=0}e.prototype.setDrawingAttributes=function(e){this.output.setDrawingAttributes(1===e.effect.type?new Uk(e).setEffect({type:1,pattern:e.effect.pattern,offsetX:this.offsetX,offsetY:this.offsetY}).build():e)};e.prototype.beginStroke=function(e){this.output.beginStroke(e);this.begin=e};e.prototype.addPoint=function(e){this.output.addPoint(e)};e.prototype.endStroke=function(e){this.output.endStroke(e);var t=e.x-this.begin.x,n=e.y-this.begin.y,r=t>0?48:-48;this.offsetX+=t+r;this.offsetY+=n+r;this.offsetX%=540;this.offsetY%=540};return e})(),Wk=(function(){function e(){this.attributes=qk;this.offset=new zk}e.prototype.setDrawingAttributes=function(e){this.attributes=e};e.prototype.beginStroke=function(e){GC(this.offset,this.output);this.out=1===this.attributes.effect.type?this.offset:this.output;this.out.setDrawingAttributes(this.attributes);this.out.beginStroke(e)};e.prototype.addPoint=function(e){this.out.addPoint(e)};e.prototype.endStroke=function(e){this.out.endStroke(e)};return e})();var Xk=(function(){function e(e,t,n){this.wetCanvas=e;this.wetInkDryer=t;this.pointerEventInputPipelineSource=n;this.ignoreStroke=!1;this.drawingBounds=Ar}e.prototype.getShouldIgnoreStrokeOnPointerDown=function(e){if(!ep(e))return!0;var t=this.pointerEventInputPipelineSource.getBoundingClientRect();return!Or({x:e.clientX-t.left,y:e.clientY-t.top},this.drawingBounds)};e.prototype.onPointerDown=function(e){((function(e){return 5===e.button||32==(32&e.buttons)})(e)||(function(e){return 2===e.button||2==(2&e.buttons)})(e))&&this.wetInkDryer.dryAllStrokes();this.ignoreStroke=this.getShouldIgnoreStrokeOnPointerDown(e);if(!this.ignoreStroke){try{this.wetCanvas.setPointerCapture(e.pointerId)}catch(e){}this.output.onPointerDown(e)}};e.prototype.onPointerMove=function(e){this.ignoreStroke||this.output.onPointerMove(e)};e.prototype.onPointerUp=function(e){if(this.ignoreStroke)this.ignoreStroke=!1;else{this.output.onPointerUp(e);try{this.wetCanvas.releasePointerCapture(e.pointerId)}catch(e){}}};e.prototype.setDrawingBounds=function(e){this.drawingBounds=e};return e})();var Vk=(function(){function e(e){var t=this;this.onPointerOut=function(e){t.output.onPointerOut(e)};this.element=e}e.prototype.activate=function(){this.element.addEventListener("pointerout",this.onPointerOut)};e.prototype.deactivate=function(){this.element.removeEventListener("pointerout",this.onPointerOut)};return e})(),$k=(function(){function e(){}e.prototype.onPointerDown=function(e){this.output.onPointerDown(e);this.lastStrokeInProgressEvent=e};e.prototype.onPointerMove=function(e){this.output.onPointerMove(e);this.lastStrokeInProgressEvent=e};e.prototype.onPointerUp=function(e){this.output.onPointerUp(e);this.lastStrokeInProgressEvent=void 0};e.prototype.getLastStrokeInProgressEvent=function(){return this.lastStrokeInProgressEvent};return e})(),Jk=(function(){function e(e,t,n,r,i,s,o){s?YC(this.drawer=new mk(o),this.injector=new Wk,n):ZC(this.drawer=sk(),new ok,this.injector=new Wk,n);if(void 0!==window.PointerEvent){var u=e,a=new Ak(u),f=new Xk(i,r,u),l=new $k;ZC(this.input=a,this.pointerEventTransform=f,l,this.drawer);GC(this.inputPointerUpOnPointerOut=new Vk(e),(function(e,t){return{onPointerOut:function(n){var r=t.getLastStrokeInProgressEvent();r&&e.head.onPointerUp(r)}}})(a,l))}else if(void 0!==window.TouchEvent){var c=new Hk(e);YC(c,new Fk,this.drawer);this.input=c}else{var h=new Sk(e);YC(h,new Tk,this.drawer);this.input=h}GC(this.preventTouchStartOnStylusDown=new gk(t),new Ok)}e.prototype.activate=function(){var e;this.input.activate();null===(e=this.inputPointerUpOnPointerOut)||void 0===e||e.activate();this.activateStylus()};e.prototype.deactivate=function(){var e;this.deactivateStylus();null===(e=this.inputPointerUpOnPointerOut)||void 0===e||e.deactivate();this.input.deactivate()};e.prototype.activateStylus=function(){this.preventTouchStartOnStylusDown.activate()};e.prototype.deactivateStylus=function(){this.preventTouchStartOnStylusDown.deactivate()};e.prototype.setDrawingAttributes=function(e){this.injector.setDrawingAttributes(e)};e.prototype.setDrawingBounds=function(e){var t;null===(t=this.pointerEventTransform)||void 0===t||t.setDrawingBounds(e)};return e})();var Kk=(function(){function e(e){var t=this;this.isLoopActive=!1;this.animationCallback=function(){t.delegate();t.isLoopActive&&window.requestAnimationFrame(t.animationCallback)};this.delegate=e}e.prototype.onStrokeBegin=function(){this.isLoopActive=!0;window.requestAnimationFrame(this.animationCallback)};e.prototype.onStrokeEnd=function(){this.isLoopActive=!1};return e})(),Qk=(function(){function e(){}e.prototype.toCSSColor=function(e){return(function(e){return"rgba("+e.r+","+e.g+","+e.b+","+e.a+")"})(e)};return e})();var Gk=2*Math.PI;function Yk(e,t,n){e.arc(t.x,t.y,n,0,Gk)}function Zk(e,t,n,r){var i=t.x-n,s=t.x+n,o=t.y-r,u=t.y+r;e.moveTo(i,o);e.lineTo(s,o);e.lineTo(s,u);e.lineTo(i,u);e.lineTo(i,o)}function eL(e,t){e.moveTo(t.p1.x,t.p1.y);e.lineTo(t.p2.x,t.p2.y);e.lineTo(t.p3.x,t.p3.y);e.lineTo(t.p4.x,t.p4.y);e.lineTo(t.p1.x,t.p1.y)}function tL(e,t,n,r,i,s){(function(e,t,n,r,i){var s=n.x-e.x,o=n.y-e.y,u=Math.sqrt(s*s+o*o);if(u<=Math.abs(r-t))return!1;var a=s/u,f=-o/u,l=(r-t)/u,c=Math.sqrt(1-l*l),h=f*c+a*l,p=a*c-f*l,d=f*c-a*l,v=a*c+f*l;i.p1.x=e.x-h*t;i.p1.y=e.y-p*t;i.p2.x=n.x-h*r;i.p2.y=n.y-p*r;i.p3.x=n.x+d*r;i.p3.y=n.y+v*r;i.p4.x=e.x+d*t;i.p4.y=e.y+v*t;return!0})(t,n,r,i,s)&&eL(e,s)}function nL(e){return 1.5*e+.25}var rL=(function(){function e(e,t){this.quad={p1:{x:0,y:0},p2:{x:0,y:0},p3:{x:0,y:0},p4:{x:0,y:0}};this.builder=e;this.tipRadius=t.width/2}e.prototype.beginStroke=function(e){this.builder.beginPath();this.updateRadius(e);Yk(this.builder,e,this.radius);this.lastPoint=e};e.prototype.addPoint=function(e){this.updateRadius(e);tL(this.builder,e,this.radius,this.lastPoint,this.lastRadius,this.quad);Yk(this.builder,e,this.radius);this.lastPoint=e};e.prototype.endStroke=function(e){this.addPoint(e);this.builder.closePath()};e.prototype.updateRadius=function(e){this.lastRadius=this.radius;this.radius=this.tipRadius*nL(e.pressure)};return e})(),iL=(function(){function e(e,t){this.quad={p1:{x:0,y:0},p2:{x:0,y:0},p3:{x:0,y:0},p4:{x:0,y:0}};this.builder=e;this.tipWidth=t.width/2;this.tipHeight=t.height/2}e.prototype.beginStroke=function(e){this.builder.beginPath();this.updateSize(e);Zk(this.builder,e,this.width,this.height);this.lastPoint=e};e.prototype.addPoint=function(e){this.updateSize(e);(function(e,t,n,r,i,s,o,u){(function(e,t,n,r,i,s,o){var u=r.x-e.x>0?1:-1,a=r.y-e.y>0?1:-1;o.p1.x=e.x-a*t;o.p1.y=e.y+u*n;o.p2.x=e.x+a*t;o.p2.y=e.y-u*n;o.p3.x=r.x+a*i;o.p3.y=r.y-u*s;o.p4.x=r.x-a*i;o.p4.y=r.y+u*s})(t,n,r,i,s,o,u);eL(e,u)})(this.builder,e,this.width,this.height,this.lastPoint,this.lastWidth,this.lastHeight,this.quad);Zk(this.builder,e,this.width,this.height);this.lastPoint=e};e.prototype.endStroke=function(e){this.addPoint(e);this.builder.closePath()};e.prototype.updateSize=function(e){this.lastWidth=this.width;this.lastHeight=this.height;var t=nL(e.pressure);this.width=this.tipWidth*t;this.height=this.tipHeight*t};return e})();function sL(e){throw e}function oL(e,t,n,r,i){e.lineWidth=t.width;var s=(function(e,t,n,r,i){if(1===t.effect.type){var s=t.effect,o=n.toCanvasImageSource(s);if(void 0!==o){var u=e.createPattern(o,"repeat");if(null!==u){e.scale(.5,.5);e.translate(i.x-s.offsetX,i.y-s.offsetX);return u}}}return r.toCSSColor(t.color)})(e,t,n,r,i);e.strokeStyle=s;e.fillStyle=s;switch(t.tip){case"ellipse":e.lineCap="round";e.lineJoin="round";break;case"rectangle":e.lineCap="butt";e.lineJoin="miter";break;default:sL(t.tip)}switch(t.rasterOperation){case"copy":e.globalCompositeOperation="source-over";break;case"mask":e.globalCompositeOperation="darken";break;default:sL(t.rasterOperation)}}var uL=(function(){function e(e,t,n){void 0===n&&(n=new Qk);this.context=e;this.effectResolver=t;this.colorResolver=n}e.prototype.setDrawingAttributes=function(e){this.attributes=e};e.prototype.beginStroke=function(e){this.pathBuilder="ellipse"===this.attributes.tip?new rL(this.context,this.attributes):new iL(this.context,this.attributes);this.pathBuilder.beginStroke(e);this.beginPoint=e};e.prototype.addPoint=function(e){this.pathBuilder.addPoint(e)};e.prototype.endStroke=function(e){this.pathBuilder.endStroke(e);this.context.save();oL(this.context,this.attributes,this.effectResolver,this.colorResolver,this.beginPoint);this.context.fill();this.context.restore()};return e})(),aL=(function(){function e(){}e.prototype.toCanvasImageSource=function(){};e.prototype.toSVGImageElement=function(){};return e})();var fL={alpha:!0,desynchronized:!1};function lL(e,t){var n=e.getContext("2d",t);if(null===n)throw new Error("Could not get 2D context from canvas.");return n}function cL(e){return lL(e,fL)}var hL=(function(){function e(e,t){var n,r=this;this.strokeBeginEndListener={onStrokeBegin:function(){r.renderLoop.onStrokeBegin()},onStrokeEnd:function(){r.renderLoop.onStrokeEnd()}};this.isIncrementalRender=!0;this.render=function(){r.isIncrementalRender||r.clear();r.store.streamWetStroke(r.wetRenderer,r.isIncrementalRender)};this.store=t;this.wetCanvasContext=cL(e);this.wetRenderer=(n=this.wetCanvasContext,new uL(n,new aL));this.renderLoop=new Kk(this.render)}e.prototype.clear=function(){(function(e){e.save();e.setTransform(1,0,0,1,0,0);e.clearRect(0,0,e.canvas.width,e.canvas.height);e.restore()})(this.wetCanvasContext)};e.prototype.setIncrementalRender=function(e){this.isIncrementalRender=e};e.prototype.onStrokeBegin=function(){this.strokeBeginEndListener.onStrokeBegin()};e.prototype.onStrokeEnd=function(){this.strokeBeginEndListener.onStrokeEnd()};return e})();function pL(){}var dL=(function(){function e(){this.baseId=0}e.prototype.generate=function(){return this.baseId+=1};return e})();var vL=(function(){function e(){this.id=0;this.drawingAttributes=qk;this.points=[]}e.prototype.streamChannels=function(e){this.points.forEach(function(t){e.addPoint(t);e.addPressure((function(e){return e.pressure})(t));e.addTilt(t);e.addTimestamp((function(e){return e.timestamp})(t))})};e.prototype.streamPoints=function(e){this.points.forEach(function(t){e.add(t)})};e.prototype.streamPath=function(e){mL(this,e,0)};e.prototype.stream=function(e){gL(this,e,0)};e.prototype.add=function(e){this.points.push(e)};return e})();function mL(e,t,n){if(n+2>e.points.length)return n;t.beginStroke(e.points[n]);for(var r=n+1;r<e.points.length-1;r+=1)t.addPoint(e.points[r]);t.endStroke(e.points[e.points.length-1]);return e.points.length-1}function gL(e,t,n){t.setDrawingAttributes(e.drawingAttributes);return mL(e,t,n)}var yL=(function(){function e(e){this.idGenerator=new dL;this.currentStroke=new vL;this.inputStrokes=[];this.newPointsIndex=0;this.noop={add:pL};this.output=this.noop;this.beginEndSink=e}e.prototype.setDrawingAttributes=function(e){this.currentStroke.drawingAttributes=e};e.prototype.beginStroke=function(e){this.newPointsIndex=0;this.currentStroke.id=this.idGenerator.generate();this.beginEndSink.onStrokeBegin();this.output=this.currentStroke;this.output.add(e)};e.prototype.addPoint=function(e){this.output.add(e)};e.prototype.endStroke=function(e){if(this.output!==this.noop){this.output.add(e);this.inputStrokes.push([this.currentStroke,this.newPointsIndex]);this.cancel()}};e.prototype.cancel=function(){if(this.output!==this.noop){this.output=this.noop;this.currentStroke=new vL;this.beginEndSink.onStrokeEnd()}};e.prototype.streamCollectedStrokes=function(e){this.inputStrokes.forEach(function(t){e.add(t[0]);t[1]=t[0].points.length-1})};e.prototype.streamCollectedStrokesNewPoints=function(e){this.inputStrokes.forEach(function(t){t[1]=gL(t[0],e,t[1])})};e.prototype.resetCollectedStrokes=function(){this.inputStrokes=[]};e.prototype.streamCurrentStroke=function(e){this.newPointsIndex=gL(this.currentStroke,e,0)};e.prototype.streamCurrentStrokeNewPoints=function(e){this.newPointsIndex=gL(this.currentStroke,e,this.newPointsIndex)};return e})(),bL=(function(){function e(){var e=this;this.collectedWetStrokesSink=null;this.wetStrokeCollector=new yL({onStrokeBegin:function(){e.wetInkDryer.onStrokeBegin()},onStrokeEnd:function(){e.wetInkDryer.onStrokeEnd()}})}e.prototype.streamWetStroke=function(e,t){if(t){this.wetStrokeCollector.streamCurrentStrokeNewPoints(e);this.wetStrokeCollector.streamCollectedStrokesNewPoints(e)}else{this.wetStrokeCollector.streamCurrentStroke(e);this.wetStrokeCollector.streamCollectedStrokes({add:function(t){t.stream(e)}})}};e.prototype.setCollectedWetStrokesSink=function(e){this.collectedWetStrokesSink=e};e.prototype.clearCollectedWetStrokesSink=function(){this.collectedWetStrokesSink=null};e.prototype.setInkDryer=function(e){this.wetInkDryer=e;this.initializeDryStrokesCallback()};e.prototype.initializeDryStrokesCallback=function(){var e=this;this.wetInkDryer.setTask(function(){e.wetStrokeCollector.streamCollectedStrokes({add:function(t){var n;null===(n=e.collectedWetStrokesSink)||void 0===n||n.add(t)}});e.wetStrokeCollector.resetCollectedStrokes()})};e.prototype.dryAllStrokes=function(){this.wetInkDryer.dryAllStrokes()};e.prototype.getWetStrokeCollector=function(){return this.wetStrokeCollector};return e})(),wL=(function(){function e(e,t){var n=this;this.task=function(){};this.executeTask=function(){n.task();n.renderer.clear();n.resetPendingTask()};this.renderer=e;this.idleTimeToDryInkInMs=t}e.prototype.setTask=function(e){this.task=e};e.prototype.onStrokeBegin=function(){this.renderer.onStrokeBegin();void 0!==this.timeoutTask&&this.resetPendingTask()};e.prototype.onStrokeEnd=function(){this.renderer.onStrokeEnd();this.timeoutTask=window.setTimeout(this.executeTask,this.idleTimeToDryInkInMs)};e.prototype.dryAllStrokes=function(){this.executeTask();this.resetPendingTask()};e.prototype.resetPendingTask=function(){window.clearTimeout(this.timeoutTask)};return e})();function EL(e,t){var n=Object(uc.e)(e);if(!n)throw new Error("A valid color must be provided: "+e);return{r:n.r,g:n.g,b:n.b,a:t}}function SL(e){var t=cL(e),n=e.width/(e.clientWidth||1),r=e.height/(e.clientHeight||1);t.setTransform(1,0,0,1,0,0);t.scale(n,r)}var xL=(function(){function e(e,t,n,r,i){this.wetCanvas=e;SL(e);this.store=new bL;this.renderer=new hL(this.wetCanvas,this.store);var s=new wL(this.renderer,n);this.store.setInkDryer(s);this.pipeline=new Jk(this.wetCanvas,t,this.store.getWetStrokeCollector(),s,this.wetCanvas,r,i)}e.prototype.startPipeline=function(){this.pipeline.activate();this.enableCanvasPointerEvents()};e.prototype.stopPipeline=function(){this.disableCanvasPointerEvents();this.renderer.clear();this.pipeline.deactivate()};e.prototype.enableCanvasPointerEvents=function(){this.wetCanvas.style.pointerEvents="auto"};e.prototype.disableCanvasPointerEvents=function(){this.wetCanvas.style.pointerEvents="none"};e.prototype.updateInkAttributes=function(e){var t=(function(e){var t=new Uk,n=e.inkType,r=e.htmlColor,i=e.thicknessInCssPixels;switch(n){case _s.Highlighter:var s=EL(r,.5);t.setTip("rectangle").setWidth(i/2).setHeight(i).setColor(s).setRasterOperation("copy");break;case _s.Pen:s=EL(r,1);t.setTip("ellipse").setWidth(i).setHeight(i).setColor(s).setRasterOperation("copy");break;default:throw new oa(n)}return t.build()})(e);this.pipeline.setDrawingAttributes(t);this.renderer.setIncrementalRender((function(e){switch(e){case _s.Highlighter:return!1;case _s.Pen:return!0;default:throw new oa(e)}})(e.inkType))};e.prototype.setCollectedWetStrokesSink=function(e){this.store.setCollectedWetStrokesSink(e)};e.prototype.clearCollectedWetStrokesSink=function(){this.store.clearCollectedWetStrokesSink()};e.prototype.onCanvasDimensionsUpdated=function(e){SL(e)};e.prototype.dryAllStrokes=function(){this.store.dryAllStrokes()};e.prototype.setDrawingBounds=function(e){this.pipeline.setDrawingBounds(e)};return e})();function TL(e,t,n,r){var s=Object(i.useCallback)(function(){if(e){var i=(null==t?void 0:t.clientWidth)||0,s=(null==t?void 0:t.clientHeight)||0;e.style.width=i+"px";e.style.height=s+"px";(function(e,t){if(e){e.restore();e.save();e.beginPath();var n=Vn(t),r=n[0],i=n[1],s=n[2],o=n[3];e.moveTo(r.x,r.y);e.lineTo(i.x,i.y);e.lineTo(s.x,s.y);e.lineTo(o.x,o.y);e.clip()}})(e.getContext("2d"),r);null==n||n.onCanvasDimensionsUpdated(e)}},[e,r,t,n]);Rm(t,s)}var NL=function(){return(NL=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)},CL=Object(i.memo)(function(e){var t=e.cropViewTransform,n=e.cssToPhysicalPixelRatio,r=e.width,o=e.height,u=e.cssWidth,a=e.cssHeight,f=e.styles,l=Object(i.useContext)(IC),c=l.wetInkCanvas,h=l.setWetInkCanvas,p=Object(i.useRef)(),d=Object(i.useState)(null),v=d[0],m=d[1],g=Object(i.useState)(null),y=g[0],b=g[1];Jh(y);Object(i.useEffect)(function(){if(y&&v){var e=(function(e,t){return new xL(e,t,0,!0,.5)})(y,v);e.startPipeline();h(e)}return function(){var e;null===(e=p.current)||void 0===e||e.stopPipeline();h(void 0)}},[y,v,h]);p.current=c;TL(y,v,c,t);(function(e,t,n){Object(i.useEffect)(function(){var r=Hr(Jn(Mn(1/n),t));null==e||e.setDrawingBounds(r)},[t,n,e])})(c,t,n);return s.a.createElement("div",{ref:m,style:{width:u,height:a,position:"absolute",top:0,left:0}},s.a.createElement("canvas",{ref:b,width:r,height:o,style:NL({touchAction:"none",pointerEvents:"none",position:"absolute",top:0,left:0},f)}))});function kL(e,t){void 0===t&&(t=1e-6);return e<-t||t<e}function LL(e,t,n){void 0===n&&(n=1e-6);return(function(e,t){void 0===t&&(t=1e-6);return-t<=e&&e<=t})(e-t,n)}var AL=function(e,t,n){this.incomingTangent1={x:Number.NaN,y:Number.NaN};this.incomingTangent2={x:Number.NaN,y:Number.NaN};this.outgoingTangent1={x:Number.NaN,y:Number.NaN};this.outgoingTangent2={x:Number.NaN,y:Number.NaN};this.center={x:e,y:t};this.radius=n},OL=(function(){function e(e,t){this.stroke=[];this.builder=e;this.tipRadius=t.width/2}e.prototype.beginStroke=function(e){this.builder.beginPath();this.stroke=[];this.addPoint(e)};e.prototype.addPoint=function(e){var t=new AL(e.x,e.y,this.calcRadius(e));this.stroke.push(t)};e.prototype.endStroke=function(e){this.addPoint(e);(function(e){for(var t=1;t<e.length;t++){var n=e[t-1],r=e[t],i=n.center.x,s=n.center.y,o=n.radius,u=r.center.x,a=r.center.y,f=r.radius,l=i-u,c=s-a,h=Math.sqrt(l*l+c*c),p=Math.abs(f-o);if(!(p>h)){var d=1/h,v=p*d,m=Math.sqrt(1-v*v),g=l*d,y=c*d;if(o>f){m=-m;g=-g;y=-y}var b=g*v,w=y*v,E=g*m,S=y*m,x=b+S,T=w-E,N=b-S,C=w+E;n.outgoingTangent1.x=i+o*x;n.outgoingTangent1.y=s+o*T;n.outgoingTangent2.x=i+o*N;n.outgoingTangent2.y=s+o*C;r.incomingTangent1.x=u+f*x;r.incomingTangent1.y=a+f*T;r.incomingTangent2.x=u+f*N;r.incomingTangent2.y=a+f*C}}})(this.stroke);this.buildMinimalPathFromStroke(this.stroke);this.builder.closePath()};e.prototype.buildMinimalPathFromStroke=function(e){for(var t=0,n=0;n<e.length;n++)if(n===e.length-1||isNaN(e[n].outgoingTangent1.x)){ML(this.builder,e,t,n);t=n+1}};e.prototype.calcRadius=function(e){return this.tipRadius*nL(e.pressure)};return e})();function ML(e,t,n,r){if(n!==r){var i=t[n];e.moveTo(i.outgoingTangent1.x,i.outgoingTangent1.y);var s,o=i;i=t[n+1];for(var u=n+1;u<r;u++){s=t[u+1];if(void 0!==(f=_L(o.outgoingTangent1,i.incomingTangent1,i.outgoingTangent1,s.incomingTangent1)))e.lineTo(f.x,f.y);else{e.lineTo(i.incomingTangent1.x,i.incomingTangent1.y);e.arcArc(i.radius,i.radius,0,0,0,i.outgoingTangent1.x,i.outgoingTangent1.y)}o=i;i=s}e.lineTo(i.incomingTangent1.x,i.incomingTangent1.y);var a=i.radius>t[r-1].radius?1:0;e.arcArc(i.radius,i.radius,0,a,0,i.incomingTangent2.x,i.incomingTangent2.y);o=i;i=t[r-1];for(u=r-1;u>n;u--){s=t[u-1];var f;if(void 0!==(f=_L(o.incomingTangent2,i.outgoingTangent2,i.incomingTangent2,s.outgoingTangent2)))e.lineTo(f.x,f.y);else{e.lineTo(i.outgoingTangent2.x,i.outgoingTangent2.y);e.arcArc(i.radius,i.radius,0,0,0,i.incomingTangent2.x,i.incomingTangent2.y)}o=i;i=s}e.lineTo(i.outgoingTangent2.x,i.outgoingTangent2.y);var l=i.radius>t[n+1].radius?1:0;e.arcArc(i.radius,i.radius,0,l,0,i.outgoingTangent1.x,i.outgoingTangent1.y)}else(function(e,t){e.moveTo(t.center.x-t.radius,t.center.y);e.arcArc(t.radius,t.radius,0,0,0,t.center.x+t.radius,t.center.y);e.arcArc(t.radius,t.radius,0,0,0,t.center.x-t.radius,t.center.y)})(e,t[n])}function _L(e,t,n,r){if(!((r.x-n.x)*(t.y-e.y)-(t.x-e.x)*(r.y-n.y)>0)){var i=t.y-e.y,s=e.x-t.x,o=i*e.x+s*e.y,u=r.y-n.y,a=n.x-r.x,f=u*n.x+a*n.y,l=i*a-u*s;if(kL(l)){var c=1/l,h=(a*o-s*f)*c,p=(i*f-u*o)*c;if(DL(h,p,e,t)&&DL(h,p,n,r))return{x:h,y:p}}}}function DL(e,t,n,r){return(Math.min(n.x,r.x)<e||LL(Math.min(n.x,r.x),e))&&(Math.max(n.x,r.x)>e||LL(Math.max(n.x,r.x),e))&&(Math.min(n.y,r.y)<t||LL(Math.min(n.y,r.y),t))&&(Math.max(n.y,r.y)>t||LL(Math.max(n.y,r.y),t))}var PL=(function(){function e(e){void 0===e&&(e=1);this.path="";this.precision=e}e.prototype.beginPath=function(){this.path=""};e.prototype.arc=function(e,t,n){var r=this.formatPosition(n),i=this.formatPosition(t),s=this.formatPosition(e-n),o=this.formatPosition(e+n);this.path+="M"+s+","+i;this.path+="A"+r+","+r+" 0 0,1 "+o+","+i;this.path+="A"+r+","+r+" 0 0,1 "+s+","+i};e.prototype.arcArc=function(e,t,n,r,i,s,o){this.path+="A"+this.formatPosition(e)+","+this.formatPosition(t)+" "+this.formatPosition(n)+" "+this.formatPosition(r)+" "+this.formatPosition(i)+" "+this.formatPosition(s)+","+this.formatPosition(o)};e.prototype.lineTo=function(e,t){this.path+="L"+this.formatPosition(e)+","+this.formatPosition(t)};e.prototype.moveTo=function(e,t){this.path+="M"+this.formatPosition(e)+","+this.formatPosition(t)};e.prototype.closePath=function(){};e.prototype.getPath=function(){return this.path};e.prototype.formatPosition=function(e){return t=e,n=this.precision,""+parseFloat(t.toFixed(n));var t,n};return e})();var HL=(function(){function e(e,t){void 0===t&&(t=1);this.attributes=e;this.svgPathBuilder=new PL(t)}e.prototype.beginStroke=function(e){this.pathBuilder="ellipse"===this.attributes.tip?new OL(this.svgPathBuilder,this.attributes):new iL(this.svgPathBuilder,this.attributes);this.pathBuilder.beginStroke(e)};e.prototype.addPoint=function(e){var t;null===(t=this.pathBuilder)||void 0===t||t.addPoint(e)};e.prototype.endStroke=function(e){var t;null===(t=this.pathBuilder)||void 0===t||t.endStroke(e)};e.prototype.getSvgAttributes=function(){var e=new Qk;return{path:this.svgPathBuilder.getPath(),fill:e.toCSSColor(this.attributes.color)}};return e})(),BL=function(){return(BL=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)};function jL(e){var t=e.points,n=e.drawingAttributes,r=BL(BL({},n),{effect:Ik}),i=(function(e,t){var n=new vL;n.points=e;n.drawingAttributes=t;return n})(t,r),s=new HL(r);i.streamPath(s);return s.getSvgAttributes()}function FL(e,t,n){var r=(function(e,t,n){var r=t.fill,i=t.path;return new e.Path(i,{fill:r,id:n})})(e,jL(t),t.id);(function(e,t,n,r){var i=(function(e,t,n,r){var i=Jn(t,n);return e.util.multiplyTransformMatrices(er(i),r)})(e,t,n,r.calcTransformMatrix());XC(e,r,i);r.fabricToViewTransform=Jn(qn(t),(s=(function(e){if(6!==e.length)throw new TypeError("Invalid number array: must contain 6 elements");return[e[0],e[1],e[2],e[3],e[4],e[5]]})(r.calcTransformMatrix()),[s[0],s[2],s[4],s[1],s[3],s[5]]));var s})(e,n,t.initialInvertedPhysicalImageTransform,r);return r}var IL=function(e,t,n){switch(t.contentType){case Ou.InkContent:return FL(e,t,n);default:throw new Error("To be implemented for "+t.contentType)}},qL=function(){return(qL=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)},RL=Object(i.memo)(function(e){var t=Object(i.useContext)(BC).fabricCanvas,n=(function(e){switch(e){case"Eraser":return!1;case"Highlighter":case"Pen":return!0;default:throw new oa(e)}})(e.activeMarkupToolType)&&null!==t,r=Object(i.useContext)(jC).fabric,o=Object(i.useMemo)(function(){if(r)return(function(e,t){return function(n){return IL(e,n,t)}})(r,e.imageViewTransform)},[r,e.imageViewTransform]);return s.a.createElement("div",{style:{cursor:e.cursor}},s.a.createElement(QC,qL({},e,{convertToFabricContent:o})),n&&s.a.createElement(CL,qL({},e)))});var UL=Object(i.memo)(function(e){var t=e.inkBrush;(function(e,t){Object(i.useLayoutEffect)(function(){e&&e.updateInkAttributes(t)},[e,t])})(Object(i.useContext)(IC).wetInkCanvas,t);return null}),zL=function(){return(zL=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)},WL=Object(i.memo)(function(e){var t=e.imageViewTransform,n=e.cssToPhysicalPixelRatio,r=e.addInkContent,o=Object(i.useContext)(IC).wetInkCanvas,u=Object(i.useContext)(jC).fabric;(function(e,t){Object(i.useEffect)(function(){e&&e.setCollectedWetStrokesSink({add:function(e){t(e)}});return function(){null==e||e.clearCollectedWetStrokesSink()}},[e,t])})(o,Object(i.useCallback)(function(e){u&&r(zL(zL({},e),{contentType:Ou.InkContent,initialInvertedPhysicalImageTransform:Jn(qn(t),Mn(n))}))},[r,n,u,t]));return s.a.createElement(UL,zL({},e))}),XL={Pen:{cssThicknesses:[1,2,4,6,8,12],minSliderValue:1},Highlighter:{cssThicknesses:[8,12,16,24,28,32],minSliderValue:1}},VL=function(e){var t=e.children,r=Object(i.useState)(null),o=r[0],u=r[1],a=Se(),f=Object(i.useCallback)(function(){n.ee(67,4833,7).then(function(e){u(e.default.fabric)}).catch(function(e){return a({id:"CodeSplitFailed",message:"Failed to load Fabric package"})})},[a]);return s.a.createElement(jC.Provider,{value:{fabric:o,loadFabric:f}},t)};function $L(){return n.ee(67,4833,7)}var JL=function(e){var t=e.enableMarkup,n=void 0===t||t,r=e.inkConfigurations,o=void 0===r?XL:r,u=e.localizationStrings,a=e.initialInkBrushConfigurations,f=void 0===a?xa:a,l=e.children,c=Object(i.useState)(Na),h=c[0],p=c[1],d=Aa(f);return s.a.createElement(Ca.Provider,{value:{enableMarkup:n,Canvas:RL,canvasMethods:h,setCanvasMethods:p,InkCanvasInteraction:WL,inkConfigurations:o,localizationStrings:u,scriptsToLoadJSBundles:[$L],inkBrushConfigurations:d}},s.a.createElement(qC,null,s.a.createElement(VL,null,s.a.createElement(FC,null,l))))},KL={strings:{toolbar_imageSave:AC.Xe,toolbar_imageSaveTooltip:AC.Ye,toolbar_imageSaveAsOriginal:AC.Ke,toolbar_imageSaveAsOriginalAriaLabel:AC.Qe,toolbar_imageSaveAsOriginalTooltip:AC.Ge,toolbar_imageSaveAsCopy:AC.Ve,toolbar_imageSaveAsCopyAriaLabel:AC.$e,toolbar_imageSaveAsCopyTooltip:AC.Je,toolbar_imageReset:AC.Re,toolbar_imageResetAriaLabel:AC.Ue,toolbar_imageResetFinishedAriaLive:AC.ze,toolbar_imageResetTooltip:AC.We,toolbar_zoomLevelAriaLabel:AC.rt,toolbar_zoomInAriaLabel:AC.tt,toolbar_zoomInTooltip:AC.nt,toolbar_zoomOutTooltip:AC.st,toolbar_zoomOutAriaLabel:AC.it,toolbar_cancelAriaLabel:AC.Fe,toolbar_cancelTooltip:AC.Ie,toolbar_fitToViewTooltip:AC.qe,toolbar_saveMenuSplitButtonAriaLabel:AC.Ze,toolbar_viewActualSizeTooltip:AC.et,rotate_left90:AC.Oe,rotate_left90AriaLabel:AC.Me,rotate_left90FinishedAriaLive:AC._e,rotate_right90:AC.De,rotate_right90AriaLabel:AC.Pe,rotate_right90FinishedAriaLive:AC.He,rotate_sliderAriaLabel:AC.Be,rotate_degree:AC.Ae,rotate_sliderTooltip:AC.je,flip_horizontal:AC.le,flip_horizontalAriaLabel:AC.ce,flip_horizontalFinishedAriaLive:AC.he,flip_vertical:AC.ge,flip_verticalAriaLabel:AC.ye,flip_verticalFinishedAriaLive:AC.be,aspectRatio_freeform:AC.d,aspectRatio_freeformAriaLabel:AC.v,aspectRatio_original:AC.m,aspectRatio_originalAriaLabel:AC.g,aspectRatio_square:AC.w,aspectRatio_squareAriaLabel:AC.E,aspectRatio_ratioAriaLabelFormatString:AC.y,aspectRatio_ratioLabelFormatString:AC.b,aspectRatio_tooltip:AC.S,aspectRatio_changedAriaLive:AC.p,footer_done:AC.we,flip_portrait:AC.ve,flip_portraitAriaLabel:AC.me,flip_landscape:AC.pe,flip_landscapeAriaLabel:AC.de,crop_topLeftCornerAriaLabel:AC.B,crop_topRightCornerAriaLabel:AC.j,crop_bottomLeftCornerAriaLabel:AC.A,crop_bottomRightCornerAriaLabel:AC.O,crop_cornerTooltip:AC.M,crop_rectangleAriaLabel:AC._,crop_rectangleTooltip:AC.H,crop_rectanglePositionAriaLive:AC.P,crop_rectangleCannotMoveInCurrentDirectionAriaLive:AC.D,adjustment_brightness:AC.e,adjustment_color:AC.t,adjustment_lightAriaLandmark:AC.u,adjustment_colorAriaLandmark:AC.n,adjustment_contrast:AC.r,adjustment_exposure:AC.i,adjustment_highlights:AC.s,adjustment_light:AC.o,adjustment_saturation:AC.a,adjustment_shadows:AC.f,adjustment_temperature:AC.l,adjustment_tint:AC.c,adjustment_vignette:AC.h,editor_viewingOriginal:AC.R,editor_viewingOriginalAriaLive:AC.U,editor_zoomPercentAriaLive:AC.z,editor_imageDimensionLabelFormatString:AC.q,editor_imageDimensionAriaLabelFormatString:AC.F,editor_imageDimensionAriaLive:AC.I,pivot_crop:AC.Ce,pivot_adjustment:AC.Ne,pivot_filter:AC.ke,pivot_markup:AC.Le,nonCrop_imageTooltip:AC.xe,nonCrop_imageAriaLabelWithEdits:AC.Ee,nonCrop_imageAriaLabelWithoutEdits:AC.Se,nonCrop_panViewPositionAriaLive:AC.Te,filter_intensitySliderHeader:AC.$,filter_intensitySliderAriaLabelFormatString:AC.V,filter_nameOriginal:AC.ie,filter_nameBurn:AC.J,filter_nameBw:AC.K,filter_nameBwCool:AC.Q,filter_nameBwHighContrast:AC.G,filter_nameBwWarm:AC.Y,filter_nameCoolLight:AC.ee,filter_nameCalm:AC.Z,filter_nameDramaticCool:AC.te,filter_nameFilm:AC.ne,filter_nameGolden:AC.re,filter_namePunch:AC.se,filter_nameRadiate:AC.oe,filter_nameVintage:AC.ue,filter_nameVividCool:AC.ae,filter_nameWarmContrast:AC.fe,filter_filtersAriaLandmark:AC.X,filter_changedAriaLive:AC.W,autoEnhance_name:AC.k,autoEnhance_generatingAriaLive:AC.T,autoEnhance_appliedAriaLive:AC.x,autoEnhance_removedAriaLive:AC.L,autoEnhance_intensitySliderHeader:AC.C,autoEnhance_intensitySliderAriaLabel:AC.N}};t.default=function(e){var t=HC(e.imageUrl)[0],n=Object(i.useRef)(null),s=e.platformDetection.isMobile,o=Object(i.useCallback)(function(i){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var s,o;return Object(r.__generator)(this,function(r){switch(r.label){case 0:s=i===Pf.SaveAs;return n.current?[4,n.current.getEditedImage(t)]:[3,2];case 1:(o=r.sent())?e.executeSave(o,s):u({id:"SaveFailed",message:"unable to get canvas from getEditedImage"});r.label=2;case 2:return[2]}})})},[t,n]),u=Object(i.useCallback)(function(t){var n=t.id,r=t.message;Ix.e.logData({isIntentional:!1,name:"Error",extraData:{id:n.toString(),message:r},currentPage:e.engagementCurrentPage})},[]),a=Object(i.useCallback)(function(){e.onClose()},[]),f=Object(i.useCallback)(function(t){var n=t.name,i=t.isIntentional,s=Object(r.__rest)(t,["name","isIntentional"]);Ix.e.logData({isIntentional:i,name:n,extraData:Object(r.__assign)({},s),currentPage:e.engagementCurrentPage})},[]),l=(function(){var e=Object(i.useState)({width:window.innerWidth,height:window.innerHeight}),t=e[0],n=e[1],r=Object(i.useCallback)(function(){n({width:window.innerWidth,height:window.innerHeight})},[]);Object(i.useEffect)(function(){window.addEventListener("resize",r);return function(){window.removeEventListener("resize",r)}},[r]);return t})(),c=s?LC:CC,h=s?Hb.Mobile:Hb.Desktop;return i.createElement(_C.e,null,i.createElement(OC.e,{isClickableOutsideFocusTrap:!0,forceFocusInsideTrap:!0},i.createElement(F,{theme:c},i.createElement(JL,{enableMarkup:Object(MC.isFeatureEnabled)(MC.EnableEditControlMarkup),localizationStrings:fa},i.createElement(Fx,{ref:n,componentSize:l,image:t,onDecideEnabledSaveTypes:function(t,n,r){var i=new Set(If(0,n,r));e.enableSaveOriginal||i.delete(Pf.SaveAsOriginal);return i},onSave:o,onClose:a,onError:u,telemetryCallback:f,componentImplementationContext:NC,localization:KL,enableAdjustments:Object(MC.isFeatureEnabled)(MC.EnableEditControlAdjustments),enableFilters:Object(MC.isFeatureEnabled)(MC.EnableEditControlFilters),layout:{type:h}})))))}}}]);