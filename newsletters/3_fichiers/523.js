(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([[523,463],{1816:function(e,t,n){"use strict";var r=n(0),i=n("knockout-lib"),s=n(1829),o=n(1794);function u(e){var t=document.createElement("div");t.tabIndex=0;t.className="ms-accessible";t.setAttribute("role","presentation");t.setAttribute("aria-hidden","true");t.setAttribute("data-focus-trap",e);return t}var a=s.focusNextTabStop,f=s.focusPreviousTabStop,l=i.virtualElements,c=i.applyBindingsToNode,h=i.applyBindingsToDescendants,p=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.controlsDescendantBindings=!0;var r=n,i=r.events,s=r.observables,o=r.bindingContext,a=r.element,f=t.valueAccessor()||{},p=f,d=p.isEnabled,v=p.invert,m=n._beforeHook=u("begin"),g=n._afterHook=u("end");n._invert=v;if(d){c(m,{visible:d},o);c(g,{visible:d},o)}var y=l.childNodes(a);l.prepend(a,m);l.insertAfter(a,g,y[y.length-1]);h(o,a);var b=f,w=b.before,E=void 0===w?s.create(g):w,S=b.after,x=void 0===S?s.create(m):S;n._before=s.wrap(E);n._after=s.wrap(x);i.on(m,"focus",n._onFocusBeforeHook);i.on(g,"focus",n._onFocusAfterHook);!v&&f.after&&n._initializeBeforeAndAfter();return n}t.prototype._onFocusBeforeHook=function(){this._invert?a(this._afterHook):f(this._before.peek())};t.prototype._onFocusAfterHook=function(){this._invert?f(this._beforeHook):a(this._after.peek())};t.prototype._onFocusBefore=function(){a(this._beforeHook)};t.prototype._onFocusAfter=function(){f(this._afterHook)};t.prototype._initializeBeforeAndAfter=function(){var e,t,n=this,r=this.events;this.observables.backgroundCompute(function(){var i=n._before(),s=n._after();if(i!==e){e&&r.off(e);i&&r.on(i,"focus",n._onFocusBefore);e=i}if(s!==t){t&&r.off(t);s&&r.on(s,"focus",n._onFocusAfter);t=s}})};t.supportsVirtualElements=!0;return t})(o.t);t.e=p},1821:function(e,t,n){"use strict";var r=n(0),i=n("knockout-lib"),s=n(1794),o=n(1905),u=n(1935),a=n(1810),f=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===n&&(n={});var r=e.call(this,t,n)||this;r._focusTracker=r.resources.consume(u.e);r._hasFocus=r.createObservable(!1);r._hasChildFocus=r.createObservable(!1);r._isBodyActive=r.createObservable(!1);r._value=r.createPureComputed(r._computeValue);r._isEnabled=r.createPureComputed(r._computeIsEnabled);r._onlyRecoverFromBody=r.createPureComputed(r._computeOnlyRecoverFromBody);r._shouldRecoverFocus=r.createPureComputed(r._computeShouldRecoverFocus);var s=n.ChildFocusBinding,f=void 0===s?o.e:s,l=n.applyBindingsToNode,c=void 0===l?i.applyBindingsToNode:l,h=n.recoverFocusExtenders,p=void 0===h?{rateLimit:{timeout:300,method:"notifyWhenChangesStop"}}:h;new(r.managed(f))({element:r.element,bindingContext:r.bindingContext,allBindingsAccessor:r.allBindingsAccessor,valueAccessor:function(){return{isDescendantOrSelfActive:r._hasChildFocus,isBodyActive:r._isBodyActive}}});c(r.element,{hasFocus:r._hasFocus},r.bindingContext);r._scrollContainer=Object(a.t)(r.element);r.createBackgroundComputed(r._computeRecoverFocus).extend(p);return r}t.prototype._computeValue=function(){return this.valueAccessor()||{}};t.prototype._computeIsEnabled=function(){var e=this._value().isEnabled,t=void 0===e||e;return this.unwrapObservable(t)};t.prototype._computeOnlyRecoverFromBody=function(){var e=this._value().onlyRecoverFromBody,t=void 0!==e&&e;return this.unwrapObservable(t)};t.prototype._computeShouldRecoverFocus=function(){return this._isEnabled()&&!this._hasChildFocus()&&(!this._onlyRecoverFromBody()||this._isBodyActive())&&this._focusTracker.isWindowActive.peek()};t.prototype._computeRecoverFocus=function(){this._shouldRecoverFocus()&&this._recoverFocus()};t.prototype._recoverFocus=function(){var e=this._scrollContainer,t=e.scrollTop,n=e.scrollLeft;this._hasFocus(!0);e.scrollTop!==t&&(e.scrollTop=t);e.scrollLeft!==n&&(e.scrollLeft=n)};return t})(s.t);t.e=f},1829:function(e,t,n){"use strict";n.r(t);n.d(t,"focusFirstTabStop",function(){return i});n.d(t,"focusLastTabStop",function(){return s});n.d(t,"focusNextTabStop",function(){return o});n.d(t,"focusPreviousTabStop",function(){return u});n.d(t,"getFirstTabStop",function(){return a});n.d(t,"getLastTabStop",function(){return f});n.d(t,"getNextTabStop",function(){return l});n.d(t,"getPreviousTabStop",function(){return c});n.d(t,"isTabStop",function(){return h});var r=n(288);function i(e,t){p(e,a,t)}function s(e,t){p(e,f,t)}function o(e,t){p(e,l,t)}function u(e,t){p(e,c,t)}function a(e,t){return e&&g(e,t)}function f(e,t){return e&&y(e,t)}function l(e,t){return e&&(m(e.firstElementChild,d,g,t)||b(e,d,g,t))}function c(e,t){return e&&b(e,v,y,t)}function h(e,t){return!(!e||!E(e,t))}function p(e,t,n){var r=t(e,n);r&&r.focus()}function d(e){return e.nextElementSibling}function v(e){return e.previousElementSibling}function m(e,t,n,r){for(;e;e=t(e)){var i=n(e);if(i)return i}}function g(e,t){return E(e,t)||m(e.firstElementChild,d,g)}function y(e,t){return m(e.lastElementChild,v,y)||E(e,t)}function b(e,t,n,i){for(;e;e=Object(r.e)(e)){var s=m(t(e),t,n);if(s)return s}}var w={a:1,input:1,area:1,button:1,select:1,textarea:1,object:1};function E(e,t){var n=e.tagName.toLowerCase();if((n in w||void 0!==e.attributes.tabindex)&&(-1!==e.tabIndex||t)&&"true"!==e.getAttribute("aria-hidden")&&"none"!==e.style.display.toLowerCase()&&"hidden"!==e.style.visibility.toLowerCase()&&!(0===e.offsetWidth&&0===e.offsetHeight||e.disabled||"input"===n&&"hidden"===e.type.toLowerCase()))return e}},1840:function(e,t,n){"use strict";var r=n(0),i=n(1829),s=n(1794),o=n(288),u=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this,r=n.valueAccessor(),i=n.wrapObservable(void 0===r||r);n._shouldRestoreFocus=i;var s=null;try{s=document.activeElement}catch(e){}n._activeElement=s;n._preserveActiveElementAncestors=[];for(;s&&s!==document.body;){n._preserveActiveElementAncestors.push(s);s=Object(o.e)(s)}return n}t.prototype.dispose=function(){if(this._shouldRestoreFocus.peek()){var t=null;try{t=document.activeElement}catch(e){}if(!t||t===document.body||this._isAncestorOrSelf(t,this.element))for(var n=0,r=this._preserveActiveElementAncestors;n<r.length;n++){var s=r[n];if(s&&s.focus&&(Object(i.isTabStop)(s,!0)||s===this._activeElement)&&document.body.contains(s)){s.focus();break}}}this._preserveActiveElementAncestors=[];delete this._activeElement;e.prototype.dispose.call(this)};t.prototype._isAncestorOrSelf=function(e,t){for(;e;){if(e===t)return!0;e=Object(o.e)(e)}return!1};return t})(s.t);t.e=u},1845:function(e,t,n){"use strict";n.d(t,"r",function(){return u});n.d(t,"n",function(){return a});n.d(t,"e",function(){return f});n.d(t,"t",function(){return l});n.d(t,"i",function(){return c});n.d(t,"c",function(){return h});n.d(t,"h",function(){return p});n.d(t,"p",function(){return d});n.d(t,"o",function(){return v});n.d(t,"u",function(){return m});n.d(t,"s",function(){return g});n.d(t,"a",function(){return y});n.d(t,"f",function(){return b});n.d(t,"l",function(){return w});var r=n(1966),i=n(18),s=n(1967),o=n(77),u="_ComplianceTag",a="D4B6480A-4BED-4094-9A52-30181EA38F1D",f="ComplianceAssetId",l="_ComplianceFlags",c=200;function h(e){return!!(e&&e.schema&&(t=e.schema.FieldType,n=e.schema.Id,t&&"lookup"===t.toLowerCase()&&n&&n.toLowerCase()===a.toLowerCase()));var t,n}function p(e){return!!(e&&e.schema&&(t=e.schema.FieldType,n=e.schema.Id,t&&"boolean"===t.toLowerCase()&&n&&n.toLowerCase()==="96BE7325-AFA4-48CF-8503-9258F0A7817D".toLowerCase()));var t,n}function d(e){return!!(256&e)}function v(e){return g(e)?r.t:r.e}function m(e){if(e.properties.hasOwnProperty("_ComplianceFlags")){if(4&+e.properties._ComplianceFlags)return!0}return!1}function g(e){if(e.properties.hasOwnProperty("_ComplianceFlags")){var t=+e.properties._ComplianceFlags;if(Object(o.isFeatureEnabled)(o.IPRecordVersioningClient)){if(4&t||256&t)return!0}else if(4&t&&1&t)return!0}return!1}function y(){return s.RecordLabelHoverText}function b(e){if(!e.HasRetentionAction)return" ";if(0===e.TagDuration)return e.BlockDelete?s.RetainForeverText:" ";var t=E(e.TagDuration);return e.BlockDelete?i.format(s.PreserveTagText,t):e.AutoDelete?i.format(s.DeleteTagText,t):" "}function w(e){if(e.Notes)return e.Notes;if(!e.HasRetentionAction)return s.NoRetentionTooltip;if(0===e.TagDuration)return e.BlockDelete?s.PreserveForeverTooltip:s.NoRetentionTooltip;var t=E(e.TagDuration),n="",r="";if(e.BlockDelete){n="PreserveTag"+e.TagRetentionBasedOn+"Tooltip";e.BlockEdit&&(r=s.PreserveIsRecordTooltipModifier);e.ReviewerEmail?r+=s.ReviewTooltip:r+=e.AutoDelete?s.PreserveAutoDeleteTooltipModifier:s.PreserveNoDeleteTooltipModifier}else e.AutoDelete&&(n="DeleteTag"+e.TagRetentionBasedOn+"Tooltip");var o=s[n];return o?i.format(o,t)+r:null}function E(e){var t="";if(e>0){var n=Math.floor(e/365);if(n>0){var r=n>1?s.RetentionPeriodYears:s.RetentionPeriodYear;t=i.format(r,n)}else{var o=Math.floor(e/30);if(o>0){var u=o>1?s.RetentionPeriodMonths:s.RetentionPeriodMonth;t=i.format(u,o)}else{var a=e>1?s.RetentionPeriodDays:s.RetentionPeriodDay;t=i.format(a,e)}}}return t}},1864:function(e,t,n){"use strict";n(1870);var r=n(1886),i=n(1790),s={tagName:"ms-file-type-icon",template:'<span class="FileTypeIcon" data-bind="attr:{title:hoverText},click:onClick,css:{\'FileTypeIcon--clickable\':!!onClick}" tabindex="-1"><img class="FileTypeIcon-icon" data-bind="attr:{src:iconUrl,alt:iconFieldAriaLabel},style:{width:size,height:size,\'font-size\':size}">\x3c!--ko if:overlayUrl--\x3e<img class="FileTypeIcon-overlay" data-bind="attr:{src:overlayUrl}">\x3c!--/ko--\x3e</span>',viewModel:r.e,synchronous:!0};i.e(s);t.e=s},1866:function(e,t,n){"use strict";n.r(t);n.d(t,"resourceKey",function(){return v});var r=n(0),i=n(474),s=n(8),o=n(93),u=n(229),a=n(1805),f=n(113),l=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this;r._dataSource=n.sharingDataSource;return r}t.prototype.share=function(e,t,n){return this._dataSource.share(e,t)};t.dependencies={sharingDataSource:o.re};return t})(i.e),c=Object(s.s)("ShareItemHelper",l),h=n(69),p=(function(){function e(e,t){this.item=e.item;this._dataSource=t.dataSource}e.prototype.getSettings=function(){var e=this;if(!this._settingsPromise){this._settingsPromise=this._dataSource.getSettings(this);this._settingsPromise.done(null,function(t){if(h.n.isCanceled(t)){e._settingsPromise=null;e._rawResponse=null}})}return this._settingsPromise};e.prototype.getPermissions=function(e){this._permissionsPromise&&!e||(this._permissionsPromise=this._dataSource.getPermissions(this));return this._permissionsPromise};e.prototype.cancelGetPermissionsPromise=function(){if(this._permissionsPromise){this._permissionsPromise.cancel();this._cleanCacheIfCancel()}};e.prototype.getLinks=function(){var e=this;this._linksPromise||(this._linksPromise=this._dataSource.getLinks(this).then(function(t){e._linksData=t;return t}));return this._linksPromise};e.prototype.cancelGetLinksPromise=function(){if(this._linksPromise){this._linksPromise.cancel();this._cleanCacheIfCancel()}};e.prototype.getBestSharingLink=function(e){return this._dataSource.getBestSharingLink(this,e)};e.prototype.setLink=function(e){var t=this._linksData;if(e&&t){var n=t.filter(function(t){return t&&t.role===e.role&&t.type===e.type});if(0===n.length)t.push(e);else{var r=n[0];r.url=e.url;r.expiration=e.expiration;r.isActive=e.isActive}}};e.prototype.doSharingScopesContainLinks=function(){return this._dataSource.doSharingScopesContainLinks()};e.prototype.getRawResponse=function(){var e=this;if(!this._rawResponse){this._rawResponse=this._dataSource.getRawResponse(this);this._rawResponse.done(null,function(t){h.n.isCanceled(t)&&(e._rawResponse=null)})}return this._rawResponse};e.prototype._cleanCacheIfCancel=function(){this._linksPromise=null;this._settingsPromise=null;this._permissionsPromise=null;this._rawResponse=null};return e})(),d=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this;r._dataSource=n.sharingDataSource;r._sharingDataDataSource=n.sharingDataDataSource;r._itemProvider=n.externallySharedItemProvider||n.itemProvider;r._shareDataCache={};r._shareItemHelper=n.shareItemHelper;return r}t.prototype.getSharingInformation=function(e,t,n,r,i){return this._dataSource.getSharingInformation(e,t,n,r,"",i)};t.prototype.shareLink=function(e){var t=this;return this._dataSource.shareLink(e).then(function(n){if(n.link){t._invalidateCachedItem(e.items[0]);t._invalidateItem(e.items[0])}return n})};t.prototype.unshareLink=function(e){var t=this;return this._dataSource.unshareLink(e).then(function(n){t._invalidateCachedItem(e.item);t._invalidateItem(e.item);return n})};t.prototype.updatePermissions2=function(e,t,n){var r=this;return this._dataSource.updatePermissions2(e,t,n).then(function(e){r._invalidateCachedItem(t);r._invalidateItem(t);return e})};t.prototype.updatePermissionsMultiple=function(e,t,n,r,i){var s=this;return this._dataSource.updatePermissionsMultiple(e,t,n,r,i).then(function(e){s._invalidateCachedItem(t);s._invalidateItem(t);return e})};t.prototype.supportsExistingAccessOption=function(e){return this._dataSource.supportsExistingAccessOption(e)};t.prototype.getClientId=function(){return this._dataSource.getClientId()};t.prototype.parseRawSharingInformation=function(e){return this._dataSource.parseRawSharingInformation(e)};t.prototype.emailWithoutPermissioning=function(e,t,n){return this._dataSource.emailWithoutPermissioning(e,t,n)};t.prototype.checkPermissions=function(e,t){return this._dataSource.checkPermissions(e,t)};t.prototype.setAddressBarLinkCapability=function(e,t){return this._dataSource.setAddressBarLinkCapability(e,t)};t.prototype.getSharingData=function(e,t){var n=this._shareDataCache[e.id],r=n&&n.data;if(!r||e.eTag!==n.eTag||t){r=this.scope.attach(new p({item:e},{dataSource:this._sharingDataDataSource}));this._shareDataCache[e.id]={eTag:e.eTag,data:r}}return r};t.prototype.share=function(e,t){var n=this;return this._shareItemHelper.share(e,t).then(function(e){n._invalidateCache();return e})};t.prototype.unshare=function(e){var t=this;return this._dataSource.unshare(e).then(function(n){t._invalidateCache();var r=t._itemProvider;if(r){r.invalidateItem(e.parent.key);r.invalidateItem(e.key)}return n})};t.prototype.updatePermissions=function(e,t,n,r){var i=this;return this._dataSource.updatePermissions(e,t,n,r).then(function(e){i._invalidateCache();i._itemProvider&&i._itemProvider.invalidateItem(t.parent.key);return e})};t.prototype.manageSharingLinks=function(e,t){var n=this;if(t&&t.link&&t.link.shareId&&!t.create){var r={item:e[0],kind:t.link.kind,shareId:t.link.shareId};return this._dataSource.unshareLink(r).then(function(e){n._invalidateCachedItem(r.item);n._invalidateItem(r.item);return[]})}var i=(e=e&&e.length?e:[]).map(function(e){return n.getSharingData(e)});return this._dataSource.manageSharingLinks(i,t).then(function(t){n._invalidateCache();var r=e[0]&&e[0].parent&&e[0].parent.key;r&&n._itemProvider.invalidateItem(r);return t})};t.prototype._invalidateCache=function(){this._shareDataCache={}};t.prototype._invalidateCachedItem=function(e){e&&e.id&&this._shareDataCache[e.id]&&(this._shareDataCache[e.id]=null)};t.prototype._invalidateItem=function(e){this._itemProvider&&e&&e.parent&&e.parent.key&&this._itemProvider.invalidateItem(e.parent.key)};t.dependencies=Object(r.__assign)(Object(r.__assign)({},i.e.dependencies),{sharingDataSource:o.re,sharingDataDataSource:o.ie.optional,navigation:f.e,externallySharedItemProvider:u.r.optional,itemProvider:a.resourceKey.optional,shareItemHelper:c});return t})(i.e),v=(t.default=d,Object(s.s)("SharingProvider",d))},1870:function(e,t,n){"use strict";var r=n(185);Object(r.n)([{rawString:".FileTypeIcon{position:relative;display:inline-block}.FileTypeIcon--clickable{cursor:pointer}.FileTypeIcon-icon{display:inline-block;vertical-align:middle;position:relative;overflow:hidden}.FileTypeIcon-icon::before{display:block}.FileTypeIcon-overlay{display:block;border:0;position:relative;left:9px;bottom:9px;height:9px;width:9px}"}])},1875:function(e,t,n){"use strict";n.d(t,"n",function(){return d});n.d(t,"e",function(){return v});n.d(t,"t",function(){return m});n.d(t,"i",function(){return g});n.d(t,"r",function(){return y});var r=n(1100),i=n(1098),s=n(18),o=n(1845),u=n(1983),a=n(1908),f=n(34),l=n(230),c=n(1964),h=n(1892),p=n(1921);function d(e,t){switch(e.queryType){case f.e.Recent:return(function(e){var t=[],n=m(e)||e.name;n&&t.push(n);var r=e.displayPath;if(r){var i=r.segments.join(" "+u.c+" ");t.push(u.l+": "+i)}var s=e.dateAccessed;s&&t.push(a.d+" "+s);return t.join(", ")||void 0})(e);case f.e.Files:default:return(function(e,t){var n=[],r=m(e)||e.name,a=(function(e){if(e.dateDeleted&&(e.queryType===f.e.RecycleBin||e.queryType===f.e.SecondStageRecycleBin))return s.format(c.dateDeletedLabelFormat,e.dateDeleted);if(e.dateModified)return s.format(c.dateModifiedLabelFormat,e.dateModified);return})(e)||e.dateModified,l=e.defaultSubText,d=e.size,v=Object(h.e)(e.lifeCycleStatus);r&&n.push(r);v>0&&n.push((function(e){var t;return((t={})[3]=u.p,t[2]=u.a,t[4]=u.o,t[1]=u.n,t)[e]||""})(v));a&&n.push(a);l&&n.push(l);d&&n.push(i.e.getDisplayString(d,{ignoreZero:!0}));if(e.folder){var g=e.folder.totalCount,y=void 0===g?e.childCount:g;n.push(s.format(s.getLocalizedCountValue(c.itemCountFormat,c.itemCountIntervals,y),y))}e.sharingType===p.e.Shared?n.push(u.h):e.sharingType!==p.e.Unknown&&n.push(u.f);if(o.s(e)){var b=o.a();n.push(b)}t&&n.push(c.selected);return n.join(", ")||void 0})(e)}}function v(e){var t=e.extension,n=[];if(e.type===l.e.Folder)n.push(r.n(e.sharingType)?c.fileTypeSharedFolder:c.fileTypeFolder);else{var i=e.appMap;if(i){var o=i.toLowerCase();-1!==o.indexOf("ms-word")?n.push(c.fileTypeDoc):-1!==o.indexOf("ms-excel")?n.push(c.fileTypeXls):-1!==o.indexOf("ms-powerpoint")?n.push(c.fileTypePpt):-1!==o.indexOf("onenote")&&n.push(c.fileTypeOneNotebook)}else if(e.type===l.e.Media&&e.photo)n.push(s.format(c.fileTypeImage,t||"").trim());else if(t){var u="."===t[0]?t.substring(1):t;n.push(s.format(c.fileTypeUnknown,u))}else e.type===l.e.App&&e.properties&&e.properties.appTypeString?n.push(s.format(a.c,e.properties.appTypeString)):e.type===l.e.Subsite&&e.name&&n.push(s.format(a.c,e.name));var f=g(e);f&&n.push(f)}return n.join(", ")}function m(e){var t=[],n=v(e);t.push(e.name);n&&t.push(n);return t.join(", ")}function g(e){var t=[];e.itemStatus?t.push(c.sharedViolationWarningViewer):e.isViolation&&t.push(c.sharedViolationWarning);e.policyTip&&(2&e.policyTip?t.push(c.policyTipBlockText):1===e.policyTip&&t.push(c.policyTipNotifyText));e.hasMissingMetadata&&t.push(c.missingMetadataText);if(o.s(e)){var n=o.a();t.push(n)}var r=e.properties.CheckoutUser,i=(void 0===r?[]:r)[0],u=(void 0===i?{}:i).title,a=void 0===u?void 0:u;a&&t.push(s.format(c.checkedOutTo,a));return t.join(" ")}function y(){return c.toggleSelection}},1886:function(e,t,n){"use strict";var r=n(0),i=n(1789),s=n(1851),o=n(1890),u=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this,r=t.iconFieldAriaLabel,i=void 0===r?"":r,u=t.iconName,a=t.extension,f=t.item,l=t.desiredSize||16;n.hoverText=t.hoverText;n.onClick=t.onClick;var c=n,h=c.observables,p=c.resources,d=h.create(""),v=h.create(i);if(t.iconUrl)d(t.iconUrl);else if(u){var m=t.iconSize||l,g=s.e(p,u,m);d(g);if(a){var y=p.consume(o.e.optional);y&&h.backgroundCompute(function(){d(y.getFileTypeIconUrl(a)||g);v(y.getFileTypeName(a)||i)})}var b=s.r(p,m,f);b&&d(b)}var w=t.desiredSizeRem?"rem":"px",E=t.desiredSizeRem?t.desiredSizeRem:l;n.size=""+(d.peek()?E:0)+w;n.iconUrl=d;n.iconFieldAriaLabel=v;t.overlayType?n.overlayUrl=window.require.toUrl("odsp-media/images/overlays/"+t.overlayType.toLowerCase()):n.overlayUrl="";return n}return t})(i.t);t.e=u},1892:function(e,t,n){"use strict";n.d(t,"e",function(){return r});function r(e){if(e&&Object.keys(e).length>0){if(e.isMalwareDetected)return 4;if(e.isExternal)return 1;if(e.isTrending)return 3;if(e.isNew)return 2}return 0}},2062:function(e,t,n){"use strict";n.d(t,"e",function(){return s});n.d(t,"n",function(){return o});n.d(t,"t",function(){return u});n.d(t,"r",function(){return a});n.d(t,"i",function(){return f});var r,i,s;(function(e){e[e.NONE=0]="NONE";e[e.ASC=1]="ASC";e[e.DESC=2]="DESC"})(r||(r={}));(function(e){e.id="id";e.reorderable="reorderable"})(i||(i={}));(function(e){e.notStarted="notStarted";e.inProgress="inProgress";e.failed="failed";e.succeeded="succeeded"})(s||(s={}));var o={name:{fieldRefName:"Name",valueType:"TEXT"},parent:{fieldRefName:"Parent",valueType:"TEXT"},group:{fieldRefName:"Group",valueType:"TEXT"},lastPublished:{fieldRefName:"LastPublished",valueType:"TEXT"},source:{fieldRefName:"Source",valueType:"TEXT"}},u="DO_NOT_DELETE_SPLIST_TENANTADMIN_AGGREGATED_CONTENTTYPES",a="DO_NOT_DELETE_SPLIST_SITECOLLECTION_AGGREGATED_CONTENTTYPES",f=[{id:"0x010400691950A997E07447B9CB06D610150755",description:"",eTag:'"0"',group:"Custom Content Types",hidden:!1,name:"TestCt1",parentId:"0x0104",readOnly:!1,sealed:!1,parentReference:{id:"0x0104",name:"Announcement"}},{id:"0x010400691950A997E07447B9CB06D610150866",description:"",eTag:'"0"',group:"Custom Content Types",hidden:!1,name:"TestCt2",parentId:"0x0104",readOnly:!1,sealed:!1,parentReference:{id:"0x0104",name:"Announcement"}},{id:"0x010400691950A997E07447B9CB06D610150977",description:"",eTag:'"0"',group:"Custom Content Types",hidden:!1,name:"TestCt3",parentId:"0x0104",readOnly:!1,sealed:!1,parentReference:{id:"0x0104",name:"Announcement"}}]},2101:function(e,t,n){"use strict";var r=n(185);Object(r.n)([{rawString:".od-Confirmation-message{padding:0;box-sizing:border-box;box-shadow:none;margin:0;padding:0;font-size:.875rem}.od-Dialog.od-Dialog--close .od-ConfirmationDialog.od-Dialog-main .od-Dialog-content{line-height:1.25rem}.od-Dialog.od-Dialog--close .od-ConfirmationDialog.od-Dialog-main .od-Dialog-content .od-Dialog-button.od-Dialog-button--close{width:2rem;height:2rem;line-height:2rem}.od-Dialog.od-Dialog--close .od-ConfirmationDialog.od-Dialog-main .od-Dialog-content .od-Dialog-button.od-Dialog-button--close i.ms-Icon.ms-Icon--Cancel{font-size:1rem}.od-Dialog.od-Dialog--close .od-ConfirmationDialog.od-Dialog-main .od-Dialog-actions{height:2rem}.od-Dialog.od-Dialog--close .od-ConfirmationDialog.od-Dialog-main .od-Dialog-actions button.od-Dialog-action{height:2rem;font-size:.875rem}.od-Dialog.od-Dialog--close .od-ConfirmationDialog.od-Dialog-main .od-Dialog-actions button.od-Dialog-action .od-Button-label{font-size:.875rem}.od-Dialog.od-Dialog--close .od-ConfirmationDialog.od-Dialog-main #od-Dialog-title{font-size:1.25rem}"}]);var i=n(0),s=(function(e){Object(i.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.message=t.message;return n}return t})(n(1789).t),o=n(1790).e({tagName:"ms-confirmation",template:'<div class="od-Confirmation"><p class="od-Confirmation-message" data-bind="text:message"></p></div>',viewModel:s});t.e=o},2242:function(e,t,n){"use strict";var r,i,s,o,u,a=n(0),f=n(83),l=n(2987),c=n(592),h=n(1863),p=n(2062),d=n(84),v=n(44),m=n(673),g=n(2092),y=(function(){function e(e){this._children=e}e.prototype.generateCamlQueryString=function(){var e=this._children.map(function(e){return e.generateCamlQueryString()}).join("");return e?"<Where>"+e+"</Where>":""};return e})(),b=(function(){function e(e,t){this._fieldName=e;this._fieldValue=t}e.prototype.generateCamlQueryString=function(){var e=m.e.encodeText(p.n[this._fieldName].fieldRefName),t=m.e.encodeText(this._fieldValue),n=m.e.encodeText(p.n[this._fieldName].valueType);return t?"<Eq><FieldRef Name='"+e+"'/><Value Type='"+n+"'>"+t+"</Value></Eq>":"<IsNull><FieldRef Name='"+e+"'/></IsNull>"};return e})(),w=(function(){function e(e,t){this._filterFieldValueCamlQueries=[];for(var n=0,r=t;n<r.length;n++){var i=r[n];this._filterFieldValueCamlQueries.push(new b(e,i))}}e.prototype.generateCamlQueryString=function(){for(var e="",t=0,n=this._filterFieldValueCamlQueries;t<n.length;t++){var r=n[t].generateCamlQueryString();e=e?"<Or>"+e+r+"</Or>":r}return e};return e})(),E=(function(){function e(e){var t=this,n=e||new Map;this._filterByFieldCamlQueries=[];n.forEach(function(e,n){0!==e.length&&t._filterByFieldCamlQueries.push(new w(n,e))})}e.prototype.generateCamlQueryString=function(){for(var e="",t=0,n=this._filterByFieldCamlQueries;t<n.length;t++){var r=n[t].generateCamlQueryString();e=e?"<And>"+e+r+"</And>":r}return e};return e})(),S=(function(){function e(e){this._condition=e}e.prototype.generateCamlQueryString=function(){if(0===this._condition.direction)throw new Error("OrderBy query direction is set to NONE which is unexpected!");var e=2===this._condition.direction;return"<OrderBy><FieldRef Name='"+m.e.encodeText(p.n[this._condition.field].fieldRefName)+"' Ascending='"+!e+"' /></OrderBy>"};return e})(),x=(function(){function e(e){this._condition=e}e.prototype.generateCamlQueryString=function(){return"<GroupBy><FieldRef Name='"+m.e.encodeText(p.n[this._condition.field].fieldRefName)+"' /></GroupBy>"};return e})(),T=(function(){function e(e){e=e||{};this._queryCamlQueryElements=[];var t=[];t.push(new E(e.filterBys));this._queryCamlQueryElements.push(new y(t));e.orderBy&&this._queryCamlQueryElements.push(new S(e.orderBy));e.groupBy&&this._queryCamlQueryElements.push(new x(e.groupBy))}e.prototype.generateCamlQueryString=function(){var e=this._queryCamlQueryElements.map(function(e){return e.generateCamlQueryString()}).join("");return e?"<Query>"+e+"</Query>":""};return e})(),N=(function(){function e(e){this._fieldRefName=e}e.prototype.generateCamlQueryString=function(){return'<FieldRef Name="'+this._fieldRefName+'"/>'};return e})(),C=(function(){function e(e){this._contentTypeCamlQueryElements=[];for(var t=0,n=e;t<n.length;t++){var r=n[t];this._contentTypeCamlQueryElements.push(new N(r))}}e.prototype.generateCamlQueryString=function(){var e=this._contentTypeCamlQueryElements.map(function(e){return e.generateCamlQueryString()}).join("");return e?"<ViewFields>"+e+"</ViewFields>":""};return e})(),k=(function(){function e(e,t){this._contentTypeCamlQueryElements=[];e&&this._contentTypeCamlQueryElements.push(new T(e));t&&this._contentTypeCamlQueryElements.push(new C(t))}e.parseCamlQueryString=function(e){var t=g.r(e),n={};if(t.filters){n.filterBys=new Map;for(var r=0,i=t.filters;r<i.length;r++){var s=i[r];if(this._instanceOfIFilter(s)){var o=this._getColumnKeyFromFieldRefName(s.fieldName);o&&(n.filterBys[o]=s.values)}}}if(t.sorts){var u=this._getColumnKeyFromFieldRefName(t.sorts[0].fieldName);u&&(n.orderBy={field:u,direction:t.sorts[0].isAscending?1:2})}if(t.groupBy){var a=this._getColumnKeyFromFieldRefName(t.groupBy.group1.fieldName);a&&(n.groupBy={field:a})}return n};e._instanceOfIFilter=function(e){return"fieldName"in e};e._getColumnKeyFromFieldRefName=function(e){for(var t in p.n)if(p.n[t].fieldRefName===e)return t};e.prototype.generateCamlQueryString=function(){var e=this._contentTypeCamlQueryElements.map(function(e){return e.generateCamlQueryString()}).join("");return e?"<View>"+e+"</View>":""};return e})(),L=n(18),A=n(69),O=function(e,t,n){var r="--"+e+"\r\n";r+="Content-ID: "+t+"\r\n";return r+="Content-Type: "+n+"\r\n\r\n"},M=function(e,t,n){var r="--"+e+"\r\n";r+="Content-Type: "+t+"\r\n";return r+="Content-Transfer-Encoding: "+n+"\r\n\r\n"},_=function(e,t,n,r,i){var s=n+" "+r+" HTTP/1.1\r\n";s+="Content-Type: "+e+"\r\n";s+="Accept: "+t+"\r\n";i&&(s+="Content-Length: "+i+"\r\n\r\n");return s},D=n(67);(function(e){e.JSON="application/json";e.octetStream="application/octet-stream";e.multipartBoundary="multipart/related; boundary=";e.HTTP="application/http";e.multipartMixedBoundary="multipart/mixed; boundary="})(r||(r={}));(function(e){e.metadata="metadata";e.content="content"})(i||(i={}));(function(e){e.binary="binary"})(s||(s={}));(function(e){e.GET="GET";e.POST="POST";e.DELETE="DELETE"})(o||(o={}));(function(e){e.JSON="application/json"})(u||(u={}));var P=(function(e){Object(a.__extends)(t,e);function t(t,n,r,i){var s=e.call(this,{dataSourceName:"ContentTypeDataSource"},{pageContext:t})||this;s.siteInfoByUrlTemplate="{0}/_api/site";s.siteUrlTemplate="{0}/_api/v2.1/sites/{1},{2}";s.listUrlTemplate="{0}/_api/v2.1/sites/{1},{2}/lists/{3}";s.updateListUrlTemplate="{0}/_api/web/lists(guid'{1}')";s.contentTypeUrlTemplate="{0}/_api/v2.1/sites/{1},{2}/contentTypes";s.urlTemplateForSharedPackages="{0}/_api/v2.1/sites/{1},{2}/lists/{3}/items?$expand=fields&$top=500";s.listContentTypeDetailedUrlTemplate="{0}/_api/v2.1/sites/{1},{2}/lists/{3}/contentTypes";s.contentTypeColumnsUrlTemplate="{0}/_api/v2.1/sites/{1},{2}/contentTypes/{3}/columns";s.contentTypeColumnsAddUrlTemplate="{0}/_api/v2.1/sites/{1},{2}/contentTypes/{3}/columns/add";s.sharedPackageListTemplate="{0}/_api/web/GetList(@listUrl)?@listUrl='/sites/contenttypehub/lists/PackageList'";s.sharedPackageUrlTemplate="{0}/_api/web/GetList(@listUrl)/items?@listUrl='/sites/contenttypehub/lists/PackageList'";s.sharedPackageByTitleUrlTemplate="{0}/_api/v2.1/sites/{1}/lists/Shared Packages/items?expand=fields";s.availableContentTypesForListUrlTemplate="{0}/_api/v2.1/sites/{1},{2}/oneDrive.getApplicableContentTypesForList(listId='{3}')";s.siteColumnsUrlTemplate="{0}/_api/v2.1/sites/{1},{2}/columns";s.listColumnsUrlTemplate="{0}/_api/v2.1/sites/{1}/lists/{2}?expand=columns";s.ancestorSiteColumnsUrlTemplate="{0}/_api/v2.1/sites/{1},{2}?expand=externalColumns";s.currencyListUrlTemplate="{0}/_api/SP.CurrencyList.GetList";s.regionalDateTimeUrlTemplate="{0}/_api/web/GetRegionalDateTimeSchema";s.permissionUrlTemplate="{0}/_api/web/DoesUserHavePermissions(@v)";s.siteListsUrlTemplate="{0}/_api/v2.1/sites/{1},{2}/lists?$select=system,id,name,displayName,list";s.listFieldsUrlTemplate="{0}/_api/v2.1/sites/{1},{2}/lists/{3}/columns";s.createContentTypeViewUrl="{0}/_api/v2.1/sites/{1},{2}/lists/{3}/views";s.listContentTypeColumnsUrlTemplate="{0}/_api/v2.1/sites/{1},{2}/lists/{3}/contentTypes/{4}/columns";s.publishContentTypeUrlTemplate="{0}/_api/v2.1//sites/{1}/contentTypes/{2}/oneDrive.publish";s.unpublishContentTypeUrlTemplate="{0}/_api/v2.1/sites/{1}/contentTypes/{2}/oneDrive.unpublish";s.updateContentTypeColumnUrlTemplate="{0}/_api/v2.1/sites/{1},{2}/contentTypes/{3}/columns/{4}";s.contentTypesPublishedFromHubUrlTemplate="{0}/_api/v2.1/sites/{1},{2}/lists/{3}/contentTypes/getCompatibleHubContentTypes";s.siteContentTypesPublishedFromHubUrlTemplate="{0}/_api/v2.1/sites/{1},{2}/contentTypes/getCompatibleHubContentTypes";s.updateContentTypeUrlTemplate="{0}/_api/v2.1/sites/{1},{2}/contentTypes/{3}";s.updateListContentTypeUrlTemplate="{0}/_api/v2.1/sites/{1},{2}/lists/{3}/contentTypes/{4}";s.contentTypeListViewUrl="/_api/web/lists/GetByTitle('{0}')";s.createListUrlTemplate="{0}/_api/v2.1/sites/{1},{2}/lists";s.batchUrlTemplate="{0}/_api/v2.1/$batch";s.addContentTypeToListBatchUrlTemplate="sites/{0},{1}/lists/{2}/contentTypes/addCopyFromContentTypeHub";s.addContentTypeToSiteFromHubUrlTemplate="{0}/_api/v2.1/sites/{1},{2}/contentTypes/addCopyFromContentTypeHub";s.contentTypeOperationsUrlTemplate="{0}/_api/v2.1/sites/{1},{2}/lists/{3}/operations";s.contentTypeOperationUrlTemplate="sites/{0},{1}/lists/{2}/operations/{3}";s.fetchCustomCTProperty="$filter=custom ne null";s.filterByReorderable="$filter=reorderable eq true";s.selectDocTemplateProperty="$select=documentTemplate";s.reorderColumns="$select=columnOrder";s.selectIsUpdateAvailable="$select=isUpdateAvailable";s.getContentTypeColumnsHiddenParam="$select=*,hidden";s.getContentTypeAncestorsParam="$expand=ancestors";s.getContentTypeEnforcemenetParam="$select=*,enforcement";s.contentTypeExpandColumnsParam="$expand=columns";s.docSetSharedandWelcomePageColumnsParam="$expand=documentSet/sharedColumns,documentSet/welcomePageColumns";s.contentTypeOperationsFilterParam="$filter=type eq 'contentTypeCopy'";s.contentTypeAccessPermissionParam="@v={'High':'0', 'Low':'256'}";s.adminCenterAcesssPermissionParam="@v={'High':'0', 'Low':'0'}";s.getToken=function(e){var t=Object(f.r)(s._pageContext);return s._getOAuthToken?s._getOAuthToken(e):s._tokenProvider.getToken(t)};s._tokenProvider=new l.e(null,{oAuthTokenDataSource:new h.e(t)});s._getOAuthToken=n;s._isAdmin=void 0!==r&&r;s._isFilterByReorderableEnabled=void 0!==i&&i;return s}t.prototype.getSiteInfo=function(e,t){return this.dataRequestor.getData({url:encodeURI(L.format(this.siteUrlTemplate,Object(f.r)(this._pageContext),e,t)),qosName:this._isAdmin?"GetSiteInfo":"SiteLevelGetSiteInfo",method:"GET",contentType:"application/json",parseResponse:function(e){return JSON.parse(e)},noRedirect:!0})};t.prototype.getSiteInfoByUrl=function(e){return this.dataRequestor.getData({url:encodeURI(L.format(this.siteInfoByUrlTemplate,e)),qosName:this._isAdmin?"GetSiteInfoByUrl":"SiteLevelGetSiteInfoByUrl",method:"GET",contentType:"application/json",parseResponse:function(e){return JSON.parse(e).d},noRedirect:!0})};t.prototype.pullContentTypeFromHub=function(e,t,n){var r=this;return this.getToken().then(function(i){return r.dataRequestor.getData({url:encodeURI(L.format(r.addContentTypeToSiteFromHubUrlTemplate,Object(f.r)(r._pageContext),e,t)),qosName:r._isAdmin?"PullContentTypeFromHub":"SiteLevelPullContentTypeFromHub",method:"POST",authToken:i,contentType:"application/json",additionalHeaders:{accept:"application/json"},additionalPostData:JSON.stringify({contentTypeId:n}),parseResponse:function(e){},noRedirect:!0})})};t.prototype.getContentTypesPublishedFromHub=function(e,t,n){return this.dataRequestor.getData({url:encodeURI(D.t.isActivated("46c96b7d-5fa7-4c49-a351-60bdbda651f0","07/02/2021","Filter by Reorderable Property")?L.format(this.contentTypesPublishedFromHubUrlTemplate+"?"+this.contentTypeExpandColumnsParam,Object(f.r)(this._pageContext),e,t,n):L.format(this.contentTypesPublishedFromHubUrlTemplate+"?"+this.contentTypeExpandColumnsParam+"("+this.getContentTypeColumnsHiddenParam+";"+this.filterByReorderable+")",Object(f.r)(this._pageContext),e,t,n)),qosName:this._isAdmin?"GetPublishedContentTypeFromHub":"SiteLevelGetPublishedContentTypeFromHub",method:"GET",contentType:"application/json",parseResponse:function(e){return JSON.parse(e).value},noRedirect:!0})};t.prototype.getSiteContentTypesPublishedFromHub=function(e,t){var n=this;return this.dataRequestor.getData({url:encodeURI(this._isFilterByReorderableEnabled?L.format(this.siteContentTypesPublishedFromHubUrlTemplate+"?"+this.contentTypeExpandColumnsParam+"("+this.getContentTypeColumnsHiddenParam+";"+this.filterByReorderable+")",Object(f.r)(this._pageContext),e,t):L.format(this.siteContentTypesPublishedFromHubUrlTemplate+"?"+this.contentTypeExpandColumnsParam,Object(f.r)(this._pageContext),e,t)),qosName:this._isAdmin?"GetSitePublishedContentTypeFromHub":"SiteLevelGetSitePublishedContentTypeFromHub",method:"GET",contentType:"application/json",parseResponse:function(r){try{if(r){var i=JSON.parse(r);return i.value?i.value:[]}return[]}catch(i){if(!D.t.isActivated("2b1b4b18-f501-4760-a161-e3332c85d70a","09/02/2021","Send telemetry for invalid json error")){new d.e({name:"ContentTypeDataSource.SiteLevelGetCompatibleContentTypeFromHub"}).end({resultType:v.e.Failure,resultCode:"InvalidJSON",error:i?JSON.stringify(i):"",extraData:{responseText:r,failureMsg:"Compatible hub api invalid json error failed",siteId:e,webId:t,tenantId:n._pageContext.siteSubscriptionId}})}throw i}},noRedirect:!0})};t.prototype.getMockContentTypesPublishedFromHub=function(){return Promise.resolve(p.i)};t.prototype.getContentTypeOperationsForIds=function(e){for(var t=[],n=0,r=e;n<r.length;n++){var i=r[n];t.push({resourceId:i,status:p.e.succeeded})}return new Promise(function(e){setTimeout(function(){e(t)},5e3)})};t.prototype.getContentTypes=function(e,t){return this.dataRequestor.getData({url:encodeURI(L.format(this.contentTypeUrlTemplate,Object(f.r)(this._pageContext),e,t)),qosName:this._isAdmin?"GetSiteContentType":"SiteLevelGetSiteContentType",method:"GET",contentType:"application/json",parseResponse:function(e){return JSON.parse(e).value},noRedirect:!0})};t.prototype.getContentTypeOperations=function(e,t,n){return this.dataRequestor.getData({url:encodeURI(L.format(this.contentTypeOperationsUrlTemplate+"?"+this.contentTypeOperationsFilterParam,Object(f.r)(this._pageContext),e,t,n)),qosName:this._isAdmin?"GetContentTypeOperations":"SiteLevelGetContentTypeOperations",method:"GET",contentType:"application/json",parseResponse:function(e){return JSON.parse(e).value},noRedirect:!0})};t.prototype.deleteContentTypeOperations=function(e,t,n,r){for(var i=this,s="batch_36522ad7-fc75-4b56-8c71-56071383e77b",o="",u=0,a=r;u<a.length;u++){var f=a[u],l=L.format(this.contentTypeOperationUrlTemplate,e,t,n,f);o+=M(s,"application/http","binary");o+=_("application/json","application/json","DELETE",l)+"\r\n"}var c=new Blob([o,"--batch_36522ad7-fc75-4b56-8c71-56071383e77b--"]);return this.getToken().then(function(e){return i.dataRequestor.getData({url:L.format(i.batchUrlTemplate,i._pageContext.webAbsoluteUrl.replace(/\/$/,"")),authToken:e,qosName:i._isAdmin?"DeleteListContentTypeOperations":"SiteLevelDeleteListContentTypeOperations",method:"POST",contentType:"multipart/mixed; boundary="+s,additionalHeaders:void 0,additionalPostData:c,parseResponse:function(e){},noRedirect:!0})})};t.prototype.getContentTypeAncestors=function(e,t,n){return this.dataRequestor.getData({url:encodeURI(L.format(this.updateContentTypeUrlTemplate+"?"+this.getContentTypeAncestorsParam,Object(f.r)(this._pageContext),e,t,n)),qosName:this._isAdmin?"GetSiteContentTypeAncestors":"SiteLevelGetSiteContentTypeAncestors",method:"GET",contentType:"application/json",parseResponse:function(e){return JSON.parse(e).ancestors},noRedirect:!0})};t.prototype.getContentType=function(e,t,n,r,i){return this.dataRequestor.getData({url:encodeURI(L.format(this.contentTypeUrlTemplate+"/"+n+(r?"?"+this.contentTypeExpandColumnsParam:i?"?"+this.docSetSharedandWelcomePageColumnsParam:""),Object(f.r)(this._pageContext),e,t)),qosName:this._isAdmin?"GetSiteContentType":"SiteLevelGetSiteContentType",method:"GET",contentType:"application/json",parseResponse:function(e){try{return JSON.parse(e)}catch(e){return}},noRedirect:!0})};t.prototype.getContentTypesDetailedAvailableForList=function(e,t,n){return this.dataRequestor.getData({url:encodeURI(L.format(this.availableContentTypesForListUrlTemplate+"?"+this.fetchCustomCTProperty,Object(f.r)(this._pageContext),e,t,n)),qosName:this._isAdmin?"GetSiteContentTypeForList":"SiteLevelGetSiteContentTypeForList",method:"GET",contentType:"application/json",parseResponse:function(e){return JSON.parse(e).value},noRedirect:!0})};t.prototype.getListContentTypesDetailed=function(e,t,n,r,i){var s=this,o=null!=r?r:Object(f.r)(this._pageContext);o.endsWith("/")&&(o=o.substring(0,o.length-2));var u=null!=i?i:"";u=u?"?"+u:"";var a=function(r){return s.dataRequestor.getData({url:encodeURI(L.format(s.listContentTypeDetailedUrlTemplate+u,o,e,t,n)),qosName:s._isAdmin?"GetListContentType":"SiteLevelGetListContentType",method:"GET",contentType:"application/json",authToken:null!=r?r:void 0,parseResponse:function(e){return JSON.parse(e).value},noRedirect:!0})};return r?this._getOAuthToken(r).then(function(e){return a(e)}):a()};t.prototype.getContentTypeColumns=function(e,t,n){return this.dataRequestor.getData({url:encodeURI(L.format(this.contentTypeColumnsUrlTemplate+"?"+this.getContentTypeColumnsHiddenParam,Object(f.r)(this._pageContext),e,t,n)),qosName:this._isAdmin?"GetContentTypeColumns":"SiteLevelGetContentTypeColumns",method:"GET",contentType:"application/json",parseResponse:function(e){return JSON.parse(e).value},noRedirect:!0})};t.prototype.getUpdateAvailablePropertyForContentType=function(e,t,n){return this.dataRequestor.getData({url:encodeURI(L.format(this.updateContentTypeUrlTemplate+"?"+this.selectIsUpdateAvailable,Object(f.r)(this._pageContext),e,t,n)),qosName:this._isAdmin?"GetContentTypeUpdateAvailable":"SiteLevelGetContentTypeUpdateAvailable",method:"GET",contentType:"application/json",parseResponse:function(e){return JSON.parse(e).isUpdateAvailable},noRedirect:!0})};t.prototype.getReorderableContentTypeColumns=function(e,t,n){return this.dataRequestor.getData({url:encodeURI(L.format(this.contentTypeColumnsUrlTemplate+"?"+this.filterByReorderable,Object(f.r)(this._pageContext),e,t,n)),qosName:this._isAdmin?"GetReorderableContentTypeColumns":"SiteLevelGetReorderableContentTypeColumns",method:"GET",contentType:"application/json",parseResponse:function(e){return JSON.parse(e).value},noRedirect:!0})};t.prototype.getListContentTypeColumns=function(e,t,n,r){return this.dataRequestor.getData({url:encodeURI(L.format(this.listContentTypeColumnsUrlTemplate,Object(f.r)(this._pageContext),e,t,n,r)),qosName:this._isAdmin?"GetContentTypeColumns":"SiteLevelGetContentTypeColumns",method:"GET",contentType:"application/json",parseResponse:function(e){try{return JSON.parse(e).value}catch(e){return[]}},noRedirect:!0})};t.prototype.getReorderableListContentTypeColumns=function(e,t,n,r){return this.dataRequestor.getData({url:encodeURI(L.format(this.listContentTypeColumnsUrlTemplate+"?"+this.filterByReorderable,Object(f.r)(this._pageContext),e,t,n,r)),qosName:this._isAdmin?"GetReorderableContentTypeColumns":"SiteLevelGetReorderableContentTypeColumns",method:"GET",contentType:"application/json",parseResponse:function(e){try{return JSON.parse(e).value}catch(e){return[]}},noRedirect:!0})};t.prototype.getEnforcedHubSites=function(e,t,n){return this.dataRequestor.getData({url:encodeURI(L.format(this.updateContentTypeUrlTemplate+"?"+this.getContentTypeEnforcemenetParam,Object(f.r)(this._pageContext),e,t,n)),qosName:this._isAdmin?"GetContentTypeEnforcedHubSites":"SiteLevelGetContentTypeEnforcedHubSites",method:"GET",contentType:"application/json",parseResponse:function(e){try{return JSON.parse(e)}catch(e){return{}}},noRedirect:!0})};t.prototype.publishContentTypeGet=function(e,t){return this.dataRequestor.getData({url:encodeURI(L.format(this.publishContentTypeUrlTemplate,Object(f.r)(this._pageContext),e,t)),qosName:this._isAdmin?"GetContentTypePublish":"SiteLevelGetContentTypePublish",method:"GET",contentType:"application/json",parseResponse:function(e){},noRedirect:!0})};t.prototype.publishContentType=function(e,t){var n=this;return this.getToken().then(function(r){return n.dataRequestor.getData({url:encodeURI(L.format(n.publishContentTypeUrlTemplate,Object(f.r)(n._pageContext),e,t)),authToken:r,qosName:n._isAdmin?"PostContentTypePublish":"SiteLevelPostContentTypePublish",method:"POST",contentType:"application/json",parseResponse:function(e){},noRedirect:!0})})};t.prototype.unpublishContentType=function(e,t){var n=this;return this.getToken().then(function(r){return n.dataRequestor.getData({url:n.getUrl(n.unpublishContentTypeUrlTemplate,e,t),authToken:r,qosName:n._isAdmin?"PostContentTypeUnpublish":"SiteLevelPostContentTypeUnpublish",method:"POST",contentType:"application/json",parseResponse:function(e){},noRedirect:!0})})};t.prototype.unpublishContentTypeGet=function(e,t){return this.dataRequestor.getData({url:this.getUrl(this.unpublishContentTypeUrlTemplate,e,t),qosName:this._isAdmin?"GetContentTypeUnpublish":"SiteLevelGetContentTypeUnpublish",method:"GET",contentType:"application/json",parseResponse:function(e){},noRedirect:!0})};t.prototype.getSiteColumns=function(e,t,n){return this.dataRequestor.getData({url:n?encodeURI(L.format(this.siteColumnsUrlTemplate,Object(f.r)(this._pageContext),e,t)+"?select="+n.join(",")):encodeURI(L.format(this.siteColumnsUrlTemplate,Object(f.r)(this._pageContext),e,t)),qosName:this._isAdmin?"GetSiteColumns":"SiteLevelGetSiteColumns",method:"GET",contentType:"application/json",parseResponse:function(e){return JSON.parse(e).value},noRedirect:!0})};t.prototype.getListColumns=function(e,t){return this.dataRequestor.getData({url:encodeURI(L.format(this.listColumnsUrlTemplate,Object(f.r)(this._pageContext),e,t)),qosName:"GetListColumns",method:"GET",contentType:"application/json",parseResponse:function(e){return JSON.parse(e)},noRedirect:!0})};t.prototype.getAncestorColumns=function(e,t,n){return this.dataRequestor.getData({url:n&&n.length>0?encodeURI(L.format(this.ancestorSiteColumnsUrlTemplate,Object(f.r)(this._pageContext),e,t)+"(select="+n.join(",")+")"):encodeURI(L.format(this.ancestorSiteColumnsUrlTemplate,Object(f.r)(this._pageContext),e,t)),qosName:this._isAdmin?"GetAncestorColumns":"SiteLevelGetAncestorColumns",method:"GET",contentType:"application/json",parseResponse:function(e){return JSON.parse(e).externalColumns},noRedirect:!0})};t.prototype.addContentTypesToList=function(e,t,n,r){var i=this;return this.getToken().then(function(s){return i.dataRequestor.getData({url:encodeURI(L.format(i.listContentTypeDetailedUrlTemplate,Object(f.r)(i._pageContext),e,t,n)),authToken:s,qosName:i._isAdmin?"AddContentTypeToList":"SiteLevelAddContentTypeToList",method:"POST",contentType:"application/json",additionalHeaders:{accept:"application/json"},additionalPostData:i.constructContentTypeAddToListPostBody(r),parseResponse:function(e){try{return JSON.parse(e).value}catch(e){return[]}},noRedirect:!0})})};t.prototype.createContentType=function(e,t,n,r,i,s,o){var u=this;return this.getToken().then(function(a){return u.dataRequestor.getData({url:encodeURI(L.format(u.contentTypeUrlTemplate+"?"+u.contentTypeExpandColumnsParam,Object(f.r)(u._pageContext),i,s)),authToken:a,qosName:u._isAdmin?"CreateContentType":"SiteLevelCreateContentType",method:"POST",contentType:"application/json",additionalHeaders:{accept:"application/json"},additionalPostData:u.constructContentTypeBody(e,t,n,r,void 0,void 0,o),parseResponse:function(e){return JSON.parse(e)},noRedirect:!0})})};t.prototype.updateContentType=function(e,t,n,r,i,s,o,u,l,c,h,p,d,v){var m=this,g=JSON.parse(this.constructContentTypeBody(r,i,s,o,u,l,h)),y=void 0,b=[],w=1;if(void 0!==c){g.documentTemplate={name:c.name};if(void 0!==c.content){g.documentTemplate["@microsoft.graph.sourceUrl"]="cid:content"+w;y=O("A100x","content"+w,"application/octet-stream");w+=1}}if(void 0!==d){g.documentSet={allowedContentTypes:d.allowedContentTypes,addNameToFile:d.addNameToFile,sharedColumns:d.sharedColumns,welcomePageColumns:d.welcomePageColumns,propagateWelcomePageChanges:d.pushWelcomePageChanges};if(d.defaultContents&&d.defaultContents.length>0){var E=1;d.defaultContents.forEach(function(e){var t={fileName:e.fileName,folderName:e.folderName,contentType:e.contentType};if(e.content){t["@microsoft.graph.sourceUrl"]="cid:content"+E;b.push("\r\n"+O("A100x","content"+E,"application/octet-stream"));b.push(e.content);E++}g.documentSet.defaultContents?g.documentSet.defaultContents.push(t):g.documentSet.defaultContents=[t]})}}var S=(function(e,t,n,r){var i=O(e,t,n);return i+=r+"\r\n"})("A100x","metadata","application/json",JSON.stringify(g)),x=[];x=void 0!==y?[S+=y,c.content,"\r\n--A100x--"]:b.length>0?Object(a.__spreadArrays)([S],b,["\r\n--A100x--"]):[S,"--A100x--"];var T=p?L.format(this.updateListContentTypeUrlTemplate,Object(f.r)(this._pageContext),e,t,p,n):d?L.format(this.updateContentTypeUrlTemplate+"?"+this.docSetSharedandWelcomePageColumnsParam,Object(f.r)(this._pageContext),e,t,n):L.format(this.updateContentTypeUrlTemplate,Object(f.r)(this._pageContext),e,t,n);v&&(T+="?$select=*,documentTemplate");return this.getToken().then(function(e){return m.dataRequestor.getData({url:T,authToken:e,qosName:m._isAdmin?"UpdateContentType":"SiteLevelUpdateContentType",method:"PATCH",contentType:"multipart/related; boundary=A100x",additionalHeaders:void 0,additionalPostData:new Blob(x),parseResponse:function(e){return JSON.parse(e)},noRedirect:!0})})};t.prototype.addContentTypesToListFromHub=function(e,t,n,r){for(var i=this,s="batch_36522ad7-fc75-4b56-8c71-56071383e77b",o="",u=0,a=r;u<a.length;u++){var f=a[u],l=L.format(this.addContentTypeToListBatchUrlTemplate,e,t,n);o+=M(s,"application/http","binary");o+=_("application/json","application/json","POST",l,f.length+20);o+=JSON.stringify({contentTypeId:f})+"\r\n\r\n"}var c=new Blob([o,"--batch_36522ad7-fc75-4b56-8c71-56071383e77b--"]);return this.getToken().then(function(e){return i.dataRequestor.getData({url:L.format(i.batchUrlTemplate,i._pageContext.webAbsoluteUrl.replace(/\/$/,"")),authToken:e,qosName:i._isAdmin?"AddContentTypeToListFromHubBatch":"SiteLevelAddContentTypeToListFromHubBatch",method:"POST",contentType:"multipart/mixed; boundary="+s,additionalHeaders:void 0,additionalPostData:c,parseResponse:function(e){return JSON.parse(e)},noRedirect:!0})})};t.prototype.createOrAddContentTypeColumns=function(e,t,n,r,i){var s=this;return this.getToken().then(function(o){return s.dataRequestor.getData({url:encodeURI(L.format(s.contentTypeColumnsUrlTemplate,Object(f.r)(s._pageContext),e,t,n)),authToken:o,qosName:s._isAdmin?"CreateContentTypeColumn":"SiteLevelCreateContentTypeColumn",method:"POST",contentType:"application/json",additionalHeaders:{accept:"application/json"},additionalPostData:JSON.stringify({value:Object(a.__spreadArrays)(r,i)}),parseResponse:function(e){return JSON.parse(e).value},noRedirect:!0})})};t.prototype.addContentTypeColumns=function(e,t,n,r,i){var s=this;return this.getToken().then(function(o){return s.dataRequestor.getData({url:encodeURI(L.format(s.contentTypeColumnsAddUrlTemplate,Object(f.r)(s._pageContext),e,t,n)),authToken:o,qosName:s._isAdmin?"AddContentTypeColumn":"SiteLevelAddContentTypeColumn",method:"POST",contentType:"application/json",additionalHeaders:{accept:"application/json"},additionalPostData:JSON.stringify({value:Object(a.__spreadArrays)(r,i)}),parseResponse:function(e){return JSON.parse(e).value},noRedirect:!0})})};t.prototype.createContentTypeView=function(e,t,n,r){var i=this;return this.getToken().then(function(s){return i.dataRequestor.getData({url:encodeURI(L.format(i.createContentTypeViewUrl,Object(f.r)(i._pageContext),e,t,n)),authToken:s,qosName:i._isAdmin?"CreateContentTypeView":"SiteLevelCreateContentTypeView",method:"POST",contentType:"application/json",additionalHeaders:{accept:"application/json"},additionalPostData:i.constructCreateContentTypeViewPostBody(r),parseResponse:function(e){try{return JSON.parse(e).value}catch(e){return""}},noRedirect:!0})})};t.prototype.getSharedPackagesByUrl=function(e,t){var n=this;return this.getToken(e).then(function(r){return n.dataRequestor.getData({url:encodeURI(L.format(n.sharedPackageUrlTemplate,e+t)),qosName:n._isAdmin?"GetSharedPackagesByUrl":"SiteLevelGetSharedPackagesByUrl",method:"GET",authToken:r,contentType:"application/json",parseResponse:function(e){return JSON.parse(e).d.results},noRedirect:!0})})};t.prototype.getSharedPackageList=function(e,t){var n=this;return this.getToken(e).then(function(r){return n.dataRequestor.getData({url:encodeURI(L.format(n.sharedPackageListTemplate,e+t)),qosName:n._isAdmin?"GetSharedPackageList":"SiteLevelGetSharedPackageList",method:"GET",authToken:r,contentType:"application/json",parseResponse:function(e){return JSON.parse(e).d.Id},noRedirect:!0})})};t.prototype.getSharedPackageListItems=function(e,t,n){return this.dataRequestor.getData({url:encodeURI(L.format(this.urlTemplateForSharedPackages,Object(f.r)(this._pageContext),e,t,n)),qosName:this._isAdmin?"GetSharedPackageListItems":"SiteLevelGetSharedPackageListItems",method:"GET",contentType:"application/json",parseResponse:function(e){var t=JSON.parse(e),n=[];t.value.map(function(e){return n.push(e.fields)});return n},noRedirect:!0})};t.prototype.getSharedPackages=function(e){return this.dataRequestor.getData({url:this.getUrl(this.sharedPackageByTitleUrlTemplate,e),qosName:this._isAdmin?"GetSharedPackages":"SiteLevelGetSharedPackages",method:"GET",contentType:"application/json",parseResponse:function(e){return JSON.parse(e).value},noRedirect:!0})};t.prototype.getCurrencyList=function(e){var t=this;return this.getToken().then(function(n){return t.dataRequestor.getData({url:encodeURI(L.format(t.currencyListUrlTemplate,e)),authToken:n,qosName:t._isAdmin?"GetCurrencyList":"SiteLevelGetCurrencyList",method:"POST",contentType:"application/json",additionalHeaders:{accept:"application/json"},parseResponse:function(e){try{return JSON.parse(e).Items}catch(e){return[]}},noRedirect:!0})})};t.prototype.getRegionalDateTimeSchema=function(e){var t=this;return this.getToken().then(function(n){return t.dataRequestor.getData({url:encodeURI(L.format(t.regionalDateTimeUrlTemplate,e)),authToken:n,qosName:t._isAdmin?"GetRegionalDateTimeSchema":"SiteLevelGetRegionalDateTimeSchema",method:"POST",contentType:"application/json",additionalHeaders:{accept:"application/json"},parseResponse:function(e){try{var t=JSON.parse(e);return JSON.parse(t.value)}catch(e){return{}}},noRedirect:!0})})};t.prototype.getContentTypeAccessPermissions=function(e){var t=this;return this.getToken().then(function(n){return t.dataRequestor.getData({url:encodeURI(L.format(t.permissionUrlTemplate+"?"+t.contentTypeAccessPermissionParam,e)),authToken:n,qosName:t._isAdmin?"GetContentTypeAccessPermissions":"SiteLevelGetContentTypeAccessPermissions",method:"GET",contentType:"application/json",additionalHeaders:{accept:"application/json"},parseResponse:function(e){try{return JSON.parse(e).value}catch(e){return!1}},noRedirect:!0})})};t.prototype.getAdminCenterAccessPermissions=function(e){var t=this;return this.getToken(e).then(function(n){return t.dataRequestor.getData({url:encodeURI(L.format(t.permissionUrlTemplate+"?"+t.adminCenterAcesssPermissionParam,e)),authToken:n,qosName:t._isAdmin?"GetAdminCenterAccessPermissions":"SiteLevelGetAdminCenterAccessPermissions",method:"GET",contentType:"application/json",additionalHeaders:{accept:"application/json"},parseResponse:function(e){try{return JSON.parse(e).value}catch(e){return!1}},noRedirect:!0})})};t.prototype.loadViews=function(e,t){var n=this;return this.dataRequestor.getData({url:""+e+L.format(this.contentTypeListViewUrl,t)+"/Views",qosName:this._isAdmin?"GetContentTypeViews":"SiteLevelGetContentTypeViews",method:"GET",contentType:"application/json",additionalHeaders:{accept:"application/json"},parseResponse:function(e){return n._parseReturnedViews(JSON.parse(e))},noRedirect:!0})};t.prototype.updateView=function(e,t,n,r,i,s){var o=this,u=""+i+L.format(this.contentTypeListViewUrl,s)+"/Views('"+e+"')/SetViewXml()",a=this._translateColumnKeysToFieldRefNames(r),f=new k(n,a).generateCamlQueryString().replace("<View>",'<View Name="'+e+'" DisplayName="'+t+'">');return this.getToken().then(function(e){return o.dataRequestor.getData({url:u,authToken:e,qosName:o._isAdmin?"UpdateContentTypeView":"SiteLevelUpdateContentTypeView",method:"POST",contentType:"application/json",additionalHeaders:{accept:"application/json"},additionalPostData:JSON.stringify({viewXml:f}),parseResponse:function(e){},noRedirect:!0})})};t.prototype.createView=function(e,t,n,r,i){var s=this,o=""+r+L.format(this.contentTypeListViewUrl,i)+"/Views/Add",u=this._translateColumnKeysToFieldRefNames(n),a=new k(t).generateCamlQueryString();return this.getToken().then(function(t){return s.dataRequestor.getData({url:o,authToken:t,qosName:s._isAdmin?"CreateContentTypeView":"SiteLevelCreateContentTypeView",method:"POST",contentType:"application/json",additionalHeaders:{accept:"application/json"},additionalPostData:JSON.stringify({parameters:{Title:e,ViewFields:u,Query:a,Paged:!1,PersonalView:!1}}),parseResponse:function(e){return JSON.parse(e).Id},noRedirect:!0})})};t.prototype.setDefaultView=function(e,t,n){return Object(a.__awaiter)(this,void 0,A.n,function(){var r,i=this;return Object(a.__generator)(this,function(s){r=""+e+L.format(this.contentTypeListViewUrl,n)+"/Views('"+t+"')";return[2,this.getToken().then(function(e){return i.dataRequestor.getData({url:r,authToken:e,qosName:i._isAdmin?"UpdateContentTypeView":"SiteLevelUpdateContentTypeView",method:"PATCH",contentType:"application/json",additionalHeaders:{accept:"application/json"},additionalPostData:JSON.stringify({DefaultView:!0}),parseResponse:function(e){},noRedirect:!0})})]})})};t.prototype.createContentTypeViewList=function(e,t,n){var r=this;return this.getToken().then(function(i){return r.dataRequestor.getData({url:encodeURI(L.format(r.createListUrlTemplate,Object(f.r)(r._pageContext),e,t)),authToken:i,qosName:r._isAdmin?"CreateContentTypeViewList":"SiteLevelCreateContentTypeViewList",method:"POST",contentType:"application/json",additionalHeaders:{accept:"application/json"},additionalPostData:JSON.stringify(n),parseResponse:function(e){return JSON.parse(e)},noRedirect:!0})})};t.prototype.updateListSettings=function(e,t){var n=this;return this.getToken().then(function(r){return n.dataRequestor.getData({url:encodeURI(L.format(n.updateListUrlTemplate,n._pageContext.webAbsoluteUrl,e)),authToken:r,qosName:n._isAdmin?"UpdateListSettings":"SiteLevelUpdateListSettings",method:"POST",contentType:"application/json",additionalHeaders:{accept:"application/json","X-HTTP-Method":"MERGE","IF-MATCH":"*"},additionalPostData:JSON.stringify(t),parseResponse:function(e){},noRedirect:!0})})};t.prototype.getAllSitesLists=function(e,t){return this.dataRequestor.getData({url:encodeURI(L.format(this.siteListsUrlTemplate,Object(f.r)(this._pageContext),e,t)),qosName:this._isAdmin?"GetAllSitesLists":"SiteLevelGetAllSitesLists",method:"GET",contentType:"application/json",parseResponse:function(e){try{return JSON.parse(e).value}catch(e){return[]}},noRedirect:!0})};t.prototype.getListData=function(e,t,n){return this.dataRequestor.getData({url:encodeURI(L.format(this.listUrlTemplate,Object(f.r)(this._pageContext),e,t,n)),qosName:this._isAdmin?"GetListData":"SiteLevelGetListData",method:"GET",contentType:"application/json",parseResponse:function(e){return JSON.parse(e)},noRedirect:!0})};t.prototype.getListFields=function(e,t,n){return this.dataRequestor.getData({url:encodeURI(L.format(this.listFieldsUrlTemplate,Object(f.r)(this._pageContext),e,t,n)),qosName:this._isAdmin?"GetListFields":"SiteLevelGetListFields",method:"GET",contentType:"application/json",parseResponse:function(e){try{return JSON.parse(e).value}catch(e){return[]}},noRedirect:!0})};t.prototype.getContentTypeDocTemplate=function(e,t,n){return this.dataRequestor.getData({url:encodeURI(L.format(this.contentTypeUrlTemplate+"/"+n+"?"+this.selectDocTemplateProperty,Object(f.r)(this._pageContext),e,t)),qosName:this._isAdmin?"GetContentTypeDocTemplate":"SiteLevelGetContentTypeDocTemplate",method:"GET",contentType:"application/json",parseResponse:function(e){try{return JSON.parse(e).documentTemplate}catch(e){return{}}},noRedirect:!0})};t.prototype.deleteContentTypeFromList=function(e,t,n,r){var i=this;return this.getToken().then(function(s){return i.dataRequestor.getData({url:encodeURI(L.format(i.listContentTypeDetailedUrlTemplate+"/"+r,Object(f.r)(i._pageContext),e,t,n)),authToken:s,qosName:i._isAdmin?"DeleteContentTypeList":"SiteLevelDeleteContentTypeList",method:"DELETE",contentType:"application/json",additionalHeaders:{accept:"application/json"},parseResponse:function(e){try{return JSON.parse(e)}catch(e){return""}},noRedirect:!0})})};t.prototype.deleteContentTypeFromSite=function(e,t,n){var r=this;return this.getToken().then(function(i){return r.dataRequestor.getData({url:encodeURI(L.format(r.contentTypeUrlTemplate+"/"+n,Object(f.r)(r._pageContext),e,t)),authToken:i,qosName:r._isAdmin?"DeleteContentTypeSite":"SiteLevelDeleteContentTypeSite",method:"DELETE",contentType:"application/json",additionalHeaders:{accept:"application/json"},parseResponse:function(e){try{return JSON.parse(e)}catch(e){return""}},noRedirect:!0})})};t.prototype.deleteContentTypeColumn=function(e,t,n,r){var i=this;return this.getToken().then(function(s){return i.dataRequestor.getData({url:encodeURI(L.format(i.updateContentTypeColumnUrlTemplate,Object(f.r)(i._pageContext),e,t,n,r)),authToken:s,qosName:i._isAdmin?"DeleteContentTypeColumn":"SiteLevelDeleteContentTypeColumn",method:"DELETE",contentType:"application/json",additionalHeaders:{accept:"application/json"},parseResponse:function(e){try{return JSON.parse(e)}catch(e){return""}},noRedirect:!0})})};t.prototype.updateContentTypeColumn=function(e,t,n,r,i,s,o){var u=this;return this.getToken().then(function(a){return u.dataRequestor.getData({url:encodeURI(L.format(u.updateContentTypeColumnUrlTemplate,Object(f.r)(u._pageContext),e,t,n,r)),authToken:a,qosName:u._isAdmin?"UpdateContentTypeColumn":"SiteLevelUpdateContentTypeColumn",method:"PATCH",contentType:"application/json",additionalHeaders:{accept:"application/json"},additionalPostData:JSON.stringify({pushDownChanges:i,hidden:s,required:o}),parseResponse:function(e){return JSON.parse(e)},noRedirect:!0})})};t.prototype.reorderContentTypeColumn=function(e,t,n,r){var i=this;return this.getToken().then(function(s){return i.dataRequestor.getData({url:encodeURI(L.format(i.updateContentTypeUrlTemplate+"?"+i.reorderColumns,Object(f.r)(i._pageContext),e,t,n)),authToken:s,qosName:i._isAdmin?"ReorderContentTypeColumns":"SiteLevelReorderContentTypeColumns",method:"PATCH",contentType:"application/json",additionalHeaders:{accept:"application/json"},additionalPostData:JSON.stringify({columnOrder:r}),parseResponse:function(e){return JSON.parse(e)},noRedirect:!0})})};t.prototype.updateSiteColumn=function(e,t,n,r){var i=this;return this.getToken().then(function(s){return i.dataRequestor.getData({url:encodeURI(L.format(i.siteColumnsUrlTemplate,i._pageContext.siteAbsoluteUrl,e,t)+"/"+n),authToken:s,qosName:i._isAdmin?"UpdateSiteColumn":"SiteLevelUpdateSiteColumn",method:"PATCH",contentType:"application/json",additionalHeaders:{accept:"application/json"},additionalPostData:JSON.stringify({customFormatter:r}),parseResponse:function(e){return JSON.parse(e)},noRedirect:!0})})};t.prototype._translateColumnKeysToFieldRefNames=function(e){for(var t=[],n=0,r=e;n<r.length;n++){var i=r[n];i in p.n&&t.push(p.n[i].fieldRefName)}return t};t.prototype._parseReturnedViews=function(e){if(!e||!e.value||0===e.value.length)throw new Error("ContentTypeDataSource.parseReturnedViews: viewsData is null or undefined!");for(var t={},n=0,r=e.value;n<r.length;n++){var i=r[n],s=void 0;s=i.ViewQuery.indexOf("<View>")>-1?k.parseCamlQueryString(i.ViewQuery):k.parseCamlQueryString("<View><Query>"+i.ViewQuery+"</Query></View>");t[i.Id]={id:i.Id,title:i.Title,isDefault:i.DefaultView,query:s}}return t};t.prototype.getUrl=function(e,t,n,r,i){var s=Object(f.r)(this._pageContext);return n?r?void 0:i?encodeURI(L.format(e,s,t,n,i)):encodeURI(L.format(e,s,t,n)):r?encodeURI(L.format(e,s,t,r)):encodeURI(L.format(e,s,t))};t.prototype.constructContentTypeBody=function(e,t,n,r,i,s,o){var u={name:e,description:t,group:n,readOnly:i,pushDownChanges:s,enforcement:o};r&&(u.parentReference={id:r});return JSON.stringify(u)};t.prototype.constructContentTypeAddToListPostBody=function(e){var t=[];e.forEach(function(e){return t.push({id:e})});return JSON.stringify({value:t})};t.prototype.constructCreateContentTypeViewPostBody=function(e){var t={columns:e.columns,isDefault:!1,isPersonalView:!1,title:e.name,associatedContentType:{id:e.parentReference.id},displayName:D.t.isActivated("1d8cce13-d7df-463e-8243-1d10761b9759","09/23/2020","Pass displayName in view creation API")?void 0:e.name,legacyType:D.t.isActivated("0039b334-3a6c-4a11-abc7-755e22011543","09/23/2020","Pass legacyType in view creation API")?void 0:"HTML"};return JSON.stringify(t)};return t})(c.t);t.e=P},2267:function(e,t,n){"use strict";var r=n(185);Object(r.n)([{rawString:".AnchorOverlay{font-size:14px;font-weight:400;display:block;position:absolute;box-shadow:0 0 5px 0 "},{theme:"blackTranslucent40",defaultValue:"rgba(0,0,0,.4)"},{rawString:";background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";border:1px solid "},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:"}.AnchorOverlay-content{background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";position:relative;outline:0}.AnchorOverlay-content.AnchorOverlay-content--themePrimary{background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.od-OverlayHost-overlay .AnchorOverlay--bubble{transform:scaleY(0)}.od-OverlayHost-overlay.od-OverlayHost-overlay--opened .AnchorOverlay--bubble{animation:AnchorOverlayPartyAnimationOne 2s linear both}@keyframes AnchorOverlayPartyAnimationOne{0%{transform:matrix3d(1,0,0,0,0,.1,0,0,0,0,1,0,0,0,0,1);opacity:0;-webkit-animation-timing-function:cubic-bezier(.1,.25,.75,.9)}2.08%{transform:matrix3d(1,0,0,0,0,.277,0,0,0,0,1,0,0,-20.376,0,1)}4.16%{transform:matrix3d(1,0,0,0,0,.485,0,0,0,0,1,0,0,-26.476,0,1)}4.7%{transform:matrix3d(1,0,0,0,0,.53,0,0,0,0,1,0,0,-26.254,0,1)}8.25%{transform:matrix3d(1,0,0,0,0,.748,0,0,0,0,1,0,0,-14.165,0,1)}9.41%{transform:matrix3d(1,0,0,0,0,.797,0,0,0,0,1,0,0,-8.36,0,1)}12.41%{transform:matrix3d(1,0,0,0,0,.888,0,0,0,0,1,0,0,5.689,0,1)}14.11%{transform:matrix3d(1,0,0,0,0,.921,0,0,0,0,1,0,0,11.685,0,1)}16.5%{transform:matrix3d(1,0,0,0,0,.954,0,0,0,0,1,0,0,16.912,0,1)}18.72%{transform:matrix3d(1,0,0,0,0,.974,0,0,0,0,1,0,0,18.592,0,1)}24.32%{transform:matrix3d(1,0,0,0,0,.997,0,0,0,0,1,0,0,13.503,0,1)}24.74%{transform:matrix3d(1,0,0,0,0,.997,0,0,0,0,1,0,0,12.828,0,1)}29.93%{transform:matrix3d(1,0,0,0,0,1.002,0,0,0,0,1,0,0,4.292,0,1)}32.99%{transform:matrix3d(1,0,0,0,0,1.002,0,0,0,0,1,0,0,.354,0,1)}35.54%{transform:matrix3d(1,0,0,0,0,1.002,0,0,0,0,1,0,0,-1.856,0,1)}41.04%{transform:matrix3d(1,0,0,0,0,1.001,0,0,0,0,1,0,0,-3.531,0,1);opacity:1}52.15%{transform:matrix3d(1,0,0,0,0,1,0,0,0,0,1,0,0,-.791,0,1)}63.26%{transform:matrix3d(1,0,0,0,0,1,0,0,0,0,1,0,0,.651,0,1)}80%{transform:matrix3d(1,0,0,0,0,1,0,0,0,0,1,0,0,-.064,0,1)}85.49%{transform:matrix3d(1,0,0,0,0,1,0,0,0,0,1,0,0,-.12,0,1)}100%{transform:matrix3d(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)}}"}]);var i=n(1790),s=n(0),o=n(1789),u=n(1818),a=n(2316),f=n(2477),l=n(584),c=n(1479),h=n(1901),p=n(1993),d=n(1830),v=n(1840),m=n(1821),g=n(1816),y=n(2076),b=(function(e){Object(s.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.addBindingHandlers({host:u.e,beakAdorner:a.e,measure:f.e,recoverFocus:m.e,preserveFocus:v.e,focusTrap:g.e});var r=t.offset,i=void 0===r?n.createObservable(new l.e(0,a.e.size/2+4)):r,s=t.isBeakVisible,o=void 0===s?n.createObservable(!0):s,b=t.anchorElement,w=t.beakColorVariation,E=t.left,S=void 0===E?n.createObservable(0):E,x=t.top,T=void 0===x?n.createObservable(0):x,N=t.trigger,C=void 0===N?n.createObservable():N,k=t.enableRecoverFocusBinding,L=void 0!==k&&k,A=t.hasExplicitAlignment,O=void 0===A?!!t.hasExplicitAlignment:A,M=t.alignment,_=void 0===M?n.createObservable(h.e.Bottom):M,D=t.allowMenuNudging,P=void 0===D||D;n.isBeakVisible=o;n.isBeakCurrentlyVisible=n.createPureComputed(n._computeIsBeakCurrentlyVisible);n.isBubble=!!t.isBubble;n.isAnimationComplete=n.createObservable(!n.isBubble);n.beak=n.createObservable();n.overlayTagName=d.e.tagName;n.renderedTemplate=n.createObservable();n._trigger=C;n.clientRect=n.createObservable(new c.e(0,0,0,0));n._offset=i;n.anchorElement=b;n.beakColorVariation=w;n._anchorOverlayHelper=new(n.managed(y.e));n.colorVariationEnum=p.e;n.isScrollable=n.createObservable(!1);n._left=S;n._top=T;n.style=n.createObservable({});n.contentStyle=n.createObservable({});n.measureTrigger=n.createComputed(function(){n.renderedTemplate();n._trigger();return{}});n.overlayParams={alignToParent:!0};n.enableRecoverFocusBinding=L;n._anchorOverlayHelper.computePositioningStyles({renderedTemplate:n.renderedTemplate,clientRect:n.clientRect,style:n.style,contentStyle:n.contentStyle,trigger:n._trigger,userOffset:n._offset,hasExplicitAlignment:O,alignment:_,allowMenuNudging:P,left:n._left,top:n._top,beak:n.beak,isScrollable:n.isScrollable});return n}t.prototype.onAnimationComplete=function(){this.isAnimationComplete(!0)};t.prototype._computeIsBeakCurrentlyVisible=function(){return this.isAnimationComplete()&&this.isBeakVisible()};return t})(o.t),w=i.e({tagName:"ms-anchor-overlay",template:'\x3c!--ko component:{name:overlayTagName,params:overlayParams}--\x3e<div class="AnchorOverlay" data-bind="beakAdorner:{trigger:beak,isVisible:isBeakCurrentlyVisible,anchorElement:anchorElement,beakColorVariation:beakColorVariation},style:style,measure:{measure:clientRect,trigger:measureTrigger},css:{\'AnchorOverlay--bubble\':isBubble},event:{animationend:onAnimationComplete}">\x3c!--ko focusTrap:{}--\x3e<div class="AnchorOverlay-content" tabindex="-1" data-bind="style:contentStyle,css:{\'is-scrollable\':isScrollable,\'AnchorOverlay-content--themePrimary\':beakColorVariation===colorVariationEnum.themePrimary},preserveFocus,recoverFocus:{isEnabled:enableRecoverFocusBinding},host:{afterRender:$component.renderedTemplate}"></div>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e',viewModel:b,synchronous:!0});t.e=w},2571:function(e,t,n){"use strict";var r=n(0),i=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._parent=null;n._parent=t.parent;return n}t.prototype.getTextValue=function(e){return this._parent.getTextValue(e)};return t})(n(1789).t);t.e=i},2683:function(e,t,n){"use strict";var r=n(0),i=n(591),s=n(176),o=n(77),u=n(1873),a=n(1866),f=n("knockout-lib"),l=n(69),c=n(1806),h=n(18),p=n(59),d=n(1789),v=n(675),m=n(230),g=n(2101),y=n(1799),b=n(2960),w=n(34),E=(function(e){Object(r.__extends)(t,e);function t(){var t=e.call(this)||this;t.keyboardOptions=[{target:null,mappings:{Enter:t.onKeyEnter}},{target:window,mappings:{}}];t.focusedTile=t.observables.create();t.focusableTiles=t.observables.createArray();return t}t.prototype.onKeyEnter=function(e,t){var n=e.keyNav.focusedTile();if(n){n.personaParams.inputEvent(t);n.personaParams.openContextMenu(!0)}t.stopPropagation();return!0};return t})(n(1602).default),S=n(1888),x=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.sharingApiErrorMessage=n.createObservable("");n._people=n.createObservable(Array());n.keyNav=new E;n.personaTileCollection=n._getPersonaTileCollection();n.personaTileByUser=n._getPersonaTileByUser();n.principalKeepSharing=n._getPrincipalKeepSharing();n.keyNav.focusableTiles=n.personaTileCollection;n.isNewSharingFlowEnabled=Object(o.isFeatureEnabled)(o.SharingDialogRedux);n.isLoading=f.observable(!1);n.scopes=f.observableArray();n.links=f.observableArray();n._scopesLinks=n.observables.createArray();n.hasFocus=t.hasFocus;n.personaSize=4;n.hasSettings=f.observable(!1);n.advancedUrl=f.observable("");n.canUnshare=f.observable(!1);n.showEmailLink=f.observable(!1);n.readPermissionsUpdated=n.createObservable(!1);n.updateComplete=n.createObservable("");n.canManagePermissions=n.createObservable(!1);n.hasInheritedLink=n.createObservable(!1);var r=n.resources.consume(s.e);n.privateDescription=n.createPureComputed(n._computeShareStatus);n._engagement=n.resources.consume(i.e);n._currentItemShareAction=n.isNewSharingFlowEnabled?new(n.managed(r.ShareByLinkAction)):new(n.managed(r.ShareAction));n._sharingProvider=n.resources.consume(a.resourceKey);n._item=t.item;n.isShareLinkVisible=n.createComputed(n._computeIsShareLinkVisible);n.fileItem=n._item();n.createComputed(function(){var e=n._item();n._onItemChanged(e)});n.totalNumberOfLinks=n.createPureComputed(n._computeTotalNumberOfLinks);n.statusText=n.createComputed(n._computeStatusText);n.fileName=n.createObservable("");n.personaTileKeepSharing=n.createComputed(n._getPersonaKeepSharing);n.keepSharingHasAccess=n.createComputed(n._getkeepSharingHasAccess);n.mailto=n.createComputed(function(){if(!n.hasSettings())return"";for(var e,t="mailto:",r=[],i=0,s=n.scopes();i<s.length;i++)for(var o=0,u=s[i].people;o<u.length;o++){var a=u[o];a.email&&r.push(a.email)}n.showEmailLink(r.length>0&&r.length<30);t+=p.e.encodeURIComponent(r.join(";"));t+="?subject="+p.e.encodeURIComponent(n._settings.itemName);e=v.e(n._settings.itemUrl);t+="&body="+p.e.encodeURIComponent(n._normalizeUrl(e));n.fileName(n._settings.itemName);n.canManagePermissions(n._settings.canManagePermissions);n.hasInheritedLink(n._settings.hasInheritedLink);n.sharingApiErrorMessage(n._settings.sharingApiErrorMessage);return t});return n}t.prototype.dispose=function(){e.prototype.dispose.call(this);if(this._getPermissionsPromise){this._sharingData.cancelGetPermissionsPromise();this._getPermissionsPromise=null}if(this._getLinksPromise){this._sharingData.cancelGetLinksPromise();this._getLinksPromise=null}};t.prototype.onLinkRemoved=function(){this._engagement.logData({name:"RemoveLinkFromPanel.Sharing.InfoPaneSection.Click",isIntentional:!0});this._onItemChanged(this._item.peek())};t.prototype.onScopeClick=function(e){this._executeShare(e);return!1};t.prototype.notifyPermissionsUpdated=function(){this.updateComplete(u.sharingPermissionsUpdated);this.readPermissionsUpdated(!0)};t.prototype.cleanPermissionsUpdated=function(){this.updateComplete("");this.readPermissionsUpdated(!1)};t.prototype.onShareClick=function(){this._executeShare(this._item.peek());return!1};t.prototype.stopSharing=function(e){this._engagement.logData({name:"StopSharing.Sharing.InfoPaneSection.Click",isIntentional:!0});this._stopSharingConfirm(e)};t.prototype.convertPersonToPersonaTile=function(e,t,n){return{personaParams:{inputEvent:this.observables.create(),openContextMenu:this.observables.create(!1),item:n,person:e,personaSize:this.personaSize,showPresence:!0,sharingRoleMenuRootElementClass:"OneDriveApp"},key:t,focused:this.observables.create(!1)}};t.prototype._computeIsShareLinkVisible=function(){return this._currentItemShareAction.isAvailable()};t.prototype._stopSharing=function(){return this._sharingProvider.unshare(this._item.peek())};t.prototype._stopSharingConfirm=function(e){var t=this,n=this.resources.consume(c.e),r=this._engagement,i=f.observable(!0);n.requestDialog({title:u.stopSharingConfirmationTitle,size:"Medium",component:{name:g.e.tagName,params:{message:u.stopSharingConfirmationMessage}},actions:[{name:u.stopSharingConfirmationButton,execute:function(){r.logData({name:"Unshare.Sharing.InfoPaneSection.Click",isIntentional:!0});i(!1);return t._stopSharing().then(function(n){t._item.peek().queryType===w.e.SharedByMe&&e();return 2},function(e){return 3})},isDefault:!0,isAvailable:i,icon:new y.e("Save"),automationId:"UnshareConfirm"},{name:u.stopSharingCancelButton,execute:function(){r.logData({name:"CancelStopSharing.Sharing.InfoPaneSection.Click",isIntentional:!0});return l.n.wrap(3)},isDefault:!1,icon:new y.e("Cancel"),automationId:"UnshareCancel"}],focusOnPrimaryAction:!0,dismissOnEsc:!0,shouldPreserveFocus:!0,executeDefaultAction:!1})};t.prototype._executeShare=function(e,t){void 0===t&&(t=this.resources);var n=this.resources.consume(s.e);(this.isNewSharingFlowEnabled?this.addDisposable(new(t.injected(n.ShareByLinkAction))):this.addDisposable(new(t.injected(n.ShareAction))({item:f.observable(e),startState:3}))).execute(null)};t.prototype._computeStatusText=function(){var e=this._item.peek(),t=this.isLoading(),n="",r=this.scopes();this._hasError&&(n=this._errorText);t?n=u.sharingLoadingStatus:0!==this.totalNumberOfLinks()||this._hasNonOwnerScopes(r)||(n=e.type===m.e.Folder?u.sharingUnsharedFolderStatus:u.sharingUnsharedFileStatus);return n};t.prototype._hasNonOwnerScopes=function(e){var t=!0,n=!1;e&&0!==e.length||(t=!1);if(t)for(var r=0;r<e.length&&!n;r++)for(var i=e[r].people,s=0;s<i.length&&!n;s++){0!==i[s].sharingInfo.role&&(n=!0)}return t&&n};t.prototype._computeShareStatus=function(){var e=this.scopes(),t="";if(0===this.totalNumberOfLinks()&&!this._hasNonOwnerScopes(e)&&0===this._item().sharingRole)if(e&&0!==e.length){if(1===e.length&&this._areAllOwners(e[0].people)){var n=e[0].people[0];t=1===e[0].people.length&&2===n.entityType?h.format(u.sharingUnsharedOwnedByGroup,n.name):u.sharingUnsharedNotShared}}else t=u.sharingUnsharedNotShared;return t};t.prototype._areAllOwners=function(e){for(var t=0,n=e;t<n.length;t++){var r=n[t];if(r.sharingInfo&&0!==r.sharingInfo.role)return!1}return!0};t.prototype._computeTotalNumberOfLinks=function(){var e=this.links(),t=this._scopesLinks();return e.length+t.length};t.prototype._onItemChanged=function(e){var t=this;this.cleanPermissionsUpdated();if(this._getPermissionsPromise){this.isLoading(!1);this._sharingData.cancelGetPermissionsPromise();this._getPermissionsPromise=null}if(this._getLinksPromise){this._sharingData.cancelGetLinksPromise();this._getLinksPromise=null}if(e&&e.key!==this._itemKey){this._itemKey=e.key;this.scopes([]);this.links([]);this.isLoading(!0)}if(e){this._sharingData=this._sharingProvider.getSharingData(e);this._sharingData.getSettings().then(function(e){t._settings=e;t.advancedUrl(e.advancedUrl);t.hasSettings(!0)},function(e){});this._hasError=!1;this._getPermissionsPromise=this._sharingData.getPermissions();this._sharingData.doSharingScopesContainLinks()||(this._getLinksPromise=this._sharingData.getLinks());this.trackPromise(this._getPermissionsPromise.then(function(n){t.isLoading(!1);t.scopes(t._processScopes(e,n))},function(e){e&&403===e.status?t._errorText=u.accessDenied:e&&e.code&&e.code.indexOf("-2130575139")>-1?t._errorText=u.noscriptErrorStatus:t._errorText=u.serverError;t._hasError=!0;t.isLoading(!1)}));this._getLinksPromise&&this._getLinksPromise.then(function(e){e&&t.links(e.filter(function(e){return e.isActive&&8!==e.type}))},function(e){});this.fileItem=e}};t.prototype._processScopes=function(e,t){var n=this,i=[];t.length>0&&this.canUnshare(t[0].canUnshare);this._scopesLinks([]);for(var s=0;s<t.length;s++){var o=t[s];if(o&&o.people.length){var a=Object(r.__assign)(Object(r.__assign)({},o),{headerHtml:"",sharingPeople:[]});if(o.item&&o.item.key!==this._item.peek().key){var f;f="<span data-bind=\"component: { name: '"+b.e.tagName+"', params: { item: scope.item } }\"></span>";a.headerHtml=h.format(u.sharingScopeHeaderFormat,f)}o.people.forEach(function(e){var t;if(e.sharingInfo&&e.sharingInfo.link){var r=e.sharingInfo.link;11===r.type&&(r.email=null===(t=e.sharingInfo)||void 0===t?void 0:t.email);n._scopesLinks.push(r)}a.sharingPeople.push({personInfo:e,sharingItem:o.item})});i.push(a)}}for(var l=new Array,c=0;c<i.length;c++)l=l.concat(i[c].sharingPeople);this._people().length&&this.notifyPermissionsUpdated();this._people(l);return i};t.prototype._getkeepSharingHasAccess=function(){var e=this.personaTileKeepSharing(),t=this.totalNumberOfLinks();return e.length>0||t>0};t.prototype._getPersonaKeepSharing=function(){for(var e=this.principalKeepSharing(),t={},n=0,r=e;n<r.length;n++){t[(c=r[n]).personaParams.person().userId]=!0}for(var i=0,s=this.links();i<s.length;i++){var o=s[i];if(o.linkMembers)for(var u=0,a=o.linkMembers;u<a.length;u++){var f=a[u],l=f.userId,c=this.convertPersonToPersonaTile(this.createObservable(f),f.userId);if(!t[l]){t[l]=!0;e.push(c)}}}return e};t.prototype._getPrincipalKeepSharing=function(){return this._getPersonaTileHelper(!0)};t.prototype._getPersonaTileCollection=function(){return this._getPersonaTileHelper()};t.prototype._getPersonaTileHelper=function(e){var t=this,n=this.createPureComputed(e?this._getPeopleKeepSharing:this._getPeopleByUserId),i=this.observables.createArray();this.createBackgroundComputed(function(){i.splice.apply(i,Object(r.__spreadArrays)([0,i.peek().length],t._people().map(function(e){return e.personInfo.userId})))});return i.filter(function(e){return e in n()}).map({mappingWithDisposeCallback:function(e){var r=t.createObservable(),i=t.createComputed(function(){r(n()[e].personInfo||r.peek())});return{mappedValue:t.convertPersonToPersonaTile(r,e,n()[e].sharingItem),dispose:function(){i.dispose()}}}})};t.prototype._getPeopleKeepSharing=function(){return this._getPeopleByUserId(!1,!0)};t.prototype._getPeopleByUserId=function(e,t){for(var n={},r=0,i=this._people();r<i.length;r++){var s=i[r],o=s.personInfo,u=o&&o.sharingInfo;u&&3===u.type||(e&&o.principalType===S.e.sharePointGroup||t&&o&&o.sharingInfo&&0===o.sharingInfo.role||(n[o.userId]=s))}return n};t.prototype._getPersonaTileByUser=function(){var e=this;return this.createComputed(function(){for(var t={},n=0,r=e.personaTileCollection();n<r.length;n++){var i=r[n];t[i.key]=i}return t})};t.prototype._normalizeUrl=function(e){var t=document.createElement("A");t.href=e;return t.href};return t})(d.t);t.e=x},2684:function(e,t,n){"use strict";var r,i=n(0),s=n(2571);(function(e){e[e.none=0]="none";e.checkOut="checkOutOverlay.svg";e.notify="notifyOverlay.svg";e.block="blockOverlay.svg";e.record="recordOverlay.svg"})(r||(r={}));var o=r,u=n(163),a=n(1875),f=n(1845),l=n(273),c=(function(e){Object(i.__extends)(t,e);function t(n){var r=e.call(this,n)||this;r.item=n.item;r.iconFieldViewModelType=t;return r}t.getOverlayType=function(e){var t=e(),n=o.none,r=t.policyTip;if(r){var i=1==(1&r);2==(2&r)?n=o.block:i&&(n=o.notify)}else t.isViolation?n=o.block:t.properties&&t.properties.CheckedOutUserId?n=o.checkOut:t.state&&t.state.upload&&4===t.state.upload.status?n=o.notify:f.u(t)&&(n=o.record);return n};t.getHoverText=function(e){var t=e();return a.i(t)};t.getOnClick=function(e,t){var r=e();return r.policyTip&&1&r.policyTip?function(r){u.e.logData({name:"PolicyTip.LaunchFromListView"});n.ee(6,3255).then(l.e).then(function(n){new(t.injected(n))({item:e}).execute(r)});return!1}:null};return t})(s.e);t.e=c},2832:function(e,t,n){"use strict";n.r(t);n.d(t,"isSpoCreateFolderAvailable",function(){return h});var r=n(0),i=n(69),s=n(34),o=n(30),u=n(1914),a=n(176),f=n(1802),l=n(2021),c=(function(e){Object(r.__extends)(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.name="CreateFolder";t.item?n._currentItem=t.item:n._currentItem=n.resources.consume(a.o);n._itemParentHelper=n.resources.consume(f.e);n._isCreateShareableFolder=t.isCreateShareableFolder;return n}t.prototype.getExecutorPath=function(){return"./CreateFolderExecutor"};t.prototype.getModuleFactory=function(){return function(){return i.n.resolve(n.ee([91,"deferred","ondemand.resx-ondemand"],3440))}};t.prototype.getExecutorParameters=function(){return{currentItem:this._currentItem.peek(),isCreateShareableFolder:this._isCreateShareableFolder}};t.prototype.onIsAvailable=function(){var e=this._currentItem();return h(e,this.unwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(e,"list")))&&this.itemCommandHelper.isCommandSupported(e,l.t)};return t})(u.e);t.default=c;function h(e,t){return!!e&&e.queryType===s.e.Files&&(!t||t.list.allowCreateFolder&&!t.list.isExternal)&&o.e.hasItemPermission(e,o.e.insertListItems)}},2847:function(e,t,n){"use strict";var r=n(185);Object(r.n)([{rawString:".od-FileNameWithIcon-fileName{vertical-align:bottom}[dir=ltr] .od-FileNameWithIcon-fileName{padding-left:.1875rem}[dir=rtl] .od-FileNameWithIcon-fileName{padding-right:.1875rem}.isFluent .od-FileNameWithIcon-fileName{vertical-align:middle}[dir=ltr] .isFluent .od-FileNameWithIcon-fileName{padding-left:.3125rem}[dir=rtl] .isFluent .od-FileNameWithIcon-fileName{padding-right:.3125rem}.od-FileNameWithIcon-icon .FileTypeIcon{width:1.25rem;height:1.25rem}"}]);var i=n(1864),s=n(0),o=n(2684),u=n(1789),a=n(1875),f=n(1095),l=n(2045),c=(function(e){Object(s.__extends)(t,e);function t(t){var n=e.call(this,t)||this,r=t.oneDriveItem;n.fileName=r.name;n.fileTypeIconTagName=i.e.tagName;var s=n.createObservable(r);n._isFluentEnabled=n.resources.consume(f.e);n.addBindingHandlers({tooltip:l.e});n.tooltip=n.fileName;n.fileTypeIconParams={iconName:r.iconName,iconUrl:r.iconUrl,extension:r.extension,desiredSize:n._isFluentEnabled?20:16,desiredSizeRem:n._isFluentEnabled?1.25:1,overlayType:o.e.getOverlayType(s),iconFieldAriaLabel:a.e(r)||"",hoverText:o.e.getHoverText(s)};return n}return t})(u.t),h=n(1790).e({tagName:"ms-fileName-with-icon",template:'<span data-bind="tooltip:{content:fileName,\'aria-label\':fileName}"><span class="od-FileNameWithIcon-icon" data-bind="component:{name:fileTypeIconTagName,params:fileTypeIconParams}"></span><span class="od-FileNameWithIcon-fileName" data-bind="text:fileName"></span></span>',viewModel:c,synchronous:!0});t.e=h},4853:function(e,t,n){"use strict";n.r(t);var r=n(185);Object(r.n)([{rawString:".od-FolderSelect-panel{position:absolute;top:0;height:100%;width:100%}[dir=ltr] .od-FolderSelect-panel{left:0}[dir=rtl] .od-FolderSelect-panel{right:0}[dir=ltr] .od-FolderSelect-region{padding-left:40px}[dir=rtl] .od-FolderSelect-region{padding-right:40px}[dir=ltr] .isFluent .od-FolderSelect-region{padding-left:16px}[dir=rtl] .isFluent .od-FolderSelect-region{padding-right:16px}[dir=ltr] .isFluent .od-FolderSelect-region{padding-right:16px}[dir=rtl] .isFluent .od-FolderSelect-region{padding-left:16px}.od-FolderSelect-loading{padding-top:12px;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.od-FolderSelect-title{font-size:21px;font-weight:100}.isFluent .od-FolderSelect-title{font-size:20px;font-weight:600}.od-FolderSelect-title-fileInfo{font-size:14px;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";overflow:hidden;text-overflow:ellipsis;white-space:nowrap;height:20px}[dir=ltr] .od-FolderSelect-title-fileInfo{padding-right:40px}[dir=rtl] .od-FolderSelect-title-fileInfo{padding-left:40px}.isFluent .od-FolderSelect-title-fileInfo{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}.od-FolderSelect-breadCrumbContainer{padding:10px 40px 10px 0;font-size:14px;display:flex;align-items:center;cursor:default}html[dir=rtl] .od-FolderSelect-breadCrumbContainer{padding:10px 0 10px 40px}[dir=ltr] .od-FolderSelect-breadCrumbContainer{margin-left:-4px}[dir=rtl] .od-FolderSelect-breadCrumbContainer{margin-right:-4px}.isFluent .od-FolderSelect-breadCrumbContainer{padding:45px 16px 10px 0}html[dir=rtl] .isFluent .od-FolderSelect-breadCrumbContainer{padding:45px 0 10px 16px}.od-FolderSelect-breadCrumbItem{overflow:hidden;white-space:nowrap;text-overflow:ellipsis;padding:0 4px;padding-bottom:2px;height:30px;line-height:30px}.isFluent .od-FolderSelect-breadCrumbItem{height:20px;line-height:20px;padding-bottom:0}.od-FolderSelect-clickableCrumb{cursor:pointer}.od--isNonMobile .od-FolderSelect-clickableCrumb:hover{background:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:";outline:1px solid transparent}.od-FolderSelect-breadCrumbRootIcon{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";font-size:10px;height:30px;line-height:30px;font-weight:800}[dir=ltr] .od-FolderSelect-breadCrumbRootIcon{padding-right:4px}[dir=rtl] .od-FolderSelect-breadCrumbRootIcon{padding-left:4px}[dir=ltr] .od-FolderSelect-breadCrumbRootIcon{padding-left:2px}[dir=rtl] .od-FolderSelect-breadCrumbRootIcon{padding-right:2px}.od-FolderSelect-breadCrumbIcon{color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:";font-size:10px;font-weight:800;padding:0;font-family:FabricMDL2Icons;font-style:normal}.od-FolderSelect-ruledLine{border-bottom:1px solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}[dir=ltr] .od-FolderSelect-ruledLine{margin-left:-40px}[dir=rtl] .od-FolderSelect-ruledLine{margin-right:-40px}[dir=ltr] .isFluent .od-FolderSelect-ruledLine{margin-left:0}[dir=rtl] .isFluent .od-FolderSelect-ruledLine{margin-right:0}.od-FolderSelect-sectionHeader{margin-top:10px;font-size:12px;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.isFluent .od-FolderSelect-sectionHeader{margin-top:12px;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}.od-FolderSelect-destinationHeader{padding-bottom:10px;font-size:12px;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.od-FolderSelect-waitingForData{padding-top:10px;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";font-size:12px}.od-FolderSelect-sectionContainer{padding-bottom:10px}.od-FolderSelect-itemsContainer{margin-top:10px;outline:0}.od-FolderSelect-itemsRegion{overflow-y:auto;overflow-x:hidden}[dir=ltr] .od-FolderSelect-itemsRegion{padding-left:40px}[dir=rtl] .od-FolderSelect-itemsRegion{padding-right:40px}[dir=ltr] .isFluent .od-FolderSelect-itemsRegion{padding-left:16px}[dir=rtl] .isFluent .od-FolderSelect-itemsRegion{padding-right:16px}.od-FolderSelect-addTopMargin{margin-top:10px}.od-FolderSelect-addBottomMargin{margin-bottom:10px}.od-FolderSelect-itemContainer,.od-FolderSelect-showMore{overflow:hidden;height:28px;padding-top:5px;padding-bottom:5px;width:100%;white-space:nowrap;text-overflow:ellipsis;min-height:28px}.isFluent .od-FolderSelect-itemContainer,.isFluent .od-FolderSelect-showMore{height:24px;min-height:24px}.od-FolderSelect-itemContainer .ms-Icon--OneDrive{vertical-align:top;line-height:28px;width:28px}.sm .od-FolderSelect-itemContainer .ms-Icon--OneDrive{line-height:20px}.isFluent .od-FolderSelect-itemContainer .ms-Icon--OneDrive{width:24px;line-height:24px}[dir=ltr] .od-FolderSelect-itemWrapper{padding-right:40px}[dir=rtl] .od-FolderSelect-itemWrapper{padding-left:40px}[dir=ltr] .isFluent .od-FolderSelect-itemWrapper{padding-right:16px}[dir=rtl] .isFluent .od-FolderSelect-itemWrapper{padding-left:16px}.od-folderSelect-showMoreExtra{display:block;font-size:13px;line-height:28px}.isFluent .od-folderSelect-showMoreExtra{box-sizing:border-box;height:38px;min-height:38px}[dir=ltr] .isFluent .od-folderSelect-showMoreExtra{padding-left:36px}[dir=rtl] .isFluent .od-folderSelect-showMoreExtra{padding-right:36px}.isFluent .od-folderSelect-showMoreExtra:hover{background:0 0}.od-FolderSelect-showMoreLoading{padding-top:5px;padding-bottom:5px}.od-FolderSelect-clickable{cursor:pointer}[dir=ltr] .od-FolderSelect-clickable{padding-left:5px}[dir=rtl] .od-FolderSelect-clickable{padding-right:5px}[dir=ltr] .od-FolderSelect-clickable{margin-left:-5px}[dir=rtl] .od-FolderSelect-clickable{margin-right:-5px}.od-FolderSelect-clickable .ms-Icon--OneDrive{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";font-size:23px;padding-top:0;vertical-align:middle}[dir=ltr] .od-FolderSelect-clickable .ms-Icon--OneDrive{padding-left:3px}[dir=rtl] .od-FolderSelect-clickable .ms-Icon--OneDrive{padding-right:3px}[dir=ltr] .isFluent .od-FolderSelect-clickable .ms-Icon--OneDrive{padding-left:0}[dir=rtl] .isFluent .od-FolderSelect-clickable .ms-Icon--OneDrive{padding-right:0}.od-FolderSelect-clickable .od-FolderSelect-itemTitle{font-size:14px;vertical-align:middle}[dir=ltr] .od-FolderSelect-clickable .od-FolderSelect-itemTitle{padding-left:8px}[dir=rtl] .od-FolderSelect-clickable .od-FolderSelect-itemTitle{padding-right:8px}.od-FolderSelect-clickable:focus{outline:1px solid transparent;background:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:"}@media screen and (-ms-high-contrast:active){.od-FolderSelect-clickable:focus{background:#0000c0}}@media screen and (-ms-high-contrast:black-on-white){.od-FolderSelect-clickable:focus{background:#00c0ff}}.od-FolderSelect-clickable.is-focused{box-shadow:0 0 0 1px "},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:" inset;outline:1px solid transparent}.od--isNonMobile .od-FolderSelect-clickable:hover{background:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:";outline:1px solid transparent}.isFluent.od--isNonMobile .od-FolderSelect-clickable:hover{background:0 0}.od-FolderSelect-folderIcon{width:28px;text-align:center;display:inline-block}.od-FolderSelect-siteIcon{position:relative;display:inline-block;vertical-align:top;width:28px;height:28px}.isFluent .od-FolderSelect-siteIcon{width:24px;height:24px}[dir=ltr] .od-FolderSelect-stickyFooter{padding-left:40px}[dir=rtl] .od-FolderSelect-stickyFooter{padding-right:40px}.od-FolderSelect-statusLabel{font-size:14px;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";padding-top:15px}[dir=ltr] .od-FolderSelect-statusLabel{padding-right:40px}[dir=rtl] .od-FolderSelect-statusLabel{padding-left:40px}.od-folderSelect-itemError{color:"},{theme:"error",defaultValue:"#a80000"},{rawString:";font-size:13px;margin-top:10px}[dir=ltr] .od-folderSelect-itemError{padding-right:40px}[dir=rtl] .od-folderSelect-itemError{padding-left:40px}.od-folderSelect-itemInfo{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";font-size:13px}[dir=ltr] .od-folderSelect-itemInfo{padding-right:40px}[dir=rtl] .od-folderSelect-itemInfo{padding-left:40px}[dir=ltr] .od-folderSelect-itemErrorPadding{padding-left:40px}[dir=rtl] .od-folderSelect-itemErrorPadding{padding-right:40px}.od-FolderSelect-addFolder{margin-bottom:10px}.od-FolderSelect-hidden{display:none}.od-FolderSelect-addFolderContainer{min-height:38px}.od-FolderSelect-actionContainer{padding-top:20px;padding-bottom:20px;white-space:nowrap}.od-Button-withCheckBox{margin-top:20px}[dir=ltr] .od-Button-withCheckBox{margin-left:175px}[dir=rtl] .od-Button-withCheckBox{margin-right:175px}.od-FolderSelect-itemAnimation{width:100%;position:absolute;transition:left .3s,right .3s;-webkit-transition:left .3s,right .3s}[dir=ltr] .od-FolderSelect-itemEnterLeft{left:-300px}[dir=rtl] .od-FolderSelect-itemEnterLeft{right:-300px}[dir=ltr] .od-FolderSelect-itemEnterRight{left:300px}[dir=rtl] .od-FolderSelect-itemEnterRight{right:300px}[dir=ltr] .od-FolderSelect-itemInitial{left:0}[dir=rtl] .od-FolderSelect-itemInitial{right:0}.od-FolderSelect-infoBar{padding-top:10px;cursor:default}[dir=ltr] .od-FolderSelect-infoBar{padding-right:40px}[dir=rtl] .od-FolderSelect-infoBar{padding-left:40px}.od-FolderSelect-infoBarClickable{cursor:pointer}[dir=ltr] .od-FolderSelect-invalidTarget{padding-right:40px}[dir=rtl] .od-FolderSelect-invalidTarget{padding-left:40px}.od-FolderSelect-sharingHint{width:32px;height:32px;padding:0 10px;background-color:transparent;margin:0 10px;border:none}html[dir=ltr] .od-FolderSelect-sharingHint{float:right}html[dir=rtl] .od-FolderSelect-sharingHint{float:left}html[dir=ltr] .od-FolderSelect-sharingHintTooltip{float:right}html[dir=rtl] .od-FolderSelect-sharingHintTooltip{float:left}.od-FolderSelect-sharingHintIcon{color:"},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:";size:16pt;position:relative;cursor:pointer;padding:8px}[dir=ltr] .od-FolderSelect-sharingHintIcon{right:9px}[dir=rtl] .od-FolderSelect-sharingHintIcon{left:9px}.od-FolderSelect-sharingInfoText{width:150px;word-wrap:break-word}html[dir=ltr] .od-FolderSelect-sharingInfoText{text-align:left}html[dir=rtl] .od-FolderSelect-sharingInfoText{text-align:right}.od-FolderSelect-fileItemName{vertical-align:bottom}"}]);n(2267),n(2847);var i=n(0),s=n("knockout-lib"),o=n("react-lib"),u=n("react-dom-lib"),a=n(176),f=n(2832),l=n(93),c=n(1812),h=n(591),p=n(95),d=n(77),v=n(9),m=n(1864),g=n(3655),y=n(771),b=n(1238),w=n(1805);Object(r.n)([{rawString:".od-FolderSelect-panel{position:absolute;top:0;height:100%;width:100%}[dir=ltr] .od-FolderSelect-panel{left:0}[dir=rtl] .od-FolderSelect-panel{right:0}[dir=ltr] .od-FolderSelect-region{padding-left:40px}[dir=rtl] .od-FolderSelect-region{padding-right:40px}[dir=ltr] .isFluent .od-FolderSelect-region{padding-left:16px}[dir=rtl] .isFluent .od-FolderSelect-region{padding-right:16px}[dir=ltr] .isFluent .od-FolderSelect-region{padding-right:16px}[dir=rtl] .isFluent .od-FolderSelect-region{padding-left:16px}.od-FolderSelect-loading{padding-top:12px;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.od-FolderSelect-title{font-size:21px;font-weight:100}.isFluent .od-FolderSelect-title{font-size:20px;font-weight:600}.od-FolderSelect-title-fileInfo{font-size:14px;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";overflow:hidden;text-overflow:ellipsis;white-space:nowrap;height:20px}[dir=ltr] .od-FolderSelect-title-fileInfo{padding-right:40px}[dir=rtl] .od-FolderSelect-title-fileInfo{padding-left:40px}.isFluent .od-FolderSelect-title-fileInfo{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}.od-FolderSelect-breadCrumbContainer{padding:10px 40px 10px 0;font-size:14px;display:flex;align-items:center;cursor:default}html[dir=rtl] .od-FolderSelect-breadCrumbContainer{padding:10px 0 10px 40px}[dir=ltr] .od-FolderSelect-breadCrumbContainer{margin-left:-4px}[dir=rtl] .od-FolderSelect-breadCrumbContainer{margin-right:-4px}.isFluent .od-FolderSelect-breadCrumbContainer{padding:45px 16px 10px 0}html[dir=rtl] .isFluent .od-FolderSelect-breadCrumbContainer{padding:45px 0 10px 16px}.od-FolderSelect-breadCrumbItem{overflow:hidden;white-space:nowrap;text-overflow:ellipsis;padding:0 4px;padding-bottom:2px;height:30px;line-height:30px}.isFluent .od-FolderSelect-breadCrumbItem{height:20px;line-height:20px;padding-bottom:0}.od-FolderSelect-clickableCrumb{cursor:pointer}.od--isNonMobile .od-FolderSelect-clickableCrumb:hover{background:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:";outline:1px solid transparent}.od-FolderSelect-breadCrumbRootIcon{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";font-size:10px;height:30px;line-height:30px;font-weight:800}[dir=ltr] .od-FolderSelect-breadCrumbRootIcon{padding-right:4px}[dir=rtl] .od-FolderSelect-breadCrumbRootIcon{padding-left:4px}[dir=ltr] .od-FolderSelect-breadCrumbRootIcon{padding-left:2px}[dir=rtl] .od-FolderSelect-breadCrumbRootIcon{padding-right:2px}.od-FolderSelect-breadCrumbIcon{color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:";font-size:10px;font-weight:800;padding:0;font-family:FabricMDL2Icons;font-style:normal}.od-FolderSelect-ruledLine{border-bottom:1px solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}[dir=ltr] .od-FolderSelect-ruledLine{margin-left:-40px}[dir=rtl] .od-FolderSelect-ruledLine{margin-right:-40px}[dir=ltr] .isFluent .od-FolderSelect-ruledLine{margin-left:0}[dir=rtl] .isFluent .od-FolderSelect-ruledLine{margin-right:0}.od-FolderSelect-sectionHeader{margin-top:10px;font-size:12px;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.isFluent .od-FolderSelect-sectionHeader{margin-top:12px;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}.od-FolderSelect-destinationHeader{padding-bottom:10px;font-size:12px;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.od-FolderSelect-waitingForData{padding-top:10px;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";font-size:12px}.od-FolderSelect-sectionContainer{padding-bottom:10px}.od-FolderSelect-itemsContainer{margin-top:10px;outline:0}.od-FolderSelect-itemsRegion{overflow-y:auto;overflow-x:hidden}[dir=ltr] .od-FolderSelect-itemsRegion{padding-left:40px}[dir=rtl] .od-FolderSelect-itemsRegion{padding-right:40px}[dir=ltr] .isFluent .od-FolderSelect-itemsRegion{padding-left:16px}[dir=rtl] .isFluent .od-FolderSelect-itemsRegion{padding-right:16px}.od-FolderSelect-addTopMargin{margin-top:10px}.od-FolderSelect-addBottomMargin{margin-bottom:10px}.od-FolderSelect-itemContainer,.od-FolderSelect-showMore{overflow:hidden;height:28px;padding-top:5px;padding-bottom:5px;width:100%;white-space:nowrap;text-overflow:ellipsis;min-height:28px}.isFluent .od-FolderSelect-itemContainer,.isFluent .od-FolderSelect-showMore{height:24px;min-height:24px}.od-FolderSelect-itemContainer .ms-Icon--OneDrive{vertical-align:top;line-height:28px;width:28px}.sm .od-FolderSelect-itemContainer .ms-Icon--OneDrive{line-height:20px}.isFluent .od-FolderSelect-itemContainer .ms-Icon--OneDrive{width:24px;line-height:24px}[dir=ltr] .od-FolderSelect-itemWrapper{padding-right:40px}[dir=rtl] .od-FolderSelect-itemWrapper{padding-left:40px}[dir=ltr] .isFluent .od-FolderSelect-itemWrapper{padding-right:16px}[dir=rtl] .isFluent .od-FolderSelect-itemWrapper{padding-left:16px}.od-folderSelect-showMoreExtra{display:block;font-size:13px;line-height:28px}.isFluent .od-folderSelect-showMoreExtra{box-sizing:border-box;height:38px;min-height:38px}[dir=ltr] .isFluent .od-folderSelect-showMoreExtra{padding-left:36px}[dir=rtl] .isFluent .od-folderSelect-showMoreExtra{padding-right:36px}.isFluent .od-folderSelect-showMoreExtra:hover{background:0 0}.od-FolderSelect-showMoreLoading{padding-top:5px;padding-bottom:5px}.od-FolderSelect-clickable{cursor:pointer}[dir=ltr] .od-FolderSelect-clickable{padding-left:5px}[dir=rtl] .od-FolderSelect-clickable{padding-right:5px}[dir=ltr] .od-FolderSelect-clickable{margin-left:-5px}[dir=rtl] .od-FolderSelect-clickable{margin-right:-5px}.od-FolderSelect-clickable .ms-Icon--OneDrive{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";font-size:23px;padding-top:0;vertical-align:middle}[dir=ltr] .od-FolderSelect-clickable .ms-Icon--OneDrive{padding-left:3px}[dir=rtl] .od-FolderSelect-clickable .ms-Icon--OneDrive{padding-right:3px}[dir=ltr] .isFluent .od-FolderSelect-clickable .ms-Icon--OneDrive{padding-left:0}[dir=rtl] .isFluent .od-FolderSelect-clickable .ms-Icon--OneDrive{padding-right:0}.od-FolderSelect-clickable .od-FolderSelect-itemTitle{font-size:14px;vertical-align:middle}[dir=ltr] .od-FolderSelect-clickable .od-FolderSelect-itemTitle{padding-left:8px}[dir=rtl] .od-FolderSelect-clickable .od-FolderSelect-itemTitle{padding-right:8px}.od-FolderSelect-clickable:focus{outline:1px solid transparent;background:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:"}@media screen and (-ms-high-contrast:active){.od-FolderSelect-clickable:focus{background:#0000c0}}@media screen and (-ms-high-contrast:black-on-white){.od-FolderSelect-clickable:focus{background:#00c0ff}}.od-FolderSelect-clickable.is-focused{box-shadow:0 0 0 1px "},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:" inset;outline:1px solid transparent}.od--isNonMobile .od-FolderSelect-clickable:hover{background:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:";outline:1px solid transparent}.isFluent.od--isNonMobile .od-FolderSelect-clickable:hover{background:0 0}.od-FolderSelect-folderIcon{width:28px;text-align:center;display:inline-block}.od-FolderSelect-siteIcon{position:relative;display:inline-block;vertical-align:top;width:28px;height:28px}.isFluent .od-FolderSelect-siteIcon{width:24px;height:24px}[dir=ltr] .od-FolderSelect-stickyFooter{padding-left:40px}[dir=rtl] .od-FolderSelect-stickyFooter{padding-right:40px}.od-FolderSelect-statusLabel{font-size:14px;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";padding-top:15px}[dir=ltr] .od-FolderSelect-statusLabel{padding-right:40px}[dir=rtl] .od-FolderSelect-statusLabel{padding-left:40px}.od-folderSelect-itemError{color:"},{theme:"error",defaultValue:"#a80000"},{rawString:";font-size:13px;margin-top:10px}[dir=ltr] .od-folderSelect-itemError{padding-right:40px}[dir=rtl] .od-folderSelect-itemError{padding-left:40px}.od-folderSelect-itemInfo{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";font-size:13px}[dir=ltr] .od-folderSelect-itemInfo{padding-right:40px}[dir=rtl] .od-folderSelect-itemInfo{padding-left:40px}[dir=ltr] .od-folderSelect-itemErrorPadding{padding-left:40px}[dir=rtl] .od-folderSelect-itemErrorPadding{padding-right:40px}.od-FolderSelect-addFolder{margin-bottom:10px}.od-FolderSelect-hidden{display:none}.od-FolderSelect-addFolderContainer{min-height:38px}.od-FolderSelect-actionContainer{padding-top:20px;padding-bottom:20px;white-space:nowrap}.od-Button-withCheckBox{margin-top:20px}[dir=ltr] .od-Button-withCheckBox{margin-left:175px}[dir=rtl] .od-Button-withCheckBox{margin-right:175px}.od-FolderSelect-itemAnimation{width:100%;position:absolute;transition:left .3s,right .3s;-webkit-transition:left .3s,right .3s}[dir=ltr] .od-FolderSelect-itemEnterLeft{left:-300px}[dir=rtl] .od-FolderSelect-itemEnterLeft{right:-300px}[dir=ltr] .od-FolderSelect-itemEnterRight{left:300px}[dir=rtl] .od-FolderSelect-itemEnterRight{right:300px}[dir=ltr] .od-FolderSelect-itemInitial{left:0}[dir=rtl] .od-FolderSelect-itemInitial{right:0}.od-FolderSelect-infoBar{padding-top:10px;cursor:default}[dir=ltr] .od-FolderSelect-infoBar{padding-right:40px}[dir=rtl] .od-FolderSelect-infoBar{padding-left:40px}.od-FolderSelect-infoBarClickable{cursor:pointer}[dir=ltr] .od-FolderSelect-invalidTarget{padding-right:40px}[dir=rtl] .od-FolderSelect-invalidTarget{padding-left:40px}.od-FolderSelect-sharingHint{width:32px;height:32px;padding:0 10px;background-color:transparent;margin:0 10px;border:none}html[dir=ltr] .od-FolderSelect-sharingHint{float:right}html[dir=rtl] .od-FolderSelect-sharingHint{float:left}html[dir=ltr] .od-FolderSelect-sharingHintTooltip{float:right}html[dir=rtl] .od-FolderSelect-sharingHintTooltip{float:left}.od-FolderSelect-sharingHintIcon{color:"},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:";size:16pt;position:relative;cursor:pointer;padding:8px}[dir=ltr] .od-FolderSelect-sharingHintIcon{right:9px}[dir=rtl] .od-FolderSelect-sharingHintIcon{left:9px}.od-FolderSelect-sharingInfoText{width:150px;word-wrap:break-word}html[dir=ltr] .od-FolderSelect-sharingInfoText{text-align:left}html[dir=rtl] .od-FolderSelect-sharingInfoText{text-align:right}.od-FolderSelect-fileItemName{vertical-align:bottom}.od-InlineCreateFolder{display:flex;align-items:center;cursor:pointer}.od-InlineCreateFolder.is-focused{box-shadow:0 0 0 1px "},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:" inset;outline:1px solid transparent;background:"},{theme:"themeLighter",defaultValue:"#d7eaf9"},{rawString:"}@media screen and (-ms-high-contrast:active){.od-InlineCreateFolder.is-focused{background:#0000c0}}@media screen and (-ms-high-contrast:black-on-white){.od-InlineCreateFolder.is-focused{background:#00c0ff}}.od-InlineCreateFolder.is-focused .od-InlineCreateFolder-addFolderText{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}.od-InlineCreateFolder-textInput{color:"},{theme:"black",defaultValue:"#000000"},{rawString:";background-color:"},{theme:"menuBackground",defaultValue:"#ffffff"},{rawString:";flex-grow:1;font-size:14px;border:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:";outline:1px solid transparent;box-sizing:border-box;min-width:100px}[dir=ltr] .od-InlineCreateFolder-textInput{padding-left:10px}[dir=rtl] .od-InlineCreateFolder-textInput{padding-right:10px}[dir=ltr] .od-InlineCreateFolder-textInput{margin-left:7px}[dir=rtl] .od-InlineCreateFolder-textInput{margin-right:7px}.od-InlineCreateFolder-textInput:focus,.od-InlineCreateFolder-textInput:hover{outline:1px solid transparent;border-color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.od-InlineCreateFolder-createButton{display:inline-block;width:32px;min-width:32px;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";padding:0 0 3px 0}[dir=ltr] .od-InlineCreateFolder-createButton{margin-right:5px}[dir=rtl] .od-InlineCreateFolder-createButton{margin-left:5px}.od-InlineCreateFolder-createButtonIcon{font-size:18px;vertical-align:middle}.od-InlineCreateFolder-addFolderText{flex-grow:1;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";font-size:14px;cursor:pointer;outline:0}[dir=ltr] .od-InlineCreateFolder-addFolderText{padding-left:10px}[dir=rtl] .od-InlineCreateFolder-addFolderText{padding-right:10px}.od-InlineCreateFolder-icon{width:30px;min-width:30px;text-align:center;font-size:16px;color:"},{theme:"themeDarkAlt",defaultValue:"#106ebe"},{rawString:";padding-top:2px;position:relative}[dir=ltr] .od-InlineCreateFolder-icon{left:-1px}[dir=rtl] .od-InlineCreateFolder-icon{right:-1px}.od-InlineCreateFolder-icon .od-LoadingSpinner-loadingGif{vertical-align:inherit}.od-InlineCreateFolder-error{font-size:12px;color:"},{theme:"error",defaultValue:"#a80000"},{rawString:"}[dir=ltr] .od-InlineCreateFolder-error{padding-left:38px}[dir=rtl] .od-InlineCreateFolder-error{padding-right:38px}"}]);var E=n(3429),S=n(1808),x=n(18),T=n(1789),N=n(1860),C=n(432),k=(function(e){Object(i.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.namePlaceholder=E.u;n.nameLabel=E.o;n.createLabel=E.t;n.newFolderText=E.a;n._processCreateFolder=function(e,t){var r={status:n._createActionStatus};new(n.managed(n._actionMap.CreateNewFolderAction))({parentItem:n._item,newFolderName:n.newFolderName,options:r,authToken:e.authToken}).execute(t).then(function(){if(n._createActionStatus()){n.errorText(n._createActionStatus());n.isFolderCreating(!1)}else{n.successText(x.format(E.n,n.newFolderName.peek()));if(n._newFolderItem){e.remoteItem=n._item.remoteItem;e.isMountPointFolder=n._item.isMountPointFolder;n._itemProvider.getItem(e).then(function(e){for(var t=e.content().items,r=0;r<t.length;r++){var i=t[r]();if(i.displayName===n.newFolderName.peek()){n._resetControl();(n._item.remoteItem||n._item.isMountPointFolder)&&(i.remoteWebUrl=n._item.isMountPointFolder?n._item.remoteWebUrl:n._item.remoteItem.SiteUrl);n._newFolderItem(i);n._itemProvider.invalidateItem(n._item.key)}}})}else{n._resetControl();n._newFolderItem()}}})};n.loadingSpinnerTagName=N.e.tagName;n.height=(t.height||38).toString()+"px";n.inputHeight=(t.height||32).toString()+"px";n._newFolderItem=t.newFolderItem;n._newItemFocused=t.newItemFocused;n.focused=t.focused;n._item=t.item;n.newFolderName=s.observable("");n.isFolderCreating=s.observable(!1);n.showAddFolderText=s.observable(!0);n.inputFocused=s.observable(!1);n._createActionStatus=s.observable("");n.errorText=s.observable("");n.successText=s.observable("");n.addBindingHandlers({keyboard:S.e});n._itemProvider=n.resources.consume(w.resourceKey);n._actionMap=n.resources.consume(a.e);n._engagement=n.resources.consume(h.e);n._identityDataSource=n.resources.consume(C.e);if(t.isActive){var r=new(n.managed(n._actionMap.CreateFolderAction))({item:s.observable(n._item)});n.createComputed(function(){t.isActive(r.isAvailable())})}return n}t.prototype.onEnterAddFolder=function(){this._newItemFocused&&this._newItemFocused(!0);this.onClickAddFolder()};t.prototype.onClickAddFolder=function(){this._engagement.logData({name:"InlineCreateFolder.NewFolder.Click",isIntentional:!0});this.showAddFolderText(!1);this.inputFocused(!0)};t.prototype.onExecuteClick=function(e,t){this._engagement.logData({name:"InlineCreateFolder.CreateFolder.Click",isIntentional:!0});this.createNewFolder(t)};t.prototype.onEnter=function(e,t){if(0!==this.newFolderName().length){this._engagement.logData({name:"InlineCreateFolder.CreateFolder.Enter",isIntentional:!0});this.createNewFolder(t);return!1}};t.prototype.onEscape=function(e,t){this._engagement.logData({name:"InlineCreateFolder.CreateFolder.Dismiss",isIntentional:!0});this._resetControl();t.stopPropagation();return!1};t.prototype.createNewFolder=function(e){var t=this;this.isFolderCreating(!0);this.inputFocused(!1);this.errorText("");if(this._item.remoteItem&&Object(d.isFeatureEnabled)(d.SupportMountPointInMoveCopyPanel)){var n={parentKey:this._item.key};this._item.remoteItem&&this._item.remoteItem.SiteUrl&&this._identityDataSource.getSharePointToken(this._item.remoteItem.SiteUrl).then(function(r){n.authToken=r.accessToken;t._processCreateFolder(n,e)})}else{var r={parentKey:this._item.key};this._processCreateFolder(r,e)}e.stopPropagation();return!1};t.prototype._resetControl=function(){this.showAddFolderText(!0);this.newFolderName("");this.isFolderCreating(!1);this.errorText("");this.focused(!1)};return t})(T.t),L=n(1790),A=L.e({tagName:"ms-inline-create-folder",template:'<div class="od-InlineCreateFolder" data-bind="attr:{\'aria-label\':newFolderText},css:{\'is-focused\':focused},style:{height:height}">\x3c!--ko if:isFolderCreating--\x3e<span class="od-InlineCreateFolder-icon" data-bind="component:{name:loadingSpinnerTagName,params:{loadingText:\'\'}}"></span>\x3c!--/ko--\x3e\x3c!--ko ifnot:isFolderCreating--\x3e<i class="od-InlineCreateFolder-icon ms-Icon ms-Icon--FabricNewFolder" data-bind="icon:true"></i>\x3c!--/ko--\x3e\x3c!--ko if:showAddFolderText--\x3e<span role="button" tabindex="0" class="od-InlineCreateFolder-addFolderText" data-bind="text:newFolderText,click:onClickAddFolder,keyboard:{allowInputEvents:true,mappings:{Enter:onEnterAddFolder,Space:onEnterAddFolder}},hasFocus:focused"></span>\x3c!--/ko--\x3e\x3c!--ko ifnot:showAddFolderText--\x3e<input class="od-InlineCreateFolder-textInput" type="text" data-bind="value:newFolderName,textInput:newFolderName,keyboard:{allowInputEvents:true,mappings:{Enter:onEnter,Esc:onEscape}},attr:{maxlength:255,placeholder:namePlaceholder,\'aria-label\':namePlaceholder,\'aria-busy\':isFolderCreating},hasFocus:inputFocused,automation:automationId,style:{height:inputHeight},enable:!isFolderCreating()"><button class="od-Button od-Button--primary od-InlineCreateFolder-createButton" data-bind="style:{visibility:newFolderName()?\'\':\'hidden\'},click:onExecuteClick,attr:{\'aria-label\':createLabel},css:{\'is-disabled\':isFolderCreating}"><span class="ms-Icon ms-Icon--CheckMark od-InlineCreateFolder-createButtonIcon" data-bind="icon:true"></span></button>\x3c!--/ko--\x3e</div>\x3c!--ko if:errorText--\x3e<div class="od-InlineCreateFolder-error" aria-live="assertive" data-bind="text:errorText"></div>\x3c!--/ko--\x3e\x3c!--ko if:successText--\x3e<div class="ms-accessible" aria-live="polite" data-bind="text:successText"></div>\x3c!--/ko--\x3e',viewModel:k,synchronous:!0}),O=n(1944),M=n(230),_=n(1802),D=n(1136),P=n(1832),H=n(473),B=n(69),j=n(1900),F=n(84),I=n(44),q=n(1962),R=n(2619),U=n(3446),z=(function(e){Object(i.__extends)(t,e);function t(t){var n=e.call(this,t)||this,r=s.unwrap(n.valueAccessor());n._scrollContainer=r.scrollableElement();n._forceResize=r.forceResize;n._forceResize(!1);n.events.on(window,"resize",n._sizeContainer);n.subscribe(n._forceResize,n._forceResizeContainer);n._sizeContainer();return n}t.prototype._forceResizeContainer=function(){if(this._forceResize()){this._sizeContainer();this._forceResize(!1)}};t.prototype._sizeContainer=function(){var e=window.innerHeight,t=this._scrollContainer.getBoundingClientRect(),n=this.element.offsetHeight,r=e-t.top-n;this._scrollContainer.style.maxHeight=r.toString()+"px"};return t})(n(1794).t),W=n(36);Object(r.n)([{rawString:".od-StillSpinning-text{text-align:center;padding-top:10px}.od-StillSpinning-error{text-align:center}.od-StillSpinning-imgError{padding-bottom:10px}"}]);var X=n(4513),V=n(2556),$=n(1876),J=(function(e){Object(i.__extends)(t,e);function t(n){var r=e.call(this,n)||this;r.addBindingHandlers({visibility:V.e});r.params=n;r.resx=X;r.showControl=r.params.showControl||s.observable(!0);r.showSpinner=s.observable(!1);r.showStillWaiting=s.observable(!1);r.showError=s.observable(!1);r.errorImgUrl=window.require.toUrl("odsp-media/images/sitehub/error_icecream.png");r.spinnerTagName=0===r.params.spinnerType?N.e.tagName:$.e.tagName;r.spinnerParams=0===r.params.spinnerType?{loadingText:""}:{};r._spinnerTimeoutId=r.async.setTimeout(function(){r.showSpinner(!0);var e=r.params.stillWaitingTimeout;e?r._stillWaitingTimeoutId=r.async.setTimeout(function(){r.showStillWaiting(!0);r._startErrorTimeout()},e):r._startErrorTimeout()},r.params.spinnerTimeout||t.SPINNER_TIMEOUT);r.params.promise.then(function(e){r.showControl(!1);r._clearDataSourceTimeouts()},function(e){if(e&&e.retry){r.showControl(!1);r._clearDataSourceTimeouts()}else{r.showSpinner(!1);r.showStillWaiting(!1);r.showError(!0);r._clearDataSourceTimeouts()}});return r}t.prototype._startErrorTimeout=function(){var e=this;this.params.errorTimeout&&(this._errorTimeoutId=this.async.setTimeout(function(){e.showSpinner(!1);e.showStillWaiting(!1);e.showError(!0)},this.params.errorTimeout))};t.prototype._clearDataSourceTimeouts=function(){this._spinnerTimeoutId&&this.async.clearTimeout(this._spinnerTimeoutId);this._stillWaitingTimeoutId&&this.async.clearTimeout(this._stillWaitingTimeoutId);this._errorTimeoutId&&this.async.clearTimeout(this._errorTimeoutId)};t.SPINNER_TIMEOUT=1e3;return t})(T.t),K=L.e({tagName:"ms-stillSpinning",template:'<div data-bind="if:showControl()"><div data-bind="component:{name:spinnerTagName,params:spinnerParams},visibility:showSpinner()"></div>\x3c!--ko if:showStillWaiting()--\x3e<div class="od-StillSpinning-text" aria-live="polite" data-bind="text:resx.StillWaiting"></div>\x3c!--/ko--\x3e\x3c!--ko if:showError()--\x3e<div class="od-StillSpinning-error"><img class="od-StillSpinning-imgError" role="presentation" data-bind="attr:{src:errorImgUrl}"><div class="ms-fontWeight-semibold ms-font-l ms-fontColor-neutralSecondary" data-bind="text:resx.Error"></div><div class="ms-font-s ms-fontColor-neutralSecondary" data-bind="text:resx.Refresh"></div></div>\x3c!--/ko--\x3e</div>',viewModel:J}),Q=n(1067),G=n(12),Y=n(34),Z=n(1664),ee=n(1853),te=n(187),ne=n(2155),re=n(594),ie=n(1803),se=n(2457),oe=n(537),ue=n(1627),ae=n(121),fe=n(2332),le=n(4514);Object(r.n)([{rawString:".od-keepSharing{display:flex}.od-keepSharing .ms-TooltipHost{padding:2px}.od-keepSharing .ms-ActivityItem-activityTypeIcon{height:100%}.od-keepSharing .ms-ActivityItem-personaContainer{height:100%}.od-keepSharing .ms-ActivityItem-personaContainer .ms-Persona-imageArea{margin:0}.od-keepSharing .ms-ActivityItem-activityContent{display:none}.od-keepSharing-checkBox-label{font-size:12px;margin:1px;padding:0 2px 0 6px}html[dir=rtl] .od-keepSharing-checkBox-label{padding:0 6px 0 2px}.od-keepSharing .ms-TooltipHost{font-size:14px;vertical-align:middle}"}]);var ce,he=(function(e){Object(i.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._onCheckboxChange=function(e,t){n.setState({isChecked:t});n.props.onChangeShouldKeepSharing(t)};n.state={isChecked:t.shouldKeepSharing};return n}t.prototype.render=function(){var e=this.state.isChecked,t=this.props.personaList;return o.createElement("div",{className:"od-keepSharing"},o.createElement(se.e,{className:"od-keepSharing-checkBox",checked:e,onChange:this._onCheckboxChange}),t&&t.length>0&&o.createElement(fe.e,{isCompact:!0,activityPersonas:t.slice(0,3).map(function(e){return{imageInitials:(t=e.name||"",n=t.match(/\b\w/g)||[],((n.shift()||"")+(n.pop()||"")).toUpperCase()),imageUrl:e.image||""};var t,n})}),o.createElement("span",{className:"od-keepSharing-checkBox-label"},le.e),o.createElement(ue.e,{content:le.t,directionalHint:ae.e.bottomCenter},o.createElement(oe.e,{className:"od-od-keepSharing-learnMore",iconName:"Info","aria-describedby":le.t})))};return t})(o.Component),pe=n(2683),de=n(1657);(function(e){e.DocumentSetsGuid="3bae86a2-776d-499d-9db8-fa4cdc7884f8"})(ce||(ce={}));var ve=ce,me=n(160),ge=n(2242),ye=n(102),be=n(43),we=n(998),Ee=n(1934),Se=n(106),xe=n(78),Te=n(333),Ne=n(1),Ce=n(3070),ke=n(1828),Le=n(7),Ae=n(3),Oe=(function(e){Object(i.__extends)(t,e);function t(t,n){void 0===n&&(n={});var r=e.call(this,t,n)||this;r.chooseDestination=g.t;r.placesAltText=g.j;r.stillSpinningTagName=K.tagName;r.loadingSpinnerTagName=N.e.tagName;r.siteIconTagName=U.e.tagName;r.fileTypeIconTagName=m.e.tagName;r.inlineCreateFolderTagName=A.tagName;r._dismissErrorBar=function(){r.targetInvalid(!1)};var o=r.resources,u=n.urlDataSource,f=void 0===u?o.consume(l.pe):u,p=n.itemProvider,b=void 0===p?o.consume(w.resourceKey):p,E=n.actionMap,T=void 0===E?o.consume(a.e):E,k=n.pageContext,L=void 0===k?o.consume(W.h):k,M=n.itemUrlHelper,D=void 0===M?o.consume(te.u):M,H=n.itemParentHelper,X=void 0===H?o.consume(_.e):H,V=n.engagement,$=void 0===V?o.consume(h.e):V,J=n.suiteNavProvider,se=void 0===J?o.consume(O.resourceKey):J,oe=n.itemSelectionHelperType,ue=void 0===oe?o.consume(ie.e):oe,ae=n.viewParams,fe=void 0===ae?o.consume(a.j):ae,le=n.itemCacheStore,ce=void 0===le?o.consume(y.e.optional):le,pe=n.itemsScopeCurrentItemKey,ve=void 0===pe?o.consume(Ee.e.optional):pe,ye=n.moveCopyCapabilities,be=void 0===ye?o.consume(Ce.e):ye,we=new(r.scope.attached(ue))({}),Oe=function(e){return r.resources.consumeAsync(l.E.bypass).then(function(t){if(!t.getSharePointToken){r._engagement.logData({name:"MoveCopyPanel.ErrorInGettInGettingIdentityDataSource"});return""}return r._itemUrlHelper.getUrlParts({webUrl:e,path:e}).isCrossDomain?t.getSharePointToken(new me.e(e).authority).then(function(e){return e.accessToken}):Promise.resolve("")})};r._suiteNavProvider=se;r._engagement=$;r._urlDataSource=f;if(Object(Ae.ss)(Ae.zi)){r.legacyStoreResourceScope=r.addDisposable(new Le.i(o));r.legacyStoreResourceScope.block(ke.t);r._itemProvider=r.legacyStoreResourceScope.consume(w.resourceKey)}else{r.legacyStoreResourceScope=o;r._itemProvider=b}r._actionMap=T;r._pageContext=L;r._siteDataSource=new de.default(L,Oe);r._siteCTDataSource=new ge.e(L,Oe);r._itemUrlHelper=D;r._itemParentHelper=X;r._viewParams=fe;r._itemCacheStore=ce;r._itemsScopeCurrentItemKey=ve;r._moveCopyCapabilities=be;r.loading=s.observable(!0);r.loadingOneDrive=s.observable(!0);var Me=new F.e({name:"MoveCopySelect.LaunchPane"});r.context=t.context;r.itemOne=r._createContentItem();r.itemTwo=r._createContentItem();r._itemOneUsedLast=!1;r.waitingForItem=s.observable(!1);r.addFolderFocused=s.observable(!1);r.useLocationFocused=s.observable(!1);r.useOneDriveBrandIcon=Object(Ae.ss)(d.CommandBarBrandIcons);r.oneDriveBrandIcon=window.require.toUrl("odsp-media/images/brand-icons/product-fluent/svg/onedrive_16x1.svg");r.targetInvalid=s.observable(!1);r.newFolderActive=s.observable(!0);r.isSingleItem=r.isFileInfoVisible(r.context.peek().items);r.isSingleItem&&(r.fileItem=r.context.peek().items[0]);r.top=s.observable("0px");r.left=s.observable("12px");r.chooseLocationText=r.context().isMove?g.C:g.i;r._targetIsCrossSite=r.createObservable(!1);r._shouldKeepSharing=r.createObservable(!1);r.showKeepSharing=r.createComputed(r._computeShowKeepSharing);r._sharedUsers=r.createComputed(r._getSharingPerson);r.keepSharingComponent=he;r.keepSharingProps=r.createComputed(r._getKeepSharingProps);r.chooseLocationButtonEnabled=s.observable(!0);r.onComplete=t.onComplete;r.newFolderItem=s.observable(null);r.newFolderItemFocused=s.observable(!1);r.createComputed(function(){if(r.newFolderItem()){var e=r.getCurrentItem();if(r.newFolderItem().parentKey===r._getParentKey(e)||Object(Ae.ss)(d.SupportMountPointInMoveCopyPanel)&&e.remoteItem&&e.remoteItem.ParentKey&&e.remoteItem.ParentKey.split("&")[0]===r.newFolderItem().parentKey){var t=r._createFolderItem(r.newFolderItem(),e);e.subItems.push(t);t.focused(!0);r.focusedItem(t);r.selectionModel.selectItem(t);r.newFolderItemFocused(!1);r.newFolderItem(null)}else Q.e.logData({name:"FolderSelect.AddFolder.InvalidParent",message:"Tried to add folder but current item is different than the folder that was just created."})}});r._serverDataPromise=new j.e;r.waitingForItemParams={stillWaitingTimeout:4e3,promise:null,showControl:r.waitingForItem};r._breadCrumbItems=s.observableArray([]);r.hasBackToRootButton=s.observable(!1);r.parentBreadCrumbClass=s.observable("");r._isBreadCrumbRootClickable=!0;r.parentFolderName=r.createComputed(function(){var e=r._breadCrumbItems().length;return e>1?r.unwrapObservable(r._breadCrumbItems()[e-2].title):""});r.currentFolderName=r.createComputed(function(){var e=r._breadCrumbItems().length;return e>0?r.unwrapObservable(r._breadCrumbItems()[e-1].title):""});1===t.context().items.length?r.moveCopyText=x.format(t.context().isMove?g.L:g.o,t.context().items.length):r.moveCopyText=x.format(t.context().isMove?g.k:g.s,t.context().items.length);r._sitesTitle=Object(Ae.ss)(d.LeftNavTeamSiteLibraries)?s.observable(g.R):r._getSitesTitle();r.onItemClick=function(e){return Object(i.__awaiter)(r,void 0,void 0,function(){return Object(i.__generator)(this,function(t){return[2,this._onItemClickPreProcess(e)]})})};r.onBreadCrumbParentClick=function(){if(r.isParentBreadCrumbClickable())return r._onBreadCrumbClick(!1)};r.onBreadCrumbRootClick=function(){return r._onBreadCrumbClick(!0)};r.onShowMoreClick=function(e){return r._onShowMoreClick(e)};r.onUseLocationClick=function(e,t){return r._onUseLocationClick(e,t)};r.onKeyEnter=function(e,t){r._onItemClickPreProcess(e);return!0};r.focusedItem=s.observable();r.selectionModel=new R.e;r.addBindingHandlers({selection:q.e,keyboard:S.e,element:c.e,stickyFooter:z,dismiss:ee.e,react:P.t,delayedHasFocus:ne.e});r.stickyFooterElement=s.observable();var _e,De={title:g.B,key:void 0,focused:s.observable(!1),selected:s.observable(!1),type:3,subItems:null,sections:[{title:r.chooseDestination,altTitle:g.a,items:s.observableArray(),listElement:s.observable(),focusedItem:s.observable(),showMore:s.observable(!1),showMoreInfo:s.observable(""),showMoreError:s.observable(""),showMoreFocused:r.createObservable(!1),showMoreLoading:r.createObservable(!1)}]};!v.e.isActivated("9a6f698b-cde6-4d93-b1cb-316aac02cd5a","09/30/2020","Use ItemsScope to get current itemset page context")&&r._itemCacheStore&&r._itemsScopeCurrentItemKey&&(_e=r._itemCacheStore.dispatch(Object(Se.e)(function(e){var t=e.demandItemFacet(xe.e,r._itemsScopeCurrentItemKey&&r._itemsScopeCurrentItemKey.peek());if(t){var n=Te.e.serialize({webAbsoluteUrl:t.webAbsoluteUrl,listFullUrl:t.listFullUrl});return e.demandItemFacet(Ne.ln,n)}})));var Pe,He,Be=we.currentItem,je=r._getRootItem(Be(),"list"),Fe=r._getRootItem(Be(),"subsite");if(je){var Ie=r._itemUrlHelper.getItemUrlParts(je.key);if(_e){r._siteAbsoluteUrl=_e.webAbsoluteUrl;r._siteTitle=_e.webTitle;r._webId=_e.webId;r._siteId=_e.siteId;r._siteLogoUrl=_e.webLogoUrl;r._listTitle=_e.listTitle}else{r._siteAbsoluteUrl=Fe?r._itemUrlHelper.getItemUrlParts(Fe.key).fullItemUrl:L.webAbsoluteUrl;v.e.isActivated("9d3e1237-da65-42af-875f-6d3ca041f90e","9/14/20","fix dup currentRootSite entry on destination list")||(r._siteAbsoluteUrl=r._siteAbsoluteUrl.replace(/\/$/,""));r._siteTitle=Fe&&Fe.name?Fe.name:L.webTitle;r._webId=Fe&&Fe.subsite&&Fe.subsite.id?Fe.subsite.id:L.webId;r._siteId=Fe&&Fe.subsite&&Fe.subsite.itemReference&&Fe.subsite.itemReference.SiteId?Fe.subsite.itemReference.SiteId:L.siteId;r._listTitle=je.name?je.name:L.listTitle;r._siteLogoUrl=Fe?Fe.subsite.icon:L.webLogoUrl}r._isOneDrive=je.list.templateType===G.n.mySiteDocumentLibrary;Pe=r._loadWebDataSource().then(function(e){return e.getMyOneDriveUrl()});r._containsDocSet=!1;r.context().items.forEach(function(e){e.isDocSet&&(r._containsDocSet=!0)});r._supportsCrossSite=(r._moveCopyCapabilities.supportsCopyCrossSite&&!r.context().isMove||r._moveCopyCapabilities.supportsMoveCrossSite&&r.context().isMove)&&(L.isNoScriptEnabled||!1)&&L.listBaseTemplate!==G.n.webPageLibrary&&je.list.isDocumentLibrary&&!Object(re.r)();r._identityDataSource=r.resources.consume(C.e);Object(Ae.ss)(d.MoveCopyDocSets)||(r._supportsCrossSite=r._supportsCrossSite&&!r._containsDocSet);var qe=function(e,t,n,i){return{title:r._getLocalLibraryTitle(i),key:t,oneDriveItem:e,focused:s.observable(!0),selected:s.observable(!1),type:r._isOneDrive?5:1,siteIcon:void 0,folderIcon:"folder",subItems:null,sections:null,retrievedSharingPermissions:!1,sharingPermissions:null,sharingInfoText:null,url:n,isCrossSite:!1,webId:r._webId,siteId:r._siteId}};He=r._isOneDrive?Pe.then(function(e){return qe(je,Ie.fullItemUrl,Ie.fullListUrl,e)},function(e){return qe(je,Ie.fullItemUrl,Ie.fullListUrl)}):B.n.wrap(qe(je,Ie.fullItemUrl,Ie.fullListUrl));!(r._viewParams&&r._viewParams.peek().remoteItem)&&He.then(function(e){De.sections[0].items().length>0?De.sections[0].items.unshift(e):De.sections[0].items.push(e)})}if(r._supportsCrossSite){r._initialSitesQos=new F.e({name:"MoveCopySelect.GetInitialSites"});r._initialSitesQosDone=!1;var Re=new F.e({name:"MoveCopySelect.GetMyOneDriveCrossSite"});Pe.then(function(e){if(null!==e){if(e!==r._siteAbsoluteUrl&&!r._containsDocSet){var t={title:g.H,key:e,focused:s.observable(!1),selected:s.observable(!1),type:5,siteIcon:null,folderIcon:null,subItems:null,sections:null,retrievedSharingPermissions:!1,sharingPermissions:null,sharingInfoText:null,isCrossSite:!0};De.sections[0].items.push(t)}Re.end({resultType:I.e.Success})}else{Re.end({resultType:I.e.ExpectedFailure});Q.e.logData({name:"MoveCopySelect.GetMyOneDriveCrossSite",message:"User does not have a my site provisioned"})}r.loadingOneDrive(!1)},function(e){Re.end({resultType:I.e.Failure});r.loadingOneDrive(!1)});var Ue={title:r._sitesTitle,altTitle:g.d,type:3,lastIndex:0,listElement:s.observable(),focusedItem:s.observable(),items:s.observableArray(),showMore:s.observable(!0),showMoreLoading:s.observable(!1),showMoreInfo:s.observable(""),showMoreError:s.observable(""),showMoreFocused:s.observable(!1)};De.sections[1]=Ue;r._breadCrumbItems.push(De);r._acronymDataSource=new Z.e(L);r._itemProvider.getItemSync({parentKey:r._urlDataSource.getRootItemKey(Y.e.Subsites)});if(r._isOneDrive)r._getInitialSitesData(De.sections[1]);else{var ze=new F.e({name:"MoveCopySelect.GetCurrentTeamSiteAcronymAndColor"}),We=new F.e({name:"MoveCopySelect.GetCurrentTeamSiteDocumentLibraryCount"}),Xe=[];r._loadWebDataSource().then(function(e){Xe.push(r._getInitialSitesData(De.sections[1]));Xe.push(r._getCurrentSiteData(ze));Xe.push(r._getHasMultipleDocumentLibraries(We));B.n.all(Xe).done(function(e){var t=e[0],n=e[1],r=e[2];if(t){n&&r&&t.unshift(n);t=t.slice(0,8);De.sections[1].items(t);De.sections[1].showMoreLoading(!1)}})})}r._initialLoadSuccess(De,Me,!!je)}else if(je){r._breadCrumbItems.push(De);r._isBreadCrumbRootClickable=!1;r.loadingOneDrive(!1);He.then(function(e){var t=e;r._updateContextWithCurrentItem(t);r._getItemData(r._getParentKey(t),t.webId,t.siteId,!1,function(e){De=t;r._parseFolderItems(e,De);r._breadCrumbItems.push(De);r._initialLoadSuccess(De,Me,!0)},function(){r._initialLoadFailure(De,Me)})},function(e){r._initialLoadFailure(De,Me)})}else{Q.e.logData({name:"MoveCopySelect.LaunchPane",message:"List root item is null"});r.loadingOneDrive(!1);r._initialLoadFailure(De,Me)}return r}t.prototype.getStatusText=function(e){if(e&&e.subItems&&0===e.subItems().length)switch(e.type){case 2:case 6:case 1:return g.D;case 0:return g._}return null};t.prototype.isSite=function(e){return!!e&&0===e.type};t.prototype.isRootItem=function(e){return!!e&&3===e.type};t.prototype.isLibraryOrFolder=function(e){return!!e&&(1===e.type||2===e.type||6===e.type)};t.prototype.isLibraryOrFolderOrOneDrive=function(e){return!!e&&(this.isLibraryOrFolder(e)||this.isOneDrive(e))};t.prototype.isOneDrive=function(e){return!!e&&5===e.type};t.prototype.onChangeShouldKeepSharing=function(e){this._shouldKeepSharing(e)};t.prototype.showAddFolder=function(){var e=this.getCurrentItem(),t=e.oneDriveItem,n=this._getRootItem(t,"list");return!(e.remote||!t||!n)&&Object(f.isSpoCreateFolderAvailable)(t,n)};t.prototype.showBottomLine=function(e){return!!(e&&e.subItems&&e.subItems().length>0||this.isLibraryOrFolderOrOneDrive(e)&&this.showAddFolder())};t.prototype.getListType=function(e){if(e)return e.title===g.z?x.format(g.u,e.title):0===e.type?x.format(g.f,e.title):5===e.type||1===e.type?x.format(g.y,e.title):x.format(g.c,e.title)};t.prototype.getShowMoreText=function(e){return e&&3===e.type?Object(Ae.ss)(d.LeftNavTeamSiteLibraries)?g.T:g.e:g.U};t.prototype.getChooseLocationAccText=function(e){return this.context().isMove?x.format(g.N,e.title):x.format(g.r,e.title)};t.prototype.getCurrentItem=function(){return this._itemOneUsedLast?this.itemTwo.item():this.itemOne.item()};t.prototype.isParentBreadCrumbClickable=function(){return this._breadCrumbItems.peek().length>2||this._isBreadCrumbRootClickable};t.prototype.isFileInfoVisible=function(e){return 1===e.length};t.prototype._initialLoadSuccess=function(e,t,n){void 0===n&&(n=!1);this._setCurrentItemClass("od-FolderSelect-itemInitial");this.loading(!1);this._setCurrentItem(e,n);t.end({resultType:I.e.Success})};t.prototype._initialLoadFailure=function(e,t){e.error=s.observable(g.q);this.loading(!1);this._setCurrentItem(e);t.end({resultType:I.e.Failure})};t.prototype._getRootItem=function(e,t){var n=this.unwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(e,t));return n||null};t.prototype._getKeepSharingProps=function(){return{shouldKeepSharing:this._shouldKeepSharing.peek(),onChangeShouldKeepSharing:this.onChangeShouldKeepSharing.bind(this),personaList:this._sharedUsers()}};t.prototype._getSharingPerson=function(){var e=[];if(!this.showKeepSharing())return e;this._sharingSectionHelper||(this._sharingSectionHelper=new(this.managed(pe.e))({item:this.createObservable(this.fileItem)}));return e=this._sharingSectionHelper.personaTileKeepSharing().map(function(e){return e.personaParams.person.peek()})};t.prototype._loadWebDataSource=function(){return this.resources.consumeAsync(D.e)};t.prototype._loadSitesDataSource=function(){return this.resources.consumeAsync(l.oe)};t.prototype._renderMessageBar=function(e,t){var r=this;this.targetInvalid(!0);Promise.all([n.ee([299],4832)]).then(function(n){var i=n[0];u.render(o.createElement(i.default,{type:e,message:t,onDismiss:r._dismissErrorBar}),document.getElementsByClassName("od-FolderSelect-invalidTarget")[0])})};t.prototype._checkTargetLibForDocSets=function(e,t,n,r){return Object(i.__awaiter)(this,void 0,void 0,function(){var s,o,u,a;return Object(i.__generator)(this,function(i){switch(i.label){case 0:s=new URL(r).origin;return[4,this._siteCTDataSource.getListContentTypesDetailed(t,n,e,s)];case 1:o=i.sent();for(u=0,a=o;u<a.length;u++)if(a[u].id.startsWith("0x0120D520"))return[2,!0];return[2,!1]}})})};t.prototype._onItemClickPreProcess=function(e){return Object(i.__awaiter)(this,void 0,void 0,function(){var t,n,r,s;return Object(i.__generator)(this,function(i){switch(i.label){case 0:if(!this._containsDocSet||!this._supportsCrossSite||0!==e.type)return[3,2];this.loading(!0);return[4,this._siteDataSource.isSiteFeatureEnabled(ve.DocumentSetsGuid,e.url)];case 1:t=i.sent();this.loading(!1);this._setCurrentItemClass("");if(!t){s=x.format(g.m,e.title,this.context().isMove?g.A:g.n);this._renderMessageBar(ye.e.error,s);return[2,!1]}this.targetInvalid(!1);i.label=2;case 2:if(!(this._containsDocSet&&1===e.type&&e.docLibId&&e.siteId&&e.webId&&e.url))return[3,4];this.loading(!0);return[4,this._checkTargetLibForDocSets(e.docLibId,e.siteId,e.webId,e.url)];case 3:n=i.sent();this.loading(!1);this._setCurrentItemClass("");if(!n){r=x.format(g.v,e.title,this.context().isMove?g.A:g.n);this._renderMessageBar(ye.e.error,r);return[2,!1]}s=x.format(g.l,this.context().isMove?g.A:g.n,e.title);this._renderMessageBar(ye.e.warning,s);i.label=4;case 4:return[2,this._onItemClick(e)]}})})};t.prototype._onItemClick=function(e){var t,n=this,r=this._engagement;e.focused(!1);this._breadCrumbItems.push(e);this._updateBreadcrumb();this._exitCurrentItemLeft();this._targetIsCrossSite(!!e.isCrossSite);0===e.type?r.logData({name:"MoveCopySelect.SelectSite.Click",isIntentional:!0}):r.logData({name:"MoveCopySelect.SelectLibraryOrFolder.Click",isIntentional:!0});if(null===e.subItems){if(0===e.type||5===e.type&&e.isCrossSite){this.waitingForItemParams.promise=new B.n(function(t,r){n._loadWebDataSource().then(function(r){var i;i=5===e.type?function(e){return r.getDefaultOneDriveLibrary(e)}:function(e){return r.getDocumentLibraries(e)};n._serverDataPromise.debounce(i(e.key)).then(function(r){for(var i=[],o=0;o<r.length;o++){var u={title:r[o].title,key:r[o].target,focused:s.observable(!1),selected:s.observable(!1),url:r[o].customSettingsUrl,type:1,folderIcon:"folder",subItems:null,sections:null,isCrossSite:e.isCrossSite,webId:e.webId,siteId:e.siteId,rootItemType:e.type,remote:r[o].remote,docLibId:r[o].id};i.push(u)}if(1===i.length){var a=i[0];a.title=e.title;n._breadCrumbItems()[n._breadCrumbItems().length-1]=a;n._getItemWithWaiting(a,!1).then(function(){t()}).catch(function(){n._getItemWithWaiting(e,!0).then(function(){t()})})}else{e.subItems=s.observableArray(i);t();n._enterNextItem(e,!1)}},function(r){n._handleGetItemError(r,e);t()})})});this.waitingForItem(!0)}else if(1===e.type||2===e.type||6===e.type||5===e.type)if(6===e.type||e.isMountPointFolder){r.logData({name:"MoveCopySelect.SelectMountpoint.Click",isIntentional:!0});if(e.remoteItem){this.resources.consume(y.e).dispatch(Object(b.e)(function(t){var n=e.remoteItem.ListId,r=e.remoteItem.UniqueId;return t.demandItemFacet(be.e,we.e.serialize({siteUrl:e.remoteItem.SiteUrl,listId:n,uniqueId:r}),{suppressGetItems:!1})})).then(function(t){var r;if(t){var i=t.listFullUrl,o=t.rootFolder,u=n._itemUrlHelper.getUrlParts({path:o,listUrl:i}),a=n._urlDataSource.getKey(((r={}).id=u.serverRelativeItemUrl,r.listurl=u.normalizedListUrl,r));e.remoteItem.ParentFolderUrl=o||u.serverRelativeListUrl;e.remoteItem.ParentKey=a;var f={title:e.title,key:e.key,focused:s.observable(!1),selected:s.observable(!1),url:i,type:6,folderIcon:"folder",subItems:null,sections:null,isCrossSite:!0,webId:e.webId,siteId:e.siteId,rootItemType:e.type,remoteItem:e.remoteItem,oneDriveItem:e.oneDriveItem,remoteWebUrl:t.webAbsoluteUrl};n._getItemWithWaiting(f,!1)}})}else if(e.isMountPointFolder){e.remoteWebUrl=null===(t=e.oneDriveItem)||void 0===t?void 0:t.remoteWebUrl;this._getItemWithWaiting(e,!1).catch(function(){n._getItemWithWaiting(e,!0)})}}else this._getItemWithWaiting(e,!1).catch(function(){n._getItemWithWaiting(e,!0)})}else{this._serverDataPromise.clear();this._enterNextItem(e,!1)}return!1};t.prototype._onBreadCrumbClick=function(e){this.targetInvalid(!1);var t,n=this._engagement;if(e){n.logData({name:"MoveCopySelect.Breadcrumb.Root.Click",isIntentional:!0});if(this._isBreadCrumbRootClickable){t=this._breadCrumbItems.shift();this._breadCrumbItems([t])}else{var r=this._breadCrumbItems.slice(0,2);t=r[1];this._breadCrumbItems(r)}}else{n.logData({name:"MoveCopySelect.Breadcrumb.Click",isIntentional:!0});this._breadCrumbItems.pop();t=this._breadCrumbItems()[this._breadCrumbItems().length-1]}var i=this.getCurrentItem();i.error&&i.error()&&(i.error=null);this._serverDataPromise.isExecuting()?this._serverDataPromise.clear():this._exitCurrentItemRight();this._updateBreadcrumb();this._enterNextItem(t,!0);return!1};t.prototype._onShowMoreClick=function(e){var t=this,n=this._engagement,r=!1,i=function(){r=!0};if(3===e.type){n.logData({name:"MoveCopySelect.ShowMoreSites.Click",isIntentional:!0});e.showMoreFocused(!1);if(this._sitesFolderItem){this._breadCrumbItems.push(this._sitesFolderItem);this._exitCurrentItemLeft();this._enterNextItem(this._sitesFolderItem,!1)}else{e.showMoreLoading(!0);var o={title:this._sitesTitle,key:void 0,focused:s.observable(!1),selected:s.observable(!1),type:4,subItems:null,sections:[{title:g.h,altTitle:g.p,type:0,lastIndex:0,listElement:s.observable(),focusedItem:s.observable(),items:s.observableArray(),showMore:s.observable(!0),showMoreLoading:s.observable(!1),showMoreInfo:s.observable(""),showMoreError:s.observable(""),showMoreFocused:s.observable(!1)},{title:g.F,altTitle:g.I,type:1,lastIndex:0,listElement:s.observable(),focusedItem:s.observable(),items:s.observableArray(),showMore:s.observable(!0),showMoreLoading:s.observable(!1),showMoreInfo:s.observable(""),showMoreError:s.observable(""),showMoreFocused:s.observable(!1)}]},u=new F.e({name:"MoveCopySelect.GetFollowedSites"}),a=new F.e({name:"MoveCopySelect.GetRecentSites"});this._serverDataPromise.debounce(B.n.all([this._getSitesData(o.sections[0],u,i),this._getSitesData(o.sections[1],a,i)])).done(function(n){if(!r)if(o.sections[0].showMoreError()&&o.sections[1].showMoreError()){e.showMoreError(g.q);e.showMore(!1)}else{t._breadCrumbItems.push(o);t._updateBreadcrumb();t._exitCurrentItemLeft();t._sitesFolderItem=o;t._enterNextItem(t._sitesFolderItem,!1)}e.showMoreLoading(!1)})}}else{n.logData({name:"MoveCopySelect.ShowMore.Click",isIntentional:!0,extraData:{Type:e.type}});var f=new F.e({name:"MoveCopySelect.ShowMoreSites"});this._serverDataPromise.debounce(this._getSitesData(e,f,i)).then(function(){if(r){e.showMoreLoading(!1);t._exitCurrentItemRight()}else e.listElement().focus()})}return!1};t.prototype._onUseLocationClick=function(e,t){var n=this,r=this._engagement;this.chooseLocationButtonEnabled(!1);var i=this.getCurrentItem(),s="MoveCopySelect.ChooseLocation",o=void 0!==i.rootItemType?i.rootItemType:i.type,u={ItemCount:this.context().items.length,FolderCount:this._getFolderCount(this.context().items),FileCount:this._getFileCount(this.context().items)};s+=this.context().isMove?".Move":".Copy";var a=this._getRootItem(i.oneDriveItem,"list");a&&!a.list.isDocumentLibrary&&(s+=".List");i.isCrossSite?s+=".CrossSite.Click":s+=0===o?".WithinSite.Click":".InLibrary.Click";r.logData({name:s,isIntentional:!0,extraData:u});if(i.isCrossSite){var f="MoveCopySelect.ChooseLocation";f+=this.context().isMove?".Move":".Copy";if(0!==o||this._isOneDrive)if(0===o&&this._isOneDrive)f+=".ODBToTeamSite.Click";else if(5!==o||this._isOneDrive)if(5===o&&this._isOneDrive)f+=".ODBToODB.Click";else{f+=".UnknownCrossSite.Click";Q.e.logData({name:"MoveCopySelect.ChooseLocation.UnknownCrossSite.Click",message:"rootItemType: "+o})}else f+=".TeamSiteToODB.Click";else f+=".TeamSiteToTeamSite.Click";r.logData({name:f,isIntentional:!0,extraData:u})}!this._initialSitesQosDone&&this._initialSitesQos&&this._initialSitesQos.end({resultType:I.e.ExpectedFailure,resultCode:"Cancelled",extraData:{Type:3}});if(i.webId){var l=i.remoteItem?i.remoteItem.WebId:i.webId;this.context.peek().webId=l}if(i.siteId){var c=i.remoteItem?i.remoteItem.SiteId:i.siteId;this.context.peek().siteId=c}var h=this.context;h.peek().remoteItem=i.remoteItem;var p={context:h,onComplete:this.onComplete,isMove:this.context().isMove,isCheckBoxShown:this.showKeepSharing.peek(),keepSharing:this.showKeepSharing.peek()&&this._shouldKeepSharing.peek(),isCrossSite:i.isCrossSite,containsDocSet:v.e.isActivated("c651985f-c547-4e15-a8ac-7177ac4aad99","09/03/20","Kill using CreateCopyJobs everytime doc set is seleced")?void 0:this._containsDocSet};if(i.remoteItem||i.isMountPointFolder){h.peek().remoteWebUrl=i.remoteWebUrl;var d=i.remoteItem?i.remoteItem.SiteUrl:i.remoteWebUrl;h.peek().isMountPointFolder=i.isMountPointFolder;this._identityDataSource.getSharePointToken(d).then(function(e){h.peek().authToken=e.accessToken;new(n.managed(n._actionMap.MoveCopyAction))(p).execute(t);t.stopPropagation()})}else{new(this.managed(this._actionMap.MoveCopyAction))(p).execute(t);t.stopPropagation()}return!1};t.prototype._getFolderCount=function(e){for(var t=0,n=0;n<e.length;n++)e[n].folder&&t++;return t};t.prototype._getFileCount=function(e){return e.length-this._getFolderCount(e)};t.prototype._getItem=function(e,t,n,r,i,s,o){var u=this,a={parentKey:e,requestAllChildren:!0,ownerId:this._urlDataSource.getOwnerId(e),sortField:r?"ID":"LinkFilename",isAscending:!r,needSchema:!0,expandGroup:!0,ignoreListContext:!0,webId:t,siteId:n,noGroupReplace:!0,remoteItem:i,remoteWebUrl:s||(i?i.SiteUrl:void 0),isMountPointFolder:o};if(Object(Ae.ss)(d.SupportMountPointInMoveCopyPanel)){a.additionalFiltersXml=this._getFiltersXml();a.skipCache=!0;a.needsMountPoint=!0;if(s||i){var f=s||i.SiteUrl;return this._identityDataSource.getSharePointToken(f).then(function(e){a.authToken=e.accessToken;return u._itemProvider.getItem(a)})}return this._itemProvider.getItem(a)}a.filters=this._getFilters();return this._itemProvider.getItem(a)};t.prototype._getItemData=function(e,t,n,r,i,s,o,u,a){return this._getItem(e,t,n,r,o,u,a).then(i,s)};t.prototype._getItemWithWaiting=function(e,t){var n=this,r=e.oneDriveItem&&e.oneDriveItem.remoteItem?e.oneDriveItem.remoteItem:void 0,i=e.oneDriveItem&&e.oneDriveItem.isMountPointFolder;this.waitingForItemParams.promise=this._serverDataPromise.debounce(this._getItemData(this._getParentKey(e),e.webId,e.siteId,t,function(t){1!==e.type&&5!==e.type||(e.oneDriveItem=t.item());n._parseFolderItems(t,e);n._enterNextItem(e,!1)},function(r){if(r&&-2147024860===r.errorCode&&!t){r.retry=!0;return B.n.wrapError(r)}n._handleGetItemError(r,e)},r,e.remoteWebUrl,i));this.waitingForItem(!0);return this.waitingForItemParams.promise};t.prototype._handleGetItemError=function(e,t){if(!B.n.isCanceled(e)){e.status?404===e.status&&(t.error=s.observable(g.g)):0===t.type?t.error=s.observable(g.E):t.error=s.observable(g.b);this._setNextItemClass("");this._setNextItem(t)}};t.prototype._parseFolderItems=function(e,t){t.subItems=s.observableArray();for(var n=e.content().items,r=0;r<n.length;r++){var i=n[r]();i.type===M.e.Folder&&t.subItems.push(i.remoteItem?this._createMountPointItem(i,t):this._createFolderItem(i,t))}};t.prototype._computeShowKeepSharing=function(){var e=Object(Ae.ss)(d.MoveKeepSharing),t=this.fileItem&&this.fileItem.type!==M.e.Folder&&this.fileItem.type!==M.e.OneNote;!this._sharingSectionHelper&&t&&(this._sharingSectionHelper=new(this.managed(pe.e))({item:this.createObservable(this.fileItem)}));var n=this._sharingSectionHelper&&this._sharingSectionHelper.keepSharingHasAccess();return e&&!!(this._targetIsCrossSite()&&t&&this.isSingleItem&&this.context().isMove)&&n};t.prototype._createFolderItem=function(e,t){return{title:e.name,key:e.id,focused:s.observable(!1),selected:s.observable(!1),url:t.url,oneDriveItem:e,type:2,siteIcon:void 0,folderIcon:e.iconName,subItems:null,sections:null,isCrossSite:t.isCrossSite,webId:t.webId,siteId:t.siteId,remote:t.remote,rootItemType:void 0!==t.rootItemType?t.rootItemType:t.type,isMountPointFolder:t.isMountPointFolder||e.isMountPointFolder,remoteWebUrl:e.isMountPointFolder?e.remoteWebUrl:void 0}};t.prototype._createMountPointItem=function(e,t){var n;return{title:e.name,key:e.id,focused:s.observable(!1),selected:s.observable(!1),url:t.url,oneDriveItem:e,type:6,siteIcon:void 0,folderIcon:"linkedfolder",subItems:null,sections:null,isCrossSite:!0,webId:e.remoteItem?e.remoteItem.WebId:void 0,siteId:null===(n=e.remoteItem)||void 0===n?void 0:n.SiteId,remote:t.remote,rootItemType:void 0!==t.rootItemType?t.rootItemType:t.type,remoteItem:e.remoteItem,remoteWebUrl:e.remoteItem?e.remoteItem.SiteUrl:e.remoteWebUrl,isMountPointFolder:t.isMountPointFolder||e.isMountPointFolder}};t.prototype._createContentItem=function(){var e=s.observable(),t={item:s.observable(),className:s.observable(""),element:e,regionElement:s.observable(),listElement:s.observable(),stickyFooterElement:s.observable(),resizeStickyFooter:s.observable(!1),isActive:s.observable(!1),eventGroup:new p.t(e),isEntering:!1};this.addDisposable(t.eventGroup);return t};t.prototype._addAnimationEvents=function(e,t){var n=this;void 0===t&&(t=!1);var r=function(r){if(!(r&&r.target&&r.target.className.indexOf("ms-Checkbox-checkbox")>-1)){var i=e.item.peek();if(t||e.isEntering){e.isEntering=!1;if(i.subItems)0===i.subItems.peek().length?n.useLocationFocused(!0):n.selectionModel.selectItem(i.subItems.peek()[0]);else if(!v.e.isActivated("4B0170CC-0732-4639-A698-8C9F2FE93415","02/03/2021","Set focus when current item with no subItems defined in Move Copy Panel")&&i.sections&&i.sections[0]&&i.sections[0].items){i.sections[0].items.peek()[0].focused(!0)}}else e.isActive(!1)}};e.element()?(function(){if(t)r();else{e.eventGroup.on(e.element(),"transitionEnd",r);e.eventGroup.on(e.element(),"webkitTransitionEnd",r)}})():this.async.setTimeout(function(){n._addAnimationEvents(e,t)},10)};t.prototype._getSitesData=function(e,t,n){e.showMoreLoading(!0);var r,i=function(n){t.end({resultType:I.e.Success,extraData:{Length:n.length,Type:e.type}});e.lastIndex+=n.length;0===n.length&&0===e.lastIndex&&(0===e.type?e.showMoreInfo(g.O):e.showMoreInfo(g.S));for(var r=0;r<n.length;r++){var i={title:n[r].title,key:n[r].serverRelativeUrl,focused:s.observable(!1),selected:s.observable(!1),siteIcon:{iconUrl:n[r].icon,color:n[r].color,acronym:n[r].acronym},folderIcon:void 0,type:0,subItems:null,sections:null,isCrossSite:!0,webId:n[r].itemReference&&n[r].itemReference.WebId,siteId:n[r].itemReference&&n[r].itemReference.SiteId};e.items.push(i)}5!==n.length&&e.showMore(!1);e.showMoreLoading(!1)},o=function(r){if(B.n.isCanceled(r)){t.end({resultType:I.e.ExpectedFailure,resultCode:"Cancelled",extraData:{Type:e.type}});n&&n()}else{var i=!1;if(0===e.type)e.showMoreError(g.w);else if(1===e.type){if(500011===(r.responseData&&r.responseData.ErrorCode)){e.showMoreInfo(g.M);i=!0}else e.showMoreError(g.S)}else e.showMoreError(g.x);e.showMoreLoading(!1);i?t.end({resultType:I.e.ExpectedFailure,extraData:{Type:e.type}}):t.end({resultType:I.e.Failure,extraData:{Type:e.type}});e.showMore(!1)}};switch(e.type){case 0:r=this._loadSitesDataSource().then(function(t){return t.getFollowedSites(e.lastIndex,5).then(i,o)});break;case 1:r=this._loadSitesDataSource().then(function(t){return t.getRecentSites(e.lastIndex,5).then(i,o)});break;default:Q.e.logData({name:"FolderSelect.GetSites.InvalidSectionType",message:"Invalid section type:"+e.type.toString()})}return r};t.prototype._getInitialSitesData=function(e){var t=this;e.showMoreLoading(!0);return this._itemProvider.getItem({parentKey:this._urlDataSource.getRootItemKey(Y.e.Subsites)}).then(function(n){var r=0;if(v.e.isActivated("2f571e30-4a81-4672-94f2-368e4f91e59a","09/30/2020","Use Sites Length in Move Copy Panel"))for(var i=n.content().groupings[0].itemGroups,o=0;o<i.length;o++)r+=i[o].count;else r=n.content().items.length;e.lastIndex+=r;if(0===r&&0===e.lastIndex){e.showMoreInfo(g.O);e.showMoreLoading(!1);t._initialSitesQos.end({resultType:I.e.Success,extraData:{Length:r,Type:e.type}});t._initialSitesQosDone=!0;return null}for(var u=[],a={},f=0;f<r;f++){var l=t.peekUnwrapObservable(n.content().items[f]);if(l){var c=t._itemUrlHelper.getItemUrlParts(l.key),h=c.fullItemUrl&&c.fullItemUrl.replace(/\/$/,"");if(t._isOneDrive||h!==t._siteAbsoluteUrl){var p={title:l.name,key:c.fullItemUrl,focused:s.observable(!1),selected:s.observable(!1),siteIcon:{iconUrl:l.subsite.icon,color:l.subsite.color,acronym:l.subsite.acronym},folderIcon:null,type:0,subItems:null,sections:null,isCrossSite:!0,webId:l.subsite.id,siteId:l.subsite.itemReference&&l.subsite.itemReference.SiteId,url:c.fullItemUrl};if(!a[c.fullItemUrl]){a[c.fullItemUrl]=!0;u.push(p)}}}}if(t._isOneDrive){u=u.slice(0,8);e.items(u);e.showMoreLoading(!1)}t._initialSitesQos.end({resultType:I.e.Success,extraData:{Length:r,Type:e.type}});t._initialSitesQosDone=!0;return u},function(n){B.n.isCanceled(n)?t._initialSitesQos.end({resultType:I.e.ExpectedFailure,resultCode:"Cancelled",extraData:{Type:e.type}}):t._initialSitesQos.end({resultType:I.e.Failure,extraData:{Type:e.type}});t._initialSitesQosDone=!0;e.showMoreError(g.x);e.showMoreLoading(!1);return null})};t.prototype._getCurrentSiteData=function(e){var t={title:this._siteTitle,key:this._siteAbsoluteUrl,focused:s.observable(!1),selected:s.observable(!1),siteIcon:{iconUrl:"_layouts/15/images/siteicon.png"===this._siteLogoUrl?"":this._siteLogoUrl},folderIcon:null,type:0,subItems:null,sections:null,isCrossSite:!1,webId:this._webId,siteId:this._siteId};return this._acronymDataSource.getAcronymData(this._siteTitle).then(function(n){e.end({resultType:I.e.Success});t.siteIcon.color=n.color;t.siteIcon.acronym=n.acronym;return t},function(t){e.end({resultType:I.e.Failure});return null})};t.prototype._getHasMultipleDocumentLibraries=function(e){var t=this;return this._loadWebDataSource().then(function(n){return n.getDocumentLibraries(t._siteAbsoluteUrl).then(function(t){e.end({resultType:I.e.Success});return t.length>1})},function(t){e.end({resultType:I.e.Failure});return!0})};t.prototype._setCurrentItem=function(e,t){void 0===t&&(t=!1);var n;(n=this._itemOneUsedLast?this.itemTwo:this.itemOne).item(e);n.isActive(!0);this._addAnimationEvents(n,t)};t.prototype._setNextItem=function(e){var t,n,r=this;this._updateContextWithCurrentItem(e);if(this._itemOneUsedLast){t=this.itemOne;n=this.itemTwo}else{t=this.itemTwo;n=this.itemOne}this._itemOneUsedLast=!this._itemOneUsedLast;t.item(e);t.isActive(!0);n.isActive(!1);e.error||(t.isEntering=!0);this._addAnimationEvents(t);this.async.setTimeout(function(){r._setElementLeft(t.element(),0)},0)};t.prototype._setNextItemClass=function(e){this._itemOneUsedLast?this.itemOne.className(e):this.itemTwo.className(e)};t.prototype._setCurrentItemClass=function(e){this._itemOneUsedLast?this.itemTwo.className(e):this.itemOne.className(e)};t.prototype._setCurrentItemLeft=function(e){var t,n=(t=this._itemOneUsedLast?this.itemTwo.element():this.itemOne.element()).getBoundingClientRect().width+40;(e&&!H.e.isRightToLeft||!e&&H.e.isRightToLeft)&&(n=-n);this._setElementLeft(t,n)};t.prototype._setElementLeft=function(e,t){H.e.isRightToLeft?e.style.right=t+"px":e.style.left=t+"px"};t.prototype._exitCurrentItemLeft=function(){this._setCurrentItemLeft(!0)};t.prototype._exitCurrentItemRight=function(){this._setCurrentItemLeft(!1)};t.prototype._enterNextItem=function(e,t){t&&!H.e.isRightToLeft||!t&&H.e.isRightToLeft?this._setNextItemClass("od-FolderSelect-itemEnterLeft"):this._setNextItemClass("od-FolderSelect-itemEnterRight");this._setNextItem(e)};t.prototype._updateBreadcrumb=function(){this.hasBackToRootButton(this._breadCrumbItems().length>2);this.isParentBreadCrumbClickable()?this.parentBreadCrumbClass("od-FolderSelect-clickableCrumb"):this._isBreadCrumbRootClickable||this.parentBreadCrumbClass("")};t.prototype._updateContextWithCurrentItem=function(e){this.context().targetKey=this._getParentKey(e);this.context().targetId=e.key};t.prototype._getLocalLibraryTitle=function(e){var t=this._pageContext.isSiteAdmin&&this._isOneDrive;e&&(t=e===this._siteAbsoluteUrl);return this._isOneDrive?t?g.H:x.format(g.P,this._pageContext.webTitle):this._supportsCrossSite?g.z:this._listTitle};t.prototype._getFilters=function(){return this._moveCopyCapabilities.supportsMoveCopyFilterParams?{FilterField1:"FSObjType",FilterValue1:"1"}:{}};t.prototype._getFiltersXml=function(){return this._moveCopyCapabilities.supportsMoveCopyFilterParams?'<Or><Eq><FieldRef Name="FSObjType"/><Value Type="Lookup">1</Value></Eq><Eq><FieldRef Name="ProgId"/><Value Type="Text">AddToOneDrive.MountPoint</Value></Eq></Or>':""};t.prototype._getParentKey=function(e){var t,n=e.key,r=e.url,i=this._itemUrlHelper.getUrlParts({path:n,listUrl:r});return this._urlDataSource.getKey(((t={}).id=i.serverRelativeItemUrl,t.listurl=i.normalizedListUrl,t))};t.prototype._getSitesTitle=function(){var e=this.createObservable();this.trackPromise(this._suiteNavProvider.loadData().then(function(e){return e.CompanyDisplayName})).done(function(t){e(t)});return this.createPureComputed(function(){return e()||g.W})};return t})(T.t),Me=L.e({tagName:"ms-folder-select",template:'<div class="od-FolderSelect-panel"><div class="od-FolderSelect-region"><h1 class="od-FolderSelect-title" data-bind="text:moveCopyText"></h1>\x3c!--ko if:targetInvalid--\x3e<div class="od-FolderSelect-invalidTarget"></div>\x3c!--/ko--\x3e<div class="od-FolderSelect-title-fileInfo">\x3c!--ko if:isSingleItem--\x3e\x3c!--ko component:{name:\'ms-fileName-with-icon\',params:{oneDriveItem:fileItem}}--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div><div class="od-FolderSelect-breadCrumbContainer"><span class="od-FolderSelect-breadCrumbRootIcon od-FolderSelect-clickableCrumb" role="button" data-bind="click:onBreadCrumbRootClick,keyboard:{mappings:{Enter:onBreadCrumbRootClick,Space:onBreadCrumbRootClick}},style:{display:hasBackToRootButton()?\'\':\'none\'},attr:{title:placesAltText,tabindex:hasBackToRootButton()?0:-1,\'aria-label\':placesAltText}"><i class="ms-Icon ms-Icon--DoubleChevronLeft" data-bind="icon:true"></i></span><span class="od-FolderSelect-breadCrumbItem ms-fontWeight-semilight" role="button" data-bind="text:parentFolderName,class:parentBreadCrumbClass,click:onBreadCrumbParentClick,keyboard:{mappings:{Enter:onBreadCrumbParentClick,Space:onBreadCrumbParentClick}},style:{display:parentFolderName()?\'\':\'none\'},attr:{title:parentFolderName,tabindex:isParentBreadCrumbClickable()?0:-1,\'aria-label\':parentFolderName}"></span><i class="od-FolderSelect-breadCrumbIcon ms-Icon ms-Icon--ChevronRight" data-bind="style:{display:parentFolderName()?\'\':\'none\'}" aria-hidden="true"></i><span class="od-FolderSelect-breadCrumbItem ms-fontWeight-semibold" data-bind="text:currentFolderName,attr:{title:currentFolderName}"></span></div><div class="od-FolderSelect-ruledLine" aria-hidden="true"></div>\x3c!--ko if:loading--\x3e<div class="od-FolderSelect-loading" data-bind="component:{name:loadingSpinnerTagName}"></div>\x3c!--/ko--\x3e\x3c!--ko ifnot:loading--\x3e\x3c!--ko if:itemOne.isActive()--\x3e<div data-bind="automationType:\'FolderSelectContent\',template:{name:\'od-folder-select-content\',data:itemOne,afterRender:itemOne.resizeStickyFooter.bind(true)}"></div>\x3c!--/ko--\x3e\x3c!--ko if:itemTwo.isActive()--\x3e<div data-bind="automationType:\'FolderSelectContent\',template:{name:\'od-folder-select-content\',data:itemTwo,afterRender:itemTwo.resizeStickyFooter.bind(true)}"></div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div>\x3c!--ko if:waitingForItem--\x3e<div class="od-FolderSelect-waitingForData" data-bind="component:{name:stillSpinningTagName,params:waitingForItemParams}"></div>\x3c!--/ko--\x3e</div>',viewModel:Oe,synchronous:!0});L.t("od-folder-select-content",'<div class="od-FolderSelect-itemAnimation" data-bind="class:className,element:element">\x3c!--ko if:item().error--\x3e<div class="od-folderSelect-itemError od-folderSelect-itemErrorPadding" aria-live="assertive" data-bind="text:item().error"></div>\x3c!--/ko--\x3e\x3c!--ko ifnot:item().error--\x3e\x3c!--ko if:item().sections--\x3e<div class="od-FolderSelect-itemsRegion" data-bind="element:regionElement"><div class="od-FolderSelect-sectionContainer" data-bind="foreach:item().sections">\x3c!--ko if:title--\x3e<div class="od-FolderSelect-sectionHeader" data-bind="text:title"></div>\x3c!--/ko--\x3e\x3c!--ko if:items().length>0--\x3e<div class="od-FolderSelect-itemsContainer" tabindex="0" role="list" data-bind="foreach:items,element:listElement,attr:{tabindex:0,\'aria-label\':altTitle},selection:{data:items,mode:\'single\',direction:\'vertical\',focused:focusedItem,selectFirstItemOnActivate:true,clearSelectionOnRemoval:true}"><div class="od-FolderSelect-itemWrapper"><div class="od-FolderSelect-itemContainer od-FolderSelect-clickable" role="listitem" data-bind="click:$component.onItemClick.bind($data),keyboard:{mappings:{Enter:$component.onKeyEnter,Space:$component.onKeyEnter}},css:{\'is-focused\':focused},attr:{tabindex:focused()||selected()?0:-1,\'aria-label\':title},hasFocus:focused">\x3c!--ko if:$component.useOneDriveBrandIcon--\x3e<img role="presentation" class="ms-Icon ms-Icon--OneDrive" data-bind="attr:{src:$component.oneDriveBrandIcon},style:{display:$component.isOneDrive($data)?\'\':\'none\'}">\x3c!--/ko--\x3e\x3c!--ko ifnot:$component.useOneDriveBrandIcon--\x3e<i role="presentation" class="ms-Icon ms-Icon--OneDrive" data-bind="icon:true,style:{display:$component.isOneDrive($data)?\'\':\'none\'}"></i>\x3c!--/ko--\x3e\x3c!--ko if:$component.isSite($data)--\x3e<span class="od-FolderSelect-siteIcon" data-bind="component:{name:$component.siteIconTagName,params:siteIcon}"></span>\x3c!--/ko--\x3e\x3c!--ko if:$component.isLibraryOrFolder($data)--\x3e<span class="od-FolderSelect-folderIcon" data-bind="component:{name:$component.fileTypeIconTagName,params:{iconName:folderIcon,desiredSize:16}}"></span>\x3c!--/ko--\x3e<span class="od-FolderSelect-itemTitle" data-bind="text:title"></span></div></div></div>\x3c!--/ko--\x3e\x3c!--ko if:showMoreInfo--\x3e<div class="od-folderSelect-itemInfo" aria-live="polite" data-bind="text:showMoreInfo"></div>\x3c!--/ko--\x3e\x3c!--ko if:showMoreError--\x3e<div class="od-folderSelect-itemError" aria-live="assertive" data-bind="text:showMoreError"></div>\x3c!--/ko--\x3e\x3c!--ko if:showMore--\x3e<div>\x3c!--ko ifnot:showMoreLoading()--\x3e<div class="od-FolderSelect-itemWrapper"><a class="od-FolderSelect-showMore od-folderSelect-showMoreExtra od-FolderSelect-clickable" role="button" tabindex="0" data-bind="click:$component.onShowMoreClick.bind($data),keyboard:{mappings:{Enter:$component.onShowMoreClick.bind($data),Space:$component.onShowMoreClick.bind($data)}},css:{\'is-focused\':showMoreFocused},hasFocus:showMoreFocused,text:$component.getShowMoreText($data),automationType:\'FolderSelectShowMoreSites\'"></a></div>\x3c!--/ko--\x3e\x3c!--ko if:showMoreLoading--\x3e<div class="od-FolderSelect-showMoreLoading" aria-busy="true" data-bind="component:{name:$component.loadingSpinnerTagName,params:{loadingText:\'\'}}"></div>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e</div></div>\x3c!--/ko--\x3e\x3c!--ko if:item().subItems--\x3e<div class="od-FolderSelect-itemsRegion" data-bind="element:regionElement">\x3c!--ko if:item().subItems().length>0--\x3e<div class="od-FolderSelect-itemsContainer" role="list" data-bind="foreach:item().subItems,element:listElement,selection:{data:item().subItems,mode:\'single\',direction:\'vertical\',focused:$component.focusedItem,selectionModel:$component.selectionModel,selectFirstItemOnActivate:true,clearSelectionOnRemoval:true},attr:{\'aria-label\':$component.getListType(item()),tabindex:$component.selectionModel.selection().length>0?-1:0},css:{\'od-FolderSelect-addBottomMargin\':!$component.showAddFolder()}">\x3c!--ko if:$index()===0--\x3e<div class="od-FolderSelect-destinationHeader" data-bind="text:$component.chooseDestination"></div>\x3c!--/ko--\x3e<div class="od-FolderSelect-itemWrapper"><div class="od-FolderSelect-itemContainer od-FolderSelect-clickable" role="listitem" data-bind="click:$component.onItemClick.bind($data),keyboard:{mappings:{Enter:$component.onKeyEnter,Space:$component.onKeyEnter}},css:{\'is-focused\':focused,\'is-selected\':selected},attr:{tabindex:focused()||selected()?0:-1,\'aria-label\':title},hasFocus:focused"><span class="od-FolderSelect-folderIcon" data-bind="component:{name:$component.fileTypeIconTagName,params:{iconName:folderIcon,desiredSize:16}}"></span><span class="od-FolderSelect-itemTitle" data-bind="text:title"></span></div></div></div>\x3c!--/ko--\x3e\x3c!--ko if:$component.showAddFolder()--\x3e<div class="od-FolderSelect-addFolder" data-bind="css:{\'od-FolderSelect-addTopMargin\':item().subItems().length===0}"><div class="od-FolderSelect-itemWrapper" data-bind="css:{\'od-FolderSelect-hidden\':!$component.newFolderActive()}"><div class="od-FolderSelect-addFolderContainer od-FolderSelect-clickable" data-bind="component:{name:$component.inlineCreateFolderTagName,params:{item:$component.getCurrentItem().oneDriveItem,newFolderItem:$component.newFolderItem,focused:$component.addFolderFocused,newItemFocused:$component.newFolderItemFocused,isActive:$component.newFolderActive,resources:$component.legacyStoreResourceScope}}"></div></div></div>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e<div class="od-FolderSelect-stickyFooter" data-bind="stickyFooter:{scrollableElement:regionElement,forceResize:resizeStickyFooter}">\x3c!--ko if:$component.showBottomLine(item())--\x3e<div class="od-FolderSelect-ruledLine" role="separator" aria-hidden="true"></div>\x3c!--/ko--\x3e\x3c!--ko if:$component.getStatusText(item())--\x3e<div class="od-FolderSelect-statusLabel"><span role="status" data-bind="text:$component.getStatusText(item())"></span></div>\x3c!--/ko--\x3e\x3c!--ko if:$component.isLibraryOrFolderOrOneDrive(item())--\x3e<div class="od-FolderSelect-actionContainer">\x3c!--ko if:$component.showKeepSharing--\x3e<div class="od-FolderSelect-checkBox"><div class="od-FolderSelect-keepSharing" data-bind="react:{componentType:$component.keepSharingComponent,props:$component.keepSharingProps}"></div></div>\x3c!--/ko--\x3e<button class="od-Button od-Button--primary" data-bind="click:$component.onUseLocationClick,enable:$component.chooseLocationButtonEnabled,automationType:\'FolderSelectUseLocation\',delayedHasFocus:$component.useLocationFocused,css:{\'od-Button-withCheckBox\':$component.showKeepSharing},attr:{\'aria-label\':$component.getChooseLocationAccText(item())}"><span class="od-Button-label" data-bind="text:$component.chooseLocationText"></span></button></div>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e</div>');t.default=Me}}]);