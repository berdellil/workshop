(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([[542],{1972:function(e,t,n){"use strict";n.d(t,"u",function(){return a});n.d(t,"e",function(){return f});n.d(t,"a",function(){return l});n.d(t,"f",function(){return c});n.d(t,"n",function(){return h});n.d(t,"s",function(){return p});n.d(t,"d",function(){return d});n.d(t,"o",function(){return v});n.d(t,"i",function(){return m});n.d(t,"r",function(){return g});n.d(t,"t",function(){return y});n.d(t,"v",function(){return b});n.d(t,"h",function(){return w});n.d(t,"g",function(){return E});n.d(t,"p",function(){return S});n.d(t,"m",function(){return x});n.d(t,"S",function(){return T});n.d(t,"c",function(){return N});n.d(t,"y",function(){return C});n.d(t,"b",function(){return k});n.d(t,"l",function(){return L});n.d(t,"E",function(){return A});n.d(t,"w",function(){return O});var r=n(163),i=n(67),s=n(536),o=n(112),u=n(245),a="_spAppBarNewsSitesCachedData",f="_spAppBarHomeClientContext",l=36e5,c=144e5,h=9e5,p=36e5,d=function(){return u.n.isFeatureEnabled({ODB:60547})},v="SPHomeWeb:news",m="SPHomeWeb:sites/feed",g="SPHomeWeb:sites/followed",y=30,b=function(){return i.t.isActivated("05b7fa9c-b894-4890-baa4-8276069fb1a0","8/26/2021","error states on token fetch error")},w=function(e,t,n,r,s,o,u,a,f){if(e)return t({cachingStrategy:2,spHomeCachedItem:{cacheContext:null,cacheValue:""},spHomeClientContext:{Urls:[""],Token:{AccessToken:"",ExpiresOn:""}},returnStatistics:!0}).then(function(e){var t,s;if(e){if(i.t.isActivated("bfe78ae3-ed54-4f77-b63b-e91d3ae8c0ff","11/17/2020","Only send data to parent if exists")||(null===(s=null===(t=e)||void 0===t?void 0:t.data)||void 0===s?void 0:s.Items)&&e.data.Items.length>0){f(e,r);return S(e.cacheStats.lastModified,n)?{data:a(e.data),stale:!1,date:e.cacheStats.lastModified}:{data:a(e.data),stale:!0,date:e.cacheStats.lastModified}}return{data:[],stale:!0,date:0}}return{data:[],stale:!0,date:0}});var l=o&&o.find(function(e){return e.Key===u}),c=null;l&&s?c=t({cachingStrategy:1,spHomeCachedItem:l.Value,spHomeClientContext:s,returnStatistics:!0,cacheTimeoutTime:n}):s&&s.Token&&(c=t({cachingStrategy:1,spHomeCachedItem:{cacheContext:null,cacheValue:""},spHomeClientContext:s,returnStatistics:!0,cacheTimeoutTime:n}));return c?c.then(function(e){var t,n;if(i.t.isActivated("bfe78ae3-ed54-4f77-b63b-e91d3ae8c0ff","11/17/2020","Only send data to parent if exists")){f(e,r);return{data:a(e.data),stale:!1,date:Date.now()}}if((null===(n=null===(t=e)||void 0===t?void 0:t.data)||void 0===n?void 0:n.Items)&&e.data.Items.length>0){f(e,r);return{data:a(e.data),stale:!1,date:Date.now()}}return{data:[],stale:!0,date:0}}):Promise.resolve({data:[],stale:!0,date:0})},E=function(e,t){try{if(e){var n=JSON.parse(e);if(n)return t(n)}}catch(e){}},S=function(e,t){return Date.now()-e<=t},x=function(e){return function(t){1!==t.button&&2!==t.button||r.e.logData({name:e})}},T=function(e){return e.which===Object(s.t)(o.e.right)},N=function(e){return function(t){var n;if(t.which===o.e.enter){null===(n=document.getElementById(e))||void 0===n||n.click()}}},C=function(e){return d()?e.map(function(e){return{author:e.createdBy,description:e.description,publishDate:new Date(e.createdDateTime),title:e.title,url:e.webUrl,isAuthoritative:!1,site:{id:e.sharepointIds.siteId,serverRelativeUrl:e.parentReference.path,title:e.parentReference.siteTitle,webTemplateId:0},image:e.thumbnails[0].source.url}}).sort(function(e,t){return t.publishDate.getTime()-e.publishDate.getTime()}):e.Items.map(function(e){var t=e.Author,n=e.Description,r=e.ImageUrl,i=e.Title,s=e.IsAuthoritativeNews,o=e.OriginalUrl||e.Url,u=new Date(e.FirstPublishedDate),a=e.Site,f=a.ItemReference;return{author:t,description:n,isAuthoritative:s,publishDate:u,site:{id:f.WebId,siteCollectionId:f.SiteId,title:a.Title,isExternal:a.IsExternalContent,serverRelativeUrl:a.OriginalUrl||a.Url,icon:a.BannerImageUrl,color:a.BannerColor,acronym:a.Acronym,indexId:f.IndexId,itemReference:f,weight:a.Weight||0,pinOrder:a.PinOrder,webTemplateId:0,allowPinning:!!f&&!!f.SiteId&&!!f.WebId},title:i,url:o,image:r}})},k=function(e){return e.Items.map(function(e){var t=e.ItemReference,n=t.WebId,r=t.SiteId,i=t.IndexId,s=e.Title,o=e.IsExternalContent,u=e.ItemReference,a=e.BannerImageUrl,f=e.BannerColor,l=e.Acronym,c=e.Weight,h=e.PinOrder,p=e.WebTemplate;return{id:n,siteCollectionId:r,title:s,isExternal:o,serverRelativeUrl:e.OriginalUrl||e.Url,icon:a,color:f,acronym:l,indexId:i,itemReference:u,weight:c||0,pinOrder:h,allowPinning:!!u&&!!u.SiteId&&!!u.WebId,webTemplateId:0,WebTemplate:p}})},L=function(e,t,n,r){var i=(r?t.filter(function(e){return e.serverRelativeUrl!==r}):t).slice(0,n);return[e.filter(function(e){return r?e.serverRelativeUrl!==r:i.reduce(function(t,n){return t&&n.serverRelativeUrl!==e.serverRelativeUrl},!0)}),i]},A=function(){return i.t.isActivated("5f63801e-33ab-4a4f-b625-bf3d487f6798","4/21/2021","Teams panel should stop using post messaging for routing")};function O(e,t){var n,r;if(e&&t){if(e.name)this.componentData[t]=e;else{var i=this.componentData[t];if(null===(r=null===(n=i)||void 0===n?void 0:n.cacheStats)||void 0===r?void 0:r.lastModified){if(e.cacheStats.lastModified>i.cacheStats.lastModified)this.componentData[t]=e;else if(isNaN(e.cacheStats.lastModified)){e.cacheStats.lastModified=Date.now();this.componentData[t]=e}}else this.componentData[t]=e}}}},2382:function(e,t,n){"use strict";n.d(t,"t",function(){return r});n.d(t,"r",function(){return i});n.d(t,"n",function(){return o});n.d(t,"e",function(){return u});var r=function(e,t){return e.replace("spappbarwebpack/spappbarwebpack.js","odsp-media/images/spappbar/"+t)},i=function(e,t){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var n=new RegExp(e+"=([^&]*)").exec(t);return null===n?"":decodeURIComponent(n[1].replace(/\+/g," "))},s={"ftp:":"21","gopher:":"70","http:":"80","https:":"443","ws:":"80","wss:":"443"},o=function(e){var t=document.createElement("a");t.href=e;var n=t.hostname,r=t.origin,i=t.port,o=t.protocol;return r||(s.hasOwnProperty(o)?i&&s[o]!==i?o+"//"+n+":"+i:o+"//"+n:"null")},u=function(e,t,n){return e<768?"lists"===n?3:t?10:5:e<1024?"lists"===n?9:t?15:10:"lists"===n?14:t?20:15}},2804:function(e,t,n){"use strict";n.d(t,"e",function(){return o});var r=n(0),i=n(69),s=n(477),o=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,{dataSourceName:"SPHomeDataSource",id:"SPHomeDataSource"},{pageContext:t})||this;n.isMicroserviceToken=function(e){return!!e.access_token};n._isDataSourceParam=function(e){return!!e.spHomeClientContext};n._spHomeCacheKey="spHome_"+t.aadUserId;return n}t.prototype.getFrequentSites=function(e,t,n,r,i,s,o,u){void 0===n&&(n=!0);var a,f,l;if(this._isDataSourceParam(e)){var c=e;f=c.spHomeClientContext;t=c.spHomeCachedItem;s=c.returnStatistics;o=c.cachingStrategy;u=c.cacheTimeoutTime}else{f=e;o=0;r?o=3:i&&(o=2)}l=(null===(a=f)||void 0===a?void 0:a.Urls)&&f.Urls[0]?f.Urls[0]+"/api/v1/sites/feed?start=0&count=30&acronyms=true":"";return this.getSPHomeData({spHomeClientContext:f,spHomeSitesCachedData:t,url:l,qosName:"spAppBarGetFrequentSites",cacheRequestKey:this._spHomeCacheKey+"frequent",returnStatistics:!!s,cachingStrategy:o,cacheTimeoutTime:u})};t.prototype.getFollowedSites=function(e,t,n,r,i,s,o,u){void 0===n&&(n=!0);var a,f,l;if(this._isDataSourceParam(e)){var c=e;f=c.spHomeClientContext;t=c.spHomeCachedItem;s=c.returnStatistics;o=c.cachingStrategy;u=c.cacheTimeoutTime}else{f=e;o=0;r?o=3:i&&(o=2)}l=(null===(a=f)||void 0===a?void 0:a.Urls)&&f.Urls[0]?f.Urls[0]+"/api/v1/sites/followed?mostRecentFirst=true&start=0&count=100&fillSiteData=true&fillSiteCount=10":"";return this.getSPHomeData({spHomeClientContext:f,spHomeSitesCachedData:t,url:l,qosName:"spAppBarGetFollowedSites",cacheRequestKey:this._spHomeCacheKey+"followed",returnStatistics:!!s,cachingStrategy:o,cacheTimeoutTime:u})};t.prototype.getNews=function(e,t,n,r,i,s,o,u){void 0===n&&(n=!0);var a,f,l;if(this._isDataSourceParam(e)){var c=e;f=c.spHomeClientContext;t=c.spHomeCachedItem;s=c.returnStatistics;o=c.cachingStrategy;u=c.cacheTimeoutTime}else{f=e;o=0;r?o=3:i&&(o=2)}l=(null===(a=f)||void 0===a?void 0:a.Urls)&&f.Urls[0]?f.Urls[0]+"/api/v1/news?start=0&count=30":"";return this.getSPHomeData({spHomeClientContext:f,spHomeSitesCachedData:t,url:l,qosName:"spAppBarGetNews",cacheRequestKey:this._spHomeCacheKey+"news",returnStatistics:!!s,cachingStrategy:o,cacheTimeoutTime:u})};t.prototype.getHomeContext=function(){var e={url:this._pageContext.webAbsoluteUrl+"/_api/sphomeservice/context?$expand=Token,Payload",qosName:"spAppBarGetSPHomeToken",method:"GET",additionalHeaders:{accept:"application/json","SPHome-ClientType":"WebAppBar","Service-Worker-Navigation-Preload":"true"},cachingStrategy:3,cacheRequestKey:this._spHomeCacheKey+"token"};return this.getDataUtilizingPersistentCache(e)};t.prototype.shouldShowPostNewsTip=function(){return this.getDataUtilizingPersistentCache({url:this._pageContext.webAbsoluteUrl+"/_api/sitepages/pages/feed?promotedstate=2&published=true&$top=3",qosName:"GetFeedCount",method:"GET",cachingStrategy:3,parseResponse:function(e){var t,n,r;try{return(null===(r=null===(n=null===(t=JSON.parse(e))||void 0===t?void 0:t.d)||void 0===n?void 0:n.results)||void 0===r?void 0:r.length)<2}catch(e){return!0}}})};t.prototype.getSPHomeData=function(e){var t=e.cachingStrategy,n={url:e.url,qosName:e.qosName,method:"GET",additionalHeaders:{"sphome-apicontext":e.spHomeClientContext.Payload,"sphome-cachecontext":e.spHomeSitesCachedData.cacheContext,"sphome-clienttype":"WebAppBar"},cacheRequestKey:e.cacheRequestKey,cachingStrategy:t,returnStatistics:e.returnStatistics},r=e.spHomeClientContext.Token;r&&(this.isMicroserviceToken(r)?n.authToken=r.access_token:n.authToken=r.AccessToken);e.url&&0!==e.url.length||(n.getData=function(){return i.n.resolve()});e.cacheTimeoutTime&&(n.cacheTimeoutTime=e.cacheTimeoutTime);return this.getDataUtilizingPersistentCache(n)};return t})(s.e)},3023:function(e,t,n){"use strict";n.d(t,"e",function(){return u});var r=n(0),i=n(69),s=n(477),o=n(53),u=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,{dataSourceName:"SharePointDataSource",id:"SharePointDataSource"},{pageContext:t})||this;n._isCachedResultWithStatistic=function(e){return!!e.cacheStats};n._parseResponse=function(e,t){var i,s,o=!1;if(n._isCachedResultWithStatistic(e)){i=e.data;o=!0}else i=e;s=t(i);return o?Object(r.__assign)(Object(r.__assign)({},e),{data:s}):s};n._cacheKey="sharepointAppBar_"+t.aadUserId;n.pageContext=t;return n}t.prototype.canCreatePage=function(e){var t=this;return this.getDataUtilizingPersistentCache({getUrl:function(){return e.siteUrl+"/_api/sitepages/cancreatepage"},qosName:"canCreatePage",method:"GET",noRedirect:!0,cacheRequestKey:this._cacheKey+"_canCreatePage_"+e.siteCache,cachingStrategy:e.cachingStrategy,cacheTimeoutTime:e.cacheTimeoutTime,returnStatistics:e.returnStatistics}).then(function(e){return t._parseResponse(e,function(e){return!(!e||!e.d)&&e.d.CanCreatePage})})};t.prototype.canCreatePromotedPage=function(e){var t=this;return this.getDataUtilizingPersistentCache({getUrl:function(){return e.siteUrl+"/_api/sitepages/cancreatepromotedpage"},qosName:"canCreatePromotedPage",method:"GET",noRedirect:!0,cacheRequestKey:this._cacheKey+"_canCreatePromotedPage_"+e.siteCache,cachingStrategy:e.cachingStrategy,cacheTimeoutTime:e.cacheTimeoutTime,returnStatistics:e.returnStatistics}).then(function(e){return t._parseResponse(e,function(e){return!(!e||!e.d)&&e.d.CanCreatePromotedPage})})};t.prototype.getRecentLists=function(e){var t=this;return this.getDataUtilizingPersistentCache({url:this.pageContext.webAbsoluteUrl+"/_api/sp.RecentListProxy.GetRecentListsProxy/",qosName:"getRecentLists",method:"GET",noRedirect:!0,cacheRequestKey:this._cacheKey+"_getRecentLists",cachingStrategy:e.cachingStrategy,cacheTimeoutTime:e.cacheTimeoutTime,returnStatistics:e.returnStatistics}).then(function(e){return e?t._parseResponse(e,function(e){var t,n;return(null===(n=null===(t=e)||void 0===t?void 0:t.value)||void 0===n?void 0:n.length)>0?e.value.map(function(e){var t=e.color,n=e.icon,r=e.listId,i=e.listUrl,s=e.listTitle,o=e.siteId,u=e.siteTitle,a=e.siteUrl;return{listColor:Number(t),listIcon:Number(n),listId:r,listUrl:i,listTitle:s,siteId:o,siteTitle:u,siteUrl:a}}):[]}):[]})};t.prototype.getFavoriteLists=function(e){var t=this;return this.getDataUtilizingPersistentCache({url:this.pageContext.webAbsoluteUrl+"/_api/SP.FavoriteLists.GetListsBy",qosName:"getFavoriteLists",method:"GET",noRedirect:!0,cacheRequestKey:this._cacheKey+"_getFavoriteLists",cachingStrategy:e.cachingStrategy,cacheTimeoutTime:e.cacheTimeoutTime,returnStatistics:e.returnStatistics}).then(function(e){return e?t._parseResponse(e,function(e){var t,n,r,i;return(null===(i=null===(r=null===(n=null===(t=e)||void 0===t?void 0:t.d)||void 0===n?void 0:n.GetListsBy)||void 0===r?void 0:r.results)||void 0===i?void 0:i.length)>0?e.d.GetListsBy.results.map(function(e){var t=e.color,n=e.icon,r=e.listId,i=e.listUrl,s=e.title,o=e.siteId,u=e.siteTitle,a=e.siteUrl;return{listColor:Number(t),listIcon:Number(n),listId:r,listUrl:i,listTitle:s,siteId:o,siteTitle:u,siteUrl:a}}):[]}):[]}).catch(function(e){var t;if(e&&"-1, System.NotSupportedException"===(null===(t=e)||void 0===t?void 0:t.code))return[]})};t.prototype.getNewsFeed=function(e){var t=this;return this.getDataUtilizingPersistentCache({url:this.pageContext.webAbsoluteUrl+"/_api/v2.1/getNewsFeed?section=SharePointNewsFeedTargeted&$expand=analytics($expand=allTime),thumbnails",additionalHeaders:{scenario:"SharePointAppBar"},qosName:"getNewsFeed",method:"GET",noRedirect:!0,cacheRequestKey:this._cacheKey+"_getNewsFeed",cachingStrategy:e.cachingStrategy,cacheTimeoutTime:e.cacheTimeoutTime,returnStatistics:e.returnStatistics}).then(function(e){return e?t._parseResponse(e,function(e){var t;return(null===(t=e)||void 0===t?void 0:t.value)?e.value:[]}):{value:[]}})};t.prototype.getMySiteUrl=function(){var e;if(Number(this._pageContext.webTemplate)===o.e.mySite&&this._pageContext.isSiteOwner)e=i.n.resolve(this._pageContext.webAbsoluteUrl);else{if(this._pageContext.isAnonymousGuestUser||this._pageContext.isEmailAuthenticationGuestUser||this._pageContext.isExternalGuestUser)return i.n.resolve(void 0);var t=this.pageContext.webAbsoluteUrl+"/_api/SP.Directory.DirectorySession/me?$select=mySite";e=this.dataRequestor.getData({url:t,qosName:"GetMyOneDriveUrl",noRedirect:!0,method:"GET"}).then(function(e){if(e&&e.d){var t=e.d.mySite;return t&&t.replace(/\/$/,"")}})}return e};return t})(s.e)},3875:function(e,t,n){"use strict";n.d(t,"e",function(){return o});var r=n(0),i=n(67),s=n(477),o=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,{dataSourceName:"RecentFilesGraphDataSource",id:"RecentFilesGraphDataSource"},{pageContext:t})||this;n._parseFilesResponse=function(e,t){var s,o,u,a;if(e){var f,l=!1;if(n._isCachedResultWithStatistic(e)){f=e.data;l=!0}else f=e;var c=null===(u=null===(o=null===(s=f)||void 0===s?void 0:s.data)||void 0===o?void 0:o.me)||void 0===u?void 0:u.recent;if(null!=c){if(!c||0===c.length)return t?{data:[],cacheStats:{lastModified:Date.now(),lastRead:Date.now(),reads:0}}:[];var h=null===(a=c=n._sortByAccessTime(c.filter(function(e){var t,n=e.remoteItem;return n.name&&(null===(t=n.sharepointIds)||void 0===t?void 0:t.siteUrl)&&(i.t.isActivated("7c90522e-4460-4492-9407-5e098008f98c","5/17/2021","switch to oneup view")?n.webUrl:n.webDavUrl)})))||void 0===a?void 0:a.slice(0,n._maxNumber).map(function(e){var t,n,s,o,u,a,f=e.remoteItem,l=null,c=f.name;if("oneNote"===(null===(t=f.package)||void 0===t?void 0:t.type)){u="one";a=c}else{var h=c.lastIndexOf(".");u=c.substr(h+1);a=c.substr(0,h)}var p=f.sharepointIds.siteUrl,d=document.createElement("a");d.href=f.webDavUrl;if("documentLibrary"===f.parentReference.driveType){var v=p.substr(p.lastIndexOf("/")+1);p=null===(n=f.webDavUrl)||void 0===n?void 0:n.substr(0,f.webDavUrl.lastIndexOf("/"));var m=d.pathname,g=m.substr(m.indexOf(v)+v.length+1),y=decodeURI(g).split("/");y.pop();l=y.length>=3?v+" > ... > "+y[y.length-1]:Object(r.__spreadArrays)([v],y).join(" > ")}else{var b=null===(o=null===(s=f.createdBy)||void 0===s?void 0:s.user)||void 0===o?void 0:o.displayName;l=b&&b.length>0?"OneDrive > "+b:"OneDrive > Documents"}return{name:a,url:i.t.isActivated("7c90522e-4460-4492-9407-5e098008f98c","5/17/2021","switch to oneup view")?f.webUrl:f.webDavUrl+"?web=1",path:l,extension:u,siteurl:p}});return l?Object(r.__assign)(Object(r.__assign)({},e),{data:h}):h}}};n._sortByAccessTime=function(e){if(!e||e.length<=1)return e;var t=e.length,n={},r=-1;n[t-1]=new Date(e[t-1].remoteItem.fileSystemInfo.lastAccessedDateTime);for(var i=t-2;i>=0;i--){var s=new Date(e[i].remoteItem.fileSystemInfo.lastAccessedDateTime);n[i]=s;s<n[i+1]&&i+1>r&&(r=i+1)}var o=function(t,n,r){if(t===n)return t;if(new Date(e[t].remoteItem.fileSystemInfo.lastAccessedDateTime)<r)return t;if(new Date(e[n].remoteItem.fileSystemInfo.lastAccessedDateTime)>r)return n+1;if(t===n-1)return n;var i=Math.floor((t+n)/2);return new Date(e[i].remoteItem.fileSystemInfo.lastAccessedDateTime)>r?u(i,n,r):u(t,i,r)},u=function(t,n,r){if(t===n)return t;if(t===n-1)return new Date(e[t].remoteItem.fileSystemInfo.lastAccessedDateTime)<r?t:new Date(e[n].remoteItem.fileSystemInfo.lastAccessedDateTime)>r?n+1:n;var i=Math.floor((t+n)/2);return new Date(e[i].remoteItem.fileSystemInfo.lastAccessedDateTime)>r?u(i,n,r):u(t,i,r)},a=[];for(i=0;i<r;i++)a.push(e.shift());for(i=0;i<a.length;i++){var f=o(0,t-r-1+i,new Date(a[i].remoteItem.fileSystemInfo.lastAccessedDateTime));e.splice(f,0,a[i])}return e};n._isCachedResultWithStatistic=function(e){return!!e.cacheStats};n._recentFilesGraphCacheKey="recentFiles_"+t.aadUserId;n.pageContext=t;return n}t.prototype.getRecentFiles=function(e){var t=this;this._maxNumber=e.maxItems;return this.getDataUtilizingPersistentCache({url:this.pageContext.webAbsoluteUrl+"/_api/v2.1/graphql",qosName:"RecentFilesGraph",method:"POST",contentType:"application/graphql",additionalPostData:"{ me { recent { remoteItem { name webUrl webDavUrl parentReference { driveType } package { type } sharepointIds { siteUrl } fileSystemInfo { lastAccessedDateTime } createdBy { user { displayName } } } } } }",cachingStrategy:e.cachingStrategy,cacheRequestKey:this._recentFilesGraphCacheKey+"recent",cacheTimeoutTime:e.cacheTimeoutTime?e.cacheTimeoutTime:864e5,returnStatistics:e.returnStatistics}).then(function(n){return t._parseFilesResponse(n,e.returnStatistics)})};return t})(s.e)},4944:function(e,t,n){"use strict";n.r(t);var r=n(0),i=n("react-lib"),s=n(1289),o=n(121),u=n(2382),a=n(1972),f=n(3875),l=n(1555),c=n(2804),h=n(3023),p=n(178),d=n(245),v=n(273),m=n(67),g=i.lazy(function(){return n.ee([480],4700)}),y=i.lazy(function(){return n.ee([474,"deferred.office-ui-fabric-react","ondemand.resx-ondemand"],4027)}),b=i.lazy(function(){return n.ee([475,"deferred.office-ui-fabric-react","ondemand.resx-ondemand"],3261)}),w=i.lazy(function(){return n.ee([481,"deferred.office-ui-fabric-react","ondemand.resx-ondemand"],4028)}),E=i.lazy(function(){return n.ee([482,"deferred.office-ui-fabric-react","ondemand.resx-ondemand"],3283)}),S=i.lazy(function(){return n.ee([478,"deferred.office-ui-fabric-react","ondemand.resx-ondemand"],4029)}),x=i.lazy(function(){return n.ee([479,"deferred.office-ui-fabric-react","ondemand.resx-ondemand"],3284)}),T=i.lazy(function(){return n.ee([472,"deferred.office-ui-fabric-react","ondemand.resx-ondemand"],4701)}),N=i.lazy(function(){return n.ee([473,"deferred.office-ui-fabric-react","ondemand.resx-ondemand"],4030)}),C=i.lazy(function(){return n.ee([471,"deferred.odsp-datasources","ondemand.resx-ondemand"],4950)}),k=i.lazy(function(){return n.ee([483,"deferred.office-ui-fabric-react","ondemand.resx-ondemand"],4702)}),L=i.lazy(function(){return n.ee([476,"deferred.office-ui-fabric-react","ondemand.resx-ondemand"],4703)}),A=i.lazy(function(){return n.ee([477,"deferred.office-ui-fabric-react","ondemand.resx-ondemand"],4138)}),O={ODB:60124},M={ODB:60357},_=function(){return m.t.isActivated("c92e40dc-3388-4078-a457-9b15495593d2","8/12/2021","window event listener mem leak fix")},D=(function(e){Object(r.__extends)(t,e);function t(t){var r,i=e.call(this,t)||this;i.componentData={};i._initializeFileTypeIcons=function(){n.ee([595],967).then(v.e).then(function(e){i.initializedIcons=!0;e.initializeFileTypeIcons()})};i._isTokenExpired=function(e){var t;return!(null===(t=e)||void 0===t?void 0:t.Token)||i._getExpirationTimeLeft(e.Token)<=0};i._getExpirationTimeLeft=function(e){return i.dataSource.isMicroserviceToken(e)?1e3*parseInt(e.expires_on,10)-Date.now():1e3*parseInt(e.ExpiresOn,10)-Date.now()};i._clearClientContext=function(){Object(a.v)()||i.state.clientContext||null===i.state.clientContext||i.setState({clientContext:null})};i._setTimeoutAndGetHomeContext=function(e){(Object(a.v)()||e>0)&&(i.tokenRefreshTimer=i.tokenRefreshAsync.setTimeout(function(){i.dataSource.getHomeContext().then(function(e){i._checkAndSetContext(e)}).catch(function(){i._clearClientContext()})},e))};i._checkAndSetContext=function(e,t){if(e.Token){var n=e.Token,r=i._getExpirationTimeLeft(n);if(r>=3e4){t||i.setState({clientContext:e});i._setTimeoutAndGetHomeContext(r-3e4)}}else i._clearClientContext()};i._shouldPrewarm=function(e){return!i.hasGottenFreshData&&("blank"===e.workload&&"blank"!==i.state.workload||!i._isFetchTokenKSActivated()&&"teams"===i.state.workload)};i._handleWorkloadMessages=function(e){if(e.origin===i.windowOrigin&&e.data&&e.data.type)if("spAppBarWorkload"===e.data.type){var t=Object(u.r)("workload",e.data.payload);i.setState({workload:t})}else if("setRTL"===e.data.type){var n=e.data.isRTL?"rtl":"ltr";document.documentElement.setAttribute("dir",n)}else"spAppBarWorkloadBlank"===e.data.type&&i.setState({workload:"blank"})};i._messageParentAppStarted=function(){window.postMessage({type:"spAppBarPanelStarted"},i.windowOrigin)};i._isFetchTokenKSActivated=function(){return m.t.isActivated("e58df739-96ea-4281-82b1-61ce8550c069","4/12/2021","fetch token if expired in prewarm")};i._setUpAndPrewarm=function(e){i._isFetchTokenKSActivated()||i._fetchTokenIfExpired();i.hasGottenFreshData=!0;i.filesDataSource=new f.e(i.pageContext);i.globalnavDataSource=new l.e(i.pageContext);i.sharePointDataSource=new h.e(i.pageContext);i._prewarmDataClick(e)};i._fetchTokenIfExpired=function(){i._isTokenExpired(i.state.clientContext)&&i.dataSource.getHomeContext().then(function(e){i.tokenRefreshTimer&&i.tokenRefreshAsync.clearTimeout(i.tokenRefreshTimer);i._checkAndSetContext(e)}).catch(function(){i._clearClientContext()})};i._prewarmDataClick=function(e){n.ee([543],269).then(v.e).then(function(t){var n,r;if("files"!==e){t.logData({name:"SPAppBar.Files.DataClick"});i._getFilesNetwork()}if("globalnav"!==e&&(null===(n=i.pageContext.appBarParams)||void 0===n?void 0:n.isGlobalNavEnabled)&&(null===(r=i.pageContext.companyPortalReference)||void 0===r?void 0:r.SiteId)){t.logData({name:"SPAppBar.GlobalNav.DataClick"});i.globalnavDataSource.getGlobalNav(!1).catch()}if("news"!==e){t.logData({name:"SPAppBar.News.DataClick"});i.useNewNewsDataSource?i.sharePointDataSource.getNewsFeed({cachingStrategy:0,cacheTimeoutTime:a.a,returnStatistics:!0}).then(function(e){i.receivedNewData(e,"news")}).catch():i._getSPHomeNetwork(i.dataSource.getNews.bind(i.dataSource),a.a,a.o,"news")}if("sites"!==e){t.logData({name:"SPAppBar.Frequent.DataClick"});i._getSPHomeNetwork(i.dataSource.getFrequentSites.bind(i.dataSource),a.f,a.i,"frequent");t.logData({name:"SPAppBar.Followed.DataClick"});i._getSPHomeNetwork(i.dataSource.getFollowedSites.bind(i.dataSource),a.f,a.r,"followed")}if("lists"!==e&&d.n.isFeatureEnabled(M)){t.logData({name:"SPAppBar.Lists.Recent.DataClick"});i._getRecentListsNetwork();t.logData({name:"SPAppBar.Lists.Favorite.DataClick"});i._getFavoriteListsNetwork()}})};i._getFilesNetwork=function(){i.filesDataSource.getRecentFiles({cachingStrategy:1,returnStatistics:!0,maxItems:a.t}).then(function(e){i.receivedNewData(e,"files")}).catch()};i._getRecentListsNetwork=function(){i.sharePointDataSource.getRecentLists({cachingStrategy:0,cacheTimeoutTime:a.s,returnStatistics:!0}).then(function(e){i.receivedNewData(e,"recentLists")}).catch()};i._getFavoriteListsNetwork=function(){i.sharePointDataSource.getFavoriteLists({cachingStrategy:0,cacheTimeoutTime:a.s,returnStatistics:!0}).then(function(e){i.receivedNewData(e,"favoriteLists")}).catch()};i._getSPHomeNetwork=function(e,t,n,r){var s=i.state.cachedData&&i.state.cachedData.find(function(e){return e.Key===n}),o=null;s&&i.state.clientContext?o=e({cachingStrategy:1,spHomeCachedItem:s.Value,spHomeClientContext:i.state.clientContext,returnStatistics:!0,cacheTimeoutTime:t}):i.state.clientContext&&i.state.clientContext.Token&&(o=e({cachingStrategy:1,spHomeCachedItem:{cacheContext:null,cacheValue:""},spHomeClientContext:i.state.clientContext,returnStatistics:!0,cacheTimeoutTime:t}));if(o){switch(r){case"news":i.needsNewsData=!1;break;case"frequent":i.needsFrequentData=!1;break;case"followed":i.needsFollowedData=!1}o.then(function(e){i.receivedNewData(e,r)}).catch()}else switch(r){case"news":i.needsNewsData=!0;break;case"frequent":i.needsFrequentData=!0;break;case"followed":i.needsFollowedData=!0}};var s=Object(u.r)("workload",t.query);i.useNewNewsDataSource=Object(a.d)();i.state={workload:s,cachedData:void 0,clientContext:void 0};i.pageContext=i.props.spPageContextInfo?i.props.spPageContextInfo:window._spPageContextInfo;i.windowOrigin=m.t.isActivated("d8afff78-f409-446a-9a1f-2d573b688a46","5/14/2021","use window origin")?Object(u.n)(null===(r=i.pageContext.appBarParams)||void 0===r?void 0:r.portalUrl):window.location.origin;i.dataSource=new c.e(i.pageContext);i.tokenRefreshTimer=0;i.tokenRefreshAsync=new p.e;if(_()){window.addEventListener("message",i._handleWorkloadMessages.bind(i));i._messageParentAppStarted()}i.receivedNewData=a.w.bind(i);return i}t.prototype.componentDidUpdate=function(e,t){if(!t.clientContext&&this.state.clientContext){this.needsNewsData&&this._getSPHomeNetwork(this.dataSource.getNews.bind(this.dataSource),a.a,a.o,"news");this.needsFrequentData&&this._getSPHomeNetwork(this.dataSource.getFrequentSites.bind(this.dataSource),a.f,a.i,"frequent");this.needsFollowedData&&this._getSPHomeNetwork(this.dataSource.getFollowedSites.bind(this.dataSource),a.f,a.r,"followed")}this._fetchTokenIfExpired();this._shouldPrewarm(t)&&d.n.isFeatureEnabled(O)&&this._setUpAndPrewarm(this.state.workload)};t.prototype.componentDidMount=function(){if(!_()){window.addEventListener("message",this._handleWorkloadMessages);this._messageParentAppStarted()}"blank"!==this.state.workload&&d.n.isFeatureEnabled(O)&&this._setUpAndPrewarm(this.state.workload)};t.prototype.componentWillUnmount=function(){_()||window.removeEventListener("message",this._handleWorkloadMessages)};t.prototype.render=function(){var e;switch(this.state.workload){case"globalnav":if(this.componentData.globalnav){var t=this.componentData.globalnav;e=i.createElement(i.Suspense,{fallback:i.createElement("div",null)},i.createElement(b,{rawNavData:t,useRouterNavigation:!1,pageContext:this.pageContext,onDismissAppBarPanel:this.props.onDismissAppBarPanel}))}else e=i.createElement(i.Suspense,{fallback:i.createElement("div",null)},i.createElement(y,{useRouterNavigation:!1,sendUpdatedDataToParent:this.receivedNewData,onDismissAppBarPanel:this.props.onDismissAppBarPanel,pageContext:this.pageContext}));break;case"sites":if(this.componentData.frequent&&this.componentData.followed){var n=this.componentData.frequent,r=this.componentData.followed;if(Object(a.p)(n.cacheStats.lastModified,a.f)&&Object(a.p)(r.cacheStats.lastModified,a.f)){e=i.createElement(i.Suspense,{fallback:i.createElement("div",null)},i.createElement(E,{frequentSites:Object(a.b)(n.data),followedSites:Object(a.b)(r.data),useRouterNavigation:!1,hideFrequentSites:!1,onDismissAppBarPanel:this.props.onDismissAppBarPanel,pageContext:this.pageContext,countToRender:Object(u.e)(window.innerHeight,!1)}))}else e=i.createElement(i.Suspense,{fallback:i.createElement("div",null)},i.createElement(w,{useRouterNavigation:!1,sendUpdatedDataToParent:this.receivedNewData,clientContext:this.state.clientContext,cachedData:this.state.cachedData,onDismissAppBarPanel:this.props.onDismissAppBarPanel,pageContext:this.pageContext,countToRender:Object(u.e)(window.innerHeight,!1)}))}else e=i.createElement(i.Suspense,{fallback:i.createElement("div",null)},i.createElement(w,{useRouterNavigation:!1,sendUpdatedDataToParent:this.receivedNewData,clientContext:this.state.clientContext,cachedData:this.state.cachedData,onDismissAppBarPanel:this.props.onDismissAppBarPanel,pageContext:this.pageContext,countToRender:Object(u.e)(window.innerHeight,!1)}));break;case"news":if(this.componentData.news){var s=this.componentData.news;e=Object(a.p)(s.cacheStats.lastModified,a.a)?i.createElement(i.Suspense,{fallback:i.createElement("div",null)},i.createElement(x,{news:Object(a.y)(s.data),useRouterNavigation:!1,onDismissAppBarPanel:this.props.onDismissAppBarPanel,pageContext:this.pageContext,countToRender:Object(u.e)(window.innerHeight,!0)})):i.createElement(i.Suspense,{fallback:i.createElement("div",null)},i.createElement(S,{useRouterNavigation:!1,sendUpdatedDataToParent:this.receivedNewData,clientContext:this.state.clientContext,cachedData:this.state.cachedData,onDismissAppBarPanel:this.props.onDismissAppBarPanel,pageContext:this.pageContext,countToRender:Object(u.e)(window.innerHeight,!0)}))}else e=i.createElement(i.Suspense,{fallback:i.createElement("div",null)},i.createElement(S,{useRouterNavigation:!1,sendUpdatedDataToParent:this.receivedNewData,clientContext:this.state.clientContext,cachedData:this.state.cachedData,onDismissAppBarPanel:this.props.onDismissAppBarPanel,pageContext:this.pageContext,countToRender:Object(u.e)(window.innerHeight,!0)}));break;case"files":if(this.componentData.files){this.initializedIcons||this._initializeFileTypeIcons();var o=this.componentData.files;e=Object(a.p)(o.cacheStats.lastModified,a.n)?i.createElement(i.Suspense,{fallback:i.createElement("div",null)},i.createElement(N,{files:o.data,useRouterNavigation:!1,onDismissAppBarPanel:this.props.onDismissAppBarPanel,pageContext:this.pageContext,countToRender:Object(u.e)(window.innerHeight,!0)})):i.createElement(i.Suspense,{fallback:i.createElement("div",null)},i.createElement(T,{useRouterNavigation:!1,sendUpdatedDataToParent:this.receivedNewData,onDismissAppBarPanel:this.props.onDismissAppBarPanel,pageContext:this.pageContext,countToRender:Object(u.e)(window.innerHeight,!0)}))}else{this.initializedIcons||this._initializeFileTypeIcons();e=i.createElement(i.Suspense,{fallback:i.createElement("div",null)},i.createElement(T,{useRouterNavigation:!1,sendUpdatedDataToParent:this.receivedNewData,onDismissAppBarPanel:this.props.onDismissAppBarPanel,pageContext:this.pageContext,countToRender:Object(u.e)(window.innerHeight,!0)}))}break;case"teams":e=i.createElement(i.Suspense,{fallback:i.createElement("div",null)},i.createElement(k,{useRouterNavigation:!0,clientContext:this.state.clientContext,cachedData:this.state.cachedData,pageContext:this.pageContext}));break;case"create":this.initializedIcons||this._initializeFileTypeIcons();if(this.componentData.frequent&&this.componentData.followed){n=this.componentData.frequent,r=this.componentData.followed;e=i.createElement(i.Suspense,{fallback:i.createElement("div",null)},i.createElement(C,{clientContext:this.state.clientContext,pageContext:this.pageContext,useRouterNavigation:!1,onDismissAppBarPanel:this.props.onDismissAppBarPanel,frequentSites:Object(a.b)(n.data),followedSites:Object(a.b)(r.data),countToRender:Object(u.e)(window.innerHeight,!1)}))}else e=i.createElement(i.Suspense,{fallback:i.createElement("div",null)},i.createElement(C,{clientContext:this.state.clientContext,pageContext:this.pageContext,useRouterNavigation:!1,onDismissAppBarPanel:this.props.onDismissAppBarPanel}));break;case"lists":if(this.componentData.recentLists&&this.componentData.favoriteLists){var f=this.componentData.recentLists,l=this.componentData.favoriteLists;e=Object(a.p)(f.cacheStats.lastModified,a.s)&&Object(a.p)(l.cacheStats.lastModified,a.s)?i.createElement(i.Suspense,{fallback:i.createElement("div",null)},i.createElement(A,{recentLists:f.data,favoriteLists:l.data,useRouterNavigation:!1,onDismissAppBarPanel:this.props.onDismissAppBarPanel,pageContext:this.pageContext,countToRender:Object(u.e)(window.innerHeight,!1,"lists")})):i.createElement(i.Suspense,{fallback:i.createElement("div",null)},i.createElement(L,{useRouterNavigation:!1,sendUpdatedDataToParent:this.receivedNewData,clientContext:this.state.clientContext,cachedData:this.state.cachedData,onDismissAppBarPanel:this.props.onDismissAppBarPanel,pageContext:this.pageContext,countToRender:Object(u.e)(window.innerHeight,!1,"lists")}))}else e=i.createElement(i.Suspense,{fallback:i.createElement("div",null)},i.createElement(L,{useRouterNavigation:!1,sendUpdatedDataToParent:this.receivedNewData,clientContext:this.state.clientContext,cachedData:this.state.cachedData,onDismissAppBarPanel:this.props.onDismissAppBarPanel,pageContext:this.pageContext,countToRender:Object(u.e)(window.innerHeight,!1,"lists")}));break;case"blank":default:e=null}return e?i.createElement(i.Suspense,{fallback:i.createElement("div",null)},i.createElement(g,{content:e})):null};return t})(i.PureComponent),P=(function(e){Object(r.__extends)(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;t.state={hasError:!1};return t}t.getDerivedStateFromError=function(e){return{hasError:!0}};t.prototype.componentDidCatch=function(e,t){console.error(e,t)};t.prototype.render=function(){return this.state.hasError?i.createElement(i.Fragment,null):this.props.children};return t})(i.Component),H=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._handleEventFromAppBar=function(e){e.origin===window.location.origin&&e.data&&e.data.type&&("spAppBarWorkload"===e.data.type?e.data.payload!==n.state.appbarQueryString?n.setState({showAppBarCallout:!0,appbarQueryString:e.data.payload}):n.state.showAppBarCallout||(n.state.firstClose?n.setState({firstClose:!1}):n.setState({showAppBarCallout:!0,appbarQueryString:e.data.payload})):"CLOSE_CALLOUT"!==e.data.type&&"spAppBarCreateSite"!==e.data.type||n.state.showAppBarCallout&&n.setState({showAppBarCallout:!1}))};n._dismissAppBarPanel=function(e){var t;if(n.state.showAppBarCallout&&(!e||!e.target||"sp-appBar-link"!==e.target.className)){if("focus"===(null===(t=e)||void 0===t?void 0:t.type))return;n.setState({showAppBarCallout:!1});window.postMessage({type:"CLOSE_CALLOUT"},window.location.origin);window.postMessage({type:"spAppBarWorkloadBlank"},window.location.origin)}};window.addEventListener("message",n._handleEventFromAppBar);n.state={showAppBarCallout:!1,appbarQueryString:"/_layouts/15/spappbar.aspx?workload=blank",firstClose:!1};return n}t.prototype.render=function(){var e,t=null===(e=document.getElementById("sp-appBar"))||void 0===e?void 0:e.classList.contains("sp-appBar-mobile"),n={root:{height:"100%",display:"flex",flexDirection:"column",minWidth:t?"100vw":"320px",maxWidth:t?"unset":"320px",borderRadius:0,boxShadow:"10px 5.4px 14.4px -10px rgb(0 0 0 / 13%), 10px 0.2px 3.6px -10px rgb(0 0 0 / 11%)",animation:"none",bottom:"0px !important"},container:{height:"100%",zIndex:10},calloutMain:{display:"flex",flexDirection:"column",height:"100%",borderRadius:0},beak:{height:"97%"},beakCurtain:{height:"96%"}},r=i.createElement(s.e,{className:"spappbar-callout",id:"sp-appBar-callout",gapSpace:0,target:".sp-appBar",isBeakVisible:!1,directionalHint:o.e.topCenter,setInitialFocus:!0,styles:n,doNotLayer:!0,minPagePadding:-1,hidden:!this.state.showAppBarCallout,onDismiss:this._dismissAppBarPanel,shouldUpdateWhenHidden:!0,dismissOnTargetClick:!0},i.createElement(D,{query:this.state.appbarQueryString,onDismissAppBarPanel:this._dismissAppBarPanel,spPageContextInfo:this.props.spPageContextInfo}));return m.e.isActivated("51a8f759-b128-40d0-b421-9ce4b0c17463","9/27/2021","Use error boundary for app bar callout")?r:i.createElement(P,null,r)};return t})(i.Component);t.default=H}}]);