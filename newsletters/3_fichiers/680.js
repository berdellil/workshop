(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([[680],{1942:function(e,t,n){"use strict";var r=n(0),i=n(69),s=n(1602),o=n(229),u=n(77),a=n(1114),f=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._getModule=t.getModule;n._path=t.path;n._getExecutorParams=t.getExecutorParams;if(!Object(u.isFeatureEnabled)(u.RemoveBundeLoaderFromExecutorAction)){n._bundleLoader=n.resources.consume(o.e);n._bundleLoader.queueLoad(n._path,n._getModule).done()}return n}t.prototype.execute=function(e,t){var n=this;return this._path?this._loadExecutorType().then(function(r){return"function"!=typeof r?i.n.wrapError(new Error("Cannot create action from "+r+": "+n._path)):i.n.as(n._getExecutorParams()).then(function(s){var o=new(n.resources.injected(r))(s);return i.n.as(o.execute(e,t))})}):i.n.wrapError(new Error("Cannot create action from nothing: "+this._path))};t.prototype._loadExecutorType=function(){if(Object(u.isFeatureEnabled)(u.RemoveBundeLoaderFromExecutorAction))return this._getModule().then(function(e){return Object(a.e)(e)});var e=this._bundleLoader.loadNow(this._path,this._getModule);this._loadExecutorType=function(){return e};return e};return t})(s.default);t.e=f},2928:function(e,t,n){"use strict";n.r(t);var r=n(0),i=n(69),s=n(1839),o=n(1942),u=n(1803),a=n(93),f=n(34),l=n(12),c=n(1805),h=n(1841),p=n(2156),d=n(77),v=(function(e){Object(r.__extends)(t,e);function t(t){void 0===t&&(t={});var r,s=e.call(this,t)||this;s.name="Share";s._urlDataSource=s.resources.consume(a.pe);if(t.itemKey){var f=s.resources.consume(c.resourceKey);r=f.getSpecifiedItems({itemKeys:[t.itemKey],recurseInFolders:!0}).then(function(e){return e.children})}s._selectionHelper=new(s.child(u.e))({canFallback:!0,overrideItem:t.item,allowMultiSelect:!1});s._itemCommandHelper=s.resources.consume(h.t);var l=t.activeTab||1;s._loader=new(s.managed(o.e))({path:"./ShareExecutor",getModule:function(){return i.n.resolve(n.ee([681,"deferred","deferred.odsp-datasources","ondemand.resx-ondemand"],3761))},getExecutorParams:function(){return{selectionHelper:s._selectionHelper,activeTab:s.observables.create(l),deferredItems:r,initialTab:l}}});return s}t.prototype.onIsAvailable=function(){var e=this.item();if(!this._itemCommandHelper.isCommandSupported(e,p.n))return!1;if(!e||e.queryType===f.e.RecycleBin||e.queryType===f.e.SecondStageRecycleBin)return!1;var t=this.getParent(e,"list");if(!t)return!1;if(t&&t.list&&t.list.templateType===l.n.webPageLibrary)return!1;if(this._urlDataSource.isCurrentQuery(f.e.DocumentLibraries))return!1;var n=this._selectionHelper.firstItem();return Object(d.isFeatureEnabled)(d.ShareControlListSharingUI)&&n&&n.list&&(n.isRootFolder||n.list)?this._itemCommandHelper.isCommandSupported(n,p.n)&&!n.isPlaceholder&&!n.subsite:!!n&&this._itemCommandHelper.isCommandSupported(n,p.n)&&!n.isPlaceholder&&!n.isRootFolder&&!n.list&&!n.subsite};t.prototype.onExecute=function(e){return this._loader.execute(e)};return t})(s.e);t.default=v}}]);