(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([[688],{2990:function(e,t,n){"use strict";n.d(t,"e",function(){return g});var r,i,s=n(0),o=n(431),u=n(136),a=n(61),f=n(6),l=n(133),c=n(134),h=n(18),p=n(236),d=[],v=((r={})[a.r.started]=function(e){return Object(h.format)(Object(h.getLocalizedCountValue)(p.l,p.r,e)||"",e)},r[a.r.completed]=function(e){return Object(h.format)(Object(h.getLocalizedCountValue)(p.n,p.r,e)||"",e)},r[a.r.failed]=function(e){return Object(h.format)(Object(h.getLocalizedCountValue)(p.o,p.u,e)||"",e)},r[a.r.canceled]=function(e){return Object(h.format)(Object(h.getLocalizedCountValue)(p.o,p.u,e)||"",e)},r),m=((i={})[a.r.created]=p.i,i[a.r.canceled]=p.e,i[a.r.completed]=p.t,i);function g(e,t){var n=t.itemKey,r=t.progressFormat,i=e.demandItemFacet(a.b,n),h=i&&i.itemKey,p=e.demandItemFacet(f.h,n)||e.demandItemFacet(f.h,h),g=e.demandItemFacet(f.c,n),y=e.demandItemFacet(l.e,n),b=e.demandItemFacet(o.e,n),w=Object(u.t)(e,{itemKey:n}),E=Object(u.r)(e,{itemKey:n}),S=E.phase,x=E.count,T=Object(u.n)(e,{itemKey:n}),N=e.demandItemFacet(a.c,n),C=N?0!==N.total?N.current/N.total:void 0:S!==a.r.started?1:void 0,k=o.e.evaluate(b)(e,Object(s.__assign)(Object(s.__assign)({itemKey:n,title:p||v[S](x),description:null!=g?g:y&&!Object(c.n)(y)?y.message:m[T]},C?{percentComplete:C}:{}),{itemCountsByPhase:w,format:r,commands:d,error:y}));return{itemKey:n,sourceItemKey:h,title:k.title,description:k.description,percentComplete:k.percentComplete,phase:S,commands:k.commands,error:k.error}}},4541:function(e,t,n){"use strict";n.r(t);n.d(t,"KOToItemItemCacheOperationProvider",function(){return ge});n.d(t,"resourceKey",function(){return ye});var r=n(0),i=n(1991),s=n(3830),o=n(3480),u=n(8),a=n(1842),f=n(1911),l=n(1827),c=n(2315),h=n(133),p=n(61),d=n(143),v=n(2990),m=n(271),g=n(1602),y=n(771),b=n(2),w=n(526),E=n(5),S=new b.e("legacyKnockoutOperation"),x=new E.e("legacyKnockoutOperationItem",{id:Object(E.i)()}),T=new b.e("legacyKnockoutOperationCommands"),N=new w.e("legacyKnockoutOperation"),C=n(511),k=n("react-lib"),L=n(16),A=n(386),O=n(14),M=n(431),_=n(136),D=n(2701),P=n(3013);function H(e){switch(e){case a.e.created:return p.r.created;case a.e.started:return p.r.started;case a.e.completed:return p.r.completed;case a.e.failed:return p.r.failed;case a.e.canceled:return p.r.canceled;case a.e.expired:return p.r.expired;default:return}}function B(e){switch(e){case p.r.created:return a.e.created;case p.r.started:return a.e.started;case p.r.completed:return a.e.completed;case p.r.failed:return a.e.failed;case p.r.canceled:return a.e.canceled;case p.r.expired:return a.e.expired;default:return}}function j(e){var t=e.minimum,n=e.maximum;return{current:e.current-t,total:n-t}}var F=n(23),I=n(55),q=n(10),R=n(22),U=n(2410),z=function(e){var t=e.isAvailableObservable,n=e.onExecute,r=Object(U.n)(t);return k.createElement(R.e,{isAvailable:r,onExecute:n})},W=n(135),X=function(e){var t=e.actions,n=Object(U.r)(),i=k.useMemo(function(){return n.pureCompute(function(){return t.filter(function(e){return e.isAvailable()})})},[]),s=k.useMemo(function(){return n.pureCompute(function(){return i().length>0})},[]);return k.createElement(z,{isAvailableObservable:s,onExecute:function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,Promise.all(i.peek().map(function(e){return e.execute()}))];case 1:e.sent();return[2]}})})}})},V=n(1206),$=Object(L.t)(function(){return function(e){e(Object(A.e)(N,M.e)(Object(O.t)()(K)));e(Object(A.e)(N,V.e)(Object(O.t)()(J)))}});function J(){return function(e){return function(){return{isAvailable:!1}}}}function K(){return function(e){return ee}}var Q=[],G=new W.e("shouldShowErrors",function(e,t){var n=t.itemKey;if(e.demandItemFacet(I.s,n)){var r=e.demandItemFacet(q.e,n),i=null==r?void 0:r.itemKeys;if(i)for(var s=0,o=0,u=i;o<u.length;o++){var a=u[o];!!e.demandItemFacet(h.e,a)&&s++;if(s>=4)return!0}return!1}return!0}),Y=new W.e("legacyKnockoutCommands",function(e,t){var n=t.itemKey,r=[];if(e.demandItemFacet(I.s,n)){var i=e.demandItemFacet(q.e,n),s=null==i?void 0:i.itemKeys;if(s){for(var o=new Map,u=0,a=s;u<a.length;u++){var f=a[u];if(p=e.demandItemFacet(T,f))for(var l in p){var c=p[l],h=o.get(l);if(void 0===h){h=[];o.set(l,h)}h.push(c)}}o.forEach(function(e,t){var n={key:t,name:Z(t,2),action:k.createElement(X,{actions:e})};r.push(n)})}}else{var p;if(p=e.demandItemFacet(T,n))for(var l in p){var d=(c=p[l]).key,v=c.isAvailable,m=c.execute,g={key:d,name:Z(d,c.count.peek()),action:k.createElement(z,{isAvailableObservable:v,onExecute:m.bind(c)})};r.push(g)}}return r});function Z(e,t){var n={count:te(t),states:te({}),payloads:te({}),progress:null,error:te(void 0)},r=D.e.actions[e];return r&&r.name&&Object(D.n)(r.name,n)}function ee(e,t){var n=t.itemKey,i=t.format,s=(function(e,t){var n=t,i=e.demandItemFacet(h.e,t);if(e.demandItemFacet(I.s,t)){var s=e.demandItemFacet(q.e,t),o=null==s?void 0:s.itemKeys,u=o&&o.length>0&&o[0];if(!u)return;n=u;if(!i)for(var a=0,f=o;a<f.length;a++){var l=f[a],c=e.demandItemFacet(h.e,l);if(c){i=c;break}}}var p=e.demandItemFacet(S,n);if(!p)return;return Object(r.__assign)(Object(r.__assign)({progressItemKey:n},p),{error:i})})(e,n);if(!s)return{};var o=s.type,u=s.payloads,c=s.name,d=s.error,v=Object(_.n)(e,{itemKey:n}),m=B(v);if(void 0===m||void 0===o)return{};var g,y,b=e.demandItemFacet(F.l,F.o),w=a.e[m],E=l.e[o],x=l.e[l.e.multiple],T=D.e.types[E],N=D.e.types[x],C=T.states[w],k=N.states[w],L=Object(_.t)(e,{itemKey:n}),A=L[v],O=e.demandItemFacet(p.c,n),M=e.demandItemFacet(G,n),H={count:te(A),states:te(L),error:te(d&&new f.e(d)),payloads:te(u),progress:{minimum:te(0),maximum:te(O?O.total:1),current:te(O?O.current:0)}};if("summary"===i){var j=C&&(C.shortTitle||C.title)||k&&(k.shortTitle||k.title)||T.shortTitle||N.shortTitle;return{title:P.e({context:H,resources:b},Object(D.n)(j,H))}}if("item"===i&&c)g=c;else{var R=C&&C.title||k&&k.title||T.title||N.title;g=P.e({context:H,resources:b},Object(D.n)(R,H))}var U=Q;if(M){var z=C&&C.description||k&&k.description||T.description||N.description;y=P.e({context:H,resources:b},Object(D.n)(z,H));U=e.demandItemFacet(Y,n)}return{title:g,description:y,commands:U,error:d}}function te(e){function t(t){if(!(arguments.length>0))return e;e=t}t.prototype.peek=function(){return e};return t}var ne=n(3479),re=n(123),ie=n(1851),se=n(186),oe=n(1093),ue=n(200),ae=n(418),fe=n(1520),le=n(1083),ce=n(68),he=n(471),pe=0,de=new WeakMap,ve=(function(){function e(e,t){var n=this,s=t.itemCacheObservablesFactory,o=t.observablesFactoryType,u=t.itemCacheStore,a=t.platformDetection;this._isRetinaSupported=a.isRetinaSupported;this._scope=new m.e;var f=this._scope.attach(new o({owner:this}));this._itemCacheStore=u;this._sourceItemKey=x.serialize({id:pe++});this.batch=e.batch||new i.e;var l=(function(e){var t=de.get(e),n=void 0===t;if(n){t=C.e.serializeNext();de.set(e,t)}return{batchKey:t,isNew:n}})(this.batch),c=l.batchKey,h=l.isNew;this.visibility=f.create(e.visibility||0);var p=this._createItemCacheProgressItem(e,c,h);this._progressItemKey=p;var d=j(Object(r.__assign)({minimum:0,maximum:0,current:0},e.progress||{}));this._updateItemCacheProgress(d);this._initializeActions(e.actions);this._progressItemData=this._scope.attach(s.pureCompute(function(e){return Object(v.e)(e,{itemKey:n._progressItemKey,progressFormat:"item"})}));this._progressItemData.equalityComparer=oe.t;this._knockoutOperationData=this._scope.attach(s.pureCompute(function(e){return e.demandItemFacet(S,n._progressItemKey)}));this._knockoutOperationData.equalityComparer=oe.t;this._knockoutActions=this._scope.attach(s.pureCompute(function(e){return e.demandItemFacet(T,n._progressItemKey)||{}}));this.name=e.name;this.iconName=e.iconName;this.state=f.compute(this._createStateObservableDef());this.warning=f.create("");this.error=f.compute(this._createErrorObservableDef());this.count=f.create(1);var g=Object(r.__assign)({minimum:0,maximum:0},e.progress||{});this.progress={minimum:f.create(g.minimum),maximum:f.create(g.maximum),current:f.compute(this._createCurrentProgressObservableDef())};this.type=f.compute(this._createTypeObservableDef());this.actions=f.compute(this._createActionsObservableDef());this.payloads=f.compute(this._createPayloadsObservableDef())}e.prototype._createItemCacheProgressItem=function(e,t,n){var i,s,o,u,a,f=this._itemCacheStore.dispatch,c=e.name,h=e.iconName,v=e.type,m=e.payloads;f($);var g=N.serializeBatchKey(t);f(Object(he.e)({owner:this,items:(i={},i[g]={},i)}));var y=N.serializeTaskKey(t,this._sourceItemKey,{}),w=new ue.e;w.resolveItems({items:(s={},s[y]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},p.b.pack({itemKey:this._sourceItemKey})),S.pack({name:c,type:v||l.e.multiple,payloads:m||{}})),p.g.pack(p.r.created)),s)});if(2!==this.visibility.peek()){n&&w.resolveItems({items:(o={},o[ae.e]=Object(b.n)({childItems:q.e},{childItems:{itemKeys:new fe.e([g],function(e){return e})}}),o)});w.resolveItems({items:(u={},u[g]=Object(r.__assign)(Object(r.__assign)({},Object(b.n)({childItems:q.e},{childItems:{itemKeys:new fe.e([y],function(e){return e})}})),I.s.pack(!0)),u)});h&&this._itemCacheStore.dispatch(Object(d.e)({items:(a={},a[this._sourceItemKey]=Object(r.__assign)({},re.n.pack({height:48,width:48,url:Object(ie.n)(this._isRetinaSupported,h,48)})),a)}))}this._itemCacheStore.dispatch(w.execute());return y};e.prototype.dispose=function(){this.actions({});this.payloads({});this._itemCacheStore.dispatch(Object(he.n)({owner:this}));this._scope.dispose()};e.prototype._createTypeObservableDef=function(){var e=this;return{read:function(){var t;return(null===(t=e._knockoutOperationData())||void 0===t?void 0:t.type)||l.e.multiple},write:function(t){var n;e._itemCacheStore.dispatch(Object(d.e)({items:(n={},n[e._progressItemKey]=Object(r.__assign)({},S.pack({type:t})),n)}))},pure:!0}};e.prototype._createStateObservableDef=function(){var e=this;return{read:function(){return B(e._progressItemData().phase)||a.e.created},write:function(t){var n;e._itemCacheStore.dispatch(Object(d.e)({items:(n={},n[e._progressItemKey]=Object(r.__assign)({},p.g.pack(H(t))),n)}))},pure:!0}};e.prototype._createErrorObservableDef=function(){var e=this;return{read:function(){var t=e._progressItemData().error;return t&&new f.e({message:t.message})},write:function(t){var n;e._itemCacheStore.dispatch(Object(d.e)({items:(n={},n[e._progressItemKey]=Object(r.__assign)({},Object(b.n)({error:h.e},{error:t?new le.e(t):new ce.e})),n)}))},pure:!0}};e.prototype._createPayloadsObservableDef=function(){var e=this;return{read:function(){var t=e._knockoutOperationData();return t&&t.payloads||{}},write:function(t){var n;e._itemCacheStore.dispatch(Object(d.e)({items:(n={},n[e._progressItemKey]=Object(r.__assign)({},S.pack({payloads:t})),n)}))},pure:!0}};e.prototype._createCurrentProgressObservableDef=function(){var e=this;return{read:function(){var t=e.progress.minimum(),n=e.progress.maximum();return(function(e,t,n){void 0===t&&(t=0);void 0===n&&(n=1);return{minimum:t,maximum:n,current:e*(n-t)+t}})(e._progressItemData().percentComplete||0,t,n).current},write:function(t){var n=j({minimum:e.progress.minimum.peek(),maximum:e.progress.maximum.peek(),current:t});e._updateItemCacheProgress(n)},pure:!0}};e.prototype._createActionsObservableDef=function(){var e=this;return{read:function(){return e._knockoutActions()},write:function(t){e._updateItemCacheActions(t)},pure:!0}};e.prototype._updateItemCacheProgress=function(e){var t;this._itemCacheStore.dispatch(Object(d.e)({items:(t={},t[this._progressItemKey]=Object(r.__assign)({},p.y.pack(e)),t)}))};e.prototype._initializeActions=function(e){void 0===e&&(e={});var t={};for(var n in e){var r=e[n];t[n]=this._scope.attach(new ne.e({key:n,operation:this,isAvailable:r.isAvailable,onExecute:r.execute}))}this._updateItemCacheActions(t)};e.prototype._updateItemCacheActions=function(e){var t;this._itemCacheStore.dispatch(Object(d.e)({items:(t={},t[this._progressItemKey]=Object(r.__assign)({},T.pack(e)),t)}))};return e})(),me=Object(u.o)("KOToItemCacheOperation",ve,{observablesFactoryType:g.observablesFactoryTypeResourceKey,itemCacheObservablesFactory:c.e,itemCacheStore:y.e,platformDetection:se.e});var ge=(function(){function e(e,t){void 0===e&&(e={});var n=t.observablesFactoryType;this._scope=new m.e;this._observables=this._scope.attach(new n({owner:this}));var r=this._observables,u=t.itemCacheOperationType;this._itemCacheOperationType=u;var a=new i.e;this._observers=r.createArray();var f=this.operations=r.createArray(),l=this._scope.attached(s.e),c=this.groups=this._scope.attach(o.e.group(f,function(e){return e.batch}).map({mappingWithDisposeCallback:function(e){var t=new l({batch:e.key,operations:e.values});return{mappedValue:t,dispose:function(){t.dispose()}}}}));this.overall=new(this._scope.attach(s.e))({batch:a,operations:c});this.isLocked=r.pureCompute(this._computeIsLocked);r.backgroundCompute(this._computeRemoveAllWhenUnlocked).extend({deferred:!0})}e.prototype.lock=function(){var e=this,t={};this._observers.push(t);return{dispose:function(){e._observers.remove(t)}}};e.prototype.register=function(e){var t=new this._itemCacheOperationType(e);2!==t.visibility.peek()&&this.operations.push(t);return t};e.prototype.deleteGroupOperation=function(e){var t=Object(r.__spreadArrays)(e.operations.peek());this.operations.removeAll(t);t.forEach(function(e){e.dispose()})};e.prototype.cleanup=function(e){void 0===e&&(e=!1)};e.prototype._computeRemoveAllWhenUnlocked=function(){this.isLocked()||this.cleanup()};e.prototype._computeIsLocked=function(){return this._observers().length>0};e.dependencies={observablesFactoryType:g.observablesFactoryTypeResourceKey,itemCacheOperationType:me};return e})(),ye=Object(u.s)("KOToItemCacheOperationProvider",ge)},4554:function(e,t,n){"use strict";n.r(t);n.d(t,"WithKnockoutStoreItems",function(){return w});n.d(t,"WithKnockoutResourcesAndItemCacheData",function(){return E});var r=n("react-lib"),i=n(216),s=(n(0),n(1238),n(1110)),o=n(6),u=n(164),a=n(131);function f(e,t){var n=!0;t.forEach(function(t){n=n&&(function(e,t){var n=!0,r=t;for(;r;){e.demandItemFacet(s.t,r);n=n&&e.isItemFacetResolved(s.t,r);var i=e.demandItemFacet(o.M,r),u=i&&i.itemKey;r=u}return n})(e,t)});return n}var l=n(32),c=n(107),h=n(8),p=n(1803),d=n(3072),v=n(1849),m=n(4541),g=Object(c.n)(function(e){e.exposeFactory(p.e,new h.e(d.typeResourceKey));e.exposeFactory(v.resourceKey,new h.e(m.resourceKey))},{owner:"ItemCacheToKOResourceProvider"})(r.Fragment),y=n(1138),b=n(3),w=Object(l.t)(function(e,t){var n=t.itemKey,i=t.children,s=(function(e,t){var n=[];t&&n.push(t);var r=Object(a.e)(e);r&&n.push(r);var i=Object(u.e)(e);if(i)for(var s=0,o=i;s<o.length;s++){var f=o[s];n.push(f)}return n})(e,n);return Object(b.ss)(b.zi)||f(e,s)?r.createElement(r.Fragment,null,i):null}),E=Object(i.n)(y.e)(Object(i.n)(w)(g))}}]);