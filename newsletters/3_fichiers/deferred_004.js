(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([["deferred.odsp-shared-react"],{249:function(e,t,n){"use strict";n.d(t,"e",function(){return u});var r=n(0),i=n(3486),s=n(7),o=(function(){function e(e,t){this._componentType=e;this.dependencies=Object(r.__assign)(Object(r.__assign)({},e.dependencies||{}),t||{})}e.prototype.create=function(e){return{instance:Object(i.t)(this._componentType,e)}};return e})();(function(){function e(e,t){this._statelessComponent=e;this.dependencies=t}e.prototype.create=function(e){return{instance:Object(i.n)(this._statelessComponent,e)}}})();function u(e,t,n){return new s.t({name:e,factory:new o(t,n)})}},1680:function(e,t,n){"use strict";n.r(t);var r=n(163),i=n(67),s=n(1216),o=(function(){function e(){}e.registerContentElement=function(t){if(e===Object(s.n)()){if(t!==e._contentElement){e._contentElement&&e._contentElement.removeEventListener("scroll",e._onScroll);e._contentElement=t;if(t)e._manageEventAttachment();else{e._isShyMode=!1;e._callbacks.forEach(function(e){try{e.onUnshy()}catch(e){}})}}}else Object(s.n)().registerContentElement(t)};e.registerCallbacks=function(t){if(e===Object(s.n)()){if(e._callbacks.indexOf(t)<0){e._callbacks.push(t);e._totalHeightDifference+=t.heightDifference;try{e._contentElement&&(e._contentElement.scrollTop-=t.heightDifference);this._isShyMode&&t.onShy()}catch(e){}e._manageEventAttachment();return!0}return!1}Object(s.n)().registerCallbacks(t)};e.unregisterCallback=function(t){if(e===Object(s.n)()){var n=e._callbacks.indexOf(t);if(n>=0){var r=e._callbacks[n];try{if(e._isShyMode){e._contentElement&&(e._contentElement.scrollTop+=r.heightDifference);r.onUnshy()}}catch(e){}e._totalHeightDifference-=r.heightDifference;e._callbacks.splice(n,1);e._manageEventAttachment();return!0}return!1}Object(s.n)().unregisterCallback(t)};e.unshy=function(){if(e===Object(s.n)()){e._onShyEventSent=!1;e._isShyMode=!1;e._callbacks.forEach(function(e){try{e.onUnshy()}catch(e){}})}else Object(s.n)().unshy()};e._manageEventAttachment=function(){if(e.enabled&&e._contentElement){var t=!i.t.isActivated("A2EE05E1-7A4E-4A5B-97D2-8BF10F0BC846","9/02/20","no scrollTop adjustment for anchor navigation");e._contentElement.removeEventListener("scroll",e._onScroll);e._contentElement.removeEventListener("mousedown",e._onMouseDown);e._contentElement.removeEventListener("mouseup",e._onMouseUp);t&&window.removeEventListener("hashchange",e._onHashChange);if(e._callbacks.length){e._contentElement.addEventListener("scroll",e._onScroll);e._contentElement.addEventListener("mousedown",e._onMouseDown);e._contentElement.addEventListener("mouseup",e._onMouseUp);t&&window.addEventListener("hashchange",e._onHashChange)}}};e._onScroll=function(t){e._queueScrollEvent=!0;if(!e._isMouseDown){window.clearTimeout(e._handleScrollTimeoutId);e._handleScrollTimeoutId=window.setTimeout(e._handleScroll,25)}};e._onMouseDown=function(t){e._isMouseDown=!0};e._onMouseUp=function(t){e._isMouseDown=!1;e._queueScrollEvent&&e._handleScroll()};e._onHashChange=function(t){e._hashChangedRecently=!0;window.clearTimeout(e._handleHashChangeTimeoutId);e._handleHashChangeTimeoutId=window.setTimeout(function(){e._hashChangedRecently=!1},500)};e._handleScroll=function(){if(e._queueScrollEvent){e._queueScrollEvent=!1;var t=e._contentElement.scrollTop-e._lastScrollPosition;if(t>=0&&!e._isShyMode){e._scrolledAmountConsecutively>=0?e._scrolledAmountConsecutively+=t:e._scrolledAmountConsecutively=t;if(e._scrolledAmountConsecutively>e.scrollThresholdDown&&e._contentElement.scrollTop-e._totalHeightDifference>e.scrollThresholdDown){if(!e._onShyEventSent){e._onShyEventSent=!0;Math.random()<.01&&r.e.logData({name:"ShyConductor.OnShy"})}e._isShyMode=!0;e._callbacks.forEach(function(e){try{e.onShy()}catch(e){}});e._hashChangedRecently?r.e.logData({name:"ShyConductor.HashNavNoAutoscrollShy"}):e._contentElement.scrollTop-=e._totalHeightDifference}}else if(t<0&&e._isShyMode){e._scrolledAmountConsecutively<=0?e._scrolledAmountConsecutively+=t:e._scrolledAmountConsecutively=t;if(-e._scrolledAmountConsecutively>e.scrollThresholdUp||e._contentElement.scrollTop<e.scrollThresholdDown){e._isShyMode=!1;e._callbacks.forEach(function(e){try{e.onUnshy()}catch(e){}});e._hashChangedRecently?r.e.logData({name:"ShyConductor.HashNavNoAutoscrollUnshy"}):e._contentElement.scrollTop+=e._totalHeightDifference}}e._lastScrollPosition=e._contentElement.scrollTop}};e.scrollThresholdDown=300;e.scrollThresholdUp=500;e.enabled=!0;e._callbacks=[];e._totalHeightDifference=0;e._isShyMode=!1;e._lastScrollPosition=0;e._scrolledAmountConsecutively=0;e._isMouseDown=!1;e._queueScrollEvent=!1;e._hashChangedRecently=!1;e._onShyEventSent=!1;return e})();t.default=o;Object(s.n)()||(window[s.e]=o)},2075:function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r=n(0),i=n("react-lib");function s(e,t,n,s){var o=e.split("{0}");s=Object(r.__assign)({key:"key"},s||{});return[o[0],i.createElement(n,s,t),o[1]]}},2180:function(e,t,n){"use strict";n.d(t,"e",function(){return V});var r=n(0),i=n(69),s=n(83),o=n(696),u=n(2693),a=n(519),f=n(3859),l=n(5033),c=n(207),h=n(219),p=n(2998),d=n(763),v=n(1330),m=n(1591),g=n(4630),y=n(95),b=n(67),w=n(405),E=(function(){function e(t){var n,s=this;this.removePreviewTheme=function(){s.previewTheme(e.OriginalOptions.theme);e.PreviewOptions.theme=e.OriginalOptions.theme};this.previewTheme=function(t){var n,i,o,u,f,l,c=(null===(n=t)||void 0===n?void 0:n.backgroundImageUri)?'url("'+t.backgroundImageUri+'")':"none",h=(null===(o=null===(i=t)||void 0===i?void 0:i.theme)||void 0===o?void 0:o.backgroundOverlay)||"",p=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},e._getGeneratedThemeColors(null===(u=t)||void 0===u?void 0:u.theme)),null===(f=t)||void 0===f?void 0:f.theme),{backgroundImageUri:c,backgroundOverlay:h});Object(a.t)({palette:p,isInverted:!!(null===(l=t)||void 0===l?void 0:l.isInverted)});e.PreviewOptions.theme=t;s.previewHeaderEmphasis(e.PreviewOptions.chromeOptions.header.emphasis)};this.getAvailableThemesPromise=function(){return i.n.all([s._getAllThemes(),s.getCurrentTheme(!1)]).then(function(t){e.OriginalOptions.theme=t[1];e.PreviewOptions.theme=e.PreviewOptions.theme||t[1];return Object(r.__assign)(Object(r.__assign)({},t[0]),{currentTheme:e.OriginalOptions.theme})})};this.getLoadingThemes=function(){return s._loadingThemes};this.getCurrentTheme=function(t){if(t){e.OriginalOptions.theme=null;s._originalThemePromise=s._loadAndRememberCurrentTheme(!0);return s._originalThemePromise}if(e.OriginalOptions.theme)return i.n.resolve(e.OriginalOptions.theme);s._originalThemePromise||(s._originalThemePromise=s._loadAndRememberCurrentTheme(!0));return s._originalThemePromise};this.saveTheme=function(){var t,n=e.PreviewOptions.theme;if(!(null===(t=n)||void 0===t?void 0:t.theme))return i.n.resolve();var o={};for(var u in n.theme)o[u]=c.e.fromHtmlColor(n.theme[u]);var a={name:n.name,theme:{backgroundImageUri:n.backgroundImageUri||"",palette:o,cacheToken:"",isDefault:!0,isInverted:n.isInverted,version:""}};return s._tenantThemeProvider.setTheme(a).then(function(t){e.OriginalOptions.theme=Object(r.__assign)(Object(r.__assign)({},n),{name:p.currentTheme});e.PreviewOptions.theme=Object(r.__assign)(Object(r.__assign)({},n),{name:p.currentTheme});return t})};this.getColorThemes=function(e,t){return Object(u.r)(e,t)};this.getAccentColors=function(e){return Object(u.e)(e)};this.previewHeaderEmphasis=function(t,n){var r,i;e.PreviewOptions.chromeOptions.header.emphasis=t||d.e.None;Object(v.e)(t,n||{palette:null===(r=e.PreviewOptions.theme)||void 0===r?void 0:r.theme,isInverted:!!(null===(i=e.PreviewOptions.theme)||void 0===i?void 0:i.isInverted)})};this.previewDiffNewChromeOptions=function(t){for(var n in t)e.PreviewOptions.chromeOptions[n]=Object(r.__assign)(Object(r.__assign)({},e.PreviewOptions.chromeOptions[n]),t[n]);h.e.applySettings({chromeOptions:e.PreviewOptions.chromeOptions});s.previewHeaderEmphasis(e.PreviewOptions.chromeOptions.header.emphasis)};this.previewFooterOptionsChange=function(t){e.PreviewOptions.footerLinks=Object(r.__spreadArrays)(t);h.e.applySettings({footerLinks:e.PreviewOptions.footerLinks})};this.previewLogo=function(e,t){t?s._updateLogoPreview(t):e?g.e.readFile(e).then(function(e){s._updateLogoPreview(e)}):s._updateLogoPreview(null)};this.previewBackgroundImage=function(e,t){t?s._updateBackgroundPreview(t):e?g.e.readFile(e).then(function(e){s._updateBackgroundPreview(e)}):s._updateBackgroundPreview(null)};this.previewBackgroundImageFocalPoint=function(e){s._updateBackgroundFocalPoint(e)};this.savingOptions=function(){e.OriginalOptions=JSON.parse(JSON.stringify(e.PreviewOptions));s.cancelPreview()};this.cancelPreview=function(){var t,n;h.e.applySettings({chromeOptions:e.OriginalOptions.chromeOptions});h.e.applySettings({footerLinks:e.OriginalOptions.footerLinks});w.e({ODB:60340},s._pageContext,{experimentFlightId:90024,killSwitch:"39702562-b8cb-4062-acff-022dc2cb0606"})&&y.t.raise(window,"UPDATE_NAV_PLACEMENT",{placement:e.OriginalOptions.chromeOptions.nav.placement,quickLaunchEnabled:e.OriginalOptions.chromeOptions.nav.quickLaunchEnabled});s.removePreviewTheme();Object(v.e)(e.OriginalOptions.chromeOptions.header.emphasis,{palette:null===(t=e.OriginalOptions.theme)||void 0===t?void 0:t.theme,isInverted:!!(null===(n=e.OriginalOptions.theme)||void 0===n?void 0:n.isInverted)});s._updateLogoPreview(e.OriginalOptions.logoUrl,!e.OriginalOptions.logoCustomized);if(s._extendedSiteHeaderEnabled){s._updateBackgroundPreview(e.OriginalOptions.backgroundUrl,!e.OriginalOptions.backgroundCustomized);s._updateBackgroundFocalPoint(e.OriginalOptions.backgroundFocalPoint)}e.PreviewOptions=JSON.parse(JSON.stringify(e.OriginalOptions))};this._loadAndRememberCurrentTheme=function(t){return s._themeProvider.loadFullFormattedThemeData(t).then(function(t){var n=b.t.isActivated("6EC985BD-B232-48E1-BF51-9F5F07912665","08/17/2021")?{name:p.currentTheme,theme:t&&t.palette}:{name:p.currentTheme,isInverted:t&&t.isInverted,theme:t&&t.palette};e.OriginalOptions.theme=n;e.PreviewOptions.theme=e.PreviewOptions.theme||n;s._originalThemePromise=null;return n})};this._getAllThemes=function(){return s._tenantThemeProvider.getTenantThemingOptions().then(function(e){var t=[];e.themes.forEach(function(e){t.push({name:e.name,isInverted:e.theme.isInverted,backgroundImageUri:e.theme.backgroundImageUri,theme:s._convertPaletteToHTMLStrings(e.theme.palette),error:e.error})});return{defaultThemes:e.hideDefaultThemes?null:s._getDefaultThemes(),customThemes:t}})};this._convertPaletteToHTMLStrings=function(e){var t={};for(var n in e)e[n]&&(t[n]=c.e.toHtmlString(e[n]));return t};this._getDefaultThemes=function(){var e=Object(u.n)(),t=[];if(p)for(var n in p)if(e[n]){e[n].name=p[n];e[n].extraData={isOutOfBoxTheme:!0};t.push(e[n])}return t};this._updateLogoPreview=function(t,n){void 0===n&&(n=!1);e.PreviewOptions.logoCustomized=!n;e.PreviewOptions.logoUrl=n?void 0:t;h.e.applySettings({logoPreview:e.PreviewOptions.logoUrl,hasLogoPreview:e.PreviewOptions.logoCustomized})};this._updateBackgroundPreview=function(t,n){void 0===n&&(n=!1);e.PreviewOptions.backgroundCustomized=!n;e.PreviewOptions.backgroundUrl=n?void 0:t;h.e.applySettings({backgroundPreview:e.PreviewOptions.backgroundUrl,hasBackgroundPreview:e.PreviewOptions.backgroundCustomized})};this._updateBackgroundFocalPoint=function(t){e.PreviewOptions.backgroundFocalPoint=t;h.e.applySettings({backgroundFocalPoint:e.PreviewOptions.backgroundFocalPoint})};var E=Object(m.e)(t.pageContext),S=h.e.getSettings(["chromeOptions"]).chromeOptions;if(S)for(var x in E)E[x]=Object(r.__assign)(Object(r.__assign)({},E[x]),S[x]);e.OriginalOptions={chromeOptions:E,theme:void 0,logoUrl:h.e.getSettings(["logoPreview"]).logoPreview,logoCustomized:h.e.getSettings(["hasLogoPreview"]).hasLogoPreview,footerLinks:h.e.getSettings(["footerLinks"]).footerLinks,backgroundUrl:h.e.getSettings(["backgroundPreview"]).backgroundPreview,backgroundCustomized:h.e.getSettings(["hasBackgroundPreview"]).hasBackgroundPreview,backgroundFocalPoint:(null===(n=t.pageContext)||void 0===n?void 0:n.focalPoint)||{x:50,y:50}};e.PreviewOptions=JSON.parse(JSON.stringify(e.OriginalOptions));this._themeProvider=t.themeProvider?t.themeProvider:Object(f.e)(t.pageContext);this._tenantThemeProvider=t.TenantThemesProvider?t.TenantThemesProvider:new l.e({pageContext:t.pageContext});this._originalThemePromise=this._loadAndRememberCurrentTheme(!0);this._extendedSiteHeaderEnabled=Object(o.e)(t.pageContext);this._pageContext=t.pageContext}e._getGeneratedThemeColors=function(e){return e?{primaryBackground:e.PageBackground||e.backgroundColor,primaryText:e.primaryText||e.neutralPrimary,backgroundOverlay:e.BackgroundOverlay,suiteBarBackground:e.SuiteBarBackground||e.themePrimary,suiteBarText:e.SuiteBarText||e.white,suiteBarDisabledText:e.SuiteBarDisabledText||e.neutralLight,topBarBackground:e.TopBarBackground||e.neutralLight,topBarText:e.TopBarText||e.neutralSecondary,topBarHoverText:e.TopBarHoverText||e.neutralPrimary,dialogBorder:e.DialogBorder||e.neutralLighter}:{}};return e})(),S=n(84),x=n(44),T=n(163),N=n(3858),C=n(2996),k=n(18),L=n(4273),A=n(4274),O=n(4632),M=n(2058),_=n(806),D=n(4631),P=n(3499),H=n(142),B=n(4551),j=n(2576),F=n(2422);var I=n(245),q=n(2244),R=n(30),U=n(341),z={ODB:1067},W={ODB:60340};function X(){return!b.t.isActivated("cd085c87-5bf4-4d47-be09-c46ac94eee19","08/05/2021")}var V=(function(){function e(e){var t=this;this.getRenderProps=function(){var e=t._canEditCurrentTheme(),n=t._getEditingThemeProps(),r=n.colorThemes,i=n.accentColorMap,s=t._isThemeLocked(),o=s?k.format(N.r,t._hubSiteName):void 0,u=function(n){var u=n.customThemes,a=n.defaultThemes,f=[E.OriginalOptions.theme];s||(f=u);return{themeCustomizerProps:{themes:f,onThemeClick:t._onThemeClick,onUneditableThemeClick:t._onUneditableThemeClick,isThemeLocked:s,themeLockedText:o,errorText:t._errorText,onEditThemeClick:t._onEditThemeClick,currentlyAppliedTheme:E.OriginalOptions.theme,defaultThemes:a,currentThemeEditable:e,currentlySelectedTheme:E.PreviewOptions.theme,editingTheme:t._editingTheme,colorThemes:r,accentColorMap:i},headerCustomizerProps:{options:E.PreviewOptions.chromeOptions.header,onChange:t._themeManager.previewDiffNewChromeOptions,onLogoChange:t._onLogoChange,onRectLogoChange:t._onRectLogoChange,onBackgroundImageChange:t._onBackgroundImageChange,imageUrls:t._params.headerImageUrls,onHeaderEmphasisChanged:t._onHeaderEmphasisChanged,selectedEmphasis:E.PreviewOptions.chromeOptions.header.emphasis,pageContext:t._pageContext,onHideTitleChange:t._themeManager.previewDiffNewChromeOptions,selectedLogoAlignment:E.PreviewOptions.chromeOptions.header.logoAlignment,onBackgroundImageFocalPointChange:t._onBackgroundImageFocalPointChange},pageContext:t._pageContext,onSave:t._onSave,saveEnabled:!0,onCancel:t._onCancel,isOpen:t._isOpen,onDismiss:t._onDismiss,changeTheLookPageLink:t._getClassicChangeTheLookUrl(),isLoading:t._loading,isSaving:t._saving,onBackButtonClick:t._onBackClick,renderL2PanelType:t._renderL2PanelType,renderL3PanelType:t._renderL3PanelType,chromeOptions:E.PreviewOptions.chromeOptions,onChromeOptionsChanged:t._themeManager.previewDiffNewChromeOptions,onEditChromeOptionsClick:t._onEditChromeOptionsClick,onFooterTranslationClick:t._onFooterTranslationClick,onFooterLinksEditClicked:t._onFooterLinksEditClicked,exitL3Panel:t._exitL3Panel,footerOptions:t._currFooterOptions,onFooterOptionsChanged:t._onFooterOptionsChanged,footerTitleKey:t._footerTitleKey,footerTitleCurrentLCID:t._footerTitleCurrentLCID,emptyImageUrl:t._params.emptyImageUrl,isHubSite:t._pageContext.isHubSite,navImageUrls:t._params.navImageUrls}},a=new S.e({name:"ChangeTheLookPanelStateManager.LoadThemes"});return t._themeManager.getAvailableThemesPromise().then(function(e){var n=[];if(e.defaultThemes&&e.defaultThemes.length)for(var r=0,i=e.defaultThemes;r<i.length;r++){(l=i[r]).error?t._errorText=N.t:n.push(l)}var s=[];if(e.customThemes&&e.customThemes.length)for(var o=0,f=e.customThemes;o<f.length;o++){var l;(l=f[o]).error?t._errorText=N.t:s.push(l)}a.end({resultType:x.e.Success});return u({currentTheme:e.currentTheme,customThemes:s,defaultThemes:n})},function(e){a.end({resultType:x.e.Failure,error:"There was an error while loading the themes: "+JSON.stringify(e)});t._errorText=N.t;return u({currentTheme:E.PreviewOptions.theme,customThemes:[],defaultThemes:[]})})};this._onDismiss=function(){if(t._isOpen){t._isOpen=!1;var e=E.PreviewOptions.chromeOptions;X()?T.e.logData({name:"ChangeTheLookPanelStateManager.Cancel.Click",extraData:{nav:e.nav}}):T.e.logData({name:"ChangeTheLookPanelStateManager.Cancel.Click"});var n=new S.e({name:"ChangeTheLookPanelStateManager.CancelClick"});try{t._themeManager.cancelPreview();n.end({resultType:x.e.Success})}catch(e){n.end({resultType:x.e.Failure,error:e})}t._updateStateWithRenderProps(function(){return t._verifyAndCallFunction(t._params.onDismiss)})}};this._onSave=function(){var e,n,u=new S.e({name:"ChangeTheLookPanelStateManager.SaveTheme"}),a=[];void 0!==t._renderL2PanelType&&T.e.logData({name:"ChangeTheLookPanelStateManager.Save"+t._renderL2PanelType+".Click"});var f=Object(U.e)(E.OriginalOptions.chromeOptions.nav,E.PreviewOptions.chromeOptions.nav);t._themeManager.savingOptions();var l=t._isServerVersionAtLeast("16.0.20020.12764");if(l){var c=I.n.isFeatureEnabled(z),h=E.PreviewOptions.chromeOptions,p={headerLayout:h.header.layout,headerEmphasis:h.header.emphasis,megaMenuEnabled:h.nav.megaMenuEnabled,footerEnabled:!h.footer.hidden,footerLayout:h.footer.layout,footerEmphasis:h.footer.emphasis,hideTitleInHeader:c?h.header.hideTitle:void 0,logoAlignment:h.header.logoAlignment};w.e(W,t._pageContext,{experimentFlightId:90024,killSwitch:"39702562-b8cb-4062-acff-022dc2cb0606"})&&(p.horizontalQuickLaunch=h.nav.placement===H.i.HORIZONTAL);f&&X()&&T.e.logData({name:"SPSettings.ChangeTheLook.Navigation.Save",extraData:Object(r.__assign)(Object(r.__assign)({},h.nav),{siteType:t._pageContext.webTemplate})});a.push(function(){return t._chromeOptionsDataSource.setChromeOptions(p).then(function(){return t._getLogoSaverPromise()})})}else{a.push(function(){return t._chromeOptionsDataSource.setNavMegaMenu(E.PreviewOptions.chromeOptions.nav.megaMenuEnabled)});a.push(function(){return t._chromeOptionsDataSource.setFooterVisibility(!E.PreviewOptions.chromeOptions.footer.hidden).then(function(){return t._getLogoSaverPromise()})});a.push(function(){return t._chromeOptionsDataSource.setHeaderLayout(E.PreviewOptions.chromeOptions.header.layout)})}t._logoEdited&&a.push((function(e){var t=e.imageFile,n=e.pageContext;if(Object(s.s)(n)){var r=new B.e({pageContext:n});return function(){if(t){if(-1===j.n.indexOf(t.type))throw new Error(F.h);if(t.size>j.e)throw new Error(F.c);return r.setGroupImage(t).catch(function(e){throw e&&e.status&&404===e.status?new Error(F.f):new Error(F.l)})}}}var i=new P.e(n);if(t){var o="__sitelogo__"+t.name;return function(){return Object(M.e)(new D.e(n),i,o,t).then(function(e){return b.t.isActivated("bedcb6d9-f854-4548-8b3f-a4e9344d97ef","01/14/2021","Switch to SetSiteLogo API")?i.setBasicWebProperties({siteLogoUrl:Object(s.r)(n)+e.serverRelativeUrl}):i.setSiteLogo(e.serverRelativeUrl,0,0)})}}if(null===t)return b.t.isActivated("bedcb6d9-f854-4548-8b3f-a4e9344d97ef","01/14/2021","Switch to SetSiteLogo API")?function(){return i.setBasicWebProperties({siteLogoUrl:""})}:function(){return i.setSiteLogo("",0,0)}})({imageFile:t._newSiteLogo,pageContext:t._pageContext}));if(I.n.isFeatureEnabled(z)){t._rectLogoEdited&&a.push((function(e,t){var n=new P.e(t);if(e){var r="__rectSitelogo__"+e.name;return function(){return Object(M.e)(new D.e(t),n,r,e).then(function(e){return n.setSiteLogo(e.serverRelativeUrl,0,1)})}}if(null===e)return function(){return n.setSiteLogo("",0,1)}})(t._newRectSiteLogo,t._pageContext));l||a.push(function(){return t._chromeOptionsDataSource.setTitleVisibility(E.PreviewOptions.chromeOptions.header.hideTitle)})}Object(o.e)(t._pageContext)&&t._backgroundImageEdited&&a.push((function(e,t,n){var r=new P.e(n);if(e){var i="__extendedHeaderBackgroundImage__"+e.name;return function(){return Object(M.e)(new D.e(n),r,i,e).then(function(e){var n,i;r.setSiteLogo(encodeURIComponent(e.serverRelativeUrl),2,0,null===(n=t)||void 0===n?void 0:n.x,null===(i=t)||void 0===i?void 0:i.y)})}}return null===e?function(){return r.setSiteLogo("",2)}:function(){var e,n;return r.setSiteLogo("",2,0,null===(e=t)||void 0===e?void 0:e.x,null===(n=t)||void 0===n?void 0:n.y,!0)}})(t._newBackgroundImage,t._backgroundFocalPoint,t._pageContext));!b.t.isActivated("e04142b5-2f68-499c-b44f-60e54d1c82a1")&&Object(_.e)(t._pageContext)&&R.e.hasPermission(t._pageContext.webPermMasks,R.e.manageWeb)&&a.push(function(){return t._webDataSource.setBasicWebProperties({quickLaunchEnabled:E.PreviewOptions.chromeOptions.nav.quickLaunchEnabled})});if(!l){a.push(function(){return t._chromeOptionsDataSource.setFooterLayout(E.PreviewOptions.chromeOptions.footer.layout)});a.push(function(){return t._chromeOptionsDataSource.setFooterEmphasis(E.PreviewOptions.chromeOptions.footer.emphasis)})}T.e.logData({name:"ChangeTheLookPanelStateManager.SaveTheme.Click",extraData:Object(r.__assign)(Object(r.__assign)({},null===(e=E.PreviewOptions.theme)||void 0===e?void 0:e.extraData),{isInverted:null===(n=E.PreviewOptions.theme)||void 0===n?void 0:n.isInverted})});l||a.push(function(){return new L.e(t._pageContext).setHeaderEmphasis(E.PreviewOptions.chromeOptions.header.emphasis).then(function(e){t._pageContext.headerEmphasis=Number(E.PreviewOptions.chromeOptions.header.emphasis)})});t._loading=!0;t._saving=!0;t._updateStateWithRenderProps();a.push(function(){return new i.n(function(e){t._updateStateWithRenderProps(function(){t._themeBeingEdited&&(t._themeBeingEdited=E.PreviewOptions.theme);t._themeManager.saveTheme().then(function(n){t._pageContext.themedCssFolderUrl=n;u.end({resultType:x.e.Success});e()},function(t){u.end({resultType:x.e.Failure,error:t});e()})})})});return i.n.serial(a).then(function(){t._logoEdited=!1;t._rectLogoEdited=!1;t._backgroundImageEdited=!1;t._pageContext.isHubSite&&t._hubDataSource.getHubData(!0,!0);t._verifyAndCallFunction(t._params.onSave)}).catch(function(e){i.n.reject(e);e&&e.message&&(t._errorText=e.message.value||e.message)}).then(function(){t._loading=!1;t._saving=!1;t._updateStateWithRenderProps()})};this._onCancel=function(){t._onDismiss()};this._onFooterTranslationClick=function(){t._renderL3PanelType="MUIEditing";t._updateStateWithRenderProps()};this._exitL3Panel=function(e,n,r){void 0===e&&(e=!1);t._renderL3PanelType="";if(e){var i=new S.e({name:"ChangeTheLookPanelStateManager.ExitL3"});try{t._themeManager.cancelPreview();n&&t._onFooterOptionsChanged({name:n,translatedTitles:r});i.end({resultType:x.e.Success})}catch(e){i.end({resultType:x.e.Failure,error:e})}}t._updateStateWithRenderProps()};this._onFooterLinksEditClicked=function(e){t._verifyAndCallFunction(t._params.onFooterLinksEditClicked)};this._onThemeClick=function(e,n){var r;if("Theme"===t._renderL2PanelType&&t._editingTheme){r=new S.e({name:"ChangeTheLookPanelStateManager.EditThemePreviewClick"});T.e.logData({name:"ChangeTheLookPanelStateManager.EditThemePreview.Click"})}else{r=new S.e({name:"ChangeTheLookPanelStateManager.PreviewThemeClick"});T.e.logData({name:"ChangeTheLookPanelStateManager.PreviewTheme.Click"})}if(n){E.PreviewOptions.theme=n;t._updateStateWithRenderProps(function(){try{t._themeManager.previewTheme(n);r.end({resultType:x.e.Success})}catch(e){r.end({resultType:x.e.Failure,error:"There was an error attempting to preview the theme"});t._errorText=N.n;t._updateStateWithRenderProps()}})}else{r.end({resultType:x.e.Failure,error:"No theme was provided to preview"});t._errorText=N.n;t._updateStateWithRenderProps()}};this._onEditThemeClick=function(e){T.e.logData({name:"ChangeTheLookPanelStateManager.EditTheme.Click"});t._editingTheme=!0;t._themeBeingEdited=E.PreviewOptions.theme;e.stopPropagation();t._updateStateWithRenderProps()};this._onEditChromeOptionsClick=function(e){t._renderL2PanelType=e.currentTarget.dataset.chromeType;X()&&T.e.logData({name:"SPSettings.ChangeTheLook."+e.currentTarget.dataset.chromeType+".Click",extraData:{siteType:t._pageContext.webTemplate}});e.stopPropagation();t._updateStateWithRenderProps()};this._onBackClick=function(e){if("Theme"===t._renderL2PanelType&&t._editingTheme){var n=new S.e({name:"ChangeTheLookPanelStateManager.ExitEditThemeClick"});T.e.logData({name:"ChangeTheLookPanelStateManager.ExitEditTheme.Click"});t._editingTheme=!1;t._themeBeingEdited=null;n.end({resultType:x.e.Success})}else{T.e.logData({name:"ChangeTheLookPanelStateManager.Exit"+t._renderL2PanelType+".Click"});void 0!==t._renderL3PanelType&&""!==t._renderL3PanelType?t._renderL3PanelType="":t._renderL2PanelType=""}e.stopPropagation();t._updateStateWithRenderProps()};this._onHeaderEmphasisChanged=function(e){t._themeManager.previewHeaderEmphasis(e)};this._onLogoChange=function(e,n){t._logoEdited=!0;t._newSiteLogo=e||null;t._themeManager.previewLogo(e,n)};this._onRectLogoChange=function(e,n){t._rectLogoEdited=!0;t._newRectSiteLogo=n||null;t._themeManager.previewLogo(n,e)};this._onBackgroundImageChange=function(e,n){t._backgroundImageEdited=!0;t._newBackgroundImage=n||null;t._themeManager.previewBackgroundImage(n,e)};this._onBackgroundImageFocalPointChange=function(e){t._backgroundImageEdited=!0;t._backgroundFocalPoint=e;t._themeManager.previewBackgroundImageFocalPoint(e)};this._onFooterOptionsChanged=function(e){t._currFooterOptions=Object(r.__assign)(Object(r.__assign)({},t._currFooterOptions),e);var n,i=[];void 0!==e.logoUrl&&i.push({url:e.logoUrl,name:"2e456c2e-3ded-4a6c-a9ea-f7ac4c1b5100"});if(void 0!==e.name||void 0!==e.translatedTitles){var s=void 0;if(void 0!==e.translatedTitles){var o=q.t.getDisplayLanguage(e.translatedTitles,t._pageContext);n=o[0].code;s=t._footerTitleKey?void 0:o[1].value;t._footerTitleCurrentLCID=n}i.push({url:void 0,name:"7376cd83-67ac-4753-b156-6a7b3fa0fc1f",links:[{url:void 0,name:e.name,webDefaultTitle:s,currentLCID:n,translatedTitles:e.translatedTitles}]})}t._themeManager.previewFooterOptionsChange(i)};this._params=e;this._pageContext=e.pageContext;this._themeManager=new E({pageContext:e.pageContext});this._editingTheme=!1;this._renderL2PanelType="";this._renderL3PanelType="";this._isOpen=!0;this._errorText="";this._hubSiteName="";this._loading=!0;this._saving=!1;this._hubDataSource;this._chromeOptionsDataSource=new A.e(this._pageContext);this._logoEdited=!1;this._rectLogoEdited=!1;this._backgroundImageEdited=!1;this._editNavDataSource=new O.e(this._pageContext);this._hubDataSource=new C.HubDataSource(this._pageContext);this._webDataSource=new P.e(this._pageContext);this._spListCollectionDataSource=new D.e(this._pageContext);this._currFooterOptions={};this._updateStateWithRenderProps();T.e.logData({name:"ChangeTheLookPanelStateManager.LoadPanel"})}e.prototype.componentDidMount=function(){var e=this,t=[];this._isThemeLocked()&&t.push(this._hubDataSource.getHubData().then(function(t){e._hubSiteName=t.name}));t.push(this._editNavDataSource.getMenuState({menuNodeKey:"13b7c916-4fea-4bb2-8994-5cf274aeb530"}).then(function(t){for(var n=0,r=t.links;n<r.length;n++){var i=r[n];if("2e456c2e-3ded-4a6c-a9ea-f7ac4c1b5100"===i.name)e._currFooterOptions.logoUrl=i.url;else if("7376cd83-67ac-4753-b156-6a7b3fa0fc1f"===i.name&&i.links&&i.links.length>0){var s=i.links[0];e._currFooterOptions.name=s.name;e._footerTitleCurrentLCID=s.currentLCID;e._footerTitleKey=s.key}if(e._currFooterOptions.name&&e._currFooterOptions.logoUrl)break}}));var n=function(){e._loading=!1;e._updateStateWithRenderProps()};i.n.all(t).then(n,n)};e.prototype.componentWillUnmount=function(){this._onDismiss()};e.prototype._updateStateWithRenderProps=function(e){var t=this;this.getRenderProps().then(function(n){t._params.updateState(n,e)})};e.prototype._isServerVersionAtLeast=function(e){var t="$$".length,n=this._pageContext&&this._pageContext.siteClientTag,r=n&&n.indexOf("$$"),i=r&&n.substr(r+t),s=i&&i.split("."),o=e&&e.split(".");if(s&&o&&4===s.length&&4===o.length){for(var u=0;u<4;u++){var a=+s[u],f=+o[u];if(f<a)return!0;if(a<f)return!1}return!0}return!1};e.prototype._getLogoSaverPromise=function(){var e=this,t=[],n=i.n.resolve();if(this._currFooterOptions.logoFile){var r="__footerlogo__"+this._currFooterOptions.logoFile.name;n=Object(M.t)(this._spListCollectionDataSource,this._webDataSource,r,this._currFooterOptions.logoFile).then(function(n){e._currFooterOptions.logoUrl=Object(s.r)(e._pageContext)+n.serverRelativeUrl;t.push({name:"2e456c2e-3ded-4a6c-a9ea-f7ac4c1b5100",url:e._currFooterOptions.logoUrl})})}else""===this._currFooterOptions.logoUrl&&t.push({name:"2e456c2e-3ded-4a6c-a9ea-f7ac4c1b5100",url:void 0,isDeleted:!0});if(void 0===this._currFooterOptions.name)t.push({url:void 0,name:"7376cd83-67ac-4753-b156-6a7b3fa0fc1f",isDeleted:!0});else{var o=void 0;if(void 0!==this._currFooterOptions.translatedTitles){var u=q.t.getDisplayLanguage(this._currFooterOptions.translatedTitles,this._pageContext);o=this._footerTitleKey?void 0:u[1].value}t.push({url:void 0,name:"7376cd83-67ac-4753-b156-6a7b3fa0fc1f",links:[{url:void 0,name:this._currFooterOptions.name,webDefaultTitle:o,translatedTitles:this._currFooterOptions.translatedTitles}]})}return n.then(function(){return e._editNavDataSource.onSave(t,void 0,"13b7c916-4fea-4bb2-8994-5cf274aeb530").then(function(){})})};e.prototype._onUneditableThemeClick=function(){};e.prototype._getEditingThemeProps=function(){return{colorThemes:this._getColorThemes(),accentColorMap:this._getAccentColors()}};e.prototype._getColorThemes=function(){var e=this._themeBeingEdited;if(e)return this._themeManager.getColorThemes(e.isInverted,e.theme.primaryBackground)};e.prototype._getAccentColors=function(){var e=this._themeBeingEdited;if(e)return this._themeManager.getAccentColors(e.theme.primaryBackground)};e.prototype._canEditCurrentTheme=function(){var e=E.PreviewOptions.theme;if(e&&e.theme){var t=this._themeManager.getColorThemes()[e.theme.themePrimary],n=this._themeManager.getColorThemes(!0,e.theme.primaryBackground)[e.theme.themePrimary];if(t&&t.primaryBackground===e.theme.primaryBackground||n&&n.primaryBackground===e.theme.primaryBackground)return!0}return!1};e.prototype._getClassicChangeTheLookUrl=function(){return this._pageContext.webAbsoluteUrl+"/"+this._pageContext.layoutsUrl+"/designgallery.aspx"};e.prototype._verifyAndCallFunction=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];e&&"function"==typeof e&&e.apply(void 0,t)};e.prototype._isThemeLocked=function(){var e=this._pageContext,t=e.isHubSite;return e.hubSiteId&&!t};return e})()},2195:function(e,t,n){"use strict";n.r(t);n.d(t,"SiteScriptProgressIndicator",function(){return y});var r=n(0),i=n("react-lib"),s=n(102),o=n(1783),u=n(1780),a=n(163),f=n(2209),l=n(4283),c=n(70),h=n(1259),p=n(1328),d=n(3008),v=n(245),m=Object(c.e)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee(18,4574)];case 1:return[2,e.sent().WebTemplatesGalleryDialog]}})})}),g=Object(c.e)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([487,"ondemand.resx-ondemand"],4545)];case 1:return[2,e.sent().SiteScriptProgressPanel]}})})}),y=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._onNewDataReceived=function(e){if(e.isSiteDesignPending&&!n._firstRunPanelExperience){a.e.logData({name:"SiteScripts.BarAppeared"});n._firstRunPanelExperience=!0}var t=!1;e.canRenderWebTemplatesGalleryFirstRun&&Object(h.r)(n.props.pageContext)&&(t=!0);n.setState({isComplete:n._siteScriptProgressStateManager.isRunComplete(e.displayedRunKey),isVisible:e.isSiteDesignPending,renderWebTemplatesGalleryFirstRun:t,siteDesignId:e.displayedSiteDesignId})};n._onOpenPanelAction=function(e){a.e.logData({name:"SiteScripts.OpenPanelFromGear.Click"});n.state.isPanelOpen||n.setState({isPanelOpen:!0})};n._onClickOpenPanel=function(e){a.e.logData({name:"SiteScripts.OpenPanelFromBar.Click"});n.setState({isPanelOpen:!0});e.stopPropagation();e.preventDefault()};n._onClickRefreshPage=function(e){a.e.logData({name:"SiteScripts.RefreshFromBar.Click"});window.location.href=n.props.pageContext?n.props.pageContext.webServerRelativeUrl:window.location.href};n._onPanelDismissed=function(){n.setState({isPanelOpen:!1})};n.state={isPanelOpen:!1,isComplete:!1,isVisible:!1,renderWebTemplatesGalleryFirstRun:!1,useWebTemplatesGallery:v.n.isFeatureEnabled({ODB:1047})};n._siteScriptProgressStateManager=f.SiteScriptProgressStateManager.getInstance({pageContext:t.pageContext});n._panelWasEverOpen=!1;n._firstRunPanelExperience=!1;return n}t.prototype.componentDidMount=function(){this._siteScriptProgressManagerKey="SiteScriptProgressIndicator"+Math.random().toString();this._siteScriptProgressStateManager.registerCallback(this._siteScriptProgressManagerKey,f.SiteScriptProgressCallbackType.newProgressData,this._onNewDataReceived);this._siteScriptProgressStateManager.registerCallback(this._siteScriptProgressManagerKey,f.SiteScriptProgressCallbackType.openPanelAction,this._onOpenPanelAction)};t.prototype.componentWillUnmount=function(){this._siteScriptProgressStateManager.unregisterCallback(this._siteScriptProgressManagerKey,f.SiteScriptProgressCallbackType.newProgressData);this._siteScriptProgressStateManager.unregisterCallback(this._siteScriptProgressManagerKey,f.SiteScriptProgressCallbackType.openPanelAction)};t.prototype.render=function(){var e,t;this._panelWasEverOpen=this._panelWasEverOpen||this.state.isPanelOpen;if(this.state.isVisible||this._siteScriptProgressStateManager.getState().isSiteDesignPending)if(this.state.isComplete){3!==(v=l.t.split(/{[01]}/)).length&&(v=[l.t,"",""]);var n=this.state.useWebTemplatesGallery?l.i:l.s,a=i.createElement(u.e,{onClick:this._onClickOpenPanel,"data-automationid":"SiteScriptProgressOpenPanelLink"},n),f=i.createElement(u.e,{onClick:this._onClickRefreshPage},l.e),c=void 0;c=l.t.indexOf("{0}")<=l.t.indexOf("{1}")?[a,f]:[f,a];var h=this.state.useWebTemplatesGallery?s.e.success:s.e.warning;t=i.createElement(o.e,{messageBarType:h},v[0],c[0],v[1],c[1],v[2])}else{var v,y=this.state.useWebTemplatesGallery?l.n:l.r;2!==(v=y.split("{0}")).length&&(v=[y,""]);t=i.createElement(o.e,{messageBarType:s.e.warning},v[0],i.createElement(u.e,{onClick:this._onClickOpenPanel,"data-automationid":"SiteScriptProgressOpenPanelLink"},l.o),v[1])}else{if(this.state.renderWebTemplatesGalleryFirstRun)return i.createElement(p.e,Object(r.__assign)({},{pageContext:this.props.pageContext,imageUrls:{webTemplatesFirstRunIllustration:null===(e=this.props.imageUrls)||void 0===e?void 0:e.webTemplatesFirstRunIllustration}}));if(!this._panelWasEverOpen)return null;t=void 0}return i.createElement("div",null,t,this.state.useWebTemplatesGallery?this.state.isPanelOpen?i.createElement(m,{mode:this.state.isComplete?d.e.progressFinished:d.e.progressStarted,pageContext:this.props.pageContext,onDismiss:this._onPanelDismissed,webTemplateId:this.state.siteDesignId}):null:i.createElement(g,{onDismissed:this._onPanelDismissed,siteScriptProgressStateManager:this._siteScriptProgressStateManager,isOpen:this.state.isPanelOpen,firstRunPanelExperience:this._firstRunPanelExperience,responsiveMode:this.props.responsiveMode,imageUrls:this.props.imageUrls,pageContext:this.props.pageContext}))};return t})(i.Component)},2376:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=(function(){function e(){}e.OFFICE_SUPPORT_HOME_LINK="https://docs.microsoft.com/${locale}/sharepoint/sharepoint-online";e.REGISTER_HUB_SITE_HELP_LINK="https://docs.microsoft.com/${locale}/sharepoint/create-hub-site";e.SET_UP_HUB_SITE_SUPPORT_LINK="https://support.microsoft.com/${locale}/office/e2daed64-658c-4462-aeaf-7d1a92eba098";e.TEMAS_CONNECTED_SITE_HELP_LINK="https://docs.microsoft.com/${locale}/sharepoint/teams-connected-sites";return e})(),i=(function(){function e(){}e.getHelpLink=function(e,t){return e&&0!==e.length?e.replace(/\${locale}/gm,t):r.OFFICE_SUPPORT_HOME_LINK};return e})();t.t=i},2401:function(e,t,n){"use strict";n.d(t,"e",function(){return v});var r=n(0),i=n("react-lib"),s=n(965),o=n(40),u=n(1617),a=n(395),f=n(4148),l=n(2686),c=n(4264),h=(function(e){Object(r.__extends)(t,e);function t(t){return e.call(this,t)||this}t.prototype.render=function(){var e=this.props,t=e.panelProps,n=e.isOpen,s=e.onDismiss,o=e.isWidgetRendered,h=e.showError,d=e.errorImgUrl;return i.createElement(f.e,Object(r.__assign)({},t,{className:"ms-FlowWidgetPanel ms-FlowWidgetPanel-safariFix",type:l.e.smallFixedFar,isLightDismiss:!0,isOpen:n,onDismiss:s,closeButtonAriaLabel:c.e}),i.createElement("div",{className:"ms-FlowPanel-contents","data-automationid":"flowControl"},!o&&!h&&i.createElement(u.e,{className:"ms-FlowPanel-center",size:a.e.large}),h&&i.createElement("div",{className:"ms-FlowPanel-center"},i.createElement("img",{className:"ms-FlowPanel-errorImage",role:"presentation",src:d}),i.createElement("div",{className:"ms-FlowPanel-errorMessage ms-font-s ms-fontColor-neutralSecondary"},c.t)),i.createElement(p,Object(r.__assign)({},this.props))))};return t})(s.e),p=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._iframeContainer=i.createRef();return n}t.prototype.render=function(){var e=this.props,t=e.showError,n=e.isWidgetRendered;return i.createElement("div",{className:Object(o.e)("ms-FlowPanel-iframeContainer",{"ms-FlowPanel--hidden":t,"ms-FlowPanel--loadingWidget":!n}),ref:this._iframeContainer,"aria-hidden":!n})};t.prototype.componentDidMount=function(){this.props.isOpen&&this.props.onIFrameContainerRendered&&this.props.onIFrameContainerRendered(this._iframeContainer.current)};t.prototype.componentDidUpdate=function(e){!e.isOpen&&this.props.isOpen&&this.props.onIFrameContainerRendered&&this.props.onIFrameContainerRendered(this._iframeContainer.current)};return t})(s.e),d=n(3495),v=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._onDismiss=function(){n._flowWidgetProvider&&n._flowWidgetProvider.dispose();n.props.onDismiss&&n.props.onDismiss()};n._onIFrameContainerRendered=function(e){var t=n.props.widgetParams;t.widgetStyleSettings||(t.widgetStyleSettings={backgroundColor:"white"});n._getFlowWidgetProvider().launchFlowWidget(e,t)};n._onWidgetRendered=function(){n.setState({isWidgetRendered:!0});n.props.onWidgetRendered&&n.props.onWidgetRendered()};n._onWidgetError=function(e){n.setState({showError:!0});n.props.onWidgetError&&n.props.onWidgetError(e)};n._onTokenError=function(e){n.props.onTokenError&&n.props.onTokenError(e)};n._onFlowCreationSucceeded=function(e,t){n.props.onFlowCreationSucceeded&&n.props.onFlowCreationSucceeded(e,t)};n._onFlowCreationFailed=function(e){n.props.onFlowCreationFailed&&n.props.onFlowCreationFailed(e)};n._onWidgetClose=function(e){n.props.onWidgetClose&&n.props.onWidgetClose(e)};n._onTriggerFlowStarted=function(e){n.props.onTriggerFlowStarted&&n.props.onTriggerFlowStarted(e)};n._onTriggerFlowSucceeded=function(e,t){n.props.onTriggerFlowSucceeded&&n.props.onTriggerFlowSucceeded(e,t)};n._onTriggerFlowDoneClicked=function(e){n.props.onTriggerFlowDoneClicked&&n.props.onTriggerFlowDoneClicked(e)};n._onTriggerFlowCancelClicked=function(e){n.props.onTriggerFlowCancelClicked&&n.props.onTriggerFlowCancelClicked(e)};n._onApprovalStatusChanged=function(e){n.props.onApprovalStatusChanged&&n.props.onApprovalStatusChanged(e)};n._onGetStrings=function(e){n.props.onGetStrings&&n.props.onGetStrings(e)};n.state={isWidgetRendered:!1,showError:!1};return n}t.prototype.render=function(){return i.createElement(h,Object(r.__assign)({},this.getRenderProps()))};t.prototype.getRenderProps=function(){var e=this.props,t=this.state;return{isOpen:e.isOpen,isWidgetRendered:t.isWidgetRendered,showError:t.showError,errorImgUrl:e.errorImgUrl,panelProps:e.panelProps,onDismiss:this._onDismiss,onIFrameContainerRendered:this._onIFrameContainerRendered}};t.prototype._getFlowWidgetProvider=function(){this._flowWidgetProvider||(this._flowWidgetProvider=new d.e({onWidgetRendered:this._onWidgetRendered,onWidgetError:this._onWidgetError,onTokenError:this._onTokenError,onFlowCreationSucceeded:this._onFlowCreationSucceeded,onFlowCreationFailed:this._onFlowCreationFailed,onWidgetClose:this._onWidgetClose,onTriggerFlowStarted:this._onTriggerFlowStarted,onTriggerFlowSucceeded:this._onTriggerFlowSucceeded,onTriggerFlowDoneClicked:this._onTriggerFlowDoneClicked,onTriggerFlowCancelClicked:this._onTriggerFlowCancelClicked,onApprovalStatusChanged:this._onApprovalStatusChanged,onGetStrings:this._onGetStrings},{pageContext:this.props.pageContext,oAuthTokenProvider:this.props.oAuthTokenProvider}));return this._flowWidgetProvider};return t})(s.e);t.t=v},2461:function(e,t,n){"use strict";n.d(t,"e",function(){return D});var r=n(0),i=n("react-lib"),s=n(40),o=n(965),u=n(1608),a=n(1616),f=n(1115),l=n(3771),c=n(2473),h=n(537),p=n(1780),d=n(1627),v="teamsIcon_3918413f",m="infoIcon_3918413f",g="description_3918413f",y="teamifySpinner_3918413f",b=n(4469),w=n(2075),E=n(163),S=n(4551),x=n(18),T=n(4012),N=n(156),C=n(1617),k=n(395),L=n(67),A=n(245),O=n(84),M=i.lazy(function(){return n.ee(87,4860)}),_={ODB:1936},D=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._experimentKillswitch=!1;n._renderTooltipContent=function(){return A.n.isFeatureEnabled(_)||!n._experimentKillswitch?i.createElement("div",{className:"tooltip_3918413f"},b.v):i.createElement("div",{className:"tooltip_3918413f"},b.h,i.createElement("br",null),i.createElement("br",null),Object(w.e)(b.p,b.e,"span",{className:"createTeamText_3918413f"}))};n._onHideTeamifyBanner=function(){new S.e({pageContext:n.props.pageContext}).hideTeamifyBanner();E.e.logData({name:"TeamifyBanner.Hide",isIntentional:!0});n.setState({hasDismissed:!0});n._onCloseHideTeamifyDialog()};n._onDismissTeamifyBanner=function(){var e=new S.e({pageContext:n.props.pageContext});E.e.logData({name:"TeamifyBanner.DismissPermanently",isIntentional:!0});e.dismissTeamifyBanner().then(function(){n._onCloseHideTeamifyDialog();n.setState({hasDismissed:!0})})};n._onClick=function(){if(A.n.isFeatureEnabled(_))n._onClickV2Experience();else if(n._experimentKillswitch)n._onClickV1Experience();else{switch(Object(N.n)(90010,n.props.pageContext)){case 1:n._onClickV2Experience();break;default:n._onClickV1Experience()}}E.e.logData({name:"TeamifyBanner.Click",isIntentional:!0})};n._onClickV2Experience=function(){n._teamifyQos=new O.e({name:"TeamifyWizardLoader.Load"});n._toggleTeamify()};n._onClickV1Experience=function(){n.setState({hasClickedLink:!0});new S.e({pageContext:n.props.pageContext}).teamify().done(function(e){if(void 0!==e){n.setState({responseHasFailure:!1,responseHasSuccess:!0,teamUrl:e});E.e.logData({name:"TeamifyBanner.Teamify.Success",isIntentional:!1})}else n.setState({responseHasFailure:!0})},function(e){n.setState({responseHasFailure:!0})})};n._onCloseHideTeamifyDialog=function(){n.setState({hideTeamifyDialogOpen:!1})};n._onOpenHideTeamifyDialog=function(){E.e.logData({name:"TeamifyBanner.OpenHideDialog",isIntentional:!0});n.setState({hideTeamifyDialogOpen:!0})};n._toggleTeamify=function(){n.setState(function(e){return{showTeamifyWizard:!e.showTeamifyWizard}})};n.state={};n._experimentKillswitch=L.t.isActivated("DB52012D-C103-4653-928C-16AC57D214B9","11/05/2020","Enable v2 Experiment");return n}t.prototype.render=function(){return A.n.isFeatureEnabled(_)?this._renderV2Experience():this._experimentKillswitch?this._renderV1Experience():this._renderExperimentalExperience()};t.prototype.componentDidMount=function(){E.e.logData({name:"TeamifyBanner.Render",isIntentional:!1})};t.prototype._renderV1Experience=function(){var e,t=i.createElement(d.e,{tooltipProps:{onRenderContent:this._renderTooltipContent}},i.createElement(h.e,{iconName:"Info",className:m,tabIndex:0,ariaLabel:"Microsoft Teams. "+b.n}));this.state.hasClickedLink?this.state.responseHasFailure||this.state.responseHasSuccess?this.state.responseHasFailure?e=i.createElement("div",{className:g},b.r):this.state.responseHasSuccess&&(e=i.createElement("div",{className:g},i.createElement(p.e,{href:this.state.teamUrl,target:"_blank"},b.m))):e=i.createElement("div",{className:g},b.n,i.createElement("br",null),i.createElement(C.e,{size:k.e.xSmall,className:y+" "+y})," ",b.t):e=i.createElement("div",{className:g},b.n,i.createElement("span",{className:"toolTipContainer_3918413f"},t),i.createElement("br",null),i.createElement(p.e,{onClick:this._onClick,className:"createTeamLink_3918413f"},b.e));return i.createElement("div",{className:Object(s.e)(this.props.className,"teamifyBanner_3918413f")},this._renderHideTeamifyButton(),i.createElement("div",{className:"titleWrapper_3918413f"},i.createElement(h.e,{className:v,iconName:"TeamsLogoInverse"}),i.createElement("span",{className:"teamsName_3918413f"},"Microsoft Teams")),e)};t.prototype._renderV2Experience=function(){var e=i.createElement(d.e,{tooltipProps:{onRenderContent:this._renderTooltipContent}},i.createElement(h.e,{iconName:"Info",className:m,tabIndex:0}));return i.createElement("div",null,i.createElement("div",{className:Object(s.e)(this.props.className,"teamifyBanner_3918413f")},this._renderHideTeamifyButton(),i.createElement("div",{className:"titleWrapper_3918413f"},i.createElement(h.e,{className:v,iconName:"TeamsLogoInverse"}),i.createElement("span",{className:"teamsName_3918413f"},b.d)),i.createElement("div",{className:g},b.c,i.createElement("span",{className:"toolTipContainer_3918413f"},e),i.createElement("br",null),i.createElement(p.e,{onClick:this._onClick,className:"createTeamLink_3918413f"},b.l))),this.state.showTeamifyWizard&&i.createElement(i.Suspense,{fallback:null},i.createElement(M,{pageContext:this.props.pageContext,onDismiss:this._toggleTeamify,entryPoint:T.e.TeamifyBanner,strings:this.props.teamifyStrings,qos:this._teamifyQos})))};t.prototype._renderExperimentalExperience=function(){var e,t=i.createElement(d.e,{tooltipProps:{onRenderContent:this._renderTooltipContent}},i.createElement(h.e,{iconName:"Info",className:m,tabIndex:0}));this.state.hasClickedLink?this.state.responseHasFailure||this.state.responseHasSuccess?this.state.responseHasFailure?e=i.createElement("div",{className:g},b.r):this.state.responseHasSuccess&&(e=i.createElement("div",{className:g},i.createElement(p.e,{href:this.state.teamUrl,target:"_blank"},b.m))):e=i.createElement("div",{className:g},b.n,i.createElement("br",null),i.createElement(C.e,{size:k.e.xSmall,className:y+" "+y})," ",b.t):e=i.createElement("div",{className:g},b.c,i.createElement("span",{className:"toolTipContainer_3918413f"},t),i.createElement("br",null),i.createElement(p.e,{onClick:this._onClick,className:"createTeamLink_3918413f"},b.l));return i.createElement("div",{className:Object(s.e)(this.props.className,"teamifyBanner_3918413f")},this._renderHideTeamifyButton(),i.createElement("div",{className:"titleWrapper_3918413f"},i.createElement(h.e,{className:v,iconName:"TeamsLogoInverse"}),i.createElement("span",{className:"teamsName_3918413f"},"Microsoft Teams")),e,this.state.showTeamifyWizard&&i.createElement(i.Suspense,{fallback:null},i.createElement(M,{pageContext:this.props.pageContext,onDismiss:this._toggleTeamify,entryPoint:T.e.TeamifyBanner,strings:this.props.teamifyStrings,qos:this._teamifyQos})))};t.prototype._renderHideTeamifyButton=function(){return this.state.hasDismissed?null:[i.createElement(u.e,{className:"hideTeamifyButton_3918413f",ariaLabel:b.i,iconProps:{iconName:"ChromeClose",className:"hideTeamifyIcon_3918413f"},onClick:this._onOpenHideTeamifyDialog}),this._renderHideTeamifyDialog()]};t.prototype._renderHideTeamifyDialog=function(){return i.createElement(l.e,{hidden:!this.state.hideTeamifyDialogOpen,type:c.e.close,dialogContentProps:{type:c.e.close,title:b.a,subText:x.format(b.s,b.u),showCloseButton:!0,onDismiss:this._onCloseHideTeamifyDialog},modalProps:{onDismiss:this._onCloseHideTeamifyDialog},isBlocking:!1},i.createElement("div",{className:"hideTeamifyDialogButtonContainer_3918413f"},i.createElement("div",{className:"hideTeamifyDialogButton_3918413f"},i.createElement(a.e,{onClick:this._onHideTeamifyBanner}," ",b.f," ")),i.createElement("div",{className:"hideTeamifyDialogButton_3918413f"},i.createElement(f.e,{onClick:this._onCloseHideTeamifyDialog}," ",b.o," "))),i.createElement("div",{className:"hideTeamifyDialogButtonContainer_3918413f"},i.createElement(p.e,{className:"dismissPermanentlyLink_3918413f",onClick:this._onDismissTeamifyBanner},b.u)))};return t})(o.e)},2517:function(e,t,n){"use strict";n.d(t,"e",function(){return He});var r,i,s=n(0),o=n("react-lib"),u=n(4148),a=n(2686),f=n(1616),l=n(1115),c=n(1608),h=n(1637),p=n(537),d=n(1780),v=n(40),m=n(488),g=n(536),y=n(965),b=n(1617),w=n(4544),E=n(3000),S=n(142),x=n(4968),T=n(67),N=n(30),C=n(806),k=n(95),L=n(405),A=n(163);(function(e){e.horizontal="horizontal";e.vertical="vertical"})(r||(r={}));function O(e){return"vertical"===e?S.i.LEFT:S.i.HORIZONTAL}(function(e){e.megaMenu="megamenu";e.cascade="cascade"})(i||(i={}));function M(){return!T.t.isActivated("cd085c87-5bf4-4d47-be09-c46ac94eee19","08/05/2021")}var _=(function(e){Object(s.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._navigationSwitcherEnabled=L.e({ODB:60340},n.props.pageContext,{experimentFlightId:90024,killSwitch:"39702562-b8cb-4062-acff-022dc2cb0606"});n._onQuickLaunchToggleChanged=function(e,t){var r=O(n.state.navPlacementSelectedKey);M()&&A.e.logData({name:"SPSettings.ChangeTheLook.Navigation.Visibility."+(t?"On":"Off"),extraData:{siteType:n.props.pageContext.webTemplate}});if(n.props.onChange){var i=Object(s.__assign)(Object(s.__assign)(Object(s.__assign)({},n.props.options),n._currentNavigationProperties),{quickLaunchEnabled:t});n.props.onChange({nav:i})}if(n._navigationSwitcherEnabled){n.setState({quickLaunchEnabled:t});n.updateNav(r,t)}};n._onNavPlacementChanged=function(e,t){var r,i=t.key;if(i!==n.state.navPlacementSelectedKey){M()&&A.e.logData({name:"SPSettings.ChangeTheLook.Navigation.Orientation."+i+".Click",extraData:{siteType:n.props.pageContext.webTemplate}});n.setState({navPlacementSelectedKey:i});var o=O(i),u=Object(s.__assign)(Object(s.__assign)(Object(s.__assign)({},n.props.options),n._currentNavigationProperties),{placement:o});null===(r=n.props)||void 0===r||r.onChange({nav:u});n.updateNav(o,!0)}};n._onMenuStyleChanged=function(e,t){var r=t.key;if(r!==n.state.selectedKey){n.setState({selectedKey:r});var i="megamenu"===r;M()&&A.e.logData({name:"SPSettings.ChangeTheLook.Navigation.MenuStyle."+r+".Click",extraData:{siteType:n.props.pageContext.webTemplate}});var o=Object(s.__assign)(Object(s.__assign)(Object(s.__assign)({},n.props.options),n._currentNavigationProperties),{megaMenuEnabled:i});n.props.onChange&&n.props.onChange({nav:o})}};n.state={navPlacementSelectedKey:n.props.options.placement===S.i.LEFT?"vertical":"horizontal",selectedKey:n.props.options.megaMenuEnabled?"megamenu":"cascade",quickLaunchEnabled:n.props.options.quickLaunchEnabled};return n}Object.defineProperty(t.prototype,"_currentNavigationProperties",{get:function(){return this._navigationSwitcherEnabled?{quickLaunchEnabled:this.state.quickLaunchEnabled,megaMenuEnabled:"megamenu"===this.state.selectedKey,placement:O(this.state.navPlacementSelectedKey)}:{}},enumerable:!0,configurable:!0});t.prototype.render=function(){var e=this.state,t=e.quickLaunchEnabled,n=e.navPlacementSelectedKey,r=!T.t.isActivated("e04142b5-2f68-499c-b44f-60e54d1c82a1")&&Object(C.e)(this.props.pageContext)&&N.e.hasPermission(this.props.pageContext.webPermMasks,N.e.manageWeb)&&o.createElement(x.e,{styles:{root:{marginTop:this._navigationSwitcherEnabled?1:20}},label:this._navigationSwitcherEnabled?E.l:E.f,defaultChecked:this.state.quickLaunchEnabled,onChange:this._onQuickLaunchToggleChanged,onText:this._navigationSwitcherEnabled?E.d:E.p,offText:this._navigationSwitcherEnabled?E.h:E.c}),i=o.createElement(w.e,{styles:{root:{marginTop:16}},label:E.K,selectedKey:this.state.navPlacementSelectedKey,options:[{imageSrc:this.props.imageUrls.horizontal,key:"horizontal",text:E.Q,selectedImageSrc:this.props.imageUrls.horizontal},{imageSrc:this.props.imageUrls.vertical,key:"vertical",text:E.G,selectedImageSrc:this.props.imageUrls.vertical}],onChange:this._onNavPlacementChanged}),s=o.createElement(w.e,{styles:{root:{marginTop:this._navigationSwitcherEnabled?20:void 0}},label:E.V,selectedKey:this.state.selectedKey,options:[{imageSrc:this.props.imageUrls&&this.props.imageUrls.megaMenu,key:"megamenu",text:E.J,selectedImageSrc:this.props.imageUrls&&this.props.imageUrls.megaMenu},{imageSrc:this.props.imageUrls&&this.props.imageUrls.cascade,key:"cascade",text:E.$,selectedImageSrc:this.props.imageUrls&&this.props.imageUrls.cascade}],onChange:this._onMenuStyleChanged}),u=o.createElement(o.Fragment,null,s,r),a=o.createElement(o.Fragment,null,r,this.props.isTeamSite&&t&&i,t&&"horizontal"===n&&s);return o.createElement("div",{className:Object(v.e)("sp-ChangeTheLookPanel-content","sp-ChangeTheLookPanel-customizeNav-layout")},this._navigationSwitcherEnabled?a:u)};t.prototype.updateNav=function(e,t){k.t.raise(window,"UPDATE_NAV_PLACEMENT",{placement:e,quickLaunchEnabled:t})};return t})(y.e),D=n(3322),P=n(2314),H=n(24),B=n(2679),j=n(5041),F=n(377),I=n(1633),q=n(693),R=n(763),U=n(1592),z=n(2998),W=Object(F.e)(),X=(function(e){Object(s.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._onChange=function(e,t){var r=R.e.None;switch(t.key){case String(R.e.Neutral):r=R.e.Neutral;break;case String(R.e.Soft):r=R.e.Soft;break;case String(R.e.Strong):r=R.e.Strong}n.setState({selectedEmphasis:t.key});n.props.onChange&&n.props.onChange(e,r)};n._getRenderEmphasisOption=function(e){var t=Object(U.r)(n.props.theme||Object(H._)(),e),r=W(n.props.styles||n.props.getStyles,{theme:t});return function(e){return o.createElement("div",{className:r.option},o.createElement(I.e,{settings:{theme:t}},o.createElement(p.e,{className:r.icon,iconName:"Font"})))}};n.state={selectedEmphasis:String(t.selectedEmphasis)||String(R.e.None)};return n}t.prototype.render=function(){var e=this.props,t=e.theme,n=e.styles,r=void 0===n?this.props.getStyles:n,i=W(r,{theme:t});return o.createElement("div",{className:i.root},o.createElement(w.e,{label:this.props.noTitle?null:this.props.title||z.headerEmphasisTitle,selectedKey:this.state.selectedEmphasis,options:[{key:String(R.e.None),text:z.headerEmphasisOptionNone,ariaLabel:z.headerEmphasisOptionNone,onRenderLabel:this._getRenderEmphasisOption(R.e.None)},{key:String(R.e.Neutral),text:z.headerEmphasisOptionNeutral,ariaLabel:z.headerEmphasisOptionNeutral,onRenderLabel:this._getRenderEmphasisOption(R.e.Neutral)},{key:String(R.e.Soft),text:z.headerEmphasisOptionSoft,ariaLabel:z.headerEmphasisOptionSoft,onRenderLabel:this._getRenderEmphasisOption(R.e.Soft)},{key:String(R.e.Strong),text:z.headerEmphasisOptionStrong,ariaLabel:z.headerEmphasisOptionStrong,onRenderLabel:this._getRenderEmphasisOption(R.e.Strong)}],onChange:this._onChange}))};return t})(o.PureComponent),V=Object(q.e)(X,function(e){var t=e.theme||Object(H._)(),n=t.semanticColors,r=t.palette;return{root:["sp-EmphasisSelector-container",{selectors:{".ms-Label":{padding:0},".ms-ChoiceField":{display:"inline-block",marginRight:8},".ms-ChoiceField-field":{height:68,width:64,boxSizing:"border-box"},".ms-ChoiceField:first-child .ms-ChoiceField-field:not(:hover):not(.is-checked)":{border:"1px solid "+r.neutralLight},".ms-ChoiceField-field:hover":{padding:4,border:"4px solid "+r.neutralLight},".ms-ChoiceField-field.is-checked":{padding:4,border:"4px solid "+r.neutralTertiaryAlt},"& .ms-ChoiceField-field::before, & .ms-ChoiceField-field::after":{display:"none"}}}],option:{height:"100%",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:n.bodyBackground,color:n.bodyText},icon:{fontSize:20}}}),$=!1,J=function(){if(!$){Object(H.U)({icons:{"headercustomization-standard":o.createElement("svg",{viewBox:"0 0 32 18"},o.createElement("path",{d:"M32,18H0V0H32V18h0ZM2,16H30V2H2Zm8-4H4V6h6v6h0ZM6,10H8V8H6Zm14,2V10h6v2Zm-8,0V10h6v2Zm0-4V6h8V8Z"})),"headercustomization-compact":o.createElement("svg",{viewBox:"0 0 32 10"},o.createElement("path",{d:"M32,10H0V0H32V10h0ZM2,8H30V2H2ZM22,6V4h6V6ZM14,6V4h6V6ZM4,6V4h8V6Z"})),"headercustomization-minimal":o.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 6"},o.createElement("rect",{width:"32",height:"2"})),"headercustomization-extended":o.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 22"},o.createElement("path",{d:"M0,0V22H32V0ZM30,20H2V14H30Zm0-8H2V2H30Z"}),o.createElement("path",{d:"M10,4H4v6h6ZM8,8H6V6H8Z"}),o.createElement("rect",{x:"12",y:"6",width:"11",height:"2"}),o.createElement("rect",{x:"4",y:"16",width:"6",height:"2"}),o.createElement("rect",{x:"12",y:"16",width:"6",height:"2"}),o.createElement("rect",{x:"20",y:"16",width:"6",height:"2"})),"footercustomization-simple":o.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 14"},o.createElement("path",{id:"icn_footer_simple",d:"M32,14H0V0H32V14h0ZM2,12H30V2H2Zm8-2H4V4h6v6h0ZM6,8H8V6H6ZM24,8V6h4V8ZM18,8V6h4V8ZM12,8V6h4V8Z"})),"footercustomization-extended":o.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 14"},o.createElement("path",{id:"icn_footer_extended",d:"M32,14H0V0H32V14h0ZM2,12H30V2H2Zm16-2V8h4v2Zm-6,0V8h4v2Zm-2,0H4V4h6v6h0ZM6,8H8V6H6ZM24,6V4h4V6ZM18,6V4h4V6ZM12,6V4h4V6Z"})),"footercustomization-stacked":o.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 20"},o.createElement("path",{id:"icn_footer_stacked",d:"M32,20H0V0H32V20h0ZM2,18H30V2H2Zm22-2V14h4v2Zm-6,0V14h4v2Zm-6,0V14h4v2Zm6-6V8h4v2Zm-6,0V8h4v2Zm-2,0H4V4h6v6h0ZM6,8H8V6H6ZM24,6V4h4V6ZM18,6V4h4V6ZM12,6V4h4V6Z"}))}});$=!0}},K=n(2694),Q=n(3806),G=n(2244),Y=(function(e){Object(s.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._onSaveClick=function(e){var t=e?e.filter(function(e){return e.value&&e.value.length>0}):[];A.e.logData({name:"FooterPanel.TranslationsPanelOK.Click",extraData:{translatedItems:t.length}});n.props.onExitClick(!1,e)};n._onCancelClick=function(){n.props.onExitClick(!0)};n._textUpdateCallback=function(e){var t=G.t.getDisplayLanguage(e,n.props.pageContext),r={name:t[0].value,translatedTitles:e};r.name!==n.props.currentDisplay&&n.props.updateFooterName(r.name,t[0].code);n.props.onFooterOptionsChanged(r)};return n}t.prototype.render=function(){return o.createElement(Q.e,{currentDisplay:this.props.currentDisplay,currentLCID:this.props.currentLCID,dataSourceType:this.props.dataSourceType,navNodeId:this.props.navNodeId,pageContext:this.props.pageContext,onCancelClick:this._onCancelClick,onSaveClick:this._onSaveClick,translations:this.props.translations,textUpdateCallback:this._textUpdateCallback,defaultLanguageIsOptional:!0})};return t})(y.e),Z=n(18),ee=n(2999),te=n(1627),ne=n(3323);J();var re=["image/png","image/jpeg","image/gif","image/bmp","image/tiff"],ie=(function(e){Object(s.__extends)(t,e);function t(t){var n,r=e.call(this,t)||this;r._updateFooterName=function(e,t){r.setState({name:e,titleCurrentLCID:t})};r._onRenderDisplayNameLabel=function(e,t){var n,i,s,u,a,f;if(null===(n=r.props.pageContext)||void 0===n?void 0:n.webLanguage){var l;l=!(null===(i=r._muiUtilities)||void 0===i?void 0:i.multilingualFeatureOn)&&(null===(s=r._muiUtilities)||void 0===s?void 0:s.shouldDisplayNameLanguage(r.state.titleCurrentLCID))?Z.format(K.X,ee.e.getResourceByCode(r.state.titleCurrentLCID)):r.state.titleCurrentLCID===(null===(u=r.props.pageContext)||void 0===u?void 0:u.webLanguage)&&r.state.titleCurrentLCID!==(null===(a=r.props.pageContext)||void 0===a?void 0:a.currentLanguage)?Z.format(K.V,ee.e.getResourceByCode(null===(f=r.props.pageContext)||void 0===f?void 0:f.webLanguage)):K.z;return o.createElement("div",null,t(e),o.createElement(te.e,{content:o.createElement("span",null,l)},o.createElement(c.e,{iconProps:{iconName:"Info"},className:"sp-MUIEditing-InfoIcon"})))}};r._onL3ExitClick=function(e,t){void 0===e&&(e=!1);if(e)r.setState({name:r._originalName});else{r._originalName=r.state.name;r._originalTranslatedTitles=t}r.props.onL3ExitClick&&r.props.onL3ExitClick(e,r._originalName,r._originalTranslatedTitles)};r._toggleTranslationpanel=function(e){return function(){e&&A.e.logData({name:"FooterPanel.TranslationsPanelOpen.Click"});r.setState({showTranslationPanel:e});r.props.onTranslationsButtonClick&&r.props.onTranslationsButtonClick()}};r._onVisibilityChanged=function(e){if(e!==r.state.footerVisible){r.setState({footerVisible:e});var t=Object(s.__assign)(Object(s.__assign)({},r.props.chromeOptions),{hidden:!e});r.props.onChromeOptionsChange&&r.props.onChromeOptionsChange({footer:t})}};r._onImageChanged=function(e,t){if(e!==r.state.logoUrl){r.setState({logoUrl:e||""});var n={logoUrl:e||"",logoFile:t,name:r.state.name};r.props.onFooterOptionsChanged&&r.props.onFooterOptionsChanged(n)}};r._onNameTextFieldChanged=function(e,t){var n,i;(null===(n=r._muiUtilities)||void 0===n?void 0:n.multilingualFeatureOn)&&r.props.footerOptions.translatedTitles&&(i=r.props.footerOptions.translatedTitles.map(function(e){e.code===r.state.titleCurrentLCID&&(e.value=t);return e}));r.setState({name:t});var s={logoUrl:r.state.logoUrl,name:t,translatedTitles:i};r.props.onFooterOptionsChanged&&r.props.onFooterOptionsChanged(s)};r._onFooterLayoutChange=function(e,t){var n;switch(t.key){case String(S.t.SIMPLE):n=S.t.SIMPLE;break;case String(S.t.EXTENDED):n=S.t.EXTENDED;break;default:n=S.t.STACKED}r.props.onChromeOptionsChange({footer:{layout:n}});r.setState({footerType:n})};r._onEmphasisChange=function(e,t){var n=r._convertFabricToFooterEmphasis(t);r.props.onChromeOptionsChange({footer:{emphasis:n}});r.setState({selectedVariant:n})};r.state={footerType:r.props.chromeOptions.layout?r.props.chromeOptions.layout:S.t.SIMPLE,footerVisible:!r.props.chromeOptions.hidden,logoUrl:r.props.footerOptions.logoUrl,name:r.props.footerOptions.name,selectedVariant:r.props.chromeOptions.emphasis,titleCurrentLCID:r.props.titleCurrentLCID||(null===(n=r.props.pageContext)||void 0===n?void 0:n.webLanguage)};r._originalName=r.props.footerOptions.name;r._originalTranslatedTitles=r.props.footerOptions.translatedTitles;r.props.pageContext&&(r._muiUtilities=new ne.e(r.props.pageContext));return r}t.prototype.render=function(){var e,t,n,r,i,s,u,a,f,l=Object(H._)(),c=this.state.footerType,h=E.D;this.state.titleCurrentLCID&&(null===(e=this._muiUtilities)||void 0===e?void 0:e.shouldDisplayNameLanguage(this.state.titleCurrentLCID))?h=Z.format(K.a,ee.e.getResourceByCode(this.state.titleCurrentLCID)):(null===(t=this.props.pageContext)||void 0===t?void 0:t.webLanguage)&&(null===(n=this._muiUtilities)||void 0===n?void 0:n.shouldDisplayNameLanguage(null===(r=this.props.pageContext)||void 0===r?void 0:r.webLanguage))&&(h=Z.format(K.a,ee.e.getResourceByCode(null===(i=this.props.pageContext)||void 0===i?void 0:i.webLanguage)));return this.props.renderL3PanelType?o.createElement("div",{className:"sp-ChangeTheLookPanel-content"},o.createElement(Y,{currentDisplay:this.state.name,currentLCID:this.state.titleCurrentLCID||(null===(s=this.props.pageContext)||void 0===s?void 0:s.webLanguage),navNodeId:this.props.titleKey,dataSourceType:this.props.titleKey?G.e.ExistingNavNode:G.e.NewNavNode,translations:this.props.footerOptions.translatedTitles,pageContext:this.props.pageContext,onFooterOptionsChanged:this.props.onFooterOptionsChanged,onExitClick:this._onL3ExitClick,updateFooterName:this._updateFooterName})):o.createElement("div",{className:"sp-ChangeTheLookPanel-content"},o.createElement("div",{"data-automation-id":"sp-ChangeTheLookPanel-footerVisibility"},o.createElement(P.e,null,E.H),o.createElement(x.e,{onText:E.j,offText:E.B,checked:this.state.footerVisible,onChanged:this._onVisibilityChanged})),this.state.footerVisible&&o.createElement(o.Fragment,null,o.createElement(P.e,{id:"footerTypeLabel"},E.P),o.createElement(w.e,{ariaLabelledBy:"footerTypeLabel",className:"sp-ChangeTheLookPanel-customizeHeader-layout",options:[{key:String(S.t.SIMPLE),iconProps:{iconName:"footercustomization-simple",styles:{root:{width:32,height:32,fill:l.palette.neutralSecondary}}},text:E.te},{key:String(S.t.EXTENDED),iconProps:{iconName:"footercustomization-extended",styles:{root:{width:32,height:32,fill:l.palette.neutralSecondary}}},text:E.O}],selectedKey:String(c),onChange:this._onFooterLayoutChange}),o.createElement("div",{className:"sp-ChangeTheLookPanel-footerProperty"},o.createElement(P.e,null,E._),o.createElement(j.e,{ref:this._resolveRef("_imageBrowser"),emptyImageUrl:this.props.emptyImageUrl,imageHeight:32,imageWidth:32,initialPreviewUrl:this.state.logoUrl,disableRemove:!this.state.logoUrl,supportedImageTypes:re,onImageChanged:this._onImageChanged})),o.createElement("div",{className:"sp-ChangeTheLookPanel-footerProperty"},o.createElement(B.e,{label:h,onChange:this._onNameTextFieldChanged,value:this.state.name,onRenderLabel:(null===(u=this._muiUtilities)||void 0===u?void 0:u.shouldDisplayNameLanguage(this.state.titleCurrentLCID))?this._onRenderDisplayNameLabel:void 0,styles:(null===(a=this._muiUtilities)||void 0===a?void 0:a.shouldDisplayNameLanguage(this.state.titleCurrentLCID))?{subComponentStyles:{label:{root:{display:"inline-block"}}}}:void 0}),(null===(f=this._muiUtilities)||void 0===f?void 0:f.multilingualFeatureOn)&&o.createElement(d.e,{onClick:this._toggleTranslationpanel(!0),"aria-label":K.$,styles:{root:{marginBottom:"4px"}},className:"sp-ChangeTheLookPanel-footerTranslation"},K.$)),o.createElement(V,{selectedEmphasis:this._spEmphasis,onChange:this._onEmphasisChange})))};Object.defineProperty(t.prototype,"_spEmphasis",{get:function(){switch(this.state.selectedVariant){case S.e.Strong:return D.e.Strong;case S.e.Neutral:return D.e.Neutral;case S.e.Soft:return D.e.Soft;default:return D.e.None}},enumerable:!0,configurable:!0});t.prototype._convertFabricToFooterEmphasis=function(e){switch(e){case D.e.None:return S.e.None;case D.e.Neutral:return S.e.Neutral;case D.e.Soft:return S.e.Soft;default:return S.e.Strong}};return t})(y.e),se=n(98),oe=n(4271),ue=n(2576),ae=n(83),fe=n(245),le=n(696),ce=Object(H._)(),he=Object(H.j)({accordionContainer:{borderTop:"1px solid "+ce.palette.neutralLight,paddingTop:0,paddingBottom:24,position:"relative"},accordionContainerSlim:{paddingTop:0,paddingBottom:0,position:"relative"},accordionHeader:{position:"relative",height:44,display:"flex",cursor:"pointer",paddingLeft:24,paddingRight:24,selectors:{label:{lineHeight:"1.8em",fontSize:H.i.mediumPlus,marginRight:"auto",cursor:"inherit"},button:{fontSize:H.i.mediumPlus,color:ce.palette.neutralSecondary,backgroundColor:"transparent",border:"none",cursor:"pointer",height:44,marginRight:-20,paddingRight:0,paddingLeft:0},".chevronIcon":{transition:"transform .1s linear"},".collapsed":{transform:"rotate(180deg)"},":hover":{backgroundColor:ce.palette.neutralLight}}},accordionContent:{padding:"0px 24px"},collapsedContent:{display:"none"}}),pe=function(e){var t=Object(o.useState)(!1),n=t[0],r=t[1];if(void 0===e.children)return null;var i=!1,s=o.Children.toArray(e.children);for(var u in s)if(u){i=!0;break}return i?o.createElement("div",{className:he.accordionContainer+" "+(n?he.accordionContainerSlim:"")},o.createElement("div",{className:he.accordionHeader,onClick:function(){r(!n)}},o.createElement(P.e,null,e.title),o.createElement(l.e,{ariaLabel:e.title,"aria-expanded":!n},o.createElement(p.e,{className:Object(v.e)("ms-Nav-chevron","chevronIcon",{collapsed:n}),iconName:"ChevronUp"}))),o.createElement("div",{className:n?he.collapsedContent:he.accordionContent},e.children)):null},de=n(103);J();var ve={ODB:1067},me=(function(e){Object(s.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._isHubJoined=!1;n._renderContentNew=function(){var e,t=Object(H._)(),r=Object(le.t)(n.props.pageContext),i=Object(le.e)(n.props.pageContext),s=n.state.selectedLayout===String(S.s.extended),u=r?{root:{marginRight:2,selectors:{":last-child":{marginRight:0}}}}:void 0,a={root:{width:32,height:32,fill:t.palette.neutralSecondary}},f={key:String(S.s.minimal),text:E.U,styles:u,iconProps:{iconName:"headercustomization-minimal",styles:a}},l={key:String(S.s.compact),text:E.q,styles:u,iconProps:{iconName:"headercustomization-compact",styles:a}},c={key:String(S.s.standard),text:E.z,styles:u,iconProps:{iconName:"headercustomization-standard",styles:a}},h={key:String(S.s.extended),text:E.R,styles:u,iconProps:{iconName:"headercustomization-extended",styles:a}},p=r?[f,l,c]:[c,l];i&&p.push(h);return o.createElement(o.Fragment,null,o.createElement(pe,{title:E.I},o.createElement(w.e,{className:"sp-ChangeTheLookPanel-customizeHeader-layout",selectedKey:n.state.selectedLayout,options:p,onChange:n._onLayoutChange})),o.createElement(pe,{title:E.u},!n._isHubJoined&&o.createElement(o.Fragment,null,o.createElement("div",{className:"sp-ChangeTheLookPanel-customizeHeader-Section"},E.r),o.createElement(V,{selectedEmphasis:n.state.selectedEmphasis,onChange:n._onEmphasisChange,noTitle:!0})),i&&s&&o.createElement(o.Fragment,null,o.createElement("div",{className:"sp-ChangeTheLookPanel-customizeHeader-Section"},E.i),o.createElement(j.e,{supportedImageTypes:ue.n,onImageChanged:n._onBackgroundImageChanged,initialPreviewUrl:n.props.pageContext.webAbsoluteUrl+"/_api/siteiconmanager/getsitelogo?target='2'",imageFit:de.t.cover,isFocalPointEnabled:!0,imageWidth:292,changeButtonAriaLabel:E.e,removeButtonAriaLabel:E.v,uploadButtonAriaLabel:E.N,imageAlt:E.s,onFocalPointMove:n._onFocalPointMove,initialFocalPoint:null===(e=n.props.pageContext)||void 0===e?void 0:e.focalPoint}))),n.props.pageContext&&o.createElement(pe,{title:E.a},o.createElement("div",{className:"sp-ChangeTheLookPanel-customizeHeader-Section"},E.S),o.createElement(x.e,{ariaLabel:E.S,checked:!n.state.hideTitle,onText:E.T,offText:E.x,onChange:n._onTitleVisiblityChanged}),o.createElement("div",{className:"sp-ChangeTheLookPanel-customizeHeader-Section"},E.b,n._renderInfoTip("site-thumbnail-info",E.E)),o.createElement(j.e,{supportedImageTypes:ue.n,onImageChanged:n._onLogoChanged,initialPreviewUrl:fe.n.isFeatureEnabled(ve)?n.props.pageContext.webAbsoluteUrl+"/_api/siteiconmanager/getsitelogo":n.state.siteLogoUrl,disableRemove:Object(ae.s)(n.props.pageContext),changeButtonAriaLabel:E.n,removeButtonAriaLabel:E.g,uploadButtonAriaLabel:E.k,imageAlt:E.b}),o.createElement("div",{className:"sp-ChangeTheLookPanel-customizeHeader-Section"},E.w,n._renderInfoTip("site-logo-info",E.y)),o.createElement(j.e,{supportedImageTypes:ue.n,onImageChanged:n._onRectLogoChanged,initialPreviewUrl:n.props.pageContext.webAbsoluteUrl+"/_api/siteiconmanager/getsitelogo?type='1'",imageWidth:292,changeButtonAriaLabel:E.t,removeButtonAriaLabel:E.m,uploadButtonAriaLabel:E.C,imageAlt:E.w,imageAlignment:oe.e.left}),i&&s&&o.createElement(o.Fragment,null,o.createElement("div",{className:"sp-ChangeTheLookPanel-customizeHeader-Section"},E.o),o.createElement(w.e,{selectedKey:n.state.selectedLogoAlignment,options:n._getLogoAlignmentOptions(t),onChange:n._onLogoAlignmentChange}))))};n._renderInfoTip=function(e,t){return o.createElement(te.e,{content:t,id:e,calloutProps:{gapSpace:0},styles:{root:{display:"inline-block",position:"relative",top:4}}},o.createElement(c.e,{iconProps:{iconName:"Info"},ariaLabel:t,disabled:!1,checked:!1,styles:{rootHovered:{backgroundColor:"inherit"},rootPressed:{backgroundColor:"inherit"}}}))};n._getLogoAlignmentOptions=function(e){var t=function(t){return{root:{backgroundColor:e.palette.white},field:[{width:32,height:32,padding:0,border:"none"},t.checked&&{borderRadius:2,backgroundColor:e.semanticColors.bodyBackgroundChecked,selectors:{"::before, ::after":{border:"none",width:0,height:0}}},{selectors:{":hover":{borderRadius:2,backgroundColor:e.semanticColors.bodyBackgroundHovered},":hover::before":{border:"none",width:0,height:0}}}],choiceFieldWrapper:{width:32,height:32},iconWrapper:{color:e.palette.themePrimary,fontSize:16,width:32,height:32},innerField:{padding:0},labelWrapper:{margin:0}}};return[{key:String(S.r.left),text:"",styles:t,iconProps:{iconName:"AlignHorizontalLeft"}},{key:String(S.r.middle),text:"",styles:t,iconProps:{iconName:"AlignHorizontalCenter"}},{key:String(S.r.right),text:"",styles:t,iconProps:{iconName:"AlignHorizontalRight"}}]};n._renderContentOld=function(){var e=Object(H._)();return o.createElement("div",{className:"sp-ChangeTheLookPanel-content"},o.createElement(w.e,{className:"sp-ChangeTheLookPanel-customizeHeader-layout",label:E.I,selectedKey:n.state.selectedLayout,options:[{key:String(S.s.standard),text:E.z,iconProps:{iconName:"headercustomization-standard",styles:{root:{width:32,height:32,fill:e.palette.neutralSecondary}}}},{key:String(S.s.compact),text:E.q,iconProps:{iconName:"headercustomization-compact",styles:{root:{width:32,height:32,fill:e.palette.neutralSecondary}}}}],onChange:n._onLayoutChange}),n.props.pageContext&&o.createElement("div",{className:"sp-CustomizeTheme-headerEmphasis-title"},"Site logo"),n.props.pageContext&&o.createElement(j.e,{supportedImageTypes:ue.n,onImageChanged:n._onLogoChanged,initialPreviewUrl:n.state.siteLogoUrl,disableRemove:Object(ae.s)(n.props.pageContext)}),!n._isHubJoined&&o.createElement(V,{selectedEmphasis:n.state.selectedEmphasis,onChange:n._onEmphasisChange}))};n._onLogoChanged=function(e,t){n.props.onLogoChange(t,e)};n._onRectLogoChanged=function(e,t){n.props.onRectLogoChange(e,t)};n._onBackgroundImageChanged=function(e,t){n.props.onBackgroundImageChange&&n.props.onBackgroundImageChange(e,t)};n._onTitleVisiblityChanged=function(e,t){if(t!==!n.state.hideTitle){n.setState({hideTitle:!t});n.props.onHideTitleChange&&n.props.onHideTitleChange({header:{hideTitle:!t}})}};n._onFocalPointMove=function(e){n.props.onBackgroundImageFocalPointChange&&n.props.onBackgroundImageFocalPointChange(e)};n._onLogoAlignmentChange=function(e,t){if(t.key!==n.state.selectedLogoAlignment){n.setState({selectedLogoAlignment:t.key});var r=S.r.left;switch(t.key){case String(S.r.left):r=S.r.left;break;case String(S.r.middle):r=S.r.middle;break;case String(S.r.right):r=S.r.right}var i={logoAlignment:r};n.props.onChange&&n.props.onChange({header:i})}};n._onLayoutChange=function(e,t){if(t.key!==n.state.selectedLayout){n.setState({selectedLayout:t.key});var r=S.s.standard;switch(t.key){case String(S.s.standard):r=S.s.standard;break;case String(S.s.compact):r=S.s.compact;break;case String(S.s.minimal):r=S.s.minimal;break;case String(S.s.extended):r=S.s.extended}var i={layout:r};n.props.onChange&&n.props.onChange({header:i});!T.t.isActivated("73ea761e-b7df-4b36-9130-c0201950927e")&&Object(ae.o)(n.props.pageContext)&&se.e.raise(window,"Header_Layout_Changed",{layout:r})}};n._onEmphasisChange=function(e,t){if(t!==n.state.selectedEmphasis){n.props.onHeaderEmphasisChanged&&n.props.onHeaderEmphasisChanged(t);n.setState({selectedEmphasis:t})}};n.state={selectedLayout:String(t.options.layout)||String(S.s.none),selectedEmphasis:n.props.selectedEmphasis||R.e.None,siteLogoUrl:n.props.pageContext&&n.props.pageContext.webLogoUrl,hideTitle:n.props.options&&n.props.options.hideTitle,selectedLogoAlignment:String(t.selectedLogoAlignment)};n._isHubJoined=n.props.pageContext.hubSiteId&&!n.props.pageContext.isHubSite;return n}t.prototype.render=function(){return fe.n.isFeatureEnabled(ve)?this._renderContentNew():this._renderContentOld()};return t})(y.e),ge=n(481),ye=n(1768),be=n(1122),we=(function(e){Object(s.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props.palette,t=void 0===e?{}:e,n=t.white||"transparent";return o.createElement("svg",{role:"presentation",className:"sp-ThemeListItem-svgIcon",viewBox:"0 0 84 46","aria-hidden":!0},o.createElement("rect",{height:"100%",width:"100%",fill:n,stroke:"none"}),this._renderShades(),o.createElement("text",{x:"10%",y:"84%",fill:t.neutralPrimary,role:"presentation"},this.props.sampleText))};t.prototype._renderShades=function(){var e=this.props.palette||{},t=this.props.isInverted;return[o.createElement("rect",{key:"primary",y:"0%",height:"50%",width:"50%",fill:e.themePrimary,stroke:"none"}),o.createElement("rect",{key:"secondary",y:"0%",height:"50%",width:50/3+"%",fill:t?e.themeDark:e.themeSecondary,stroke:"none",x:"50%"}),o.createElement("rect",{key:"accent",y:"0%",height:"50%",width:50/3+"%",fill:t?e.themeDarker:e.themeTertiary,stroke:"none",x:50+50/3+"%"}),o.createElement("rect",{key:"last",y:"0%",height:"50%",width:50/3+"%",fill:e.accent||e.themePrimary,stroke:"none",x:50+50/3+50/3+"%"})]};return t})(o.PureComponent),Ee=(function(e){Object(s.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.state={};return n}t.prototype.UNSAFE_componentWillReceiveProps=function(e){if(this.props.selected!==e.selected){var t=e.selected;e.editable&&this.setState({buttonAnimation:t?H.t.fadeIn100:H.t.fadeOut100,titleAnimation:t?H.t.slideUpIn10:H.t.slideDownIn10})}else!this.props.selected&&this.state.buttonAnimation&&this.setState({buttonAnimation:void 0,titleAnimation:void 0})};t.prototype.render=function(){var e=this,t=this.props,n=t.selected,r=t.editable,i=t.themeOption,u=i.theme,a=i.name,f=i.isInverted,l={key:"choice",text:a};return o.createElement(w.e,{name:"ThemeListItems",selectedKey:n&&"choice",options:[Object(s.__assign)(Object(s.__assign)({},l),{onRenderLabel:function(){return o.createElement("div",{className:Object(v.e)("sp-ThemeListItem",n&&"sp-ThemeListItem-selected")},o.createElement("div",{className:"sp-ThemeListItem-container"},o.createElement("div",{"aria-hidden":!0,className:"sp-ThemeListItem-colorIcon"},o.createElement(we,{palette:u,isInverted:f,sampleText:z.themeSampleText})),o.createElement("div",{className:"sp-themeListItem-content"},o.createElement("div",{className:"sp-ThemeListItem-itemContentTitleContainer",style:Object(s.__assign)({},e.state.titleAnimation)},o.createElement("span",{className:"sp-ThemeListItem-choice"},a)),n&&r&&o.createElement(be.e,{style:Object(s.__assign)({},e.state.buttonAnimation),className:"sp-ThemeListItem-commandButton","data-automationid":"ThemeListItemEditButton",onClick:e.props.onEditThemeClick,styles:{label:{margin:0}}},z.customizeThemeButton))))}})]})};return t})(y.e),Se=(function(e){Object(s.__extends)(t,e);function t(t){return e.call(this,t)||this}t.prototype.render=function(){return o.createElement(ye.e,{componentRef:this._resolveRef("_themeList"),role:"group",className:Object(v.e)("sp-ThemeList",this.props.className),items:this.props.themes,renderedWindowsAhead:4,onRenderCell:this._onRenderTheme.bind(this),"aria-labelledby":this.props["aria-labelledby"]})};t.prototype.UNSAFE_componentWillReceiveProps=function(e){e.selectedThemeId!==this.props.selectedThemeId&&(e.selectedThemeId.listId!==this.props.themeListId&&this.props.selectedThemeId.listId!==this.props.themeListId||this.forceUpdate())};t.prototype.forceUpdate=function(){this._themeList.forceUpdate();e.prototype.forceUpdate.call(this)};t.prototype._onRenderTheme=function(e,t){var n=this,r=this.props.selectedThemeId,i=r.index===t&&this.props.themeListId===r.listId,s=i?void 0:function(r){return n._onThemeClick(r,e,t)};return o.createElement("div",{onClick:s,onFocus:s,title:e.name,"data-automationid":"ThemeListItem-"+t},o.createElement(Ee,{themeOption:e,index:t,selected:i,onEditThemeClick:this.props.onEditThemeClick,editable:this.props.editEnabled}))};t.prototype._onThemeClick=function(e,t,n){this.props.onThemeClick&&this.props.onThemeClick(e,t,n)};return t})(y.e),xe=n(1623),Te=(function(e){Object(s.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._onThemeClick=function(e,t,r,i,s){void 0===i&&(i=0);void 0===s&&(s=!1);!s&&n.props.onUneditableThemeClick&&n.props.onUneditableThemeClick();n.props.onThemeClick&&n.props.onThemeClick(e,t);n.setState({selectedThemeId:{listId:r,index:i}})};n._spThemeListLabel=Object(ge.e)("spThemeList");n.state={selectedThemeId:{index:0,listId:z.siteThemeHeader}};return n}t.prototype.focus=function(){this._focusZone.focus()};t.prototype.render=function(){var e=this.props,t=e.currentlyAppliedTheme,n=e.themes,r=e.defaultThemes,i=e.themeErrorText,s=e.currentlyAppliedThemeEditable,u=e.isThemeLocked,a=!u&&n&&n.length>0,f=!u&&r&&r.length>0,l=!u&&s;return o.createElement(xe.e,{className:"sp-ThemeList-focusZone sp-ChangeTheLookPanel-content",componentRef:this._resolveRef("_focusZone"),ariaLabelledBy:this._spThemeListLabel},o.createElement("label",{id:this._spThemeListLabel,className:"sp-ThemeList-ariaLabel"},this.props.ariaLabel||z.themeListContainerAriaLabel),t&&this._renderThemeList(z.siteThemeHeader,[t],l),a&&this._renderThemeList(z.companyThemes,n),f&&this._renderThemeList(z.sharePointThemes,r,!0),i&&i)};t.prototype._renderThemeList=function(e,t,n){var r=this;void 0===n&&(n=!1);var i=this.props.onEditThemeClick,s=this.state.selectedThemeId,u=String(Math.floor(1e4*Math.random()));return o.createElement("div",{key:e},o.createElement("div",{className:"sp-ChangeTheLookPanel-themeListHeader","data-automationid":"ThemeListHeader",id:u},e),o.createElement(Se,{themes:t,onThemeClick:function(t,i,s){return r._onThemeClick(t,i,e,s,n)},className:"sp-ChangeTheLookPanel-themeList",onEditThemeClick:i,selectedThemeId:s,themeListId:e,editEnabled:n,"aria-labelledby":u}))};return t})(y.e),Ne=n(4868),Ce=n(397),ke={width:30,height:30},Le=(function(e){Object(s.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.componentDidMount=function(){var e=this;setTimeout(function(){e._focusZone&&e._focusZone.focus()},50)};t.prototype.render=function(){var e=this.props,t=e.onPrimaryColorClick,n=e.onAccentColorClick,r=e.currentPrimaryColor,i=e.currentAccentColor,u=e.primaryColors,a=e.accentColors,f=!T.t.isActivated("E618684E-A2B7-49C6-A5B3-83E6002EFB1E","07/27/2021","Label color pickers"),l=f?"CustomizeThemeContent-mainColor":"sp-CustomizeTheme-accentTitle",c=f?"CustomizeThemeContent-accentColor":void 0;return o.createElement("div",{"aria-label":z.customizerAriaNavigationInstructions,ref:this._resolveRef("_focusZone"),className:Object(v.e)("sp-CustomizeTheme-container","sp-ChangeTheLookPanel-content"),tabIndex:0},o.createElement("div",{id:l},z.mainColor),o.createElement(Ne.e,{key:"primaryColors",className:"sp-CustomizeTheme-colorPicker","aria-labelledby":f?l:void 0,colorCells:this._convertColorsToCells(u),cellShape:"square",selectedId:r,columnCount:6,onColorChanged:function(e,n){return t(n)},shouldFocusCircularNavigate:!1,getColorGridCellStyles:function(){var e;return{colorCell:Object(s.__assign)(Object(s.__assign)({},ke),{selectors:(e={$svg:ke},e["."+Ce.e+" &:focus $svg"]=ke,e[":hover $svg"]=ke,e[":focus $svg"]=ke,e[":active $svg"]=ke,e)}),svg:Object(s.__assign)(Object(s.__assign)({},ke),{boxSizing:"border-box"})}}}),a&&o.createElement("div",{className:"sp-CustomizeTheme-accentColors"},o.createElement("div",{id:c,key:"AccentColorsTitle"},z.accentColor),o.createElement(Ne.e,{key:"accentColors",className:"sp-CustomizeTheme-colorPicker","aria-labelledby":c,cellShape:"square",colorCells:this._convertColorsToCells(a),columnCount:6,selectedId:i,onColorChanged:function(e,t){return n(t)},getColorGridCellStyles:function(){var e;return{colorCell:Object(s.__assign)(Object(s.__assign)({},ke),{selectors:(e={$svg:ke},e["."+Ce.e+" &:focus $svg"]=ke,e[":hover $svg"]=ke,e[":focus $svg"]=ke,e[":active $svg"]=ke,e)}),svg:Object(s.__assign)(Object(s.__assign)({},ke),{boxSizing:"border-box"})}}})))};t.prototype._convertColorsToCells=function(e){var t=this;return e.map(function(e,n){return{id:e,color:e,index:n,label:t.props.colorNameMap[e]}})};return t})(y.e),Ae=n(2693),Oe=n(4276),Me=(function(e){Object(s.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._onPrimaryColorClick=function(e){var t=Object(s.__assign)(Object(s.__assign)({},n.state.currentTheme),{name:e,theme:Object(s.__assign)({},n.props.themes[e])});n.props.onPreviewThemeClick(null,t);n.setState({currentTheme:t,accentColors:n._getAccents(t)})};n._onAccentColorClick=function(e){var t=Object(s.__assign)(Object(s.__assign)({},n.state.currentTheme),{theme:Object(s.__assign)(Object(s.__assign)({},n.state.currentTheme.theme),{accent:e})});n.props.onPreviewThemeClick(null,t);n.setState({currentTheme:t})};var r=t.defaultTheme;n.state={currentTheme:r,primaryColors:n._loadPrimaryColors(t.themes),accentColors:n._getAccents(r)};n._defaultTheme=r;return n}t.prototype.render=function(){return o.createElement(Le,Object(s.__assign)({},this.getRenderProps()))};t.prototype.resetTheme=function(){this.props.onPreviewThemeClick(null,this._defaultTheme);this.setState({currentTheme:this._defaultTheme,accentColors:this._getAccents(this._defaultTheme)})};t.prototype.getCurrentTheme=function(){return this.state.currentTheme};t.prototype.getRenderProps=function(){var e=this.state,t=e.currentTheme,n=e.primaryColors,r=e.accentColors,i="#03787c",s=null;t&&t.theme&&t.theme.themePrimary&&(i=t.theme.themePrimary);t&&t.theme&&t.theme.accent&&(s=t.theme.accent);var o=t&&Object(Ae.t)(t.isInverted,t.theme.primaryBackground),u={};if(o)for(var a=0,f=Object.keys(o);a<f.length;a++){var l=f[a];if(Oe[l]){u[o[l]]=Oe[l]}}return{onPrimaryColorClick:this._onPrimaryColorClick,onAccentColorClick:this._onAccentColorClick,primaryColors:n,accentColors:r,currentPrimaryColor:i,currentAccentColor:s,colorNameMap:u}};t.prototype._loadPrimaryColors=function(e){var t=[];for(var n in e){var r=e[n];r&&r.themePrimary&&t.push(r.themePrimary)}return t};t.prototype._getAccents=function(e){var t=e.theme.themePrimary,n=e.isInverted,r=this.props.accentColorMap;return n?[t].concat(r[t]):r[t].concat([t])};return t})(y.e),_e=(function(e){Object(s.__extends)(t,e);function t(t){return e.call(this,t)||this}t.prototype.render=function(){return this.props.isThemeLocked?o.createElement("div",{className:"sp-ChangeTheLookPanel-themeLockedText"},this.props.themeLockedText):this.props.editingTheme?this._renderEditTheme():this._renderThemesList()};t.prototype._renderThemesList=function(){var e=this.props,t=e.themes,n=e.errorText,r=e.defaultThemes,i=e.currentlyAppliedTheme,s=e.onThemeClick,u=e.onUneditableThemeClick,a=e.onEditThemeClick,f=e.currentThemeEditable,l=e.isThemeLocked,c=e.themeLockedText,h=t&&t.length>0,p=r&&r.length>0,d="";n||(h||p)||(d=E.Y||"");var v=l?c:void 0;return o.createElement("div",{"data-automationid":"ThemesListContainer"},o.createElement(Te,{isThemeLocked:l,currentlyAppliedTheme:i,themeErrorText:d,themes:t,defaultThemes:r,onThemeClick:s,onUneditableThemeClick:u,onEditThemeClick:a,currentlyAppliedThemeEditable:f,ariaLabel:v}),n&&o.createElement("div",{key:"errorText",className:"sp-ChangeTheLookPanel-errorText"},n))};t.prototype._renderEditTheme=function(){var e=this.props,t=e.currentlySelectedTheme,n=e.colorThemes,r=e.accentColorMap,i=e.onThemeClick;return o.createElement(Me,{defaultTheme:t,themes:n,accentColorMap:r,onPreviewThemeClick:i})};return t})(y.e),De=n(53),Pe=n(3858),He=(function(e){Object(s.__extends)(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;t._root=Object(o.createRef)();t._isTeamSite=t.props.pageContext&&[De.t.teamSite,De.t.group].indexOf(Number(t.props.pageContext.webTemplate))>-1;t._onDismiss=function(){t.props.onDismiss&&t.props.onDismiss()};t._onSave=function(e){t.props.onSave?t.props.onSave(e).then(function(){return t._onDismiss()}):t._onDismiss()};t._onCancel=function(e){if(t.props.onCancel){t.props.onCancel(e);t._onDismiss()}};t._renderFooterContent=function(){return t._isL2Panel?o.createElement("div",{className:"sp-ChangeTheLookPanel-footer"},o.createElement(f.e,{"data-automationid":"changethelookpanel-savebutton",onClick:t._onSave,className:"sp-ChangeTheLookPanel-footerButton",disabled:!t.props.saveEnabled},E.Z),o.createElement(l.e,{"data-automationid":"changethelookpanel-cancelbutton",onClick:t._onCancel,className:"sp-ChangeTheLookPanel-footerButton"},E.L)):o.createElement("div",{className:"sp-ChangeTheLookPanel-footer"},o.createElement("div",null,o.createElement(f.e,{"data-automationid":"changethelookpanel-savebutton",onClick:t._onSave,className:"sp-ChangeTheLookPanel-footerButton",disabled:!t.props.saveEnabled},E.Z),o.createElement(l.e,{"data-automationid":"changethelookpanel-cancelbutton",onClick:t._onCancel,className:"sp-ChangeTheLookPanel-footerButton"},E.L)),o.createElement("div",{className:"sp-ChangeTheLookPanel-footerLinkContainer"},o.createElement("div",{className:"sp-ChangeTheLookPanel-footerLinks"},o.createElement(d.e,{className:"sp-ChangeTheLookPanel-footerLink",href:t.props.changeTheLookPageLink},E.A))))};return t}t.prototype.render=function(){var e=this,t=this.props,n=t.isOpen,r=t.isLoading,i=t.isSaving,s=t.chromeOptions,f=t.isHubSite;return o.createElement(u.e,{type:a.e.smallFixedFar,className:"sp-ChangeTheLookPanel",onDismiss:this._onDismiss,isOpen:n,onRenderFooterContent:this._isL3Panel?void 0:this._renderFooterContent,onRenderNavigationContent:function(t,n){var r;switch(e.props.renderL2PanelType){case"Theme":r=E.ne;break;case"Header":r=E.F;break;case"Nav":r=E.X;break;case"Footer":r=E.M;break;default:r=E.re}if(e.props.renderL3PanelType)switch(e.props.renderL3PanelType){case"MUIEditing":r=K.$}return o.createElement(o.Fragment,null,o.createElement("div",{className:Object(v.e)("sp-ChangeTheLookPanel-headerContainer",e._isL2Panel&&"editing")},e._isL2Panel&&o.createElement(c.e,{iconProps:{iconName:"Back"},ariaLabel:Pe.e,onClick:e.props.onBackButtonClick}),e.isHeaderLevelKSActive()?o.createElement("h4",{className:"sp-ChangeTheLookPanel-headerText"},r):o.createElement("h1",{className:"sp-ChangeTheLookPanel-headerText"},r)),n(t))},closeButtonAriaLabel:E.L,isFooterAtBottom:!0,overlayProps:!this.isBlockedKSActive()&&{styles:{root:{backgroundColor:"rgba(0,0,0,0)",pointerEvents:"none",cursor:"default"}}},isBlocking:!this.isBlockedKSActive()},o.createElement("div",{ref:this._root},!r&&!this._isL2Panel&&this._renderChromeCustomization("Theme",this.props.onEditChromeOptionsClick),!r&&!this._isL2Panel&&this._renderChromeCustomization("Header",this.props.onEditChromeOptionsClick),!r&&(L.e({ODB:60340},this.props.pageContext||{},{experimentFlightId:90024,killSwitch:"39702562-b8cb-4062-acff-022dc2cb0606"})?!this.props.pageContext.PublishingFeatureOn:s&&s.nav.placement===S.i.HORIZONTAL||f)&&!this._isL2Panel&&this._renderChromeCustomization("Nav",this.props.onEditChromeOptionsClick),!r&&s&&s.nav.placement===S.i.HORIZONTAL&&!this._isTeamSite&&!this._isL2Panel&&this._renderChromeCustomization("Footer",this.props.onEditChromeOptionsClick),this._isL2Panel&&!r&&this._renderL2Panel(),r&&o.createElement("div",{key:"spinner",className:"sp-ChangeTheLookPanel-spinnerContainer",role:"alert"},o.createElement(b.e,{label:i?E.ee:E.W}))))};t.prototype.componentDidUpdate=function(e){var t=this;e.renderL2PanelType===this.props.renderL2PanelType&&e.isLoading===this.props.isLoading||setTimeout(function(){var e=Object(m.i)(t._root.current,t._root.current,!0);e&&e.focus()},50)};t.prototype._renderL2Panel=function(){switch(this.props.renderL2PanelType){case"Theme":return this._renderThemeCustomizer();case"Nav":return this._renderNavCustomization();case"Footer":return this._renderFooterCustomization();case"Header":return this._renderHeaderCustomizer()}};t.prototype._renderThemeCustomizer=function(){return o.createElement(_e,Object(s.__assign)({},this.props.themeCustomizerProps))};t.prototype._renderNavCustomization=function(){return o.createElement(_,{pageContext:this.props.pageContext,options:this.props.chromeOptions.nav,onChange:this.props.onChromeOptionsChanged,imageUrls:this.props.navImageUrls,isTeamSite:this._isTeamSite})};t.prototype._renderFooterCustomization=function(){return o.createElement(ie,{chromeOptions:this.props.chromeOptions.footer,onChromeOptionsChange:this.props.onChromeOptionsChanged,onFooterLinksEditClicked:this.props.onFooterLinksEditClicked,onL3ExitClick:this.props.exitL3Panel,cancelCallback:this._onCancel,footerOptions:this.props.footerOptions,onFooterOptionsChanged:this.props.onFooterOptionsChanged,emptyImageUrl:this.props.emptyImageUrl||"",pageContext:this.props.pageContext,onTranslationsButtonClick:this.props.onFooterTranslationClick,renderL3PanelType:this.props.renderL3PanelType,titleCurrentLCID:this.props.footerTitleCurrentLCID,titleKey:this.props.footerTitleKey})};t.prototype._renderHeaderCustomizer=function(){return o.createElement(me,Object(s.__assign)({},this.props.headerCustomizerProps))};Object.defineProperty(t.prototype,"_isL2Panel",{get:function(){return void 0!==this.props.renderL2PanelType&&""!==this.props.renderL2PanelType},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"_isL3Panel",{get:function(){return void 0!==this.props.renderL3PanelType&&""!==this.props.renderL3PanelType},enumerable:!0,configurable:!0});t.prototype._renderChromeCustomization=function(e,t){var n;switch(e){case"Theme":n=E.ne;break;case"Header":n=E.F;break;case"Nav":n=E.X;break;case"Footer":n=E.M}return o.createElement(h.e,{className:"sp-ChangeTheLookPanel-section","data-chrome-type":e,onClick:t},n,o.createElement(p.e,{iconName:Object(g.e)()?"Back":"Forward",className:"sp-ChangeTheLookPanel-drillDownArrow"}))};t.prototype.isBlockedKSActive=function(){return T.t.isActivated("9ea89f81-cba6-44d1-a351-ab2359bd8179","06/11/2021","Use blocking panel")};t.prototype.isHeaderLevelKSActive=function(){return T.t.isActivated("90a1f437-50e4-418e-833f-77f58959d4bc","09/01/2021","Set panel header to level 1")};return t})(y.e)},2520:function(e,t,n){"use strict";n.d(t,"e",function(){return B});var r=n(0),i=n("react-lib"),s=n(4148),o=n(2686),u=n(693),a=n(1779),f=n(120),l=n(101),c=n(739),h=n(1590),p=n(1781),d=n(481),v=n(1608),m=n(163),g=n(1627),y=n(986),b=n(1154),w=n(3771),E=n(2473),S=n(2849),x=n(1616),T=n(1115),N=n(3855),C=n(4560),k=n(537),L=n(18),A=n(4628),O=n(4260),M=n(4969),_=n(3856),D=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._getColumns=function(e,t,r){return[{key:"column1",name:N.D,fieldName:"Title",minWidth:1,isRowHeader:!0,isResizable:!1,isSorted:"Title"===t,isSortedDescending:r,sortAscendingAriaLabel:N.n,sortDescendingAriaLabel:N.v,onRender:n._renderNameColumn,onColumnClick:n._onColumnClick,data:"string",isPadded:!1,ariaLabel:N.D},{key:"column2",name:N.m,fieldName:"UserExpiration",minWidth:95,maxWidth:105,isSorted:"UserExpiration"===t,isSortedDescending:r,isResizable:!1,sortAscendingAriaLabel:N.t,sortDescendingAriaLabel:N.d,onColumnClick:n._onColumnClick,data:"number",className:"ms-UserExpirationList-ExpirationColumn",onRender:n._renderExpirationDate,isPadded:!1,ariaLabel:N.m},{key:"column3",name:"",isResizable:!1,onRender:function(t){return n._renderOptionsBox(t,e)},minWidth:10,maxWidth:10,isPadded:!1}]};n._renderNoUsersMessage=function(){return n.state.filterText?i.createElement(A.e,{stickyPosition:O.e.Header},i.createElement("div",null,N.B)):i.createElement(A.e,{stickyPosition:O.e.Header},i.createElement("div",null,N.H))};n._renderButtonArea=function(){var e=n.state.isUserSelected;return i.createElement("div",{className:"ms-UserExpirationList-ButtonAreaPadding"},i.createElement("div",{className:"ms-UserExpirationList-ButtonArea"},!e&&n._renderSearch(),e&&n._renderButtons()))};n._renderSearch=function(){var e=n.state.filterText;return i.createElement(C.e,{placeholder:N.F,className:"ms-UserExpirationList-Search",value:e,onChange:function(e,t){return n._searchForUser(t)},styles:{field:"ms-UserExpirationList-SearchField"}})};n._renderButtons=function(){var e={root:"ms-UserExpirationList-ButtonAreaButton"};return n.props.userExpirationPolicyEnabled?i.createElement("div",{className:"ms-UserExpirationList-ButtonArea"},i.createElement(b.e,{"data-automation-id":"CommandBarExtend",iconProps:{iconName:"DateTime2"},text:N.T,onClick:n._showExtendDialog,styles:e}),i.createElement(b.e,{"data-automation-id":"CommandBarExpire",iconProps:{iconName:"UserRemove"},text:N.j,onClick:n._showExpireDialog,styles:e})):i.createElement("div",{className:"ms-UserExpirationList-ButtonArea"},i.createElement(b.e,{"data-automation-id":"CommandBarClear",iconProps:{iconName:"RemoveEvent"},text:N.o,onClick:n._showClearDialog,styles:e}),i.createElement(b.e,{"data-automation-id":"CommandBarExpire",iconProps:{iconName:"UserRemove"},text:N.j,onClick:n._showExpireDialog,styles:e}))};n._renderList=function(){var e=n.state,t=e.users,r=e.columns,s=e.hasMoreUsers;return i.createElement(a.e,null,i.createElement(p.e,{"data-automation-id":"UserExpirationDetailsList",className:"ms-UserExpiration-UserExpirationList",checkboxCellClassName:"ms-UserExpirationList-Checkbox",items:t||[],compact:!1,columns:r,selectionMode:t&&t.length>0?f.t.multiple:f.t.none,layoutMode:l.i.justified,isHeaderVisible:!0,selection:n._selection,selectionPreservedOnEmptyClick:!0,enterModalSelectionOnTouch:!0,ariaLabelForSelectionColumn:N.q,ariaLabelForSelectAllCheckbox:N.I,onRowDidMount:function(e,t){n._onRenderItem(e,t)},constrainMode:l.r.horizontalConstrained,enableShimmer:t?0===t.length&&s:s,onRenderDetailsHeader:n._onRenderDetailsHeader,onRenderRow:n._onRenderRow}))};n._onRenderRow=function(e,t){return t(Object(r.__assign)(Object(r.__assign)({},e||{}),{onRenderCheck:n._onRenderCheck}))};n._onRenderCheck=function(e,t){void 0===t&&(t=c.e);return i.createElement(t,Object(r.__assign)({},e,{styles:{root:"ms-UserExpirationList-CheckBoxRoot",check:"ms-UserExpirationList-CheckBoxCheck",isDisabled:"ms-UserExpirationList-CheckBoxDisabled"}}))};n._onRenderDetailsHeader=function(e,t){return i.createElement(A.e,{stickyPosition:O.e.Header},t(Object(r.__assign)(Object(r.__assign)({},e||{}),{onRenderColumnHeaderTooltip:n._onRenderDetailsHeaderTooltip,onRenderDetailsCheckbox:n._onRenderDetailsCheckbox,styles:{cellIsCheck:"ms-UserExpirationList-CheckBoxRoot",check:"ms-UserExpirationList-CheckBoxRoot"}})))};n._onRenderDetailsCheckbox=function(e,t){return t(Object(r.__assign)({},e))};n._onRenderDetailsHeaderTooltip=function(e){return i.createElement(g.e,Object(r.__assign)({},e))};n._renderNameColumn=function(e){var t=n.state,r=t.isNameTooltipVisible,s=t.isEmailTooltipVisible;if(e){var o=e.uniqueId+"name",u=e.uniqueId+"nameTooltip",a=e.uniqueId+"email",f=e.uniqueId+"emailTooltip";return i.createElement("div",null,i.createElement("div",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}},i.createElement(g.e,{content:e.title,overflowMode:y.e.Parent,id:u,onTooltipToggle:n._onNameTooltip,calloutProps:{gapSpace:0,target:"#"+o}},i.createElement("span",{className:"ms-UserExpirationList-UserName","aria-labelledby":r?u:void 0,id:o},e.title))),i.createElement("div",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}},i.createElement(g.e,{content:e.email,overflowMode:y.e.Parent,id:f,onTooltipToggle:n._onEmailTooltip,calloutProps:{gapSpace:0,target:"#"+a}},i.createElement("span",{className:"ms-UserExpiratinLIst-UserEmail","aria-labelledby":s?f:void 0,id:a},e.email?e.email:""))))}};n._renderOptionsBox=function(e,t){var r=t?[{key:"extend",text:N.N,onClick:function(){n.setState({selectedUser:e,isExtendDialogVisible:!0})}},{key:"expire",text:N.j,onClick:function(){n.setState({selectedUser:e,isExpireDialogVisible:!0})}}]:[{key:"clear",text:N.o,onClick:function(){n.setState({selectedUser:e,isClearDialogVisible:!0})}},{key:"expire",text:N.j,onClick:function(){n.setState({selectedUser:e,isExpireDialogVisible:!0})}}],s={iconName:"MoreVertical",styles:{root:{fontSize:"16px"}}};return i.createElement(v.e,{"data-is-focusable":!0,className:"ms-UserExpiration-actionButton",ariaLabel:"stringsResx.moreOptionsLabel",menuIconProps:s,menuProps:{shouldFocusOnMount:!0,items:r}})};n._renderExpirationDate=function(e){var t=n.state.isExpirationTooltipVisible;if(e.isExpiring)return i.createElement("div",null,N.x);if(e.isExtending)return i.createElement("div",null,N.M);if(e.isClearing)return i.createElement("div",null,N.c);var r=n.daysAway(e.expiration),s="ms-UserExpirationList-Expiration"+(r<7&&r>0?" Soon":"")+(e.isSiteAdmin?" Admin":""),o=e.uniqueId+"expiration",u=o+"tooltip";return i.createElement("div",null,i.createElement(g.e,{content:L.format(N.S,e.expiration.toLocaleDateString("en-us",{month:"long",day:"numeric",year:"numeric"})),id:u,onTooltipToggle:n._onExpirationTooltip,calloutProps:{gapSpace:0,target:"#"+o}},i.createElement("div",{className:s,id:o,"aria-labelledby":t?u:void 0},n._ExpirationDate(e))),e.isSiteAdmin&&n._renderAdminNotification(o))};n._renderAdminNotification=function(e){return i.createElement(g.e,{content:N.e,calloutProps:{gapSpace:0,target:"#"+e+"test"}},i.createElement(k.e,{id:e+"test",iconName:"Info",className:"ms-UserExpirationList-AdminWarning"}))};n._renderDialog=function(){var e,t,r,s,o,u,a,f=n.state,l=f.isExpireDialogVisible,c=f.isExtendDialogVisible,h=f.isClearDialogVisible,p=f.selectedUser,d=n.props.userExpirationPolicyDays,v=n._selection.getSelectedCount();if(p){o=p.title;u=p.email}else if(1===v){var m=n._selection.getSelection()[0];o=m.title;u=m.email}if(l){e=N.E;t=v<=1?L.format(N.y,o,u):L.formatWithLocalizedCountValue(N.w,N.b,v);r=N.g;s=N.i;if(p){var g=[];g.push(p);a=function(){n._expireNow(g);n._closeDialog()}}else a=function(){n._expireNow(n._selection.getSelection());n._selection.setItems(n._selection.getSelection(),!0);n._closeDialog()}}else if(c){var y=new Date;y.setDate(y.getDate()+d);e=N.O;t=v<=1?L.format(N.k,o,u,y.toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})):L.format(L.getLocalizedCountValue(N.A,N.L,v),v,y.toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}));r=N.C;s=N.i;if(p){var b=[];b.push(p);a=function(){n._setUserExpiration(b,y);n._closeDialog()}}else a=function(){n._setUserExpiration(n._selection.getSelection(),y);n._selection.setItems(n._selection.getSelection(),!0);n._closeDialog()}}else if(h){e=N.l;t=v<=1?L.format(N.u,o,u):L.formatWithLocalizedCountValue(N.f,N.a,v);r=N.s;s=N.i;if(p){var C=[{}];C.push(p);a=function(){n._clearExpiration(C);n._closeDialog()}}else a=function(){n._clearExpiration(n._selection.getSelection());n._selection.setItems(n._selection.getSelection(),!0);n._closeDialog()}}else n._closeDialog();return i.createElement(w.e,{hidden:!1,onDismiss:n._closeDialog,dialogContentProps:{type:E.e.normal,title:e,subText:t},modalProps:{isBlocking:!1,containerClassName:"ms-dialogMainOverride"}},i.createElement(S.e,null,i.createElement(x.e,{onClick:a,text:r}),i.createElement(T.e,{onClick:n._closeDialog,text:s})))};n._onNameTooltip=function(e){n.setState({isNameTooltipVisible:e})};n._onEmailTooltip=function(e){n.setState({isEmailTooltipVisible:e})};n._onExpirationTooltip=function(e){n.setState({isExpirationTooltipVisible:e})};n._showExtendDialog=function(){n.setState({isExtendDialogVisible:!0})};n._showClearDialog=function(){n.setState({isClearDialogVisible:!0})};n._showExpireDialog=function(){n.setState({isExpireDialogVisible:!0})};n._clearExpiration=function(e){e.forEach(function(e){e.isClearing=!0});n._updateUsers(e);n._userExpirationProvider.setUserExpiration(e,void 0).then(function(t){var r=[];t.forEach(function(t,n){t?r.push(e[n]):e[n].isClearing=!1});n._removeUsers(r);return e.filter(function(e,n){return!t[n]})}).then(function(e){if(e.length>0){e.forEach(function(t,n){e[n].isExpiring=!1});n._updateUsers(e)}})};n._fetchExpiringUsers=function(){var e=n.state,t=e.orderBy,r=e.ascending,i=e.filterText,s=e.hasMoreUsers,o=e.allUsers,u=n.props.pageSize;if(s){var a;a=o?n.state.allUsers:[];n._userExpirationProvider.getUsersWithExpirationsWithCache(t,r,u,a.length,void 0,3).then(function(e){if(Array.isArray(e)&&e.length>0){e.forEach(function(e){e.uniqueId=Object(d.e)();a.push(e)});var t=n._mergeInNewUsers(e),r=n.filterUsers(i,t),s=e.length===u&&r&&r.length<u;n.setState({allUsers:t,users:r,hasMoreUsers:e.length===u});return s}n.setState({hasMoreUsers:!1});return!1}).then(function(e){e&&n._fetchExpiringUsers()}).catch(function(e){m.e.logData({name:"error fetching users"})})}};n._setUserExpiration=function(e,t){e.forEach(function(e){e.isExtending=!0});n._updateUsers(e);n._userExpirationProvider.setUserExpiration(e,t).then(function(r){var i=!1;r.forEach(function(n,r){n?e[r].expiration=t:i=!0;e[r].isExtending=!1});n._updateUsers(e);return i}).then(function(e){})};n._expireNow=function(e){e.forEach(function(e){e.isExpiring=!0});n._updateUsers(e);n._userExpirationProvider.expireUser(e).then(function(t){var r=e.filter(function(e,n){return t[n]});n._removeUsers(r);return e.filter(function(e,n){return!t[n]})}).then(function(e){if(e.length>0){e.forEach(function(t,n){e[n].isExpiring=!1});n._updateUsers(e)}})};n._removeUsers=function(e){var t=n.state,r=t.allUsers,i=t.filterText,s=n._mapUsers(e),o=r.filter(function(e){return!(e.id in s)});n.setState({allUsers:o.concat(),users:n.filterUsers(i,o)},function(){o.length<=10&&n._fetchExpiringUsers()})};n._updateUsers=function(e){var t=n.state,r=t.allUsers,i=t.filterText,s=n._mapUsers(e),o=r.map(function(e){return s[e.id]||e});n.setState({allUsers:o,users:n.filterUsers(i,o)})};n._mergeInNewUsers=function(e){var t=n.state.allUsers;if(t&&t.length>0){var i=n._mapUsers(t),s=e.filter(function(e){return!(e.id in i)});return Object(r.__spreadArrays)(t,s)}return e};n._mapUsers=function(e){for(var t={},n=0,r=e;n<r.length;n++){var i=r[n];t[i.id]=i}return t};n._sort=function(e,t,n){var r=t?function(e,t){return e.title.toLocaleUpperCase().localeCompare(t.title.toLocaleUpperCase())}:function(e,t){return e.expiration.valueOf()-t.expiration.valueOf()};e.sort(r);n&&e.reverse();return e};n._closeDialog=function(){n.setState({isExpireDialogVisible:!1,isExtendDialogVisible:!1,isClearDialogVisible:!1,selectedUser:void 0})};n._onRenderItem=function(e,t){var r=n.state.users;(t===r.length-10||r.length<10&&t===r.length-1)&&n._fetchExpiringUsers()};n._ExpirationDate=function(e){var t=e.expiration,r=n.daysAway(t);return r<7&&r>0?L.formatWithLocalizedCountValue(N.h,N.p,r):t.toLocaleString("en-us",{month:"short",day:"numeric"})};n.daysAway=function(e){var t=e.getTime(),n=Date.now();return Math.ceil((t-n)/864e5)};n._getSelectionDetails=function(){return n._selection.getSelectedCount()>0};n._onColumnClick=function(e,t){var i=n.state,s=i.columns,o=i.hasMoreUsers,u=i.users,a=s.map(function(e){var n=e.key===t.key;return Object(r.__assign)(Object(r.__assign)({},e),{isSorted:n,isSortedDescending:n&&!e.isSortedDescending})});o?n.setState({allUsers:[],hasMoreUsers:!0,orderBy:t.fieldName,ascending:!t.isSortedDescending,columns:a},function(){return n._fetchExpiringUsers()}):n.setState({users:Object(r.__spreadArrays)(n._sort(u,"Title"===t.fieldName,!t.isSortedDescending)),orderBy:t.fieldName,ascending:!t.isSortedDescending,columns:a})};n._searchForUser=function(e){var t=n.state.allUsers;t&&t.length>0?n.setState({filterText:e,users:n.filterUsers(e,t)},function(){var e=n.state.users;e&&e.length<10&&n._fetchExpiringUsers()}):n.setState({filterText:e})};n.filterUsers=function(e,t){var n=e.toLocaleUpperCase();return t&&t.length>0?t.filter(function(e){return e&&e.email&&e.email.toLocaleUpperCase().indexOf(n)>-1||e&&e.title&&e.title.toLocaleUpperCase().indexOf(n)>-1}):t};n._userExpirationProvider=t.userExpirationProvider;var s=n._getColumns(t.userExpirationPolicyEnabled,"UserExpiration",!1);n._selection=new h.e({onSelectionChanged:function(){n.setState({isUserSelected:n._getSelectionDetails()})}});n.state={users:void 0,allUsers:void 0,columns:s,isUserSelected:n._getSelectionDetails(),isNameTooltipVisible:!1,isEmailTooltipVisible:!1,isExpirationTooltipVisible:!1,isClearDialogVisible:!1,isExpireDialogVisible:!1,isExtendDialogVisible:!1,selectedUser:void 0,hasMoreUsers:!0,orderBy:"UserExpiration",ascending:!0,filterText:""};return n}t.prototype.render=function(){var e=this.state,t=e.users,n=e.isExtendDialogVisible,r=e.isClearDialogVisible,s=e.isExpireDialogVisible,o=e.hasMoreUsers,u=!(t&&0!==t.length||o);return i.createElement("div",{className:"ms-userExpirationList"},this._renderButtonArea(),i.createElement(M.e,{scrollbarVisibility:_.t.always,className:"ms-userExpirationList-ScrollablePane"},this._renderList(),u&&this._renderNoUsersMessage()),(s||n||r)&&this._renderDialog())};t.prototype.componentDidMount=function(){this._fetchExpiringUsers()};t.prototype.componentDidUpdate=function(e){e.userExpirationPolicyEnabled!==this.props.userExpirationPolicyEnabled&&this.setState({columns:this._getColumns(this.props.userExpirationPolicyEnabled,this.state.orderBy,this.state.ascending)})};return t})(i.Component),P=Object(u.e)(D,function(e){return{root:[],label:{}}}),H=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._renderCloseButton=function(){var e={iconName:"cancel",styles:{root:"ms-UserExpiration-CloseButton"}};return i.createElement("div",{className:"ms-UserExpiration-Navigation"},i.createElement(v.e,{"data-is-focusable":!0,ariaLabel:"Close panel",iconProps:e,onClick:n._closePanel}))};n._renderHeader=function(){var e=n.props.userExpirationPolicyDays,t=n.state.hideNoExpirationPolicyInfo,r={iconName:"Back",styles:{root:"ms-UserExpirationPanel-Back"}};return i.createElement("div",{className:"ms-UserExpirationPanel-Header"},i.createElement("div",{className:"ms-UserExpirationPanel-TitleRow"},i.createElement("div",{className:"ms-UserExpirationPanel-Title"},n.props.onBackButton&&i.createElement(v.e,{"data-is-focusable":!0,className:"ms-UserExpiration-BackButton",ariaLabel:N.r,iconProps:r,onClick:n._onBackButton}),N.R),n._renderCloseButton()),i.createElement("div",{className:"ms-UserExpirationPanel-HeaderText"},L.formatWithLocalizedCountValue(N._,N.U,e)),!t&&n._renderNoExpirationPolicyInfo())};n._renderGuestExpiration=function(){var e=n.props,t=e.userExpirationPolicyDays,r=e.userExpirationPolicyEnabled;return i.createElement("div",{className:"ms-UserExpirationList"},i.createElement(P,{userExpirationProvider:n.props.userExpirationProvider,userExpirationPolicyDays:t,userExpirationPolicyEnabled:r,pageSize:50}))};n._renderNoExpirationPolicyInfo=function(){if(!n.props.userExpirationPolicyEnabled){return i.createElement("div",{className:"ms-UserExpiration-NoPolicy"},i.createElement(k.e,{iconName:"Error",className:"ms-UserExpiration-Warning"}),i.createElement("div",{className:"ms-UserExpiration-NoPolicyText"},N.P),i.createElement(v.e,{"data-is-focusable":!0,className:"ms-UserExpiration-HideNoPolicyInfo",ariaLabel:"hide no policy info",menuIconProps:{iconName:"cancel"},onClick:n._hideNoPolicyInfo}))}};n._hideNoPolicyInfo=function(){n.setState({hideNoExpirationPolicyInfo:!0})};n._closePanel=function(){n.setState({showPanel:!1});n.props.onDismiss&&n.props.onDismiss()};n._onBackButton=function(){n.setState({showPanel:!1});n.props.onBackButton&&n.props.onBackButton()};n.state={showPanel:!0,hideNoExpirationPolicyInfo:!1};return n}t.prototype.render=function(){return i.createElement(s.e,{className:"ms-UserExpirationPanel",isOpen:this.props.isOpen,type:o.e.smallFixedFar,onDismiss:this._closePanel,isLightDismiss:!0,forceFocusInsideTrap:!1,styles:{content:"ms-UserExpirationPanel-content",scrollableContent:"ms-UserExpirationPanel-ScrollableContent"},onRenderHeader:this._renderHeader,hasCloseButton:!1,onRenderBody:this._renderGuestExpiration})};return t})(i.Component),B=Object(u.e)(H,function(e){return{root:[],label:{}}})},2529:function(e,t,n){"use strict";n.r(t);n.d(t,"TeamifyBanner",function(){return r.e});n.d(t,"default",function(){return r.e});var r=n(2461)},2550:function(e,t,n){"use strict";n.d(t,"e",function(){return u});var r=n(0),i=n("react-lib"),s=n(2180),o=n(2517),u=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._changeTheLookPanelStateManager=new s.e(Object(r.__assign)(Object(r.__assign)({},t),{updateState:n.setState.bind(n)}));n._changeTheLookPanelStateManager.getRenderProps().then(function(e){return n.setState(e)});return n}t.prototype.componentDidMount=function(){this._changeTheLookPanelStateManager.componentDidMount()};t.prototype.render=function(){return this.state&&i.createElement(o.e,Object(r.__assign)({},this.state))};return t})(n(965).e)},2575:function(e,t,n){"use strict";n.d(t,"e",function(){return We});var r=n(0),i=n("react-lib"),s=n(4148),o=n(2686),u=n(1608),a=n(2525),f=n(2127),l=n(1533),c=n(121),h=n(40),p=n(1623),d=n(321),v=n(537),m=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._onClick=function(){r.setState({isContextualMenuVisible:!r.state.isContextualMenuVisible})};r._onDismiss=function(e){r.setState({isContextualMenuVisible:!1});e.stopPropagation();e.preventDefault()};r._resolveMenu=function(e){return r.menu=e};r.state={isContextualMenuVisible:!1};return r}t.prototype.render=function(){return this.props.menuItems?i.createElement("div",{className:"ms-sitePerm-ContextMenuButton","data-automationid":"SitePermissionsPersonaContextMenuButton"},i.createElement(p.e,{direction:d.e.horizontal},i.createElement("div",{className:"ms-sitePerm-buttonArea",ref:this._resolveMenu},i.createElement("span",{className:"ms-sitePerm-linkText",onClick:this._onClick,"data-is-focusable":!0,role:"button","aria-haspopup":!0,"data-automationid":"SitePermissionsPersonaContextMenuButton","aria-expanded":!!this.state.isContextualMenuVisible},this.props.permLevelTitle,i.createElement(v.e,{iconName:"ChevronDown",className:Object(h.e)("ms-sitePermMenu-chevron",this.props.permLevelTitle&&"has-permLevelTitle")}))),this.state.isContextualMenuVisible&&i.createElement(l.e,{className:"ms-sitePerm-PersonaContextMenu",items:this.props.menuItems,isBeakVisible:!1,target:this.menu,directionalHint:c.e.bottomLeftEdge,onDismiss:this._onDismiss,gapSpace:0}))):i.createElement("div",{className:"ms-sitePerm-noButtonArea","data-automationid":"SitePermissionsNoButtonArea"},this.props.permLevelTitle)};return t})(i.Component),g=n(536),y=n(112),b=n(690),w=n(1627),E=n(1598),S=n(67),x=n(4261),T=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._onClick=function(){n.setState({isExpanded:!n.state.isExpanded})};n._onLPCOpen=function(){n.props.isLPCOpenHandler&&n.props.isLPCOpenHandler(!0)};n._onLPCClose=function(){n.props.isLPCOpenHandler&&n.props.isLPCOpenHandler(!1)};n.state={isExpanded:t&&t.hideHeader};return n}t.prototype.render=function(){var e=this,t=this.props,n=t.personas,r=t.hideHeader,s=this.state.isExpanded;return i.createElement("div",{className:"ms-sitePerm-body","data-automationid":"SitePermissionsBody"},i.createElement(p.e,{direction:d.e.vertical,isInnerZoneKeystroke:function(e){return e.which===Object(g.t)(y.e.right)}},!r&&i.createElement("span",null,i.createElement("span",{className:"ms-sitePerm-itemBtn",onClick:this._onClick,"data-is-focusable":!0,"data-automationid":"SitePermHeader"+t.permLevel,"aria-expanded":!!s,role:"button"},i.createElement(v.e,{iconName:"ChevronDown",className:Object(h.e)("ms-sitePerm-chevron",s&&"is-expanded")}),i.createElement("span",{className:"ms-sitePerm-itemBtn-title","data-automationid":"SitePermissionsBodyButton"},t.title)),!S.t.isActivated("aa38568e-5b21-4929-a610-068c546b4839","08/03/2021","Replace group membership picker component")&&t.description&&i.createElement(w.e,{content:t.description,directionalHint:c.e.bottomCenter,hostClassName:"ms-sitePerm-infoIconContainer"},i.createElement(b.e,{iconName:"Info",className:"ms-sitePerm-infoIcon",tabIndex:0,"data-is-focusable":!0,"aria-label":t.description,role:"img"}))),i.createElement("div",{className:"ms-sitePerm-personaContainer"},s&&n&&n.length?n.map(function(t,n){if(t.currentUserCannotViewMembers)return i.createElement("div",{className:"ms-sitePerm-cannotViewMembersText"},x.e);var r=e._getPersonaControl(t);return e._getPersona(r,t,n)}):s&&i.createElement("div",{className:"ms-sitePerm-emptyGroupText"},x.t))))};t.prototype._makeDeferredLpcProps=function(e){var t,n=2===e.type?"Group":"User";t={cardParameters:{personaInfo:{identifiers:{Smtp:e.groupId?void 0:e.email,PersonaType:n,Upn:e.email,AadObjectId:e.groupId,DisplayName:e.name}},behavior:{onCardOpen:this._onLPCOpen,onCardClose:this._onLPCClose}}};return{personaType:n,identifier:e.email,pageContext:this.props.pageContext,moduleLoader:this.props.lpcModuleLoader,customWaiter:this.props.lpcModuleCustomWaiter,addGroupMembersCallback:void 0,lpcHoverTargetProps:void 0,lpcHoverTargetV2Props:t}};t.prototype._wrapPersona=function(e){var t=this;return function(n,r){var s=t._makeDeferredLpcProps(e);return Object(E.t)(s,i.createElement("div",null,r(n)))}};t.prototype._getPersonaControl=function(e){var t=this.props.lpcModuleLoader?this._wrapPersona(e):void 0;return i.createElement(a.e,{"data-is-focusable":!0,imageInitials:e.imageInitials,imageUrl:e.imageUrl,initialsColor:e.initialsColor,primaryText:e.name,size:f.n.small,hidePersonaDetails:!1,onRenderCoin:t,onRenderInitials:t,onRenderPrimaryText:t,"data-automationid":"SitePermissionsPersonaControl"},(S.t.isActivated("53558946-f5c9-4d9e-a69e-d53a11db1ac8","06/24/2021","Disable site perm menu for channel site")||!this.props.pageContext.isTeamsChannelSite)&&i.createElement(m,{menuItems:e.menuItems,title:this.props.title,permLevelTitle:this.props.permLevelTitle}))};t.prototype._getPersona=function(e,t,n){return i.createElement("div",{className:"ms-sitePerm-Persona",title:t.name,key:n+t.name,"data-automationid":"SitePermissionsPersona"},i.createElement("div",{className:"ms-sitePerm-personName","data-automationid":"SitePermissionsPersonaName"},e))};return t})(i.Component),N=n(1616),C=n(1115),k=n(1988),L=n(3493),A=n(2073),O=n(1617),M=n(1780),_=n(163),D=n(5037),P=n(2679),H=n(2457),B=n(83),j=n(4176),F=n(1783),I=n(102),q=n(30),R=n(18),U=n(4256),z=n(1888);function W(e){for(var t=e.selectedItems,n=e.sharingLinkKind,r=e.canAddExternalPrincipal,s=e.hasDlpPolicyTip,o=e.viewPolicyTipCallback,u=e.permissionsMap,a=0,f=t;a<f.length;a++){var l=f[a];if(!l.isResolved)return s&&!r?i.createElement("div",null,i.createElement("span",null,U.e," "),i.createElement(M.e,{onClick:o},U.t)):l.rawData?l.rawData.Description:i.createElement("span",null,U.a);if(l.isExternal&&l.principalType===z.e.distributionList&&2===l.entityType)return i.createElement("span",null,U.p);var c=3===n||2===n;if(l.isExternal&&c)return i.createElement("span",null,U.h)}if(u&&1===n){var h=0;for(var p in u)1===u[p]&&h++;if(1===h)return i.createElement("span",null,U.s);if(h>1)return i.createElement("span",null,U.o)}return null}var X,V,$,J=n(2075),K=n(58),Q=n(3853),G=n(244),Y=n(5020),Z=n(693),ee=n(4259),te=n(4968),ne=n(4544),re=n(2314),ie=n(3771),se=n(2473),oe=n(2849);(function(e){e[e.Default=0]="Default";e[e.Email=1]="Email"})(X||(X={}));(function(e){e[e.FileFolderSite=0]="FileFolderSite";e[e.FileFolder=1]="FileFolder";e[e.None=2]="None"})(V||(V={}));(function(e){e[e.Unspecified=0]="Unspecified";e[e.On=1]="On";e[e.Off=2]="Off"})($||($={}));var ue=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.onDismiss=function(){n.resetState();n.props.onDismiss&&n.props.onDismiss();_.e.logData({name:"SiteSharingSettingsPanel.OnDismiss.Click"})};n.onBackButtonClick=function(){if(!n.hasInvalidSettings()&&n.haveSettingsChanged())n.setState({showConfirmDialog:!0});else{n.resetState();n.props.onDismiss&&n.props.onDismiss()}_.e.logData({name:"SiteSharingSettingsPanel.BackButton.Click"})};n.onSaveClick=function(){var e=n.state.selectedPersons&&1===n.state.selectedPersons.length?n.state.selectedPersons[0]:null,t="someone@example.com",r=!1;n.state.accessRequestEnabled?n.state.accessRequestOption===X.Email?t=e.email:r=!0:t="";n.setMembersCanShareFromOption(n.state.membersCanShareOption);var i={membersCanShare:n.membersCanShareEnabled,requestAccessEmail:t,useAccessRequestDefault:r,accessRequestSiteDescription:n.state.accessRequestSiteDescription,defaultMembersGroupAddMembers:n.membersCanShareEnabled&&n.membersCanAddToGroupEnabled,membersGroup:n.siteSharingSettings.membersGroup,ownersGroup:n.siteSharingSettings.ownersGroup};n.sharingSiteProvider.setSiteSharingSettings(i).then(function(e){n.siteSharingSettings=i;n.setState({showLoadingSpinner:!1});n.props.onDismiss&&n.props.onDismiss()},function(e){var t=[];if(e&&e.hasError&&e.items)for(var r=e.items,i=0;i<r.length;i++){var s=r[i];s&&s.error&&t.push(s.error.message)}n.setState({showLoadingSpinner:!1,saveFailed:!0,serverErrorDetails:t})});n.setState({showLoadingSpinner:!0,showConfirmDialog:!1});_.e.logData({name:"SiteSharingSettingsPanel.Save.Click"})};n.onDiscardClick=function(){n.resetState();n.props.onDismiss&&n.props.onDismiss();_.e.logData({name:"SiteSharingSettingsPanel.Discard.Click"})};n.onAccessRequestChange=function(){n.setState({accessRequestEnabled:!n.state.accessRequestEnabled});_.e.logData({name:"SiteSharingSettingsPanel.AccessRequest.Click"})};n.onAccessRequestSiteDescriptionChange=function(e,t){n.setState({accessRequestSiteDescription:t});_.e.logData({name:"SiteSharingSettingsPanel.AccessRequestSiteDescription.Click"})};n.onAccessRequestOptionChanged=function(e,t){n.setState({accessRequestOption:X[t.key]})};n.onMembersCanShareOptionChanged=function(e,t){n.setState({membersCanShareOption:V[t.key]})};n.onSelectedPeopleChange=function(e){var t,r=W({selectedItems:e});if(!r&&e.length>0){e[0].email||(r=i.createElement("span",null,ee.m))}r&&(t=i.createElement(F.e,{className:"ms-siteSharingSettingsPanel-peoplePicker-error",messageBarType:I.e.error},r));var s=e.length>0&&!t;n.setState({selectedPersons:e,peoplePickerError:t,personaSelected:s})};n.onSuggestionSelected=function(e){return n.peoplePickerProvider.resolve(e.userId,n.pickerParams).then(function(e){!e.email&&e.rawData.EntityData&&(e.email=e.rawData.EntityData.OtherMails);return e})};n.onDiscardDialogClick=function(){n.resetState();n.props.onDismiss&&n.props.onDismiss();_.e.logData({name:"SiteSharingSettingsPanel.DialogDiscard.Click"})};n.onDismissSaveErrorMessage=function(){n.setState({saveFailed:!1,serverErrorDetails:[]});_.e.logData({name:"SiteSharingSettingsPanel.ErrorMessage.Click"})};n.state={showLoadingSpinner:!0};n.peoplePickerProvider=t.peoplePickerProvider;n.sharingSiteProvider=t.sharingSiteProvider;n.pickerParams={principalSource:15,principalType:7,allowEmailAddresses:!0,maximumEntitySuggestions:30,forceResolve:!0};_.e.logData({name:"SiteSharingSettingsPanel.Opened.Click"});return n}t.prototype.render=function(){var e=this,t=this.props,n=t.pageContext,r=t.isOpen,a=this.state,f=a.showLoadingSpinner,l=a.accessRequestOption,c=a.membersCanShareOptionDisabled,h=a.membersCanShareOption,p=a.accessRequestEnabled,d=a.accessRequestSiteDescription,v=a.selectedPersons,m=a.peoplePickerError,g=a.showConfirmDialog,y={iconName:"Back"};return i.createElement(s.e,{className:"ms-siteSharingSettingsPanel",isOpen:r,type:o.e.smallFixedFar,onDismiss:this.onDismiss,isLightDismiss:!0,forceFocusInsideTrap:!1,closeButtonAriaLabel:ee.u,onRenderNavigationContent:function(t,n){return i.createElement(i.Fragment,null,i.createElement("div",{className:"ms-siteSharingSettingsPanel-Header"},i.createElement("div",{className:"ms-siteSharingSettingsPanel-Title-Container"},i.createElement(u.e,{"data-is-focusable":!0,className:"ms-siteSharingSettings-BackButton",ariaLabel:ee.u,iconProps:y,onClick:e.onBackButtonClick}),i.createElement("p",{className:"ms-siteSharingSettingsPanel-Title"}," ",ee.y))),n(t))},onRenderFooterContent:function(t,n){return i.createElement("div",{className:"ms-siteSharingSettingsPanel-Footer"},i.createElement(N.e,{className:"ms-siteSharingSettingsPanel-saveButton",onClick:e.onSaveClick,"data-automationid":"SiteSharingSettingsPanelSaveButton",disabled:e.hasInvalidSettings()||!e.haveSettingsChanged()},ee.d),i.createElement(C.e,{className:"ms-siteSharingSettingsPanel-discardButton",onClick:e.onDiscardClick,"data-automationid":"SiteSharingSettingsPanelPanelDiscardButton"},ee.f),e.state.saveFailed&&i.createElement("div",{className:"ms-groupMember-errorMessage"},i.createElement(F.e,{messageBarType:I.e.error,isMultiline:!0,onDismiss:e.onDismissSaveErrorMessage,dismissButtonAriaLabel:ee.u},i.createElement("span",null,ee.v),e.state.serverErrorDetails.map(function(e){return i.createElement("span",null,e)}))))},styles:{content:"siteSharingSettingsPanel-content"}},i.createElement("div",{className:"ms-siteSharingSettingsPanel-Content"},!f&&i.createElement("div",null,i.createElement("div",{className:"SiteSharingSettingsPanelDescription","data-automationid":"SiteSharingSettingsPanelDescription"},ee.g),c?i.createElement(re.e,{className:"ms-siteSharingSettingsPanel-tenantAdminMembersCanShareMessage"},ee.b):null,i.createElement("div",{className:"ms-siteSharingSettingsPanel-SharingPermissionsChoiceGroup"},i.createElement(ne.e,{selectedKey:V[h],options:[{key:V[0],text:ee.c},{key:V[1],text:ee.l},{key:V[2],text:ee.h}],label:ee.p,styles:{applicationRole:{marginBottom:48},label:{fontWeight:"600",fontSize:16}},required:!1,disabled:c,onChange:this.onMembersCanShareOptionChanged})),i.createElement("div",{className:"ms-siteSharingSettingsPanel-sectionHeader"},i.createElement(re.e,{className:"ms-siteSharingSettingsPanel-sectionHeaderLabel"},ee.n)),i.createElement(te.e,{checked:p,label:ee.o,inlineLabel:!0,onChange:this.onAccessRequestChange,onText:ee.E,offText:ee.w,styles:{root:{justifyContent:"space-between"}}}),p&&i.createElement("div",{className:"ms-siteSharingSettingsPanel-AccessRequestsChoiceGroup"},i.createElement(ne.e,{selectedKey:X[l],options:[{key:X[0],text:this.siteSharingSettings.ownersGroup&&this.siteSharingSettings.ownersGroup.title||ee.r},{key:X[1],text:ee.t}],label:ee.e,required:!1,onChange:this.onAccessRequestOptionChanged,styles:{applicationRole:{marginBottom:16},label:{fontWeight:"600"}}})),p&&l===X.Email&&i.createElement("div",{className:"ms-siteSharingSettingsPanel-container"},i.createElement(k.e,{noResultsFoundText:" ",context:n,peoplePickerType:A.e.normal,onSelectedPersonasChange:this.onSelectedPeopleChange,onSuggestionSelected:this.onSuggestionSelected,dataProvider:this.peoplePickerProvider,itemLimit:1,peoplePickerQueryParams:this.pickerParams,selectedItems:v}),m),p&&i.createElement(P.e,{label:ee.i,className:"ms-siteSharingSettingsPanel-textField",placeholder:ee.s,multiline:!0,rows:4,resizable:!1,value:d,onChange:this.onAccessRequestSiteDescriptionChange,maxLength:500,styles:{subComponentStyles:{label:{root:{paddingBottom:16}}}}})),f&&i.createElement(O.e,null),i.createElement(ie.e,{hidden:!g,className:"ms-siteSharingSettingsPanel-confirmDialog",onDismiss:this.onDiscardDialogClick,dialogContentProps:{type:se.e.normal,title:ee.a},modalProps:{isBlocking:!1}},i.createElement(oe.e,null,i.createElement(N.e,{className:"ms-siteSharingSettingsPanel-saveButton",onClick:this.onSaveClick,text:ee.d}),i.createElement(C.e,{className:"ms-siteSharingSettingsPanel-discardButton",onClick:this.onDiscardDialogClick,text:ee.f})))))};t.prototype.componentDidMount=function(){this.loadSiteSharingSettings()};t.prototype.loadSiteSharingSettings=function(){var e=this;this.getSiteSharingSettings().then(function(){e.setState({showLoadingSpinner:!1,membersCanShareOption:e.getMembersCanShareOption(),membersCanShareOptionDisabled:e.siteSharingSettings&&e.siteSharingSettings.tenantAdminMembersCanShare&&e.siteSharingSettings.tenantAdminMembersCanShare!==$.Unspecified,accessRequestEnabled:e.siteSharingSettings&&(e.siteSharingSettings.useAccessRequestDefault||!!e.siteSharingSettings.requestAccessEmail),accessRequestOption:!e.siteSharingSettings||!e.siteSharingSettings.useAccessRequestDefault&&e.siteSharingSettings.requestAccessEmail?X.Email:X.Default,requestAccessEmail:e.siteSharingSettings&&e.siteSharingSettings.requestAccessEmail,accessRequestSiteDescription:e.siteSharingSettings&&e.siteSharingSettings.accessRequestSiteDescription});e.state.requestAccessEmail?e.peoplePickerProvider.resolve(e.state.requestAccessEmail,e.pickerParams).then(function(t){!t.email&&t.rawData.EntityData&&(t.email=t.rawData.EntityData.OtherMails);e.setState({selectedPersons:[t],showLoadingSpinner:!1,personaSelected:!0})}):e.setState({showLoadingSpinner:!1})})};t.prototype.getSiteSharingSettings=function(){var e=this;return this.sharingSiteProvider.getSiteSharingSettings().then(function(t){e.siteSharingSettings=t}).catch(function(t){e.siteSharingSettings=void 0})};t.prototype.haveSettingsChanged=function(){var e=this.state,t=e.accessRequestOption,n=e.membersCanShareOption,r=e.accessRequestEnabled,i=e.accessRequestSiteDescription,s=e.selectedPersons,o=e.personaSelected,u=r&&t===X.Email&&o?s[0].email:"";this.setMembersCanShareFromOption(n);return this.siteSharingSettings&&(this.siteSharingSettings.membersCanShare!==this.membersCanShareEnabled||this.siteSharingSettings.membersGroup&&this.siteSharingSettings.membersGroup.allowMembersEditMembership!==this.membersCanAddToGroupEnabled||this.siteSharingSettings.requestAccessEmail!==u||this.siteSharingSettings.useAccessRequestDefault!==(r&&t===X.Default)||this.siteSharingSettings.accessRequestSiteDescription!==i)};t.prototype.hasInvalidSettings=function(){return this.state.accessRequestEnabled&&this.state.accessRequestOption===X.Email&&!this.state.personaSelected};t.prototype.setMembersCanShareFromOption=function(e){this.membersCanShareEnabled=!1;this.membersCanAddToGroupEnabled=!1;switch(e){case V.FileFolderSite:this.membersCanShareEnabled=!0;this.membersCanAddToGroupEnabled=!0;break;case V.FileFolder:this.membersCanShareEnabled=!0;this.membersCanAddToGroupEnabled=!1;break;default:this.membersCanShareEnabled=!1;this.membersCanAddToGroupEnabled=!1}};t.prototype.getMembersCanShareOption=function(){V.FileFolderSite;if(this.siteSharingSettings)return this.siteSharingSettings.tenantAdminMembersCanShare&&this.siteSharingSettings.tenantAdminMembersCanShare!==$.Unspecified?this.siteSharingSettings.tenantAdminMembersCanShare===$.On?V.FileFolderSite:V.None:this.siteSharingSettings.membersCanShare&&this.siteSharingSettings.membersGroup&&this.siteSharingSettings.membersGroup.allowMembersEditMembership?V.FileFolderSite:this.siteSharingSettings.membersCanShare?V.FileFolder:V.None};t.prototype.resetState=function(){this.setState({membersCanShareOption:this.getMembersCanShareOption(),accessRequestEnabled:this.siteSharingSettings&&(this.siteSharingSettings.useAccessRequestDefault||!!this.siteSharingSettings.requestAccessEmail),accessRequestOption:this.siteSharingSettings&&this.siteSharingSettings.useAccessRequestDefault?X.Default:X.Email,requestAccessEmail:this.siteSharingSettings&&this.siteSharingSettings.requestAccessEmail,accessRequestSiteDescription:this.siteSharingSettings&&this.siteSharingSettings.accessRequestSiteDescription,serverErrorDetails:[],saveFailed:!1})};return t})(i.Component),ae=Object(Z.e)(ue,function(e){return{root:[],label:{}}}),fe=n(4625),le=n(4257),ce=n(2520),he=n(4967),pe=n(4258),de=n(2782),ve=n(3857),me=n(120),ge=n(101),ye=n(739),be=n(1590),we=n(4629),Ee=n(1779),Se=n(4969),xe=n(3856),Te=n(4628),Ne=n(4260),Ce=n(1781),ke=n(345),Le=n(4548),Ae=n(2674),Oe=n(1122),Me=n(2146),_e=n(1629),De=n(282),Pe=n(4624),He=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._getColumns=function(e,t){return[{key:"column1",name:"     "+ve.m,fieldName:"RequestedForDisplayName",iconName:"Contact",minWidth:200,isRowHeader:!0,isResizable:!1,isSorted:"RequestedForDisplayName"===e,isSortedDescending:t,onRender:n._renderNameColumn,onColumnClick:n._onColumnClick,data:"string",isPadded:!1,className:"ms-AccessRequestsList-Column ms-AccessRequestsList-NameColumn"},{key:"column2",name:"File type",isResizable:!1,iconName:"Page",isIconOnly:!0,minWidth:16,maxWidth:16,onColumnClick:n._onColumnClick,onRender:n._renderFileType,className:"ms-AccessRequestsList-Column ms-AccessRequestsList-IconColumn"},{key:"column3",name:ve.p,fieldName:"ObjectRequestedTitleDisp",minWidth:280,isSorted:"ObjectRequestedTitleDisp"===e,isSortedDescending:t,isResizable:!1,onColumnClick:n._onColumnClick,data:"string",className:"ms-AccessRequestsList-Column ms-AccessRequestsList-ItemColumn",onRender:n._renderFilename,isPadded:!1},{key:"column4",name:ve.S,fieldName:"RequestDate",minWidth:138,isSorted:"RequestDate"===e,isSortedDescending:t,isResizable:!1,onColumnClick:n._onColumnClick,data:"string",onRender:n._renderRequestDate,className:"ms-AccessRequestsList-Column ms-AccessRequestsList-RequestDateColumn",isPadded:!1},{key:"column5",name:ve.w,isResizable:!1,onRender:n._renderPermissionsDropdown,minWidth:138,className:"ms-AccessRequestsList-Column ms-AccessRequestsList-PermissionsColumn",isPadded:!1},{key:"column6",name:"",isResizable:!1,onRender:n._renderRequestComment,minWidth:78,className:"ms-AccessRequestsList-Column ms-AccessRequestsList-CommentColumn",isPadded:!1}]};n._renderNoRequestsMessage=function(){return i.createElement(Te.e,{stickyClassName:"ms-AccessRequest-AccessRequestListHeader",stickyPosition:Ne.e.Header},i.createElement("div",null,ve.b))};n._renderNoInternalRequestsMessage=function(){return i.createElement(Te.e,{stickyClassName:"ms-AccessRequest-AccessRequestListHeader",stickyPosition:Ne.e.Header},i.createElement("div",null,ve.y))};n._renderNoExternalRequestsMessage=function(){return i.createElement(Te.e,{stickyClassName:"ms-AccessRequest-AccessRequestListHeader",stickyPosition:Ne.e.Header},i.createElement("div",null,ve.g))};n._renderContainsError=function(){return i.createElement(de.e,{horizontal:!0,tokens:{childrenGap:10,padding:10},styles:{root:{width:"100%"}}},i.createElement(de.e.Item,{order:1,className:"ms-accessRequestsList-Blocked"},i.createElement(v.e,{iconName:"Blocked2"})),i.createElement(Ae.e,{order:2,className:"ms-accessRequestsList-ErrorText"},ve.l),i.createElement(Ae.e,{order:3},i.createElement(u.e,{className:"ms-accessRequestsList-Cancel",iconProps:{iconName:"Cancel"},onClick:function(){n.setState({containsError:!1})}})))};n._renderTopButtons=function(){var e,t,r=n._selection.getSelection(),s=r.length>1,o=!(r.length>0);e=function(){n._approveDeclineAll(r,we.e.Approve)};t=function(){n._approveDeclineAll(r,we.e.Decline)};return i.createElement(de.e,{horizontal:!0,className:"ms-accessRequestsButtons",tokens:{childrenGap:10,padding:10},styles:{root:{width:"100%"}}},i.createElement(de.e.Item,{order:1},i.createElement("span",null,i.createElement(Oe.e,{iconProps:{iconName:"CheckMark"},allowDisabledFocus:!0,onClick:e,disabled:o},s?ve.r:ve.n))),i.createElement(de.e.Item,{order:2},i.createElement("span",null,i.createElement(Oe.e,{iconProps:{iconName:"Cancel"},allowDisabledFocus:!0,onClick:t,disabled:o},s?ve.u:ve.o))),i.createElement(de.e.Item,{order:3},0===r.length?i.createElement(Oe.e,{iconProps:{iconName:"Refresh"},allowDisabledFocus:!0,onClick:n._refreshPage},ve.E):null))};n._refreshPage=function(){n.setState({allRequests:[],hasMoreRequests:!0,orderBy:"RequestDate"},function(){return n._fetchPendingRequests()})};n._approveDeclineAll=function(e,t){var r=!1;e.forEach(function(e){!0===e.completed&&(r=!0)});if(r)n.setState({containsError:!0});else{n.setState({containsError:!1});n._accessRequestsProvider.changeRequestStatus(e,t).then(function(r){e.forEach(function(e){e.completed=!0;e.completedStatus=t===we.e.Approve?ve.i:ve.a});n._selection.setAllSelected(!0);n._selection.setAllSelected(!1)})}};n._renderList=function(){"internal"===n.props.currentFilter?n._filterForInternal():"external"===n.props.currentFilter&&n._filterForExternal();var e=n.state,t=e.allRequests,r=e.internalRequests,s=e.externalRequests,o=e.columns,u=e.hasMoreRequests;return i.createElement(Ee.e,null,i.createElement(Ce.e,{"data-automation-id":"AccessRequestDetailsList",className:"ms-AccessRequest-AccessRequestList",checkboxCellClassName:"ms-AccessRequestList-Checkbox",items:"all"===n.props.currentFilter?t:"internal"===n.props.currentFilter?r||[]:"external"===n.props.currentFilter&&s||[],compact:!1,columns:o,selectionMode:t&&t.length>0?me.t.multiple:me.t.none,layoutMode:ge.i.justified,isHeaderVisible:!0,selection:n._selection,selectionPreservedOnEmptyClick:!0,enterModalSelectionOnTouch:!0,ariaLabelForSelectionColumn:ve.N,ariaLabelForSelectAllCheckbox:ve.x,onRowDidMount:function(e,t){n._onRenderItem(e,t)},constrainMode:ge.r.horizontalConstrained,enableShimmer:t?0===t.length&&u:u,onRenderDetailsHeader:n.onRenderDetailsHeader,onRenderRow:n._onRenderRow}))};n._onRenderRow=function(e,t,i){return t(Object(r.__assign)(Object(r.__assign)({},e||{}),{onRenderCheck:n._onRenderCheck}))};n._onRenderCheck=function(e,t){void 0===t&&(t=ye.e);return i.createElement(t,Object(r.__assign)({},e,{styles:{root:"ms-AccessRequestsList-CheckBoxRoot",check:"ms-AccessRequestsList-CheckBoxCheck",isDisabled:"ms-AccessRequestsList-CheckBoxDisabled"}}))};n._renderFileType=function(e){if(e){var t=n._getItemIcon(e.itemUrl);return i.createElement(v.e,{iconName:t})}};n._renderRequestComment=function(e){if(e&&e.comment&&e.comment.length)return i.createElement("div",null,i.createElement(w.e,{content:n._renderRequestCommentToolTip(e),calloutProps:{gapSpace:0},styles:{root:{display:"inline-block"}}},i.createElement(u.e,{iconProps:{iconName:"Message"},title:ve.v,ariaLabel:ve.v})))};n._renderRequestCommentToolTip=function(e){var t,r;t=function(){n._selection.setAllSelected(!1);n._approveDeclineAll([e],we.e.Approve)};r=function(){n._selection.setAllSelected(!1);n._approveDeclineAll([e],we.e.Decline)};return i.createElement("div",{className:"ms-AccessRequestsList-CommentToolTip"},i.createElement("div",{className:"ms-AccessRequestsList-Comment"}," ",e.comment," "),e.completed?null:i.createElement(de.e,{horizontal:!0},i.createElement(de.e.Item,{order:1},i.createElement(Oe.e,{iconProps:{iconName:"CheckMark"},allowDisabledFocus:!0,onClick:t},ve.n)),i.createElement(de.e.Item,{order:2},i.createElement(Oe.e,{iconProps:{iconName:"Cancel"},allowDisabledFocus:!0,onClick:r},ve.o))))};n._renderRequestDate=function(e){var t=n.props.pageContext;if(e){if(!0===e.completed)return i.createElement("div",{className:"ms-AccessRequestsList-CompletedStatus"},e.completedStatus);var r=e.requestDate,s=r&&new Date(r).getTime();if("number"==typeof s&&!isNaN(s)){var o=t.currentUICultureName;return i.createElement("div",{className:"ms-AccessRequestsList-RequestDate"},Object(ke.n)(new Date(s),o))}}};n._onRenderOption=function(e){return i.createElement("div",null,e.data&&e.data.icon&&i.createElement(v.e,{style:{marginRight:"8px"},iconName:e.data.icon,"aria-hidden":"true",title:e.data.icon}),i.createElement("span",null,e.text))};n._onRenderPlaceholder=function(e){return i.createElement("div",{className:"dropdownExample-placeholder"},i.createElement(v.e,{style:{marginRight:"8px"},iconName:"Edit","aria-hidden":"true"}),i.createElement("span",null,e.placeholder))};n._onRenderTitle=function(e){var t=e[0];return i.createElement("div",null,t.data&&t.data.icon&&i.createElement(v.e,{style:{marginRight:"8px"},iconName:t.data.icon,"aria-hidden":"true",title:t.data.icon}),i.createElement("span",null,t.text))};n._renderPermissionsDropdown=function(e){var t;e.dropRef=i.createRef();if(e.isWeb){n._associatedGroups&&0!==n._associatedGroups.length||n._fetchAssociatedGroups();(!n._associatedGroups||n._associatedGroups.length<2)&&(e.isWeb=!1)}t=function(){var t=e.dropRef.current.selectedOptions[0].key;return n._onChangePermission(t,e)};var r=e.isWeb?ve.d:ve.f,s=e.isWeb?ve.L:ve.k;return i.createElement(de.e,{tokens:{childrenGap:20},verticalAlign:"end"},i.createElement(Le.e,{componentRef:e.dropRef,disabled:e.completed,placeholder:r,ariaLabel:ve.T,options:[{key:"Edit",text:r,data:{icon:"Edit"}},{key:"View",text:s,data:{icon:"Uneditable2"}}],styles:{dropdown:{width:120}},onRenderOption:n._onRenderOption,onRenderPlaceholder:n._onRenderPlaceholder,onRenderTitle:n._onRenderTitle,onChange:t}))};n._renderNameColumn=function(e){var t=n.state.resolvedPersons;if(t[e.userLogin]){var r=t[e.userLogin],s={personaType:"User",identifier:r.userId,pageContext:n.props.pageContext,lpcHoverTargetProps:{upn:r.email,hostAppPersonaInfo:{PersonaDisplayName:e.requesterDispName}}};return Object(E.t)(s,i.createElement("div",{className:"ms-AccessRequestsList-card"},i.createElement(a.e,{"data-is-focusable":!0,imageUrl:r.image,primaryText:e.requesterDispName,size:f.n.small,hidePersonaDetails:!1,showInitialsUntilImageLoads:!0})))}if(!e.queried){n._queryForPersonaInfo(e.userLogin);e.queried=!0}return i.createElement("div",{className:"ms-AccessRequestsList-name"},i.createElement(w.e,{content:ve.C,calloutProps:{gapSpace:0},styles:{root:{display:"inline-block"}}},e.requesterDispName))};n._renderFilename=function(e){return i.createElement("div",{className:"ms-AccessRequestsList-ColumnText"},i.createElement(M.e,{href:e.itemUrl.toString(),target:"_blank",className:"ms-AccessRequestsList-Link"},e.item))};n._fetchPendingRequests=function(){var e=n.state,t=e.hasMoreRequests,r=e.allRequests,i=e.orderBy,s=e.ascending,o=n.props.pageSize;if(t){var u;u=r?n.state.allRequests:[];n._accessRequestsProvider.getPendingAccessRequests(i,s,o,u.length).then(function(e){if(Array.isArray(e)&&e.length>0){e.forEach(function(e){e.queried=!1;u.push(e)});var t=n._mergeInNewRequests(e),r=e.length===o&&t&&t.length<o;n.setState({allRequests:t,hasMoreRequests:e.length===o});return r}n.setState({hasMoreRequests:!1});return!1}).then(function(e){e&&n._fetchPendingRequests()}).catch(function(e){_.e.logData({name:"AccessRequests.Error"})})}};n._queryForPersonaInfo=function(e){var t=n.state.resolvedPersons,r=n.state.resolvedPersons;t[e]||n._onGetMoreResults(e).then(function(t){r[e]={userId:t.userId,name:t.name,email:t.email,image:t.image,department:t.department,job:t.job,office:t.office,phone:t.phone,isResolved:t.isResolved,isExternal:t.isExternal};n.setState({resolvedPersons:r})});return!0};n._onGetMoreResults=function(e){var t=n.props.pageContext,r={allowEmailAddresses:!1,allowMultipleEntities:null,allUrlZones:null,enabledClaimProviders:null,forceClaims:null,groupID:0,maximumEntitySuggestions:30,principalSource:15,principalType:1,required:null,urlZone:null,urlZoneSpecified:null,filterExternalUsers:!1,blockExternalUsers:!1,useGraph:!t.enforceIBSegmentFilter,useSubstrate:t.IBSegments&&t.IBSegments.length>0,conversationId:K.e.generate(),siteIBSegmentIDs:t.IBSegments};return n._peoplePickerProvider.resolve(e,r)};n._mergeInNewRequests=function(e){var t=n.state.allRequests;if(t&&t.length>0){var i=n._mapRequests(t),s=e.filter(function(e){return!(e.id in i)});return Object(r.__spreadArrays)(t,s)}return e};n._mapRequests=function(e){for(var t={},n=0,r=e;n<r.length;n++){var i=r[n];t[i.id]=i}return t};n._sort=function(e,t,n){var r="RequestedForDisplayName"===t?function(e,t){return e.requesterDispName.toLocaleUpperCase().localeCompare(t.requesterDispName.toLocaleUpperCase())}:"ObjectRequestedTitleDisp"===t?function(e,t){return e.item.toLocaleUpperCase().localeCompare(t.item.toLocaleUpperCase())}:function(e,t){return e.requestDate.valueOf()-t.requestDate.valueOf()};e.sort(r);n&&e.reverse();return e};n._onRenderItem=function(e,t){var r=n.state.allRequests,i=n.props.pageSize;(t===r.length-i||r.length<i&&t===r.length-1)&&n._fetchPendingRequests()};n._getSelectionDetails=function(){return n._selection.getSelectedCount()>0};n._onColumnClick=function(e,t){var i=n.state,s=i.columns,o=i.hasMoreRequests,u=i.allRequests,a=s.map(function(e){var n=e.key===t.key;return Object(r.__assign)(Object(r.__assign)({},e),{isSorted:n,isSortedDescending:n&&!e.isSortedDescending})});o?n.setState({allRequests:[],hasMoreRequests:!0,orderBy:t.fieldName,ascending:!t.isSortedDescending,columns:a},function(){return n._fetchPendingRequests()}):n.setState({allRequests:Object(r.__spreadArrays)(n._sort(u,t.fieldName,!t.isSortedDescending)),orderBy:t.fieldName,ascending:!t.isSortedDescending,columns:a})};n._accessRequestsProvider=t.accessRequestsProvider;n._peoplePickerProvider=new j.e({pageContext:t.pageContext,peoplePickerDataSource:t.peoplePickerDataSource});n._sitePermissionsProvider=new Pe.e(t.pageContext);var s=n._getColumns("RequestDate",!1);n._selection=new be.e({onSelectionChanged:function(){n.setState({isRequestSelected:n._getSelectionDetails()})}});n.state={columns:s,allRequests:[],isRequestSelected:n._getSelectionDetails(),internalRequests:[],externalRequests:[],selectedRequest:void 0,hasMoreRequests:!0,orderBy:"RequestDate",ascending:!0,isCommentTooltipVisible:!1,resolvedPersons:new Map,containsError:!1};Object(Me.e)();return n}t.prototype.render=function(){var e=this.state,t=e.allRequests,n=e.internalRequests,r=e.externalRequests,s=e.hasMoreRequests,o=!(t&&0!==t.length||s),u=n&&!n.length,a=r&&!r.length;return i.createElement("div",{className:"ms-accessRequestsList"},this._renderTopButtons(),i.createElement("div",{className:"ms-accessRequestsList-ErrorMessage"},this.state.containsError&&this._renderContainsError()),i.createElement("div",{className:"ms-accessRequestsList-ScrollablePane"},i.createElement(Se.e,{scrollbarVisibility:xe.t.auto},this._renderList(),"all"===this.props.currentFilter?o&&this._renderNoRequestsMessage():"internal"===this.props.currentFilter?u&&this._renderNoInternalRequestsMessage():"external"===this.props.currentFilter?a&&this._renderNoExternalRequestsMessage():"")))};t.prototype.componentDidMount=function(){this._fetchAssociatedGroups();this._fetchPendingRequests()};t.prototype.componentDidUpdate=function(e){e.accessRequestsEnabled!==this.props.accessRequestsEnabled&&this.setState({columns:this._getColumns(this.state.orderBy,this.state.ascending)})};t.prototype.onRenderDetailsHeader=function(e,t){return i.createElement(Te.e,{stickyClassName:"ms-AccessRequest-AccessRequestListHeader",stickyPosition:Ne.e.Header,isScrollSynced:!0},t(Object(r.__assign)({},e)))};t.prototype._filterForInternal=function(){for(var e=this.state,t=e.allRequests,n=e.internalRequests,r=e.resolvedPersons,i=[],s=!1,o=0,u=t;o<u.length;o++){var a=u[o];if(r[a.userLogin]&&!r[a.userLogin].isExternal){i.push(a);n&&n.length>=i.length&&i[i.length-1]!==n[i.length-1]&&(s=!0)}}n&&n.length!==i.length&&(s=!0);s&&this.setState({internalRequests:i})};t.prototype._filterForExternal=function(){for(var e=this.state,t=e.allRequests,n=e.externalRequests,r=e.resolvedPersons,i=[],s=!1,o=0,u=t;o<u.length;o++){var a=u[o];if(r[a.userLogin]&&r[a.userLogin].isExternal){i.push(a);n&&n.length>=i.length&&i[i.length-1]!==n[i.length-1]&&(s=!0)}}n&&n.length!==i.length&&(s=!0);s&&this.setState({externalRequests:i})};t.prototype._getItemIcon=function(e){if(e){var t=null,n=e.toString().split("/"),r=n[n.length-1];if(!r.includes(".")){return"teams"===n[n.length-2]?"SharepointLogo":Object(_e.n)({type:De.e.folder,size:16}).iconName}t=r.split(".")[1].split("?")[0];return Object(_e.n)({extension:t,size:16}).iconName}};t.prototype._onChangePermission=function(e,t){if("Edit"===e){t.isEditor=!0;t.isWeb&&this._associatedGroups&&this._associatedGroups.length>2&&(t.groupId=this._associatedGroups[1].id)}else{t.isEditor=!1;t.isWeb&&this._associatedGroups&&this._associatedGroups.length>2&&(t.groupId=this._associatedGroups[2].id)}};t.prototype._fetchAssociatedGroups=function(){var e=this;this._sitePermissionsProvider.getAssociatedPermissionGroups().then(function(t){e._associatedGroups=t})};return t})(i.Component),Be=Object(Z.e)(He,function(e){return{root:[],label:{}}}),je=n(4626),Fe=n(4627),Ie=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.handlePivotClick=function(e){"all"===e.props.itemKey?n.setState({currentFilter:"all"}):"internal"===e.props.itemKey?n.setState({currentFilter:"internal"}):"external"===e.props.itemKey&&n.setState({currentFilter:"external"})};n.state={currentFilter:"all"};return n}t.prototype.render=function(){return i.createElement(ie.e,{hidden:!this.props.showAccessRequestDialog,onDismiss:this.props.onDismiss,containerClassName:"ms-dialogMainOverride ms-AccessRequestsDialogContainer",dialogContentProps:{type:se.e.normal,showCloseButton:!0,className:"ms-AccessRequestsDialogContent",styles:{header:{className:"ms-AccessRequestsDialogHeader"},inner:{className:"ms-AccessRequestsDialog-inner"},content:{className:"ms-AccessRequestsDialog-content"}}},modalProps:{isBlocking:!0,isDarkOverlay:!1}},i.createElement(de.e,{horizontal:!0,disableShrink:!0},i.createElement(de.e.Item,{order:1},i.createElement("div",{className:"ms-AccessRequestsDialogHeader"},i.createElement("div",{className:"ms-AccessRequestsDialogTitle"},ve.e))),i.createElement(de.e.Item,{order:2},this.renderPivot())),i.createElement("div",{className:"ms-AccessRequestsDialogListContainer"},i.createElement(Be,{pageSize:10,accessRequestsEnabled:!0,accessRequestsProvider:new je.e({dataSource:new Fe.e({pageContext:this.props.pageContext})}),peoplePickerDataSource:this.props.peoplePickerDataSource,pageContext:this.props.pageContext,currentFilter:this.state.currentFilter})),i.createElement("div",{className:"ms-AccessRequestsDialog-Footer"},this.renderClassicLink()))};t.prototype.renderClassicLink=function(){var e=this.props.pageContext.webAbsoluteUrl+"/Access%20Requests/pendingreq.aspx?mbypass=1";return i.createElement(M.e,{href:e,className:"ms-AccessRequestsDialog-ClassicExperience-link","data-automationid":"SitePermissionsPanelAccessRequestsDialogClassicLink",target:"_blank"},ve.s)};t.prototype.renderPivot=function(){return i.createElement("div",null,i.createElement(he.e,{"aria-label":"Filtering between all, internal, and external only users",onLinkClick:this.handlePivotClick,headersOnly:!0},i.createElement(pe.e,{headerText:ve.t,itemKey:"all"}),i.createElement(pe.e,{headerText:ve.h,itemKey:"internal"}),i.createElement(pe.e,{headerText:ve.c,itemKey:"external"})))};return t})(i.Component),qe=n(245),Re=n(2376),Ue={ODB:1559},ze={ODB:1479},We=(function(e){Object(r.__extends)(t,e);function t(t){var n,s=e.call(this,t)||this;s._onGetErrorMessage=function(e){var t="";Object(r.__spreadArrays)(e).length>500&&(t=Q.L);return t};s._onChangeSendEmail=function(e){s.setState({shouldSendEmail:!s.state.shouldSendEmail})};s._removePermControl=function(e){s.setState({shouldHidePermControl:!0})};s._onChangeEnableHubPermissionSync=function(e,t){s.props.onSaveHubPermissionSync&&s.props.onSaveHubPermissionSync(t)};s._closePanel=function(){if(!s._isLPCOpen){s.setState({showPanel:!1,showUserExpirationPanel:!1});s.props.onDismiss&&s.props.onDismiss()}};s._onClick=function(){if(S.t.isActivated("142ea5f8-b804-4a08-a473-a0c8c822575d","09/21/2021","Use context menu functionality from Fluent button")){s.setState({isInvitePeopleContextualMenuVisible:!s.state.isInvitePeopleContextualMenuVisible});_.e.logData({name:"SitePermissionsPanel.InvitePeople.Click"})}else _.e.logData({name:"SitePermissionsPanel.InvitePeople.Click"})};s._onDismiss=function(e){s.setState({isInvitePeopleContextualMenuVisible:!1});e.stopPropagation();e.preventDefault()};s._onSaveClick=function(e){s.setState({showSavingSpinner:!0,saveButtonDisabled:!0});var t=s._peoplePicker.selectedPeople;t&&t.length&&s.props.onSave&&s.props.onSave(t,s.state.shouldSendEmail,s._mailMessage).done(function(e){s.setState({showSavingSpinner:!1,saveButtonDisabled:!1,showPanel:s._showPanel()});s._resetSharePanel()});_.e.logData({name:"SitePermissionsPanel.Save.Click"})};s._showPanel=function(){return!!s.props.shareSiteErrorMsg||!s.props.shouldLoadSharePanelOnly&&s.state.showPanel};s._onCancelClick=function(e){if(s.props.onCancel){s._resetSharePanel();s.props.onCancel()}_.e.logData({name:"SitePermissionsPanel.Cancel.Click"})};s._onAccessRequestsClick=function(){s.setState({showAccessRequestDialog:!0})};s._onDismissAccessRequestsDialog=function(){s.setState({showAccessRequestDialog:!1})};s._onSuggestionSelected=function(e){var t=s.props.pickerSettings,n={principalSource:t.PrincipalSource,principalType:t.PrincipalAccountType,allowEmailAddresses:t.AllowEmailAddresses,filterExternalUsers:!1,maximumEntitySuggestions:30,forceResolve:!0};if(!1===e.isExternal||e.isExternal&&e.providerName)return e;if(e.principalType===z.e.distributionList){n.isGraphDistributionList=!0;n.useGraph=!0;n.useSubstrate=!0}return s._peoplePickerProvider.resolve(e.userId,n).then(function(e){!e.email&&e.rawData.EntityData&&(e.email=e.rawData.EntityData.OtherMails);!e.name&&e.rawData.EntityData&&(e.name=e.rawData.EntityData.OtherMails);return e})};s._onSelectHubPersona=function(e){var t=e&&e[0];s.props.onAddHubUserCallback&&s.props.onAddHubUserCallback(t)};s._onSelectedPeopleChange=function(e){var t,n,r=[],o=W({selectedItems:e}),u=(function(e){var t=e.filter(function(e){return 1===e.entityType}),n=t.length,r=t.map(function(e){return e.name});if(2===n){var i=(o=r.join(", ")).lastIndexOf(","),s=o.substring(0,i)+" "+U.n+" "+o.substring(i+1);return R.format(U.l,s)}if(n>2){var o;i=(o=r.join(", ")).lastIndexOf(","),s=o.substring(0,i+1)+" "+U.n+" "+o.substring(i+1);return R.format(U.l,s)}return 1===n?R.format(U.c,r[0]):""})(e),a=(function(e,t){var n=e.filter(function(e){return 2===e.entityType}).length,r="";1===n?r=U.f:n>1&&(r=R.format(U.u,n));t>=1e3?r+=" "+U.i:t>=25&&(r+=" "+R.format(U.r,t));return r})(e);o&&(t=i.createElement(F.e,{className:"ms-SitePermPanel-PeoplePicker-error",messageBarType:I.e.error},o));u&&r.push(i.createElement(F.e,{className:"ms-SitePermPanel-PeoplePicker-warning",messageBarType:I.e.warning},u));a&&r.push(i.createElement(F.e,{className:"ms-SitePermPanel-PeoplePicker-warning",messageBarType:I.e.warning},a));r.length>0&&(n=i.createElement("div",{className:"ms-SitePermPanel-PeoplePicker-warnings"},r));s.setState({isPersonaSelected:s._peoplePicker.selectedPeople.length>0&&!t,peoplePickerError:t,peoplePickerWarnings:n})};s._siteSharingSettingsOnClick=function(){s.setState({showSiteSharingSettingsPanel:!0});_.e.logData({name:"SitePermissionsPanel.SiteSharingSettings.Click"})};s._onDismissSiteSharingSettingsPanel=function(){s.setState({showSiteSharingSettingsPanel:!1});_.e.logData({name:"SitePermissionsPanel.DismissSiteSharingSettings.Click"})};s._onUserExpirationClick=function(){s.setState({showUserExpirationPanel:!0});_.e.logData({name:"SitePermissionsPanel.UserExpirationPanel.Click"})};s._onDismissUserExpirationPanel=function(){s.setState({showUserExpirationPanel:!1});_.e.logData({name:"SitePermissionsPanel.DismissUserExpirationPanel.Click"})};s._isLPCOpenHandler=function(e){s._isLPCOpen=e};s._isUserExpirationPanelEnabled=t.pageContext.isSiteAdmin&&G.e.isFeatureEnabled(Ue);s._isAccessRequestDialogEnabled=!1;s._isGroup=Object(B.s)(t.pageContext);s._resolveMenu=function(e){return s._menu=e};s._mailMessage="";s._isLPCOpen=!1;s.state={showPanel:!0,showShareSiteOnly:t.showShareSiteOnly,shouldSendEmail:!0,showSiteSharingSettingsPanel:!1,showUserExpirationPanel:!1,showAccessRequestDialog:!1,showMsgBarForChannelSite:null===(n=s.props.pageContext)||void 0===n?void 0:n.isTeamsChannelSite};s._peoplePickerProvider=new j.e({pageContext:t.pageContext,peoplePickerDataSource:t.peoplePickerDataSource});if(s._isUserExpirationPanelEnabled){s._userExpirationProvider=new fe.UserExpirationProvider({dataSource:new le.UserExpirationDataSource({pageContext:t.pageContext})});s._userExpirationProvider.getExternalUserExpirationPolicy().then(function(e){return s.setState({userExpirationPolicyDays:e})})}if(G.e.isFeatureEnabled(ze)){s._accessRequestsProvider=new je.e({dataSource:new Fe.e({pageContext:t.pageContext})});s._accessRequestsProvider.hasAccessRequests().then(function(e){s._isAccessRequestDialogEnabled=e&&(t.pageContext.isSiteAdmin||t.pageContext.isSiteOwner)})}_.e.logData({name:"SitePermissionsPanel.Opened.Click"});return s}t.prototype.render=function(){var e=this,t=this.props,n=t.showShareSiteOnly,r=t.shouldDismissPanel,a=t.pickerSettings,f=t.showHubPivot,l=t.shouldLoadSharePanelOnly,c=l?t.shareSiteTitle||Q.z:null;return i.createElement(s.e,{className:"ms-SitePermPanel",isOpen:this.state.showPanel&&!r,type:o.e.smallFixedFar,onDismiss:this._closePanel,isLightDismiss:!0,headerText:n?c:t.title||Q.ee,forceFocusInsideTrap:!1,closeButtonAriaLabel:Q.c,onRenderFooterContent:function(t,r){return n&&a?i.createElement("div",{className:"ms-SitePermPanelButton"},i.createElement("span",{className:"ms-SitePermPanelButton-container"},i.createElement(N.e,{className:"ms-SitePermPanel-saveButton",disabled:!e.state.isPersonaSelected,onClick:e._onSaveClick,"data-automationid":"SitePermissionsPanelSaveButton"},e.props.saveButton)),i.createElement("span",{className:"ms-SitePermPanelButton-container"},i.createElement(C.e,{className:"ms-SitePermPanel-cancelButton",onClick:e._onCancelClick,"data-automationid":"SitePermissionsPanelCancelButton"},Q.l))):null},onRenderNavigationContent:function(t,r){return n&&!l?i.createElement("div",{className:"ms-SitePermPanel-NavigationContent"},i.createElement(u.e,{iconProps:{iconName:"Back"},className:"ms-SitePermPanel-BackIcon",onClick:e._onCancelClick,ariaLabel:Q.f}),i.createElement("p",{className:"ms-SitePermPanel-Title"},e.props.shareSiteTitle||Q.z),r(t)):i.createElement("div",{className:"ms-SitePermPanel-NavigationContentDismiss"}," ",r(t)," ")}},n&&a&&this._renderShareSiteOnly(),!n&&f&&i.createElement(he.e,{className:"ms-SitePermPanel-Pivot"},i.createElement(pe.e,{headerText:Q.P},this._renderPermissions()),i.createElement(pe.e,{headerText:Q.D},this._renderHubPermissions())),!n&&!f&&this._renderPermissions())};t.prototype._renderAdvancedPermSettings=function(){var e,t=this.props,n=t.advancedPermSettingsUrl,r=t.hasCustomizedGroups,s=t.pageContext,o=t.permissionLevelOfCurrentUser,u=t.isDefaultPermissionsChanged,a=t.showShareSiteOnly;if(n&&(o===L.e.FullControl||q.e.hasPermission(s.webPermMasks,q.e.managePermissions))){var f=i.createElement(M.e,{href:n,target:"_blank",className:"ms-MessageBar-link","data-automationid":"SitePermissionsPanelAdvancedPermLink"},Q.u),l=void 0;u?l=a?Q.I:Q.re:r&&(l=Q.o);if(l){-1===l.indexOf("{0}")&&(l+=" {0}.");f=i.createElement("span",null,R.formatToArray(l,f))}e=i.createElement("div",{className:"ms-SitePermPanel-AdvancedPerm"},f)}return e};t.prototype._renderSiteSharingSetting=function(){var e,t=this.props,n=t.pageContext,r=t.permissionLevelOfCurrentUser,s=this.state.showSiteSharingSettingsPanel;if(r===L.e.FullControl||q.e.hasPermission(n.webPermMasks,q.e.managePermissions)){var o=i.createElement(M.e,{className:"ms-MessageBar-link","data-automationid":"SitePermissionsPanelSiteSharingSettingsLink",onClick:this._siteSharingSettingsOnClick},Q.K);e=i.createElement("div",{className:"ms-SitePermPanel-SharingSettings"},i.createElement("div",{className:"ms-SitePermPanel-sectionTitle"}," ",Q.Q),o,s&&i.createElement(ae,{isOpen:s,onDismiss:this._onDismissSiteSharingSettingsPanel,pageContext:n,peoplePickerProvider:this._peoplePickerProvider,sharingSiteProvider:new Y.e({pageContext:n})}))}return e};t.prototype._renderUserExpiration=function(){var e=this.props.pageContext,t=this.state,n=t.showUserExpirationPanel,r=t.userExpirationPolicyDays,s=i.createElement(M.e,{className:"ms-MessageBar-link","data-automationid":"SitePermissionsPanelUserExpirationLink",onClick:this._onUserExpirationClick},Q.oe);return null!=r&&i.createElement("div",{className:"ms-SitePermPanel-UserExpiration"},i.createElement("div",{className:"ms-SitePermPanel-sectionTitle"},Q.ie),i.createElement("div",{className:"ms-SitePermPanel-UserExpiration-text"},R.formatWithLocalizedCountValue(Q.ue,Q.se,r)),s,n&&i.createElement(ce.e,{isOpen:n,onBackButton:this._onDismissUserExpirationPanel,onDismiss:this._closePanel,pageContext:e,userExpirationProvider:this._userExpirationProvider,userExpirationPolicyDays:r,userExpirationPolicyEnabled:r>0}))};t.prototype._renderAccessRequestsDialog=function(){var e=this.state.showAccessRequestDialog,t=this.props.pageContext,n=i.createElement(M.e,{className:"ms-AccessRequests-link","data-automationid":"SitePermissionsPanelAccessRequestsDialogLink",onClick:this._onAccessRequestsClick},Q.t);return i.createElement("div",{className:"ms-SitePermPanel-AcessRequests"},n,e&&i.createElement(Ie,{showAccessRequestDialog:e,onDismiss:this._onDismissAccessRequestsDialog,pageContext:t,peoplePickerDataSource:this.props.peoplePickerDataSource}))};t.prototype._renderPermissions=function(){var e=this,t=this.props.sitePermissions;return i.createElement("div",null,this.state.showMsgBarForChannelSite&&this._renderMessageBarForChannelSite(),this._renderInviteContextMenu(),t&&i.createElement("div",{style:{marginTop:!S.t.isActivated("53558946-f5c9-4d9e-a69e-d53a11db1ac8","06/24/2021","Disable site perm menu for channel site")&&this.props.pageContext.isTeamsChannelSite?20:0}},t.map(function(t){return e._getSitePermissions(t)})),this._renderSiteSharingSetting(),this._isAccessRequestDialogEnabled&&this._renderAccessRequestsDialog(),this._isUserExpirationPanelEnabled&&this._renderUserExpiration(),this._renderAdvancedPermSettings())};t.prototype._renderMessageBarForChannelSite=function(){var e=this;return qe.n.isFeatureEnabled({ODB:60350})?i.createElement(F.e,{messageBarType:I.e.blocked,onDismiss:function(){return e.setState({showMsgBarForChannelSite:!1})},dismissButtonAriaLabel:"Close",styles:{root:{marginTop:20}}},Q.O,i.createElement(M.e,{href:Re.t.getHelpLink(Re.e.TEMAS_CONNECTED_SITE_HELP_LINK,this.props.pageContext.currentUICultureName),target:"_blank"},Q.e)):null};t.prototype._renderInviteContextMenu=function(){if(qe.n.isFeatureEnabled({ODB:60350})&&this.props.pageContext.isTeamsChannelSite)return null;var e=this.props,t=e.menuItems,n=e.onShareSiteCallback,r=e.sitePermissions,s=e.permissionLevelOfCurrentUser,o=e.pickerSettings,u=e.shouldShowInviteButton,a={items:t,className:"ms-sitePermPanel-invitePeopleContextualMenu"};return i.createElement("div",null,i.createElement("p",{className:"ms-sitePermPanel-TextArea","data-automationid":"SitePermissionsPanelDescription"},Q._),i.createElement("div",{className:"ms-sitePerm-ContextMenu"},o&&r&&(s===L.e.FullControl||s===L.e.Edit)&&u&&i.createElement("div",{className:"ms-sitePermPanel-buttonArea",ref:this._resolveMenu},S.t.isActivated("142ea5f8-b804-4a08-a473-a0c8c822575d","09/21/2021","Use context menu functionality from Fluent button")?i.createElement(N.e,{className:Object(h.e)("ms-sitePermPanel-itemBtn",this._isGroup?"ms-sitePermPanel-invitePeopleButton":"ms-sitePermPanel-shareSiteButton"),onClick:this._isGroup?this._onClick:n,"data-automationid":"SitePermissionsPanelInviteButton","aria-haspopup":this._isGroup?"menu":void 0,"aria-expanded":this._isGroup?this.state.isInvitePeopleContextualMenuVisible:void 0,"aria-owns":this.state.isInvitePeopleContextualMenuVisible?"sitePerm-contextMenu":void 0},this._isGroup?Q.k:Q.z):i.createElement(N.e,{menuProps:this._isGroup?a:void 0,className:Object(h.e)("ms-sitePermPanel-itemBtn",this._isGroup?"ms-sitePermPanel-invitePeopleButton":"ms-sitePermPanel-shareSiteButton"),onClick:this._isGroup?this._onClick:n,"data-automationid":"SitePermissionsPanelInviteButton"},this._isGroup?Q.k:Q.z)),this.state.isInvitePeopleContextualMenuVisible&&i.createElement(l.e,{className:"ms-sitePermPanel-invitePeopleContextualMenu",id:"sitePerm-contextMenu",items:t,isBeakVisible:!1,target:this._menu,directionalHint:c.e.bottomLeftEdge,onDismiss:this._onDismiss,gapSpace:0})))};t.prototype._renderHubPermissions=function(){var e,t=this,n=this.props,s=n.isHubSite,o=n.hubSiteTitle,u=n.enableHubPermissionsSync,a=n.showHubSyncToggleSpinner,f=n.hubSyncControlsAreDisabled,l=n.hubPivotErrorString,c=n.isOverHubPermSyncLimit,h=n.hubVisitorsCount,p=s?Q.d:Q.p,d=void 0;s?d=u?Q.S:Q.E:o&&(d=u?R.format(Q.a,null===(e=this.props.pageContext)||void 0===e?void 0:e.webTitle,o):R.format(Q.x,o));var v=u&&!a,m=v&&s,g=this._getPeoplePickerProps(),y=Object(r.__assign)(Object(r.__assign)({},g),{itemLimit:1,peoplePickerType:A.e.normal,onSelectedPersonasChange:this._onSelectHubPersona,peoplePickerQueryParams:Object(r.__assign)(Object(r.__assign)({},g.peoplePickerQueryParams),{allowEmailAddresses:!1}),inputProps:{"aria-label":Q.N,placeholder:Q.w}}),b=10-h;b<0&&(b=0);return i.createElement("div",{className:"ms-SitePermPanel-HubPivotDiv"},i.createElement(te.e,{checked:u,disabled:a||f,label:p,onText:Q.ne,offText:Q.te,onChange:this._onChangeEnableHubPermissionSync}),a?i.createElement(O.e,null):null,d&&i.createElement(re.e,{className:"ms-SitePermPanel-HubPivot-helperText"},d+" ",i.createElement(M.e,{href:"https://go.microsoft.com/fwlink/?linkid=2133626"},Q.e)),v&&i.createElement(re.e,null,Q.T),m?i.createElement("div",{className:"ms-SitePermPanel-PeoplePicker","data-automationid":"SitePermissionsPanelHubPeoplePicker"},c&&i.createElement(F.e,{messageBarType:I.e.warning},Q.M),i.createElement(k.e,Object(r.__assign)({},y)),i.createElement(re.e,{className:"ms-SitePermPanel-HubVisitorPickerHint"},R.format(Q.C,b))):null,l&&i.createElement(F.e,{className:"ms-SitePermPanel-HubPivot-error",messageBarType:I.e.error},l),!a&&u&&this.props.hubSitePermissions&&i.createElement("div",{className:"ms-SitePermPanel-HubPivot-permissions"},this.props.hubSitePermissions.map(function(e){return t._getSitePermissions(e)})))};t.prototype._renderShareSiteOnly=function(){var e=this,t=this.props,n=t.goToOutlookOnClick,s=t.isEmailSharingEnabled,o=t.pageContext,u=t.shouldLoadSharePanelOnly,a=t.sitePermissions,f=t.sitePreviewLoader,l=t.isDefaultPermissionsChanged,c=t.shareSiteErrorMsg,h=this.state,p=h.isPersonaSelected,d=h.peoplePickerError,v=h.peoplePickerWarnings,m=h.shouldHidePermControl,g=h.shouldSendEmail,y=h.showSavingSpinner,b=null;this._isGroup&&n&&(b=i.createElement("div",{className:"ms-SitePermPanel-PeoplePicker","data-automationid":"SitePermissionsPanelPeoplePicker"},Object(J.e)(Q.U,Q.R,M.e,{className:"ms-SitePermPanel-Link",onClick:n,"data-automationid":"SitePermissionsPanelAddMemberLink"})));return l?this._renderAdvancedPermSettings():i.createElement("div",{className:"ms-SitePermPanel-SharePanel"},i.createElement("div",{onClick:this._removePermControl,className:"ms-SitePermPanel-PeoplePicker","data-automationid":"SitePermissionsPanelPeoplePicker"},i.createElement("div",{className:"ms-SitePermPanel-PeoplePicker",id:"sitePerm-peoplePickerLabel"},o.isSPO?Q.i:Q.s),b,i.createElement(k.e,Object(r.__assign)({},this._getPeoplePickerProps(),{componentRef:function(t){t&&(e._peoplePicker=t)}})),d||v),i.createElement("div",null,u&&!m&&i.createElement("div",null,a&&a.map(function(t){return e._getSitePermissions(t)})),s&&p&&i.createElement("div",{className:"ms-SitePermPanel-ShareSiteEmail"},i.createElement(H.e,{className:"ms-SitePermPanel-ShareSiteEmail-checkbox",defaultChecked:g,label:Q.j,onChange:this._onChangeSendEmail}),g&&i.createElement("div",{className:"ms-SitePermPanel-ShareSiteEmail-message-div"},i.createElement(P.e,{className:"ms-SitePermPanel-ShareSiteEmail-message",multiline:!0,resizable:!1,placeholder:Q.A,onChange:function(t,n){return e._mailMessage=n},onGetErrorMessage:this._onGetErrorMessage}),f))),y&&i.createElement(O.e,null),!S.t.isActivated("5a013444-053c-4234-8a89-3443d47a5952","02/04/2021","Improve share site error handling")&&c&&i.createElement(F.e,{"aria-label":Q.W,messageBarType:I.e.error,isMultiline:!0,dismissButtonAriaLabel:Q.c},Q.W))};t.prototype.renderPeoplePickerItemWithMenu=function(e){var t,n=this.props.sitePermissionsContextualMenuItems.map(function(e){return e.permissionLevel});t=e.item.permissionLevel?e.item.permissionLevel:n.indexOf(this.props.addMemberDefaultPermissionLevel)>-1?this.props.addMemberDefaultPermissionLevel:n.indexOf(L.e.Edit)>-1?L.e.Edit:n.indexOf(L.e.Read)>-1?L.e.Read:L.e.FullControl;var s=this.props.permissionLevelOfCurrentUser===L.e.FullControl?this.props.sitePermissionsContextualMenuItems.filter(function(e){return e.permissionLevel!==t}).map(function(t){return Object(r.__assign)(Object(r.__assign)({},t),{onClick:function(t,n){var r=e.item;r.permissionLevel=n.permissionLevel;e.onItemChange(r,e.index)}})}):void 0;return i.createElement(D.e,Object(r.__assign)(Object(r.__assign)({},e),{menuTitle:this.props.permissionLevelOfCurrentUser!==L.e.FullControl?"":this.props.permissionStrings[t],menuItems:s}))};t.prototype._getSitePermissions=function(e){return i.createElement(T,Object(r.__assign)({},e,{key:e.permLevel,pageContext:this.props.pageContext,lpcModuleLoader:this.props.lpcModuleLoader,lpcModuleCustomWaiter:this.props.lpcModuleCustomWaiter,isLPCOpenHandler:this._isLPCOpenHandler}))};t.prototype._resetSharePanel=function(){this.setState({shouldSendEmail:!0,isPersonaSelected:!1,peoplePickerWarnings:void 0,peoplePickerError:void 0})};t.prototype._getPeoplePickerProps=function(){var e=this,t=this.props,n=t.pageContext,r=t.pickerSettings;return{noResultsFoundText:" ",context:n,peoplePickerType:A.e.listBelow,onSelectedPersonasChange:this._onSelectedPeopleChange,onRenderItem:function(t){return e.renderPeoplePickerItemWithMenu(t)},onSuggestionSelected:this._onSuggestionSelected,dataProvider:this._peoplePickerProvider,peoplePickerQueryParams:{allowEmailAddresses:!0,allowMultipleEntities:null,allUrlZones:null,enabledClaimProviders:null,forceClaims:null,groupID:0,maximumEntitySuggestions:30,principalSource:r&&r.PrincipalSource,blockExternalUsers:!0,principalType:r&&r.PrincipalAccountType,required:null,urlZone:null,urlZoneSpecified:null,useGraph:!n.enforceIBSegmentFilter,useSubstrate:n.IBSegments&&n.IBSegments.length>0,conversationId:K.e.generate(),siteIBSegmentIDs:n.IBSegments},suggestionsAvailableAlertText:Q.Z,enableSelectedSuggestionAlert:!0,inputProps:{"aria-labelledby":"sitePerm-peoplePickerLabel",autoFocus:!0}}};return t})(i.Component)},2576:function(e,t,n){"use strict";n.d(t,"n",function(){return re});n.d(t,"e",function(){return ie});n.d(t,"t",function(){return oe});var r=n(0),i=n("react-lib"),s=n(2421),o=n(1616),u=n(1115),a=n(537),f=n(1608),l=n(2457),c=n(4968),h=n(3771),p=n(2473),d=n(2849),v=n(4548),m=n(5041),g=n(2314),y=n(1780),b=n(4148),w=n(2686),E=n(3803),S=n(24);var x=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._initialThemeColor=r._getCurrentSiteLogoColor();return r}t.prototype.render=function(){return i.createElement("div",null,this.renderGroupSiteLogo())};t.prototype.renderGroupSiteLogo=function(){var e,t,n,r=null;if(this.props){if(!!(r=this.props.siteLogoUrl)&&/(?=_api\/groupservice\/getgroupimage)(?!color)/.test(r.toLowerCase())){var i=this._getCurrentSiteLogoColor();i!==this._initialThemeColor&&(r=(t=i,n=-1!==(e=r).indexOf("?")?"&":"?",""+e+n+"color='"+encodeURIComponent(t)+"'"))}}return this.renderSiteLogo(r)};t.prototype._getCurrentSiteLogoColor=function(){var e=Object(S._)();return this.props.siteLogoBgColor?this.props.siteLogoBgColor:e&&e.palette.themePrimary};return t})(E.e),T=n(1617),N=n(2679),C=n(40),k=n(163),L=n(18),A=n(178),O=n(67),M=n(2401),_=n(965),D=n(3497),P=n(1627),H=n(2871),B=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._renderInfoTip=function(){var e=i.createElement("a",{href:"https://aka.ms/SPOIBUser",target:"_blank"},H.f),t=L.formatToArray(H.a,e),n=L.format(H.a,"");return i.createElement(P.e,{content:t,id:"IBSegment-info",calloutProps:{gapSpace:0},styles:{root:{display:"inline-block",position:"relative",top:4}}},i.createElement(f.e,{iconProps:{iconName:"Info"},ariaLabel:n,disabled:!1,checked:!1,styles:{rootHovered:{backgroundColor:"inherit"},rootPressed:{backgroundColor:"inherit"}}}))};return n}t.prototype.render=function(){var e=this.props,t=e.ibDisplayLabels,n=e.errorString,r=t.map(function(e,t){return i.createElement(i.Fragment,{key:e.objectId},i.createElement("span",{key:e.objectId},(t?", ":"")+e.displayName))});return this.props.isLoading?i.createElement(T.e,null):i.createElement(i.Fragment,null,i.createElement("div",{className:"ms-CurrentIBSegmentDisplayView-sectionTitle"},H.r,this._renderInfoTip()),r,n?i.createElement("div",{className:"ms-CurrentIBSegmentDisplayView-ErrorMessage","data-automationid":"CurrentIBSegmentDisplayView-ErrorMessage"},n):null)};return t})(_.e),j=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._setIBSegmentLabelsFromPromise=function(e){e.then(function(e){e.length>0?n.setState({ibDisplayLabels:e,isLoading:!1}):n.setState({errorString:H.u,isLoading:!1})}).catch(function(){n.setState({errorString:H.o,isLoading:!1})})};n.state={errorString:"",ibDisplayLabels:[],isLoading:!0};return n}t.prototype.componentDidMount=function(){if(this.props.pageContext.IBSegments&&this.props.pageContext.IBSegments.length>0){this._isIBSite=!0;this._ibSegmentDatasource=new D.e(this.props.pageContext);var e=this._ibSegmentDatasource.getIBSegmentLabels();this._setIBSegmentLabelsFromPromise(e)}};t.prototype.render=function(){return this._isIBSite?i.createElement(B,Object(r.__assign)({},this.state)):null};return t})(_.e),F=n(245),I=n(58),q=n(1122),R=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._onRemoveDropdownElement=function(e){n.props.onRemoveDropdown&&n.props.onRemoveDropdown(e.currentTarget.id)};n._onDropdownChange=function(e,t){n.props.onDropdownChange&&n.props.onDropdownChange(t.key.toString(),e.target.id)};n._onAddAdditionalDropdown=function(e){n.props.additionalIBSegmentDropdownPairs.forEach(function(e){e.isIBSegmentDropdownPairDisabled=!0});n.setState({isAddingSegment:!0});n.props.onAddAdditionalDropdown&&n.props.onAddAdditionalDropdown()};n._getAdditionalTitleString=function(){return n._isShowEditPanelInfoBarrierFlightEnabled&&n.props.isHostSiteAdmin?H.s:H.i};n._getAriaDescriptionForRemoveButton=function(e,t){if(n._isShowEditPanelInfoBarrierFlightEnabled){var r=H.c;e.map(function(e){e.key===t&&(r=r+" "+e.text)});return r}};n.state={isAddingSegment:!1};n._isShowEditPanelInfoBarrierFlightEnabled=F.n.isFeatureEnabled({ODB:1975});return n}t.prototype.componentDidUpdate=function(e){this.props.additionalIBSegmentDropdownPairs.length!==e.additionalIBSegmentDropdownPairs.length&&this.setState({isAddingSegment:!1})};t.prototype.render=function(){var e=this,t=this.props,n=t.additionalIBSegmentDropdownPairs,r=t.errorString,s=t.areAllSelected,o=t.noAdditionalSegmentsString,u=n.map(function(t,r){return i.createElement("div",{key:t.key,id:t.key+"-parent",className:"ms-CompatibleIBSegmentElement-DropdownContainer",tabIndex:-1},i.createElement(v.e,{"aria-label":H.n,options:t.options,selectedKey:t.selectedKey,placeHolder:H.n,id:t.key,className:"ms-CompatibleIBSegmentElement-Dropdown",onChange:e._onDropdownChange,disabled:r<n.length-1||t.isIBSegmentDropdownPairDisabled}),i.createElement(f.e,{allowDisabledFocus:!0,key:t.key,iconProps:{iconName:"Cancel"},title:"Remove",ariaLabel:H.h,ariaDescription:e._getAriaDescriptionForRemoveButton(t.options,t.selectedKey),id:t.key,className:"ms-CompatibleIBSegmentElement-DropdownRemove",onClick:e._onRemoveDropdownElement,disabled:!t.selectedKey}))});return this.props.isLoading?i.createElement(T.e,null):i.createElement(i.Fragment,null,i.createElement("div",{"aria-label":this._getAdditionalTitleString(),role:"group",className:"ms-CurrentIBSegmentDisplayView-additionalSectionTitle"},this._getAdditionalTitleString()),u,o?null:this.state.isAddingSegment?i.createElement(T.e,null):i.createElement("div",null,i.createElement(q.e,{allowDisabledFocus:!0,iconProps:{iconName:"Add"},onClick:this._onAddAdditionalDropdown,disabled:!s},H.e)),r?i.createElement("div",{className:"ms-CurrentIBSegmentDisplayView-ErrorMessage","data-automationid":"CurrentIBSegmentDisplayView-ErrorMessage"},r):null,o?i.createElement("div",{className:"ms-CurrentIBSegmentDisplayView-NoAdditionalSegments","data-automationid":"CurrentIBSegmentDisplayView-NoAdditionalSegments"},o):null,this.props.isSaving?i.createElement(T.e,null):null)};return t})(_.e),U=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._createDropdownOptions=function(e){return e.map(function(e){return{key:e.objectId,text:e.displayName}})};n._removeDropdownOption=function(e){var t,r,i=n.state.additionalIBSegmentDropdownPairs,s=!0;i=i.filter(function(n){n.isIBSegmentDropdownPairDisabled||(r=n);if(n.key!==e){n.selectedKey&&n.selectedKey.length>0||(s=!1);return!0}n.selectedKey&&n.selectedKey.length>0&&n.options.some(function(e){if(e.key===n.selectedKey){t=e;return!0}return!1});return!1});if(r&&t){var o=n._getCurrentIBSegments().filter(function(e){return e!==t.key&&e!==r.selectedKey});(n.props.isHostSiteAdmin?n._ibSegmentDatasource.getTenantAllOrCompatibleIBSegments(o):n._ibSegmentDatasource.getCompatibleSegments(o)).then(function(e){r.options=n._createDropdownOptions(e);n.setState({additionalIBSegmentDropdownPairs:i})})}n.setState({additionalIBSegmentDropdownPairs:i,areAllSelected:s,noAdditionalSegmentsString:""},function(){n._validateAndEnableDisableSaveButtonForSPAC();if(!O.t.isActivated("AA3645AE-B971-446B-93FD-BCD469EACC2A","01/28/2021","focus the active dropdown")&&r){var e=document.getElementById(r.key+"-parent");e&&e.focus()}})};n._dropdownChange=function(e,t){var i=n.state.additionalIBSegmentDropdownPairs,s=!0;i=i.map(function(n){if(n.key===t)return Object(r.__assign)(Object(r.__assign)({},n),{selectedKey:e});n.selectedKey&&n.selectedKey.length>0||(s=!1);return n});n.setState({additionalIBSegmentDropdownPairs:i,areAllSelected:s},function(){n._validateAndEnableDisableSaveButtonForSPAC()})};n._addAdditionalDropdown=function(){if(n.state.areAllSelected){var e=n._getCurrentIBSegments();if(n.props.isHostSiteAdmin){var t=n._ibSegmentDatasource.getTenantAllOrCompatibleIBSegments(e);n._setAdditionalIBSegmentDropdownPairsFromPromise(t,!0)}else{t=n._ibSegmentDatasource.getCompatibleSegments(e);n._setAdditionalIBSegmentDropdownPairsFromPromise(t,!0)}}else n.setState({errorString:H.t})};n._setAdditionalIBSegmentDropdownPairsFromPromise=function(e,t){e.then(function(e){if(e&&e.length>0){var i={options:n._createDropdownOptions(e),key:I.e.generate()};n.setState({additionalIBSegmentDropdownPairs:Object(r.__spreadArrays)(n.state.additionalIBSegmentDropdownPairs,[i]),isLoading:!1,areAllSelected:!1,noAdditionalSegmentsString:""},function(){if(!O.t.isActivated("AA3645AE-B971-446B-93FD-BCD469EACC2A","01/28/2021","focus the active dropdown")&&t){var e=document.getElementById(i.key+"-parent");e&&e.focus()}})}else n.setState({noAdditionalSegmentsString:H.l,areAllSelected:!1,isLoading:!1},function(){if(!O.t.isActivated("AA3645AE-B971-446B-93FD-BCD469EACC2A","01/28/2021","focus the active dropdown")&&t){var e=document.querySelector(".ms-CurrentIBSegmentDisplayView-NoAdditionalSegments");e&&e.focus()}})}).catch(function(e){n.setState({errorString:n._getErrorString(e),isLoading:!1})})};n._saveIBSegments=function(){var e=n._getCurrentIBSegments();n.setState({additionalIBSegmentDropdownPairs:n.state.additionalIBSegmentDropdownPairs.map(function(e){e.isIBSegmentDropdownPairDisabled=!0;return e})});n.props.isHostSiteAdmin&&n.props.onIBSegmentsSaved?n.props.onIBSegmentsSaved(e):e.length!==n.props.pageContext.IBSegments.length?n._ibSegmentDatasource.setIBSegments(e).then(function(){n.setState({isSaving:!1});n.props.onIBSegmentsSaved&&n.props.onIBSegmentsSaved(e)}).catch(function(e){n.setState({errorString:n._getErrorString(e),isSaving:!1})}):n.props.onIBSegmentsSaved&&n.props.onIBSegmentsSaved(e)};n._getCurrentIBSegments=function(){var e=[];n.props.isHostSiteAdmin||(e=Object(r.__spreadArrays)(n.props.pageContext.IBSegments));n.state.additionalIBSegmentDropdownPairs.forEach(function(t){t.selectedKey&&t.selectedKey.length>0&&e.indexOf(t.selectedKey)<0&&e.push(t.selectedKey)});return e};n._getIBSegmentsFromIBSegmentLabelMap=function(){return n.props.pageContext.IBSegments&&0!==n.props.pageContext.IBSegments.length?Object.keys(n.props.ibSegmentLabelMap).filter(function(e){return n.props.pageContext.IBSegments.indexOf(e)>-1}).map(function(e){return{objectId:e,displayName:n.props.ibSegmentLabelMap[e]}}):Object.keys(n.props.ibSegmentLabelMap).map(function(e){return{objectId:e,displayName:n.props.ibSegmentLabelMap[e]}})};n._validateAndEnableDisableSaveButtonForSPAC=function(){if(n.props.isHostSiteAdmin&&n._isShowEditPanelInfoBarrierFlightEnabled){var e=n.state.additionalIBSegmentDropdownPairs,t=n.props.pageContext.IBSegments;if(e.length===t.length&&t.every(function(t){return e.find(function(e){return e.selectedKey===t})})){if(n.props.disableSaveButtonForAdminSite&&n._isSaveButtonForAdminSiteEnabled){n.props.disableSaveButtonForAdminSite();n._isSaveButtonForAdminSiteEnabled=!1}}else if(n.props.enableSaveButtonForAdminSite&&!n._isSaveButtonForAdminSiteEnabled){n.props.enableSaveButtonForAdminSite();n._isSaveButtonForAdminSiteEnabled=!0}}};n.state={errorString:"",isLoading:!0,additionalIBSegmentDropdownPairs:[],areAllSelected:!1,noAdditionalSegmentsString:"",isSaving:!1};n._isShowEditPanelInfoBarrierFlightEnabled=F.n.isFeatureEnabled({ODB:1975});n._isSaveButtonForAdminSiteEnabled=!1;return n}t.prototype.componentDidMount=function(){if(this._isShowEditPanelInfoBarrierFlightEnabled&&this.props.isHostSiteAdmin||this.props.pageContext.IBSegments&&this.props.pageContext.IBSegments.length>0){this._ibSegmentDatasource=new D.e(this.props.pageContext);if(this._isShowEditPanelInfoBarrierFlightEnabled&&this.props.isHostSiteAdmin)this._setInitialIBSegmentDropdownPairsForAdmin();else{var e=this._ibSegmentDatasource.getCompatibleSegments(this.props.pageContext.IBSegments);this._setAdditionalIBSegmentDropdownPairsFromPromise(e,!1)}}};t.prototype._setInitialIBSegmentDropdownPairsForAdmin=function(){var e=this;if(this.props.ibSegmentLabelMap)try{var t=this._getIBSegmentsFromIBSegmentLabelMap(),n=[];if(0===this.props.pageContext.IBSegments.length){var i=this._createDropdownOptions(t);n.push({options:i,key:I.e.generate()})}else t.map(function(t){var r=e._createDropdownOptions([t]);n.push({options:r,key:t.objectId,selectedKey:t.objectId,isIBSegmentDropdownPairDisabled:!0})});this.setState({additionalIBSegmentDropdownPairs:Object(r.__spreadArrays)(n),isLoading:!1,areAllSelected:this.props.pageContext.IBSegments.length>0,noAdditionalSegmentsString:""})}catch(e){this.setState({errorString:H.o,isLoading:!1})}else if(0===this.props.pageContext.IBSegments.length){var s=this._ibSegmentDatasource.getTenantAllOrCompatibleIBSegments([]);this._setAdditionalIBSegmentDropdownPairsFromPromise(s,!1)}else{this._ibSegmentDatasource.getIBSegmentLabels().then(function(t){if(t&&t.length>0){var n=[];t.map(function(t){var r=e._createDropdownOptions([t]);n.push({options:r,key:t.objectId,selectedKey:t.objectId,isIBSegmentDropdownPairDisabled:!0})});e.setState({additionalIBSegmentDropdownPairs:Object(r.__spreadArrays)(n),isLoading:!1,areAllSelected:!0,noAdditionalSegmentsString:""})}}).catch(function(t){e.setState({errorString:e._getErrorString(t),isLoading:!1})})}};t.prototype.render=function(){return this._isShowEditPanelInfoBarrierFlightEnabled&&this.props.isHostSiteAdmin||this.props.pageContext.IBSegments&&this.props.pageContext.IBSegments.length>0?i.createElement(R,Object(r.__assign)({},this.state,{onRemoveDropdown:this._removeDropdownOption,onDropdownChange:this._dropdownChange,onAddAdditionalDropdown:this._addAdditionalDropdown,isSaving:this.state.isSaving,isHostSiteAdmin:this._isShowEditPanelInfoBarrierFlightEnabled&&this.props.isHostSiteAdmin})):null};t.prototype.componentDidUpdate=function(e){if(this.props.saveIBSegmentsClicked&&!e.saveIBSegmentsClicked){this.setState({isSaving:!0});this._saveIBSegments()}this._isShowEditPanelInfoBarrierFlightEnabled&&this.props.isHostSiteAdmin&&!this.props.saveIBSegmentsClicked&&e.saveIBSegmentsClicked&&this.setState({isSaving:!1})};t.prototype._getErrorString=function(e){return e&&e.message?e.message.value||e.message:H.o};return t})(_.e),z=n(244),W=n(536),X=n(1783),V=n(4561),$=n(3806),J=n(2244),K=n(83),Q=n(2999),G=n(3323),Y={ODB:681},Z={ODB:1067},ee={ODB:60028},te={ODB:60328},ne={ODB:60513},re=["image/png","image/jpeg","image/gif","image/bmp","image/tiff"],ie=4194304,se=0,oe=(function(e){Object(r.__extends)(t,e);function t(n){var o=e.call(this,n)||this;o._nameText=Object(i.createRef)();o._descriptionText=Object(i.createRef)();o._privacyDropdown=Object(i.createRef)();o._classificationDropdown=Object(i.createRef)();o._imageBrowser=Object(i.createRef)();o._joinHubSiteDropdown=Object(i.createRef)();o._onRenderMUIEditingInfoLabel=function(e,t){return function(n,r){var u,a,l,c,h,p;if(null===(u=o.props.pageContext)||void 0===u?void 0:u.webLanguage){var d;d=!(null===(a=o._muiUtilities)||void 0===a?void 0:a.multilingualFeatureOn)&&(null===(l=o._muiUtilities)||void 0===l?void 0:l.shouldDisplayNameLanguage(t))?L.format(s.K,Q.e.getResourceByCode(t),e?s.U:s.q):t===(null===(c=o.props.pageContext)||void 0===c?void 0:c.webLanguage)&&t!==(null===(h=o.props.pageContext)||void 0===h?void 0:h.currentLanguage)?L.format(s.$,Q.e.getResourceByCode(null===(p=o.props.pageContext)||void 0===p?void 0:p.webLanguage),e?s.V:s.X):L.format(s.J,e?s.V:s.X);return i.createElement("div",null,r(n),i.createElement(P.e,{content:i.createElement("span",null,d)},i.createElement(f.e,{className:"ms-MUIEditing-InfoIcon",iconProps:{iconName:"Info"}})))}}};o._onMakeHubCheckboxChecked=function(e,t){k.e.logData({name:"SiteSettingsPanel.MakeHub.Click",isIntentional:!0});o.setState({makeHubCheckboxChecked:t,hubDisplayType:t?0:o.props.hubDisplayType})};o._onHubPermSyncToggleChange=function(e,t){o.setState({hubPermSyncCheckboxChecked:t})};o._onDeleteConfirmationCheckboxChange=function(e,t){o.setState({deleteConfirmationCheckboxChecked:t})};o._onDeleteConfirmationDialogAccept=function(){k.e.logData({name:"SiteSettingsPanel.DeleteGroupConfirmation.Click"});o.setState({showDeletingSpinner:!0});o.props.onDeleteGroup&&o.props.onDeleteGroup()};o._onDeleteConfirmationDialogCancel=function(){o.setState({showDeleteConfirmationDialog:!1});o.props.onDeleteGroupDismiss&&o.props.onDeleteGroupDismiss()};o._onDescriptionChange=function(e,t){t!==o.state.description&&o.setState({description:t})};o._onDeleteGroupClick=function(){k.e.logData({name:"SiteSettingsPanel.DeleteGroup.Click"});o.props.deleteSiteFallbackUrl?window.location.href=o.props.deleteSiteFallbackUrl:o.setState({showDeleteConfirmationDialog:!0,showDeletingSpinner:!1,deleteConfirmationCheckboxChecked:!1})};o._onSaveClick=function(e){var t=o,n=t.props,r=t.state,i=o._imageBrowser.current;k.e.logData({name:"SiteSettingsPanel.Save.Click"});o.setState({showSavingSpinner:!0,saveButtonDisabled:!0});if(n.onSave){var s=o.state.name?o.state.name.trim():"",u=o.state.description?o.state.description.trim():"";n.onSave(n.groupNameWithPrefixAndSuffix?n.groupNameWithPrefixAndSuffix:s,u,o._findDropdownOption(n.privacyOptions,r.privacySelectedKey),o._findDropdownOption(n.classificationOptions,r.classificationSelectedKey),i&&i.getImageFile(),o._findDropdownOption(n.joinHubSiteOptions,r.joinHubSiteSelectedKey),r.makeHubCheckboxChecked,!o._hidePermSyncControl&&r.hubPermSyncCheckboxChecked,o.state.titleTranslations,o.state.descriptionTranslations)}};o._onCancelClick=function(e){k.e.logData({name:"SiteSettingsPanel.Cancel.Click"});o._closePanel()};o._onNameTextChanged=function(e,t){var n=o._nameText.current,r=t?t.trim():"";o.state.name!==t&&o.setState({name:t});if(o.props.onValidateGroupName){var i=new A.e(o);o.state.saveButtonDisabled||o.setState({saveButtonDisabled:!0});i.setTimeout(function(){var e=this,t=n&&n.value?n.value.trim():"";t===r&&this.props.onValidateGroupName(t).then(function(){e.setState({saveButtonDisabled:e.props.isGroupNameValidationInProgress||!Boolean(t)||Boolean(e.props.groupNameValidationError)})})}.bind(o),500)}else o.setState({saveButtonDisabled:!Boolean(r)})};o._onClassificationOptionChanged=function(e){o.setState({classificationSelectedKey:e.key,errorMessage:void 0})};o._onClassificationOptionChangedPrivacy=function(e){o._onClassificationOptionChanged(e);var n=t._getDerivedPrivacyStateForClassification(o.props,e.key.toString());o.setState(Object(r.__assign)({},n))};o._onJoinHubSiteOptionChanged=function(e){o.setState({joinHubSiteSelectedKey:e.key,makeHubDisplayType:e.key?0:o.props.makeHubDisplayType})};o._onCancelPendingHubSiteJoinClicked=function(){o.props.onCancelPendingHubSiteJoinClicked&&o.props.onCancelPendingHubSiteJoinClicked()};o._onPrivacyOptionChanged=function(e){o.setState({privacySelectedKey:e.key})};o._closePanel=function(){o.props.onDismiss&&o.props.onDismiss()};o._focusOnTranslationLink=function(e){if(o._shouldRestoreFocusWhenExitMUIEditing)switch(e){case 2:o._translateSiteDescriptionLink&&o._translateSiteDescriptionLink.current&&o._translateSiteDescriptionLink.current.focus();break;case 1:o._translateSiteNameLink&&o._translateSiteNameLink.current&&o._translateSiteNameLink.current.focus()}};o._renderLanguageEditingComponent=function(e){var t=e===J.e.SiteTitle,n=o.state.name,r=o.state.description;return i.createElement("div",{className:"ms-SiteSettingsPanel-LanguagePanel"},i.createElement($.e,{dataSourceType:e,pageContext:o.props.pageContext,onSaveClick:o._onTranslationSaveClick(e),onCancelClick:o._onTranslatePanelDismiss,multilineInput:!t,translations:t?o.state.titleTranslations:o.state.descriptionTranslations,currentDisplay:t?n:r,currentLCID:t?o.state.nameCurrentLCID:o.state.descriptionCurrentLCID,defaultLanguageIsOptional:!t}))};o._onTranslationSaveClick=function(e){return function(t){var n=e===J.e.SiteTitle,r=e===J.e.SiteDescription,i=o._getDisplayLanguage(t),s=o.state.translatePanelType;o.setState({name:n?i.value:o.state.name,nameCurrentLCID:n?i.code:o.state.nameCurrentLCID,description:r?i.value:o.state.description,descriptionCurrentLCID:r?i.code:o.state.descriptionCurrentLCID,translatePanelType:0,titleTranslations:n?t:o.state.titleTranslations,descriptionTranslations:r?t:o.state.descriptionTranslations},function(){return o._focusOnTranslationLink(s)});var u=o.state.titleTranslations?o.state.titleTranslations.filter(function(e){return e.value&&e.value.length>0}):[];n?k.e.logData({name:"SiteSettingsPanel.SiteTitleTranslationsPanelOK.Click",extraData:{translatedItems:u.length}}):k.e.logData({name:"SiteSettingsPanel.SiteDescriptionTranslationsPanelOK.Click",extraData:{translatedItems:u.length}})}};o._getDisplayLanguage=function(e){var t=e.filter(function(e){var t;return e.code===(null===(t=o.props.pageContext)||void 0===t?void 0:t.currentLanguage)}),n=e.filter(function(e){var t;return e.code===(null===(t=o.props.pageContext)||void 0===t?void 0:t.webLanguage)});return 1===t.length&&t[0].value.trim().length>0?t[0]:n[0]};o._handleOpenTranslatePanel=function(e){return function(){o.setState({translatePanelType:e});switch(e){case 1:k.e.logData({name:"SiteSettingsPanel.SiteTitleTranslationsPanelOpen.Click"});break;case 2:k.e.logData({name:"SiteSettingsPanel.SiteDescriptionTranslationsPanelOpen.Click"})}}};o._onTranslatePanelDismiss=function(){var e=o.state.translatePanelType;o.setState({translatePanelType:0},function(){o._focusOnTranslationLink(e)})};o._onClassificationDescriptionsClick=function(){k.e.logData({name:"SiteSettingsPanel.ClassificationDescriptions.Click"});o.setState({showClassificationDescriptions:!0})};o._onClassificationDescriptionsDismiss=function(){o.setState({showClassificationDescriptions:!1})};o._onAddIBSegmentLinkClick=function(){o.setState({showAddIBSegments:!0})};o._onAddIBSegmentsDismiss=function(){o.setState({showAddIBSegments:!1,isSavingIBSegments:!1})};o._onSaveClickIBSegment=function(){o.setState({isSavingIBSegments:!0})};o._onAddIBSegmentsSaved=function(e){o.props.pageContext.IBSegments=e;o.setState({showAddIBSegments:!1,isSavingIBSegments:!1})};o.state={privacySelectedKey:void 0,classificationSelectedKey:void 0,joinHubSiteSelectedKey:void 0,showClassificationDescriptions:!1,makeHubCheckboxChecked:n.isHubSite,hubDisplayType:n.hubDisplayType,makeHubDisplayType:n.makeHubDisplayType,isPrivacyDisabled:!1,showAddIBSegments:!1,isSavingIBSegments:!1,translatePanelType:0,name:void 0,description:void 0,nameCurrentLCID:o.props.nameCurrentLCID,descriptionCurrentLCID:o.props.descriptionCurrentLCID};o._classificationDropdownId="SiteClassificationDropdown"+se++;o._isRootWebContext=Object(K.l)(o.props.pageContext);o._isTeamsChannelSite=o.props.pageContext.isTeamsChannelSite;k.e.logData({name:"SiteSettingsPanel.Opened"});return o}t.prototype.componentDidMount=function(){if(this.props.pageContext){this._muiUtilities=new G.e(this.props.pageContext);if(this._shouldDisplayMUIEditing){this._translateSiteNameLink=i.createRef();this._translateSiteDescriptionLink=i.createRef()}}this._shouldRestoreFocusWhenExitMUIEditing=!O.t.isActivated("43d939e7-d76e-4fef-a055-1b7c3d56bee5","7/29/2021","restore focus to link after existing MUI Editing")};t.getDerivedStateFromProps=function(e,n){var i={};if(e.errorMessage||e.groupDeleteErrorMessage){i.showSavingSpinner=!1;i.showDeletingSpinner=!1;i.saveButtonDisabled=!1;i.errorMessage=e.errorMessage}if(!e.showLoadingSpinner){void 0===n.privacySelectedKey&&(i.privacySelectedKey=e.privacySelectedKey);if(void 0===n.classificationSelectedKey){i.classificationSelectedKey=e.classificationSelectedKey;if(e.useSensitivityLabels){var s=t._getDerivedPrivacyStateForClassification(e,e.classificationSelectedKey);i=Object(r.__assign)(Object(r.__assign)({},i),s)}}if(e.joinHubSiteSelectedKey!==n.lastJoinHubSiteSelectedKeyProp){i.joinHubSiteSelectedKey=e.joinHubSiteSelectedKey;i.lastJoinHubSiteSelectedKeyProp=e.joinHubSiteSelectedKey}}e.hubDisplayType!==n.hubDisplayType&&(i.hubDisplayType=e.hubDisplayType);e.makeHubDisplayType!==n.makeHubDisplayType&&(i.makeHubDisplayType=e.makeHubDisplayType);void 0===n.hubPermSyncCheckboxChecked&&(i.hubPermSyncCheckboxChecked=e.isHubPermSyncEnabled);e.name!==n.name&&""!==e.name&&void 0===n.name&&(i.name=e.name);e.description!==n.description&&""!==e.description&&void 0===n.description&&(i.description=e.description);e.nameCurrentLCID!==n.nameCurrentLCID&&e.nameCurrentLCID&&void 0===n.nameCurrentLCID&&(i.nameCurrentLCID=e.nameCurrentLCID);e.descriptionCurrentLCID!==n.descriptionCurrentLCID&&e.descriptionCurrentLCID&&void 0===n.descriptionCurrentLCID&&(i.descriptionCurrentLCID=e.descriptionCurrentLCID);return i};t.prototype.render=function(){var e,t=this,n=this.props,c=this.props,h=c.classificationOptions,p=c.classificationDescriptions,d=c.makeHubDisplayType,m=c.privacyOptions,E=c.groupNameValidationError,S=c.groupNameWithPrefixAndSuffix,x=c.isGroupNameValidationInProgress,k=c.useSensitivityLabels,A=this.state,_=s.W;if(n.showLoadingSpinner)e=i.createElement(T.e,null);else if(A.showClassificationDescriptions){e=this._renderClassificationDescriptions();_=k?s.l:s.a}else if(F.n.isFeatureEnabled(Y)&&A.showAddIBSegments){_=s.i;e=this._renderAddIBSegments()}else if(0!==A.translatePanelType){var D=1===A.translatePanelType;_=D?s.V:s.X;e=this._renderLanguageEditingComponent(D?J.e.SiteTitle:J.e.SiteDescription)}else{var H=this.state.nameCurrentLCID&&this._shouldDisplayNameLanguage(this.state.nameCurrentLCID)?L.format(s.j,Q.e.getResourceByCode(this.state.nameCurrentLCID)):s.B,B=this.state.descriptionCurrentLCID&&this._shouldDisplayNameLanguage(this.state.descriptionCurrentLCID)?L.format(s.E,Q.e.getResourceByCode(this.state.descriptionCurrentLCID)):s.w;e=i.createElement("div",{className:"ms-SiteSettingsPanel-content"},this._renderSiteLogo(),this._isRootWebContext&&this._renderUsageLink(),i.createElement("div",{className:"ms-SiteSettingsPanel-SiteInfo","data-automationid":"SiteSettingsPanelSiteInfo"},i.createElement(N.e,{className:Object(C.e)("ms-SiteSettingsPanel-nameText",{"prefix-suffix":!!S},{"ms-SiteSettingsPanel-nameText-translateLink":this._shouldDisplayMUIEditing}),componentRef:this._nameText,label:H,value:this.state.name,onChange:this._onNameTextChanged,errorMessage:x?null:E,required:!0,"data-automationid":"SiteSettingsPanelNameText",onRenderLabel:this._shouldDisplayNameLanguage(this.state.nameCurrentLCID)?this._onRenderMUIEditingInfoLabel(!0,this.state.nameCurrentLCID):void 0,styles:this._shouldDisplayNameLanguage(this.state.nameCurrentLCID)?{subComponentStyles:{label:{root:{":after":{paddingRight:0,paddingLeft:0},display:"inline-block"}}}}:void 0}),this._shouldDisplayMUIEditing&&i.createElement(y.e,{componentRef:this._translateSiteNameLink,onClick:this._handleOpenTranslatePanel(1),className:"ms-SiteSettingsPanel-translationButton","aria-label":s.V},s.V),x?i.createElement(T.e,{label:s.G}):S?i.createElement("span",{className:"ms-SiteSettingsPanel-groupNameWithPrefixAndSuffix"},S):null,i.createElement(N.e,{componentRef:this._descriptionText,label:B,multiline:!0,onChange:this._onDescriptionChange,value:this.state.description,resizable:!1,"data-automationid":"SiteSettingsPanelDescriptionText",className:Object(C.e)("ms-SiteSettingsPanel-siteDescription",{"ms-SiteSettingsPanel-siteDescription-translateLink":this._shouldDisplayMUIEditing}),onRenderLabel:this._shouldDisplayNameLanguage(this.state.descriptionCurrentLCID)?this._onRenderMUIEditingInfoLabel(!1,this.state.descriptionCurrentLCID):void 0,styles:this._shouldDisplayNameLanguage(this.state.descriptionCurrentLCID)?{subComponentStyles:{label:{root:{display:"inline-block"}}}}:void 0}),this._shouldDisplayMUIEditing&&i.createElement(y.e,{componentRef:this._translateSiteDescriptionLink,onClick:this._handleOpenTranslatePanel(2),className:"ms-SiteSettingsPanel-translationButton","aria-label":s.X},s.X),this._isRootWebContext&&this._renderJoinHubDropdown(),i.createElement(M.t,Object(r.__assign)({},n.flowWidgetPanelProps)),this._isRootWebContext&&i.createElement(i.Fragment,null,2===d?i.createElement("div",{className:"ms-SiteSettingsPanel-makeHubCheckbox"},i.createElement(l.e,{label:s.P,checked:A.makeHubCheckboxChecked,onChange:this._onMakeHubCheckboxChecked,disabled:!!A.joinHubSiteSelectedKey})):null),this._isRootWebContext&&h&&h.length?i.createElement("div",{className:"ms-SiteSettingsPanel-classification"},i.createElement(g.e,{className:"ms-Dropdown-label ms-SiteSettingsPanel-classificationDropDownLabel",htmlFor:this._classificationDropdownId},k?s.l:s.f),p&&p.length>0?i.createElement(y.e,{onClick:this._onClassificationDescriptionsClick,"data-automationid":"SiteSettingsPanelclassificationInfoIcon"},i.createElement(a.e,{iconName:"Info",className:"ms-SiteSettingsPanel-classificationInfoIcon"})):null,i.createElement(v.e,{className:"ms-SiteSettingsPanel-ClassificationDropdown",componentRef:this._classificationDropdown,id:this._classificationDropdownId,options:h,selectedKey:A.classificationSelectedKey,onChanged:k?this._onClassificationOptionChangedPrivacy:this._onClassificationOptionChanged,disabled:this._isTeamsChannelSite&&!O.t.isActivated("BFCC0647-0268-49F0-9AD9-966BFF0BEFF9","09/17/2020","Disable sensitivity label / classification dropdown on private channel sites")&&F.n.isFeatureEnabled(ee)})):null,this._isRootWebContext&&m&&m.length?i.createElement(v.e,{className:"ms-SiteSettingsPanel-PrivacyDropdown",componentRef:this._privacyDropdown,label:s.F,options:m,selectedKey:A.privacySelectedKey,onChanged:this._onPrivacyOptionChanged,disabled:!!k&&A.isPrivacyDisabled}):null,this._isRootWebContext&&this.props.pageContext.IBSegments&&this.props.pageContext.IBSegments.length>0&&i.createElement("div",{className:"ms-SiteSettingsPanel-IBSegmentsSection"},i.createElement("div",{className:"ms-SiteSettingsPanel-CurrentIBSegmentDisplay"},i.createElement(j,{pageContext:this.props.pageContext})," "),F.n.isFeatureEnabled(Y)&&i.createElement("div",{className:"ms-SiteSettingsPanel-UsageLink"},i.createElement(P.e,{content:this.props.pageContext.isTeamsConnectedSite?s.H:null},i.createElement(y.e,{onClick:this._onAddIBSegmentLinkClick,disabled:this.props.pageContext.isTeamsConnectedSite},s.n)))),A.errorMessage?i.createElement("div",{className:"ms-SiteSettingsPanel-ErrorMessage","data-automationid":"SiteSettingsPanelErrorMessage"},A.errorMessage):null,A.showSavingSpinner?i.createElement(T.e,{className:"ms-SiteSettingsPanel-savingSpinner"}):null,this._renderHelpTextFooter(),this._renderDeleteGroupLink()))}var I=Object(W.e)()?"Forward":"Back",q="ms-SiteSettingsPanel-BackIcon-RTL";return i.createElement(b.e,{className:"ms-SiteSettingsPanel",isOpen:n.isPanelOpen,type:w.e.smallFixedFar,onDismiss:this._closePanel,isLightDismiss:!0,closeButtonAriaLabel:s.c,"aria-live":this._shouldDisplayMUIEditing?"polite":"off",headerText:A.showClassificationDescriptions||A.showAddIBSegments||0!==A.translatePanelType?null:_,onRenderNavigationContent:function(e,n){return A.showClassificationDescriptions?i.createElement("div",{className:"ms-SiteSettingsPanel-NavigationContent"},i.createElement(f.e,{iconProps:{iconName:I},className:q,onClick:A.showClassificationDescriptions?t._onClassificationDescriptionsDismiss:t._closePanel,ariaLabel:s.s}),i.createElement("p",{className:"ms-SiteSettingsPanel-Title"}," ",_),n(e)):A.showAddIBSegments?i.createElement("div",{className:"ms-SiteSettingsPanel-NavigationContent"},i.createElement(f.e,{iconProps:{iconName:I},className:q,onClick:t._onAddIBSegmentsDismiss,ariaLabel:s.s}),i.createElement("p",{className:"ms-SiteSettingsPanel-Title"}," ",_),n(e)):0!==A.translatePanelType?i.createElement(i.Fragment,null,i.createElement("div",{className:"ms-SiteSettingsPanel-NavigationContent ms-SiteSettingsPanel-NavigationContentTranslate"},i.createElement(f.e,{iconProps:{iconName:I},className:q,onClick:t._onTranslatePanelDismiss,ariaLabel:s.s}),i.createElement("p",{className:"ms-SiteSettingsPanel-Title"}," ",_),n(e)),i.createElement(V.e,null)):i.createElement("div",{className:"ms-SiteSettingsPanel-NavigationContentDismiss"}," ",n(e)," ")},onRenderFooterContent:function(e,n){return A.showClassificationDescriptions?i.createElement(o.e,{className:"ms-ClassificationDescriptions-dismissButton",onClick:t._onClassificationDescriptionsDismiss},s.u):A.showAddIBSegments?i.createElement("div",{className:"ms-SiteSettingsPanel-Buttons","data-automationid":"SiteSettingsPanelButtons"},i.createElement("span",{className:"ms-SiteSettingsPanelButton-container"},i.createElement(o.e,{className:"ms-SiteSettingsPanelButton-saveButton",disabled:A.saveButtonDisabled,onClick:t._onSaveClickIBSegment,"data-automationid":"SiteSettingsPanelSaveButtonIBSegment"},s.I)),i.createElement("span",{className:"ms-SiteSettingsPanelButton-container"},i.createElement(u.e,{className:"ms-SiteSettingsPanelButton-cancelButton",onClick:t._onAddIBSegmentsDismiss,"data-automationid":"SiteSettingsPanelCancelButtonIBSegment"},s.c))):0===A.translatePanelType?i.createElement(i.Fragment,null,!A.showClassificationDescriptions&&i.createElement("div",{className:"ms-SiteSettingsPanel-Buttons","data-automationid":"SiteSettingsPanelButtons"},i.createElement("span",{className:"ms-SiteSettingsPanelButton-container"},i.createElement(o.e,{className:"ms-SiteSettingsPanelButton-saveButton",disabled:A.saveButtonDisabled,onClick:t._onSaveClick,"data-automationid":"SiteSettingsPanelSaveButton"},s.I)),i.createElement("span",{className:"ms-SiteSettingsPanelButton-container"},i.createElement(u.e,{className:"ms-SiteSettingsPanelButton-cancelButton",onClick:t._onCancelClick,"data-automationid":"SiteSettingsPanelCancelButton"},s.c)))):void 0}},e,this._renderDeleteConfirmationDialog())};t.prototype._shouldDisplayNameLanguage=function(e){var t;return this.props.pageContext&&!this.props.pageContext.groupId&&(null===(t=this._muiUtilities)||void 0===t?void 0:t.shouldDisplayNameLanguage(e))};Object.defineProperty(t.prototype,"_shouldDisplayMUIEditing",{get:function(){var e;return this.props.pageContext&&!this.props.pageContext.groupId&&(null===(e=this._muiUtilities)||void 0===e?void 0:e.multilingualFeatureOn)},enumerable:!0,configurable:!0});t._getDerivedPrivacyStateForClassification=function(e,t){var n={},r=e.classificationPrivacy;if(r.length>0&&t){var i=r.filter(function(e){return e.classificationTitle===t}).pop(),s=i?i.classificationPrivacy:void 0;if(s){var o=void 0;o=O.t.isActivated("8770829e-3a57-4518-ac8b-d9ee1f50697c","10/02/2020","UnspecifiedPrivacyOption")?"private"===s.toLowerCase()?"private":"unspecified"===s.toLocaleLowerCase()&&e&&e.privacySelectedKey?e.privacySelectedKey:"public":"private"===s.toLowerCase()?"private":"public"===s.toLocaleLowerCase()?"public":e&&t===e.classificationSelectedKey&&e.privacySelectedKey?e.privacySelectedKey:"private";var u="unspecified"!==s.toLowerCase();n.privacySelectedKey=o;n.isPrivacyDisabled=u}else n.isPrivacyDisabled=!1}return n};t.prototype._findDropdownOption=function(e,t){return e&&e.filter(function(e){return e.key===t})[0]};t.prototype._renderJoinHubDropdown=function(){var e;if(!(z.e.isFeatureEnabled(te)&&(null===(e=this.props.pageContext)||void 0===e?void 0:e.isTeamsChannelSite)||this.props.isHubSite)){var t,n=this.props,r=this.state,o=n.hubDisplayType,u=n.joinHubSiteOptions,a=n.isHubOptionsReady,f=n.isHubSitePermSyncSupported,l=n.hubSites,h=r.joinHubSiteSelectedKey;if(!a)return i.createElement(T.e,{className:"ms-SiteSettingsPanel-hubLoadingSpinner"});if(l)for(var p in l)if(l[p].id===h){t=l[p];break}this._hidePermSyncControl=!t||t&&!t.enablePermissionsSync;O.t.isActivated("041f10a5-5c0e-420f-b564-a3d03baa36ae","05/18/2021","Site owner is now allowed to manage hub perm sync")&&(this._hidePermSyncControl=!this.props.pageContext.isSiteAdmin||this._hidePermSyncControl);var d=null;if(n.isHubSiteJoinPending)d=i.createElement("span",null,s.M,"",i.createElement(y.e,{onClick:this._onCancelPendingHubSiteJoinClicked},s.k));else if(n.joinHubSiteSelectedKey!==h)if(h){var m=this._findDropdownOption(u,h);d=i.createElement("span",null,s._,f&&!this._hidePermSyncControl&&i.createElement(i.Fragment,null," "+s.T+" ",i.createElement(y.e,{href:"https://go.microsoft.com/fwlink/?linkid=2133626"},s.e)),m.data&&m.data.requiresJoinApproval&&i.createElement("div",{style:{marginTop:20}},s.N))}else d=s.S;return i.createElement("div",{className:"ms-SiteSettingsPanel-joinHubSite"},i.createElement(v.e,{className:"ms-SiteSettingsPanel-joinHubSiteDropdown",componentRef:this._joinHubSiteDropdown,label:s.x,options:u,selectedKey:h,onChanged:this._onJoinHubSiteOptionChanged,disabled:!!r.makeHubCheckboxChecked||!!n.isHubSiteJoinPending||1===o}),i.createElement("span",{className:"ms-SiteSettingsPanel-hubDropdownTip",role:"alert"},i.createElement("span",{key:h||"none"},d)),f&&!this._hidePermSyncControl&&h&&i.createElement(i.Fragment,null,i.createElement(c.e,{className:"ms-SiteSettingsPanel-HubPermSyncCheckbox",onText:"On",offText:"Off",checked:r.hubPermSyncCheckboxChecked,label:s.z,disabled:1===o,onChange:this._onHubPermSyncToggleChange})))}};t.prototype._renderDeleteGroupLink=function(){var e=null;this.props.enableDelete&&(e=i.createElement("div",{className:"ms-SiteSettingsPanel-DeleteGroupLink"},i.createElement(y.e,{onClick:this._onDeleteGroupClick,"data-automationid":"SiteSettingsPanelDeleteGroupLink"},i.createElement(a.e,{iconName:"Delete",className:"ms-SiteSettingsPanel-DeleteGroupLinkIcon"}),i.createElement("span",{className:"ms-SiteSettingsPanel-DeleteGroupLinkLabel"},s.m))));return e};t.prototype._renderDeleteConfirmationDialog=function(){var e=this.props,t=e.enableDelete,n=e.groupDeleteErrorMessage,r=e.name,a=e.useDeleteSiteStrings,f=this.state,c=null;t&&(c=i.createElement(h.e,{hidden:!f.showDeleteConfirmationDialog,type:p.e.close,onDismiss:this._onDeleteConfirmationDialogCancel,isBlocking:!0,closeButtonAriaLabel:s.c,title:a?s.b:s.v},i.createElement("div",null,L.format(a?s.y:s.d,r)),i.createElement(l.e,{className:"ms-SiteSettingsPanel-DeleteGroupConfirmationCheckbox",label:a?s.g:s.p,onChange:this._onDeleteConfirmationCheckboxChange}),n?i.createElement("div",{className:"ms-SiteSettingsPanel-ErrorMessage"},n):null,i.createElement(d.e,null,i.createElement(o.e,{disabled:!f.deleteConfirmationCheckboxChecked||f.showDeletingSpinner,onClick:this._onDeleteConfirmationDialogAccept,text:s.h}),i.createElement(u.e,{onClick:this._onDeleteConfirmationDialogCancel,text:s.c}),f.showDeletingSpinner?i.createElement(T.e,null):null)));return c};t.prototype._renderHelpTextFooter=function(){var e=this.props.classicSiteSettingsUrl,t=null;e&&(t=i.createElement("div",{className:"ms-SiteSettingsPanel-HelpText","data-automationid":"SiteSettingsPanelHelperText"},i.createElement(y.e,{href:e},s.o)));return t};t.prototype._renderSiteLogo=function(){return F.n.isFeatureEnabled(ne)?i.createElement("div",{className:"ms-SiteSettingsPanel-SiteLogo","data-automationid":"SiteSettingsPanelSiteLogo"},i.createElement(X.e,null,s.R)):this._renderSiteLogoCore()};t.prototype._renderSiteLogoCore=function(){var e=this.props,t=this.props,n=t.siteLogo,r=t.showImageBrowser,o=null;n&&!r?o=i.createElement(x,{siteTitle:e.name,siteLogoUrl:n.imageUrl,siteAcronym:n.acronym,siteLogoBgColor:n.backgroundColor,disableSiteLogoFallback:!1,size:64}):r&&(o=i.createElement(m.e,{ref:this._imageBrowser,initialPreviewUrl:F.n.isFeatureEnabled(Z)?this.props.pageContext.webAbsoluteUrl+"/_api/siteiconmanager/getsitelogo":n&&n.imageUrl,disableRemove:e.disableRemoveLogo,supportedImageTypes:re}));return i.createElement("div",{className:"ms-SiteSettingsPanel-SiteLogo","data-automationid":"SiteSettingsPanelSiteLogo"},i.createElement(g.e,{className:"ms-SiteSettingsPanel-SiteLogo-Title"},s.D),o)};t.prototype._renderUsageLink=function(){var e=this.props.usageGuidelinesUrl,t=null;e&&(t=i.createElement("div",{className:"ms-SiteSettingsPanel-UsageLink"},i.createElement(y.e,{href:e,target:"_blank","data-automationid":"SiteSettingsPanelUsageLink"},s.Q)));return t};t.prototype._renderClassificationDescriptions=function(){var e=this.props.classificationDescriptions;return e&&e.length>0?i.createElement("div",{className:"ms-SiteSettingsPanel-ClassificationDescriptions"},e.map(function(e,t){return i.createElement("div",{className:"ms-ClassificationDescriptions-item",key:t},i.createElement("div",{className:"ms-ClassificationDescriptions-itemTitle"},e.classificationTitle),i.createElement("div",{className:"ms-ClassificationDescriptions-itemDescription"},e.classificationDescription))})):null};t.prototype._renderAddIBSegments=function(){if(this.props.pageContext.IBSegments&&this.props.pageContext.IBSegments.length>0){var e=i.createElement("a",{href:"https://aka.ms/SPOInfoBarriers",target:"_blank"},s.e),t=L.formatToArray(s.r,e);return i.createElement(i.Fragment,null,i.createElement("div",{className:"ms-SiteSettingsPanel-AddSegmentsDescription"},t),i.createElement("div",{className:"ms-SiteSettingsPanel-CompatibleIBSegmentDisplay"},i.createElement(j,{pageContext:this.props.pageContext}),i.createElement(U,{pageContext:this.props.pageContext,saveIBSegmentsClicked:this.state.isSavingIBSegments,onIBSegmentsSaved:this._onAddIBSegmentsSaved})))}return null};return t})(i.Component)},2693:function(e,t,n){"use strict";n.d(t,"n",function(){return l});n.d(t,"e",function(){return c});n.d(t,"r",function(){return h});n.d(t,"t",function(){return p});var r,i,s,o=n(0),u=n(954);(function(e){e[e.Red=0]="Red";e[e.Orange=1]="Orange";e[e.Yellow=2]="Yellow";e[e.Green=3]="Green";e[e.Teal=4]="Teal";e[e.Blue=5]="Blue";e[e.Dark_Blue=6]="Dark_Blue";e[e.Indigo=7]="Indigo";e[e.Plum=8]="Plum";e[e.Purple=9]="Purple";e[e.Gray=10]="Gray";e[e.Warm_Gray=11]="Warm_Gray"})(s||(s={}));var a={red:"#a4262c",orange:"#ca5010",yellow:"#986f0b",green:"#498205",teal:"#03787c",blue:"#0078d4",dark_Blue:"#004e8c",indigo:"#4f6bed",plum:"#881798",purple:"#8764b8",gray:"#69797e",warm_Gray:"#7a7574"},f={red:"#ef6950",yellow:"#ffc83d",green:"#00b294",blue:"#3a96dd",purple:"#9c89e9",gray:"#b1adab"};function l(){return S}function c(e){return"#1b1a19"===e||"#182534"===e?d:v}function h(e,t){var n=(function(e,t){var n=m,r=w;if(e){n="#182534"===t?y:g;r=b}return{partialThemes:r,neutrals:n}})(e,t),r=n.neutrals,i=n.partialThemes,s={};for(var u in i){var a=i[u];s[a.themePrimary]=Object(o.__assign)(Object(o.__assign)({},a),r)}return s}function p(e,t){return e?f:a}var d={"#ef6950":["#9c89e9","#00b294","#3a96dd","#b1adab"],"#ffc83d":["#3a96dd","#ef6950","#9c89e9","#b1adab"],"#00b294":["#3a96dd","#9c89e9","#ef6950","#b1adab"],"#3a96dd":["#9c89e9","#00b294","#ef6950","#b1adab"],"#9c89e9":["#3a96dd","#ef6950","#ffc83d","#b1adab"],"#b1adab":["#3a96dd","#9c89e9","#ef6950","#ffc83d"]},v={"#a4262c":["#ca5010","#881798","#498205","#7a7574"],"#ca5010":["#986f0b","#a4262c","#498205","#7a7574"],"#986f0b":["#ca5010","#498205","#0078d4","#69797e"],"#498205":["#03787c","#0078d4","#ca5010","#69797e"],"#03787c":["#4f6bed","#0078d4","#ca5010","#69797e"],"#0078d4":["#8764b8","#03787c","#ca5010","#69797e"],"#004e8c":["#03787c","#0078d4","#986f0b","#69797e"],"#4f6bed":["#8764b8","#0078d4","#03787c","#69797e"],"#881798":["#03787c","#0078d4","#ca5010","#69797e"],"#8764b8":["#03787c","#0078d4","#986f0b","#69797e"],"#69797e":["#0078d4","#ca5010","#498205","#a4262c"],"#7a7574":["#ca5010","#0078d4","#498205","#a4262c"]},m=Object(o.__assign)(Object(o.__assign)({},u.e),{black:"#000000",white:"#ffffff",primaryBackground:"#ffffff",primaryText:"#333333"}),g={neutralLighterAlt:"#201f1e",neutralLighter:"#252423",neutralLight:"#292827",neutralQuaternaryAlt:"#323130",neutralQuaternary:"#3b3a39",neutralTertiaryAlt:"#484644",neutralTertiary:"#797775",neutralSecondary:"#a19f9d",neutralPrimaryAlt:"#c8c6c4",neutralPrimary:"#f3f2f1",neutralDark:"#faf9f8",black:"#ffffff",white:"#1b1a19",primaryBackground:"#1b1a19",primaryText:"#f3f2f1"},y={neutralLighterAlt:"#1d2b3c",neutralLighter:"#223244",neutralLight:"#2b3d51",neutralQuaternaryAlt:"#324459",neutralQuaternary:"#374a5f",neutralTertiaryAlt:"#4f637a",neutralTertiary:"#c8c8c8",neutralSecondary:"#d0d0d0",neutralPrimaryAlt:"#dadada",neutralPrimary:"#ffffff",neutralDark:"#f4f4f4",black:"#f8f8f8",white:"#182534",primaryBackground:"#182534",primaryText:"#ffffff"},b=((r={})[s.Red]={themePrimary:"#ef6950",themeLighterAlt:"#0a0403",themeLighter:"#26110d",themeLight:"#481f18",themeTertiary:"#903e2f",themeSecondary:"#d35b46",themeDarkAlt:"#f17660",themeDark:"#f38a77",themeDarker:"#f6a89a",accent:"#ef6950"},r[s.Yellow]={themePrimary:"#ffc83d",themeLighterAlt:"#0a0802",themeLighter:"#29200a",themeLight:"#4d3c12",themeTertiary:"#997825",themeSecondary:"#e0b036",themeDarkAlt:"#ffce51",themeDark:"#ffd56c",themeDarker:"#ffe092",accent:"#ffc83d"},r[s.Green]={themePrimary:"#00b294",themeLighterAlt:"#000706",themeLighter:"#001d18",themeLight:"#00362d",themeTertiary:"#006b59",themeSecondary:"#009d83",themeDarkAlt:"#13ba9e",themeDark:"#2fc5ac",themeDarker:"#5dd4c0",accent:"#00b294"},r[s.Blue]={themePrimary:"#3a96dd",themeLighterAlt:"#020609",themeLighter:"#091823",themeLight:"#112d43",themeTertiary:"#235a85",themeSecondary:"#3385c3",themeDarkAlt:"#4ba0e1",themeDark:"#65aee6",themeDarker:"#8ac2ec",accent:"#3a96dd"},r[s.Purple]={themePrimary:"#9c89e9",themeLighterAlt:"#060509",themeLighter:"#191625",themeLight:"#2f2946",themeTertiary:"#5e528b",themeSecondary:"#8978cc",themeDarkAlt:"#a594ea",themeDark:"#b2a4ee",themeDarker:"#c6bbf2",accent:"#9c89e9"},r[s.Gray]={themePrimary:"#b1adab",themeLighterAlt:"#070707",themeLighter:"#1c1c1b",themeLight:"#353433",themeTertiary:"#6a6766",themeSecondary:"#9b9896",themeDarkAlt:"#b8b5b3",themeDark:"#c3c0be",themeDarker:"#d3d0cf",accent:"#b1adab"},r),w=((i={})[s.Red]={themePrimary:"#a4262c",themeLighterAlt:"#fbf4f4",themeLighter:"#f0d3d4",themeLight:"#e3afb2",themeTertiary:"#c86c70",themeSecondary:"#ae383e",themeDarkAlt:"#932227",themeDark:"#7c1d21",themeDarker:"#5b1519",accent:"#ca5010"},i[s.Orange]={themePrimary:"#ca5010",themeLighterAlt:"#fdf7f4",themeLighter:"#f6dfd2",themeLight:"#efc4ad",themeTertiary:"#df8f64",themeSecondary:"#d06228",themeDarkAlt:"#b5490f",themeDark:"#993e0c",themeDarker:"#712d09",accent:"#986f0b"},i[s.Yellow]={themePrimary:"#986f0b",themeLighterAlt:"#fbf8f2",themeLighter:"#efe5cb",themeLight:"#e0cfa2",themeTertiary:"#c2a356",themeSecondary:"#a57f1e",themeDarkAlt:"#8a650a",themeDark:"#745608",themeDarker:"#563f06",accent:"#ca5010"},i[s.Green]={themePrimary:"#498205",themeLighterAlt:"#f6faf0",themeLighter:"#dbebc7",themeLight:"#bdda9b",themeTertiary:"#85b44c",themeSecondary:"#5a9117",themeDarkAlt:"#427505",themeDark:"#386304",themeDarker:"#294903",accent:"#03787c"},i[s.Teal]={themePrimary:"#03787c",themeLighterAlt:"#f0f9fa",themeLighter:"#c5e9ea",themeLight:"#98d6d8",themeTertiary:"#49aeb1",themeSecondary:"#13898d",themeDarkAlt:"#026d70",themeDark:"#025c5f",themeDarker:"#014446",accent:"#4f6bed"},i[s.Blue]={themePrimary:"#0078d4",themeLighterAlt:"#eff6fc",themeLighter:"#deecf9",themeLight:"#c7e0f4",themeTertiary:"#71afe5",themeSecondary:"#2b88d8",themeDarkAlt:"#106ebe",themeDark:"#005a9e",themeDarker:"#004578",accent:"#8764b8"},i[s.Dark_Blue]={themePrimary:"#004e8c",themeLighterAlt:"#f0f6fa",themeLighter:"#c7dced",themeLight:"#9abfdd",themeTertiary:"#4a88ba",themeSecondary:"#125d9a",themeDarkAlt:"#00457e",themeDark:"#003b6b",themeDarker:"#002b4f",accent:"#03787c"},i[s.Indigo]={themePrimary:"#4f6bed",themeLighterAlt:"#f7f9fe",themeLighter:"#e1e6fc",themeLight:"#c7d1fa",themeTertiary:"#92a4f4",themeSecondary:"#627cef",themeDarkAlt:"#4661d5",themeDark:"#3b52b4",themeDarker:"#2c3c85",accent:"#8764b8"},i[s.Plum]={themePrimary:"#881798",themeLighterAlt:"#faf2fb",themeLighter:"#ebceef",themeLight:"#daa7e0",themeTertiary:"#b65fc2",themeSecondary:"#972aa5",themeDarkAlt:"#7c158a",themeDark:"#691174",themeDarker:"#4d0d56",accent:"#03787c"},i[s.Purple]={themePrimary:"#8764b8",themeLighterAlt:"#f9f8fc",themeLighter:"#e9e2f4",themeLight:"#d7c9ea",themeTertiary:"#b29ad4",themeSecondary:"#9372c0",themeDarkAlt:"#7959a5",themeDark:"#664b8c",themeDarker:"#4b3867",accent:"#03787c"},i[s.Gray]={themePrimary:"#69797e",themeLighterAlt:"#f8f9fa",themeLighter:"#e4e9ea",themeLight:"#cdd5d8",themeTertiary:"#9fadb1",themeSecondary:"#78888d",themeDarkAlt:"#5d6c70",themeDark:"#4f5b5f",themeDarker:"#3a4346",accent:"#0078d4"},i[s.Warm_Gray]={themePrimary:"#7a7574",themeLighterAlt:"#faf9f9",themeLighter:"#eae8e8",themeLight:"#d7d5d4",themeTertiary:"#afabaa",themeSecondary:"#8a8584",themeDarkAlt:"#6e6a69",themeDark:"#5d5958",themeDarker:"#454241",accent:"#ca5010"},i),E={default_SharePoint:{name:"",backgroundImageUri:"",theme:Object(o.__assign)(Object(o.__assign)({},w[s.Teal]),m)}},S=Object(o.__assign)(Object(o.__assign)({},E),{default_Office:{name:"",backgroundImageUri:"",theme:Object(o.__assign)(Object(o.__assign)({},w[s.Blue]),m)},default_Orange:{name:"",backgroundImageUri:"",theme:Object(o.__assign)(Object(o.__assign)({},w[s.Orange]),m)},default_Red:{name:"",backgroundImageUri:"",theme:Object(o.__assign)(Object(o.__assign)({},w[s.Red]),m)},default_Purple:{name:"",backgroundImageUri:"",theme:Object(o.__assign)(Object(o.__assign)({},w[s.Purple]),m)},default_Green:{name:"",backgroundImageUri:"",theme:Object(o.__assign)(Object(o.__assign)({},w[s.Green]),m)},default_Gray:{name:"",backgroundImageUri:"",theme:Object(o.__assign)(Object(o.__assign)({},w[s.Gray]),m)},default_DarkYellow:{name:"",backgroundImageUri:"",isInverted:!0,theme:Object(o.__assign)(Object(o.__assign)({},b[s.Yellow]),g)},default_DarkBlue:{name:"",isInverted:!0,backgroundImageUri:"",theme:Object(o.__assign)(Object(o.__assign)({},b[s.Blue]),y)}})},3323:function(e,t,n){"use strict";var r=n(245),i=n(373),s=(function(){function e(e){this.pageContext=e}Object.defineProperty(e.prototype,"multilingualFeatureOn",{get:function(){if(void 0===this._multilingualFeatureOn){var e=new i.e(this.pageContext.featureInfo);if(e){var t=e.get("MultilingualPages");this._multilingualFeatureOn=!!t&&t.enabled}else this._multilingualFeatureOn=!1}return this._multilingualFeatureOn},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"publishingFeatureOn",{get:function(){if(void 0===this._publishingFeatureOn){var e=new i.e(this.pageContext.featureInfo);if(e){var t=e.get("Publishing");this._publishingFeatureOn=!!t&&t.enabled}else this._publishingFeatureOn=!1}return this._publishingFeatureOn},enumerable:!0,configurable:!0});e.prototype._isMultilingualScenario=function(e){var t,n;return!!e&&(this.multilingualFeatureOn||e!==(null===(t=this.pageContext)||void 0===t?void 0:t.webLanguage)||(null===(n=this.pageContext)||void 0===n?void 0:n.currentLanguage)!==e)};Object.defineProperty(e.prototype,"isMUIStreamliningEnabled",{get:function(){return r.n.isFeatureEnabled({ODB:60483})&&!this.publishingFeatureOn},enumerable:!0,configurable:!0});e.prototype.shouldDisplayNameLanguage=function(e){return this.isMUIStreamliningEnabled?this._isMultilingualScenario(e):!this.isMUIStreamliningEnabled&&this.multilingualFeatureOn};return e})();t.e=s},3486:function(e,t,n){"use strict";n.d(t,"e",function(){return o});n.d(t,"t",function(){return u});n.d(t,"n",function(){return a});var r=n(0),i=n("react-lib"),s=n("prop-types-lib"),o={dependencies:s.object.isRequired};function u(e,t){var n=e,s={dependencies:Object(r.__assign)({},t||{})};return(function(e){Object(r.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getChildContext=function(){return s};t.prototype.render=function(){return i.createElement(n,Object(r.__assign)({},this.props))};t.childContextTypes=Object(r.__assign)({},o);return t})(i.Component)}function a(e,t){var n=e.contextTypes,i=void 0===n?{}:n,s=(i.dependencies,Object(r.__rest)(i,["dependencies"])),o=function(n,i){return e(n,Object(r.__assign)(Object(r.__assign)({},i),{dependencies:t}))};o.contextTypes=s;return o}},3493:function(e,t,n){"use strict";n.d(t,"e",function(){return l});var r,i,s,o,u,a,f,l,c=n(0),h=n(83),p=n(4624),d=n(4254),v=n(2996),m=n(1657),g=n(69),y=n(163),b=n(18),w=n(30),E=n(5020),S=n(3853),x=n(244),T=n(67),N={ODB:1145};(function(e){e[e.Limited=0]="Limited";e[e.FullControl=1]="FullControl";e[e.Edit=2]="Edit";e[e.Read=3]="Read"})(l||(l={}));var C=((r={})[1]=l.Limited,r[2]=l.Read,r[3]=l.Edit,r[4]=l.Edit,r[6]=l.Edit,r[5]=l.FullControl,r),k=1073741830,L=1073741826,A=((i={})[5]=1073741829,i[6]=k,i[2]=L,i),O=48,M=128,_=2147483647,D=((s={})[5]=1,s[6]=O,s[2]=M,s),P=((o={})[l.Edit]=S.h,o[l.FullControl]=S.v,o[l.Read]=S.H,o),H=((u={})[l.FullControl]=S.$,u[l.Edit]=S.X,u[l.Read]=S.G,u),B=((a={})[l.FullControl]=S.J,a[l.Edit]=S.V,a[l.Read]=S.Y,a),j=((f={})[l.Read]=S.T,f),F=(function(){function e(e){var t=this;this._permissionGroups={};this._shareSite=function(e,n,r){var i=t._assignUsersToPermssionGroup(e),s=[];t._sharingSiteProvider||(t._sharingSiteProvider=new E.e({pageContext:t._pageContext}));for(var o in i)if(i[o]&&i[o].length>0){var u=t._pageContext.isExternalGuestUser&&t._permissionLevelOfCurrentUser!==l.FullControl?"":"group:"+t._permissionGroups[o];s.push(t._sharingSiteProvider.shareSite(i[o],{siteUrl:t._pageContext.webAbsoluteUrl,roleValue:u,sendEmail:t._params.isEmailSharingEnabled&&n,message:r,requireSignIn:!0}))}return g.n.all(s).then(function(e){if(!T.t.isActivated("5a013444-053c-4234-8a89-3443d47a5952","02/04/2021","Improve share site error handling")&&e&&e.length>0)for(var n in e)if(e[n]&&e[n].errorMessage){t._setState({shareSiteErrorMsg:t._getShareSiteErrorMsg(e[n])});return!1}t._setState({showShareSiteOnly:!!t._params.shouldLoadSharePanelOnly});t._fetchUpdatedPermissions();return!0})};this._onCancel=function(){t._params.shouldLoadSharePanelOnly?t._setState({shouldDismissPanel:!0,shareSiteErrorMsg:null}):t._setState({showShareSiteOnly:!1,shareSiteErrorMsg:null});t._fetchUpdatedPermissions()};this._onDismiss=function(){t._setState({shareSiteErrorMsg:null})};this._saveHubPermissionSync=function(e){t._setState({showHubSyncToggleSpinner:!0});var n=void 0;y.e.logData({name:e?"SitePermissionsPanel.EnableHubPermSync":"SitePermissionsPanel.DisableHubPermSync",extraData:{isHubSite:t._pageContext.isHubSite}});(n=t._pageContext.isHubSite?t._hubDataSource.getHubSite(t._pageContext.hubSiteId).then(function(n){return t._hubDataSource.updateHubSite(Object(c.__assign)(Object(c.__assign)({},n),{description:n.description||"",enablePermissionsSync:e}))}):t._siteDataSource.setCanSyncHubSitePermissionsProperty(e))&&n.then(function(){t._fetchHubPermissions()},function(e){t._setState({hubPivotErrorString:t._getErrorString(e),showHubSyncToggleSpinner:!1})})};this._addHubUser=function(e){var n;y.e.logData({name:"SitePermissions.AddHubUser"});if((null===(n=t._params.sitePermissionsPanelContainer.state)||void 0===n?void 0:n.hubVisitorsCount)>=10)t._setState({isOverHubPermSyncLimit:!0});else{t._setState({showHubSyncToggleSpinner:!0});var r=t._hubSiteGroups&&t._hubSiteGroups[0];r&&e&&t._sitePermissionsDataSource.ensureUser(e.userId).then(function(e){return t._sitePermissionsDataSource.addUserToGroup(String(r.id),e.loginName)}).then(function(){t._fetchHubPermissions()},function(e){t._setState({hubPivotErrorString:t._getErrorString(e),showHubSyncToggleSpinner:!1})})}};this._shareSiteOnlyOnClick=function(){y.e.logData({name:"SitePermissions.ShareSiteOnlyClick"});t._setState({showShareSiteOnly:!t._params.sitePermissionsPanelContainer.state.showShareSiteOnly,showSavingSpinner:!1})};this._goToOutlookClick=function(){y.e.logData({name:"SitePermissions.GoToOutlookClick"});t._params.goToOutlookOnClick()};var n=e.pageContext;this._params=e;this._pageContext=n;this._sitePermissionsProvider=new p.e(n);this._sitePermissionsDataSource=new d.e(n);this._sharingSiteProvider=new E.e({pageContext:n});this._hubDataSource=new v.HubDataSource(n);this._siteDataSource=new m.SiteDataSource(n);this._permissionLevelOfCurrentUser=this._getPermissionLevelOfCurrentUser();this._isGroup=Object(h.s)(this._pageContext);this._isHubSitePermSyncEnabled=x.e.isFeatureEnabled(N)&&n.isSiteAdmin}e.prototype.componentDidMount=function(){var e=this;this._fetchUpdatedPermissions();this._getPickerSettings().then(function(){e._params.sitePermissionsPanelContainer.setState({pickerSettings:e._pickerSettings})})};e.prototype.componentWillUnmount=function(){};e.prototype.getRenderProps=function(e,t){var n,r=this._params,i=r.sitePermissionsPanelContainer.state,s=i&&i.hubSite&&i.hubSite.enablePermissionsSync,o=void 0;this._isHubSitePermSyncEnabled&&(o=this._pageContext.isHubSite?s:i&&i.canSyncHubSitePermissions);return{sitePermissions:i&&i.sitePermissions,showShareSiteOnly:!(!i||!i.showShareSiteOnly),showSavingSpinner:!(!i||!i.showSavingSpinner),menuItems:this._getPanelAddMenu(),pageContext:this._pageContext,onSave:this._shareSite,onCancel:this._onCancel,onDismiss:this._onDismiss,saveButton:r.shouldLoadSharePanelOnly?S.F:S.n,advancedPermSettingsUrl:r.advancedPermSettingsUrl,permissionStrings:P,sitePermissionsContextualMenuItems:this._getSitePermissionsContextualMenuItems(),goToOutlookOnClick:r.goToOutlookOnClick,addMemberDefaultPermissionLevel:r.addMemberDefaultPermissionLevel,sitePreviewLoader:r.sitePreviewLoader,shouldDismissPanel:i&&i.shouldDismissPanel,shouldLoadSharePanelOnly:r.shouldLoadSharePanelOnly,onShareSiteCallback:this._shareSiteOnlyOnClick.bind(this),permissionLevelOfCurrentUser:this._permissionLevelOfCurrentUser,isEmailSharingEnabled:r.isEmailSharingEnabled,pickerSettings:i&&i.pickerSettings,hasCustomizedGroups:i&&i.hasCustomizedGroups,lpcModuleLoader:e,lpcModuleCustomWaiter:t,peoplePickerDataSource:r.peoplePickerDataSource,isDefaultPermissionsChanged:i&&i.isDefaultPermissionsChanged,showHubSyncToggleSpinner:i&&i.showHubSyncToggleSpinner,shareSiteErrorMsg:null===(n=i)||void 0===n?void 0:n.shareSiteErrorMsg,showHubPivot:this._isHubSitePermSyncEnabled&&(this._pageContext.isHubSite||s),onSaveHubPermissionSync:this._saveHubPermissionSync,enableHubPermissionsSync:o,isHubSite:this._pageContext.isHubSite,hubSiteTitle:i&&i.hubSite&&i.hubSite.name,hubSyncControlsAreDisabled:i&&i.hubSite&&!this._pageContext.isHubSite&&!i.hubSite.enablePermissionsSync,hubSitePermissions:i&&i.hubSitePermissions,onAddHubUserCallback:this._addHubUser,hubPivotErrorString:i&&i.hubPivotErrorString,isOverHubPermSyncLimit:i&&i.isOverHubPermSyncLimit,hubVisitorsCount:i&&i.hubVisitorsCount,shouldShowInviteButton:T.t.isActivated("85471b0f-ddf2-4b02-8230-8abf823eca41","06/09/2021","check for ibmode to show invite button")||1!==this._pageContext.IBMode}};e.prototype._setState=function(e){this._params.sitePermissionsPanelContainer.setState(e)};e.prototype._fetchUpdatedPermissions=function(){var e=this;this._sitePermissionsProvider.getAssociatedPermissionGroups().then(function(t){e._associatedGroups=t}).then(function(){return e._checkIfDefaultPermissionsChanged(e._associatedGroups)}).then(function(t){e._isDefaultPermissionsChanged=t;t?e._setState({sitePermissions:void 0,menuItems:e._getPanelAddMenu(),isDefaultPermissionsChanged:!0,hasCustomizedGroups:e._hasCustomizedGroups}):e._sitePermissionsProvider.getSiteGroupsAndUsersWithPermissions(e._associatedGroups).then(function(t){if(t&&t.length){for(var n=0,r=t;n<r.length;n++){var i=r[n],s=C[i.roleType];e._permissionGroups[s]=i.id}var o=t.map(function(t){var n=C[t.roleType];return{personas:e._getPersona(t),title:H[n]||"",description:B[n]||"",permLevel:n,permLevelTitle:e._permissionLevelOfCurrentUser!==l.FullControl?"":P[n]||"",emptyGroupText:e._params.emptyGroupText}});e._setState({sitePermissions:o,menuItems:e._getPanelAddMenu(),isDefaultPermissionsChanged:!1,hasCustomizedGroups:e._hasCustomizedGroups})}})});this._fetchHubPermissions()};e.prototype._fetchHubPermissions=function(){var e=this;if(this._isHubSitePermSyncEnabled&&this._pageContext.hubSiteId){this._setState({showHubSyncToggleSpinner:!0});var t,n,r,i,s=[],o=this._hubDataSource.getHubSite(this._pageContext.hubSiteId).then(function(e){t=e});s.push(o);if(!this._pageContext.isHubSite){var u=this._siteDataSource.getCanSyncHubSitePermissionsProperty(!0).then(function(e){n=e});s.push(u)}var a=this._sitePermissionsProvider.getHubSitePermissionGroups().then(function(t){e._hubSiteGroups=t;return e._sitePermissionsProvider.getSiteGroupsAndUsersWithPermissions(t).then(function(t){var n;if(t&&t.length){i=(null===(n=t[0].users)||void 0===n?void 0:n.length)||0;r=t.map(function(t){var n=C[t.roleType];return{personas:e._getPersona(t,!0),title:j[n]||"",permLevel:n,permLevelTitle:P[n]||"",emptyGroupText:e._params.emptyGroupText,hideHeader:!0}})}})});s.push(a);g.n.all(s).then(function(){e._setState({hubSite:t,canSyncHubSitePermissions:n,hubSitePermissions:r,showHubSyncToggleSpinner:!1,hubPivotErrorString:void 0,isOverHubPermSyncLimit:i>10,hubVisitorsCount:i})},function(t){e._setState({hubPivotErrorString:e._getErrorString(t),showHubSyncToggleSpinner:!1})})}};e.prototype._checkIfDefaultPermissionsChanged=function(e){var t=this;if(this._permissionLevelOfCurrentUser===l.FullControl||w.e.hasPermission(this._pageContext.webPermMasks,w.e.managePermissions)){var n=function(e,n){if(t._isGroup)return!1;for(var r=!1,i=!1,s=0,o=n[e.id];s<o.length;s++){var u=o[s],a=A[e.roleType];if(u.id===a)r=!0;else if(u.order<D[e.roleType]||u.order===_){i=!0;break}}return!r||i};return this._sitePermissionsProvider.getRoleAssignments().then(function(r){if(!r)return!1;t._hasCustomizedGroups=Object.keys(r).length>3;for(var i=0,s=e;i<s.length;i++){var o=s[i];if(n(o,r))return!0}return!1}).catch(function(e){return!1})}return g.n.wrap(!1)};e.prototype._getPersona=function(e,t){void 0===t&&(t=!1);var n=[];if(e.users)for(var r=0,i=e.users;r<i.length;r++){var s=i[r],o=this._isGroupLoginName(s.loginName);if("SHAREPOINT\\system"!==s.loginName){var u=this._permissionLevelOfCurrentUser;n.push({name:this._getUserTitle(s),email:s.email,imageUrl:s.urlImage,initialsColor:s.initialsColor,imageInitials:s.imageInitials,groupId:o&&this._parseGroupId(s.loginName),type:o&&2,menuItems:this._isGroupClaimOwner(s.loginName)||u!==l.FullControl&&(u!==l.Edit||C[s.roleType]!==l.Edit)?void 0:this._getUserPermissions(s,e,t)})}}else e.currentUserCannotViewMembers&&n.push({currentUserCannotViewMembers:!0});return n};e.prototype._getUserPermissions=function(e,t,n){var r=this;void 0===n&&(n=!1);var i=[];if(n&&this._pageContext.hubSiteId&&!this._pageContext.isHubSite)return null;if(!n)for(var s=function(t){t.onClick=function(){return r._updatePerm(e,t.permissionLevel)}},o=0,u=i=this._getSitePermissionsContextualMenuItems().filter(function(e){return e.permissionLevel!==C[t.roleType]});o<u.length;o++){s(u[o])}this._isGroupClaim(e.loginName)||i.push({name:S.B,key:"remove",onClick:function(t){return r._removePerm(e)}});return i&&i.length>0?i:void 0};e.prototype._getSitePermissionsContextualMenuItems=function(){var e=this,t=[{name:S.H,key:"read",permissionLevel:l.Read},{name:S.v,key:"full",permissionLevel:l.FullControl},{name:S.h,key:"edit",permissionLevel:l.Edit}];this._permissionLevelOfCurrentUser===l.Edit?t=[t[2]]:this._permissionLevelOfCurrentUser===l.Read&&(t=[t[0]]);return t.filter(function(t){return e._permissionGroups[t.permissionLevel]})};e.prototype._updatePerm=function(e,t){var n=this,r=this._permissionGroups[t];this._sitePermissionsDataSource.addUserToGroup(r,e.loginName).then(function(){n._sitePermissionsDataSource.removeFromGroupById(e.principalId.toString(),e.id.toString()).then(function(){n._fetchUpdatedPermissions()})});y.e.logData({name:"SitePermissionsPanel.UpdatePermTo"+l[t]})};e.prototype._removePerm=function(e){var t=this;this._sitePermissionsDataSource.removeFromGroupById(e.principalId.toString(),e.id.toString()).then(function(){t._fetchUpdatedPermissions()})};e.prototype._getUserTitle=function(e){return this._isGroupClaim(e.loginName)?this._isGroupClaimOwner(e.loginName)?b.format(S.b,this._pageContext.webTitle):b.format(S.y,this._pageContext.webTitle):e.title};e.prototype._isGroupLoginName=function(e){return e&&-1!==e.indexOf("federateddirectoryclaimprovider")};e.prototype._isGroupClaim=function(e){return this._isGroupLoginName(e)&&-1!==e.indexOf(this._pageContext.groupId)};e.prototype._isGroupClaimOwner=function(e){return this._isGroupClaim(e)&&-1!==e.indexOf("_o")};e.prototype._parseGroupId=function(e){var t;if(this._isGroupClaim(e))t=this._pageContext.groupId;else if(this._isGroupLoginName(e)){var n=e.indexOf("federateddirectoryclaimprovider")+"federateddirectoryclaimprovider".length+1;t=e.substring(n,n+36)}return t};e.prototype._getPanelAddMenu=function(){var e=[];this._isGroup&&e.push({name:S.r,key:"addToGroup",onClick:this._goToOutlookClick,className:"SitePermissionsPanel-addToGroup"});this._isDefaultPermissionsChanged||e.push({name:S.q,key:"shareSiteOnly",onClick:this._shareSiteOnlyOnClick,className:"SitePermissionsPanel-shareSiteOnly"});return e.length>0?e:void 0};e.prototype._getPermissionLevelOfCurrentUser=function(){var e=this._pageContext.webPermMasks;return w.e.hasPermission(e,w.e.manageWeb)?l.FullControl:w.e.hasPermission(e,w.e.editListItems)?l.Edit:w.e.hasPermission(e,w.e.viewPages)?l.Read:void 0};e.prototype._assignUsersToPermssionGroup=function(e){for(var t,n=((t={})[l.FullControl]=[],t[l.Edit]=[],t[l.Read]=[],t),r=0,i=e;r<i.length;r++){var s=i[r],o=this._params.addMemberDefaultPermissionLevel,u=this._getSitePermissionsContextualMenuItems().map(function(e){return e.permissionLevel}),a=s.permissionLevel;a||(a=o&&this._permissionGroups[o]&&u.indexOf(o)>-1?o:this._permissionGroups[l.Edit]&&u.indexOf(l.Edit)>-1?l.Edit:this._permissionGroups[l.Read]&&u.indexOf(l.Read)>-1?l.Read:l.FullControl);n[a]&&n[a].push(s)}return n};e.prototype._getPickerSettings=function(){var e=this;return this._sharingSiteProvider.getSharingSettings().then(function(t){e._pickerSettings=t.pickerProperties}).catch(function(t){e._pickerSettings=void 0})};e.prototype._getErrorString=function(e){return e&&e.message?String(e.message.value||e.message):S.m};e.prototype._getShareSiteErrorMsg=function(e){var t;return(null===(t=e)||void 0===t?void 0:t.errorMessage)?e.errorMessage:S.g};return e})();t.t=F},3803:function(e,t,n){"use strict";n.d(t,"e",function(){return u});var r=n(0),i=n("react-lib"),s=n(24),o=n(40),u=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._handleOnClick=function(e){r.props.logoOnClick&&r.props.logoOnClick(e)};r._imgLoadHandler=function(){r.setState({imageLoaded:!0})};r._imgLoadErrorHandler=function(){r.setState({imageError:!0})};r.state={imageLoaded:!1};return r}t.prototype.UNSAFE_componentWillReceiveProps=function(e){e.siteLogoUrl!==this.props.siteLogoUrl&&this.setState({imageLoaded:!1})};t.prototype.render=function(){return i.createElement("div",null,this.renderSiteLogo(this.props?this.props.siteLogoUrl:null))};t.prototype.renderSiteLogo=function(e){var t;if(this.props){e&&!this.state.imageError&&(t=i.createElement("img",{role:"presentation","aria-hidden":"true",src:e,onLoad:this._imgLoadHandler,onError:this._imgLoadErrorHandler,style:{display:this.state.imageLoaded?void 0:"none"}}));!this.props.siteAcronym||e&&!this.state.imageError||(t=i.createElement("div",null,i.createElement("div",{role:"presentation","aria-hidden":"true",className:"ms-siteLogoAcronym ms-font-xxl",style:this._addOverrideStyle({backgroundColor:this.props.siteLogoBgColor,display:this.state.imageLoaded?"none":void 0},!0,!0)},this.props.siteAcronym),t))}var n=!this.state.imageLoaded&&!this.props.disableSiteLogoFallback,r=this.props,u=r.logoHref,a=r.siteTitle,f=i.createElement(u?"a":"div",{className:Object(o.e)("ms-siteLogo-defaultLogo",n&&Object(s.L)("Group")),onClick:this._handleOnClick,href:u,style:this._addOverrideStyle(void 0,!0),"aria-label":a},i.createElement("div",{className:"ms-siteLogo-actual"},t));return i.createElement("div",{className:"ms-siteLogoContainerOuter",style:this._addOverrideStyle()},i.createElement("div",{className:"ms-siteLogoContainerInner",style:this._addOverrideStyle()},f))};t.prototype._addOverrideStyle=function(e,t,n){var r=this.props,i=r.size,s=r.roundedCorners;if(i){var o=i.toString()+"px";e=this._addPropToStyleObj(e,"width",o);e=this._addPropToStyleObj(e,"height",o);if(t){var u=n?Math.round(i/3):i;e=this._addPropToStyleObj(e,"fontSize",u.toString()+"px")}}if(s){var a=i?(i/2).toString()+"px":"15px";e=this._addPropToStyleObj(e,"borderRadius",a)}return e};t.prototype._addPropToStyleObj=function(e,t,n){(e=e||{})[t]=n;return e};return t})(i.Component)},3806:function(e,t,n){"use strict";n.d(t,"e",function(){return g});var r=n(0),i=n("react-lib"),s=n(2679),o=n(1616),u=n(1115),a=n(1617),f=n(395),l=n(2244),c=n(4263),h=n(2694),p=n(2999),d=n(18),v=n(40),m=n(67),g=(function(e){Object(r.__extends)(t,e);function t(t){var n,r=e.call(this,t)||this;r._focusOnElement=function(){r._shouldRestoreFocusWhenExitMUIEditing&&r._defaultTextField&&r._defaultTextField.current&&r._defaultTextField.current.focus()};r._IsRequiredFields=function(e){return 0===e&&!r.props.defaultLanguageIsOptional};r._insertMetaData=function(e){var t=d.format(c.e,p.e.getResourceByCode(r._webLanguage)||"");return e.map(function(e){return{code:e.code,language:e.code===r._webLanguage?t:e.language||"",value:e.code===r.props.currentLCID?r.props.currentDisplay:e.value}})};r._onChange=function(e){return function(t,n){var i=r.state.translations.map(function(t,r){e===r&&(t.value=n||"");return t});r.props.textUpdateCallback&&r.props.textUpdateCallback(i);r.setState({translations:i,errorState:r._validateErrorState(i)})}};r._handleSaveClick=function(){r.props.onSaveClick&&r.props.onSaveClick(r.state.translations)};r._handleCancelClick=function(){r.props.onCancelClick&&r.props.onCancelClick()};r._validateErrorState=function(e){if(e&&0!==e.length&&(m.t.isActivated("3997930c-2770-4c54-8a47-7aea575aaf97","3/2/2021","Do not dispaly error message for required field")||r._IsRequiredFields(0))&&!r.props.multilineInput)return 0===e[0].value.trim().length?c.t:void 0};r._webLanguage=null===(n=r.props.pageContext)||void 0===n?void 0:n.webLanguage;var s=t.translations?r._insertMetaData(t.translations):void 0;r.state={errorState:s?r._validateErrorState(s):void 0,translations:s||void 0};r._defaultTextField=i.createRef();r._shouldRestoreFocusWhenExitMUIEditing=!m.t.isActivated("cfd5602d-6f38-4a39-a4b6-cc059465c60a","6/15/2021","restore focus to link after existing MUI Editing");return r}t.prototype.componentDidMount=function(){var e=this;if(this.state.translations&&0!==this.state.translations.length)setTimeout(function(){e._focusOnElement()},50);else{var t=new l.t(this.props.pageContext);switch(this.props.dataSourceType){case l.e.ExistingNavNode:case l.e.SiteTitle:case l.e.SiteDescription:t.getTranslations(this.props.dataSourceType,this.props.navNodeId).then(function(t){e.setState({translations:e._insertMetaData(t)},function(){e._focusOnElement()})});break;case l.e.NewNavNode:t.getAllSupportedLanguages().then(function(t){e.setState({translations:e._insertMetaData(t)},function(){e._focusOnElement()})})}}};t.prototype.render=function(){var e=this;return this.state.translations?i.createElement("div",null,i.createElement("div",{className:Object(v.e)("ms-MultilingualInputs-Links",this.props.contentClassNames),"data-automationid":"MultilingualInputs-Inner"},this.state.translations.map(function(t,n){return i.createElement(s.e,{componentRef:0===n?e._defaultTextField:void 0,key:"MUIEditing_"+t.language,id:"MUIEditing_TextField_"+n,className:"ms-MultilingualInputs-Link",label:t.language,multiline:e.props.multilineInput,value:t.value,required:e._IsRequiredFields(n),"aria-required":e._IsRequiredFields(n),onChange:e._onChange(n),styles:{root:{marginRight:"6px"}},errorMessage:0===n&&e.state.errorState})})),i.createElement("div",{className:"ms-MultilingualInputs-ButtonArea"},i.createElement(o.e,{className:"ms-MultilingualInputs-SaveButton",onClick:this._handleSaveClick,disabled:!!this.state.errorState,"data-automationid":"MultilingualInputs-SaveTranslation"},h.c),i.createElement(u.e,{className:"ms-MultilingualInputs-CancelButton",onClick:this._handleCancelClick,"data-automationid":"MultilingualInputs-CancelTranslation"},h.h))):i.createElement(a.e,{styles:{root:{marginTop:"50vh"}},ariaLabel:c.n,size:f.e.large})};return t})(i.Component)},4271:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r;(function(e){e[e.center=0]="center";e[e.left=1]="left"})(r||(r={}))},4929:function(e,t,n){"use strict";n.r(t);n.d(t,"HorizontalNav",function(){return R});var r,i=n(693),s=n(0),o=n(4251),u=n("react-lib"),a=n(67),f=n(1623),l=n(321),c=n(91),h=n(40),p=n(536),d=n(965),v=n(457),m=n(121),g=n(1555),y=n(1424),b=n(537),w=n(185),E=n(377),S=n(481),x=n(1633),T=n(98),N=n(24),C=n(18),k=n(1007),L=n(84),A=n(44),O=n(163),M=n(554),_=n(620),D=Object(E.e)();(function(e){e[e.KeyPress=0]="KeyPress";e[e.Hover=1]="Hover";e[e.Click=2]="Click"})(r||(r={}));var P;function H(e){return e.key+e.name+e.url}var B,j=(function(e){Object(s.__extends)(t,e);function t(n,r){var i=e.call(this,n,r)||this;i._horizontalNavItemsRef={};i._boundItemClick={};i._boundMainItemHover={};i._isPreventSetStateKsActivated=a.t.isActivated("053d44d4-27d0-4713-b578-00f3bb0005c1","05/14/2021","Prevent setState on hover");i._renderShimmer=function(e,n){var r=e&&e.data;i._asyncFetch(r);return i._getDeferredShimmer({customElementsGroup:i._getOneLeveOndemandElements(),width:t.MENU_WIDTH})};i._getOneLeveOndemandElements=function(){var e={type:3,width:t.MENU_ITEM_SIDE_MARGIN,height:t.MENU_ITEM_HEIGHT};return i._getDeferredShimmerElementsGroup({flexWrap:!0,shimmerElements:[e,{type:1,width:t.MENU_WIDTH-2*t.MENU_ITEM_SIDE_MARGIN,height:10},e,e,{type:1,width:t.MENU_WIDTH-2*t.MENU_ITEM_SIDE_MARGIN,height:10},e]})};i._onOverflowClick=function(e){if(i.state.contextMenuItems||"overflow"===i.state.lastTriggeringItem){i._onNavMenuDismiss();i.setState({lastTriggeringItem:null})}else i.setState({contextMenuItems:i.state.overflowItems,contextMenuRef:e.currentTarget,lastTriggeringItem:"overflow"})};i._onEditClick=function(e){i.props.editLink.onClick(e);i.setState({isEditMode:!0})};i._onMouseLeave=function(){i._async.clearTimeout(i._navItemHoverTimerId)};i._closeMegaMenu=function(e){i._useMegaMenu&&0!==i.state.lastTriggeringAction&&i._onNavMenuDismiss()};i._onNavMenuDismiss=function(e){if(e&&e.relatedTarget&&i._horizontalNavRegion.contains(e.relatedTarget)){e.stopPropagation();e.preventDefault()}else(!i._isPreventSetStateKsActivated&&i.state.contextMenuItems&&i.state.contextMenuItems.length||i._isPreventSetStateKsActivated)&&i.setState({contextMenuItems:null})};i._instanceIdPrefix=Object(S.e)("HorizontalNav");a.t.isActivated("fcf17a35-9f5b-41a0-a61c-012617651178","2020-08-17","Fire post-message for sub-links for in-place nav")||(i._inPlaceNavEnabled=i.props.inplaceNavigationEnabled);i._getItemHoverMegaMenuCallback=Object(c.t)(function(e){return function(t){i._onMainItemHoverMegaMenu(e,t)}});i._getItemHoverCallback=Object(c.t)(function(e){return function(t){i._onMainItemHover(e,t)}});i._getItemClickCallback=Object(c.t)(function(e){return function(t){i._onItemClick(e,t)}});i._getKeyPressCallback=Object(c.t)(function(e){return function(t){i._handleKeyPress(e,t)}});i._getAnchorClickCallback=Object(c.t)(function(e){return function(t){i._onAnchorClick(e,t)}});if(i._isAudienceTargeted()){i.state=i._getStateFromProps(Object(s.__assign)(Object(s.__assign)({},i.props),{items:[]}));i._applyInitialAudienceTargeting()}else i.state=i._getStateFromProps(i.props);i._editLinkWidth=-1;i._resolvedElement=function(e){return function(t){return i._horizontalNavItemsRef[e]=t}};Object(w.t)();i._foundSelectedLink=!1;i._qosEvent=new L.e({name:"HorizontalNav"});return i}t._isHeader=function(e){return!e||e===k.t};t.prototype.componentDidMount=function(){var e=this;if(!a.t.isActivated("47EA3EB5-5EC0-4AA0-8B94-43A80997C5E0","9/1/2020","ResizeObserver for HorizontalNavBase")&&"function"==typeof ResizeObserver&&this._horizontalNavRegion){this._resizeObserver=new ResizeObserver(function(){e.measureLayout()});this._resizeObserver.observe(this._horizontalNavRegion)}else{if(!this._isAudienceTargeted()||(this.state.items||[]).length>0){this._updateItemMeasurements();this._updateRenderedItems()}this._events.on(window,"resize",this._updateRenderedItems)}this.props.onRendered&&this.props.onRendered(!0);this._isMounted=!0;this._qosEvent.end({resultType:A.e.Success});this._events.on(window,t.SUBMENU_OPEN_EVENT,this._onNavMenuDismiss);this._events.on(document,"mouseleave",this._closeMegaMenu);var n=document.getElementById("SuiteNavWrapper");n&&this._events.on(n,"mouseenter",this._closeMegaMenu);if(!this._isMegaMenuTopPlaceholderKSActive()){var r=document.getElementById("spTopPlaceholder");r&&this._events.on(r,"mouseenter",this._closeMegaMenu)}};t.prototype.componentWillUnmount=function(){this._isMounted=!1;this._resizeObserver&&this._resizeObserver.disconnect()};t.prototype.UNSAFE_componentWillReceiveProps=function(e){var t=this._hasItemWidthChanged(this.props.items||[],e.items||[]),n=this._hasItemWidthChanged(this.props.overflowItems||[],e.overflowItems||[]);if(t){this._navItemWidths=void 0;this._navItemMargin=void 0}(t||n||this.state.isEditMode&&this.state.isEditMode!==e.isEditMode||this.props.isEditMode!==e.isEditMode)&&this.setState(this._getStateFromProps(e))};t.prototype.componentDidUpdate=function(e,t){var n=this.state.overflowItems,r=t.overflowItems;if(!this._navItemWidths&&!this.state.isEditMode||n&&(!r||r.length!==n.length)||t.isEditMode&&t.isEditMode!==this.state.isEditMode){this._updateItemMeasurements();this._updateRenderedItems()}this.props.onRendered&&this.props.onRendered(!1)};t.prototype.render=function(){var e=this.props,t=e.styles,n=void 0===t?this.props.getStyles:t,r=e.theme;this._classNames=D(n,{theme:r});var i=this.state.contextMenuItems,s=this._useMegaMenu&&"overflow"!==this.state.lastTriggeringItem;this._foundSelectedLink=!1;var o=void 0;i&&(o=s?this._getDeferredMegaMenu(this._getMegaMenuProps(i)):u.createElement(x.e,{settings:{theme:Object(N._)()}},this._getDeferredContextualMenu(this._getContextualMenuProps(i))));var a=this.props.skipRole?void 0:"navigation";return u.createElement("div",{className:this._classNames.root,onMouseLeave:"overflow"!==this.state.lastTriggeringItem&&this._useMegaMenu?this._closeMegaMenu:void 0,ref:this._resolveRef("_horizontalNavRegion"),role:a,"aria-label":this.props.ariaLabel},u.createElement(f.e,{direction:l.e.horizontal},u.createElement("div",{className:"ms-HorizontalNavItems",role:"menubar"},this._renderHorizontalNavItems(s&&o),this._renderOverflow(),this._renderEditLink())),!s&&i&&o)};t.prototype._asyncFetch=function(e){var t=this;if(!parent)return Promise.resolve();new g.e(this.props.pageContext,"GlobalNavigationSwitchableProvider").getMenuState({useCache:!0,depth:1,menuNodeKey:e}).then(function(n){a.t.isActivated("1cd2d1c9-fdc8-4110-a71e-e8125063dd90","2020-09-01","Refine the audience targeting logging")&&!n||!n.links||t._UpdateRenderedItemsWithSubmenuItems(e,n.links)},function(){t._qosEvent.verbose("HorizontalNav: FetchGlobalNavFailed")})};Object.defineProperty(t.prototype,"_useMegaMenu",{get:function(){var e=!1;this.props.ignoreChromeOptions||void 0===this.props.chromeOptions?e=this.props.useMegaMenu:this.props.chromeOptions&&(e=this.props.chromeOptions.nav.megaMenuEnabled);return e},enumerable:!0,configurable:!0});t.prototype._getDeferredContextualMenu=function(e){var t={modulePath:"office-ui-fabric-react/lib/ContextualMenu",moduleLoader:{load:function(){return n.ee([583],365).then(function(e){return e.ContextualMenu})}},props:e};return u.createElement(v.e,Object(s.__assign)({},t))};t.prototype._getDeferredMegaMenu=function(e){var t={modulePath:"../MegaMenu/MegaMenuCallout",moduleLoader:{load:function(){return n.ee([712],2206).then(function(e){return e.MegaMenuCallout})}},props:e};return u.createElement(v.e,Object(s.__assign)({},t))};t.prototype._getDeferredShimmer=function(e){var t={modulePath:"office-ui-fabric-react/lib/Shimmer",moduleLoader:{load:function(){return n.ee(66,1526).then(function(e){return e.Shimmer})}},props:e};return u.createElement(v.e,Object(s.__assign)({},t))};t.prototype._getDeferredShimmerElementsGroup=function(e){var t={modulePath:"office-ui-fabric-react/lib/Shimmer",moduleLoader:{load:function(){return n.ee(66,1526).then(function(e){return e.ShimmerElementsGroup})}},props:e};return u.createElement(v.e,Object(s.__assign)({},t))};t.prototype._getContextualMenuProps=function(e){return{className:"ms-HorizontalNav",labelElementId:this._instanceIdPrefix+"overflow",items:this._getContextualItemProps(e),target:this.state.contextMenuRef,onDismiss:this._onNavMenuDismiss,gapSpace:10,isBeakVisible:!1,directionalHint:m.e.bottomLeftEdge,shouldFocusOnMount:!0}};t.prototype._getMegaMenuProps=function(e){var t=this;return{layoutProps:{maxColumnCount:4,showDivider:!0,gridSpacingFromEdge:8,enforceGridWidth:!0},onDismiss:this._onNavMenuDismiss,onItemClick:this._onNavMenuDismiss,target:this.state.contextMenuRef,shouldFocusOnMount:0===this.state.lastTriggeringAction,pageContext:this.props.pageContext,theme:Object(N._)(),sections:e.map(function(e){return{heading:{name:e.name,url:e.url,target:e.target,onClick:e.onClick},items:e.links&&t._getContextualItemProps(e.links),theme:Object(N._)()}}),navigationSource:this.props.navigationSource}};t.prototype.measureLayout=function(){this._updateItemMeasurements();this._updateRenderedItems()};t.prototype._getContextualItemProps=function(e,n){var r=this;void 0===n&&(n=0);return e.filter(function(e){return!!e&&"1033"!==e.key}).map(function(e){var i,s=F(e),o=(function(e){return!!e&&e.hasChildLinks})(e),u=[];o&&u.push({key:"shimmerItem",text:"shimmer",data:e.key,onRender:r._renderShimmer});var a=g.e.shouldLinkOpenInSameWindow(e.url)?"_self":"_blank",f=e.onClick?function(t){e.onClick(t,e);if(!r._isLinkPropagateKSActive())return!0}:function(e){if(!r._isLinkPropagateKSActive())return!0};i={key:H(e),name:e.name,split:s||o,target:a,href:s||o||t._isHeader(e.url)?void 0:e.url,onClick:f,subMenuProps:s?{items:r._getContextualItemProps(e.links,n+1)}:o?{items:u}:void 0};!s&&!o||t._isHeader(e.url)||(i.onClick=function(){if(r._inPlaceNavEnabled)window.postMessage("router://"+e.url,window.location.origin);else{window.open(e.url,a);e.forceAnchor&&e.onClick&&e.onClick()}});return i})};t.prototype._renderHorizontalNavItems=function(e){var t=this,n=this.state.renderedItems;if(n&&0!==n.length)return n.map(function(n){var r,i=H(n),s=t._useMegaMenu?t._reuseMainHoverKSActive()?t._getItemHoverMegaMenuCallback(n):t._getItemHoverCallback(n):t._boundMainItemHover[i]||t._getItemHoverCallback(n),o=t._useMegaMenu?t._onNavMenuDismiss:t._onMouseLeave,a=C.format(t.props.splitButtonAriaLabel,n.name);(r=!!t.props.hasSelectedState&&(!t._foundSelectedLink&&t._isLinkSelected(n)))&&(t._foundSelectedLink=!0);return u.createElement("span",{className:"ms-HorizontalNavItem","data-automationid":"HorizontalNav-link",key:i,ref:t._resolvedElement(i),onMouseEnter:s,onMouseLeave:o},t._shouldRenderAsAnchor(n)?t._renderAnchorLink(n,i,r):t._renderButtonLink(n,i,r),F(n)?u.createElement("button",{className:Object(h.e)("ms-HorizontalNavItem-splitbutton ms-HorizontalNavItem-splitbutton-width",t._classNames.splitButton),onClick:t._getItemClickCallback(n),"aria-label":a,"aria-expanded":!!t.state.contextMenuItems,onKeyDown:t._getKeyPressCallback(n),role:"menuitem"},u.createElement(b.e,{iconName:"ChevronDownMed",className:Object(h.e)("ms-HorizontalNav-chevronDown",t._classNames.chevron)})):null,t.state.contextMenuItems===n.links&&e)})};t.prototype._renderAnchorLink=function(e,t,n){return u.createElement("a",{className:Object(h.e)("ms-HorizontalNavItem-link",{"is-selected":n},{"is-not-selected":!n},this._classNames.link,n?this._classNames.linkSelected:this._classNames.linkUnselected),href:e.url,"aria-label":e.ariaLabel,onKeyDown:this._getKeyPressCallback(e),onClick:e.onClick?this._boundItemClick[t]:void 0,target:g.e.shouldLinkOpenInSameWindow(e.url)?"_self":"_blank",rel:"noopener","aria-current":n?"page":void 0,"data-navigationcomponent":Object(M.t)(this.props.navigationSource)},e.name)};t.prototype._shouldRenderAsAnchor=function(e){return(e.forceAnchor||void 0===e.forceAnchor)&&!t._isHeader(e.url)};t.prototype._renderButtonLink=function(e,n,r){var i=t._isHeader(e.url);return u.createElement("button",{className:Object(h.e)("ms-HorizontalNavItem-link",{"is-selected":r},{"is-header":i},this._classNames.link,r?this._classNames.linkSelected:this._classNames.linkUnselected),"aria-label":e.ariaLabel,onClick:this._boundItemClick[n]||this._getItemClickCallback(e),onKeyDown:this._getKeyPressCallback(e),"aria-haspopup":F(e),disabled:i,"aria-current":"page","data-navigationcomponent":Object(M.t)(this.props.navigationSource)},e.name)};t.prototype._renderOverflow=function(){var e=this.state,t=e.overflowItems,n=e.lastTriggeringItem,r=this.props.moreOptionsAriaLabel||_.n;return t&&t.length?u.createElement("div",{className:"ms-HorizontalNavItem",key:"overflow",ref:this._resolveRef("_overflowElementRef"),"data-automationid":"HorizontalNav-overflow"},u.createElement("button",{id:this._instanceIdPrefix+"overflow","aria-label":r,className:Object(h.e)("ms-HorizontalNavItem-link",this._classNames.link,this._classNames.overflowButton),onClick:this._onOverflowClick,"aria-haspopup":!0,"aria-expanded":"overflow"===n,onKeyDown:this._getKeyPressCallback("overflow"),role:"menuitem"},u.createElement(b.e,{iconName:"More",className:"ms-HorizontalNavItem-overflow"}))):null};t.prototype._renderEditLink=function(){var e=this.props,t=e.editLink,n=e.isEditMode,r="portals"===window.teamsCustomAppType;return!t||n||r?null:u.createElement("div",{className:"ms-HorizontalNavItem",ref:this._resolveRef("_editLinkElementRef"),"data-automationid":"HorizontalNav-edit"},u.createElement("button",{id:this._instanceIdPrefix+"EditLink",className:Object(h.e)("ms-HorizontalNavItem-link",this._classNames.link,this._classNames.editButton),onClick:this._onEditClick,"aria-label":t.ariaLabel?t.ariaLabel:t.name},t.name))};t.prototype._updateItemMeasurements=function(){this._currentOverflowWidth=this._overflowElementRef||this.props.overflowItems&&this.props.overflowItems.length?32.67:0;-1===this._editLinkWidth&&this.props.editLink&&this._editLinkElementRef&&(this._editLinkWidth=this._getElementWidth(this._editLinkElementRef,this._getElementMargin(this._editLinkElementRef)));this._navItemWidths||(this._navItemWidths={});for(var e=0,t=this.state.items;e<t.length;e++){var n=H(t[e]),r=this._horizontalNavItemsRef[n];void 0===this._navItemMargin&&(this._navItemMargin=this._getElementMargin(r));this._navItemWidths[n]||(this._navItemWidths[n]=this._getElementWidth(r,this._navItemMargin))}};t.prototype._getElementWidth=function(e,t){return e?e.getBoundingClientRect().width+t:0};t.prototype._getElementMargin=function(e){return parseInt(Object(p.e)()?window.getComputedStyle(e).marginLeft:window.getComputedStyle(e).marginRight,10)};t.prototype._updateRenderedItems=function(){this._horizontalNavRegion&&this._UpdateRenderedItemsCore(this.state.items)};t.prototype._UpdateRenderedItemsCore=function(e){for(var t=Object(s.__spreadArrays)(e),n=this._horizontalNavRegion.clientWidth-this._currentOverflowWidth-this._editLinkWidth,r=this.props.overflowItems||[],i=0,o=!1,u=0;u<t.length;u++){var a=H(t[u]),f=this._navItemWidths[a];if(i+f>=n){u>0&&0===r.length&&n-i<32.67&&u--;r=t.splice(u).concat(r);o=!0;break}i+=f}!o&&this.state.overflowItems.length>0&&(o=!0);o&&this.setState({renderedItems:t,overflowItems:r})};t.prototype._UpdateRenderedItemsWithSubmenuItems=function(e,t){var n=this.state.items;this._InsertItemsWithSubmenuItems(n,e,t);this._UpdateRenderedItemsCore(n)};t.prototype._InsertItemsWithSubmenuItems=function(e,t,n){if(!e||!parent||!n)return!1;for(var r=!1,i=0;i<e.length;i++){if(e[i].key===t){e[i].links=n;r=!0;break}if(e[i].links&&e[i].links.length>0&&this._InsertItemsWithSubmenuItems(e[i].links,t,n)){r=!0;break}}return r};t.prototype._onAnchorClick=function(e,t){this._foundSelectedLink=!1;e.onClick&&e.onClick(t,e)};t.prototype._onItemClick=function(e,n){this._foundSelectedLink=!1;this._navItemHoverTimerId&&this._async.clearTimeout(this._navItemHoverTimerId);n.stopPropagation();n.preventDefault();if(this.state.contextMenuItems||this.state.lastTriggeringItem===e){this.setState({lastTriggeringItem:null});this._onNavMenuDismiss()}else"I"!==n.target.tagName?e.onClick?e.onClick(n,e):t._isHeader(e.url)||window.open(e.url,g.e.shouldLinkOpenInSameWindow(e.url)?"_self":"_blank"):this._openSubMenu(e.links,n.currentTarget,e,2)};t.prototype._onMainItemHover=function(e,n){var r=this;t._isHeader(e.url)||(window.status=e.url);n.stopPropagation();n.preventDefault();var i=n.currentTarget;F(e)&&(this._navItemHoverTimerId=this._async.setTimeout(function(){if(r.state.contextMenuItems!==e.links){r.state.contextMenuItems&&r._onNavMenuDismiss();r._openSubMenu(e.links,i,e,1)}},!this._reuseMainHoverKSActive()&&this._useMegaMenu?50:500))};t.prototype._onMainItemHoverMegaMenu=function(e,n){t._isHeader(e.url)||(window.status=e.url);n.stopPropagation();n.preventDefault();if(F(e)&&this.state.contextMenuItems!==e.links){this.state.contextMenuItems&&this._onNavMenuDismiss();this._openSubMenu(e.links,n.currentTarget,e,1)}else F(e)||this._onNavMenuDismiss()};t.prototype._handleKeyPress=function(e,t){if(32===t.which||40===t.which||13===t.which&&t.target&&-1!==t.target.className.indexOf("ms-HorizontalNavItem-splitbutton")){t.stopPropagation();t.preventDefault();"overflow"===e?this._openSubMenu(this.state.overflowItems,t.target,e,0):this._openSubMenu(e.links,t.target,e,0)}};t.prototype._openSubMenu=function(e,n,r,i){T.e.raise(window,t.SUBMENU_OPEN_EVENT);if(-1!==n.className.indexOf("ms-HorizontalNavItem-splitbutton")||"i"===n.tagName&&"overflow"!==r){for(var s=n;s&&"span"!==s.tagName.toLowerCase();)s=s.parentElement;s&&s.children&&s.children.length>0&&(n=s.children[0])}this.setState({lastTriggeringItem:r,contextMenuItems:e,contextMenuRef:n,lastTriggeringAction:i})};t.prototype._isAudienceTargeted=function(){if(!this.props||!this.props.pageContext)return!1;var e=new g.e(this.props.pageContext,"GlobalNavigationSwitchableProvider");return this.props.pageContext&&this.props.isAudienceTargeted&&e.isNavAudienceTargetedEnabled()};t.prototype._applyInitialAudienceTargeting=function(){var e=this;y.e.getInstance(this.props.pageContext).getCurrentUserMemberships("SiteNav").then(function(t){e._audienceMemberships=t;if(a.t.isActivated("0123f94e-245a-4fca-a866-b5ebd969abe9","2020-08-06","Refine audience targeting logging for header nav"))e._isMounted?e.setState(e._getStateFromProps(e.props)):e.state=e._getStateFromProps(e.props);else{var n=e._getStateFromProps(e.props);e._isMounted?e.setState(n):e.state=n;O.e.logData({name:"SiteNav.Render",extraData:{audienceTargetingEnabled:!0,audienceTargetingProvided:y.e.containsAudienceTargetedNode(e.props.items),audienceTargetingAffected:g.e.checkIfLinksAffected(e.props.items,n.items)}})}}).catch(function(){e.setState(e._getStateFromProps(e.props))})};t.prototype._getStateFromProps=function(e){var t=e.overflowItems,n=e.isEditMode,r=this._isAudienceTargeted()?y.e.filterLinksWithMemberships(e.items,this._audienceMemberships):e.items;this._boundItemClick={};this._boundMainItemHover={};for(var i=0,s=r=r||[];i<s.length;i++){var o=s[i],u=H(o);this._boundItemClick[u]=this._shouldRenderAsAnchor(o)?this._getAnchorClickCallback(o):this._getItemClickCallback(o);this._boundMainItemHover[u]=this._getItemHoverCallback(o)}return{renderedItems:r,overflowItems:t||[],contextMenuItems:null,isEditMode:n,selectedKey:void 0,items:r}};t.prototype._isLinkSelected=function(e){B=this.props.selectedKey||this.state.selectedKey;return q(e)};t.prototype._hasItemWidthChanged=function(e,t){return e.length!==t.length||e.map(function(e,n){var r=t[n];if(e.name!==r.name)return!0;if(e.links||r.links){if((e.links||[]).length!==(r.links||[]).length)return!0;for(var i=0;i<e.links.length;i++)if(e.links[i].name!==r.links[i].name)return!0;return!1}return!1}).reduce(function(e,t){return e||t},!1)};t.prototype._isLinkPropagateKSActive=function(){return a.t.isActivated("ce44885f-f77b-48b2-8391-af0256fb0a0f","8/12/2020","allow link propagation for ContextualMenu links")};t.prototype._isMegaMenuTopPlaceholderKSActive=function(){return a.t.isActivated("575f60b2-1ef4-4ce7-8494-b4bfdf0390b9","3/24/2021","close the MegaMenu when mousing over the top placeholder for custom extensions")};t.prototype._reuseMainHoverKSActive=function(){return a.t.isActivated("374c3fa4-7439-4e31-af03-0ec0ecf7104f","04/14/21","reuse main menu hover")};t.SUBMENU_OPEN_EVENT="submenu_open";t.MENU_WIDTH=200;t.MENU_ITEM_SIDE_MARGIN=8;t.MENU_ITEM_HEIGHT=32;return t})(d.e);function F(e){return!!(e&&e.links&&e.links.length)}function I(e){return e.key===B||!!F(e)&&e.links.some(I)}function q(e){if(void 0!==B)return I(e);if("undefined"==typeof window)return!1;if(j._isHeader(e.url))return!!F(e)&&e.links.some(q);(P=P||document.createElement("a")).href=e.url||"";var t=P.href.toLowerCase(),n=(t+"/SitePages/Home.aspx").toLowerCase(),r=location.href.toLowerCase();if(r===t||r===n)return!0;var i=(location.protocol+"//"+location.host+location.pathname).toLowerCase();if(i===t||i===n)return!0;if(location.hash){if(location.hash===e.url)return!0;P.href=location.hash.substring(1);if(P.href===t)return!0}if(!a.t.isActivated("85768861-c670-4b56-baaa-7ff73af906cb","2021-07-01","match spRedirectedFromUrl for _isLinkSelected")&&history&&history.state&&history.state.spRedirectedFromUrl){P.href=history.state.spRedirectedFromUrl.toLowerCase();if(P.href===t||P.href===n)return!0}return!!F(e)&&e.links.some(q)}var R=Object(i.e)(j,function(e){var t=e.theme,n=t.palette,r=t.semanticColors;return{root:"ms-HorizontalNav",link:[Object(s.__assign)(Object(s.__assign)({color:r.bodySubtext},t.fonts.small),{selectors:{":hover":{color:n.themePrimary},"&.is-header":{cursor:"auto",color:r.bodySubtext}}})],linkUnselected:{border:"none"},linkSelected:Object(s.__assign)({color:r.bodyText,borderBottom:"2px solid "+n.themePrimary},Object(o.e)(t).semibold),splitButton:{selectors:{":hover":{color:n.themePrimary}}},chevron:{color:r.bodySubtext},editButton:["ms-HorizontalNavItem-Edit",{border:"none",color:n.themePrimary,selectors:{":hover":{color:n.themeDarker,textDecoration:"underline"}}}],overflowButton:{border:"none"}}})},5041:function(e,t,n){"use strict";n.d(t,"e",function(){return S});var r=n(0),i=n("react-lib"),s=n(1122),o=n(690),u=n(537),a=n(103),f=n(783),l=n(1623),c=n(321),h=n(112),p=n(40),d=n(4271),v=n(4630),m=n(67),g=n(4265),y=n.n(g),b=n(4270),w={x:50,y:50},E={image:{height:64,background:"linear-gradient(45deg, #d2d0ce 25%, transparent 25%, transparent 75%, #d2d0ce 75%, #d2d0ce 0), linear-gradient(45deg, #d2d0ce 25%, transparent 25%, transparent 75%, #d2d0ce 75%, #d2d0ce 0), white",backgroundPosition:"0px 0, 5px 5px",transformOrigin:"0 0 0",backgroundSize:"10px 10px, 10px 10px"}},S=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._fileBrowser=Object(i.createRef)();n._defaultFocusButton=Object(i.createRef)();n._onChangeClick=function(){n.props.onChangeClick&&n.props.onChangeClick();var e=n._fileBrowser.current;e&&e.click()};n._onImageChange=function(e){var t=e.target,r=t&&t.files&&t.files[0];r&&v.e.readFile(r).then(function(e){n.setState({newPreviewSrc:e,fileToUpload:r,removeImage:!1,isError:!1,isLoaded:!0});n.props.onImageChanged&&n.props.onImageChanged(e,r)})};n._onRemoveClick=function(){n.props.onRemoveClick&&n.props.onRemoveClick();n.setState({newPreviewSrc:void 0,fileToUpload:void 0,removeImage:!0,isError:!1,isLoaded:!1});n.props.onImageChanged&&n.props.onImageChanged(void 0,void 0)};n._onFocalPointDrag=function(e,t){if(n.props.onFocalPointMove){var r={x:n._pixelToPercentage(t.x,n.imageWidth),y:n._pixelToPercentage(t.y,n.imageHeight)};n.setState({focalPoint:r});n.props.onFocalPointMove(r)}};n._onHandleKeyDown=function(e){if(n.props.onFocalPointMove){e.stopPropagation();e.preventDefault();var t=n.state.focalPoint;if(n._isKey(h.e.enter,e)){n.props.onFocalPointMove(t);n._defaultFocusButton&&n._defaultFocusButton.current.focus();return}n._isKey(h.e.escape,e)?t.x=t.y=50:n._isKey(h.e.left,e)?t.x--:n._isKey(h.e.up,e)?t.y--:n._isKey(h.e.right,e)?t.x++:n._isKey(h.e.down,e)&&t.y++;n._ensureFocalPointInBound(t);n.setState({focalPoint:t})}};n._ensureFocalPointInBound=function(e){var t=n._percentageToPixel(e.x,n.imageWidth),r=n._percentageToPixel(e.y,n.imageHeight);t<0?t=0:t>n.imageWidth-52&&(t=n.imageWidth-52);r<0?r=0:r>n.imageHeight-52&&(r=n.imageHeight-52);e.x=n._pixelToPercentage(t,n.imageWidth);e.y=n._pixelToPercentage(r,n.imageHeight)};n._percentageToPixel=function(e,t){return(e||50)/100*t-26};n._pixelToPercentage=function(e,t){return(e+26)/t*100};n._onLoadingStateChange=function(e){e===a.n.error?n.setState({isError:!0,isLoaded:!1}):e===a.n.loaded?n.setState({isLoaded:!0,isError:!1}):n.setState({isLoaded:!1,isError:!1})};n.state={focalPoint:t.initialFocalPoint||w};n.imageHeight="imageHeight"in t?t.imageHeight:64;n.imageWidth="imageWidth"in t?t.imageWidth:64;n.imageFit="imageFit"in t?t.imageFit:a.t.contain;return n}t.prototype.render=function(){var e,t,n,r=this.props,a=this.state,h=r.initialPreviewUrl,v=r.disableRemove,g=!this.state.isError&&this.state.isLoaded;n=a.newPreviewSrc?a.newPreviewSrc:h&&!this.state.removeImage?h:r.emptyImageUrl||"";var w=!this.state.isLoaded,S=this.state.isLoaded&&!v;return i.createElement(l.e,{direction:c.e.bidirectional,defaultTabbableElement:".ms-ImageBrowser-change"},i.createElement("div",{className:"ms-ImageBrowser"},i.createElement("div",{className:Object(p.e)("ms-ImageBrowser-imageContainer",g?"":"ms-ImageBrowser-defaultBackground"),style:{width:this.imageWidth,height:this.imageHeight}},this.props.isFocalPointEnabled&&g&&i.createElement(y.a,{bounds:"parent",onDrag:this.debounce(this._onFocalPointDrag,250),defaultPosition:{x:this._percentageToPixel(50,this.imageWidth),y:this._percentageToPixel(50,this.imageHeight)},position:{x:this._percentageToPixel(null===(e=this.state.focalPoint)||void 0===e?void 0:e.x,this.imageWidth),y:this._percentageToPixel(null===(t=this.state.focalPoint)||void 0===t?void 0:t.y,this.imageHeight)}},i.createElement("div",{"aria-roledescription":b.r,"aria-label":b.n,className:"ms-ImageBrowser-focalCircle",onKeyDown:this._onHandleKeyDown,"data-is-focusable":"true"},i.createElement(o.e,{iconName:"SIPMove",className:"ms-ImageBrowser-focalIcon"}))),i.createElement(f.Image,{className:Object(p.e)("ms-ImageBrowser-image",this.props.imageAlignment===d.e.left?"ms-ImageBrowser-leftAlignment":""),width:this.imageWidth,height:this.imageHeight,imageFit:this.imageFit,src:n,alt:r.imageAlt||"",onLoadingStateChange:this._onLoadingStateChange,styles:!m.t.isActivated("09186f6d-1c9c-4d7d-80e8-5dbd70c63e66","11/03/2020","Support checkers for white/transparent images")&&this.state.isLoaded&&E}),!g&&i.createElement(u.e,{iconName:"Photo2",className:"ms-ImageBrowser-PlaceHolder",style:{top:this.imageHeight/2-12,left:this.imageWidth/2-12}})),i.createElement("div",{className:"ms-ImageBrowser-actionBar"},i.createElement(s.e,{componentRef:this._defaultFocusButton,className:"ms-ImageBrowser-change",onClick:this._onChangeClick,iconProps:{iconName:w?"Upload":"EditPhoto"},ariaLabel:w?r.uploadButtonAriaLabel||b.o:r.changeButtonAriaLabel||b.e},w?b.u:b.t),S&&i.createElement(s.e,{className:"ms-ImageBrowser-remove",onClick:this._onRemoveClick,iconProps:{iconName:"Delete"},ariaLabel:r.removeButtonAriaLabel||b.i},b.s)),i.createElement("input",{ref:this._fileBrowser,style:{display:"none"},type:"file",accept:(r.supportedImageTypes||["image/*"]).join(","),onChange:this._onImageChange,tabIndex:-1,multiple:!1})))};t.prototype.getImageFile=function(){return this.state.removeImage?null:this.state.fileToUpload};t.prototype._isKey=function(e,t){return t.keyCode===e&&!t.altKey&&!t.ctrlKey&&!t.shiftKey};t.prototype.debounce=function(e,t,n){void 0===n&&(n=!1);var r;return function(){var i=this,s=arguments,o=function(){r=null;n||e.apply(i,s)},u=n&&!r;clearTimeout(r);r=setTimeout(o,t);u&&e.apply(i,s)}};return t})(i.Component)}}]);