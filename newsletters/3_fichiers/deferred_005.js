(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([["deferred.odsp-datasources"],{1863:function(e,t,n){"use strict";var r,i=n(0),s=(function(){function e(){}e.tokenCacheSessionStorageId="tokenCache";e.aboutToExpireIntervalSeconds=600;e.apiUrl="/_api/SP.OAuth.Token/Acquire";e.retries=3;e.retriableErrorCodes=[10006,10008];e.unexpectedErrorCodeFormat="Expected error code format is <numericCode>, <exception class name>";e.unexpectedTokenMessageFormat="Your token request succeedeed but the token could not be parsed from the response.This is most probably caused by a change in the server response format";e.npmPackageVersion="0.1.5";return e})();(function(e){e[e.unknownError=0]="unknownError";e[e.malformedResponseBody=1]="malformedResponseBody";e[e.serverError=2]="serverError"})(r||(r={}));var o=(function(e){Object(i.__extends)(t,e);function t(n,r){var i=e.call(this,r.message)||this;i.__proto__=t.prototype;i._type=n;i._httpResponseStatus=r.httpResponseStatus;i._cultureName=r.cultureName;i._message=r.message;i._serverErrorCode=r.serverErrorCode;i._correlationId=r.correlationId;i._redirectUrl=r.redirectUrl;return i}Object.defineProperty(t.prototype,"type",{get:function(){return this._type},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"serverErrorCode",{get:function(){if(this.type!==r.serverError)throw new Error("ServerErrorCode can only be obtained for errors of type serverError");return this._serverErrorCode},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"httpResponseStatus",{get:function(){return this._httpResponseStatus},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"message",{get:function(){return this._message},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"cultureName",{get:function(){return this._cultureName},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"correlationId",{get:function(){return this._correlationId},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"redirectUrl",{get:function(){return this._redirectUrl},enumerable:!0,configurable:!0});return t})(Error),u=(function(){function e(e){var t=this;this._context=e;this._dispose=this._dispose.bind(this);window.addEventListener("unload",this._dispose);window._spPageOnMediaTokenReceived=function(){t._receiveMediaServiceFlushedToken()};window._spMSBTLoaded=function(){t._receiveMediaServiceFlushedToken()}}e._getCorrelationId=function(e){return e.headers.get("sprequestguid")};e._extractRealError=function(e){return e.hasOwnProperty("error")?e.error:e};e.prototype.getOAuthToken=function(e,t){return this.getInstrumentedOAuthToken(e,t).then(function(e){if(e)return e.tokenInfo})};e.prototype.getInstrumentedOAuthToken=function(e,t){var n=this;this._receiveMediaServiceFlushedToken();var r=this._getCachedTokenData(e);if(r&&!this._isExpiring(r)){var i={token:r.accessToken,isGuest:!1,expirationTimeMs:r.expiresOn};return Promise.resolve({tokenInfo:i,spRequestId:r.correlationId,spRequestTimestamp:r.requestTimestamp})}return this._retriableFetchWithDigest(e,s.retries,t).then(function(t){n._storeTokenData(e,t);return{tokenInfo:{token:t.accessToken,isGuest:!1,expirationTimeMs:t.expiresOn},spRequestId:t.correlationId,spRequestTimestamp:t.requestTimestamp}})};e.prototype.clearCachedToken=function(e){var t=this._getCacheKey(e);window.sessionStorage.removeItem(t);var n=this._resourceKeys.indexOf(t);!isNaN(n)&&n>-1&&this._resourceKeys.splice(n)};Object.defineProperty(e.prototype,"_resourceKeys",{get:function(){this._keysToDispose||(this._keysToDispose=new Array);return this._keysToDispose},enumerable:!0,configurable:!0});e.prototype._retriableFetchWithDigest=function(t,n,i){var s=this,u=this._context.qosMonitor(),a=Date.now();return this._context.fetchWithDigest(this._buildTokenRequest(t,i)).then(function(f){if(200!==f.status){s._context.logger.logError("fetchWithDigest failed. Server responded with "+f.statusText);var l=new o(r.unknownError,{httpResponseStatus:f.status,message:f.statusText,correlationId:e._getCorrelationId(f)});if(400!==f.status){u.writeUnexpectedFailure("UnknownError",l);return Promise.reject(l)}return f.json().then(function(r){var o=e._extractRealError(r),a=s._getErrorCodeFromResponseCode(o);if(!s._isRetriableError(a)||0===n){var f=s._buildErrorFromResponse(o);u.writeUnexpectedFailure("SharepointServerError",f);return Promise.reject(f)}s._context.logger.logError("fetchWithDigest failed. Retrying. Retries left: "+n);return s._retriableFetchWithDigest(t,n-1,i)})}return s._instrumentedParseResponseData(f,u,a)})};e.prototype._getCachedTokenData=function(e){return JSON.parse(window.sessionStorage.getItem(this._getCacheKey(e)))};e.prototype._storeTokenData=function(e,t){window.sessionStorage.setItem(this._getCacheKey(e),JSON.stringify(t))};e.prototype._getCacheKey=function(e){var t=["sp-client-shared",s.npmPackageVersion,"OAuthUtility",e].join(";");-1===this._resourceKeys.indexOf(t)&&this._resourceKeys.push(t);return t};e.prototype._isExpiring=function(e){return e.expiresOn-Date.now()/1e3<s.aboutToExpireIntervalSeconds};e.prototype._isRetriableError=function(e){return-1!==s.retriableErrorCodes.indexOf(e)};e.prototype._buildTokenRequest=function(e,t){var n=new Headers;n.append("Content-Type","application/json; charset=utf-8");n.append("Odata-Version","4.0");n.append("Accept","application/json;odata.metadata=minimal");var r={method:"POST",headers:n,body:JSON.stringify(this._buildRequestBody(e))},i=t;i&&i.lastIndexOf("/")===i.length-1&&(i=i.substr(0,i.length-1));return new Request(i+s.apiUrl,r)};e.prototype._buildRequestBody=function(e){return{resource:e}};e.prototype._buildErrorFromResponse=function(e){var t,n,i=this._getErrorCodeFromResponseCode(e);if(void 0===i)return new o(r.malformedResponseBody,{httpResponseStatus:400,message:s.unexpectedErrorCodeFormat,correlationId:e.correlationId});if(e.message)if("string"==typeof e.message)t=e.message;else{t=e.message.value;n=e.message.lang}return new o(r.serverError,{httpResponseStatus:400,message:t,cultureName:n,serverErrorCode:i,correlationId:e.correlationId,redirectUrl:e["error.redirectUrl"]||e["@error.redirectUrl"]})};e.prototype._getErrorCodeFromResponseCode=function(e){var t=e.code,n=Number(t);if(isNaN(n)&&"string"==typeof e.message){var r=t.indexOf(",");-1!==r&&(n=Number(t.substr(0,r)))}return n};e.prototype._instrumentedParseResponseData=function(t,n,i){try{return t.json().then(function(r){n.writeSuccess();return{accessToken:r.access_token,expiresOn:Number(r.expires_on),notBefore:Number(r.not_before),resource:r.resource,tokenType:r.token_type,correlationId:e._getCorrelationId(t),requestTimestamp:i}})}catch(i){n.writeUnexpectedFailure("ResponseParseError",i);return Promise.reject(new o(r.malformedResponseBody,{httpResponseStatus:200,message:s.unexpectedTokenMessageFormat,correlationId:e._getCorrelationId(t)}))}};e.prototype._dispose=function(e){window.removeEventListener("unload",this._dispose);for(var t=0,n=this._resourceKeys;t<n.length;t++){var r=n[t];window.sessionStorage.removeItem(r)}};e.prototype._receiveMediaServiceFlushedToken=function(){if(window._spMSBT){var e={tokenType:window._spMSBT.TokenType,expiresOn:window._spMSBT.ExpiresOn,notBefore:void 0,resource:window._spMSBT.Resource,accessToken:window._spMSBT.AccessToken};this._storeTokenData(e.resource,e);window._spMSBT=void 0}};return e})(),a=n(592),f=n(69),l=n(83),c=n(84),h=n(44),p=(function(){function e(){this._qos=new c.e({name:"OAuthTokenDataSource"})}e.prototype.writeSuccess=function(){this._qos.end({resultType:h.e.Success})};e.prototype.writeUnexpectedFailure=function(e,t){this._qos.end({resultCode:e,resultType:h.e.Failure,error:JSON.stringify(t)})};e.prototype.writeExpectedFailure=function(e,t){this._qos.end({resultCode:e,resultType:h.e.ExpectedFailure,error:JSON.stringify(t)})};return e})(),d=(function(){function e(){}e.prototype.logWarning=function(e){};e.prototype.logError=function(e){};return e})(),v=(function(e){Object(i.__extends)(t,e);function t(t,n){var r=e.call(this,{},{pageContext:t})||this;r.logger=new d;if(n){n.logger&&(r.logger=n.logger);n.useAbsoluteUrlForOAuth&&(r._useAbsoluteUrlForOAuth=n.useAbsoluteUrlForOAuth)}r._oAuthUtility=new u(r);return r}t.prototype.qosMonitor=function(){return new p};Object.defineProperty(t.prototype,"webUrl",{get:function(){return this._useAbsoluteUrlForOAuth?this._pageContext.webAbsoluteUrl:Object(l.n)(this._pageContext)},enumerable:!0,configurable:!0});t.prototype.fetchWithDigest=function(e){var t=this;return e.text().then(function(n){var r=e.headers.get("Content-Type");e.headers.delete("Content-Type");return t._odspPromiseToEs6Promise(t.getData(function(){return e.url},function(e,t){return new Response(e,{status:t.getStatus(),headers:t.getResponseHeadersDictionary()})},"DelegationTokenDataSource",function(){return n},"POST",t._getRequestHeadersDictionary(e),r,void 0,!0).then(function(e){return e},function(e){return new Response(JSON.stringify(e),{status:e.status})}))})};t.prototype.getToken=function(e,t){t&&this._oAuthUtility.clearCachedToken(e);return this._es6PromiseToOdspPromise(this._oAuthUtility.getOAuthToken(e,this.webUrl).then(function(e){return e.token}))};t.prototype.getInstrumentedToken=function(e,t){t&&this._oAuthUtility.clearCachedToken(e);return this._es6PromiseToOdspPromise(this._oAuthUtility.getInstrumentedOAuthToken(e,this.webUrl))};t.prototype._getRequestHeadersDictionary=function(e){var t=e.headers,n={};t.forEach(function(e,t){n[t]=e});return n};t.prototype._odspPromiseToEs6Promise=function(e){return new Promise(function(t,n){e.then(function(e){t(e)},function(e){n(e)})})};t.prototype._es6PromiseToOdspPromise=function(e){return new f.n(function(t,n){e.then(function(e){t(e)},function(e){n(e)})})};return t})(a.t);t.e=v},1888:function(e,t,n){"use strict";var r;(function(e){e[e.none=0]="none";e[e.user=1]="user";e[e.distributionList=2]="distributionList";e[e.securityGroup=4]="securityGroup";e[e.sharePointGroup=8]="sharePointGroup";e[e.all=15]="all"})(r||(r={}));t.e=r},2004:function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return i});var r,i,s={applyPanel:"filtersPane-applyInPanel",pinnedToFiltersPaneChanged:"filtersPane-pinnedToFiltersPaneChanged",showInFiltersPaneChanged:"filtersPane-showInFiltersPaneChangedChanged",sectionInfosChanged:"filtersPane-sectionInfosChanged"};(function(e){e[e.user=0]="user";e[e.date=1]="date";e[e.fileType=2]="fileType";e[e.choice=3]="choice";e[e.hierarchy=4]="hierarchy"})(r||(r={}));(function(e){e[e.none=0]="none";e[e.last3Months=1]="last3Months";e[e.last30Days=2]="last30Days";e[e.last7Days=3]="last7Days";e[e.yesterday=4]="yesterday";e[e.today=5]="today";e[e.tomorrow=6]="tomorrow";e[e.next7Days=7]="next7Days";e[e.next30Days=8]="next30Days";e[e.next3Months=9]="next3Months";e[e.nextYear=10]="nextYear"})(i||(i={}))},2058:function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=n(4272),i=n(69);function s(e,t,n,r){return e.ensureSiteAssetsLibrary().then(function(e){return t.addFileToWebList(e.id,n,r,!0)})}function o(e,t,n,o){return("image/svg+xml"===o.type?i.n.resolve(o):Object(r.e)(o,648,648)).then(function(r){return s(e,t,n,o)})}},2077:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r,i;(function(e){e[e.queued=0]="queued";e[e.started=1]="started";e[e.completed=2]="completed";e[e.aborted=3]="aborted";e[e.failed=4]="failed";e[e.none=5]="none"})(r||(r={}));(function(e){e[e.none=0]="none";e[e.other=1]="other";e[e.general=2]="general";e[e.conflict=3]="conflict";e[e.similarNameExists=4]="similarNameExists";e[e.invalidName=5]="invalidName";e[e.fileSize=6]="fileSize";e[e.emptyFileOrFolder=7]="emptyFileOrFolder";e[e.emptyFileOrFolderForDocLib=8]="emptyFileOrFolderForDocLib";e[e.overQuota=9]="overQuota";e[e.accessDenied=10]="accessDenied";e[e.lockMismatch=11]="lockMismatch";e[e.overQuotaSharedFolder=12]="overQuotaSharedFolder";e[e.folderUploadNotSupported=13]="folderUploadNotSupported";e[e.versionMismatch=14]="versionMismatch";e[e.authFailure=15]="authFailure";e[e.targetFolderMissing=16]="targetFolderMissing";e[e.itemNotFound=17]="itemNotFound";e[e.malwareDetected=18]="malwareDetected";e[e.throttled=19]="throttled";e[e.pathTooLong=20]="pathTooLong";e[e.disconnected=21]="disconnected";e[e.unlockRequired=22]="unlockRequired";e[e.insufficientVaultQuota=23]="insufficientVaultQuota"})(i||(i={}))},2079:function(e,t,n){"use strict";n.r(t);n.d(t,"getItemName",function(){return a});n.d(t,"updateListContext",function(){return f});n.d(t,"updateListContextGroupInfo",function(){return l});var r=n(0),i=n(162),s=n(368),o=n(390),u=n(12);function a(e,t,n){return n&&!n.isDocLib&&t!==i.t.Folder&&(e.Title||e["URL.desc"])||e.FileLeafRef}function f(e,t){if(Number(e.ListTemplateType)){t.listTemplateType=Number(e.ListTemplateType);t.isDocLib=Object(u.i)(t.listTemplateType)}"boolean"==typeof e.ContentTypesEnabled&&(t.contentTypesEnabled=e.ContentTypesEnabled);if(e.ListSchema){t.listId=e.listName;t.rawListSchema=e.ListSchema;t.viewTitle=e.viewTitle;t.openInClient="0"===t.rawListSchema.DefaultItemOpen}e.ListTitle&&(t.listTitle=e.ListTitle);e.listUrlDir&&(t.listUrl=decodeURIComponent(e.listUrlDir));e.EnableAttachments&&(t.enableAttachments="true"===e.EnableAttachments);e.Flags2&&(t.flags2=e.Flags2);e.Icon&&(t.icon=e.Icon);e.Color&&(t.color=e.Color);var n=e.BasePermissions;n&&(t.permissions={manageLists:n.ManageLists,managePersonalViews:n.ManagePersonalViews,openItems:n.OpenItems});"boolean"!=typeof e.ExcludeFromOfflineClient&&"boolean"!=typeof e.WebExcludeFromOfflineClient||(t.excludeFromOfflineClient=!(!e.ExcludeFromOfflineClient&&!e.WebExcludeFromOfflineClient));"boolean"==typeof e.TenantTagPolicyEnabled&&(t.tenantTagPolicyEnabled=e.TenantTagPolicyEnabled);"boolean"==typeof e.verEnabled&&(t.enableVersions=e.verEnabled);"boolean"==typeof e.checkPowerAppState&&(t.checkPowerAppState=e.checkPowerAppState);"boolean"==typeof e.EnableMinorVersions&&(t.enableMinorVersions=e.EnableMinorVersions);"boolean"==typeof e.NewWOPIDocumentEnabled&&(t.newWOPIDocumentEnabled=e.NewWOPIDocumentEnabled);"number"==typeof e.NewWOPIDocumentTypes&&(t.newWOPIDocumentTypes=e.NewWOPIDocumentTypes);"boolean"==typeof e.isForceCheckout&&(t.isForceCheckout=e.isForceCheckout);"boolean"==typeof e.isModerated&&(t.isModerated=e.isModerated);"boolean"==typeof e.EnableRequestSignOff&&(t.enableRequestSignOff=e.EnableRequestSignOff);"boolean"==typeof e.AllowCreateFolder&&(t.allowCreateFolder=e.AllowCreateFolder);"boolean"==typeof e.DisableCommenting&&(t.disableCommenting=e.DisableCommenting);"boolean"==typeof e.AllowGridMode?t.allowGridMode=e.AllowGridMode:"boolean"!=typeof t.allowGridMode&&(t.allowCreateFolder=!0);e.displayFormUrl&&(t.displayFormUrl=e.displayFormUrl);e.editFormUrl&&(t.editFormUrl=e.editFormUrl);e.newFormUrl&&(t.newFormUrl=e.newFormUrl);e.metadataNavFeatureEnabled&&(t.metadataNavFeatureEnabled=e.metadataNavFeatureEnabled);e.AvailableContentTypes&&(t.availableContentTypes=e.AvailableContentTypes);if(e.ViewMetadata){var i=void 0;i=Object(r.__assign)({},e.ViewMetadata);if(e.VisualizationInfo)try{i.VisualizationInfo=JSON.parse(e.VisualizationInfo)}catch(e){}i.CustomFormatter=e.ListSchema&&e.ListSchema.CustomFormatter;t.viewResult=new s.e(i)}t.isPlaceholder=!1}function l(e){var t=void 0;if(e.groupByOverride)t=[e.groupByOverride];else if(e.rawListSchema&&e.rawListSchema.group1){(t=[]).push(e.rawListSchema.group1);e.rawListSchema.group2&&t.push(e.rawListSchema.group2)}var n=-1,r=e.rawListSchema&&"TRUE"===e.rawListSchema.Collapse;if(t&&t.length>0){n=0;if(e.filterParams&&!r){var i=Boolean(Object(o.getFilterFieldByName)(e.filterParams,t[0])),s=!(!i||!t[1])&&Boolean(Object(o.getFilterFieldByName)(e.filterParams,t[1]));(i&&1===t.length||s&&2===t.length)&&(n=-1)}}e.groupLevel=n;e.groupBy=n>-1?t:void 0;e.isGrouped=Boolean(e.groupBy)}},2092:function(e,t,n){"use strict";n.d(t,"r",function(){return o});n.d(t,"n",function(){return a});n.d(t,"t",function(){return l});n.d(t,"e",function(){return c});var r=n(31),i=n(445),s=n(89);function o(e){var t="string"==typeof e?Object(i.t)(e):e;return{filters:l(t.where),sorts:u(t.orderBy),groupBy:a(t.groupBy),fieldNames:Object(i.s)(t.viewFields),rowLimit:f(t.rowLimit),associatedContentTypeId:Object(i.i)(t.associatedContentTypeId)}}function u(e){if(e){var t=Array.prototype.slice.call(e.childNodes).map(function(e){return h(e)}).filter(function(e){return!!e});return t.length?t:void 0}}function a(e){if(e){var t=Array.prototype.slice.call(e.childNodes).map(function(e){return h(e)}).filter(function(e){return!!e});if(t.length){var n={isCollapsed:p(e,r.e.collapse,!0),group1:t[0]};t[1]&&(n.group2=t[1]);return n}}}function f(e){if(e&&e.textContent)return{rowLimit:Number(e.textContent),isPerPage:p(e,r.e.paged,!1)}}function l(e){if(e&&e.childElementCount){var t=c(e.firstElementChild);return t&&t.length?t:void 0}}function c(e){if(e){var t;switch(e.tagName){case r.n.and:t=(function(e){if(!e||!e.childElementCount)return;var t=e.firstElementChild,n=c(t);if(!t.nextElementSibling)return n;var r=c(t.nextElementSibling);if(!n&&!r)return;return(n||[]).concat(r||[])})(e);break;case r.n.or:t=(function(e){var t=(function e(t){if(!t.childElementCount)return;var n;switch(t&&t.tagName){case r.n.or:var i=t.firstElementChild,s=e(i);if(s&&i.nextElementSibling){var o=e(i.nextElementSibling);n=o?s.concat(o):void 0}else n=s;break;case r.n.eq:n=d(t);break;case r.n.isNull:n=v(t)}if(n)return Array.isArray(n)?n:[n];return})(e);if(t&&t.length&&!t.some(function(e){return!e})){if(t.every(function(e){return e.fieldName===t[0].fieldName&&e.lookupId===t[0].lookupId})){var n=!1,i=t.reduce(function(e,t){if(!n)if(e.type&&t.type&&e.type!==t.type){n=!0;e.type=void 0}else e.type=e.type||t.type;e.values.push(t.values[0]);return e});i.operator=r.n.eq;i.id=e&&s.t(e,r.e.id);return i}}return null})(e);break;case r.n.isNull:case r.n.isNotNull:case r.n.membership:t=v(e);break;case r.n.beginsWith:case r.n.contains:case r.n.eq:case r.n.greaterEq:case r.n.greater:case r.n.includes:case r.n.lessEq:case r.n.less:case r.n.notEq:case r.n.notIncludes:t=d(e);break;case r.n.inTag:t=(function(e){var t=m(e),n=Array.prototype.filter.call(e.childNodes,function(e){return e.tagName===r.n.values})[0];if(!t||!n)return;var i=!1,s=Array.prototype.map.call(n.childNodes,function(e){var n=g(e);if(n&&n.type&&!i){var r=n.type,s=t.type;i=!(!s||!r||s===r);t.type=s||r}return n&&n.value});if((s=s.filter(function(e){return!!e})).length){t.values=s;i&&(t.type=void 0)}return s.length?t:void 0})(e)}return t?Array.isArray(t)?t.length?t:void 0:[t]:void 0}}function h(e){if(e&&e.tagName===r.n.fieldRef){var t=s.t(e,r.e.name);if(t)return{fieldName:t,isAscending:p(e,r.e.ascending,!0)}}}function p(e,t,n){switch((s.t(e,t)||"").toLowerCase()){case"true":return!0;case"false":return!1;default:return n}}function d(e){var t=m(e),n=Array.prototype.filter.call(e.childNodes,function(e){return e.tagName===r.n.value})[0];if(t&&n){var i=g(n);if(i){t.type=i.type;t.values=[i.value];return t}}}function v(e){var t=m(e);if(t)if(e.tagName===r.n.isNull)t.values=[""];else if(e.tagName===r.n.membership){var n=s.t(e,r.e.type);n?t.values=[n]:t=void 0}return t}function m(e){var t=Array.prototype.filter.call(e.childNodes,function(e){return e.tagName===r.n.fieldRef})[0],n=t&&s.t(t,r.e.name),i=e&&s.t(e,r.e.id);if(n)return{fieldName:n,id:i,type:void 0,lookupId:p(t,r.e.lookupId),operator:e.tagName,values:void 0}}function g(e){var t=e&&e.childElementCount&&e.firstElementChild.tagName!==r.n.today&&e.firstElementChild.tagName!==r.n.me;if(e&&e.tagName===r.n.value&&!t){var n,i={value:e.textContent,type:s.t(e,r.e.type)};if(e.childElementCount)if(e.firstElementChild.tagName===r.n.today){var o=e.firstElementChild,u=s.t(o,r.e.offset)||s.t(o,r.e.offsetDays),a=parseInt(u,10)||0;i.value=s.s(a);i.type=i.type||"DateTime"}else if(e.firstElementChild.tagName===r.n.me){i.value=s.r();i.type=i.type||"Integer"}i.value&&"DateTime"===i.type&&!0!==p(e,r.e.includeTimeValue)&&(n=i.value.match(r.t.datetimeNoTimeRegex))&&(i.value=n[1]);return i}}},2131:function(e,t,n){"use strict";var r,i=n(390);(function(e){e.getFilterData=function(e,t,r,s){var o=[];e=e.split("<br>")[0];var u=document.createElement("DIV");u.innerHTML=e;var a=u.querySelector("#diidFilter"+t);if(null!=a)for(var f=a.childNodes.length,l=a.childNodes,c=1;c<f;c++){var h=Object(i.getText)(l[c]),p=l[c].value.toString(),d={display:null!=s&&s?p:h,value:p};if(r){var v=n(p);if(v.filterType){d.value=v.value;d.calculatedFieldOriginFilterValue=p;d.calculatedFieldFilterType=v.filterType;o.push(d)}}else o.push(d)}for(var m={},g=0,y=o;g<y.length;g++){(E=y[g]).display in m?m[E.display]++:m[E.display]=1}for(var b=0,w=o;b<w.length;b++){var E;m[(E=w[b]).display]>1&&(E.display=E.value)}return o};var t=["Text","Text","Text","Text","Text","Number","Text","DateTime","Text","Text","Error","Boolean"];function n(e){var n=e.indexOf("_"),r=e,i=void 0;if(n>0){r=e.substring(n+1);var s=Number(e.substring(0,n));!isNaN(s)&&s<t.length&&(i=t[s])}return{value:r,filterType:i}}e.getCalculatedFieldFilterValueAndType=n})(r||(r={}));t.e=r},2209:function(e,t,n){"use strict";n.r(t);n.d(t,"SiteScriptProgressCallbackType",function(){return r});n.d(t,"SiteScriptRunAge",function(){return i});n.d(t,"SiteScriptProgressStateManager",function(){return v});var r,i,s=n(0),o=n(163),u=n(592),a=n(54),f=n(59),l=(function(e){Object(s.__extends)(t,e);function t(t){return e.call(this,{dataSourceName:"SiteScriptProgressDataSource"},{pageContext:t.pageContext})||this}t.prototype.getDesignPackageMenuContents=function(){return this.getData(this._constructGetDesignPackageMenuContentsUrl.bind(this),function(e){return JSON.parse(e)},"GetDesignPackageMenuContentsAPI")};t.prototype.getSiteDesignTasks=function(){var e=this;return this.getData(this._constructGetSiteDesignTasksUrl.bind(this),function(e){return JSON.parse(e)},"GetSiteDesignTasksAPI",function(){return JSON.stringify({webUrl:f.e.escapeUrlForCallback(e._pageContext.webAbsoluteUrl)})})};t.prototype.addSiteDesignTask=function(e){return this.getData(this._constructAddSiteDesignTaskUrl.bind(this),function(e){return JSON.parse(e)},"AddSiteDesignTaskAPI",function(){return JSON.stringify({siteDesignId:e})})};t.prototype.getSiteDesignRunStatus=function(e){return this.getData(this._constructGetSiteDesignRunStatusUrl.bind(this),function(e){return JSON.parse(e)},"GetSiteDesignRunStatusAPI",function(){return JSON.stringify({runId:e})})};t.prototype.getSiteDesignRuns=function(){return this.getData(this._constructGetSiteDesignRunsUrl.bind(this),function(e){return JSON.parse(e)},"GetSiteDesignStagesAPI")};t.prototype.getSiteDesignStages=function(e){return this.getData(this._constructGetSiteDesignStagesUrl.bind(this),function(e){return JSON.parse(e)},"GetSiteDesignStagesAPI",function(){return JSON.stringify({siteDesignId:e})})};t.prototype.applySiteDesign=function(e,t){var n=this;return this.getData(this._constructApplySiteDesignUrl.bind(this),function(e){return JSON.parse(e)},"ApplySiteDesignAPI",function(){return JSON.stringify({siteDesignId:e,webUrl:n._pageContext.webAbsoluteUrl,store:t})})};t.prototype.getTenantSiteDesigns=function(){return this.getData(this._consturctGetTenantSiteDesignsUrl.bind(this),function(e){return JSON.parse(e)},"GetTenantSiteDesignsAPI")};t.prototype.getOutOfBoxSiteDesigns=function(){return this.getData(this._consturctGetOutOfBoxSiteDesignsUrl.bind(this),function(e){return JSON.parse(e)},"GetOutOfBoxSiteDesignsAPI")};t.prototype.getIsSiteDesignPending=function(){return this.getData(this._constructValidateSiteDesignPendingUrl.bind(this),function(e){return JSON.parse(e)},"ValidateSiteDesignPendingAPI")};t.prototype.applyImplicitSiteDesign=function(){this.getData(this._constructApplyImplicitSiteDesignUrl.bind(this),function(e){return e},"ApplyImplicitSiteDesignAPI")};t.prototype.getOutOfBoxTemplateSettings=function(){return this.getData(this._constructGetOutOfBoxTemplateSettingsUrl.bind(this),function(e){return JSON.parse(e)},"GetOutOfBoxTemplateSettingsAPI")};t.prototype._constructGetDesignPackageMenuContentsUrl=function(){return this._constructGenericUrl("/_api/Microsoft.Sharepoint.Utilities.WebTemplateExtensions.SiteScriptUtility.GetDesignPackageMenuContents")};t.prototype._constructGetSiteDesignTasksUrl=function(){return this._constructGenericUrl("/_api/Microsoft.Sharepoint.Utilities.WebTemplateExtensions.SiteScriptUtility.GetSiteDesignTasks")};t.prototype._constructAddSiteDesignTaskUrl=function(){return this._constructGenericUrl("/_api/Microsoft.Sharepoint.Utilities.WebTemplateExtensions.SiteScriptUtility.AddSiteDesignTaskToCurrentWeb")};t.prototype._constructGetSiteDesignRunStatusUrl=function(){return this._constructGenericUrl("/_api/Microsoft.Sharepoint.Utilities.WebTemplateExtensions.SiteScriptUtility.GetSiteDesignRunStatusAndSchema")};t.prototype._constructGetSiteDesignRunsUrl=function(){return this._constructGenericUrl("/_api/Microsoft.Sharepoint.Utilities.WebTemplateExtensions.SiteScriptUtility.GetSiteDesignRun")};t.prototype._constructGetSiteDesignStagesUrl=function(){return this._constructGenericUrl("/_api/Microsoft.Sharepoint.Utilities.WebTemplateExtensions.SiteScriptUtility.GetSiteDesignStages")};t.prototype._constructApplySiteDesignUrl=function(){return this._constructGenericUrl("/_api/Microsoft.Sharepoint.Utilities.WebTemplateExtensions.SiteScriptUtility.ApplySiteDesign")};t.prototype._consturctGetTenantSiteDesignsUrl=function(){return this._constructGenericUrl("/_api/Microsoft.Sharepoint.Utilities.WebTemplateExtensions.SiteScriptUtility.GetSiteDesigns")};t.prototype._consturctGetOutOfBoxSiteDesignsUrl=function(){return this._constructGenericUrl("/_api/Microsoft.Sharepoint.Utilities.WebTemplateExtensions.SiteScriptUtility.GetSiteDesigns?store=1")};t.prototype._constructValidateSiteDesignPendingUrl=function(){return this._constructGenericUrl("/_api/Microsoft.Sharepoint.Utilities.WebTemplateExtensions.SiteScriptUtility.ValidatePendingWebTemplateExtension")};t.prototype._constructApplyImplicitSiteDesignUrl=function(){return this._constructGenericUrl("/_api/Microsoft.Sharepoint.Utilities.WebTemplateExtensions.SiteScriptUtility.ApplyImplicitSiteDesign")};t.prototype._constructGetOutOfBoxTemplateSettingsUrl=function(){return this._constructGenericUrl("/_api/Microsoft.Sharepoint.Utilities.WebTemplateExtensions.SiteScriptUtility.GetOutOfBoxSiteTemplateSettings")};t.prototype._constructGenericUrl=function(e){return new a.t(a.t.concatenate(f.e.escapeUrlForCallback(this._pageContext.webServerRelativeUrl),e)).toString()};return t})(u.t),c=(function(){function e(e){this._dataSource=e.dataSource;this._currentCultureName=e.currentCultureName}e.prototype.getSiteDesignRunStatus=function(e,t){var n=this;return this._dataSource.getSiteDesignRunStatus(e).then(function(e){var r=[],i=e&&e.d&&e.d.GetSiteDesignRunStatusAndSchema&&e.d.GetSiteDesignRunStatusAndSchema.ActionStatus&&e.d.GetSiteDesignRunStatusAndSchema.ActionStatus.results;if(i&&i.length)for(var s=0;s<i.length;s++){var o=i[s];r.push({outcomeCode:o.OutcomeCode,outcomeText:o.OutcomeText})}var u=void 0;t&&e.d.GetSiteDesignRunStatusAndSchema.Schema&&(u=n._constructSiteScriptData(e.d.GetSiteDesignRunStatusAndSchema.Schema,void 0));return{siteScriptData:u,stageResultData:r}})};e.prototype.getSiteDesignRuns=function(){var e=this;return this._dataSource.getSiteDesignRuns().then(function(t){var n=[];if(t&&t.d&&t.d.results)for(var r=0;r<t.d.results.length;r++){var i=t.d.results[r],s=parseInt(i.StartTime,10);n.push({siteDesignId:i.SiteDesignID,siteDesignTitle:i.SiteDesignTitle,runId:i.ID,version:i.SiteDesignVersion,runDate:isNaN(s)?"":new Date(s).toLocaleDateString(e._currentCultureName)})}return n})};e.prototype.getSiteDesignStages=function(e){var t=this;return this._dataSource.getSiteDesignStages(e).then(function(n){if(n&&n.d&&n.d.GetSiteDesignStages)return t._constructSiteScriptData(n.d.GetSiteDesignStages,e)})};e.prototype.addSiteDesignTask=function(e){return this._dataSource.addSiteDesignTask(e).then(function(e){if(e&&e.d&&e.d.AddSiteDesignTaskToCurrentWeb&&e.d.AddSiteDesignTaskToCurrentWeb.ID)return{taskId:e.d.AddSiteDesignTaskToCurrentWeb.ID,siteDesignId:e.d.AddSiteDesignTaskToCurrentWeb.SiteDesignID,logonName:e.d.AddSiteDesignTaskToCurrentWeb.LogonName}})};e.prototype.getSiteDesignTasks=function(){return this._dataSource.getSiteDesignTasks().then(function(e){if(e&&e.d&&e.d.GetSiteDesignTasks&&e.d.GetSiteDesignTasks.results&&e.d.GetSiteDesignTasks.results.map)return e.d.GetSiteDesignTasks.results.map(function(e){return{taskId:e.ID,siteDesignId:e.SiteDesignID,logonName:e.LogonName}})})};e.prototype.applySiteDesign=function(e,t){return this._dataSource.applySiteDesign(e,t).then(function(e){if(e&&e.d&&e.d.ApplySiteDesign){var t=e.d.ApplySiteDesign.results;if(t){for(var n=[],r=0;r<t.length;r++){var i=t[r],s=parseInt(i.Outcome,10);n.push({outcomeCode:isNaN(s)?1:s,outcomeText:i.OutcomeText})}return n}}})};e.prototype.getTenantSiteDesigns=function(){var e=this;return this._dataSource.getTenantSiteDesigns().then(function(t){return e._getSiteDesignsFromServerData(t)})};e.prototype.getOutOfBoxSiteDesigns=function(){var e=this;return this._dataSource.getOutOfBoxSiteDesigns().then(function(t){return e._getSiteDesignsFromServerData(t)})};e.prototype.getOutOfBoxTemplateSettings=function(){var e=this;return this._dataSource.getOutOfBoxTemplateSettings().then(function(t){return e._getOutOfBoxTemplateSettingsFromServerData(t)})};e.prototype.getIsSiteDesignPending=function(){return this._dataSource.getIsSiteDesignPending().then(function(e){return!(!e||!e.d)&&(!e.error&&!!e.d.ValidatePendingWebTemplateExtension)},function(e){return!1})};e.prototype.applyImplicitSiteDesign=function(){this._dataSource.applyImplicitSiteDesign()};e.prototype._constructSiteScriptData=function(e,t){var n=JSON.parse(e),r=[],i=[];if(n&&n.recipes.length)for(var s=0;s<n.recipes.length;s++){r.push({id:n.recipes[s].recipeGuid,name:n.recipes[s].recipeName,actions:n.recipes[s].actions});if(n.recipes[s].actions&&n.recipes[s].actions.length)for(var o=0;o<n.recipes[s].actions.length;o++)n.recipes[s].actions[o]&&n.recipes[s].actions[o].stages&&n.recipes[s].actions[o].stages.length&&i.push.apply(i,n.recipes[s].actions[o].stages)}return{siteDesignId:t,siteDesignTitle:n.siteDesignTitle,siteScripts:r,stageNames:i,isLongRunning:i.length>30}};e.prototype._getSiteDesignsFromServerData=function(e){if(e&&e.d&&e.d.GetSiteDesigns){var t=e.d.GetSiteDesigns.results;if(t&&t.length){for(var n=[],r=0;r<t.length;r++){var i=t[r];if(i){var s=i.SupportedWebTemplates&&i.SupportedWebTemplates.results&&i.SupportedWebTemplates.results.length?this._getSupportedTemplateTypes(i.SupportedWebTemplates.results):this._getSupportedTemplateTypes([i.WebTemplate]),o=i.TemplateFeatures&&i.TemplateFeatures.results;n.push({id:i.Id,title:i.Title,version:i.Version,schema:void 0,imageUrl:i.PreviewImageUrl,imageAltText:i.PreviewImageAltText,description:i.Description,supportedTemplates:s,designPackageId:void 0,thumbnailUrl:i.ThumbnailUrl,templateFeatures:o,isOutOfBoxTemplate:i.IsOutOfBoxTemplate,requiresGroupConnected:i.RequiresGroupConnected,requiresTeamsConnected:i.RequiresTeamsConnected,requiresYammerConnected:i.RequiresYammerConnected,isTenantAdminOnly:i.IsTenantAdminOnly,order:i.Order})}}return n}}return[]};e.prototype._getOutOfBoxTemplateSettingsFromServerData=function(e){if(e&&e.d&&e.d.GetOutOfBoxSiteTemplateSettings){var t=e.d.GetOutOfBoxSiteTemplateSettings.results;if(t&&t.length){for(var n=[],r=0;r<t.length;r++){var i=t[r];i&&n.push({id:i.Id,isHidden:i.IsHidden})}return n}}return[]};e.prototype._getSupportedTemplateTypes=function(e){var t=[];if(e)for(var n=0;n<e.length;n++){var r=e[n];if(r){var i=parseInt(r,10);isNaN(i)||t.push(i)}}return t};return e})();(function(e){e[e.newProgressData=0]="newProgressData";e[e.newNonProgressData=1]="newNonProgressData";e[e.openPanelAction=2]="openPanelAction"})(r||(r={}));(function(e){e[e.unknown=0]="unknown";e[e.old=1]="old";e[e.new=2]="new"})(i||(i={}));var h=(function(){function e(e,t){this._totalTimeWaited=0;this._useTimerV2=!1;this._useTimerV2=!0;this._nextTimeout=8;this._lastTimeout=8}e.prototype.getNextTimeout=function(){if(this._useTimerV2){var e=void 0;if(this._totalTimeWaited>=120){e=this._nextTimeout;this._nextTimeout=this._nextTimeout+this._lastTimeout;this._lastTimeout=e}else e=8;this._totalTimeWaited+=e;return 1e3*e}var t=this._lastTimeout;this._lastTimeout=this._nextTimeout;this._nextTimeout=this._nextTimeout+t;return 1e3*this._lastTimeout};return e})(),p="00000000-0000-0000-0000-000000000000",d=p,v=(function(){function e(e){var t=this;this._getSiteDesignProgress=function(e,n,s,o,u,a){if(!t.isRunComplete(n)){var f=setTimeout(t._getSiteDesignProgress.bind(t),o.getNextTimeout(),e,n,s,o,!1,a),l=!t._data[n].stageResultData||t._runCompletionStates[n].isSchemaDirty;t._provider.getSiteDesignRunStatus(e,l).then(function(e){if(e){var o=!1,u=!1;e.siteScriptData&&!e.siteScriptData.siteDesignTitle&&t._siteDesignRunDict[n]&&t._siteDesignRunDict[n].siteDesignTitle&&(e.siteScriptData.siteDesignTitle=t._siteDesignRunDict[n].siteDesignTitle);var l=t._getStageOutcomesKnownButIncomplete(e.stageResultData);if(e.siteScriptData){t._data[n].siteScriptData=e.siteScriptData;t._runCompletionStates[n].isSchemaDirty=!1;t._runCompletionStates[n].stagesRetrieved=!0;t._runCompletionStates[n].stagesRequired=e.siteScriptData.stageNames.length;o=!0}if(!t._data[n].stageResultData||e.stageResultData.length>t._data[n].stageResultData.length||l<t._runCompletionStates[n].stageOutcomesKnownButIncomplete){t._data[n].stageResultData=e.stageResultData;t._runCompletionStates[n].stageOutcomesKnown=e.stageResultData.length;t._runCompletionStates[n].stageOutcomesKnownButIncomplete=l;o=!0}var c=t.isRunComplete(n);if(t._runCompletionStates[n].age===i.unknown){t._runCompletionStates[n].age=c?i.old:i.new;o=!0}if(c){clearTimeout(f);if(t._runCompletionStates[n].age===i.new){t._state.hasARunCompleted=!0;u=!0}}if(o&&n===t._state.displayedRunKey){t._updateState(t._runCompletionStates[n]);t._notifyListeners(r.newProgressData)}else u&&t._notifyListeners(r.newProgressData)}else if(t._runCompletionStates[n].age===i.unknown){t._runCompletionStates[n].age=i.new;a&&t._getSiteDesignStages(n,s);if(n===t._state.displayedRunKey){t._updateState(t._runCompletionStates[n]);t._notifyListeners(r.newProgressData)}}},function(e){if(t._runCompletionStates[n].age===i.unknown){t._runCompletionStates[n].age=i.new;a&&t._getSiteDesignStages(n,s);if(n===t._state.displayedRunKey){t._updateState(t._runCompletionStates[n]);t._notifyListeners(r.newProgressData)}}404===e.status&&u&&t._provider.applyImplicitSiteDesign()})}};this._pageContext=e.pageContext;this._currentCultureName=this.getCurrentCultureName();this._webTemplate=e.pageContext?e.pageContext.webTemplate:"";this._provider=new c({dataSource:this.createSiteScriptProgressDataSource(),currentCultureName:this._currentCultureName});this._state={isSiteDesignPending:!1,stagesRetrieved:!1,stageOutcomesKnown:0,stageOutcomesKnownButIncomplete:0,displayedRunKey:d,stagesRequired:0,age:i.unknown,selectedTenantSiteDesign:"",hasARunCompleted:!1};this._runCompletionStates={};this._data={};this._registeredCallbacks=[];this._tenantSiteDesignsDict={};this._siteDesignRunDict={};this._siteDesignRunRequestSentDict={};this._tenantSiteDesignSchemaRequestSentDict={};this._triggeredOpenBefore=!1;e.pageContext?e.pageContext.hasPendingWebTemplateExtension?this._isSiteDesignPendingPromise=this._checkForPendingSiteDesign():this._isSiteDesignPendingPromise=Promise.resolve(!1):this._isSiteDesignPendingPromise=this._checkForPendingSiteDesign()}e.getInstance=function(t){e._instance||(e._instance=new e(t));return e._instance};e.prototype.createSiteScriptProgressDataSource=function(){return new l({pageContext:this._pageContext})};e.prototype.getCurrentCultureName=function(){return this._pageContext.currentCultureName};e.prototype.getWebTemplate=function(){return this._webTemplate};e.prototype.showSiteDesignRun=function(e){if(this._siteDesignRunDict[e]){if(!this._data[e]&&!this._siteDesignRunRequestSentDict[e]){this._siteDesignRunRequestSentDict[e]=!0;this._initializeRunData(e,i.unknown);this._getSiteDesignProgress(e,e,this._siteDesignRunDict[e].siteDesignId,new h(3,2),!1,!0)}this._updateState(Object(s.__assign)(Object(s.__assign)({},this._runCompletionStates[e]),{displayedRunKey:e,selectedTenantSiteDesign:"",selectedTenantSiteDesignSchema:void 0,showingTenantSiteDesigns:!1}));this._notifyListeners(r.newNonProgressData)}};e.prototype.showTenantSiteDesigns=function(){this._updateState({showingTenantSiteDesigns:!0,selectedTenantSiteDesign:"",selectedTenantSiteDesignSchema:void 0});this._notifyListeners(r.newNonProgressData)};e.prototype.hideTenantSiteDesigns=function(){if(this._state.showingTenantSiteDesigns){this._updateState({showingTenantSiteDesigns:!1,selectedTenantSiteDesign:"",selectedTenantSiteDesignSchema:void 0});this._notifyListeners(r.newNonProgressData)}};e.prototype.showTenantSiteDesign=function(e){var t=this;if(e){if(this._tenantSiteDesignsDict[e]){this._updateState({selectedTenantSiteDesign:e,selectedTenantSiteDesignSchema:this._tenantSiteDesignsDict[e].schema});this._notifyListeners(r.newNonProgressData);if(!this._tenantSiteDesignsDict[e].schema&&!this._tenantSiteDesignSchemaRequestSentDict[e]){this._tenantSiteDesignSchemaRequestSentDict[e]=!0;this._provider.getSiteDesignStages(e).then(function(n){n&&(t._tenantSiteDesignsDict[e].schema=n);if(t._state.selectedTenantSiteDesign===e){t._state.selectedTenantSiteDesignSchema=t._tenantSiteDesignsDict[e].schema;t._notifyListeners(r.newNonProgressData)}})}}}else{this._updateState({selectedTenantSiteDesign:"",selectedTenantSiteDesignSchema:void 0});this._notifyListeners(r.newNonProgressData)}};e.prototype.applySiteDesign=function(e){var t;if(this._tenantSiteDesignsDict[e]){t=this._tenantSiteDesignsDict[e];var n=Date.now().toString();this._siteDesignRunRequestSentDict[n]=!0;this._siteDesignRunDict[n]={siteDesignTitle:t.title,siteDesignId:e,runId:n,version:t.version,runDate:(new Date).toLocaleDateString(this._currentCultureName)};this._state.siteDesignRuns=Object(s.__spreadArrays)([this._siteDesignRunDict[n]],this._state.siteDesignRuns);this._initializeRunData(n,i.new);this._data[n].stageResultData=[];this._addSiteDesignTask(t,n);this._updateState(Object(s.__assign)(Object(s.__assign)({},this._runCompletionStates[n]),{displayedRunKey:n,showingTenantSiteDesigns:!1,selectedTenantSiteDesign:"",selectedTenantSiteDesignSchema:void 0}));this._notifyListeners(r.newNonProgressData)}};e.prototype.retrieveTenantSiteDesignsAndSiteDesignRuns=function(){var e=this;if(!this._requestedTenantSiteDesigns){this._requestedTenantSiteDesigns=!0;this._provider.getTenantSiteDesigns().then(function(t){o.e.logData({name:"SiteScripts.GetTenantSiteDesigns",extraData:{siteDesignCount:t?t.length:0}});e._updateState({tenantSiteDesigns:t});for(var n=0;n<t.length;n++)e._tenantSiteDesignsDict[t[n].id]=t[n];e._notifyListeners(r.newNonProgressData)})}this._getSiteDesignRuns()};e.prototype.getSiteDesignRun=function(e){return this._siteDesignRunDict[e]};e.prototype._addSiteDesignTask=function(e,t){var n=this;this._data[t].siteScriptData=e.schema;this._runCompletionStates[t].stagesRetrieved=!0;this._runCompletionStates[t].stagesRequired=this._data[t].siteScriptData.stageNames.length;this._runCompletionStates[t].isSchemaDirty=!0;this._provider.addSiteDesignTask(e.id).then(function(r){n._getSiteDesignProgress(r.taskId,t,e.id,new h(3,2),!1,!1)})};e.prototype._getSiteDesignRuns=function(){var e=this;this._siteDesignRunsPromise||(this._siteDesignRunsPromise=this._provider.getSiteDesignRuns().then(function(t){e._updateState({siteDesignRuns:t});for(var n=0;n<t.length;n++)e._siteDesignRunDict[t[n].runId]=t[n];e._notifyListeners(r.newNonProgressData);return t}));return this._siteDesignRunsPromise};e.prototype._getSiteDesignTasks=function(){this._siteDesignTasksPromise||(this._siteDesignTasksPromise=this._provider.getSiteDesignTasks());return this._siteDesignTasksPromise};e.prototype.getState=function(){return this._state};e.prototype.getData=function(e){return this._data[e]};e.prototype.getTenantSiteDesign=function(e){return this._tenantSiteDesignsDict[e]};e.prototype.registerCallback=function(e,t,n){this._registeredCallbacks[t]||(this._registeredCallbacks[t]={});this._registeredCallbacks[t][e]=n};e.prototype.unregisterCallback=function(e,t){var n=this._registeredCallbacks[t];n&&n.hasOwnProperty(e)&&delete n[e]};e.prototype.triggerOpenPanelAction=function(){var e=this;if(!this._triggeredOpenBefore){this._triggeredOpenBefore=!0;this._isSiteDesignPendingPromise.then(function(t){t||e._getSiteDesignRuns().then(function(t){if(t&&t.length){var n=t[0].runId;e._initializeRunData(n,i.unknown);e._updateState(Object(s.__assign)(Object(s.__assign)({},e._runCompletionStates[n]),{displayedRunKey:n}));e._notifyListeners(r.newNonProgressData);e._siteDesignRunRequestSentDict[n]=!0;e._getSiteDesignProgress(n,n,t[0].siteDesignId,new h(3,2),!1,!0)}})})}this._notifyListeners(r.openPanelAction)};e.prototype.isRunComplete=function(e){if(this._runCompletionStates[e]){var t=this._runCompletionStates[e];return t.stagesRetrieved&&t.stageOutcomesKnown===t.stagesRequired&&0===t.stageOutcomesKnownButIncomplete}return!1};e.prototype.getCompletionRatio=function(e){if(this._data&&this._data[e]&&this._data[e].siteScriptData&&this._data[e].siteScriptData.stageNames){return 0===this._data[e].siteScriptData.stageNames.length?1:Math.max(0,this._state.stageOutcomesKnown-this._state.stageOutcomesKnownButIncomplete)/this._data[e].siteScriptData.stageNames.length}return 0};e.prototype._updateState=function(e){this._state=Object(s.__assign)(Object(s.__assign)({},this._state),e)};e.prototype._initializeRunData=function(e,t){this._runCompletionStates[e]={stagesRetrieved:!1,stageOutcomesKnown:0,stageOutcomesKnownButIncomplete:0,stagesRequired:0,age:t};this._data[e]={siteScriptData:void 0,stageResultData:void 0}};e.prototype._notifyListeners=function(e){var t=this._registeredCallbacks[e];if(t)for(var n in t)if(t.hasOwnProperty(n))try{t[n](Object(s.__assign)({},this._state))}catch(e){}};e.prototype._checkForPendingSiteDesign=function(){var e=this;this._siteDesignRunRequestSentDict[d]=!0;return this._provider.getIsSiteDesignPending().then(function(t){if(t){e._initializeRunData(d,i.unknown);e._updateState(Object(s.__assign)(Object(s.__assign)({},e._runCompletionStates[d]),{isSiteDesignPending:!0}));e._notifyListeners(r.newProgressData);e._getSiteDesignProgress(d,d,p,new h(3,2),!0,!0);return!0}return e._getSiteDesignTasks().then(function(t){if(t.length){e._initializeRunData(t[0].taskId,i.new);e._updateState(Object(s.__assign)(Object(s.__assign)({},e._runCompletionStates[t[0].taskId]),{displayedRunKey:t[0].taskId,displayedSiteDesignId:t[0].siteDesignId,isSiteDesignPending:!0}));e._notifyListeners(r.newProgressData);e._getSiteDesignProgress(t[0].taskId,t[0].taskId,t[0].siteDesignId,new h(3,2),!1,!0);return!0}e._updateState({canRenderWebTemplatesGalleryFirstRun:!0});e._notifyListeners(r.newProgressData);return!1})},function(){return!1})};e.prototype._getSiteDesignStages=function(e,t){var n=this,i=this._provider.getSiteDesignStages(t);i.then(function(t){if(!n._data[e].siteScriptData){n._data[e].siteScriptData=t;n._runCompletionStates[e].stagesRetrieved=!0;n._runCompletionStates[e].stagesRequired=t.stageNames.length;n._runCompletionStates[e].isSchemaDirty=!0;if(e===n._state.displayedRunKey){n._updateState(n._runCompletionStates[e]);n._notifyListeners(r.newNonProgressData)}}});return i};e.prototype._getStageOutcomesKnownButIncomplete=function(e){for(var t=0,n=0;n<e.length;n++)4===e[n].outcomeCode&&(t+=1);return t};return e})()},2244:function(e,t,n){"use strict";n.d(t,"e",function(){return o});n.d(t,"t",function(){return c});var r,i=n(0),s=n(477);(function(e){e.PREFIX="MultilingualPages";e.Page="Page";e.Settings="MuiSettings";e.Panel="TranslationPanel";e.LangSelector="LanguageSelector"})(r||(r={}));var o,u=n(2999),a=n(84),f=n(44),l="/_api/web/navigation/GetNodeById($NodeId)/TitleResource/GetResourceEntries";(function(e){e[e.NewNavNode=0]="NewNavNode";e[e.ExistingNavNode=1]="ExistingNavNode";e[e.SiteTitle=2]="SiteTitle";e[e.SiteDescription=3]="SiteDescription"})(o||(o={}));var c=(function(e){Object(i.__extends)(t,e);function t(t){var n,i,s=e.call(this,{id:"TranslationsDataSource",dataSourceName:"TranslationsDataSource"},{pageContext:t})||this;s.clearCache=function(){s.flushCache(s._cacheRequestKey)};s.getTranslations=function(e,t){var n=new a.e({name:r.PREFIX+".MUIEditing.NAVGetResourceEntries"});return s.getTranslationsPromise(e,{navNodeKey:t}).then(function(e){n.end({resultType:f.e.Success});return s.formatTranslations(e)}).catch(function(e){n.end({resultType:f.e.Failure,resultCode:""+(e?e.status:"undefined error"),error:e&&e.message?e.message.toString():"GetResourceEntries failed",extraData:{userId:s._pageContext.userId,tenantID:s._pageContext.siteSubscriptionId,correlationId:e?e.correlationId:"undefined error"}});return[]})};s.getAllSupportedLanguages=function(){var e=new a.e({name:r.PREFIX+".MUIEditing.GetSupportedLanguages"});return s.getAllSupportedLanguagesPromise().then(function(t){e.end({resultType:f.e.Success});return s._getAllSupportedLanguagesWithDefaultValue(t)}).catch(function(t){e.end({resultType:f.e.Failure,resultCode:""+(t?t.status:"undefined error"),error:t&&t.message?t.message.toString():"GetSupportedLanguages failed",extraData:{userId:s._pageContext.userId,tenantID:s._pageContext.siteSubscriptionId,correlationId:t?t.correlationId:"undefined error"}});return[]})};s.formatTranslations=function(e){return e?e.map(function(e){return{code:e.LCID,language:u.e.getResourceByCode(e.LCID)||"",value:e.Value}}):[]};s.getTranslationsPromise=function(e,t){if(!s._pageContext||!s._pageContext.webId)return Promise.reject("MissingWebId");var n=s._pageContext.webAbsoluteUrl,r="",i="";switch(e){case o.ExistingNavNode:i=n+l.replace("$NodeId",t.navNodeKey);r="MUIEditingGetNavTranslations";break;case o.SiteTitle:i=n+"/_api/web/TitleTranslations";r="MUIEditingGetSiteTitleTranslations";break;case o.SiteDescription:i=n+"/_api/web/DescriptionTranslations";r="MUIEditingGetSiteDescriptionTranslations"}var u={url:i,qosName:r,parseResponse:function(e){return e&&JSON.parse(e).value},method:"GET",additionalHeaders:{"ODATA-VERSION":"4.0",Accept:"*/*, application/json; odata.metadata=minimal"},contentType:"application/json; odata.metadata=minimal",maxRetries:1,cachingStrategy:3};return s.getDataUtilizingPersistentCache(u).catch(function(e){throw e})};s.getAllSupportedLanguagesPromise=function(){if(!s._pageContext||!s._pageContext.webId)return Promise.reject("MissingWebId");var e={url:s._pageContext.webAbsoluteUrl+"/_api/web//SupportedUILanguageIds",qosName:"GetAllSupportedLanguagesMUIEditing",parseResponse:function(e){return e&&JSON.parse(e).value},method:"GET",additionalHeaders:{"ODATA-VERSION":"4.0",Accept:"*/*, application/json; odata.metadata=minimal"},contentType:"application/json; odata.metadata=minimal",maxRetries:1,cachingStrategy:3};return s.getDataUtilizingPersistentCache(e).catch(function(e){throw e})};s._getAllSupportedLanguagesWithDefaultValue=function(e){return e.map(function(e){return{code:e,language:u.e.getResourceByCode(e)||"",value:""}})};s._cacheRequestKey="TranslationsDataSource_"+(null===(n=t)||void 0===n?void 0:n.siteId)+"_"+(null===(i=t)||void 0===i?void 0:i.webId);return s}t.convertTranslationInputToSPResourceEntry=function(e){return e.map(function(e){return{LCID:e.code,Value:e.value}})};t.getDisplayLanguage=function(e,t){var n=e.filter(function(e){var n;return e.code===(null===(n=t)||void 0===n?void 0:n.currentLanguage)}),r=e.filter(function(e){var n;return e.code===(null===(n=t)||void 0===n?void 0:n.webLanguage)});return[1===n.length&&n[0].value.trim().length>0?n[0]:r[0],r[0]]};return t})(s.t)},2277:function(e,t,n){"use strict";n.d(t,"i",function(){return s});n.d(t,"n",function(){return o});n.d(t,"r",function(){return u});n.d(t,"t",function(){return a});n.d(t,"e",function(){return f});var r=n(245),i={ODB:751};function s(){return r.n.isFeatureEnabled(i)}function o(e){if(s())return"https://tip1.flow.microsoft.com";var t=e&&e.farmSettings&&e.farmSettings.ExternalService_flowhostname;return t?"https://"+t:"https://flow.microsoft.com"}function u(e,t){return o(t)+"/manage/environments/"+e.environmentId+"/flows/shared/"+e.id+"/details"}function a(e,t){return o(t)+"/manage/environments/"+e+"/approvals/received"}var f=function(){}},2303:function(e,t,n){"use strict";n.r(t);var r;(function(e){e.getParent=function(e,t){if(e.level&&e.parentKey&&0!==e.level){return t.filter(function(t){return t.groupingId===e.parentKey})[0]}};e.getFilterDetails=function(n,r){for(var i=n,s=[],o=[];i&&i.fieldSchema;){s.unshift(i.fieldSchema.Name);var u=t(i);o.unshift(u);i=e.getParent(i,r)}return{fields:s,values:o}};function t(e){var t="";switch(e.fieldSchema.Type){case"User":case"Lookup":t=e.name;break;case"DateTime":var n=decodeURIComponent(e.groupString).split(";#"),r=n[0];n.length>0&&(n=n.slice(1,n.length-1))[e.level]&&(r=n[e.level]);t=(function(e){if(!e)return e;var t=e.substring(0,4),n=e.substring(4,6),r=e.substring(6,8);return[t,"-",n,"-",r].join("")})(r);break;default:t=e.fieldValue}return t}})(r||(r={}));t.default=r},2329:function(e,t,n){"use strict";n.d(t,"e",function(){return r});n.d(t,"r",function(){return i});n.d(t,"n",function(){return s});n.d(t,"t",function(){return o});var r="role:1073741827",i="role:1073741826",s="role:1073741829",o="role:1073741830"},2334:function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=n(379),i=n(465);function s(e,t){var n=Object(r.e)(e).id;t&&t.urlParts&&(n===t.urlParts.fullListUrl||n===t.urlParts.serverRelativeListUrl)&&(n=void 0);return n}function o(e,t){var n=e;0!==n.indexOf("id")&&(n=Object(i.e)({id:e,listurl:t}));return n}},2336:function(e,t,n){"use strict";n.d(t,"t",function(){return s});var r;(function(e){e[e.unknown=1]="unknown";e[e.odb=2]="odb";e[e.sharePoint=3]="sharePoint";e[e.ngsc=4]="ngsc";e[e.word=5]="word";e[e.powerpoint=6]="powerpoint";e[e.excel=7]="excel";e[e.onenoteWeb=8]="onenoteWeb";e[e.wac=9]="wac";e[e.visio=10]="visio";e[e.officecom=11]="officecom";e[e.listPart=12]="listPart";e[e.outlookWeb=13]="outlookWeb";e[e.odIos=14]="odIos";e[e.odAndroid=15]="odAndroid";e[e.teams=16]="teams";e[e.sample=17]="sample";e[e.odc=18]="odc";e[e.wordAndroid=19]="wordAndroid";e[e.excelAndroid=20]="excelAndroid";e[e.powerpointAndroid=21]="powerpointAndroid";e[e.wordIos=22]="wordIos";e[e.excelIos=23]="excelIos";e[e.powerpointIos=24]="powerpointIos";e[e.onenote=25]="onenote";e[e.teamsIos=26]="teamsIos";e[e.teamsAndroid=27]="teamsAndroid";e[e.onenoteIos=28]="onenoteIos";e[e.visioIos=29]="visioIos";e[e.onenoteAndroid=30]="onenoteAndroid";e[e.visioAndroid=31]="visioAndroid";e[e.outlookWindows=32]="outlookWindows";e[e.outlookMac=33]="outlookMac";e[e.onenoteUWP=34]="onenoteUWP";e[e.officemobileIos=35]="officemobileIos";e[e.officemobileAndroid=36]="officemobileAndroid";e[e.odcWac=37]="odcWac";e[e.outlookGroupsWeb=38]="outlookGroupsWeb";e[e.fluid=39]="fluid";e[e.modernFileExplorer=40]="modernFileExplorer";e[e.listsHome=41]="listsHome";e[e.listsIos=42]="listsIos";e[e.edgeEnterpriseNtp=43]="edgeEnterpriseNtp";e[e.officeFeed=44]="officeFeed";e[e.searchUx=45]="searchUx";e[e.consumerList=46]="consumerList";e[e.shareDemo=47]="shareDemo";e[e.onePlayer=48]="onePlayer"})(r||(r={}));var i=void 0;function s(e){if(void 0===i){i={};for(var t in r){var n=parseInt(t);if(!isNaN(n)){var s=r[n].toLowerCase();i[s]=n}}}var o=e?e.toLowerCase():"";return i[o]||r.unknown}t.e=r},2370:function(e,t,n){"use strict";n.d(t,"e",function(){return E});var r=n(0),i=n(83),s=n(245),o=n(244),u=n(58),a=n(592),f=n(1888),l=n(69),c=n(2605),h=n(772),p=n(366),d=n(2865),v=n(2357),m=n(2018),g=n(67),y=n(2153),b=n(54),w={ODB:60307},E=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=this,i=S(t)?t:n.pageContext;r=e.call(this,{},{pageContext:i})||this;var s=S(t)?t.apiUrlHelper:n.apiUrlHelper;r._apiUrlHelper=s||new h.e({},{itemUrlHelper:new p.e({},{pageContext:i}),pageContext:i});r._capabilities={supportsMruCaching:!0};if(n){r._dataRequestor=n.dataRequestor;r._graphPeoplePickerHelper=n.graphPeoplePickerHelper;r._substratePeoplePickerHelper=n.substratePeoplePickerHelper;r._livePeoplePickerHelper=n.livePeoplePickerHelper;r._getAuthToken=n.getAuthToken}r._webAbsoluteUrl=i.webAbsoluteUrl;return r}t.prototype.getCapabilities=function(){return this._capabilities};t.prototype.getPersonaDetails=function(e){var t=this;return l.n.resolve(this._getAuthToken&&this._getAuthToken(this._pageContext.webAbsoluteUrl)).then(function(n){return t.dataRequestor.getData({url:t._apiUrlHelper.build().segment("sp.publishing.personmagazine.GetPersonMagazineUserProfileDataForUser").parameter("accountName",e).toString(),qosName:"GetPersonaDetails",authToken:n,parseResponse:function(e){var n=function(e){return{name:e.DisplayName,email:e.Email,userId:e.AccountName,office:e.Office,image:e.PictureUrl,job:e.Title,department:e.DepartmentName,phone:e.Phone,sip:e.Lync}},r=JSON.parse(e).d.GetPersonMagazineUserProfileDataForUser,s={personDetails:n(r.Primary),managerChain:r.ManagerChain.results.map(n),directReports:r.DirectReports.results.map(n)};s.personDetails.profilePage=Object(i.r)(t._pageContext)+"/_layouts/15/me.aspx?p="+encodeURIComponent(s.personDetails.sip)+"&origin=ProfileODBCard";return s}})})};t.prototype.getPickerEntityInformation=function(e){var t=this,n=0;e.principalType===f.e.sharePointGroup&&(n=Number(e.rawPersonData.EntityData.SPGroupID));var r=JSON.stringify({entityInformationRequest:{PrincipalType:e.principalType,EmailAddress:e.email,GroupId:n}});return l.n.resolve(this._getAuthToken&&this._getAuthToken(this._pageContext.webAbsoluteUrl)).then(function(n){return t.dataRequestor.getData({url:t._apiUrlHelper.build().segment("SP.UI.ApplicationPages.ClientPeoplePickerWebServiceInterface.GetPickerEntityInformation").toString(),additionalPostData:r,qosName:"getPickerEntityInformation",authToken:n,noRedirect:!0,parseResponse:function(t){return{totalMemberCount:JSON.parse(t).d.TotalMemberCount,person:e}}})})};t.prototype.resolve=function(e,t){var n=this;return l.n.resolve(this._getAuthToken&&this._getAuthToken(this._pageContext.webAbsoluteUrl)).then(function(r){var i=t.listId&&{querycontext:t.listId};return n.dataRequestor.getData({url:n._apiUrlHelper.build().segment("SP.UI.ApplicationPages.ClientPeoplePickerWebServiceInterface.ClientPeoplePickerResolveUser").toString(),additionalPostData:n._constructPostBody(e,t),qosName:"Resolve",authToken:r,additionalHeaders:i,parseResponse:function(e){var r=JSON.parse(e),i=JSON.parse(r.d.ClientPeoplePickerResolveUser),s=[];s[0]=i;i.IsResolved||i.EntityData.IsBlockedOnODB&&"true"===i.EntityData.IsBlockedOnODB.toLowerCase()||(s[0].DisplayText=i.Key);var o=(s=n._transformData(s,t.filterExternalUsers))[0];if(t.filterExternalUsers&&o&&1===o.entityType){o.isResolved=!1;o.entityType=0}else if(t.blockViaPolicy&&!t.filterExternalUsers&&o&&!o.isResolved&&0===o.multipleMatches.length){o.isResolved=!0;o.isExternal=!0;o.entityType=1}if(t.isGraphDistributionList&&t.useGraph&&o.isExternal){o.entityType=2;o.principalType=f.e.distributionList}return o}})})};t.prototype.canUseGraph=function(e){var t=e&&e.useGraph&&this._graphPeoplePickerHelper&&this._graphPeoplePickerHelper.canUseGraph();t&&!this._dataRequestor&&(this._dataRequestor=new v.t({},{}));return t};t.prototype.canUseSubstrate=function(e){var t=e.useSubstrate&&this._substratePeoplePickerHelper&&this._substratePeoplePickerHelper.canUseSubstrate();t&&!this._dataRequestor&&(this._dataRequestor=new v.t({},{}));return t};t.prototype.getLivePersonaPickerHelper=function(){return this._livePeoplePickerHelper};t.prototype.search=function(e,t){return this.canUseSubstrate(t)?this._substrateSearch(e,t):this.canUseGraph(t)?this._graphSearch(e,t):this.sharePointSearch(e,t)};t.prototype.sharePointSearch=function(e,t){var n=this;t.onToggleGetMoreResults&&t.onToggleGetMoreResults(!1);return l.n.resolve(this._getAuthToken&&this._getAuthToken(this._pageContext.webAbsoluteUrl)).then(function(r){var i=t.listId&&{querycontext:t.listId};return n.dataRequestor.getData({url:n._apiUrlHelper.build().segment("SP.UI.ApplicationPages.ClientPeoplePickerWebServiceInterface.ClientPeoplePickerSearchUser").toString(),additionalPostData:n._constructPostBody(e,t),qosName:"Search",additionalHeaders:i,authToken:r,parseResponse:function(r){var i=t.allowSharePointGroups,s=void 0===i||i,o=t.filterExternalUsers,u=JSON.parse(r),a=JSON.parse(u.d.ClientPeoplePickerSearchUser),l=n._transformData(a,o);o&&(l=l.filter(function(e){return 1!==e.entityType}));l=l.filter(function(e){return e.principalType===f.e.sharePointGroup?s:e.principalType===f.e.securityGroup?s||n._isValidEmail(e.email,!0):n._isValidEmail(e.email,!1)});if(!1!==t.resolveEmailIfNoResults&&0===l.length&&n._isValidEmail(e,!1)){var c={Key:e,IsResolved:!1};l.push({email:e,entityType:1,isResolved:!1,job:!1===t.fallbackToEmailIfNoJob?void 0:e,name:e,userId:e,rawData:c,rawPersonData:c,isExternal:!0})}return l}})})};t.prototype.subscribePresence=function(e,t){var n=this;try{this._ensureSkypePresence();if(!O365Shell_Shim.SkypeIntegration.isAvailable())return null;var r=function(e){try{switch(e){case 0:t(0);break;case 1:t(1);break;case 2:t(2);break;case 3:t(3);break;case 4:t(4);break;case 5:t(5);break;case 6:t(6);break;case 8:t(7);break;default:t(0)}}catch(e){}};this._skypeIntegration.TrackPresence(e,r);return{dispose:function(){try{n._skypeIntegration.UntrackPresence(e,r)}catch(e){}}}}catch(e){}return null};t.prototype.sendSourceName=function(){return"PeoplePickerDataSource"};t.prototype._constructPostBody=function(e,t){var n={queryParams:{QueryString:e,MaximumEntitySuggestions:t.maximumEntitySuggestions,AllowEmailAddresses:t.allowEmailAddresses,AllowOnlyEmailAddresses:t.allowOnlyEmailAddresses,PrincipalType:t.principalType,PrincipalSource:t.principalSource,UseSubstrateSearch:t.useSubstrateSearch,SharePointGroupID:t.groupID,QuerySettings:t.querySettings}};return JSON.stringify(n)};t.prototype._ensureSkypePresence=function(){var e=this;try{if(!Boolean(this._skypeIntegration)){var t=new O365Shell_Shim.SkypeIntegration;t.OnApiReady(function(){e._skypeIntegration=t})}}catch(e){}};t.prototype._graphSearch=function(e,n){var r=this;return this._graphPeoplePickerHelper.getGraphToken().then(function(i){if(!i)return r.sharePointSearch(e,n);var s=new b.t("https://graph.microsoft.com/v1.0/me/people");if(e){s.setQueryFromObject({$search:'"'+e+'"',$top:"30",$select:"displayName,scoredEmailAddresses,personType,department,jobTitle,userPrincipalName"});if(g.t.isActivated("08c31a2f-5109-4dd9-b6ab-d6ea8fec0d9f","09/29/2020","Fix bug: Should correctly handle PrincipalType in Graph query filter."))!1!==n.filterPublicDistributionList&&s.setQueryParameter("$filter","personType/subclass ne 'PublicDistributionList'");else{var o=t._getPersonTypeFilter(n);o&&s.setQueryParameter("$filter",o)}}return r._dataRequestor.send({apiName:"Graph.PeopleSearch",path:s.toString(),headers:{Authorization:"Bearer "+i,"X-PeopleQuery-QuerySources":"Mailbox,Directory"},needsAuthorization:!1}).then(function(t){n.onToggleGetMoreResults&&n.onToggleGetMoreResults(!0);if(!t||!t.value||0===t.value.length)return r.sharePointSearch(e,n);var i=t.value,s=[];i.forEach(function(e){if(!e.personType.subclass||!r._isIgnorablePeopleSubType(e.personType.subclass)){var t=e.scoredEmailAddresses[0]?e.scoredEmailAddresses[0].address:"",i=e.userPrincipalName&&r._isValidEmail(e.userPrincipalName,!1)?e.userPrincipalName:t,o={Key:i,IsResolved:!1},u="ImplicitContact"===e.personType.subclass,a="OrganizationUser"===e.personType.subclass,l="Group"===e.personType.class&&"UnifiedGroup"===e.personType.subclass,c="PublicDistributionList"===e.personType.subclass,h=Object(d.n)(r._webAbsoluteUrl,t),p={department:e.department,email:t,image:u?void 0:h,job:!1===n.fallbackToEmailIfNoJob?e.jobTitle:e.jobTitle||t,name:e.displayName,providerName:a?"Provider":void 0,userId:i,rawData:o,rawPersonData:o,isExternal:!a,aadObjectId:e.id};if(a){p.entityType=0;p.principalType=f.e.user;p.isResolved=!0}else if(l){p.entityType=2;p.principalType=f.e.securityGroup;p.isResolved=!1;p.userId=e.id}else{p.principalType=c?f.e.distributionList:f.e.none;p.entityType="Group"===e.personType.class?2:1;p.isResolved=!1;p.providerName=void 0}p.userId&&s.push(p)}});if(!1!==n.resolveEmailIfNoResults&&0===s.length&&r._isValidEmail(e,!1)){var o={Key:e,IsResolved:!1};s.push({email:e,entityType:1,isResolved:!1,job:!1===n.fallbackToEmailIfNoJob?void 0:e,name:e,userId:e,rawData:o,rawPersonData:o,isExternal:!0})}return s},function(t){if(Object(m.s)(t))switch(t.status){case 400:case 401:case 403:case 404:r._graphPeoplePickerHelper.disableGraphCallsForPicker();return r.sharePointSearch(e,n);default:return r.sharePointSearch(e,n)}else"Canceled"!==t.name&&r._graphPeoplePickerHelper.disableGraphCallsForPicker();return"Canceled"===t.name?null:r.sharePointSearch(e,n)})})};t.prototype._substrateSearch=function(e,t){var n=this;return this._substratePeoplePickerHelper.getSubstrateToken().then(function(r){if(!r)return n.sharePointSearch(e,t);var i=null;t.siteIBSegmentIDs&&t.siteIBSegmentIDs.length>0&&(i=t.siteIBSegmentIDs);var a=["Mailbox","Directory"],l={Authorization:"Bearer "+r},h="";if(g.t.isActivated("c6b7bed6-b1dd-47a1-b983-66f70105c321","10/13/2021","Change to use calculated filter for 3S.")||o.e.isFeatureEnabled({ECS:100414})||!s.n.isFeatureEnabled(w))h=s.n.isFeatureEnabled(w)&&!g.t.isActivated("0576d3d3-42b4-4c60-a920-0e10e34a19a0","05/13/2021","Pass SiteIBMode to 3S.")?JSON.stringify({EntityRequests:[{EntityType:"People",ProvenanceMergeMode:"Default",Provenances:a,Query:{QueryString:e},From:0,Size:25,Fields:["DisplayName","EmailAddresses","CompanyName","JobTitle","OfficeLocation","Department","UserPrincipalName","PeopleType","PeopleSubtype"],InformationBarrierMode:t.siteIBMode,Filter:i?{Or:i.map(function(e){return{Term:{InformationBarrierSegment:e}}})}:null}],TimeZone:"UTC",Cvid:t.conversationId,Scenario:{Name:"documentshare"}}):JSON.stringify({EntityRequests:[{EntityType:"People",ProvenanceMergeMode:"Default",Provenances:a,Query:{QueryString:e},From:0,Size:25,Fields:["DisplayName","EmailAddresses","CompanyName","JobTitle","OfficeLocation","Department","UserPrincipalName","PeopleType","PeopleSubtype"],Filter:i?{Or:i.map(function(e){return{Term:{InformationBarrierSegment:e}}})}:null}],TimeZone:"UTC",Cvid:t.conversationId,Scenario:{Name:"documentshare"}});else{var p=u.e.isValidGuid(e),v={Or:["OrganizationUser","Guest","PublicDistributionList","UnifiedGroup"].map(function(e){return{Term:{PeopleSubtype:e}}})},m=i?{Or:i.map(function(e){return{Term:{InformationBarrierSegment:e}}})}:null,y=p?{Or:{Term:{ExternalDirectoryObjectId:e}}}:null,b=i||p?p?i?{And:[v,m,y]}:{And:[v,y]}:{And:[v,m]}:v;h=JSON.stringify({EntityRequests:[{EntityType:"People",ProvenanceMergeMode:"Default",Provenances:a,Query:{QueryString:p?null:e},From:0,Size:25,Fields:["DisplayName","EmailAddresses","CompanyName","JobTitle","OfficeLocation","Department","UserPrincipalName","PeopleType","PeopleSubtype"],InformationBarrierMode:t.siteIBMode,Filter:b}],TimeZone:"UTC",Cvid:t.conversationId,Scenario:{Name:"documentshare"}})}return n._dataRequestor.send({apiName:"Substrate.PeopleSearch",path:c.e+"/api/v1/suggestions",headers:l,needsAuthorization:!1,requestType:"POST",postData:h}).then(function(r){t.onToggleGetMoreResults&&t.onToggleGetMoreResults(!0);var i=r.Groups[0]?r.Groups[0].Suggestions:[],s=[];i.forEach(function(e){if(!e.PeopleSubtype||!n._isIgnorablePeopleSubType(e.PeopleSubtype)){var r=e.EmailAddresses[0]||e.QueryText||"",i=e.UserPrincipalName&&n._isValidEmail(e.UserPrincipalName,!1)?e.UserPrincipalName:r,o={Key:i,IsResolved:!1},u="ImplicitContact"===e.PeopleSubtype,a="OrganizationUser"===e.PeopleSubtype,l="LinkedIn"===e.PeopleSubtype,c="Group"===e.PeopleType&&"UnifiedGroup"===e.PeopleSubtype,h="PublicDistributionList"===e.PeopleSubtype,p=Object(d.n)(n._webAbsoluteUrl,r),v={department:e.Department,office:e.OfficeLocation,email:r,image:u?void 0:p,job:!1===t.fallbackToEmailIfNoJob?e.JobTitle:e.JobTitle||r,name:e.DisplayName,providerName:"Provider",userId:i,rawData:o,rawPersonData:o,isExternal:!a};if(a){v.entityType=0;v.principalType=f.e.user;v.isResolved=!0}else if(c){v.entityType=2;v.principalType=f.e.securityGroup;v.isResolved=!1;v.providerName=void 0}else if(l)v.entityType=4;else{v.principalType=h?f.e.distributionList:f.e.none;v.entityType="Group"===e.PeopleType?2:1;v.isResolved=!1;v.providerName=void 0}v.userId&&s.push(v)}});if(!1!==t.resolveEmailIfNoResults&&0===s.length&&n._isValidEmail(e,!1)){var o={Key:e,IsResolved:!1};s.push({email:e,entityType:1,isResolved:!1,job:!1===t.fallbackToEmailIfNoJob?void 0:e,name:e,userId:e,rawData:o,rawPersonData:o,isExternal:!0})}return s},function(r){if("Canceled"!==r.name){n._substratePeoplePickerHelper.disableSubstrateCallsForPicker();n.sharePointSearch(e,t)}return null})})};t.prototype._isValidEmail=function(e,t){return e?!(e.indexOf(" ")>-1||e.indexOf(";")>-1)&&y.e.isValidEmailSyntax(e,!1):!t};t._getPersonTypeFilter=function(e){if(g.t.isActivated("912d7eb4-a793-407d-93f8-66d450380f90","10/13/2021","Fix bug: Should have filter include viable results only vs excluding non-viable results")||o.e.isFeatureEnabled({ECS:100416})){if(e.principalType===f.e.user)return"personType/class ne 'Group'";t="";e.principalType&f.e.distributionList||(t+="personType/subclass ne 'PublicDistributionList'");if(!(e.principalType&f.e.securityGroup)){t&&(t+=" and ");t+="personType/subclass ne 'UnifiedGroup'"}return t||(!1!==e.filterPublicDistributionList?"personType/subclass ne 'PublicDistributionList'":"")}var t="";e.principalType&f.e.user&&(t+="personType/subclass eq 'OrganizationUser' or personType/subclass eq 'Guest'");if(e.principalType&f.e.securityGroup){t&&(t+=" or ");t+="personType/subclass eq 'UnifiedGroup'"}if(e.principalType&f.e.distributionList&&!1!==e.filterPublicDistributionList){t&&(t+=" or ");t+="personType/subclass eq 'PublicDistributionList'"}return t};t.prototype._isIgnorablePeopleSubType=function(e){if(!e)return!1;return["PersonalDistributionList","ImplicitGroup","Unknown"].some(function(t){return t===e})};t.prototype._transformData=function(e,t){var n=this;return e.map(function(e){var r=e.EntityData,i={name:e.DisplayText,email:r.Email,userId:e.Key,job:r.Title,department:r.Department,phone:r.MobilePhone,providerName:e.ProviderDisplayName,entityType:e.EntityType,isResolved:e.IsResolved,multipleMatches:e.MultipleMatches,rawPersonData:e,rawData:e};if(i.multipleMatches.length>0){i.multipleMatches=n._transformData(i.multipleMatches,t);t&&(i.multipleMatches=i.multipleMatches.filter(function(e){return 1!==e.entityType}))}var s=i.email;i.isResolved&&(i.image=s?Object(d.n)(n._webAbsoluteUrl,s):null);var o=r.PrincipalType||e.EntityType;switch(o){case"UNVALIDATED_EMAIL_ADDRESS":case"GUEST_USER":i.entityType=1;i.principalType=f.e.user;i.isExternal=!0;break;case"SecGroup":case"SharePointGroup":case"FormsRole":i.entityType=2;i.principalType="SharePointGroup"===o?f.e.sharePointGroup:f.e.securityGroup;break;default:i.entityType=0;i.principalType=f.e.user}return i})};return t})(a.t);function S(e){return!!e.webAbsoluteUrl}},2403:function(e,t,n){"use strict";n.d(t,"e",function(){return h});var r=n(0),i=n(592),s=n(59),o=n(33),u=n(366),a=n(772),f=n(390),l=n(2334),c=n(67).t.isActivated("29873e89-d94c-4bb0-8f5b-dfd437f6422c","6/19/2021","Look for filters within the folder structure for doclib by using GetListUsingPath API"),h=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,{},{pageContext:t.pageContext})||this;n._listContext=t.listContext;n._itemUrlHelper=t.itemUrlHelper||new u.e({},{pageContext:t.pageContext});n._apiUrlHelper=t.apiUrlHelper||new a.e({},{pageContext:t.pageContext,itemUrlHelper:n._itemUrlHelper});n._folderPath=t.folderPath;void 0===n._folderPath&&(n._folderPath=Object(l.t)(t.parentKey,n._listContext));return n}t.prototype.getFilterData=function(e,t,n,r){var i=this;return this.getData(function(){return i._getFilterDataUrl(e,t,n,r)},function(e){return e},"GetFilterData")};t.prototype._getFilterDataUrl=function(e,t,n,r){var i,u,a=this._itemUrlHelper.getUrlParts({path:this._listContext.listUrl,listUrl:this._listContext.listUrl});u=c?this._apiUrlHelper.build().webByItemUrl(a).method("GetList",a.serverRelativeListUrl).segment("RenderListFilterData").parameter("FieldInternalName",e):this._apiUrlHelper.build().webByItemUrl(a).methodWithAliases("GetListUsingPath",{DecodedUrl:a.serverRelativeListUrl}).segment("RenderListFilterData").parameter("FieldInternalName",e);n&&"f9ebc8b2-a976-48f0-a8fa-0846164c0466"!==n&&(u=u.parameter("ViewId",n));this._folderPath&&(u=u.parameter("RootFolder",{raw:s.e.encodeURIComponent(this._folderPath)}));r&&r===o.e.Taxonomy&&(u=u.parameter("ExcludeFieldFilteringHtml",!0));var l=Object(f.getFilterParams)(t,!0,{replaceMeFormatFilterWithCurrentUser:!0,currentUserDisplayName:null===(i=this._pageContext)||void 0===i?void 0:i.userDisplayName});return(u=u.rawParameter(l)).toString()};return t})(i.t)},2430:function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r=n(0),i=n(2077),s=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,Object(r.__assign)(Object(r.__assign)({},t),{isExpected:o(t.errorType)}))||this;n.message=t.message;n.errorType=t.errorType||i.e.other;n.maxSizeInBytes=t.maxSizeInBytes;n.allowRename=t.allowRename||!1;n.allowMerge=t.allowMerge||!1;n.supportsVersioning=t.supportsVersioning||!1;n.extraData=t.extraData;n.libraryName=t.libraryName;n.isFolder=t.isFolder;n.fixItUrl=t.fixItUrl;return n}return t})(n(82).e);function o(e){switch(e){case i.e.conflict:case i.e.similarNameExists:case i.e.emptyFileOrFolder:case i.e.emptyFileOrFolderForDocLib:case i.e.fileSize:case i.e.folderUploadNotSupported:case i.e.insufficientVaultQuota:case i.e.invalidName:case i.e.lockMismatch:case i.e.malwareDetected:case i.e.overQuota:case i.e.overQuotaSharedFolder:case i.e.pathTooLong:case i.e.targetFolderMissing:case i.e.throttled:case i.e.unlockRequired:case i.e.versionMismatch:return!0;case i.e.accessDenied:case i.e.itemNotFound:case i.e.disconnected:case i.e.authFailure:case i.e.general:return!1;case i.e.none:case i.e.other:return}}},2470:function(e,t,n){"use strict";n.d(t,"e",function(){return l});n.d(t,"t",function(){return c});var r=n(69),i=n(245),s=n(84),o=n(44),u=n(248),a=n(114),f={ODB:387},l="https://graph.microsoft.com",c=(function(){function e(e,t){this._pageContext=t.pageContext;this._sharingContextInformation=t.sharingContextInformation;this._oAuthTokenProvider=t.oAuthTokenProvider;this._sharingContextInformation&&this._sharingContextInformation.additionalTokens&&(this._graphToken=this._sharingContextInformation.additionalTokens.graphToken);this.initializeDataStore()}e.prototype.canUseGraph=function(){if(this._graphToken)return!0;if(this._pageContext&&!this._pageContext.isSPO)return!1;if(this._pageContext&&this._pageContext.authToken)return!1;var e=this._pageContext&&this._oAuthTokenProvider&&i.n.isFeatureEnabled(f);this._dataStore&&(e=e&&!this._dataStore.getValue("DisableGraph",a.e.session));return e};e.prototype.disableGraphCallsForPicker=function(){this.initializeDataStore();this._dataStore.setValue("DisableGraph",!0,a.e.session)};e.prototype.getGraphToken=function(){var e=this;if(this._graphToken)return r.n.resolve(this._graphToken);if(this._oAuthTokenProvider){var t=new s.e({name:"PeoplePicker.GetGraphToken"});return this._oAuthTokenProvider.getToken(l).then(function(e){t.end({resultType:o.e.Success});return e},function(n){if(r.n.isCanceled(n)){t.end({resultType:o.e.ExpectedFailure,resultCode:"Canceled"});return r.n.reject(n)}t.end({resultCode:"PeoplePicker.GetGraphTokenError",resultType:o.e.Failure,extraData:{serverErrorCode:n._serverErrorCode,message:n.message}});e.disableGraphCallsForPicker();return null})}return null};e.prototype.initializeDataStore=function(){this._dataStore||(this._dataStore=new u.e("PeoplePicker",a.e.session))};return e})()},2471:function(e,t,n){"use strict";n.d(t,"e",function(){return o});var r=n(58),i=n(433),s=n(160),o=(function(){function e(){}e.getBatchOperationUrl=function(e,t){return new i.t({webAbsoluteUrl:!e&&t?new s.e(t).authority:e}).build().segment("$batch").toString()};e.processErrorResponse=function(e,t){var n={id:t};if((e=e.error?e.error:e)&&e.code){var r=e.code?e.code.split(","):e.error.code.split(","),i=Number(r[0]),s=e.message.value;n.error={code:i,message:s}}return{items:[n]}};e.getBatchResponseText=function(e){var t,n,r,i=[];e.split("\n").length>0&&(t=e.split("\n")[0]);if(t){n=(e=e.replace(t.trim()+"--","")).split(t);for(var s=1;s<n.length;s++)(r=n[s].split("\n\r")).length>2&&i.push(r[2])}return i};e.processBatchResponse=function(e,t,n){var r,i,s,o,u=[],a=!1;e&&e.split("\n").length>0&&(r=e.split("\n")[0]);if(r){i=(e=e.replace(r.trim()+"--","")).split(r);for(var f=1;f<i.length;f++)if((s=i[f].split("\n\r")).length>2){try{o=JSON.parse(s[2])}catch(e){o=s[2]}var l=t&&t[f-1],c=l?{key:l.key,id:l.id,newId:n?n+"/"+l.name:null}:{};if((o=o.error?o.error:o)&&o.code){var h=o.code?o.code.split(","):o.error.code.split(","),p=Number(h[0]),d=o.message.value;c.error={code:p,message:d};a=!0}u.push(c)}}return{items:u,hasError:a}};e.getBatchContent=function(e,t,n,i){for(var s=[],o=0;o<t.length;o++){for(var u=t[o],a=r.e.generate(),f=[],l=0;l<u.length;l++){var c=u[l];f.push("--changeset_"+a);f.push("Content-Type: application/http");f.push("Content-Transfer-Encoding: binary");f.push("");f.push(n+" "+c+" HTTP/1.1");f.push(i);f.push("")}f.push("--changeset_"+a+"--");var h=f.join("\r\n");s.push("--batch_"+e);s.push('Content-Type: multipart/mixed; boundary="changeset_'+a+'"');s.push("Content-Length: "+h.length);s.push("Content-Transfer-Encoding: binary");s.push("");s.push(h);s.push("")}s.push("--batch_"+e+"--");return s.join("\r\n")};e.getBatchContentExtended=function(e,t,n,i,s,o,u){var a=r.e.generate(),f=[];s&&s.length!==t.length&&(s=null);for(var l=0;l<t.length;l++){var c=t[l];f.push("--changeset_"+a);f.push("Content-Type: application/http");f.push("Content-Transfer-Encoding: binary");f.push("");u?f.push(u[l]+" "+c+" HTTP/1.1"):f.push(n+" "+c+" HTTP/1.1");f.push(i);o&&f.push(o);if(s){f.push("");f.push(s[l])}f.push("")}f.push("--changeset_"+a+"--");var h=f.join("\r\n");(f=[]).push("--batch_"+e);f.push('Content-Type: multipart/mixed; boundary="changeset_'+a+'"');f.push("Content-Length: "+h.length);f.push("Content-Transfer-Encoding: binary");f.push("");f.push(h);f.push("");f.push("--batch_"+e+"--");return f.join("\r\n")};e.defaultBatchRequestPostData="Content-Type: application/json;odata=verbose";e.defaultBatchAcceptData="accept: application/json;odata=verbose";return e})();t.t=o},2605:function(e,t,n){"use strict";n.d(t,"e",function(){return l});n.d(t,"t",function(){return h});var r=n(69),i=n(84),s=n(44),o=n(2357),u=n(248),a=n(114),f=n(245),l="https://outlook.office.com/search",c={ODB:1286},h=(function(){function e(e,t){this._dataRequestor=new o.e({},{});this._pageContext=t.pageContext;this._oAuthTokenProvider=t.oAuthTokenProvider;this._sharingContextInformation&&this._sharingContextInformation.additionalTokens&&(this._substrateToken=this._sharingContextInformation.additionalTokens.substrateToken);this.initializeDataStore()}e.prototype.canUseSubstrate=function(){if(this._substrateToken)return!0;var e=!1;if(this._pageContext&&!this._pageContext.isSPO)return e;if(this._pageContext&&this._pageContext.authToken)return e;this._pageContext&&this._oAuthTokenProvider&&f.n.isFeatureEnabled(c)&&(e=!0);this._dataStore&&(e=e&&!this._dataStore.getValue("DisableSubstrateSearch",a.e.session));return e};e.prototype.disableSubstrateCallsForPicker=function(){this.initializeDataStore();this._dataStore.setValue("DisableSubstrateSearch",!0,a.e.session)};e.prototype.getSubstrateToken=function(){var e=this;if(this._substrateToken)return r.n.resolve(this._substrateToken);if(this._oAuthTokenProvider){var t=new i.e({name:"PeoplePicker.GetSubstrateToken"});return this._oAuthTokenProvider.getToken(l).then(function(e){t.end({resultType:s.e.Success});return e},function(n){if(r.n.isCanceled(n)){t.end({resultType:s.e.ExpectedFailure,resultCode:"Canceled"});return r.n.reject(n)}t.end({resultCode:"PeoplePicker.GetSubstrateTokenError",resultType:s.e.Failure,extraData:{serverErrorCode:n._serverErrorCode,message:n.message}});e.disableSubstrateCallsForPicker();return null})}return null};e.prototype.init=function(e){var t=l+"/api/v1/init?scenario=documentshare";this._dataRequestor.send({apiName:"Substrate.PeopleSearch.Init",path:t,headers:{Authorization:"Bearer "+e},needsAuthorization:!1})};e.prototype.initializeDataStore=function(){this._dataStore||(this._dataStore=new u.e("PeoplePicker",a.e.session))};return e})()},2865:function(e,t,n){"use strict";n.d(t,"e",function(){return r});n.d(t,"t",function(){return s});n.d(t,"n",function(){return o});var r,i=n(1092);(function(e){e.Small="S";e.Medium="M";e.Large="L"})(r||(r={}));function s(e){var t;switch(e.size){case r.Large:t=3;break;case r.Medium:t=2;break;default:t=1}return Object(i.getUserPhotoUrl)(e.userLoginName,t)}function o(e,t){var n=Object(i.getUserPhotoUrl)(t);if(!e||!n||0===n.indexOf("http"))return n;try{return new URL(e).origin+n}catch(e){return n}}},2870:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(7).t)("metadataSearchDataSource")},2987:function(e,t,n){"use strict";var r,i=n(69),s=n(84),o=n(44);(function(e){e[e.InteractionRequired=10013]="InteractionRequired"})(r||(r={}));var u=(function(){function e(e,t){void 0===e&&(e={});this._dataSource=t.oAuthTokenDataSource}e.prototype.getToken=function(e,t){var n=new s.e({name:"getToken"});return this._dataSource.getToken(e,t).then(function(e){n.end({resultType:o.e.Success});return e},function(e){n.end({resultType:o.e.Failure});return i.n.reject(e)})};e.prototype.getInstrumentedToken=function(e,t){var n=new s.e({name:"getToken"});return this._dataSource.getInstrumentedToken(e,t).then(function(e){n.end({resultType:o.e.Success});return e},function(e){n.end({resultType:o.e.Failure});return i.n.reject(e)})};return e})();t.e=u},2996:function(e,t,n){"use strict";n.r(t);n.d(t,"HubSiteQueryOption",function(){return r});n.d(t,"HubSiteJoinApprovalErrorCode",function(){return i});n.d(t,"HubDataSource",function(){return S});n.d(t,"isRefineHubNavAudienceLoggingKillSwitchActivated",function(){return x});var r,i,s=n(0),o=n(1555),u=n(477),a=n(1424),f=n(245),l=n(69),c=n(59),h=n(58),p=n(114),d=n(67),v={ODB:1076},m={ODB:1631},g={ODB:1145},y={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&apos;"},b=/[&<>"']/g,w=RegExp(b.source);function E(e){return e&&w.test(e)?e.replace(b,function(e){return y[e]}):e||""}(function(e){e[e.Parent=0]="Parent";e[e.Children=1]="Children";e[e.Siblings=2]="Siblings"})(r||(r={}));(function(e){e[e.NeedsApproval=1]="NeedsApproval";e[e.SiteNotPendingApproval=2]="SiteNotPendingApproval";e[e.UnexpectedApprovalCorrelationId=3]="UnexpectedApprovalCorrelationId";e[e.ApprovalTokenRejected=4]="ApprovalTokenRejected";e[e.InvalidApprovalToken=5]="InvalidApprovalToken";e[e.Unknown=-1]="Unknown"})(i||(i={}));var S=(function(e){Object(s.__extends)(t,e);function t(t){var n=e.call(this,{dataSourceName:"HubDataSource",id:"HubDataSource",cacheType:p.e.local},{pageContext:t})||this;n._parseRawHubSite=function(e){return e?{etag:e.Version||(e.__metadata?e.__metadata.etag:void 0),id:e.ID,siteId:e.SiteId,siteUrl:e.SiteUrl,logoUrl:e.LogoUrl,name:e.Title,description:e.Description,targets:n._parseReturnedHubSiteTargetString(e.Targets),siteDesignId:e.SiteDesignId,requiresJoinApproval:e.RequiresJoinApproval,hideNameInNavigation:e.HideNameInNavigation,parentHubSiteId:e.ParentHubSiteId,enablePermissionsSync:e.EnablePermissionsSync}:void 0};n._parseReturnedHubSites=function(e){var t=JSON.parse(e).d;return t.Items?t.Items.results:t.results};return n}t.prototype.getHubData=function(e,t,n){var r=this,i=this._pageContext.hubSiteId;return this.getDataUtilizingPersistentCache({getUrl:function(){return r._pageContext.webAbsoluteUrl+"/_api/web/HubSiteDataAsStream(true)"},qosName:"GetHubData",cacheRequestKey:i,cachingStrategy:t?3:0,parseResponse:function(e){return JSON.parse(e)},noRedirect:!0}).then(function(n){var i=n?Object(s.__assign)(Object(s.__assign)({},n),{isNavAudienceEnabled:Boolean(n.isNavAudienceTargeted),isNavAudienceProvided:!1,isNavAudienceAffected:!1,navigation:o.t.transformNodesToLinks(n.navigation||[])}):void 0;return e?r._ensureHubNavData(i,t):i}).then(function(e){var t=a.e.getInstance(r._pageContext);return r._pageContext&&e&&!e.usesMetadataNavigation&&!n&&e.isNavAudienceEnabled?t.filter("HubNav",e.navigation,"links").then(function(n){return Object(s.__assign)(Object(s.__assign)(Object(s.__assign)({},e),{navigation:n}),x()?{}:{isNavAudienceProvided:t.containsAudiences(e.navigation,"links"),isNavAudienceAffected:o.t.checkIfLinksAffected(e.navigation,n)})}):e})};t.prototype.joinHubSite=function(e,t,n){e||(e=h.e.Empty);var r=t?{approvalToken:t,approvalCorrelationId:n}:void 0;return this.dataRequestor.getData({url:this._pageContext.webAbsoluteUrl+"/_api/site/JoinHubSite(@v1)?@v1='"+c.e.encodeRestUriStringToken(e)+"'",qosName:"JoinHubSite",additionalPostData:JSON.stringify(r),parseResponse:function(){},noRedirect:!0}).catch(function(e){if(e.code&&e.code.indexOf("HubSiteJoinApprovalException")>=0){var t=Number(e.code.substring(0,e.code.indexOf(",")));throw Object(s.__assign)({hubSiteJoinApprovalErrorCode:t},e)}throw e})};t.prototype.getConnectedHubs=function(e,t){var n=this;return this.dataRequestor.getData({url:this._pageContext.webAbsoluteUrl+"/_api/hubsites/getconnectedhubs(hubSiteId='"+e+"',option='"+t+"')",qosName:"HubSite.GetConnectedHubs",parseResponse:this._parseReturnedHubSites,method:"GET"}).then(function(e){return e?e.map(n._parseRawHubSite):void 0})};t.prototype.makeHubSite=function(){return this.dataRequestor.getData({url:this._pageContext.webAbsoluteUrl+"/_api/site/RegisterHubSite",qosName:"MakeHubSite",parseResponse:function(e){return JSON.parse(e).d}}).then(this._parseRawHubSite)};t.prototype.registerHubSite=function(e){return this.dataRequestor.getData({url:this._pageContext.webAbsoluteUrl+"/_api/SPO.Tenant/RegisterHubSiteWithCreationInformation",qosName:"RegisterHubSite",parseResponse:function(e){return JSON.parse(e).d},additionalPostData:JSON.stringify({siteUrl:e.SiteUrl,creationInformation:e}),method:"POST"}).then(this._parseRawHubSite)};t.prototype.removeHubSite=function(){return this.dataRequestor.getData({url:this._pageContext.webAbsoluteUrl+"/_api/site/UnregisterHubSite",qosName:"RemoveHubSite",parseResponse:function(){}})};t.prototype.getHubSites=function(){var e=this;return this.dataRequestor.getData({url:this._pageContext.webAbsoluteUrl+"/_api/HubSites",qosName:"GetHubSites",method:"GET",parseResponse:this._parseReturnedHubSites,noRedirect:!0}).then(function(t){return t?t.map(e._parseRawHubSite):void 0})};t.prototype.getHubSite=function(e){return this.dataRequestor.getData({url:this._pageContext.webAbsoluteUrl+"/_api/HubSites/GetById('"+e+"')",qosName:"GetHubSite",parseResponse:function(e){return JSON.parse(e).d},noRedirect:!0}).then(this._parseRawHubSite)};t.prototype.updateHubSite=function(e){var t={__metadata:{etag:e.etag,type:"SP.HubSite"},LogoUrl:e.logoUrl,Title:e.name,Description:e.description};t.Targets=this._constructHubSiteTargetString(e.targets);t.SiteDesignId=e.siteDesignId;t.HideNameInNavigation=e.hideNameInNavigation;f.n.isFeatureEnabled(v)&&(t.RequiresJoinApproval=e.requiresJoinApproval);f.n.isFeatureEnabled(m)&&(t.ParentHubSiteId=e.parentHubSiteId);f.n.isFeatureEnabled(g)&&(t.EnablePermissionsSync=e.enablePermissionsSync);return this.dataRequestor.getData({url:this._pageContext.webAbsoluteUrl+"/_api/HubSites/GetById('"+e.id+"')",qosName:"UpdateHubSite",method:"POST",additionalPostData:JSON.stringify(t),additionalHeaders:{"X-HTTP-Method":"MERGE","If-Match":"*"},noRedirect:!0})};t.prototype.canCreateHubJoinedSite=function(e){var t=this,n=e+this._pageContext.userId;return this.getDataUtilizingLegacyCache({getUrl:function(){return t._pageContext.webAbsoluteUrl+"/_api/SPSiteManager/CanCreateHubJoinedSite('"+e+"')"},qosName:"CanCreateHubJoinedSite",cacheRequestKey:""+n,parseResponse:function(e){return JSON.parse(JSON.parse(e).d.CanCreateHubJoinedSite)},noRedirect:!0}).then(function(e){return e})};t.prototype.syncHubSiteTheme=function(){return this.dataRequestor.getData({url:this._pageContext.webAbsoluteUrl+"/_api/web/SyncHubSiteTheme",qosName:"SyncHubSiteTheme",parseResponse:function(){},noRedirect:!0})};t.prototype.onHubSiteJoinRequestStarted=function(e){var t=e?{approvalCorrelationId:e}:void 0;return this.dataRequestor.getData({url:this._pageContext.webAbsoluteUrl+"/_api/site/OnHubSiteJoinRequestStarted",method:"POST",qosName:"OnHubSiteJoinRequestStarted",additionalPostData:JSON.stringify(t),parseResponse:function(){}})};t.prototype.onHubSiteJoinRequestCanceled=function(e){var t=e?{approvalCorrelationId:e}:void 0;return this.dataRequestor.getData({url:this._pageContext.webAbsoluteUrl+"/_api/site/OnHubSiteJoinRequestCanceled",method:"POST",qosName:"OnHubSiteJoinRequestCanceled",additionalPostData:JSON.stringify(t),parseResponse:function(){}})};t.prototype.getHubSiteJoinApprovalCorrelationId=function(){return this.dataRequestor.getData({url:this._pageContext.webAbsoluteUrl+"/_api/site/GetHubSiteJoinApprovalCorrelationId",method:"GET",qosName:"GetHubSiteJoinApprovalCorrelationId",parseResponse:function(e){return JSON.parse(e).d.GetHubSiteJoinApprovalCorrelationId}})};t.prototype.onHubSiteJoinRequestApproved=function(e){return this.dataRequestor.getData({url:this._pageContext.webAbsoluteUrl+"/_api/site/OnHubSiteJoinRequestApproved",method:"POST",qosName:"OnHubSiteJoinRequestApproved",additionalPostData:JSON.stringify({joiningSiteId:e}),parseResponse:function(e){return JSON.parse(e).d.OnHubSiteJoinRequestApproved}})};t.prototype.grantHubSiteRights=function(e,t){return 0===t.length?l.n.resolve():this.dataRequestor.getData({url:this._pageContext.webAbsoluteUrl+"/_api/SPO.Tenant/GrantHubSiteRightsById",method:"POST",qosName:"GrantHubSiteRights",additionalPostData:JSON.stringify({hubSiteId:e,principals:t,grantedRights:1}),additionalHeaders:{"ODATA-VERSION":"4.0",Accept:"application/json; odata.metadata=minimal"}})};t.prototype.revokeHubSiteRights=function(e,t){return 0===t.length?l.n.resolve():this.dataRequestor.getData({url:this._pageContext.webAbsoluteUrl+"/_api/SPO.Tenant/RevokeHubSiteRightsById",method:"POST",qosName:"RevokeHubSiteRights",additionalPostData:JSON.stringify({hubSiteId:e,principals:t})})};t.prototype._ensureHubNavData=function(e,t){if(e&&e.usesMetadataNavigation){var n=this._pageContext,r={env:n.env,killSwitches:n.killSwitches,layoutsUrl:n.layoutsUrl,siteAbsoluteUrl:e.url,siteClientTag:"",webAbsoluteUrl:e.url,webServerRelativeUrl:null,webTemplate:null,hasManageWebPermissions:!1,systemUserKey:n.systemUserKey,userDisplayName:n.userDisplayName,userId:n.userId,userLoginName:n.userLoginName,userEmail:n.userEmail};return new o.t(r,"GlobalNavigationSwitchableProvider").getMenuState({useCache:!0,forceRefresh:t}).then(function(t){var n=Object(o.n)()?t&&t.links||[]:t.links||[];return Object(s.__assign)(Object(s.__assign)({},e),{navigation:n})})}return l.n.resolve(e)};t.prototype._parseReturnedHubSiteTargetString=function(e){var t=[];if(e)for(var n=(new DOMParser).parseFromString(e,"text/xml").getElementsByTagName("ace"),r=0;r<n.length;r++){var i=n[r].getAttribute("identityName"),s=n[r].getAttribute("displayName"),o="";if(i){var u=i.split("|"),a=u[u.length-1];a.indexOf("@")>0&&(o=a)}t.push({userId:i,email:o,name:s})}return t};t.prototype._constructHubSiteTargetString=function(e){if(e&&e.length>0){var t="<acl>";e.forEach(function(e){t+='<ace identityName="'+E(e.userId)+'" displayName="'+E(e.name)+'" allowRights="1" />'});return t+"</acl>"}return""};return t})(u.t);t.default=S;function x(){return d.t.isActivated("d833a180-020d-4e24-8878-e47d4e5dd147","2020-08-06","Refine the audience targeting engagement logging in hub nav")}},2999:function(e,t,n){"use strict";n.d(t,"e",function(){return o});var r=n(4262),i=r?{"ar-sa":{resource:r.Arabic,name:"",code:1025},"az-latn-az":{resource:r.Azerbaijani,name:" ",code:1068},"bg-bg":{resource:r.Bulgarian,name:" ",code:1026},"bs-latn-ba":{resource:r.Bosnian,name:"Bosanski",code:5146},"ca-es":{resource:r.Catalan,name:"Catal",code:1027},"cs-cz":{resource:r.Czech,name:"esk Jazyk",code:1029},"cy-gb":{resource:r.Welsh,name:"Cymraeg",code:1106},"da-dk":{resource:r.Danish,name:"Dansk",code:1030},"de-de":{resource:r.German,name:"Deutsche",code:1031},"el-gr":{resource:r.Greek,name:"",code:1032},"en-us":{resource:r.English,name:"English",code:1033},"es-es":{resource:r.Spanish,name:"Espaol",code:3082},"et-ee":{resource:r.Estonian,name:"Eesti",code:1061},"eu-es":{resource:r.Basque,name:"Euskara",code:1069},"fi-fi":{resource:r.Finnish,name:"Suomi",code:1035},"fr-fr":{resource:r.French,name:"Franais",code:1036},"ga-ie":{resource:r.Irish,name:"Gaeilge",code:2108},"gl-es":{resource:r.Galician,name:"Galego",code:1110},"he-il":{resource:r.Hebrew,name:"",code:1037},"hi-in":{resource:r.Hindi,name:"",code:1081},"hr-hr":{resource:r.Croatian,name:"Hrvatski",code:1050},"hu-hu":{resource:r.Hungarian,name:"Magyar",code:1038},"id-id":{resource:r.Indonesian,name:"Bahasa Indonesia",code:1057},"it-it":{resource:r.Italian,name:"Italiano",code:1040},"ja-jp":{resource:r.Japanese,name:"",code:1041},"kk-kz":{resource:r.Kazakh,name:" T",code:1087},"ko-kr":{resource:r.Korean,name:", ",code:1042},"lt-lt":{resource:r.Lithuanian,name:"Lietuvi",code:1063},"lv-lv":{resource:r.Latvian,name:"Latvieu",code:1062},"mk-mk":{resource:r.Macedonian,name:"M",code:1071},"ms-my":{resource:r.Malay,name:"Bahasa Melayu",code:1086},"nb-no":{resource:r.Norwegian,name:"Norsk",code:1044},"nl-nl":{resource:r.Dutch,name:"Nederlands",code:1043},"pl-pl":{resource:r.Polish,name:"Polski",code:1045},"prs-af":{resource:r.Dari,name:"",code:1164},"pt-br":{resource:r.PortugueseBR,name:"Portugus Brasil",code:1046},"pt-pt":{resource:r.PortuguesePT,name:"Portugus",code:2070},"ro-ro":{resource:r.Romanian,name:"Romn",code:1048},"ru-ru":{resource:r.Russian,name:"",code:1049},"sk-sk":{resource:r.Slovak,name:"Slovenina",code:1051},"sl-si":{resource:r.Slovene,name:"Slovenina",code:1060},"sr-cyrl-rs":{resource:r.SerbianCRS,name:"",code:10266},"sr-latn-cs":{resource:r.SerbianLCS,name:"Srpski",code:2074},"sr-latn-rs":{resource:r.SerbianLCS,name:"Srpski",code:9242},"sv-se":{resource:r.Swedish,name:"Svenska",code:1053},"th-th":{resource:r.Thai,name:"",code:1054},"tr-tr":{resource:r.Turkish,name:"Trke",code:1055},"uk-ua":{resource:r.Ukrainian,name:"",code:1058},"vi-vn":{resource:r.Vietnamese,name:"Ting Vit Nam",code:1066},"zh-cn":{resource:r.ChineseCN,name:"",code:2052},"zh-tw":{resource:r.ChineseTW,name:"",code:1028}}:{},s=r?{1025:{resource:r.Arabic,languageCode:"ar-sa"},1068:{resource:r.Azerbaijani,languageCode:"az-latn-az"},1026:{resource:r.Bulgarian,languageCode:"bg-bg"},5146:{resource:r.Bosnian,languageCode:"bs-latn-ba"},1027:{resource:r.Catalan,languageCode:"ca-es"},1029:{resource:r.Czech,languageCode:"cs-cz"},1106:{resource:r.Welsh,languageCode:"cy-gb"},1030:{resource:r.Danish,languageCode:"da-dk"},1031:{resource:r.German,languageCode:"de-de"},1032:{resource:r.Greek,languageCode:"el-gr"},1033:{resource:r.English,languageCode:"en-us"},3082:{resource:r.Spanish,languageCode:"es-es"},1061:{resource:r.Estonian,languageCode:"et-ee"},1069:{resource:r.Basque,languageCode:"eu-es"},1035:{resource:r.Finnish,languageCode:"fi-fi"},1036:{resource:r.French,languageCode:"fr-fr"},2108:{resource:r.Irish,languageCode:"ga-ie"},1110:{resource:r.Galician,languageCode:"gl-es"},1037:{resource:r.Hebrew,languageCode:"he-il"},1081:{resource:r.Hindi,languageCode:"hi-in"},1050:{resource:r.Croatian,languageCode:"hr-hr"},1038:{resource:r.Hungarian,languageCode:"hu-hu"},1057:{resource:r.Indonesian,languageCode:"id-id"},1040:{resource:r.Italian,languageCode:"it-it"},1041:{resource:r.Japanese,languageCode:"ja-jp"},1087:{resource:r.Kazakh,languageCode:"kk-kz"},1042:{resource:r.Korean,languageCode:"ko-kr"},1063:{resource:r.Lithuanian,languageCode:"lt-lt"},1062:{resource:r.Latvian,languageCode:"lv-lv"},1071:{resource:r.Macedonian,languageCode:"mk-mk"},1086:{resource:r.Malay,languageCode:"ms-my"},1044:{resource:r.Norwegian,languageCode:"nb-no"},1043:{resource:r.Dutch,languageCode:"nl-nl"},1045:{resource:r.Polish,languageCode:"pl-pl"},1164:{resource:r.Dari,languageCode:"prs-af"},1046:{resource:r.PortugueseBR,languageCode:"pt-br"},2070:{resource:r.PortuguesePT,languageCode:"pt-pt"},1048:{resource:r.Romanian,languageCode:"ro-ro"},1049:{resource:r.Russian,languageCode:"ru-ru"},1051:{resource:r.Slovak,languageCode:"sk-sk"},1060:{resource:r.Slovene,languageCode:"sl-si"},10266:{resource:r.SerbianCRS,languageCode:"sr-cyrl-rs"},2074:{resource:r.SerbianLCS,languageCode:"sr-latn-cs"},9242:{resource:r.SerbianLCS,languageCode:"sr-latn-rs"},1053:{resource:r.Swedish,languageCode:"sv-se"},1054:{resource:r.Thai,languageCode:"th-th"},1055:{resource:r.Turkish,languageCode:"tr-tr"},1058:{resource:r.Ukrainian,languageCode:"uk-ua"},1066:{resource:r.Vietnamese,languageCode:"vi-vn"},2052:{resource:r.ChineseCN,languageCode:"zh-cn"},1028:{resource:r.ChineseTW,languageCode:"zh-tw"}}:{},o=(function(){function e(){}e.getName=function(t){var n=e._getLanguageName(t);return n&&n.name||""};e.getLocalizedName=function(t){var n=e._getLanguageName(t);return n&&n.resource||""};e.getCode=function(t){var n=e._getLanguageName(t);return n&&n.code};e.getLanguageByCode=function(e){return s[e].languageCode};e.getResourceByCode=function(e){return s[e].resource};e.getLanguagesByCode=function(){return s};e._getLanguageName=function(e){var t=e.toLowerCase();return i[t]};return e})()},3071:function(e,t,n){"use strict";n.d(t,"e",function(){return r});n.d(t,"t",function(){return s});n.d(t,"n",function(){return o});n.d(t,"r",function(){return u});var r,i=n(3598);(function(e){e[e.Text=0]="Text";e[e.DateTime=1]="DateTime";e[e.FileType=2]="FileType";e[e.PeoplePicker=3]="PeoplePicker";e[e.ContentType=4]="ContentType"})(r||(r={}));function s(){var e=[{displayName:i.i,fieldType:r.Text,isSystemField:!0},{displayName:i.n,fieldType:r.Text,isSystemField:!0,kqlProperty:"Filename"},{displayName:i.f,fieldType:r.PeoplePicker,isSystemField:!0,kqlProperty:"People"},{displayName:i.s,fieldType:r.DateTime,isSystemField:!0,kqlProperty:"LastModifiedTime"},{displayName:i.r,fieldType:r.FileType,isSystemField:!0,kqlProperty:"FileType"},{displayName:i.e,fieldType:r.ContentType,isSystemField:!0,kqlProperty:"ContentTypeId"}];e.forEach(function(e,t){e.fieldId=t});return e}function o(){return[{key:"powerpoint",text:i.c,data:{iconName:"pptx"}},{key:"word",text:i.p,data:{iconName:"docx"}},{key:"excel",text:i.t,data:{iconName:"xlsx"}},{key:"pdf",text:i.a,data:{iconName:"pdf"}},{key:"photo",text:i.l,data:{iconName:"photo"}},{key:"video",text:i.h,data:{iconName:"video"}},{key:"other",text:i.u,data:{iconName:"genericfile"}}]}function u(e){return/^0x012000.{32}$/i.test(e)||/^0x010100.{32}$/i.test(e)||/^0x01010400.{32}$/i.test(e)}},3322:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r;(function(e){e[e.None=0]="None";e[e.Neutral=1]="Neutral";e[e.Soft=2]="Soft";e[e.Strong=3]="Strong"})(r||(r={}))},3346:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var r=n(178),i=n(387),s=n(69),o=n(2378),u={enqueue:function(e){return e()}},a=(function(){function e(e){void 0===e&&(e={});this.async=new r.e;this.uploaderCount=0;this.throttledSignals=[];var t=e.maxParallelUploads,n=void 0===t?3:t,i=e.maxUploadsPerSecond,s=void 0===i?8:i,a=e.throttleBarrier,f=void 0===a?1e3:a;this.uploadQueue=n===1/0?u:new o.e(n);this.maxUploads=s;this.throttleBarrier=f}e.prototype.throttle=function(e){var t=this;return this.uploadQueue.enqueue(function(){if(!t.isReady&&t.uploaderCount>=t.throttleBarrier){t.uploaderCount=0;t.isReady=!0}if(t.batchStartTime&&t.uploaderCount>=t.maxUploads)return t.throttleUploader(e);t.isReady&&!t.batchStartTime&&(t.batchStartTime=Date.now());return t.startUploader(e)})};e.prototype.addThrottleTimer=function(e){this.isReady=!0;this.setTimeout(e);return this.addUploaderCallback(function(){return s.n.resolve()})};e.prototype.dispose=function(){if(this.timeout){this.async.clearTimeout(this.timeout);this.timeout=void 0}this.async.dispose()};e.prototype.startUploader=function(e){this.uploaderCount+=1;return e()};e.prototype.addUploaderCallback=function(e){var t=this,n=new i.e;this.throttledSignals.push(n);return n.getPromise().then(function(){return t.startUploader(e)})};e.prototype.throttleUploader=function(e){if(this.timeout)return this.addUploaderCallback(e);var t=1e3-(Date.now()-this.batchStartTime);if(t>0){this.setTimeout(t);return this.addUploaderCallback(e)}this.uploaderCount=0;this.batchStartTime=Date.now();return this.startUploader(e)};e.prototype.setTimeout=function(e){var t=this;if(this.timeout){this.async.clearTimeout(this.timeout);this.timeout=void 0}this.timeout=this.async.setTimeout(function(){t.timeout=void 0;t.uploaderCount=0;t.batchStartTime=Date.now();for(var e=0,n=t.throttledSignals;e<n.length;e++){n[e].complete()}t.throttledSignals=[]},e)};return e})()},3361:function(e,t,n){"use strict";n.d(t,"e",function(){return N});n.d(t,"t",function(){return C});var r=n(0),i=n(4656),s=n(366),o=n(772),u=n(592),a=n(4664),f=n(2336),l=n(4308),c=n(4640),h=n(83),p=n(162),d=n(3911),v=n(53),m=n(1092),g=n(2865),y=n(244),b=n(67),w=n(1283),E=n(2329),S={ODB:1657},x=!b.t.isActivated("f8f5a253-cc95-4903-8f09-41053f644db1","10/13/2020","Deactivate Trackable Anyone Link, disable anyoneLinkAbility"),T=!b.t.isActivated("4e57b845-f0be-4660-9f02-2408a3819d8b","10/11/2021","Disable requestResource header"),N=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===n&&(n={pageContext:t.pageContext});var r=e.call(this,{dataSourceName:"SharingDataSource"},n)||this;r._getParentListId=t.getParentListId;r._itemUrlHelper=t.itemUrlHelper||new s.e({},{pageContext:t.pageContext});r._apiUrlHelper=t.apiUrlHelper||new o.e({},{pageContext:t.pageContext,itemUrlHelper:r._itemUrlHelper});r._sharingContextInformation=t.sharingContextInformation||void 0;r._sharingDataSourceHelper=new d.e({itemUrlHelper:r._itemUrlHelper,sharingContextInformation:r._sharingContextInformation,isItemUrlEncoded:t.isItemUrlEncoded});var i=Object(h.n)(r._pageContext);r._shareUrl=i+"/_api/SP.Web.ShareObject";r._userPhotoUrlKSActivated=b.t.isActivated("d819fbd9-3200-4eab-aa09-689adffcf674","06/04/2021","Fixing UserPhotoUrl in iframe.");return r}t.parsePeople=function(e){return e.map(function(e){var n={role:t.parseSharingRole(e.CurrentRole),statusCode:Number(!e.Status),errorMessage:e.Message||null};return{name:e.DisplayName,email:e.Email,userId:e.UserId,sharingInfo:n}})};t.parseSharingRole=function(e){switch(e){case 0:return 5;case 1:return 1;case 2:return 2;case 6:return 6;default:return 1}};t.prototype.getSharingInformation=function(e,t,n,r,i,s){var o,u=this,a=(r=r||this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,e,this._getParentListId(e))).segment("GetSharingInformation"),f="pickerSettings";t&&(f+=",permissionsInformation");n&&(f+=",sharingLinkTemplates");i&&(f+=",addressBarLinkSettings");o=a.oDataParameter("$Expand",f).toString();return this.getData(function(){return o},function(t){var n=JSON.parse(t),r=u._parseGetSharingInformationResponse(n,e);r.getSharingInformationSources=3;return r},"GetSharingInformation",null,"POST",this._sharingContextInformation&&this._sharingContextInformation.listId&&M(this._sharingContextInformation.listId.slice(1,-1))&&T?{"X-SP-REQUESTRESOURCES":"WEBPROPERTIES, list="+this._sharingContextInformation.listId.slice(1,-1)}:null,null,null,!0,void 0,void 0,this._getExtraData(),s)};t.prototype.emailWithoutPermissioning=function(e,n,r,i){var s=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,n,this._getParentListId(n)).segment("ForwardObjectLink").toString();return this.getData(function(){return s},function(e){var r=JSON.parse(e).d,i=[];r.UniquelyPermissionedUsers&&r.UniquelyPermissionedUsers.results&&(i=r.UniquelyPermissionedUsers.results);var s=[];r.InvitedUsers&&r.InvitedUsers.results&&(s=r.InvitedUsers.results);var o={};o.statusCode=r.StatusCode;o.errorMessage=r.ErrorMessage;o.people=t.parsePeople(i);o.invitedUsers=t.parsePeople(s);o.itemId=n&&n.id;s.length>0&&(o.invitationLink=s[0].InvitationLink);o.invalidEmails=[];if(r.UsersWithInvalidEmails&&r.UsersWithInvalidEmails.results)for(var u=0,a=r.UsersWithInvalidEmails.results;u<a.length;u++){var f=a[u];o.invalidEmails.push(f.User)}return o},"ForwardObjectLink",function(){for(var t=[],n=0,s=e;n<s.length;n++){var o=s[n];t.push(o.rawPersonData)}var u={peoplePickerInput:JSON.stringify(t),emailBody:r,emailSubject:i};return JSON.stringify(u)})};t.prototype.checkPermissions=function(e,t){var n=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,t,this._getParentListId(t)).segment("CheckPermissions").toString();return this.getData(function(){return n},function(e){var t=JSON.parse(e);if(t.d){return t.d.CheckPermissions.results}return null},"CheckPermissions",function(){var t={recipients:e};return JSON.stringify(t)})};t.prototype.share=function(e,n){var r,i=this,s=!!this._sharingContextInformation||this._sharingDataSourceHelper.canUseSecurable(n.items[0]);if(9===n.linkType||6===n.linkType||5===n.linkType)return this._shareLink(e,n);if(s){var o=n.items[0],u=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,o,this._getParentListId(o));r=u.segment("ShareObject").toString()}else r=this._shareUrl;return this.getData(function(){return r},function(e){var r=JSON.parse(e).d,i=[];r.UniquelyPermissionedUsers&&r.UniquelyPermissionedUsers.results&&(i=r.UniquelyPermissionedUsers.results);var s=[];r.InvitedUsers&&r.InvitedUsers.results&&(s=r.InvitedUsers.results);var o={};o.statusCode=r.StatusCode;o.errorMessage=r.ErrorMessage;o.people=t.parsePeople(i);o.invitedUsers=t.parsePeople(s);o.itemId=n.items[0]&&n.items[0].id;s.length>0&&(o.invitationLink=s[0].InvitationLink);o.invalidEmails=[];if(r.UsersWithInvalidEmails&&r.UsersWithInvalidEmails.results)for(var u=0,a=r.UsersWithInvalidEmails.results;u<a.length;u++){var f=a[u];o.invalidEmails.push(f.User)}return o},"Share",function(){for(var t=[],r=0;r<e.length;r++){var o=e[r];t.push(o.rawPersonData)}n.roleValue===2..toString()?n.roleValue=E.e:n.roleValue===1..toString()&&(n.roleValue=E.r);var u={peoplePickerInput:JSON.stringify(t),roleValue:n.roleValue,sendEmail:n.sendEmail,emailBody:n.message,emailSubject:n.subject,includeAnonymousLinkInEmail:!n.requireSignIn,propagateAcl:n.propagateSharing,useSimplifiedRoles:!0};s||(u.url=i._sharingDataSourceHelper.getFileUrl(n.items[0]));return JSON.stringify(u)})};t.prototype.updatePermissions2=function(e,t,n){var r=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,t,this._getParentListId(t)).segment("UpdateDocumentSharingInfo").toString();return this.getData(function(){return r},function(e){var t=JSON.parse(e).d;return t?{role:t.UpdateDocumentSharingInfo.results[0].CurrentRole}:null},"UpdatePermissions2",function(){var t;switch(n){case a.e.none:case a.e.view:case a.e.review:case a.e.edit:case a.e.owner:t=n;break;default:t=a.e.view}var r={userRoleAssignments:[{UserId:e.loginName,Role:t}],validateExistingPermissions:!1,additiveMode:!1,sendServerManagedNotification:!1,customMessage:null,includeAnonymousLinksInNotification:!1,propagateAcl:!0};return JSON.stringify(r)})};t.prototype.updatePermissionsMultiple=function(e,t,n,r,i){var s=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,t,this._getParentListId(t)).segment("UpdateDocumentSharingInfo").toString();return this.getData(function(){return s},function(e){var t=JSON.parse(e).d;return t?{role:t.UpdateDocumentSharingInfo.results[0].CurrentRole,success:t.UpdateDocumentSharingInfo.results.map(function(e){return e.Status}).reduce(function(e,t){return e&&t},!0)}:null},"UpdatePermissionsMultiple",function(){var t;switch(n){case a.e.none:t=0;break;case a.e.view:t=1;break;case a.e.review:t=6;break;case a.e.edit:t=2;break;default:t=1}var s={userRoleAssignments:e.map(function(e){return{UserId:e.userId,Role:t}}),validateExistingPermissions:!1,additiveMode:!1,sendServerManagedNotification:r,customMessage:i,includeAnonymousLinksInNotification:!1,propagateAcl:!0};return JSON.stringify(s)})};t.prototype.parseRawSharingInformation=function(e){return this._parseGetSharingInformationResponse(e,void 0)};t.prototype.unshareLink=function(e){var t=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,e.item,this._getParentListId(e.item)).segment("UnshareLink").toString();return this.getData(function(){return t},function(e){return!!JSON.parse(e).d},"UnshareLink",function(){var t={linkKind:e.kind,shareId:e.shareId};return JSON.stringify(t)})};t.prototype.shareLink=function(e){var t=e.settings,n=e.items[0],r=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,e.items[0],this._getParentListId(n)).segment("ShareLink").toString();return this.getData(function(){return r},function(e){var t=JSON.parse(e);return t.d?C(t):t.error?{error:5,errorMessage:t.error.message}:void 0},"ShareLink",function(){var n=null;t.expiration&&(n=Object(i.e)(t.expiration.toString()));var r=null;if(e.recipients&&e.recipients.length>0){r=[];for(var s=0,o=e.recipients;s<o.length;s++){var u=o[s];u.rawPersonData&&r.push(u.rawPersonData)}}var a=null;if(t.inviteesToRemove&&t.inviteesToRemove.length>0){a=[];for(var f=0,l=t.inviteesToRemove;f<l.length;f++){var c=l[f];a.push({id:c.id,loginName:c.loginName,name:c.primaryText,isExternal:c.isExternal,principalType:c.type,email:c.email})}}var h={request:{createLink:!!t.createLink,settings:{allowAnonymousAccess:t.allowAnonymousAccess,trackLinkUsers:t.trackLinkUsers,linkKind:t.sharingLinkKind,expiration:n,role:t.role,restrictShareMembership:t.restrictShareMembership,updatePassword:t.updatePassword,password:t.password,shareId:t.shareId,description:t.description,scope:t.scope}}};a&&(h.request.settings.inviteesToRemove={results:a});if(r&&r.length>0){h.request.peoplePickerInput=JSON.stringify(r);var p=e.emailData,d=e.emailSubject;void 0!==p&&void 0===d&&(h.request.emailData={body:e.emailData,subject:""});void 0===p&&void 0!==d&&(h.request.emailData={body:"",subject:e.emailSubject});void 0!==p&&void 0!==d&&(h.request.emailData={body:e.emailData,subject:e.emailSubject})}var v=e.settings.shareId;if(v){h.request.settings.shareId=v;h.request.emailData={body:""}}return JSON.stringify(h)},"POST",this._sharingContextInformation&&this._sharingContextInformation.listId&&M(this._sharingContextInformation.listId.slice(1,-1))&&T?{"X-SP-REQUESTRESOURCES":"WEBPROPERTIES, list="+this._sharingContextInformation.listId.slice(1,-1)}:null,null,null,!0,void 0,void 0,this._getExtraData()).catch(function(e){var t="";try{t=JSON.stringify(e)}catch(e){}return{error:5,debugErrorMessage:t}})};t.prototype.setAddressBarLinkCapability=function(e,t){var n=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,e,this._getParentListId(e)).segment("SetAddressBarLinkCapability").toString();return this.getData(function(){return n},function(e){return!!JSON.parse(e).d},"SetAddressBarLinkCapability",function(){var e={enable:t};return JSON.stringify(e)})};t.prototype.shareLinkExpress=function(e,t,n){var r=this._apiUrlHelper.build().webByUrl({webUrl:this._pageContext.webAbsoluteUrl}).method("Lists",e).method("GetItemById",t).segment("ShareLinkExpress").toString();return this.getData(function(){return r},function(e){var t=JSON.parse(e);return t.d?k(t.d.ShareLinkExpress.sharingLinkInfo):t.error?{error:5,errorMessage:t.error.message}:void 0},"ShareLinkExpress",function(){var e={expressOption:n};return JSON.stringify(e)},"POST",null,null,null,!0,void 0,void 0,this._getExtraData()).catch(function(e){var t="";try{t=JSON.stringify(e)}catch(e){}return{error:5,debugErrorMessage:t}})};t.prototype.getClientId=function(){var e=Number(this._pageContext.webTemplate);if(Object(w.e)(this._pageContext))return f.e.sharePoint;switch(e){case v.t.teamSite:case v.t.group:case v.t.subgroup:case v.t.sitePagePublishing:return f.e.sharePoint;case v.t.mySite:return f.e.odb;default:return f.e.sharePoint}};t.prototype._shareLink=function(e,t){var n=this,r=t.items[0],s=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,r,this._getParentListId(r)).segment("ShareLink").toString();return this.getData(function(){return s},function(n){return{statusCode:0,errorMessage:"",people:e,itemId:t.items[0].id}},"ShareLink",function(){for(var r=[],s=0,o=e;s<o.length;s++){var u=o[s];r.push(u.rawPersonData)}var a=null;t.expiration&&(a=Object(i.e)(t.expiration));var f={request:{peoplePickerInput:JSON.stringify(r),emailData:{body:t.message,subject:t.subject},linkKind:n._getSharingLinkKind(t.linkType,t.roleValue),createLink:!0,expiration:a}};return JSON.stringify(f)})};t.prototype._getSharingLinkKind=function(e,t){var n=1;6===e?n=5:5===e?n=4:9===e&&(n=t===2..toString()?3:2);return n};t.prototype._parseGetSharingInformationResponse=function(e,t){if(e.error)return{error:5,anonymousLinkExpirationRestrictionDays:void 0,anyoneLinkTrackUsers:void 0,canAddExternalPrincipal:void 0,canAddInternalPrincipal:void 0,canRequestAccessForGrantAccess:void 0,canManagePermissions:void 0,defaultSharingLink:void 0,defaultShareLinkToExistingAccess:void 0,hasInheritedLinks:void 0,isShared:void 0,item:void 0,fileExtension:void 0,sharedObjectType:void 0,sharingLinks:void 0,sharingPrincipals:void 0,peoplePickerSettings:void 0,userDisplayName:void 0,blockPeoplePickerAndSharing:void 0,userRole:void 0,defaultShareLinkPermission:void 0,sharingAbilities:void 0,defaultLinkKind:void 0,directLink:void 0,hasPermissionsInformation:void 0,sharingLinkTemplates:void 0,webTemplateId:void 0,itemUniqueId:void 0,outlookEndpointHostUrl:void 0,webUrl:void 0,userPhotoCdnBaseUrl:void 0};var n=e.d,r=!!n.permissionsInformation,i=!!n.sharingLinkTemplates,s=y.e.isFeatureEnabled(S)&&r,o=!!n.addressBarLinkSettings,u=r?this._parseSharingLinks(n.permissionsInformation.links.results,n.directUrl):[],a=i?this._parseSharingLinkTemplates(n.sharingLinkTemplates.templates.results):[],f=o?n.addressBarLinkSettings:null,c=[];if(r){var h=n.permissionsInformation.siteAdmins.results,d=n.permissionsInformation.principals.results,v=this._parseSharingPrincipals(h);v.forEach(function(e){return e.isSiteAdmin=!0});var m=this._parseSharingPrincipals(d);c=v.concat(m)}var g=this._getDefaultSharingLink(n.defaultLinkKind,u,n.sharingAbilities),w={name:this._sharingContextInformation?this._sharingContextInformation.itemName:void 0,childCount:this._sharingContextInformation?this._sharingContextInformation.itemCount:void 0,hasDlpPolicy:this._sharingContextInformation?this._sharingContextInformation.hasDlpPolicy:void 0,extension:this._sharingContextInformation&&this._sharingContextInformation.itemExtension?this._sharingContextInformation.itemExtension:n.fileExtension,appmap:this._sharingContextInformation?this._sharingContextInformation.itemAppmap:void 0,itemType:this._sharingContextInformation?this._sharingContextInformation.itemType:void 0};if(t){var E=t.properties,x=E.ItemChildCount?parseInt(E.ItemChildCount,10):0,T=E.FolderChildCount?parseInt(E.FolderChildCount,10):0,N=t.type===p.t.OneNote?0:x+T,C=this._isPolicyTipFlagSet(t.policyTip,4);w={name:t.name,childCount:N,hasDlpPolicy:C,extension:t.extension,appmap:t.appMap,itemType:t.type}}var k=n.canRequestAccessForGrantAccess||n.canAddInternalPrincipal||u.length>1;return{anonymousLinkExpirationRestrictionDays:0===n.anonymousLinkExpirationRestrictionDays?-1:n.anonymousLinkExpirationRestrictionDays,anyoneLinkTrackUsers:n.anyoneLinkTrackUsers,canAddExternalPrincipal:n.canAddExternalPrincipal,canAddInternalPrincipal:n.canAddInternalPrincipal,defaultShareLinkToExistingAccess:n.defaultShareLinkToExistingAccess,canManagePermissions:k,defaultSharingLink:g,fileExtension:n.fileExtension,sharedObjectType:n.sharedObjectType,hasInheritedLinks:!!s&&n.permissionsInformation.hasInheritedLinks,isShared:this._computeIsShared(u,c),item:w,sharingLinks:u,sharingPrincipals:c,peoplePickerSettings:n.pickerSettings,userDisplayName:this._pageContext.userDisplayName,blockPeoplePickerAndSharing:n.blockPeoplePickerAndSharing,requiresAccessApproval:!n.canAddInternalPrincipal&&n.canRequestAccessForGrantAccess,canRequestAccessForGrantAccess:n.canRequestAccessForGrantAccess,userRole:n.currentRole,defaultShareLinkPermission:n.defaultShareLinkPermission,sharingAbilities:n.sharingAbilities,defaultLinkKind:n.defaultLinkKind,directLink:{allowsAnonymousAccess:!1,audience:l.e.existing,expiration:null,description:null,isActive:!0,isEdit:!0,principals:[],invitees:[],shareId:"",sharingLinkKind:1,url:n.directUrl,updatePassword:!1,password:"",passwordLastModifiedBy:null},hasPermissionsInformation:!!n.permissionsInformation,sharingLinkTemplates:a,addressBarLinkSettings:f,webTemplateId:n.webTemplateId,itemUniqueId:n.itemUniqueId,customizedExternalSharingServiceUrl:n.customizedExternalSharingServiceUrl||"",siteIBSegmentIDs:n.siteIBSegmentIDs?n.siteIBSegmentIDs.results:null,siteIBMode:b.t.isActivated("e5511a64-99f4-4992-ac8c-181c083a4d38","04/26/2021","Pass SiteIBMode to 3S.")?"":n.siteIBMode,enforceIBSegmentFiltering:!!n.enforceIBSegmentFiltering,enforceSPOSearch:!!n.enforceSPOSearch,outlookEndpointHostUrl:n.outlookEndpointHostUrl?n.outlookEndpointHostUrl:null,webUrl:n.webUrl?n.webUrl:null,isStubFile:!!n.isStubFile&&n.isStubFile,userPhotoCdnBaseUrl:n.userPhotoCdnBaseUrl}};t.prototype._computeIsShared=function(e,t){for(var n=!1,r=0,i=e;r<i.length;r++){var s=i[r];s.isActive&&1!==s.sharingLinkKind&&(n=!0)}n||(n=t.length>0);return n};t.prototype._parseSharingLinks=function(e,t){var n=this,r=(e=e.filter(function(e){return!e.isInherited})).map(function(e){var t,r=e.linkDetails;t=x&&void 0!==r.Scope&&-1!==r.Scope?A(r.LinkKind,r.Scope):L(r.LinkKind,r.AllowsAnonymousAccess,r.RestrictedShareMembership);return{allowsAnonymousAccess:r.AllowsAnonymousAccess,hasPassword:r.RequiresPassword,blockDownload:r.BlocksDownload,description:r.Description,audience:t,expiration:r.Expiration?new Date(r.Expiration):null,isActive:r.IsActive,isEdit:O(r.LinkKind)||r.IsEditLink,isReview:r.IsReviewLink,isManageList:r.IsManageListLink,principals:n._parseSharingPrincipals(e.linkMembers.results,r.LinkKind),invitees:n._parseLinkInvitees(r),shareId:r.ShareId,sharingLinkKind:r.LinkKind,url:r.Url,updatePassword:r.UpdatePassword,password:r.Password,passwordLastModifiedBy:n._parseSharingPrincipal(r.PasswordLastModifiedBy),isCreateOnlyLink:r.IsCreateOnlyLink,isAddressBarLink:r.IsAddressBarLink,isUnhealthy:r.IsUnhealthy,status:r.SharingLinkStatus,created:r.Created,trackLinkUsers:r.TrackLinkUsers}});(r=r.sort(function(e,t){return n._getLinkRanking(t)-n._getLinkRanking(e)})).push({allowsAnonymousAccess:!1,audience:l.e.specificPeople,expiration:null,description:null,isActive:!0,isEdit:!0,principals:[],invitees:[],shareId:"",sharingLinkKind:1,url:t,updatePassword:!1,password:"",passwordLastModifiedBy:null});return r};t.prototype._getLinkRanking=function(e){var t=0;switch(e.audience){case l.e.anyone:t+=30;break;case l.e.organization:t+=20;break;case l.e.specificPeopleFlex:t+=10}e.isEdit?t+=3:e.isReview?t+=2:e.isEdit||e.isReview||e.blockDownload||(t+=1);return t};t.prototype._getSharingLinkTemplateRanking=function(e){var t=0;if(e&&e.linkDetails&&e.linkDetails.shareId){switch(e.scope){case 0:t+=30;break;case 1:t+=20;break;case 2:t+=10}switch(e.role){case a.e.edit:t+=3;break;case a.e.review:t+=2;break;case a.e.view:t+=1}}return t};t.prototype._parseSharingLinkTemplates=function(e){var t=this,n=e.map(function(e){var n,r=e.linkDetails;if(null!==r){var i=void 0;i=x&&void 0!==r.Scope&&-1!==r.Scope?A(r.LinkKind,r.Scope):L(r.LinkKind,r.AllowsAnonymousAccess,r.RestrictedShareMembership);n={allowsAnonymousAccess:r.AllowsAnonymousAccess,hasPassword:r.RequiresPassword,blockDownload:r.BlocksDownload,audience:i,expiration:r.Expiration?new Date(r.Expiration):null,description:r.Description,isActive:r.IsActive,isEdit:O(r.LinkKind)||r.IsEditLink,isReview:r.IsReviewLink,principals:void 0,invitees:t._parseLinkInvitees(r),shareId:r.ShareId,sharingLinkKind:r.LinkKind,url:r.Url,updatePassword:r.UpdatePassword,password:r.Password,passwordLastModifiedBy:t._parseSharingPrincipal(r.PasswordLastModifiedBy)}}return{linkDetails:n,passwordProtected:e.passwordProtected,role:e.role,scope:e.scope,shareKind:e.shareKind}});return n=n.sort(function(e,n){return t._getSharingLinkTemplateRanking(n)-t._getSharingLinkTemplateRanking(e)})};t.prototype._parseLinkInvitees=function(e){var t=this,n=e.Invitations;if(!n)return[];for(var r=[],i=0,s=n.results;i<s.length;i++){var o=s[i];o&&o.invitee&&r.push(o.invitee)}return r.map(function(e){return{id:e.id,email:e.email,primaryText:e.name,isExternal:e.isExternal,loginName:e.loginName,role:null,secondaryText:e.jobTitle,type:e.principalType,imageUrl:t._userPhotoUrlKSActivated?Object(m.getUserPhotoUrl)(e.email):Object(g.n)(t._pageContext.webAbsoluteUrl,e.email)}})};t.prototype._parseSharingPrincipals=function(e,t){var n=this,r=e.map(function(e){var r=e.principal;r||(r=e);var i={id:r.id,isExternal:r.isExternal,loginName:r.loginName,primaryText:r.name,role:e.role,secondaryText:r.jobTitle,type:r.principalType,imageUrl:n._userPhotoUrlKSActivated?Object(m.getUserPhotoUrl)(r.email):Object(g.n)(n._pageContext.webAbsoluteUrl,r.email),email:r.email};t&&(i.sharingLinkKind=t);return i});return d.e.getUniqueSharingPrincipals(r)};t.prototype._getExtraData=function(){var e;this._sharingContextInformation&&(e={clientId:this._sharingContextInformation.clientId,mode:c.e[this._sharingContextInformation.mode]});return e};t.prototype._parseSharingPrincipal=function(e){if(e){var t=e.principal;t||(t=e);return{id:t.id,isExternal:t.isExternal,loginName:t.loginName,primaryText:t.name,role:e.role,secondaryText:t.jobTitle,type:t.principalType,imageUrl:this._userPhotoUrlKSActivated?Object(m.getUserPhotoUrl)(t.email):Object(g.n)(this._pageContext.webAbsoluteUrl,t.email),email:t.email}}return null};t.prototype._getDefaultSharingLink=function(e,t,n){n.peopleSharingLinkAbilities&&(n.peopleSharingLinkAbilities.canManageEditLink.enabled||n.peopleSharingLinkAbilities.canManageReadLink.enabled)&&1===e&&(e=6);var r=e;if(x&&n.anyoneLinkAbilities){5!==r||n.anyoneLinkAbilities.canManageEditLink.enabled||(r=4);4!==r||n.anyoneLinkAbilities.canManageReadLink.enabled||(r=3)}else{5!==r||n.anonymousLinkAbilities.canManageEditLink.enabled||(r=4);4!==r||n.anonymousLinkAbilities.canManageReadLink.enabled||(r=3)}if(n.organizationLinkAbilities){3!==r||n.organizationLinkAbilities.canManageEditLink.enabled||(r=2);2!==r||n.organizationLinkAbilities.canManageReadLink.enabled||(r=1)}var i=void 0;5===e||4===e?i=l.e.anyone:3===e||2===e?i=l.e.organization:1===e?i=l.e.specificPeople:6===e&&(i=l.e.specificPeopleFlex);return{allowsAnonymousAccess:void 0,audience:i,expiration:void 0,description:void 0,isActive:!0,isEdit:void 0,principals:void 0,shareId:void 0,sharingLinkKind:r,url:void 0,invitees:void 0,updatePassword:!1,password:"",passwordLastModifiedBy:void 0}};t.prototype._isPolicyTipFlagSet=function(e,t){return e&&(e&t)===t};return t})(u.t);function C(e){if(e.d){return k(e.d.ShareLink.sharingLinkInfo)}}function k(e){var t;t=x&&void 0!==e.Scope&&-1!==e.Scope?A(e.LinkKind,e.Scope):L(e.LinkKind,e.AllowsAnonymousAccess,e.RestrictedShareMembership);var n=e.Expiration?new Date(e.Expiration):void 0;return{link:{allowsAnonymousAccess:e.AllowsAnonymousAccess,audience:t,expiration:n,description:e.Description,isActive:e.IsActive,isEdit:O(e.LinkKind)||e.IsEditLink,principals:null,invitees:null,hasPassword:e.RequiresPassword,shareId:e.ShareId,sharingLinkKind:e.LinkKind,url:e.Url,updatePassword:e.UpdatePassword,password:e.Password,passwordLastModifiedBy:e.PasswordLastModifiedBy,shareTokenString:e.ShareTokenString,isAddressBarLink:e.IsAddressBarLink,isUnhealthy:e.IsUnhealthy,status:e.SharingLinkStatus,created:e.Created}}}function L(e,t,n){return 5===e||4===e?l.e.anyone:3===e||2===e?l.e.organization:1===e?l.e.specificPeople:6===e?t?l.e.anyone:!1===n?l.e.organization:l.e.specificPeopleFlex:void 0}function A(e,t){return 5===e||4===e?l.e.anyone:3===e||2===e?l.e.organization:1===e?l.e.specificPeople:6===e?0==t?l.e.anyone:1===t?l.e.organization:l.e.specificPeopleFlex:void 0}function O(e){return 5===e||3===e||4!==e&&2!==e&&null}function M(e){"{"===e[0]&&(e=e.substring(1,e.length-1));return/^(\{){0,1}[0-9a-fA-F]{8}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{12}(\}){0,1}$/gi.test(e)&&"00000000-0000-0000-0000-000000000000"!=e}},3447:function(e,t,n){"use strict";n.d(t,"e",function(){return M});var r,i=n(0),s=n(58),o=n(178),u=n(387),a=n(69),f=n(67),l=n(793),c=n(84),h=n(44),p=n(213),d=n(3002),v=n(2077),m=n(82),g=n(2430),y=n(262),b=n(384),w=(function(e){Object(i.__extends)(t,e);function t(n){var r=e.call(this,n)||this;r.name="FileHasherError";r.__proto__=t.prototype;return r}return t})(Error),E="UNKNOWN_UPLOAD_ERROR",S="UPLOAD_TIMEOUT_ERROR",x="UPLOAD_TOO_SLOW_ERROR";(function(e){e[e.singleChunk=0]="singleChunk";e[e.start=1]="start";e[e.continue=2]="continue";e[e.startFinish=3]="startFinish";e[e.finish=4]="finish";e[e.status=5]="status";e[e.cancel=6]="cancel"})(r||(r={}));var T=(function(e){Object(i.__extends)(t,e);function t(t){var n=e.call(this,Object(i.__assign)(Object(i.__assign)({},t),{extraData:Object(i.__assign)(Object(i.__assign)({},t.extraData||{}),"number"==typeof t.statusCode?{status:t.statusCode}:{})}))||this;n.errorType=t.errorType;n.displayString=t.displayString;try{n.serverError=JSON.stringify(t.serverError)}catch(e){n.serverError=""}return n}return t})(m.e);function N(e){if(e&&e.code){return e.code.split(",")[0]||e.code}return e&&e.number?""+e.number:E}function C(e,t){return 404===e&&(t===r.start||t===r.startFinish||t===r.singleChunk)}function k(e,t){if(!e)return new T({errorType:v.e.general,code:"Unknown",statusCode:0,message:"Unknown upload error",serverError:e});var n,r,i=!1,s=N(e);(e instanceof y.e||e instanceof Error&&"GetDataError"===e.name)&&(e=e.errorData);if("string"==typeof e)n=e;else{var o=e.message;if("string"==typeof o)n=o;else if(o&&o.value){n=o.value;i=!0}}r=s===b.r?v.e.disconnected:"-2130575257"===s?v.e.conflict:"-2130245249"===s?v.e.similarNameExists:s===S?v.e.general:"-2147024891"===s?v.e.accessDenied:C(e.status,t)?v.e.targetFolderMissing:i?v.e.other:v.e.general;return new T({errorType:r,code:s,statusCode:e.status,displayString:i?n:"",message:n||"Unhandled client error",correlationId:e.correlationId,serverError:e})}var L="ServerRelativeUrl,UniqueId,Name,VroomItemID,VroomDriveID,ServerRedirectedUrl",A=!f.t.isActivated("B1726BAE-6860-4FE3-937B-2A8768F26044","01/08/2021","Include the full server response for errors without status codes"),O=!f.t.isActivated("D5DDFDFE-0CAB-48F0-8407-1BC0A5595ACE","06/21/2021","Handle throttled failures for streaming uploads"),M=(function(){function e(e){var t=e.hasher,n=e.throttler,r=e.dataRequestor,i=e.appName,u=e.webApiUrl,a=e.authToken,f=e.canStream,l=e.fileUpload,h=e.itemExpansion,p=e.destinationUrl,d=e.combineStartFinish,v=e.qosEvent,m=void 0===v?c.e:v,g=e.nameConflictBehavior,y=void 0===g?0:g,b=e.onStart,w=e.onAbort,E=e.onProgress;this._hasher=t;this._dataRequestor=r;this._throttler=n;this._chunkNumber=0;this._uploadedBytes=0;this._qosEvent=m;this._id=s.e.generate();this._authToken=a;this._canStream=f;this._webApiUrl=u;this._fileUpload=l;this._async=new o.e(this);this._itemExpansion=h;this._destinationUrl=p;this._combineStartFinish=d;this._nameConflictBehavior=y;this._chunkSize=Math.min(l.size,262144e3);this._trackingHeaders={Application:i,Scenario:"UploadFile",ScenarioType:"AUO"};this._onStart=b;this._onAbort=w;this._onProgress=E}e.prototype.upload=function(){var e=this,t=this._throttler.throttle(function(){var t=e._id,n=e._fileUpload.size,r=e._canStream&&n>25165824,s={fileUploadId:t,fileSize:n},o=new e._qosEvent({name:"Upload.h5",extraData:s}),u=r?"SharePointUploader.stream":"SharePointUploader.create",f=new e._qosEvent({name:u,extraData:s}),c=new d.e({scenario:"SharePointUpload",extraData:s});e._fileName=e._fileUpload.name;e._onStart&&e._onStart();return e.start(r).then(function(e){o.end({resultType:h.e.Success});f.end({resultType:h.e.Success});c.end({resultType:h.e.Success});return e},function(t){if(a.n.isCanceled(t)){o.end({resultType:h.e.ExpectedFailure,resultCode:"Aborted"});f.end({resultType:h.e.ExpectedFailure,resultCode:"Aborted"});c.end({resultType:h.e.ExpectedFailure,errorCode:"Aborted"});e._onAbort&&e._onAbort();return a.n.reject(t)}var n=(function(e){return e instanceof T?e:new T(e instanceof w?{errorType:v.e.other,code:"FileHasher",statusCode:0,innerError:e}:{errorType:v.e.general,code:"Unknown",statusCode:0,innerError:e})})(t),r=(function(e){return new g.e({message:e.displayString,errorType:e.errorType,innerError:e,supportsVersioning:!0})})(n),s=(function(e){switch(e.errorType){case v.e.disconnected:case v.e.conflict:case v.e.similarNameExists:case v.e.targetFolderMissing:return!0}switch(e.code){case"-2147023080":case"-2130575245":case b.r:case b.n:case b.i:case S:case"-2130245249":return!0}return!1})(n)?h.e.ExpectedFailure:h.e.Failure;o.end(Object(l.e)(Object(p.e)(r),{resultType:s,resultCode:v.e[r.errorType]}));var u=A&&!n.extraData.status&&n.serverError,d=Object(l.e)(Object(p.e)(n),{resultType:s,extraData:Object(i.__assign)(Object(i.__assign)({},u?{serverError:u}:{}),{uploadedBytes:e._uploadedBytes})});f.end(d);var m=d.extraData,y=d.resultCode;c.end({resultType:s,extraData:m,errorCode:y});return a.n.reject(r)})});this._uploadPromise=t;return t};e.prototype.abort=function(){var e=this,t=this._uploadPromise;this._uploadPromise=void 0;if(!this._hasCompleted&&t){t.cancel();t.then(function(){},function(){}).done(function(){e._hasher&&e._hasher.dispose();return e.cancelUpload()})}};e.prototype.restart=function(e){var t=e.nameConflictBehavior,n=void 0===t?this._nameConflictBehavior:t;this._nameConflictBehavior=n;var r=this._uploadPromise;this._uploadPromise=void 0;r&&r.cancel();this._hasher&&this._hasher.reset();return this.upload()};e.prototype.dispose=function(){this._async.dispose();this._hasher&&this._hasher.dispose()};e.prototype.start=function(e){var t=this;this._uploadedBytes=0;var n=this._fileUpload.size;return(e?this.streamFile():this.uploadFile()).then(function(e){t.updateProgress(n);return e})};e.prototype.updateProgress=function(e){if(this._uploadedBytes!==e){this._uploadedBytes=e;this._onProgress&&this._onProgress(e)}};e.prototype.getUploadUrl=function(e){var t=this._webApiUrl;t=(t=t.methodWithAliases("GetFolderByServerRelativePath",{DecodedUrl:this._destinationUrl})).segment("Files");var n={};n.DecodedUrl=this._fileName;1===this._nameConflictBehavior||3===this._nameConflictBehavior?n.overwrite=!0:2===this._nameConflictBehavior&&(n.EnsureUniqueFileName=!0);n.AutoCheckoutOnInvalidData=!0;e&&(n.XorHash=e);t=t.methodWithAliases("AddUsingPath",n).oDataParameter("$Select",L);this._itemExpansion&&(t=t.oDataParameter("$Expand",this._itemExpansion));return t.toString()};e.prototype.uploadFile=function(e){var t=this;void 0===e&&(e=3);var n=this._fileUpload.slice(0,this._fileUpload.size);return(this._hasher&&!this._hasher.hasFullHash()?this._hasher.computeHash(n,0,n.size):a.n.resolve()).then(function(){var i=t._hasher?t._hasher.getFullHash(n.size):void 0;return t.uploadChunk({trackSpeed:!1,url:t.getUploadUrl(i),qosName:"SharePointUploader.UploadFile",data:n,offset:0,length:n.size}).then(function(e){return t.parseItemResponse(e)}).catch(function(n){if(a.n.isCanceled(n))return a.n.wrapError(n);if(n&&n.retryAfter&&e>0){var i=1e3*n.retryAfter;return t._throttler.addThrottleTimer(i).then(function(){t._uploadedBytes=0;return t.uploadFile(e-1)})}return a.n.wrapError(k(n,r.singleChunk))})})};e.prototype.getUploadStage=function(e){var t,n=this._fileUpload.size,i="SharePointUploader.",s=Math.min(this._chunkSize+e,n);if(0===this._chunkNumber)if(this._combineStartFinish&&n<=s){i+="StartFinish";t=r.startFinish}else{s=0;i+="Start";t=r.start}else if(n<=s){i+="Finish";t=r.finish}else{i+="Continue";t=r.continue}return{endByte:s,qosName:i,uploadStage:t}};e.prototype.getStreamingUrl=function(e,t,n){var i,s=this._webApiUrl,o=this._fileName,u={uploadId:{guid:this._requestId}};i=t===r.start?"StartUploadFile":t===r.startFinish?"Upload":t===r.continue?"ContinueUpload":this._hasher?"FinishUploadWithChecksum":"FinishUpload";if(t===r.start||t===r.startFinish){s=(s=s.methodWithAliases("GetFolderByServerRelativePath",{DecodedUrl:this._destinationUrl})).segment("Files");s=1===this._nameConflictBehavior||3===this._nameConflictBehavior?s.methodWithAliases("GetByPathOrAddStub",{DecodedUrl:o}):2===this._nameConflictBehavior?s.methodWithAliases("AddStubUsingPath",{DecodedUrl:o,EnsureUniqueFileName:!0}):s.methodWithAliases("AddStubUsingPath",{DecodedUrl:o})}if(t===r.continue||t===r.finish){s=s.methodWithAliases("GetFileByServerRelativePath",{DecodedUrl:this._destinationUrl+"/"+o});u.fileOffset=e;n&&t===r.finish&&(u.checksum=n)}s=s.methodWithAliases(i,u);if(t===r.finish||t===r.startFinish){s=s.oDataParameter("$Select",L);this._itemExpansion&&(s=s.oDataParameter("$Expand",this._itemExpansion))}return s.toString()};e.prototype.streamFile=function(e,t){var n=this;void 0===e&&(e=0);void 0===t&&(t=3);this._requestId||(this._requestId=s.e.generate());var i=this.getUploadStage(e),o=i.endByte,f=i.qosName,l=i.uploadStage,c=this._fileUpload.slice(e,o),h=this._fileUpload.size,p=l===r.finish,d=this._hasher&&l!==r.start&&!this._hasher.hasFullHash()&&this._hasher?this._hasher.computeHash(c,e,o):a.n.resolve();return(p?d:a.n.resolve()).then(function(){var i=void 0;n._hasher&&p&&(i=n._hasher.getFullHash(h));return n.uploadChunk({trackSpeed:!0,url:n.getStreamingUrl(e,l,i),qosName:f,data:c,offset:e,length:c.size}).then(function(e){n.updateProgress(o);var i=n.parseItemResponse(e);l===r.start&&2==n._nameConflictBehavior&&i.Name&&(n._fileName=i.Name);if(o<h){n._chunkNumber++;return d.then(function(){return n.streamFile(o,t)})}return i},function(i){if(a.n.isCanceled(i)){l!==r.start&&n.cancelUpload();return a.n.reject(i)}if(O&&i&&i.retryAfter&&t>0){var s=1e3*i.retryAfter;return n._throttler.addThrottleTimer(s).then(function(){return n.streamFile(e,t-1)})}if((f=N(o=i))===x||f===S||o&&0===o.status){if(n._chunkSize<=1048576){n.cancelUpload();return a.n.reject(k(i,l))}n._chunkSize=Math.floor(n._chunkSize/2);return n.streamFile(e,t)}var o,f;if(t>0&&(function(e,t){if(429===e.status)return!1;if(C(e.status,t))return!1;switch(N(e)){case b.i:case"-1":case"-2130575257":case"-2130245249":case"-2130575142":case"-2130209002":case"-2130209003":case"-2147023080":case"-2130575245":case"-2147024891":return!1;default:return!0}})(i,l)){var c,h=new u.e(function(){c&&n._async.clearTimeout(c)});c=n._async.setTimeout(function(){return h.complete()},1e3);return h.getPromise().then(function(){return n.getUploadStatus().then(function(e){e>0&&!n._chunkNumber&&(n._chunkNumber=1);return n.streamFile(e,t-1)},function(){return n.streamFile(e,t-1)})})}(function(e,t){if(t===r.startFinish){switch(N(e)){case"-2130575257":case"-2130245249":case"-2147024891":case"-2130575245":return!1;default:return!0}}return t!==r.start})(i,l)&&n.cancelUpload();return a.n.reject(k(i,l))})},function(e){l!==r.start&&n.cancelUpload();return a.n.reject(e)})};e.prototype.getUploadStatus=function(){var e=this._webApiUrl.methodWithAliases("GetFileByServerRelativePath",{DecodedUrl:this._destinationUrl+"/"+this._fileName}).methodWithAliases("GetUploadStatus",{uploadId:{guid:this._requestId}}).toString();return this._dataRequestor.getData({url:e,method:"GET",noRedirect:!0,authToken:this._authToken,qosName:"SharePointUploader.GetUploadStatus",additionalHeaders:this._trackingHeaders,qosExtraData:{fileUploadId:this._id},telemetryHandler:function(e){var t=e.eventData,n=e.response;if(t.resultType===h.e.Success){if(!n||!n.d||!n.d.ExpectedContentRange)return{eventData:Object(i.__assign)(Object(i.__assign)({},t),{resultCode:"NoContentRange",resultType:h.e.Failure})};var r=parseInt(n.d.ExpectedContentRange.split("-")[0],10);if(isNaN(r))return{eventData:Object(i.__assign)(Object(i.__assign)({},t),{resultCode:"NaNContentRange",resultType:h.e.Failure,error:n.d.ExpectedContentRange})}}return{eventData:t}}}).then(function(e){if(e.d&&e.d.ExpectedContentRange){var t=parseInt(e.d.ExpectedContentRange.split("-")[0],10);return isNaN(t)?a.n.reject(""):t}return a.n.reject("")})};e.prototype.cancelUpload=function(){if(!this._requestId)return a.n.resolve();var e=this._webApiUrl.methodWithAliases("GetFileByServerRelativePath",{DecodedUrl:this._destinationUrl+"/"+this._fileName}).methodWithAliases("CancelUpload",{uploadId:{guid:this._requestId}}).toString();this._requestId="";this._chunkNumber=0;return this._dataRequestor.getData({url:e,noRedirect:!0,authToken:this._authToken,qosName:"SharePointUploader.CancelUploadSession",additionalHeaders:this._trackingHeaders,qosExtraData:{fileUploadId:this._id}}).then(function(){})};e.prototype.uploadChunk=function(e){var t,n,r,i,s=this,o=e.url,a=e.qosName,f=e.data,l=e.offset,c=e.length,h=!1,p=new u.e(function(){h=!0;t.cancel()}),d=function(e){var t=s._chunkNumber>0&&l+c>=s._fileUpload.size?3e5:1e4,r=Math.min(Math.max(.08*e,t),2147483647);n&&s._async.clearTimeout(n);e&&(n=s._async.setTimeout(function(){p.error({code:""+S,message:""})},r))},v=Date.now(),m=Date.now(),g=0,y=0,b=0,w=this._async.debounce(function(e){e>s._uploadedBytes&&s.updateProgress(e)},100,{leading:!1});t=this._dataRequestor.getData({url:o,qosName:a,noRedirect:!0,authToken:this._authToken,additionalHeaders:this._trackingHeaders,qosExtraData:{fileUploadId:this._id,wasHashed:!!this._hasher},parseResponse:function(e){return e},contentType:"application/octet-stream",additionalPostData:f,onUploadProgress:function(e){if(e.lengthComputable){var t=Date.now();y+=(e.loaded-g)/(t-m);b++;r=e.loaded/(t-v);m=t;g=e.loaded;s._onProgress&&w(l+e.loaded);d(c-e.loaded)}}});d(c);e.trackSpeed&&(i=this._async.setInterval(function(){if(b){Date.now()-v+(c-g)/((y+r)/(b+1))>15e4&&g<c&&p.error({code:""+x,message:""})}},1e4));var E=function(){n&&s._async.clearTimeout(n);i&&s._async.clearInterval(i)},T=p.getPromise();t.done(function(e){p.complete(e)},function(e){h||p.error(e)});T.done(function(){return E()},function(){h||t.cancel();E()});return T};e.prototype.parseItemResponse=function(e){try{return JSON.parse(e).d}catch(e){}};return e})()},3460:function(e,t,n){"use strict";n.d(t,"e",function(){return o});n.d(t,"t",function(){return u});var r=n(340),i=n(18);function s(e,t,n){var r=e.replace("&action=edit",""),i=n?"forms.officeppe.com":"forms.office.com",s="Action=Create&Host=OneDrive&XlWorkbookId="+encodeURIComponent(r)+"&Title="+encodeURIComponent(t);return"https://"+i+"/Pages/DesignPage.aspx?Action=Create&Fragment="+encodeURIComponent(s)}function o(e,t,n){var r=void 0;"string"==typeof e?0===(e=e.trim()).length?r=t.emptyNameError:/["\*:<>\?\/\\\|]/.test(e)&&(r=i.format(n?t.invalidNameError2:t.invalidNameError,e)):r=t.emptyNameError;return r}function u(e,t,n,i){var o="";null!==e&&""!==e&&(o=t===r.e.ExcelSurvey?e.replace("action=edit","action=formedit"):t===r.e.ExcelForm?s(e,n,i):e.replace("action=edit","action=editnew"));return o}},3495:function(e,t,n){"use strict";var r=n(69),i=n(178),s=n(473),o=n(163),u=n(244),a=n(67),f=n(58),l=n(44),c=n(84),h=n(2987),p=n(2277),d=n(3496),v=n(1863),m="FlowWidgetProvider.",g=(function(){function e(e,t){void 0===e&&(e={});this._params=e;this._oAuthTokenProvider=t.oAuthTokenProvider||new h.e({},{oAuthTokenDataSource:new v.e(t.pageContext)});this._async=new i.e;this._widget=null;this._widgetErrorTimeout=null;this._pageContext=t.pageContext}e.prototype.dispose=function(){this._widgetReadyQos&&this._widgetReadyQos.end({resultType:l.e.ExpectedFailure,extraData:{message:"Widget disposed"}});this._renderWidgetQos&&this._renderWidgetQos.end({resultType:l.e.ExpectedFailure,extraData:{message:"Widget disposed"}});this._notifyWidgetQos&&this._notifyWidgetQos.end({resultType:l.e.ExpectedFailure,extraData:{message:"Widget disposed"}});if(this._widgetErrorTimeout){this._async.clearTimeout(this._widgetErrorTimeout);this._widgetErrorTimeout=null}if(this._widget){this._widget.dispose();this._widget=null}};e.prototype.launchFlowWidget=function(t,n){var r=this;o.e.logData({name:m+"PanelOpened",extraData:{flowId:n.flow.id}});e._loadSdk(this._pageContext).then(function(e){t.id||(t.id="od-Flow-iframeContainer-"+f.e.generate());var i=a.t.isActivated("36574CF5-480D-47E8-BF76-8C449F1CE451","09/22/2021","Allow unidentified flow instances to run in the widget")?void 0:n.flow.id,s={container:t.id,campaign:n.campaign,environmentId:n.flow.environmentId,enableOnBehalfOfTokens:!0,enableRegionalPortal:!0,widgetStyleSettings:n.widgetStyleSettings,approvalCenterSettings:n.approvalCenterSettings,templatesSettings:{useServerSideProvisioning:!0,defaultParams:n.widgetDefaultParams,allowCustomFlowName:n.allowCustomFlowName},enableWidgetV2:!0,flowName:i};r._widgetReadyQos=new c.e({name:m+"WidgetReady"});r._renderWidgetQos=new c.e({name:m+"RenderWidget"});r._widgetErrorTimeout=r._setErrorTimeout("WIDGET_READY");try{var o=e.renderWidget(n.widgetType,s);r._registerListeners(o);r._widget=o;r._currentFlowParams=n}catch(e){r._onWidgetError(e)}})};e.preloadSdk=function(t,n){o.e.logData({name:m+"PreloadSdk"});return e._loadSdk(n,t).then(function(){return r.n.resolve()})};e.prototype._registerListeners=function(e){var t=this;e.listen("GET_ACCESS_TOKEN",function(e,n){t._onGetAccessToken(e,n)});e.listen("WIDGET_READY",function(){t._onWidgetReady(e)});e.listen("WIDGET_RENDERED",function(){t._onWidgetRendered()});e.listen("RUN_FLOW_STARTED",function(){t._onTriggerFlowStarted()});e.listen("RUN_FLOW_COMPLETED",function(e){t._onTriggerFlowSucceeded(e)});e.listen("RUN_FLOW_DONE_BUTTON_CLICKED",function(){t._onTriggerFlowDoneClicked()});e.listen("RUN_FLOW_CANCEL_BUTTON_CLICKED",function(){t._onTriggerFlowCancelClicked()});e.listen("WIDGET_CLOSE",function(){t._onWidgetClose()});e.listen("FLOW_CREATION_SUCCEEDED",function(e){t._onFlowCreationSucceeded(e)});e.listen("FLOW_CREATION_FAILED",function(){t._onFlowCreationFailed()});e.listen("RECEIVED_APPROVAL_STATUS_CHANGED",function(e){t._onApprovalStatusChanged(e)});e.listen("GET_STRINGS",function(e,n){t._onGetStrings(e,n)})};e.prototype._notifyWidget=function(e,t){var n=this;this._notifyWidgetQos=new c.e({name:m+"NotifyWidget"});e.notify(t.actionName,t.actionData).then(function(){n._notifyWidgetQos.end({resultType:l.e.Success,extraData:{flowId:t.flow.id}})}).catch(function(e){var r=l.e.Failure,i=null;if(e){var s=e.code;"runFlowWidgetCancelled"!==s&&"flowWidgetClosed"!==s||(r=l.e.Success);i=s}else i="Error unknown: no error returned in the notifyWidget promise catch clause.";n._notifyWidgetQos.end({resultType:r,extraData:{flowId:t.flow.id,message:i}})})};e.prototype._onGetAccessToken=function(e,t){this._getToken().then(function(e){t(null,{token:e})})};e.prototype._onWidgetReady=function(e){this._widgetReadyQos.end({resultType:l.e.Success});this._async.clearTimeout(this._widgetErrorTimeout);this._widgetErrorTimeout=this._setErrorTimeout("WIDGET_RENDERED");this._notifyWidget(e,this._currentFlowParams)};e.prototype._onWidgetRendered=function(){this._async.clearTimeout(this._widgetErrorTimeout);this._widgetErrorTimeout=null;this._renderWidgetQos.end({resultType:l.e.Success});this._params.onWidgetRendered&&this._params.onWidgetRendered()};e.prototype._onTriggerFlowStarted=function(){o.e.logData({name:m+"RunFlowClicked",extraData:{flowId:this._currentFlowParams.flow.id}});this._params.onTriggerFlowStarted&&this._params.onTriggerFlowStarted(this._currentFlowParams)};e.prototype._onTriggerFlowSucceeded=function(e){u.e.isFeatureEnabled(d.e)&&o.e.logData({name:"ManualFlowTriggered",isIntentional:!0});if(this._params.onTriggerFlowSucceeded){var t=e.data;this._params.onTriggerFlowSucceeded(this._currentFlowParams,t)}};e.prototype._onTriggerFlowDoneClicked=function(){this._params.onTriggerFlowDoneClicked&&this._params.onTriggerFlowDoneClicked(this._currentFlowParams)};e.prototype._onTriggerFlowCancelClicked=function(){this._params.onTriggerFlowCancelClicked&&this._params.onTriggerFlowCancelClicked(this._currentFlowParams)};e.prototype._onWidgetClose=function(){this._params.onWidgetClose&&this._params.onWidgetClose(this._currentFlowParams)};e.prototype._onFlowCreationSucceeded=function(e){if(this._params.onFlowCreationSucceeded){var t=e.data;this._params.onFlowCreationSucceeded(this._currentFlowParams,t)}};e.prototype._onFlowCreationFailed=function(){this._params.onFlowCreationFailed&&this._params.onFlowCreationFailed(this._currentFlowParams)};e.prototype._onApprovalStatusChanged=function(e){this._params.onApprovalStatusChanged&&this._params.onApprovalStatusChanged(e)};e.prototype._onGetStrings=function(e,t){this._currentFlowParams.additionalEvents&&this._currentFlowParams.additionalEvents.indexOf("GET_STRINGS")>-1&&this._params.onGetStrings?this._params.onGetStrings(t):t(null,{})};e.prototype._onTokenError=function(e){this._params.onTokenError&&this._params.onTokenError(e)};e.prototype._onWidgetError=function(e){this._renderWidgetQos&&this._renderWidgetQos.end({resultType:l.e.Failure,extraData:{message:e.message}})};e.prototype._setErrorTimeout=function(e){var t=this;return this._async.setTimeout(function(){t._onWidgetError(new Error("Timeout: Widget timed out waiting for: "+e))},15e3)};e._loadSdk=function(t,i){if(e._loadSdkPromise)return e._loadSdkPromise;e._loadSdkPromise=new r.n(function(e){0;n.ee(89,4389,7).then(function(n){var r=new MsFlowSdk({hostName:Object(p.n)(t),locale:s.e.language,hostId:i});e(r)})});return e._loadSdkPromise};e.prototype._getToken=function(){var e=this;return new r.n(function(t){var n=new c.e({name:m+"GetToken"}),r="https://service.flow.microsoft.com/",i=e._pageContext&&e._pageContext.farmSettings&&e._pageContext.farmSettings.ExternalService_flowservicehostname;i&&(r="https://"+i+"/");e._oAuthTokenProvider.getToken(r).then(function(e){t(e);n.end({resultType:l.e.Success})},function(r){e._onTokenError(r);n.end({resultType:l.e.Failure,extraData:{serverErrorCode:r._serverErrorCode,message:r.message}});t(null)})})};return e})();t.e=g},3496:function(e,t,n){"use strict";n.d(t,"e",function(){return o});n.d(t,"r",function(){return r});n.d(t,"t",function(){return i});n.d(t,"n",function(){return s});var r,i,s,o={ODB:1565};(function(e){e.ApprovalCenter="approvalCenter";e.Flows="flows";e.FlowCreation="flowCreation";e.FlowsRuntime="flowsRuntime";e.Templates="templates"})(r||(r={}));(function(e){e.CreateFlowFromTemplate="createFlowFromTemplate";e.TriggerFlow="triggerFlow";e.TriggerFlowByTemplate="triggerFlowByTemplate"})(i||(i={}));(function(e){e.GetAccessToken="GET_ACCESS_TOKEN";e.WidgetClose="WIDGET_CLOSE";e.WidgetReady="WIDGET_READY";e.WidgetRendered="WIDGET_RENDERED";e.RunFlowCompleted="RUN_FLOW_COMPLETED";e.RunFlowCancelButtonClicked="RUN_FLOW_CANCEL_BUTTON_CLICKED";e.RunFlowDoneButtonClicked="RUN_FLOW_DONE_BUTTON_CLICKED";e.RunFlowStarted="RUN_FLOW_STARTED";e.FlowCreationFailed="FLOW_CREATION_FAILED";e.FlowCreationSucceeded="FLOW_CREATION_SUCCEEDED";e.Error="ERROR";e.ApprovalStatusChanged="RECEIVED_APPROVAL_STATUS_CHANGED";e.GetStrings="GET_STRINGS"})(s||(s={}))},3497:function(e,t,n){"use strict";var r=n(0),i=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,{dataSourceName:"IBSegmentsDataSource",id:"IBSegmentsDataSource"},{pageContext:t})||this;n.SPSITEMANAGER_URL_TEMPLATE=n._pageContext.webAbsoluteUrl+"/_api/SPSiteManager";return n}t.prototype.getIBSegmentLabels=function(e){var t=this;return this.getDataUtilizingLegacyCache({getUrl:function(){return t.SPSITEMANAGER_URL_TEMPLATE+"/GetIBSegmentLabels"},qosName:"getIBSegmentLabels",bypassCache:e,parseResponse:function(e){var t=JSON.parse(e);return t&&t.d&&t.d.GetIBSegmentLabels&&t.d.GetIBSegmentLabels.results?t.d.GetIBSegmentLabels.results.map(function(e){return{objectId:e.ObjectId,displayName:e.DisplayName}}):[]},method:"POST",additionalPostData:JSON.stringify({IBSegments:this._pageContext.IBSegments})})};t.prototype.getCompatibleSegments=function(e,t){var n=this;return this.getDataUtilizingLegacyCache({getUrl:function(){return n.SPSITEMANAGER_URL_TEMPLATE+"/GetCompatibleSegments"},qosName:"GetCompatibleSegments",bypassCache:t,parseResponse:function(t){var n=JSON.parse(t);return n&&n.d&&n.d.GetCompatibleSegments&&n.d.GetCompatibleSegments.results?n.d.GetCompatibleSegments.results.map(function(e){return{objectId:e.ObjectId,displayName:e.DisplayName}}).filter(function(t){return!e.includes(t.objectId)}):[]},method:"POST",additionalPostData:JSON.stringify({segments:e})})};t.prototype.setIBSegments=function(e){var t=this;return this.getData(function(){return t.SPSITEMANAGER_URL_TEMPLATE+"/SetIBSegments"},function(e){return null},"SetIBSegments",function(){return JSON.stringify({IBSegments:e})},"POST")};t.prototype.getTenantAllOrCompatibleIBSegments=function(e,t){var n=this;return this.getDataUtilizingLegacyCache({getUrl:function(){return n._pageContext.webAbsoluteUrl+"/_api/SPO.Tenant/GetTenantAllOrCompatibleIBSegments"},qosName:"GetTenantAllOrCompatibleIBSegments",bypassCache:t,parseResponse:function(t){var n=JSON.parse(t);return n&&n.d&&n.d.GetTenantAllOrCompatibleIBSegments&&n.d.GetTenantAllOrCompatibleIBSegments.results?n.d.GetTenantAllOrCompatibleIBSegments.results.map(function(e){return{objectId:e.ObjectId,displayName:e.DisplayName}}).filter(function(t){return!e.includes(t.objectId)}):[]},method:"POST",additionalPostData:JSON.stringify({segments:e})})};return t})(n(477).t);t.e=i},3499:function(e,t,n){"use strict";n.d(t,"e",function(){return f});var r,i,s=n(0),o=n(477),u=n(83),a=n(59);(function(e){e[e.WebLogo=0]="WebLogo";e[e.HubLogo=1]="HubLogo";e[e.HeaderBackground=2]="HeaderBackground"})(r||(r={}));(function(e){e[e.Square=0]="Square";e[e.Rectangular=1]="Rectangular"})(i||(i={}));var f=(function(e){Object(s.__extends)(t,e);function t(t){return e.call(this,{dataSourceName:"WebDataSource",id:"WebDataSource("+(t?t.webId:"")+")"},{pageContext:t})||this}t.prototype.addFileToWebList=function(e,t,n,r){var i=r?"true":"false",s=a.e.encodeRestUriStringToken(t),o=Object(u.n)(this._pageContext)+"/_api/Web/Lists('"+e+"')/RootFolder/Files/Add(Overwrite="+i+",Url='"+s+"')";return this.dataRequestor.getData({url:o,qosName:"AddFileToWebList",method:"POST",noRedirect:!0,additionalPostData:n,contentType:n.type,parseResponse:function(e){var t=JSON.parse(e);return t&&t.d?{name:t.d.Name,serverRelativeUrl:t.d.ServerRelativeUrl}:{name:void 0,serverRelativeUrl:void 0}}})};t.prototype.delete=function(){var e=this;return this.getData(function(){return Object(u.n)(e._pageContext)+"/_api/Web"},void 0,"DeleteWeb",void 0,"DELETE")};t.prototype.getWebProperties=function(){var e=this;return this.getDataUtilizingLegacyCache({getUrl:function(){return Object(u.n)(e._pageContext)+"/_api/Web/AllProperties"},parseResponse:function(e){var t=JSON.parse(e);return t&&t.d?{GlobalNavLogoUrl:t.d.GlobalNavLogoUrl,GlobalNavSource:t.d.GlobalNavSource,GlobalNavTitle:t.d.GlobalNavTitle,WebTemplateExtensionId:t.d.WebTemplateExtensionId}:{GlobalNavLogoUrl:void 0,GlobalNavSource:void 0,GlobalNavTitle:void 0,WebTemplateExtensionId:void 0}},qosName:"getWebProperties",method:"GET",noRedirect:!0,bypassCache:!0})};t.prototype.getBasicWebProperties=function(e){var t=this;return this.getDataUtilizingLegacyCache({getUrl:function(){return Object(u.n)(t._pageContext)+"/_api/Web?$select=Title,Description,SiteLogoUrl"},parseResponse:function(e){var t=JSON.parse(e);return t&&t.d?{description:t.d.Description,siteLogoUrl:t.d.SiteLogoUrl,title:t.d.Title}:{description:void 0,siteLogoUrl:void 0,title:void 0}},qosName:"GetBasicWebProperties",method:"GET",noRedirect:!0,bypassCache:!!e})};t.prototype.setBasicWebProperties=function(e){var t=this;return this.getData(function(){return Object(u.n)(t._pageContext)+"/_api/Web"},void 0,"SetBasicWebProperties",function(){var t={__metadata:{type:"SP.Web"},Description:e.description,SiteLogoUrl:e.siteLogoUrl,Title:e.title,QuickLaunchEnabled:e.quickLaunchEnabled,TitleTranslations:e.titleTranslations?{results:e.titleTranslations}:void 0,DescriptionTranslations:e.descriptionTranslations?{results:e.descriptionTranslations}:void 0,HasWebTemplateExtension:e.hasWebTemplateExtension};return JSON.stringify(t)},"PATCH")};t.prototype.setGlobalNavSettings=function(e,t){var n=JSON.stringify({title:e,source:t});return this.dataRequestor.getData({url:this._pageContext.webAbsoluteUrl+"/_api/Web/SetGlobalNavSettings",qosName:"SetGlobalNavSettings",method:"POST",additionalPostData:n,noRedirect:!0})};t.prototype.getDefaultDocumentLibraryUrl=function(e){var t=this;return this.getDataUtilizingLegacyCache({getUrl:function(){return Object(u.n)(t._pageContext)+"/_api/Web/DefaultDocumentLibrary/rootfolder/ServerRelativeUrl"},parseResponse:function(e){var t=JSON.parse(e);if(t&&t.d)return t.d.ServerRelativeUrl},qosName:"GetDefaultDocumentLibraryUrl",method:"GET",noRedirect:!0,bypassCache:!!e})};t.prototype.getClassicWelcomePage=function(e){var t=this;return this.getDataUtilizingLegacyCache({getUrl:function(){return Object(u.n)(t._pageContext)+"/_api/Web?$select=ClassicWelcomePage,IsRevertHomepageLinkHidden"},parseResponse:function(e){var t=JSON.parse(e);if(t&&t.d&&!t.d.IsRevertHomepageLinkHidden)return t.d.ClassicWelcomePage},qosName:"GetClassicWelcomePage",method:"GET",noRedirect:!0,bypassCache:!!e,cacheRequestKey:this._pageContext.webServerRelativeUrl+"ClassicWelcomePage"})};t.prototype.removeClassicWelcomePage=function(){var e=this;return this.getData(function(){return Object(u.n)(e._pageContext)+"/_api/Web"},void 0,"RemoveClassicWelcomePage",function(){return JSON.stringify({__metadata:{type:"SP.Web"},IsRevertHomepageLinkHidden:!0})},"PATCH").then(function(){e.flushCache(e._pageContext.webServerRelativeUrl+"ClassicWelcomePage")})};t.prototype.getDefaultDocumentLibraryCount=function(e){var t=this;return this.getDataUtilizingLegacyCache({getUrl:function(){return Object(u.n)(t._pageContext)+"/_api/Web/DefaultDocumentLibrary/ItemCount"},parseResponse:function(e){var t=JSON.parse(e);if(t&&t.d)return t.d.ItemCount},qosName:"GetDefaultDocumentLibraryCount",method:"GET",noRedirect:!0,bypassCache:!!e})};t.prototype.sendAuditLog=function(e){var t=""+Object(u.n)(this._pageContext),n=this._pageContext.webAbsoluteUrl,r=t+"/_api/web/ActivityLogger/LogActivity",i=JSON.stringify({Operation:e,AffectedResourceUrl:n,ItemType:"Site"});return this.dataRequestor.getData({url:r,qosName:"sendAuditLog",additionalPostData:i,additionalHeaders:{ClientGUID:"00000003-0000-0ff1-ce00-000000000000"}})};t.prototype.setSiteLogo=function(e,t,n,s,o,u){void 0===t&&(t=r.WebLogo);void 0===n&&(n=i.Square);var a=JSON.stringify({relativeLogoUrl:e,type:t,aspect:n,focalx:s,focaly:o,isFocalPatch:u});return this.dataRequestor.getData({url:this._pageContext.webAbsoluteUrl+"/_api/siteiconmanager/setsitelogo",qosName:"SetSiteLogo",method:"POST",additionalPostData:a,noRedirect:!0})};t.prototype.setNextStepsFirstRunEnabled=function(e){var t=JSON.stringify({__metadata:{type:"SP.Web"},NextStepsFirstRunEnabled:e});return this.dataRequestor.getData({url:Object(u.n)(this._pageContext)+"/_api/Web",parseResponse:void 0,qosName:"SetNextStepsFirstRunEnabled",additionalPostData:t,method:"PATCH"})};t.prototype.getWebTemplatesGalleryFirstRunEnabled=function(e){var t=this;return this.getDataUtilizingLegacyCache({getUrl:function(){return Object(u.n)(t._pageContext)+"/_api/Web/WebTemplatesGalleryFirstRunEnabled"},parseResponse:function(e){var t=JSON.parse(e);return!(!t||!t.d)&&t.d.WebTemplatesGalleryFirstRunEnabled},qosName:"getWebTemplatesGalleryFirstRunEnabled",method:"GET",noRedirect:!0,bypassCache:!!e})};t.prototype.setWebTemplatesGalleryFirstRunEnabled=function(e){var t=JSON.stringify({__metadata:{type:"SP.Web"},WebTemplatesGalleryFirstRunEnabled:e});return this.dataRequestor.getData({url:Object(u.n)(this._pageContext)+"/_api/Web",parseResponse:void 0,qosName:"setWebTemplatesGalleryFirstRunEnabled",additionalPostData:t,method:"PATCH"})};return t})(o.t)},3833:function(e,t,n){"use strict";var r=n(0),i=(function(e){Object(r.__extends)(t,e);function t(t){return e.call(this,{dataSourceName:"MicroServiceEndPointDataSource"},{pageContext:t})||this}t.prototype.getMicroServiceEndPoints=function(e){var t=this._pageContext.webAbsoluteUrl+"/_api/microservicemanager/getserviceurls?service='"+e+"'";return this.dataRequestor.getData({url:t,method:"GET",qosName:"GetServiceUrls"}).then(function(e){return e&&e.d&&e.d.GetServiceUrls&&e.d.GetServiceUrls.results&&e.d.GetServiceUrls.results[0]})};t.prototype.getAllMicroServiceEndPoints=function(e){var t=this._pageContext.webAbsoluteUrl+"/_api/microservicemanager/getserviceurls?service='"+e+"'";return this.dataRequestor.getData({url:t,method:"GET",qosName:"GetAllServiceUrls"}).then(function(e){return e&&e.d&&e.d.GetServiceUrls&&e.d.GetServiceUrls.results})};return t})(n(592).t);t.e=i},3859:function(e,t,n){"use strict";n.d(t,"e",function(){return u});var r=n(820),i=n(1431),s=n(1304),o=n(69);function u(e){var t=e||window._spPageContextInfo,n={webThemeProvider:function(){return new i.e({pageContext:t,getThemeDataSource:function(){return o.n.resolve(new s.e(t))}})}};return Object(r.e)(n,t)}},3860:function(e,t,n){"use strict";var r=(function(){function e(){this.members=new Array}e.prototype.addUserToList=function(e){this.members.unshift(e)};e.prototype.removeUserFromList=function(e){for(var t=-1,n=0;n<this.members.length;n++)this.members[n].userId===e.userId&&(t=n);t>=0&&this.members.splice(t,1)};e.prototype.containsUserByPrincipalName=function(e){if(e)for(var t=e.toLowerCase(),n=0;n<this.members.length;n++)if(this.members[n].principalName&&this.members[n].principalName.toLowerCase()===t)return!0;return!1};return e})();t.e=r},3863:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(302),i=Object(r.e)({eventName:"SuiteNavError,",shortEventName:"SuiteNavError",requiresParent:!1},{message:1,stack:1,type:1})},3911:function(e,t,n){"use strict";var r=n(675),i=(function(){function e(e){this._itemUrlHelper=e.itemUrlHelper;this._sharingContextInformation=e.sharingContextInformation}e.prototype.getApiRoot=function(e,t,n){if(this._sharingContextInformation){var i=this._sharingContextInformation,s=i.isFolder,o=i.isListSharing,u=i.itemUrl,a=i.listId,f=i.listItemId,l=i.listUrl,c=i.resourceId,h=i.serverRelativeItemUrl,p=i.uniqueId,d=i.webAbsoluteUrl;if(o)return e.build().webByUrl({webUrl:d}).method("Lists",a);if(p){if(a)return e.build().webByUrl({webUrl:d}).segment("lists").method("getbyid",a).method("GetItemByUniqueId",p);var v=s?"GetFolderById":"GetFileById",m={guid:p};return e.build().webByUrl({webUrl:d}).method(v,m).segment("ListItemAllFields")}return l?e.build().webByUrl({listUrl:l}).method("GetListItem",h):u?e.build().webByUrl({webUrl:d}).method("GetFileByUrl",r.t(u)).segment("ListItemAllFields"):a&&f?e.build().webByUrl({webUrl:d}).method("Lists",a).method("GetItemById",f):e.build().webByUrl({webUrl:d}).method("GetListItemByResourceId",c)}var g;g=t.properties.path?this._itemUrlHelper.getUrlParts({path:t.properties.path}):this._itemUrlHelper.getItemUrlParts(t.key);var y=e.build().webByItemUrl(g).method("Lists",n);t.isRootFolder||(y=t.properties.ID?y.method("GetItemById",t.properties.ID):y.method("GetItemByUniqueId",t.properties.uniqueId));return y};e.prototype.getFileUrl=function(e){return this._itemUrlHelper.getItemUrlParts(e.key).fullItemUrl};e.prototype.canUseSecurable=function(e){var t=e.properties;return!!t&&(e.isRootFolder?!!e.list&&!!e.list.id:!!t.ID||!!t.uniqueId)};e.getUniqueSharingPrincipals=function(e){if(e){var t=new Set;return e.filter(function(e){if(t.has(e.loginName))return!1;t.add(e.loginName);return!0})}};return e})();t.e=i},4013:function(e,t,n){"use strict";n.d(t,"e",function(){return o});var r=n(69),i=n(83),s=n(54),o=(function(){function e(e,t){var n=this._pageContext=t.pageContext;this._groupsProvider=t.groupsProvider;this._graphUserInfoDataSource=t.graphUserInfoDataSource;this._userInfoDataSource=t.userInfoDataSource;this._isTeamsRelevant=Object(i.s)(n)}e.prototype.getTeamsUrl=function(){return this._isTeamsRelevant?this._groupsProvider.getGroup().then(function(e){return e&&e.teamsUrl}):r.n.resolve()};e.prototype.canTeamify=function(){var e=this,t=this._pageContext;if(!this._isTeamsRelevant||!t.isSiteAdmin)return r.n.resolve(!1);if(t.isTeamsConnectedSite)return r.n.resolve(!1);return this._groupsProvider.getTeamifyBannerHidden().then(function(t){return!t&&e._groupsProvider.getGroup().then(function(t){return!t.teamsUrl&&!t.yammerResources&&e._graphUserInfoDataSource.canUseTeams().then(function(e){return e})}).catch(function(){return!1})})};e.prototype.shouldShowTeamsCoachmark=function(){var e=this;return(-1!==(window.location.search||"").indexOf("resetbubble=1")?this._userInfoDataSource.setUserFlagValue("sharePointTeamsTeachingBubble",!1).then(function(){return!1}):this._userInfoDataSource.getUserFlagValue("sharePointTeamsTeachingBubble")).then(function(t){if(!1===t)return e._graphUserInfoDataSource.canUseTeams()})};e.prototype.findTeamsLink=function(e,t){if(e&&e.length){var n=new s.t(t.toLowerCase());t=decodeURIComponent(n.getStringWithoutQueryAndFragment());for(var r=0,i=e;r<i.length;r++){var o=i[r],u=decodeURIComponent((o.url||"").toLowerCase());if(u.substring(0,t.length)===t||-1!==u.indexOf("/_layouts/15/groupstatus.aspx?target=team"))return o}}};e.prototype.setTeamsBubbleFlag=function(e){return this._userInfoDataSource.setUserFlagValue("sharePointTeamsTeachingBubble",e)};return e})()},4165:function(e,t,n){"use strict";n.d(t,"e",function(){return m});var r=n(0),i=n(83),s=n(30),o=n(4252),u=n(59),a=n(245),f=n(344),l=n(67),c=n(1415),h=n(592),p=n(12),d=n(53);var v={ODB:60222,ODC:null,Fallback:!1},m=(function(e){Object(r.__extends)(t,e);function t(n,r){var i=e.call(this,{dataSourceName:"SuiteNavDataSource"},r)||this;i._suiteNavContext=n.suiteNavContext;i._suiteNavDataUpdater=n.suiteNavDataUpdater;i._suiteNavDataSourceBasic=n.suiteNavDataSourceBasic?n.suiteNavDataSourceBasic:new c.e(n,r);i._prefetchCache=r.prefetchCache;if(i._useDeadTabDetection()){i._signInTimeAtPageLoad=t._getSignInTime();i._signInTimeAtPageLoad&&window.addEventListener("focus",function(){if("undefined"!=typeof MastInteraction&&MastInteraction.ShowPrompt){var e=t._getSignInTime();if(e&&e>i._signInTimeAtPageLoad){MastInteraction.SignOutPage();MastInteraction.ShowPrompt("SwitchAccount")}}})}return i}t.prototype.getCapabilities=function(){return this._suiteNavDataSourceBasic.getCapabilities()};t.prototype.getReactShellBootstrapperUrl=function(){return this._suiteNavDataSourceBasic.getReactShellBootstrapperUrl()};t.prototype.getInitialRenderNavBarData=function(){return this._suiteNavDataSourceBasic.getInitialRenderNavBarData()};t.prototype.getCacheToken=function(){return this._suiteNavDataSourceBasic.getCacheToken()};t.prototype.getUserIdentifier=function(){return this._suiteNavDataSourceBasic.getUserIdentifier()};t.prototype.getWebTemplateType=function(){var e;return Number((null===(e=this._pageContext)||void 0===e?void 0:e.webTemplate)||d.t.invalid)};t.prototype.setFeedbackMetadata=function(e,t){var r=this,i=this._suiteNavContext.feedbackOptions;if(i&&i.appId){e=e||{contentLanguage:void 0,source:"OneShell",options:{telemetryGroup:{}}};var s=a.n.isFeatureEnabled({ODB:f.r?-1246:1246,ODC:null,Fallback:!1});!l.t.isActivated("88d7a955-6ccc-4b35-b8ff-342a6bb08f3b","9/27/2021","Add Lists Freemium feature area")&&this._pageContext.isSiteListsHost&&(s=!0);var o=e.options;o.appId=i.appId;o.disableIncludeScreenshot=!s;o.userVoiceEnabled=i.userVoiceEnabled;o.userVoiceLink=i.userVoiceLink;if(!l.t.isActivated("A12253B9-7F27-4C11-BFC9-3E7688B5CE1E","9/14/20","Ensure appData in feedback options")){o.applicationGroup||(o.applicationGroup={});o.applicationGroup.appData||(o.applicationGroup.appData="{}")}var u=o.telemetryGroup;u.audienceGroup=this._getAudienceGroup();u.featureArea=this._getFeatureArea();u.processSessionId=this._pageContext.CorrelationId;s&&t&&n.ee([601],4694,7).then(function(e){var n=e.default||e;if(!l.t.isActivated("88d7a955-6ccc-4b35-b8ff-342a6bb08f3b","9/27/2021","Add Lists Freemium feature area")&&r._pageContext.isSiteListsHost){var i=document.body;try{window.frames.length>0&&(i=window.frames[0].document.body)}catch(e){}n(i).then(function(e){t(e.toDataURL("image/jpeg"))})}else n(document.body).then(function(e){t(e.toDataURL("image/jpeg"))})})}return e};t.prototype.loadData=function(e){var t=this;if(!e&&this._dataPromise)return this._dataPromise;var n,r,s=u.e.escapeUrlForCallback(this._pageContext.currentUICultureName),o=Object(i.n)(this._pageContext),a=o?u.e.escapeUrlForCallback(o):"",f=(n={baseUrl:a,cultureName:s}).baseUrl+"/_layouts/15/online/handlers/SpoSuiteLinks.ashx?Locale="+n.cultureName+"&v=2&msajax=1&cv=2",l=a+"/_api/Microsoft.SharePoint.Portal.SuiteNavData.GetSuiteNavData?v=2&Locale="+s,h=function(e){var n={suiteNavData:e.NavBarData,suiteNavContext:t._suiteNavContext,pageContext:t._pageContext},r=t._suiteNavDataUpdater?t._suiteNavDataUpdater.updateSuiteNavData(n):e.NavBarData,i=!(!r.HasTenantBranding||!e.TenantPrimaryColorShades&&!r.TenantLogoUrl);r.AppBrandTheme=Object(c.n)(t._suiteNavContext);return{data:r,jsUrl:e.JsUrl,cssUrl:e.CssUrl,hasCobranding:i,userIdentifier:t.getUserIdentifier(),cacheToken:t.getCacheToken()}},p=function(e){return t.getData(function(){return e},function(e){return JSON.parse(e)},"LoadData",null,"POST",null,null,1).then(function(t){var n=e===f?t:JSON.parse(t.d.GetSuiteNavData);return h(n)})},d=function(){return p(f).catch(function(){return p(l)})};if(this._pageContext.isSPO){var v=!1;if(this._prefetchCache){var m=this._prefetchCache.getData({url:f,body:"",qosName:"SpoSuiteLinks"});if(m){r=m.then(h,d);v=!0}}v||(r=d())}else r=p(l);this._dataPromise=r;r.catch(function(){t._dataPromise=null});return r};t.prototype.getSuiteNavContext=function(){return this._suiteNavContext};t.prototype.onCssLoad=function(e){if(e.data&&e.data.ClientData)try{var t=JSON.parse(e.data.ClientData);t&&t.IsFallbackShell&&Object(o.e)()}catch(e){}};t.prototype.updateDataForCurrentPage=function(e){if(!this._suiteNavDataUpdater)return e;var t={suiteNavData:e,suiteNavContext:this._suiteNavContext,pageContext:this._pageContext};return this._suiteNavDataUpdater.updateSuiteNavData(t)};t.prototype._getAudienceGroup=function(){var e,t=this._pageContext;"prodbubble"===t.env&&"MSIT_SPDF_1_Content"===t.farmLabel?e="Dogfood":"prodbubble"===t.env?e="Microsoft":("prod"===t.env||"dprod"===t.env||!l.t.isActivated("88d7a955-6ccc-4b35-b8ff-342a6bb08f3b","9/27/2021","Add Lists Freemium feature area")&&t.isSiteListsHost)&&(e="Production");return e};t.prototype._getFeatureArea=function(){var e=this._pageContext;return!l.t.isActivated("88d7a955-6ccc-4b35-b8ff-342a6bb08f3b","9/27/2021","Add Lists Freemium feature area")&&e.isSiteListsHost?"Lists Freemium":e.listBaseTemplate===p.t.genericList?"List":e.listBaseTemplate===p.t.documentLibrary?"Libraries":e.listBaseTemplate===p.t.webPageLibrary?"Modern Pages and News Authoring (Floodgate)":"Site"};t.prototype._useDeadTabDetection=function(){return!l.t.isActivated("8FE233B6-3394-4918-A449-B5808E8B40BD","9/8/21","Dead tab detection")&&a.n.isFeatureEnabled(v)};t._getCookieValue=function(e){var t;return(null===(t=document.cookie.match("(^|;)\\s*"+e+"\\s*=\\s*([^;]+)"))||void 0===t?void 0:t.pop())||""};t._getSignInTime=function(){var e=t._getCookieValue("SIMI");return e?Number(JSON.parse(atob(e)).st):0};t.siteSettingsPermissions=[s.e.enumeratePermissions,s.e.manageWeb,s.e.manageSubwebs,s.e.addAndCustomizePages,s.e.applyThemeAndBorder,s.e.manageAlerts,s.e.manageLists,s.e.viewUsageData];return t})(h.e)},4176:function(e,t,n){"use strict";n.d(t,"e",function(){return f});var r=n(69),i=n(2370),s=n(0),o=n(248),u=n(114),a=(function(e){Object(s.__extends)(t,e);function t(){var n=e.call(this,t._Key,t._DataStoreCachingType)||this;n._MaxItems=200;n._Version=5;n._buffer=n.getValue(t._StorageKey);n._buffer&&n._buffer.version===n._Version&&n._buffer.lastCachePrune||n.initializeBuffer();n._data={};if(Date.now()<n._buffer.lastCachePrune+6048e5)for(var r=0;r<n._buffer.dataArray.length;r++)n._data[n._buffer.dataArray[r].email]=n._buffer.dataArray[r];else{n.initializeBuffer();n.setValue(t._StorageKey,n._buffer)}return n}t.clear=function(){new o.e(t._Key,t._DataStoreCachingType).remove(t._StorageKey)};t.isCacheEntryFresh=function(e,t){return e.name===t.name&&e.email===t.email&&e.job===t.job&&e.office===t.office&&e.department===t.department&&e.phone===t.phone};t.prototype.setItem=function(e){var n=this._data[e.email];if(n){if(t.isCacheEntryFresh(n,e))return;var r=this._buffer.dataArray.map(function(e){return e.userId}).indexOf(e.userId);this._buffer.dataArray[r]=e}else if(this._buffer.dataArray.length===this._MaxItems){this._buffer.index++;this._buffer.index>=this._MaxItems&&(this._buffer.index=0);var i=this._buffer.dataArray[this._buffer.index];delete this._data[i.email];this._buffer.dataArray[this._buffer.index]=e}else{this._buffer.dataArray.push(e);this._buffer.index++}this._data[e.email]=e;this.setValue(t._StorageKey,this._buffer)};t.prototype.getItems=function(e,t){for(var n=[],r=0;r<this._buffer.dataArray.length;r++){var i=(this._buffer.index-r+this._MaxItems)%this._MaxItems;!(this._buffer.dataArray[i].email&&this._buffer.dataArray[i].email.toLowerCase().indexOf(e.toLowerCase())>=0||this._buffer.dataArray[i].name&&this._buffer.dataArray[i].name.toLowerCase().indexOf(e.toLowerCase())>=0)||t&&1===this._buffer.dataArray[i].entityType||n.push(this._buffer.dataArray[i])}return n};t.prototype.containsItem=function(e){return Boolean(this._data[e.email])};t.prototype.initializeBuffer=function(){this._buffer={};this._buffer.dataArray=[];this._buffer.index=-1;this._buffer.version=this._Version;this._buffer.lastCachePrune=Date.now()};t._Key="ClientPeoplePicker";t._StorageKey="MRU";t._DataStoreCachingType=u.e.local;return t})(o.e),f=(function(){function e(e){this._dataSource=e.peoplePickerDataSource?e.peoplePickerDataSource:new i.e({imageAbsoluteWebUrl:e.imageAbsoluteWebUrl},{pageContext:e.pageContext,apiUrlHelper:e.apiUrlHelper,graphPeoplePickerHelper:e.graphPeoplePickerHelper});this._ppCapabilities=this._dataSource.getCapabilities();if(this._ppCapabilities.supportsMruCaching){this._mruCache=new a;this.MaxCacheSuggestions=5}else this.MaxCacheSuggestions=0}e.prototype.search=function(e,t){var n,i,s=this,o={cached:null,promise:null};this._mruCache&&!t.groupID&&(i=this.searchMruCache(e,t&&t.filterExternalUsers)).length>0&&(o.cached=i);o.promise=new r.n(function(r,o){n=s._dataSource.search(e,t).then(function(e){if(e)if(i){i.length>0&&(i=s._removeStaleCacheResults(i,e));var t=i.map(function(e){return e.userId});r(e.filter(function(e){return t.indexOf(e.userId)<0}))}else r(e)},function(e){o(e)})},function(){n&&n.cancel()});return o};e.prototype.resolve=function(e,t){var n=this;return this._dataSource.resolve(e,t).then(function(e){n._mruCache&&e.isResolved&&n.addToMruCache(e);return e})};e.prototype.getPersonaDetails=function(e){return this._dataSource.getPersonaDetails(e).then(function(e){return e})};e.prototype.subscribePresence=function(e,t){return this._dataSource.subscribePresence(e,t)};e.prototype.addToMruCache=function(e){var t=this._mruCache;t&&e.rawPersonData&&e.rawPersonData.EntityData&&"UNVALIDATED_EMAIL_ADDRESS"!==e.rawPersonData.EntityData.PrincipalType&&t.setItem(e)};e.prototype.getPickerEntityInformation=function(e){return this._dataSource.getPickerEntityInformation(e)};e.prototype.sharePointSearch=function(e,t){return this._dataSource.sharePointSearch(e,t).then(function(e){return e})};e.prototype.canUseGraph=function(e){return this._dataSource.canUseGraph(e)};e.prototype.canUseSubstrate=function(e){return this._dataSource.canUseSubstrate(e)};e.prototype.getLivePersonaPickerHelper=function(){return this._dataSource.getLivePersonaPickerHelper()};e.prototype.searchMruCache=function(e,t){var n=[],r=this._mruCache;if(r){n=r.getItems(e,t);var i=this.MaxCacheSuggestions;n.length>i&&(n=n.splice(0,i))}return n};e.prototype._removeStaleCacheResults=function(e,t){var n=e.map(function(e){return e.userId}),r=[];t.forEach(function(t){var i=n.indexOf(t.userId);if(i>-1){var s=e[i];a.isCacheEntryFresh(s,t)&&r.push(s)}});return r};return e})()},4254:function(e,t,n){"use strict";n.d(t,"e",function(){return l});var r,i,s=n(0),o=n(592),u=n(83),a=n(1092),f=n(18);(function(e){e[e.Owners=0]="Owners";e[e.Members=1]="Members";e[e.Vistors=2]="Vistors"})(r||(r={}));(function(e){e[e.Vistors=0]="Vistors"})(i||(i={}));var l=(function(e){Object(s.__extends)(t,e);function t(t){return e.call(this,{dataSourceName:"SitePermissionsDataSource"},{pageContext:t})||this}t.prototype.getSiteGroupsAndUsers=function(e){var t=this,n=e?"":"?$expand=Users";return this.getData(function(){return t._getUrl("web/SiteGroups"+n)},function(e){return t._parseSiteGroupsAndUsers(e)},"GetSiteGroupsAndUsers",void 0,"GET")};t.prototype.getSiteGroupAndUsersById=function(e){var t=this;return this.dataRequestor.getData({url:this._getUrl("web/SiteGroups/GetById(id="+e+")?$expand=Users"),parseResponse:function(e){return t._parseSiteGroupAndUsers(e)},qosName:"GetSiteGroupAndUsersById",method:"GET",noRedirect:!0})};t.prototype.associatedPermissionGroups=function(){var e=this;return this.getData(function(){return Object(u.n)(e._pageContext)+"/_api/web?$expand=AssociatedOwnerGroup,AssociatedMemberGroup,AssociatedVisitorGroup"},function(t){return e._parseAssociatedPermissionGroups(t)},"associatedPermissionGroups",void 0,"GET")};t.prototype.hubSitePermissionGroups=function(){var e=this;return this.getData(function(){return Object(u.n)(e._pageContext)+"/_api/site?$expand=HubSiteSynchronizableVisitorGroup"},function(t){return e._parseHubSitePermissionGroups(t)},"hubSitePermissionGroups",void 0,"GET")};t.prototype.addRoleAssignment=function(e,t){var n=this;return this.getData(function(){return n._getUrl(f.format("web/RoleAssignments/addroleassignment(principalid={0},roledefid={1})",e,t))},void 0,"AddRoleAssignment",void 0,"POST",void 0,void 0,3)};t.prototype.removeRoleAssignment=function(e,t){var n=this;return this.getData(function(){return n._getUrl(f.format("web/RoleAssignments/removeroleassignment(principalid={0},roledefid={1})",e,t))},void 0,"RemoveRoleAssignment",void 0,"POST",void 0,void 0,3)};t.prototype.addUserToGroup=function(e,t){var n=this,r={__metadata:{type:"SP.User"},LoginName:t};return this.getData(function(){return n._getUrl(f.format("web/sitegroups(id={0})/users",e))},void 0,"addToGroupById",function(){return JSON.stringify(r)},"POST",void 0,void 0,3)};t.prototype.removeFromGroupById=function(e,t){var n=this;return this.getData(function(){return n._getUrl(f.format("web/sitegroups(id={0})/users/removebyid(id={1})",e,t))},void 0,"removeFromGroupById",void 0,"POST",void 0,void 0,3)};t.prototype.ensureUser=function(e){var t=this,n={logonName:e};return this.getData(function(){return t._getUrl("web/ensureUser")},function(e){return t._parseSiteGroupAndUsers(e)},"ensureUser",function(){return JSON.stringify(n)},"POST",void 0,void 0,3,!0)};t.prototype.getRoleAssignments=function(){var e=this;return this.dataRequestor.getData({url:Object(u.n)(this._pageContext)+"/_api/web/RoleAssignments?$expand=RoleDefinitionBindings",parseResponse:function(t){return e._parseRoleAssignments(t)},qosName:"GetRoleAssignments",method:"GET",noRedirect:!0})};t.prototype._parseSiteGroupsAndUsers=function(e){var t=this,n=JSON.parse(e);return n&&n.d&&n.d.results&&n.d.results.length>0?n.d.results.map(function(e){return t._parseSPUser(e)}):e};t.prototype._parseSiteGroupAndUsers=function(e){var t=JSON.parse(e);return t&&t.d?this._parseSPUser(t.d):void 0};t.prototype._parseSPUser=function(e){var t=this;return{id:e.Id,loginName:e.LoginName,principalType:e.PrincipalType,title:e.Title,email:e.Email,allowMembersEditMembership:e.AllowMembersEditMembership,allowRequestToJoinLeave:e.AllowRequestToJoinLeave,autoAcceptRequestToJoinLeave:e.AutoAcceptRequestToJoinLeave,description:e.Description,users:e.Users&&e.Users.results&&e.Users.results.length>0?e.Users.results.map(function(n){return{id:n.Id,principalId:e.Id,email:n.Email,loginName:n.LoginName,isSiteAdmin:n.IsSiteAdmin,principalType:n.PrincipalType,title:n.Title,urlImage:t._fixUserImage(n)}}):void 0}};t.prototype._parseAssociatedPermissionGroups=function(e){var t=JSON.parse(e),n=[];if(t&&t.d&&t.d.AssociatedMemberGroup&&t.d.AssociatedOwnerGroup&&t.d.AssociatedVisitorGroup){n[0]=this._getSPUserFromAssociatedGroup(t.d.AssociatedOwnerGroup,5);n[1]=this._getSPUserFromAssociatedGroup(t.d.AssociatedMemberGroup,6);n[2]=this._getSPUserFromAssociatedGroup(t.d.AssociatedVisitorGroup,2)}return n};t.prototype._parseHubSitePermissionGroups=function(e){var t=JSON.parse(e),n=[];t&&t.d&&t.d.HubSiteSynchronizableVisitorGroup&&t.d.HubSiteSynchronizableVisitorGroup.LoginName&&(n[0]=this._getSPUserFromAssociatedGroup(t.d.HubSiteSynchronizableVisitorGroup,2));return n};t.prototype._getSPUserFromAssociatedGroup=function(e,t){return{id:e.Id,loginName:e.LoginName,principalType:e.PrincipalType,title:e.Title,roleType:t}};t.prototype._parseRoleAssignments=function(e){var t={},n=JSON.parse(e);if(n&&n.d&&n.d.results&&n.d.results.length>0){var r=n.d.results;for(var i in r){var s=r[i]&&r[i].PrincipalId,o=[];if(r[i]&&r[i].RoleDefinitionBindings&&r[i].RoleDefinitionBindings.results){var u=r[i].RoleDefinitionBindings.results;for(var a in u){var f=u[a];if(f){var l={id:f.Id,name:f.Name,basePermissions:{High:f.BasePermissions.High,Low:f.BasePermissions.Low},description:f.Description,hidden:f.Hidden,order:f.Order,roleTypeKind:f.RoleTypeKind};o.push(l)}}}t[s]=o}}return t};t.prototype._fixUserImage=function(e){if(1===e.PrincipalType&&e.Email)return Object(a.getUserPhotoUrl)(e.Email)};t.prototype._getUrl=function(e){return this._pageContext.webAbsoluteUrl+"/_api/"+e};return t})(o.t)},4257:function(e,t,n){"use strict";n.r(t);n.d(t,"UserExpirationDataSource",function(){return c});var r=n(0),i=n(291),s=n(69),o=n(83),u=n(2471),a=n(58),f=n(477),l=n(67),c=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,{dataSourceName:"UserExpirationDataSource",id:"UserExpirationDataSource"},{pageContext:t.pageContext})||this;n._dataRequestor=new i.t({qosName:"UserExpirationDataSource",pageContext:t.pageContext});var r=Object(o.n)(t.pageContext);n._getExpiringUsersUrl=r+"/_api/web/SiteUserInfoList/GetItems";n._setUserExpirationUrl=r+"/_api/web/SiteUsers/GetById(@a)";n._expireUserUrl=r+"/_api/web/SiteUsers/GetById(@a)/Expire";n._externalUserExpirationPolicyUrl=r+"/_api/Site/ExternalUserExpirationInDays";return n}t.prototype.setUserExpiration=function(e,t){var n=this;if(!e||e.length<1)return s.n.reject([!1]);if(e.length>1){var r=a.e.generate(),i="multipart/mixed; boundary=batch_"+r,o=[],f=[],l=[];e.forEach(function(e){o.push(n._setUserExpirationUrl+"?@a="+e.id);f.push(JSON.stringify({__metadata:{type:"SP.User"},Expiration:t?t.toISOString():""}));l.push("PATCH")});var c=this._dataRequestor.getData({url:u.t.getBatchOperationUrl(this._pageContext.webAbsoluteUrl),parseResponse:function(e){return e},qosName:"SetUserExpirations",additionalPostData:u.t.getBatchContentExtended(r,o,"PATCH",u.t.defaultBatchRequestPostData,f,u.t.defaultBatchAcceptData,l),method:"POST",contentType:i,noRedirect:!0,needsRequestDigest:!0});this.flushCache();return c.then(function(e){var t=u.t.processBatchResponse(e);return t.hasError?s.n.reject(t):t}).then(function(e){return e.items.map(function(){return!0})},function(e){return e.items.map(function(e){return!e.error})})}var h=this._setUserExpirationUrl+"?@a="+e[0].id,p={__metadata:{type:"SP.User"},Expiration:t?t.toISOString():""};this.flushCache();return this._dataRequestor.getData({url:h,parseResponse:function(e){return[!e]},qosName:"SetUserExpiration",additionalPostData:JSON.stringify(p),method:"POST",additionalHeaders:{"X-HTTP-Method":"PATCH"},noRedirect:!0,needsRequestDigest:!0})};t.prototype.expireUser=function(e){var t=this;if(!e||e.length<1)return s.n.reject([!1]);if(e.length>1){var n=a.e.generate(),r="multipart/mixed; boundary=batch_"+n,i=[],o=[];e.forEach(function(e){i.push(t._expireUserUrl+"?@a="+e.id);o.push("POST")});var f=this._dataRequestor.getData({url:u.t.getBatchOperationUrl(this._pageContext.webAbsoluteUrl),parseResponse:function(e){return e},qosName:"BatchExpireUser",additionalPostData:u.t.getBatchContentExtended(n,i,"POST",u.t.defaultBatchRequestPostData,[],u.t.defaultBatchAcceptData,o),method:"POST",contentType:r});this.flushCache();return f.then(function(e){var t=u.t.processBatchResponse(e);return t.hasError?s.n.reject(t):t}).then(function(e){return e.items.map(function(){return!0})},function(e){return e.items.map(function(e){return!e.error})})}var l=this._expireUserUrl+"?@a="+e[0].id;this.flushCache();return this._dataRequestor.getData({url:l,parseResponse:function(e){if(e){var t=JSON.parse(e);if(t&&t.d)return[!0]}return[!1]},qosName:"ExpireUser",method:"POST"})};t.prototype.getUsersWithExpirationsWithCache=function(e,t,n,r,i,s){var o=[];n&&o.push("$top="+n);r&&o.push("$skip="+r);e&&o.push("$orderby="+e+" "+(t?"asc":"desc"));i&&o.push("$filter="+i);o.push("$select=Title,ID,Name,UserExpiration,IsSiteAdmin,EMail");var u=this._getExpiringUsersUrl;o.length>0&&(u+="?"+o.join("&"));return this.getDataUtilizingPersistentCache({url:u,parseResponse:function(e){var t=JSON.parse(e);return t&&t.d&&t.d.results?t.d.results.map(function(e){return{id:e.ID,loginName:e.Name,email:e.EMail,expiration:new Date(e.UserExpiration),title:e.Title,isSiteAdmin:e.IsSiteAdmin}}):e},qosName:"GetUsersWithExpirations",additionalPostData:JSON.stringify({query:{__metadata:{type:"SP.CamlQuery"},ViewXml:"<View><Query><Where><IsNotNull><FieldRef Name='UserExpiration'/></IsNotNull></Where></Query></View>"}}),method:"POST",cachingStrategy:s})};t.prototype.getUsersWithExpirations=function(e,t,n,r,i){var s=this;return this.getUsersWithExpirationsWithCache(e,t,n,r,i,1).then(function(o){var u=s.hasSiteUsersExpiringSoon(o),a=s._pageContext.HasSiteUsersExpiringSoon===u;return l.t.isActivated("8A69325A-D039-420F-A576-FA103612FAD5","7/29/2021","Bypass cache to match pageContext expiringUser count")||0!==r||a?o:s.getUsersWithExpirationsWithCache(e,t,n,r,i,3)})};t.prototype.hasSiteUsersExpiringSoon=function(e){var t=new Date;t.setDate(t.getDate()+21);return e&&e.some(function(e){return e.expiration&&e.expiration<t})};t.prototype.getExternalUserExpirationPolicy=function(){return this._dataRequestor.getData({url:this._externalUserExpirationPolicyUrl,parseResponse:function(e){if(e){var t=JSON.parse(e);if(t&&t.d&&t.d.ExternalUserExpirationInDays)return t.d.ExternalUserExpirationInDays}return 0},qosName:"GetExternalUserExpirationPolicy",method:"GET",needsRequestDigest:!0})};return t})(f.t);t.default=c},4273:function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r=n(0),i=n(69),s=(function(e){Object(r.__extends)(t,e);function t(t){return e.call(this,{dataSourceName:"HeaderEmphasis"},{pageContext:t})||this}t.prototype.setHeaderEmphasis=function(e){var t=this;return"number"==typeof e?this.getData(function(){return t._pageContext.webAbsoluteUrl+"/_api/web"},function(e){},"setHeaderEmphasis",function(){return JSON.stringify({HeaderEmphasis:e,__metadata:{type:"SP.Web"}})},"POST",{"X-HTTP-Method":"MERGE"}).then(function(){t._pageContext.headerEmphasis=Number(e)}):i.n.resolve()};return t})(n(592).e)},4274:function(e,t,n){"use strict";n.d(t,"e",function(){return l});var r=n(0),i=n(69),s=n(592),o=n(83),u=n(405),a=n(2996),f={ODB:60340},l=(function(e){Object(r.__extends)(t,e);function t(t){return e.call(this,{dataSourceName:"ChromeOptions"},{pageContext:t})||this}t.prototype.setChromeOptions=function(e){var t=this,n=this._pageContext;return this.dataRequestor.getData({url:n.webAbsoluteUrl+"/_api/web/SetChromeOptions",method:"POST",qosName:"setChromeOptionsOnWeb",additionalPostData:JSON.stringify(e)}).then(function(){var n=e.headerLayout,r=e.headerEmphasis,i=e.megaMenuEnabled,s=e.footerEnabled,o=e.footerLayout,a=e.footerEmphasis,l=e.hideTitleInHeader,c=e.horizontalQuickLaunch;null!=n&&t._onHeaderLayoutUpdated(n);null!=r&&t._onHeaderEmphasisUpdated(r);null!=s&&t._onFooterVisibilityUpdated(s);null!=i&&t._onMegaMenuEnabledUpdated(i);null!=o&&t._onFooterLayoutUpdated(o);null!=a&&t._onFooterEmphasisUpdated(a);null!=l&&t._onTitleVisibilityUpdated(l);u.e(f,t._pageContext,{experimentFlightId:90024,killSwitch:"39702562-b8cb-4062-acff-022dc2cb0606"})&&null!=c&&t._onHorizontalQuickLaunchUpdated(c)})};t.prototype.setNavMegaMenu=function(e){var t=this,n=this._pageContext;return this.dataRequestor.getData({url:n.webAbsoluteUrl+"/_api/web",method:"POST",qosName:"enableMegaMenuOnNav",additionalPostData:JSON.stringify({MegaMenuEnabled:e,__metadata:{type:"SP.Web"}}),additionalHeaders:{"X-HTTP-Method":"MERGE"}}).then(function(){t._onMegaMenuEnabledUpdated(e)})};t.prototype._onMegaMenuEnabledUpdated=function(e){var t=this._pageContext;e?t.webPropertyFlags2|=o.t.MegaMenuEnabled:t.webPropertyFlags2&=~o.t.MegaMenuEnabled;if(t.isHubSite){this._hubDataSource||(this._hubDataSource=new a.HubDataSource(t));this._hubDataSource.getHubData(t.PublishingFeatureOn,!0)}};t.prototype.setFooterVisibility=function(e){var t=this;return this.dataRequestor.getData({url:this._pageContext.webAbsoluteUrl+"/_api/web",method:"POST",qosName:"enableSiteFooter",additionalPostData:JSON.stringify({FooterEnabled:e,__metadata:{type:"SP.Web"}}),additionalHeaders:{"X-HTTP-Method":"MERGE"}}).then(function(){t._onFooterVisibilityUpdated(e)})};t.prototype._onFooterVisibilityUpdated=function(e){e?this._pageContext.webPropertyFlags2|=o.t.FooterEnabled:this._pageContext.webPropertyFlags2&=~o.t.FooterEnabled};t.prototype.setTitleVisibility=function(e){var t=this;return this.dataRequestor.getData({url:this._pageContext.webAbsoluteUrl+"/_api/web",method:"POST",qosName:"enableSiteTitle",additionalPostData:JSON.stringify({HideTitleInHeader:e,__metadata:{type:"SP.Web"}}),additionalHeaders:{"X-HTTP-Method":"MERGE"}}).then(function(){t._onTitleVisibilityUpdated(e)})};t.prototype._onTitleVisibilityUpdated=function(e){e?this._pageContext.webPropertyFlags2|=o.t.HideTitleInHeader:this._pageContext.webPropertyFlags2&=~o.t.HideTitleInHeader};t.prototype._onHorizontalQuickLaunchUpdated=function(e){e?this._pageContext.webPropertyFlags2|=o.t.HorizontalQuickLaunch:this._pageContext.webPropertyFlags2&=~o.t.HorizontalQuickLaunch};t.prototype.setHeaderLayout=function(e){var t=this;return"number"==typeof e?this.dataRequestor.getData({url:this._pageContext.webAbsoluteUrl+"/_api/web",qosName:"setHeaderLayout",additionalPostData:JSON.stringify({HeaderLayout:e,__metadata:{type:"SP.Web"}}),additionalHeaders:{"X-HTTP-Method":"MERGE"}}).then(function(){t._onHeaderLayoutUpdated(e)}):i.n.resolve()};t.prototype._onHeaderLayoutUpdated=function(e){this._pageContext.headerLayout=e};t.prototype._onHeaderEmphasisUpdated=function(e){this._pageContext.headerEmphasis=Number(e)};t.prototype.setFooterLayout=function(e){var t=this;return this.dataRequestor.getData({url:this._pageContext.webAbsoluteUrl+"/_api/web",qosName:"setFooterLayout",additionalPostData:JSON.stringify({FooterLayout:e,__metadata:{type:"SP.Web"}}),additionalHeaders:{"X-HTTP-METHOD":"MERGE"}}).then(function(){t._onFooterLayoutUpdated(e)})};t.prototype._onFooterLayoutUpdated=function(e){e>1?this._pageContext.webPropertyFlags2|=o.t.FooterLayout1:this._pageContext.webPropertyFlags2&=~o.t.FooterLayout1;e%2==0?this._pageContext.webPropertyFlags2&=~o.t.FooterLayout0:this._pageContext.webPropertyFlags2|=o.t.FooterLayout0};t.prototype.setFooterEmphasis=function(e){var t=this;return this.dataRequestor.getData({url:this._pageContext.webAbsoluteUrl+"/_api/web",qosName:"setFooterEmphasis",additionalPostData:JSON.stringify({FooterEmphasis:e,__metadata:{type:"SP.Web"}}),additionalHeaders:{"X-HTTP-Method":"MERGE"}}).then(function(){t._onFooterEmphasisUpdated(e)})};t.prototype._onFooterEmphasisUpdated=function(e){e>1?this._pageContext.webPropertyFlags2|=o.t.FooterEmphasis1:this._pageContext.webPropertyFlags2&=~o.t.FooterEmphasis1;e%2==0?this._pageContext.webPropertyFlags2&=~o.t.FooterEmphasis0:this._pageContext.webPropertyFlags2|=o.t.FooterEmphasis0};return t})(s.e)},4278:function(e,t,n){"use strict";n.d(t,"e",function(){return N});var r=n(0),i=n(387),s=n(248),o=n(114),u=n(1665),a=n(3863),f=n(53),l=n(1214),c=n(95),h=n(245),p=n(67),d=n(3859),v=n(344),m=n(69),g=n(1091),y=n(163),b=n(84),w=n(44),E=n(1429),S={ODB:556,ODC:null,Fallback:!1},x={ODB:1302,ODC:null,Fallback:!1},T={ODB:1836,ODC:null,Fallback:!1},N=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,{engagementEvent:y.e,qosEvents:{"SuiteNavProvider.GetO365Shell":new b.e({name:"SuiteNavProvider.GetO365Shell"})}},n)||this;r._dataSource=n.dataSource;r._cssLoaded=!1;r._isSuiteNavBootstrapperLoadingFlowEnabled=h.n.isFeatureEnabled(x);return r}t.prototype.clearCachedPromise=function(){this._modelPromise=void 0};t.prototype.loadData=function(e){return this._loadModel(e).then(function(e){return e.data})};t.prototype.getO365Shell=function(){if(this._isSuiteNavBootstrapperLoadingFlowEnabled)return e.prototype.getO365Shell.call(this);if(!this._capabilities.supportsRealSuiteNav)throw new Error("getO365Shell is only supported if supportsRealSuiteNav capability is true.");var t=new i.e,n=new b.e({name:"SuiteNavProvider.GetO365Shell"});this._getSuiteNavShell(t);t.getPromise().then(function(){n.end({resultType:w.e.Success})},function(e){n.end(Object(E.n)({error:e}))});return t.getPromise()};t.prototype.getMailUrl=function(){return this._loadModel().then(function(e){var t=e&&e.data&&e.data.WorkloadLinks;if(t)for(var n=0,r=t;n<r.length;n++){var i=r[n];if(i&&i.Id===l.e.MAIL)return i.Url}})};t.prototype.updateWorkloadSettingsLinks=function(e){var t,n=this;return this.getO365Shell().then(function(r){return(t=r)&&t.Settings?n.loadData(e):void 0}).then(function(e){e&&e.CurrentWorkloadSettingsSubLinks&&e.CurrentWorkloadSettingsSubLinks.length>0&&t.Settings.SetWorkloadSettingsLinks(e.CurrentWorkloadSettingsSubLinks)}).catch(function(e){y.e.logData({name:"SuiteNavProvider.UpdateWorkloadSettingsLinksError"})})};t.prototype.trySetDataAfterInitialRender=function(e,t){var n=this,i=this._dataSource.getSuiteNavContext();if(i&&i.isConsumer){if(!p.t.isActivated("0461c2e7-c91a-4038-b591-09477f3f84a6","09/27/2021","Extra SuiteNav configuration for Consumer")&&e.NFD){i.helpNamespace&&e.NFD.UpdateHelpNamespace(i.helpNamespace);e.NFD.OnFeedbackMetadataRequested(function(e,t){return e=n._dataSource.setFeedbackMetadata(e,t)});this._addFeedbackButton(e)}this._logEngagementData({name:"SuiteNavProvider.SetDataNotNeededInConsumer"});return m.n.wrap(!0)}y.e.logData({name:"SuiteNavProvider.SetDataAfterInitialRender"});var s=t.actionContext,o=t.bundleLoader;return this.loadData().then(function(t){if(!t){y.e.logData({name:"SuiteNavProvider.NoSuiteNavData"});return!1}if(!e){y.e.logData({name:"SuiteNavProvider.NoO365Shell"});return!1}var i=h.n.isFeatureEnabled(T)&&!!e.NFD,u=i&&n._shouldAddFeedbackButton(e);if(u){var a=JSON.parse(t.ClientData);if(a.OCVFeedbackMAXEnabled){if(!p.t.isActivated("7897BF84-323B-4580-95D2-A14836FE65F6","09/15/2021","Stop modifying OCVFeedbackMAXEnabled")){a.OCVFeedbackMAXEnabled=!1;t.ClientData=JSON.stringify(a)}}else i=u=!1}try{e.SetData(t)}catch(e){y.e.logData({name:"SuiteNavProvider.SetDataFail"});b.e.instrumentPromise({name:"SuiteNav.RefreshCacheAfterInvalidShellData"},function(){return n.loadData(!0)});return!1}t.ActionsMap&&e.Navigation.OnLinkClick(function(e){var n=t.ActionsMap[e.Id];n&&(e.Cancel=!n(Object(r.__assign)(Object(r.__assign)({},e),s||{})))});e.OnHasMember("OnDataChanged",function(){e.OnDataChanged(function(){return b.e.instrumentPromise({name:"SuiteNav.RefreshCacheForShellDataChanged"},function(){return n.loadData(!0)}).done()})});if(i){e.NFD.OnFeedbackMetadataRequested(function(e,t){return e=n._dataSource.setFeedbackMetadata(e,t)});u&&n._addFeedbackButton(e)}o&&o.pageRenderingIsComplete();return!0},function(e){y.e.logData({name:"SuiteNavProvider.LoadDataError"});return!1})};t.prototype._getSuiteNavShell=function(e,t){var n=this;this._loadModel().then(function(r){if(!n._cssLoaded&&r.cssUrl){g.e.loadStylesheet(r.cssUrl);n._dataSource.onCssLoad&&n._dataSource.onCssLoad(r);n._cssLoaded=!0}y.e.logData({name:"SuiteNavProvider.GetO365ShellByS2S"});n._requestShellCore(r.jsUrl,t,C).then(function(t){e.complete(t)},function(t){n._modelPromise=void 0;if((t=Object(E.n)({error:t}))&&"LoadScriptError"===t.resultCode&&n._isDataFromCache){y.e.logData({name:"SuiteNavProvider.O365ShellCacheFailed"});n._clearCache();n._getSuiteNavShell(e)}else if(n._hasRetriedShell)e.error(t);else{n._hasRetriedShell=!0;n._cssLoaded=!1;y.e.logData({name:"SuiteNavProvider.O365ShellRetry"});n._getSuiteNavShell(e,!0)}})})};t.prototype._loadModel=function(e){var t=this;if(!e&&this._modelPromise)return this._modelPromise;var n,r,s=new i.e,o=this._capabilities.supportsCaching,u=this._dataSource,a=w.e.Failure,f=b.e.instrumentPromise({name:"SuiteNavProvider.LoadData"},function(){return new m.n(function(r,i){var s;!e&&o&&t._isCacheValid()&&(s=t._cache.getValue(t._cacheDataKey));if(s&&s.data){y.e.logData({name:"SuiteNavProvider.DataFromCache"});u.updateDataForCurrentPage&&(s.data=u.updateDataForCurrentPage(s.data));if(o&&t._isCacheOutdated()){y.e.logData({name:"SuiteNavProvider.RefreshCache"});u.loadData().then(function(e){t._updateCache(e)})}t._isDataFromCache=!0;r(s)}else{t._isDataFromCache=!1;e&&y.e.logData({name:"SuiteNavProvider.ForceUpdateData"});y.e.logData({name:"SuiteNavProvider.DataFromServer"});u.loadData().done(function(e){if(e)if(e.data){o&&!(function(e){var t=e&&e.data&&e.data.WorkloadLinks;return!!t&&t.some(function(e){return e&&!e.Url})})(e)&&t._updateCache(e);r(e)}else{n="NoModelData";i("Model with no data returned")}else{n="NoModel";i("No model returned")}},function(e){if(m.n.isCanceled(i)){n="Canceled";a=w.e.ExpectedFailure}else n="ServerLoadFailure";i(e)})}})},null,function(e){if(m.n.isCanceled(e)){a=w.e.ExpectedFailure;n="Canceled"}return{resultType:a,resultCode:n||"Other",error:e}});(r=Object(d.e)())?this._modelPromise=m.n.all({suiteNavModel:f,theme:r.loadThemeSlotsMap()}).then(function(e){var t=e.suiteNavModel,n=e.theme,r=t&&t.data,i=t&&t.hasCobranding,s=r&&r.UseSPOBehaviors,o=h.n.isFeatureEnabled(S),u=n&&n.suiteBarBackground;!(u&&r&&s)||i&&o||(r.ThemeColors=[u,n.primaryText,u,n.suiteBarText,n.suiteBarDisabledText,n.topBarBackground,n.topBarText,n.topBarHoverText,n.primaryBackground,n.themeLighterAlt,n.dialogBorder]);return t}):this._modelPromise=f;this._modelPromise.then(function(e){return s.complete(e)},function(e){return s.error(e)});return s.getPromise()};t.prototype._shouldAddFeedbackButton=function(e){var t=!1;if(h.n.isFeatureEnabled({ODB:v.r?-1246:1246,ODC:null,Fallback:!1})){var n=this._dataSource.getWebTemplateType?this._dataSource.getWebTemplateType():f.t.invalid,r=/\/_layouts\/15\/Lists.aspx$/i;t=p.t.isActivated("9BCCA26C-EC25-44FF-A395-2D6D04734F76","09/15/2021","More specific ODB check for Feedback button")?n!==f.t.mySiteHost&&n!==f.t.mySite&&n!==f.t.tenantAdmin||r.test(window.location.pathname):n!==f.t.mySiteHost&&!v.r&&n!==f.t.tenantAdmin||r.test(window.location.pathname)}return t};t.prototype._addFeedbackButton=function(e){var t;null===(t=e.Extensibility)||void 0===t||t.AddOrUpdateCustomHeaderButton({affordanceMenuItemText:u.e,ariaLabel:u.e,iconFontFamily:"FabricMDL2Icons",iconFontName:"",id:"GiveFeedbackButton",onShow:function(){var t;if(e.FlexPane){e.FlexPane.OpenFlexPaneForProvider("Feedback");c.e.raise(document.body,"resize",void 0,!0)}null===(t=e.Extensibility)||void 0===t||t.UpdateButtonState("GiveFeedbackButton",!0)},onHide:function(){var t;null===(t=e.FlexPane)||void 0===t||t.CloseFlexPaneForProvider("Feedback");c.e.raise(document.body,"resize",void 0,!0)}})};t.prototype._clearCache=function(){this._cache.remove(this._cacheDataKey);this._cache.remove(this._cacheThemeDataKey);this._cache.remove(this._cacheDateKey);this._cache.remove(this._cacheVersionKey);this._cache.remove(this._cacheSessionKey,o.e.session)};t.prototype._updateCache=function(e,t){this._cache.setValue(this._cacheDataKey,e);this._cache.setValue(this._cacheDateKey,new Date);this._cache.setValue(this._cacheVersionKey,this._cacheVersion);this._cache.setValue(this._cacheSessionKey,!0,o.e.session)};t.prototype._isCacheOutdated=function(){var e=this._cache.getValue(this._cacheSessionKey,o.e.session),t=Date.parse(this._cache.getValue(this._cacheDateKey));return s.e.hasStorageType(o.e.session)&&!e||Date.now()-t>=60*this._cacheRenew*60*1e3};return t})(E.e);function C(){var e=window._o365su;if(e&&e.b)for(var t=0,n=["ThrowOnNull","ThrowOnUndefined","ThrowOnNullOrUndefined","ThrowOnNullOrEmpty","ThrowOnNullOrEmptyArray"];t<n.length;t++){var r=n[t];k(e.b,r)}}function k(e,t){var n=e[t];"function"==typeof n&&(e[t]=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];try{return n.apply(this,e)}catch(e){a.e.logData({message:e&&e.message||"",stack:e&&e.stack||"",type:t})}})}},4306:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r="f726d58b-8913-43cb-99c3-9d155105fbc6"},4308:function(e,t,n){"use strict";var r;(function(e){e[e.specificPeople=0]="specificPeople";e[e.organization=1]="organization";e[e.anyone=2]="anyone";e[e.existing=3]="existing";e[e.specificPeopleFlex=4]="specificPeopleFlex";e[e.customLabeledSpecificPeople=5]="customLabeledSpecificPeople"})(r||(r={}));t.e=r},4309:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(3361),i=(function(){function e(e){this._dataSource=e.sharingDataSource||new r.e({getParentListId:e.getParentListId,pageContext:e.pageContext});this._itemProvider=e.itemProvider}e.prototype.getSharingInformation=function(e,t,n,r,i){return this._dataSource.getSharingInformation(e,t,n,r,i)};e.prototype.shareLink=function(e){var t=this;return this._dataSource.shareLink(e).then(function(n){t._invalidateItem(e.items[0]);return n})};e.prototype.unshareLink=function(e){var t=this;return this._dataSource.unshareLink(e).then(function(n){t._invalidateItem(e.item);return n})};e.prototype.updatePermissions2=function(e,t,n){var r=this;return this._dataSource.updatePermissions2(e,t,n).then(function(e){r._invalidateItem(t);return e})};e.prototype.updatePermissionsMultiple=function(e,t,n,r,i){var s=this;return this._dataSource.updatePermissionsMultiple(e,t,n,r,i).then(function(e){s._invalidateItem(t);return e})};e.prototype.getClientId=function(){return this._dataSource.getClientId()};e.prototype.parseRawSharingInformation=function(e){return this._dataSource.parseRawSharingInformation(e)};e.prototype.emailWithoutPermissioning=function(e,t,n,r){return this._dataSource.emailWithoutPermissioning(e,t,n,r).then(function(e){return e})};e.prototype.checkPermissions=function(e,t){return this._dataSource.checkPermissions(e,t)};e.prototype.share=function(e,t,n){return this._dataSource.share(e,t).then(function(e){return e})};e.prototype.setAddressBarLinkCapability=function(e,t){return this._dataSource.setAddressBarLinkCapability(e,t)};e.prototype._invalidateItem=function(e){this._itemProvider&&e&&e.parent&&e.parent.key&&this._itemProvider.invalidateItem(e.parent.key)};return e})()},4372:function(e,t,n){"use strict";n.d(t,"e",function(){return f});var r,i=n(0),s=n(69),o=n(477),u=n(366),a=n(772);(function(e){e.odbFirstRun="sharePointOneDriveBusinessFirstRun";e.filtersPaneFirstRun="sharePointFiltersPaneFirstRun";e.teamsTeachingBubble="sharePointTeamsTeachingBubble";e.librariesFirstRun="sharePointLibrariesFirstRun";e.listsFirstRun="sharePointListsFirstRun";e.modernDocSetsFirstRun="sharePointModernDocSetsFirstRun"})(r||(r={}));var f=(function(e){Object(i.__extends)(t,e);function t(t,n){var r=e.call(this,{dataSourceName:"UserInfo",id:"UserInfo"},n)||this,i=r._pageContext,s=n.itemUrlHelper||new u.e({},{pageContext:i});r.apiUrlHelper=n.apiUrlHelper||new a.e({},{pageContext:i,itemUrlHelper:s});r._additionalHeaders={"X-ClientType":"SharePointFirstRunUserFlag"};return r}t.prototype.getUserFlagValue=function(e){var t=this;if(!this._pageContext.userLoginName&&!this._pageContext.aadUserId)return s.n.resolve(!0);if(this._pageContext.isAnonymousGuestUser||this._pageContext.isEmailAuthenticationGuestUser||this._pageContext.isExternalGuestUser)return s.n.resolve(!0);var n={url:this._getApiUrl()+"&$select="+e,qosName:"GetUserFlag",method:"GET",cacheRequestKey:e};return this.getDataUtilizingLegacyCache(Object(i.__assign)({onlyCache:!0,useStale:!0},n)).then(function(r){return r||t.getDataUtilizingLegacyCache(Object(i.__assign)(Object(i.__assign)({},n),{additionalHeaders:Object(i.__assign)({},t._additionalHeaders),parseResponse:function(t){var n=JSON.parse(t);if(n&&n.d&&void 0!==n.d[e])return!!n.d[e];throw new Error("Response did not contain flag: "+e)}}))}).catch(function(){return null})};t.prototype.setUserFlagValue=function(e,t){var n;return this.getDataUtilizingLegacyCache({url:this._getApiUrl(),qosName:"SetUserFlag",additionalPostData:JSON.stringify((n={},n[e]=t,n)),method:"POST",additionalHeaders:Object(i.__assign)({"X-HTTP-Method":"PATCH",Accept:"application/json; odata=minimalmetadata"},this._additionalHeaders),contentType:"application/json; odata=minimalmetadata",cacheRequestKey:e,bypassCache:!0,parseResponse:function(){return t}})};t.prototype._getApiUrl=function(){return this.apiUrlHelper.build().segment("SP.Directory.DirectorySession").methodWithAliases("User",this._pageContext.aadUserId?{id:this._pageContext.aadUserId}:{principalName:this._pageContext.userLoginName}).toString()};return t})(o.e)},4551:function(e,t,n){"use strict";n.d(t,"e",function(){return C});var r=n(0),i=n(4571),s=n(996),o=n(3860),u=n(477),a=n(69),f=n(18),l=n(59),c=n(58),h=n(2471),p=n(1092),d="Group('{0}')/{1}?$skip={2}&$top={3}&$inlinecount=allpages&$select=PrincipalName,Id,DisplayName,PictureUrl,UserType,Mail",v="Group('{0}')/Members/Add(objectId='{1}', principalName='{2}')",m="Group('{0}')/Owners/Add(objectId='{1}', principalName='{2}')",g=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,{dataSourceName:"GroupsDataSource",id:"GroupsDataSource"},{pageContext:t})||this;n._isTeamifyPromptHiddenCacheKey=t?"isTeamifyPromptHidden_"+(t.siteId+t.groupId):"isTeamifyPromptHidden";return n}t._copyMember=function(e){return{sip:e.alias,userId:e.id,email:e.mail,principalName:e.principalName,name:e.displayName,job:e.title,image:e.sharePointPictureUrl,profilePage:e.profilePage,entityType:e&&e.userType&&"guest"===e.userType?1:void 0}};t._parseUser=function(e){var n=JSON.parse(e);return t._copyMember(n.d)};t._copyMembers=function(e){var n=new o.e;n.members=e.map(function(e){return t._copyMember(e)});return n};t._parseGroup=function(e){var n=JSON.parse(e);return t._copyGroup(n.d)};t._parseMembership=function(e){var n=JSON.parse(e);return t._copyMembership(n.d)};t._copyGroup=function(e){return{description:e.description,alias:e.alias,name:e.displayName,principalName:e.principalName,creationTime:e.creationTime,pictureUrl:e.pictureUrl,inboxUrl:e.inboxUrl,calendarUrl:e.calendarUrl,filesUrl:e.documentsUrl,sharePointUrl:e.siteUrl,editUrl:e.editGroupUrl,membersUrl:e.peopleUrl,notebookUrl:e.notebookUrl,teamsUrl:e.teamsUrl,isPublic:e.isPublic,mail:e.mail,classification:e.classification,yammerResources:e.yammerResources,teamsResources:e.teamsResources,allowToAddGuests:e.allowToAddGuests,isDynamic:e.isDynamic,assignedLabels:e.assignedLabels,membership:t._copyMembership(e)}};t._copyMembership=function(e){return{totalNumberOfMembers:"string"==typeof e.__count?parseInt(e.__count,10):e.__count,membersList:e&&e.results?t._copyMembers(e.results):void 0}};t._parseOwnership=function(e){var n=JSON.parse(e);return t._copyOwnership(n.d)};t._copyOwnership=function(e){return{totalNumberOfOwners:"string"==typeof e.__count?parseInt(e.__count,10):e.__count,ownersList:e&&e.results?t._copyMembers(e.results):void 0}};t.prototype.getGroupBasicProperties=function(e){var n=this;return this.getData(function(){return n._getUrl(f.format("Group('{0}')?$select=PrincipalName,Id,DisplayName,Alias,Description,InboxUrl,CalendarUrl,DocumentsUrl,SiteUrl,EditGroupUrl,PictureUrl,PeopleUrl,NotebookUrl,Mail,IsPublic,CreationTime,Classification,yammerResources,teamsResources,allowToAddGuests,isDynamic,assignedLabels",e),"SP.Directory.DirectorySession")},function(r){var i=t._parseGroup(r);i.id||(i.id=e);n._calculateMissingGroupProperties(i,e);return i},"GetBasicProperties",void 0,"GET",void 0,void 0,3)};t.prototype.setGroupBasicProperties=function(e){var t=this;if(!e)return a.n.reject("Group parameter is null or undefined");return this.getData(function(){return t._getUrl(f.format("Group('{0}')",e.id),"SP.Directory.DirectorySession")},void 0,"SetBasicProperties",function(){var t={__metadata:{type:"SP.Directory.Group"}};e.name&&(t.displayName=e.name);e.description&&(t.description=e.description);if(e.assignedLabels){null!=e.isPublic&&(t.isPublic=e.isPublic);e.assignedLabels===c.e.Empty?t.assignedLabels="":t.assignedLabels=e.assignedLabels}else{null!=e.isPublic&&(t.isPublic=e.isPublic);e.classification&&(t.classification=e.classification)}return JSON.stringify(t)},"PATCH",void 0,void 0,3)};t.prototype.getGroupByAlias=function(e){var n=this;return this.getData(function(){return n._getUrl(f.format("Group(alias='{0}')",e),"SP.Directory.DirectorySession")},function(e){return t._parseGroup(e)},"GetGroupByAlias",void 0,"GET",void 0,void 0,0)};t.prototype.getGroupMembership=function(e,n,r,i){var s=this;void 0===r&&(r=!1);void 0===i&&(i=!1);var o=r?"100":"3";return this.getData(function(){return s._getUrl(f.format(d,e,"members","0",o),"SP.Directory.DirectorySession")},function(e){var r=t._parseMembership(e);s._calculateMissingMembershipProperties(r,n);return r},"GetMembership",void 0,"GET",void 0,void 0,3).then(function(t){return i?s._addOwnerInformation(e,n,t):a.n.resolve(t)})};t.prototype.getGroupMembershipPage=function(e,n,r,i){var s=this;return this.getData(function(){return s._getUrl(f.format(d,e,"members",r,i),"SP.Directory.DirectorySession")},function(e){var r=t._parseMembership(e);s._calculateMissingMembershipProperties(r,n);return r},"GetMembershipPage",void 0,"GET",void 0,void 0,3)};t.prototype.getGroupOwnership=function(e,n){var r=this,i=n||"100";return this.getData(function(){return r._getUrl(f.format(d,e,"owners","0",i),"SP.Directory.DirectorySession")},function(e){var n=t._parseOwnership(e);r._calculateMissingOwnershipProperties(n);return n},"GetOwnership",void 0,"GET",void 0,void 0,3)};t.prototype.getUserGroupsFromAAD=function(e){var t=this;return this.getData(function(){return t._getCsomUrl("ProcessQuery")},this._parseResponseForGetUserGroups.bind(this),"GetUserGroupsFromAAD",function(){return f.format('<Request xmlns="http://schemas.microsoft.com/sharepoint/clientquery/2009" SchemaVersion="15.0.0.0" LibraryVersion="16.0.0.0" ApplicationName="Javascript Library"><Actions><ObjectPath Id="4" ObjectPathId="3" /><Query Id="5" ObjectPathId="3"><Query SelectAllProperties="true"><Properties /></Query></Query></Actions><ObjectPaths><StaticMethod Id="3" Name="GetMyGroups" TypeId="{1e54feb9-52a0-49f7-b464-6b722cf86f94}"><Parameters><Parameter Type="String">{0}</Parameter><Parameter Type="Number">0</Parameter><Parameter Type="Number">100</Parameter></Parameters></StaticMethod></ObjectPaths></Request>',e.email)},"POST")};t.prototype.getUserGroups=function(e){var t=this,n=function(){return t.getUserGroupsFromAAD(e)};return this.getData(function(){return t._getUrl(f.format("User('{0}')/RankedMembership?$top=100&$select=DisplayName,DocumentsUrl,SharePointPictureUrl,PictureUrl,Id,IsFavorite",e.userId),"SP.Directory.DirectorySession")},this._parseResponseForGetUserGroups.bind(this),"GetUserGroups",void 0,"GET",void 0,void 0,0).then(function(e){return e&&e.length?e:n()},n)};t.prototype.addGroupMember=function(e,t,n,r){var i=this;t=t||c.e.Empty;n=n||"";return this.getData(function(){return i._getUrl(f.format(v,e,t,n),"SP.Directory.DirectorySession")},void 0,r||"AddMember",void 0,"POST",void 0,void 0,3)};t.prototype.addGroupOwner=function(e,t,n,r){var i=this;t=t||c.e.Empty;n=n||"";return this.getData(function(){return i._getUrl(f.format(m,e,t,n),"SP.Directory.DirectorySession")},void 0,r||"AddOwner",void 0,"POST",void 0,void 0,3)};t.prototype.removeGroupMember=function(e,t,n){var r=this;return this.getData(function(){return r._getUrl(f.format("Group('{0}')/Members/Remove('{1}')",e,t),"SP.Directory.DirectorySession")},void 0,n||"RemoveMember",void 0,"POST",void 0,void 0,3)};t.prototype.removeGroupOwner=function(e,t,n){var r=this;return this.getData(function(){return r._getUrl(f.format("Group('{0}')/Owners/Remove('{1}')",e,t),"SP.Directory.DirectorySession")},void 0,n||"RemoveOwner",void 0,"POST",void 0,void 0,3)};t.prototype.addUsersToGroup=function(e,t,n,i,s){var o=this,u=c.e.generate(),l="multipart/mixed; boundary=batch_"+u,p=[],d=[],g=0,y=0,b=function(t,n,r){for(var i=n?m:v,s=0;s<t.length;s++){var u=void 0,a=void 0;r?a=t[s]:u=t[s];if(u||a){u=u||c.e.Empty;a=a||"";var l=o._getUrl(f.format(i,e,u,a),"SP.Directory.DirectorySession");n?d.push(l):p.push(l)}}};if(t){b(t,!0,!1);g=t.length}else if(i){b(i,!0,!0);g=i.length}if(n){b(n,!1,!1);y=n.length}else if(s){b(s,!1,!0);y=s.length}if(!(d.length<1&&p.length<1)){var w=this.getData(function(){return h.e.getBatchOperationUrl(o._pageContext.webAbsoluteUrl)},function(e){return e},"AddUsersToGroup",function(){return h.e.getBatchContent(u,[d,p],"POST",h.e.defaultBatchRequestPostData)},"POST",void 0,l,void 0,void 0,void 0,function(e){var t=e.errorData,n=e.eventData;if(t){t.extraData={OwnersNumber:g,MembersNumber:y};return{eventData:Object(r.__assign)(Object(r.__assign)({},n),{resultCode:t.status.toString()})}}return{eventData:n}},void 0);return new a.n(function(e,t){w.then(function(n){var r=h.e.processBatchResponse(n);r.hasError?t(r):e(r)},function(e){t(e)})})}};t.prototype.addRemoveGroupUsers=function(e,t,n,i,s){var o=this,u=c.e.generate(),l="multipart/mixed; boundary=batch_"+u,p=[],d=[],g=[],y=[],b=function(t,n,r){var i="SP.Directory.DirectorySession";if(void 0!==t)for(var s=0;s<t.length;s++)if(n)if(r){var u=o._getUrl(f.format(m,e,t[s],""),i);p.push(u)}else{u=o._getUrl(f.format("Group('{0}')/Owners/Remove('{1}')",e,t[s]),i);g.push(u)}else if(r){u=o._getUrl(f.format(v,e,t[s],""),i);d.push(u)}else{u=o._getUrl(f.format("Group('{0}')/Members/Remove('{1}')",e,t[s]),i);y.push(u)}};b(t,!0,!0);b(i,!0,!1);b(n,!1,!0);b(s,!1,!1);if(0!==p.length||0!==d.length||0!==g.length||0!==y.length){var w=this.getData(function(){return h.e.getBatchOperationUrl(o._pageContext.webAbsoluteUrl)},function(e){return e},"AddRemoveGroupOwners",function(){return h.e.getBatchContent(u,[p,d,g,y],"POST",h.e.defaultBatchRequestPostData)},"POST",void 0,l,void 0,void 0,void 0,function(e){var t=e.errorData,n=e.eventData;if(t){t.extraData={OwnersToAdd:p.length,MembersToAdd:d.length,OwnersToRemove:g.length,MembersToRemove:y.length};return{eventData:Object(r.__assign)(Object(r.__assign)({},n),{resultCode:t.status.toString()})}}return{eventData:n}},void 0);return new a.n(function(e,t){w.then(function(n){var r=h.e.processBatchResponse(n);r.hasError?t(r):e(r)},function(e){t(e)})})}};t.prototype.getUserInfo=function(e){var n=this;return this.getData(function(){return n._getUrl(f.format("User(principalName='{0}')",l.e.encodeRestUriStringToken(e)),"SP.Directory.DirectorySession")},function(n){var r=t._parseUser(n);r.email=e;return r},"GetGraphUser",void 0,"GET",void 0,void 0,3)};t.prototype.deleteGroup=function(e){var t=this;if(!e)return a.n.reject("Group parameter is null or undefined");return this.getData(function(){return t._getUrl(f.format("Group('{0}')",e.id),"SP.Directory.DirectorySession")},void 0,"DeleteGroup",void 0,"DELETE",void 0,void 0,3)};t.prototype.deleteSite=function(e){var t=this;return this.getData(function(){return t._pageContext.siteAbsoluteUrl+f.format("/_api/GroupSiteManager/Delete?siteUrl='{0}'",e)},void 0,"DeleteSite",void 0,"POST",void 0,void 0,3)};t.prototype.teamify=function(){var e=this;return this.getData(function(){return e._pageContext.webAbsoluteUrl+"/_api/GroupSiteManager/EnsureTeamForGroup"},function(e){if(e){var t=JSON.parse(e);if(t&&t.d)return t.d.EnsureTeamForGroup}},"Groupify",function(){return""},"POST",void 0,void 0,0)};t.prototype.teamifyV2=function(e,t){var n=this;return this.getData(function(){return n._pageContext.webAbsoluteUrl+"/_api/GroupSiteManager/EnsureTeamForGroupEx"},function(e){if(e){var t=JSON.parse(e);if(t&&t.d)return t.d.EnsureTeamForGroupEx}},"TeamifyV2",function(){return""},"POST",void 0,void 0,0).then(function(r){t(r);return r&&r.teamsId?n._pinToTeam(r,e):void 0})};t.prototype.dismissTeamifyBanner=function(){var e=this;return this.getData(function(){return e._pageContext.siteAbsoluteUrl+f.format("/_api/GroupSiteManager/HideTeamifyPrompt?siteUrl='{0}'",e._pageContext.siteAbsoluteUrl)},function(e){return null},"DismissTeamifyBanner",function(){return""},"POST").then(function(){e.flushCache(e._isTeamifyPromptHiddenCacheKey);e.getTeamifyBannerHidden(!0)})};t.prototype.getTeamifyBannerHidden=function(e){var t=this;return this.getDataUtilizingPersistentCache({getUrl:function(){return t._pageContext.siteAbsoluteUrl+f.format("/_api/GroupSiteManager/IsTeamifyPromptHidden?siteUrl='{0}'",t._pageContext.siteAbsoluteUrl)},qosName:"TeamifyBannerHidden",parseResponse:function(e){var t=JSON.parse(e);return!(!t||!t.d)&&t.d.IsTeamifyPromptHidden},additionalPostData:"",method:"Get",cachingStrategy:e?3:0,cacheRequestKey:this._isTeamifyPromptHiddenCacheKey})};t.prototype._getUrl=function(e,t){return this._pageContext.webAbsoluteUrl+"/_api/"+t+"/"+e};t.prototype._getCsomUrl=function(e){return this._pageContext.webAbsoluteUrl+"/_vti_bin/client.svc/"+e};t.prototype._getGroupStatusNotebookUrl=function(e){return this._pageContext.webAbsoluteUrl+f.format("/_layouts/15/groupstatus.aspx?id={0}&target={1}",e,"notebook")};t.prototype._getGroupStatusFilesUrl=function(e){return this._pageContext.webAbsoluteUrl+f.format("/_layouts/15/groupstatus.aspx?id={0}&target={1}",e,"documents")};t.prototype._addOwnerInformation=function(e,t,n){return this.getGroupOwnership(e,"100").then(function(e){var r=e.ownersList.members,i=n.membersList.members,s=[],o={};r.forEach(function(e){o[e.userId]=!0;e.principalName.toLowerCase()===t.toLowerCase()&&(n.isOwner=!0)});var u=0,f={};i.forEach(function(e){if(o[e.userId]){e.isOwnerOfCurrentGroup=!0;s.push(e);u++;f[e.userId]=!0}else s.push(e);e.principalName===t&&(n.isMember=!0)});u<r.length&&r.forEach(function(e){if(!f[e.userId]){e.isOwnerOfCurrentGroup=!0;s.push(e)}});n.membersList.members=s;n.totalNumberOfMembers<s.length&&(n.totalNumberOfMembers=s.length);n.totalNumberOfOwners=e.totalNumberOfOwners;return a.n.resolve(n)})};t.prototype._fixUserImages=function(e){!e.image&&e.email&&(e.image=Object(p.getUserPhotoUrl)(e.email));!e.profilePage&&e.email&&(e.profilePage=f.format("/_layouts/15/me.aspx?p={0}&v=profile&origin=ProfileODB",e.email))};t.prototype._calculateMissingMembershipProperties=function(e,t){var n=this;e.membersList.members.forEach(function(e){n._fixUserImages(e)})};t.prototype._calculateMissingOwnershipProperties=function(e){var t=this;e.ownersList.members.forEach(function(e){t._fixUserImages(e)})};t.prototype._calculateMissingGroupProperties=function(e,t){e.creationTime||(e.creationTime=Date.now());e.pictureUrl&&(e.pictureUrl=e.pictureUrl.replace("EWS/Exchange.asmx/s/GetUserPhoto","OWA/service.svc/s/GetPersonaPhoto"));!e.notebookUrl&&t&&(e.notebookUrl=this._getGroupStatusNotebookUrl(t));!e.filesUrl&&t&&(e.filesUrl=this._getGroupStatusFilesUrl(t))};t.prototype._parseResponseForGetUserGroups=function(e){var t=this,n=JSON.parse(e);if(n.constructor===Array)return n[4].GroupsList.map(function(e){return{filesUrl:e.DocumentsUrl,name:e.DisplayName,id:e.Id}});var r=n.d.results.map(function(e){var n={filesUrl:e.documentsUrl,name:e.displayName,id:e.id,pictureUrl:e.pictureUrl,isFavorite:e.isFavorite};t._calculateMissingGroupProperties(n,n.id);return n}),i=r.filter(function(e){return e.isFavorite});i.push.apply(i,r.filter(function(e){return!e.isFavorite}));return i};t.prototype._pinToTeam=function(e,t){var n=this;t=t.map(function(e){return{displayName:e.displayName,isDefault:e.isDefault,url:e.url,itemType:e.itemType}});return this.getData(function(){return n._pageContext.siteAbsoluteUrl+"/_api/GroupSiteManager/PinToTeam"},function(t){if(t){var n=JSON.parse(t);if(n&&n.d)return{pinToTeam:n.d.PinToTeam,teamsInfo:e}}},"PinToTeam",function(){if(n._pageContext&&n._pageContext.navigationInfo&&n._pageContext.navigationInfo.quickLaunch){var r={requestParams:{__metadata:{type:"Microsoft.SharePoint.Portal.PinToTeamParams"},teamsId:e.teamsId,tabs:{__metadata:{type:"Collection(Microsoft.SharePoint.Portal.M365TabItem)"},results:t}}};return JSON.stringify(r)}},"POST",void 0,void 0,0)};return t})(u.t),y=(function(){function e(e,t,n,r,i){this._groupsProvider=e;this._parentGroup=t;this._loadPageFromServerDelegate=n;this._pageSize=r&&"number"==typeof r.pageSize?r.pageSize:20;this._shouldAddOwnershipInformation=!r||(r.ownershipInformation,!1)||r.ownershipInformation;this._userLoginName=i;this._foundOwnersDictionary={};this._numberOfOwnersFound=0}e.prototype.loadPage=function(e){var t=this,n=e||0;if(this._groupsProvider&&this._parentGroup.id){return this._loadPageFromServerDelegate(this._parentGroup.id,n,this._pageSize).then(function(e){return t._processPage(e,n)},function(e){t.error=e;return a.n.reject(e)})}return a.n.reject(void 0)};e.prototype._processPage=function(e,t){var n=this;this.totalNumberOfMembers=e.totalNumberOfMembers;var r=t+this._pageSize>=this.totalNumberOfMembers,i=r?void 0:this._computeGetNextPagePromise(t+this._pageSize);if(this._shouldAddOwnershipInformation){if(this._ownersDictionary){this._addOwnershipInformationToPage(e,r);return a.n.resolve({page:e.membersList.members,getNextPagePromise:i})}return this._groupsProvider.loadOwnershipContainerFromServer(this._parentGroup.id).then(function(t){n._addOwnershipInformationToPage(e,r,t);return a.n.resolve({page:e.membersList.members,getNextPagePromise:i})})}return a.n.resolve({page:e.membersList.members,getNextPagePromise:i})};e.prototype._addOwnershipInformationToPage=function(e,t,n){var r=this;if(n){this.totalNumberOfOwners=n.totalNumberOfOwners;this._ownersDictionary={};n.ownersList.members.forEach(function(e){e.userId&&(r._ownersDictionary[e.userId]=e)});this.isOwner=n.ownersList.containsUserByPrincipalName(this._userLoginName)}e.membersList.members.forEach(function(e){e.isOwnerOfCurrentGroup=r._ownersDictionary&&!!r._ownersDictionary[e.userId];if(e.isOwnerOfCurrentGroup){r._numberOfOwnersFound++;r._foundOwnersDictionary[e.userId]=!0}});if(t&&this._ownersDictionary&&this._numberOfOwnersFound<this.totalNumberOfOwners)for(var i in this._ownersDictionary){var s=this._ownersDictionary[i];if(!this._foundOwnersDictionary[s.userId]){s.isOwnerOfCurrentGroup=!0;e.membersList.members.push(s);this.totalNumberOfMembers++}}};e.prototype._computeGetNextPagePromise=function(e){var t=this;return function(){return t.loadPage(e)}};return e})(),b=n(83),w=n(95),E=n(291),S=n(1777),x=n(163),T=n(84),N=n(67),C=(function(){function e(e){this._missingLoginNameError="Missing user login name information.";this._pageContext=e.pageContext;this._dataRequestor=new E.t({qosName:"GroupsProvider"},{pageContext:e.pageContext});this._dataSource=e.dataSource||new g(e.pageContext);var t=function(e){return e.name?Object(r.__assign)(Object(r.__assign)({},e),{name:"GroupsProvider.PersistentCache."+e.name}):e};this._persistentCache=new S.e({secret:void 0,cacheType:1,telemetry:{engagement:x.e.withData(t),qos:T.e.withData(t)}});this._userLoginName=e.pageContext&&e.pageContext.userLoginName;this._groups=[];this._eventGroup=new w.t(this);this.switchCurrentGroup(e.groupId||e.pageContext&&e.pageContext.groupId)}e.prototype.dispose=function(){if(this._eventGroup){this._eventGroup.dispose();this._eventGroup=void 0}};e.prototype.getSPPageContext=function(){return this._pageContext};e.prototype.getMembershipPager=function(e){var t=this;return new y(this,this.group,function(e,n,r){return e?t._userLoginName?t._dataSource.getGroupMembershipPage(e,t._userLoginName,n,r):a.n.reject(t._missingLoginNameError):a.n.reject("Missing group id.")},e,this._userLoginName)};e.prototype.loadGroupInfoFromCache=function(e){return e?a.n.resolve(this._persistentCache.read({key:e}).then(function(e){return e.data})):a.n.resolve(void 0)};e.prototype.saveGroupToCache=function(e){if(e)return a.n.resolve(this._persistentCache.update({key:e.id},e))};e.prototype.saveMembershipToCache=function(e,t){var n=this;return this.loadGroupInfoFromCache(e).then(function(e){if(e){e.membership={isMember:t.isMember,totalNumberOfMembers:t.totalNumberOfMembers,totalNumberOfOwners:t.totalNumberOfOwners,membersList:t.membersList,isOwner:t.isOwner,isJoinPending:t.isJoinPending,lastLoadTimeStampFromServer:t.lastLoadTimeStampFromServer};return n.saveGroupToCache(e)}})};e.prototype.loadGroupInfoContainerFromServer=function(e){var t=this;return e?this._dataSource.getGroupBasicProperties(e).then(function(e){t._performBasicPropertiesPostProcessing(e);Object(b.s)(t._pageContext)&&t.doesCachedGroupPropertiesDiffer(e)&&t.syncGroupProperties();return e}):a.n.reject("Missing group id.")};e.prototype.loadMembershipContainerFromServer=function(e,t,n){void 0===t&&(t=!1);void 0===n&&(n=!1);return e?this._userLoginName?this._dataSource.getGroupMembership(e,this._userLoginName,t,n):a.n.reject(this._missingLoginNameError):a.n.reject("Missing group id.")};e.prototype.loadOwnershipContainerFromServer=function(e,t){return e?this._dataSource.getGroupOwnership(e,t):a.n.reject("Missing group id.")};e.prototype.loadUserGroups=function(e){var t=this;return this.loadUserGroupsFromCache(e).then(function(n){return n&&0!==n.length?a.n.resolve(n):t.getCurrentUser().then(function(n){return e?t._dataSource.getUserGroupsFromAAD(n).then(function(e){t._persistentCache.update({key:"UserGroupsFromAAD"+n.userId},e);return e}):t._dataSource.getUserGroups(n).then(function(e){t._persistentCache.update({key:"UserGroups"+n.userId},e);t._setUsersGroups(e,s.e.Server);return e})})})};e.prototype.loadUserGroupsFromCache=function(e){var t=this;return this.getCurrentUser().then(function(n){return(e?a.n.resolve(t._persistentCache.read({key:"UserGroupsFromAAD"+n.userId}).then(function(e){return e.data})):a.n.resolve(t._persistentCache.read({key:"UserGroups"+n.userId}).then(function(e){return e.data}))).then(function(n){n&&!e&&t._setUsersGroups(n,s.e.Cache);return n})})};e.prototype.isUserInGroup=function(e){return this.loadUserGroups(!0).then(function(t){for(var n=0,r=t.length;n<r;n++)if(t[n].id===e)return!0;return!1})};e.prototype.getGroup=function(e,t){var n=this;void 0===t&&(t=!1);if(e)throw new Error("NotImplemented: Calling getGroup() on groupsProvider supplying a groupId is not yet implemented.");if(t||e&&0!==e.length&&(!this.group||e!==this.group.id)){e&&0!==e.length||(e=this.group.id);return this.loadGroupInfoContainerFromServer(e)}return new a.n(function(e,t){var r=n.group;n.group?r.source===s.e.None?n._eventGroup.on(r,i.t.onSourceChange,function(i){i!==s.e.Error?i===s.e.None||e(r):t(n.group.error)}):e(r):t("There is no group currently being managed by GroupsProvider.")})};e.prototype.getCurrentUser=function(){var e=this;return this._userLoginName?this.currentUser?a.n.resolve(this.currentUser):this._getUserFromCache("CurrentUser").then(function(t){e.currentUser=t;return t||e._dataSource.getUserInfo(e._userLoginName).then(function(t){e._saveUserToCache(t,"CurrentUser");e.currentUser=t;return t})}):a.n.reject(this._missingLoginNameError)};e.prototype.addUserToGroupMembership=function(e,t,n,r){var i,s=this;return e?this._getUserIdForCacheClear(t,n).then(function(o){i=o;return s._dataSource.addGroupMember(e,t,n,r)}).then(function(){s._clearUserGroupsCache(i)}):a.n.reject("Missing group id.")};e.prototype.addUserToGroupOwnership=function(e,t,n,r){var i,s=this;return e?this._getUserIdForCacheClear(t,n).then(function(o){i=o;return s._dataSource.addGroupOwner(e,t,n,r)}).then(function(){s._clearUserGroupsCache(i)}):a.n.reject("Missing group id.")};e.prototype.removeUserFromGroupMembership=function(e,t,n){var r,i=this;return e?this._getUserIdForCacheClear(t).then(function(s){r=s;return i._dataSource.removeGroupMember(e,t,n)}).then(function(){i._clearUserGroupsCache(r)}):a.n.reject("Missing group id.")};e.prototype.removeUserFromGroupOwnership=function(e,t,n){var r,i=this;return e?this._getUserIdForCacheClear(t).then(function(s){r=s;return i._dataSource.removeGroupOwner(e,t,n)}).then(function(){i._clearUserGroupsCache(r)}):a.n.reject("Missing group id.")};e.prototype.addUsersToGroup=function(e,t,n,r,i){var s,o=this;if(!e)return a.n.reject("Missing group id.");if(this.currentUser){s=this.currentUser.userId;return this._dataSource.addUsersToGroup(e,t,n,r,i).then(function(e){o._clearUserGroupsCache(s);return e})}return this.getCurrentUser().then(function(e){s=e.userId}).then(function(){return o._dataSource.addUsersToGroup(e,t,n,r,i)}).then(function(e){o._clearUserGroupsCache(s);return e})};e.prototype.saveGroupProperties=function(e){return this._dataSource.setGroupBasicProperties(e)};e.prototype.switchCurrentGroup=function(e){var t=this.group?this.group.id:void 0;if(e&&e!==t){var n=this.getCachedGroup(e);n.load();this.group=n}};e.prototype.getCachedGroup=function(e,t){var n=this._groups[e];if(!n){n=new i.t(t,this,e,this._pageContext);this._groups[e]=n}return n};e.prototype.syncGroupProperties=function(){var e=this._pageContext.webAbsoluteUrl+"/_api/GroupService/SyncGroupProperties";return this._dataRequestor.getData({url:e,qosName:"SyncGroupProperties",method:"POST",noRedirect:!0})};e.prototype.setGroupImage=function(e){var t=this._pageContext.webAbsoluteUrl+"/_api/GroupService/SetGroupImage";return this._dataRequestor.getData({url:t,qosName:"SetGroupImage",method:"POST",noRedirect:!0,additionalPostData:e,contentType:e?e.type:"image/jpeg"})};e.prototype.doesCachedGroupPropertiesDiffer=function(e){var t,n,r=this._pageContext;return r.groupId===e.id&&(N.t.isActivated("844E10F7-8C05-45CD-982D-5C58380F9E17","08/09/2021","make sure labels exist before lowercasing")?r.webTitle!==e.name||(r.siteClassification||e.classification)&&r.siteClassification!==e.classification||(r.sensitivityLabel||e.assignedLabels)&&r.sensitivityLabel.toLocaleLowerCase()!==e.assignedLabels.toLocaleLowerCase()||null===r.groupType||void 0===r.groupType||"Public"===r.groupType!==e.isPublic||!r.isTeamsConnectedSite&&!!e.teamsUrl&&e.teamsUrl.length>0:r.webTitle!==e.name||(r.siteClassification||e.classification)&&r.siteClassification!==e.classification||(r.sensitivityLabel||e.assignedLabels)&&(null===(t=r.sensitivityLabel)||void 0===t?void 0:t.toLocaleLowerCase())!==(null===(n=e.assignedLabels)||void 0===n?void 0:n.toLocaleLowerCase())||null===r.groupType||void 0===r.groupType||"Public"===r.groupType!==e.isPublic||!r.isTeamsConnectedSite&&!!e.teamsUrl&&e.teamsUrl.length>0)};e.prototype.teamify=function(){return this._dataSource.teamify()};e.prototype.teamifyV2=function(e,t){return this._dataSource.teamifyV2(e,t)};e.prototype.hideTeamifyBanner=function(){var e=this._makeHideTeamifyKey();return a.n.resolve(this._persistentCache.update({key:e},{}))};e.prototype.dismissTeamifyBanner=function(){return this._dataSource.dismissTeamifyBanner()};e.prototype.getTeamifyBannerHidden=function(e){var t=this;return a.n.resolve(this._persistentCache.read({key:this._makeHideTeamifyKey()}).then(function(n){return!!n.data||t._dataSource.getTeamifyBannerHidden(e).catch(function(){return!1})}))};e.prototype.deleteGroup=function(e){return this._dataSource.deleteGroup(e)};e.prototype.deleteSite=function(e){return this._dataSource.deleteSite(e)};e.prototype._makeHideTeamifyKey=function(e){return"HideTeamify:"+(e||this._pageContext.siteId)};e.prototype._setUsersGroups=function(t,n){var r=this;this.userGroups=t.map(function(e){var t=r.getCachedGroup(e.id,e);n!==s.e.Server&&t.source===s.e.Server||t.extend(e);t.pictureUrl||t.load();return t});this._eventGroup.raise(e.onUserGroupsChange,this.userGroups)};e.prototype._performBasicPropertiesPostProcessing=function(e){if(this._pageContext){e.hasPictureUrl=!!e.pictureUrl;e.pictureUrl=this._pageContext.webAbsoluteUrl+"/_api/GroupService/GetGroupImage";e.inboxUrl=this._getWorkloadUrl(e,"inboxUrl","conversations","Yammer.FeedURL");e.calendarUrl=this._getWorkloadUrl(e,"calendarUrl","CALENDAR",null);e.membersUrl=this._getWorkloadUrl(e,"membersUrl","members",null);e.teamsUrl=this._getWorkloadUrl(e,"teamsUrl",null,"MicrosoftTeams.TeamHomeURL")}};e.prototype._getWorkloadUrl=function(e,t,n,r){var i=null,s=e.yammerResources,o=e.teamsResources,u=function(e){var t=e.filter(function(e){return e.Key===r});return t&&t[0]?t[0].Value:null};"MicrosoftTeams.TeamHomeURL"===r?o&&o.results&&o.results.length>0&&(i=u(o.results)):s&&s.results&&s.results.length>0?"Yammer.FeedURL"===r&&(i=u(s.results)):i=e[t]?e[t]:this._pageContext.webAbsoluteUrl+"/_layouts/15/groupstatus.aspx?id="+e.id+"&target="+n;return i};e.prototype._saveUserToCache=function(e,t){if(e)return this._persistentCache.update({key:t},e)};e.prototype._getUserFromCache=function(e){return a.n.resolve(this._persistentCache.read({key:e}).then(function(e){return e.data}).catch(function(){}))};e.prototype._clearUserGroupsCache=function(e){if(e)return a.n.all([this._persistentCache.remove({key:"UserGroupsFromAAD"+e}),this._persistentCache.remove({key:"UserGroups"+e})]).then(function(e){})};e.prototype._getUserIdForCacheClear=function(e,t){var n;if(this.currentUser&&e){n=e===this.currentUser.userId?e:null;return a.n.resolve(n)}return this.getCurrentUser().then(function(r){return n=e?e===r.userId?r.userId:null:t===r.principalName?r.userId:null})};e.onUserGroupsChange="userGroups";return e})();t.t=C},4563:function(e,t,n){"use strict";n.d(t,"e",function(){return w});var r=n(0),i=n(69),s=n(178),o=n(2378),u=n(387),a=n(58),f=n(59),l=n(162),c=n(535),h=n(67),p=n(2077),d=n(2430),v=n(95),m=n(271),g=(function(){function e(){var e=this.scope=new m.e;this._events=e.attach(new v.t(this))}e.prototype.start=function(){};e.prototype.abort=function(){};e.prototype.dispose=function(){this.scope.dispose()};e.prototype.updateState=function(e){if(e!==this.state){this.state=e;this._events.raise("upload_state_change",e)}};return e})(),y=new o.e(3),b=!h.t.isActivated("72E63389-0C1B-4876-8C80-5F244AD63320","10/15/2020","Restrict retries on streaming uploads"),w=(function(e){Object(r.__extends)(t,e);function t(t){var n=this,r=t.fileUpload;(n=e.call(this)||this)._fileUpload=r;n._authToken=t.authToken;n._uploadId=null;n._chunkNumber=0;n._streamingChunkNumber=0;n._currentChunkSize=8388608;n._currentStreamingChunkSize=262144e3;n._onProgress=t.onProgress;n._dataRequestor=t.dataRequestor;n._async=n.scope.attach(new s.e(n));n.totalBytes=r.size;n.uploadedBytes=0;n.fileName=r.name;n.iconName=t.iconName;n.state=0;n.error=null;n.nameConflictBehavior=0;n.allowRename=!1;n.supportsVersioning=!0;n._expandAllItemFields=t.expandAllItemFields;n._uniqueId=t.uniqueId;n._parentItemKey=t.parentItemKey;n._targetItemKey=t.targetItemKey;n._serverRelativeItemUrl=t.serverRelativeItemUrl;n._webApiUrl=t.webApiUrl;return n}t.prototype.start=function(){var e=this;this.updateState(0);var t=y.enqueue(function(){e.error=void 0;e.updateState(1);return e._upload().then(function(){e.updateState(2)},function(t){var n;n=t instanceof d.e?t:new d.e({message:t&&t.message||"",errorType:p.e.general});e.error=n;e.updateState(4);return i.n.reject(t)})});this._uploadPromise=t;return t};t.prototype.abort=function(){var e=this;if(2!==this.state){this.error=null;this.updateState(3);var t=this._uploadPromise;this._uploadPromise=void 0;if(t){t.cancel();t.then(function(){},function(){}).done(function(){return e._cancelChunkUpload()})}}};t.prototype.restart=function(){var e,t=this,n=this._uploadPromise;this._uploadPromise=void 0;if(n){n.cancel();e=n.catch(function(){return t._cancelChunkUpload().catch(function(){})})}else e=i.n.resolve();e.done(function(){t.start()})};t.prototype._upload=function(){var e,t=this;this.uploadedBytes=0;var n=this._fileUpload.size;if(n<=25165824)e=this._sendSingleRequestUpload();else{this._maxUploadRequestDuration=15e4;e=this._sendStreamingUpload()}return e.then(function(e){t.uploadedBytes=n;t.item=e})};t.prototype._createUploadError=function(e){var t,n,r,i;if("string"==typeof e)r=String(e);else{t=this._getErrorCode(e);n=e.status;r="string"==typeof e.message?String(e.message):e.message.value}switch(t){case-2130575257:i=p.e.conflict;break;case-1:i=p.e.disconnected;break;case-2130575245:i=p.e.invalidName;break;case-2130246326:i=p.e.versionMismatch;break;case-2147023080:case-2130575282:i=p.e.overQuota;break;default:switch(n){case 401:i=p.e.authFailure;break;case 404:i=p.e.targetFolderMissing;break;case 403:case 429:i=p.e.accessDenied;break;case 409:i=p.e.conflict;break;case 412:i=p.e.versionMismatch;break;case 415:i=p.e.emptyFileOrFolder;break;case 423:i=p.e.lockMismatch;break;case 507:i=p.e.overQuota;break;default:r?i||(i=p.e.other):i=p.e.general}}return new d.e({message:r,errorType:i,allowRename:this.allowRename,supportsVersioning:this.supportsVersioning})};t.prototype._getErrorCode=function(e){var t=e.code;return(void 0===t?"":t).split(",").map(function(e){return Number(e)})[0]};t.prototype._getUploadFileUrl=function(){var e=this._uniqueId,t=this._serverRelativeItemUrl,n=this._webApiUrl;n=e?n.method("GetFolderById",e):E(n,{serverRelativeItemUrl:t,isFolder:!0});var r=this._fileUpload.name,i=1===this.nameConflictBehavior;n=n.segment("Files").methodWithAliases("AddUsingPath",{DecodedUrl:r,overwrite:i,AutoCheckoutOnInvalidData:!0});var s="ListItemAllFields";this._expandAllItemFields&&(s+="/ContentType/Fields");s&&(n=n.oDataParameter("$Expand",s));return n.toString()};t.prototype._isConflictFile=function(){var e=this;if(1===this.nameConflictBehavior)return i.n.resolve(!1);var t=this._serverRelativeItemUrl,n=this._webApiUrl;n=(n=E(n,{serverRelativeItemUrl:t,isFolder:!0})).segment("Files").oDataParameter("$filter","Name eq '"+f.e.encodeRestUriStringToken(this._fileUpload.name)+"'");return this._dataRequestor.getData({noRedirect:!0,url:n.toString(),qosName:"SingleFileUploader.GetFile",authToken:this._authToken,parseResponse:function(t){var n=JSON.parse(t);return!!(n&&n.d&&n.d.results&&n.d.results.length>0)&&!(n.d.results[0].Exists&&e._streamingChunkNumber>0)}}).then(function(e){return e},function(e){return!!i.n.isCanceled(e)&&i.n.reject(e)})};t.prototype._processUploadCompleteResponse=function(e){return this._getItemFromResponse(e)};t.prototype._getItemFromResponse=function(e){var t;try{var n=JSON.parse(e).d,r=this._targetItemKey,i=void 0;n.ListItemAllFields&&n.ListItemAllFields.Id&&(i=String(n.ListItemAllFields.Id));var s=!1;if(n.ListItemAllFields&&n.ListItemAllFields.ContentType&&n.ListItemAllFields.ContentType.Fields&&n.ListItemAllFields.ContentType.Fields.results){var o=n.ListItemAllFields.ContentType.Fields.results.filter(function(e){return e.Required});if(o.length>0)for(var u=0,f=o;u<f.length;u++){var h=f[u];if(!n.ListItemAllFields[h.InternalName]){s=!0;break}}}var p=void 0;n.UniqueId&&(p=a.e.normalizeLower(n.UniqueId));var d=n.Name,v=c.t(d);t={key:r,parentKey:this._parentItemKey,type:l.t.File,id:n.ServerRelativeUrl,name:d,displayName:d,extension:v,properties:{ID:i,uniqueId:p},itemFromServer:n,hasMissingMetadata:s}}catch(e){}return t};t.prototype._generateChunkPostUrl=function(e,t){var n,i=this._fileUpload,s=this._uniqueId,o=i.size<=t,u=this._serverRelativeItemUrl,a=this._webApiUrl,f={uploadId:{guid:this._uploadId}};if(0===this._chunkNumber&&0===this._streamingChunkNumber){n="StartUpload";a=(a=s?a.method("GetFolderById",s):E(a,{serverRelativeItemUrl:u,isFolder:!0})).segment("Files");a=1===this.nameConflictBehavior?a.methodWithAliases("GetByPathOrAddStub",{DecodedUrl:i.name}):a.methodWithAliases("AddStubUsingPath",{DecodedUrl:i.name})}else{n=o?"FinishUpload":"ContinueUpload";a=E(a,{serverRelativeItemUrl:u+"/"+i.name,isFolder:!1});f=Object(r.__assign)(Object(r.__assign)({},f),{fileOffset:e})}return(a=a.methodWithAliases(n,f)).toString()};t.prototype._getUploadStatus=function(){var e=this._fileUpload,t=this._uploadId,n=this._serverRelativeItemUrl,r=this._webApiUrl;r=r.methodWithAliases("GetFileByServerRelativePath",{DecodedUrl:n+"/"+e.name}).methodWithAliases("GetUploadStatus",{uploadId:{guid:t}});return this._dataRequestor.getData({noRedirect:!0,url:r.toString(),authToken:this._authToken,qosName:"SingleFileUploader.GetUploadStatus",method:"GET"}).then(function(e){if(e.d&&e.d.ExpectedContentRange){return parseInt(e.d.ExpectedContentRange.split("-")[0],10)}return i.n.reject(new Error("No expected range from server response."))})};t.prototype._uploadFragment=function(e,t){var n=this;void 0===e&&(e=0);void 0===t&&(t=3);var r=this._fileUpload.size,s=Math.min(this._currentChunkSize+e,r);this._uploadId||(this._uploadId=a.e.generate());var o=Date.now();return this._sendFileData({url:this._generateChunkPostUrl(e,s),qosName:"SingleFileUploader.SendFileRequest",data:this._fileUpload.slice(e,s),offset:e,length:s-e}).then(function(e){n.uploadedBytes=s;if(s<r){n._chunkNumber++;Date.now()-o<6e4&&(n._currentChunkSize=Math.min(Math.floor(n._currentChunkSize*Math.pow(2,1/4)),62914560));return n._uploadFragment(s)}return n._processUploadCompleteResponse(e)},function(r){if(i.n.isCanceled(r))return i.n.reject(r);if(-2===n._getErrorCode(r)){if(n._currentChunkSize>262144){n._currentChunkSize=Math.max(Math.floor(n._currentChunkSize/2),262144);var s=void 0;0===n._chunkNumber&&(s=n._cancelChunkUpload());return i.n.resolve(s).then(function(){return n._uploadFragment(e)})}}else if(t>0&&n._canRetry(r)){var o,a=new u.e(function(){o&&n._async.clearTimeout(o)});o=n._async.setTimeout(function(){return a.complete()},1e3);return a.getPromise().then(function(){return n._uploadFragment(e,t-1)})}return i.n.reject(n._createUploadError(r))})};t.prototype._sendSingleRequestUpload=function(){var e=this;return this._isConflictFile().then(function(t){if(t){var n=new d.e({message:"",errorType:p.e.conflict});return i.n.reject(n)}return e._fileUpload.slice(0,e._fileUpload.size)}).then(function(t){return e._sendFileData({url:e._getUploadFileUrl(),qosName:"SingleFileUploader.UploadFile",data:t,offset:0,length:t.size}).then(function(t){return e._processUploadCompleteResponse(t)}).then(function(e){return e},function(t){if(i.n.isCanceled(t))return i.n.reject(t);if(-2===e._getErrorCode(t)){e.nameConflictBehavior=1;return e._uploadFragment()}return i.n.reject(e._createUploadError(t))})})};t.prototype._sendStreamingUpload=function(e,t){var n=this;void 0===e&&(e=0);void 0===t&&(t=3);this._uploadId||(this._uploadId=a.e.generate());var r=this._fileUpload.size,s=this._streamingChunkNumber>0?Math.min(this._currentStreamingChunkSize+e,r):0;return this._isConflictFile().then(function(t){if(t){var r=new d.e({message:"",errorType:p.e.conflict});return i.n.reject(r)}return n._fileUpload.slice(e,s)}).then(function(o){return n._sendFileData({url:n._generateChunkPostUrl(e,s),qosName:"SingleFileUploader.SendFileRequest",data:o,offset:e,length:o.size}).then(function(e){n.uploadedBytes=s;if(s<r){n._streamingChunkNumber++;return n._sendStreamingUpload(s,t)}return n._processUploadCompleteResponse(e)},function(r){if(i.n.isCanceled(r))return i.n.reject(r);if(-2===n._getErrorCode(r)){if(n._currentStreamingChunkSize<=1048576)return i.n.reject(n._createUploadError(r));n._currentStreamingChunkSize=n._currentStreamingChunkSize/2;return n._sendStreamingUpload(e,t)}return n._getUploadStatus().then(function(e){return n._sendStreamingUpload(e,b?t-1:3)},function(e){if(t>0&&n._canRetry(r)){var s,o=new u.e(function(){s&&n._async.clearTimeout(s)});s=n._async.setTimeout(function(){return o.complete()},1e3);return o.getPromise().then(function(){return n._sendStreamingUpload(0,t-1)})}return i.n.reject(n._createUploadError(r))})})})};t.prototype._canRetry=function(e){var t;switch(this._getErrorCode(e)){case-2130575257:case-2130575142:t=!1;break;default:t=!0}return t};t.prototype._cancelChunkUpload=function(){var e=this._uploadId;this._uploadId=void 0;this._chunkNumber=0;if(e){var t=this._fileUpload,n=this._serverRelativeItemUrl,r=this._webApiUrl;r=(r=E(r,{serverRelativeItemUrl:n+"/"+t.name,isFolder:!1})).methodWithAliases("CancelUpload",{uploadId:{guid:e}});return this._dataRequestor.getData({noRedirect:!0,url:r.toString(),authToken:this._authToken,qosName:"SingleFileUploader.CancelUploadSession"}).then(function(){})}return i.n.resolve()};t.prototype._sendFileData=function(e){var t,n,r,i=this,s=e.url,o=e.qosName,a=e.data,f=e.offset,l=e.length,c=new u.e(function(){t.cancel()}),h=function(e){var t=i._chunkNumber>0&&f+l>=i._fileUpload.size?3e5:1e4,r=Math.max(.08*e,t);n&&i._async.clearTimeout(n);e&&(n=i._async.setTimeout(function(){c.error({code:"-1",message:""})},r))},p=Date.now(),d=Date.now(),v=0,m=0,g=0,y=this._async.debounce(function(e){if(e>i.uploadedBytes){i.uploadedBytes=e;i._onProgress&&i._onProgress(e)}},100,{leading:!1});t=this._dataRequestor.getData({url:s,noRedirect:!0,authToken:this._authToken,qosName:o,parseResponse:function(e){return e},contentType:"application/octet-stream",additionalPostData:a,onUploadProgress:function(e){if(e.lengthComputable){var t=Date.now();m+=(e.loaded-v)/(t-d);g++;r=e.loaded/(t-p);d=t;v=e.loaded;y(f+e.loaded);h(l-e.loaded)}}});h(l);var b=this._async.setInterval(function(){if(g){Date.now()-p+(l-v)/((m+r)/(g+1))>i._maxUploadRequestDuration&&v<l&&c.error({code:"-2",message:""})}},1e4);t.done(function(e){c.complete(e)},function(e){c.error(e)});c.getPromise().done(function(){n&&i._async.clearTimeout(n);b&&i._async.clearInterval(b)},function(){t.cancel();n&&i._async.clearTimeout(n);b&&i._async.clearInterval(b)});return c.getPromise()};return t})(g);function E(e,t){var n=t.serverRelativeItemUrl,r=t.isFolder;return e=e.methodWithAliases(r?"GetFolderByServerRelativePath":"GetFileByServerRelativePath",{DecodedUrl:n})}},4571:function(e,t,n){"use strict";n.d(t,"n",function(){return h});n.d(t,"e",function(){return p});var r,i=n(3860),s=n(996),o=n(69),u=n(95),a=n(67);(function(e){e[e.none=0]="none";e[e.allMembers=1]="allMembers";e[e.ownershipInformation=2]="ownershipInformation";e[e.forceSkipCache=4]="forceSkipCache"})(r||(r={}));var f=(function(){function e(e,t,n){this._eventGroup=new u.t(this);this.source=s.e.None;this.lastLoadTimeStampFromServer=-1;this._groupsProvider=t;this._parent=n;e&&this.extend(e,s.e.None);this.membersList||(this.membersList=new i.e)}e.prototype.dispose=function(){if(this._eventGroup){this._eventGroup.dispose();this._eventGroup=void 0}this._parent=void 0};e.prototype.load=function(e,t){var n=this;void 0===e&&(e=!1);void 0===t&&(t=!1);if(this._groupsProvider&&this._parent.id){var i=0;e&&(i|=r.allMembers);t&&(i|=r.ownershipInformation);var u=o.n.resolve();!a.t.isActivated("bba1fa08-50a5-47de-90d2-df830b96a2ac","07/23/2021","Handle FF private mode for membership")&&h()||this.source!==s.e.None||i||(u=this._groupsProvider.loadGroupInfoFromCache(this._parent.id).then(function(e){e&&e.membership&&e.membership.lastLoadTimeStampFromServer>0&&n.extend(e.membership,s.e.Cache)}));return u.then(function(){if(n._shouldLoadNewData(i)){n._startLoadingFromServer(i);return n._groupsProvider.loadMembershipContainerFromServer(n._parent.id,e,t).then(function(e){n.extend(e,s.e.Server);n._finishLoadingFromServer();if(!i){e.lastLoadTimeStampFromServer=n.lastLoadTimeStampFromServer;n._groupsProvider.saveMembershipToCache(n._parent.id,e)}},function(e){n._errorLoading(e)})}})}return o.n.resolve()};e.prototype.loadWithOptions=function(e){var t=this;if(this._groupsProvider&&this._parent.id){this.source!==s.e.None||e||this._groupsProvider.loadGroupInfoFromCache(this._parent.id).then(function(e){e&&e.membership&&e.membership.lastLoadTimeStampFromServer>0&&t.extend(e.membership,s.e.Cache)});if(this._shouldLoadNewData(e)){this._startLoadingFromServer(e);return this._groupsProvider.loadMembershipContainerFromServer(this._parent.id,e&&(e&r.allMembers)===r.allMembers,e&&(e&r.ownershipInformation)===r.ownershipInformation).then(function(n){t.extend(n,s.e.Server);t._finishLoadingFromServer();if(!e||e===r.forceSkipCache){n.lastLoadTimeStampFromServer=t.lastLoadTimeStampFromServer;t._groupsProvider.saveMembershipToCache(t._parent.id,n)}},function(e){t._errorLoading(e)})}}return o.n.resolve(void 0)};e.prototype.extend=function(t,n){this.isMember=t.isMember;this.isOwner=t.isOwner;this.isJoinPending=t.isJoinPending;this.membersList=t.membersList;this.totalNumberOfMembers=t.totalNumberOfMembers;this.totalNumberOfOwners=t.totalNumberOfOwners;this.lastLoadTimeStampFromServer=t.lastLoadTimeStampFromServer;this._parent.membership=this;this.source=n;this._eventGroup.raise(e.onSourceChange,this.source)};e.prototype._shouldLoadNewData=function(e){return!this.isLoadingFromServer&&this.source!==s.e.Server&&(this.lastLoadTimeStampFromServer<0||Date.now()-this.lastLoadTimeStampFromServer>864e5)||e&&(e&r.forceSkipCache)===r.forceSkipCache||e&&(e&r.allMembers)===r.allMembers&&!(this._currentLoadOptions&&(this._currentLoadOptions&r.allMembers)===r.allMembers)||e&&(e&r.ownershipInformation)===r.ownershipInformation&&!(this._currentLoadOptions&&(this._currentLoadOptions&r.ownershipInformation)===r.ownershipInformation)};e.prototype._startLoadingFromServer=function(e){this.isLoadingFromServer=!0;this._currentLoadOptions=e};e.prototype._finishLoadingFromServer=function(){this.isLoadingFromServer=!1;this._currentLoadOptions=void 0;this.lastLoadTimeStampFromServer=Date.now()};e.prototype._errorLoading=function(e){this.isLoadingFromServer=!1;this._currentLoadOptions=void 0;this.error=e};e.onSourceChange="source";return e})(),l=n(18),c=n(88);function h(){var e,t;if(a.t.isActivated("c1acc2b3-5bdc-4d0f-b35a-9a6a69576691","06/24/2021","Handle FF private mode"))return!1;var n=new c.e,r=!1;if(window.indexedDB&&n.isFirefox)try{var i=window.indexedDB.open("FF_INPRIVATE");i.onerror=function(){return r=!0};"InvalidStateError"===(null===(t=null===(e=i)||void 0===e?void 0:e.error)||void 0===t?void 0:t.name)&&(r=!0)}catch(e){r=!0}return r}var p=(function(){function e(t,n,r,i){this._eventGroup=new u.t(this);this.source=s.e.None;this.lastLoadTimeStampFromServer=-1;this._groupsProvider=n;this.id=r;t?this.extend(t):this.load();this.membership=new f(void 0,this._groupsProvider,this);!i&&n&&(i=n.getSPPageContext());this.plannerUrl=e._getPlannerUrl(i,r)}e._getPlannerUrl=function(e,t){if(e){t||(t=e.groupId);return e.webAbsoluteUrl+l.format("/_layouts/15/groupstatus.aspx?id={0}&target={1}",t,"planner")}};e.prototype.dispose=function(){if(this._eventGroup){this._eventGroup.dispose();this._eventGroup=void 0}};e.prototype.load=function(t){var n=this;if(this._groupsProvider&&this.id){var r=o.n.resolve();this.source!==s.e.None||h()||(r=this._groupsProvider.loadGroupInfoFromCache(this.id).then(function(t){if(t&&t.lastLoadTimeStampFromServer>0){n.extend(t);n.source=s.e.Cache;n._eventGroup.raise(e.onSourceChange,n.source)}}));return r.then(function(){if(n._shouldLoadNewData(t)){n._startLoadingFromServer();return n._groupsProvider.loadGroupInfoContainerFromServer(n.id).then(function(e){e.lastLoadTimeStampFromServer=Date.now();n.extend(e);n._finishLoadingFromServer();n._groupsProvider.saveGroupToCache(e)},function(e){n._errorLoading(e)})}})}return o.n.resolve()};e.prototype.extend=function(e){this.name=e.name;this.principalName=e.principalName;this.alias=e.alias;this.mail=e.mail;this.description=e.description;this.creationTime=e.creationTime;this.profileUrl=e.profileUrl;this.inboxUrl=e.inboxUrl;this.calendarUrl=e.calendarUrl;this.filesUrl=e.filesUrl;this.notebookUrl=e.notebookUrl;this.pictureUrl=e.pictureUrl;this.hasPictureUrl=e.hasPictureUrl;this.sharePointUrl=e.sharePointUrl;this.editUrl=e.editUrl;this.membersUrl=e.membersUrl;this.teamsUrl=e.teamsUrl;this.isPublic=e.isPublic;this.classification=e.classification;this.assignedLabels=e.assignedLabels;this.allowToAddGuests=e.allowToAddGuests;this.isDynamic=e.isDynamic;this.yammerResources=e.yammerResources;this.teamsResources=e.teamsResources;this.lastLoadTimeStampFromServer=e.lastLoadTimeStampFromServer};e.prototype._shouldLoadNewData=function(e){return!this.isLoadingFromServer&&(e||this.source!==s.e.Server&&(!this.lastLoadTimeStampFromServer||Date.now()-this.lastLoadTimeStampFromServer>864e5))};e.prototype._startLoadingFromServer=function(){this.isLoadingFromServer=!0};e.prototype._finishLoadingFromServer=function(){this.isLoadingFromServer=!1;this.source=s.e.Server;this._eventGroup.raise(e.onSourceChange,this.source)};e.prototype._errorLoading=function(t){this.isLoadingFromServer=!1;this.error=t;this._eventGroup.raise(e.onSourceChange,s.e.Error)};e.onSourceChange="source";return e})();t.t=p},4624:function(e,t,n){"use strict";n.d(t,"e",function(){return o});var r=n(4254),i=n(1664),s=n(69),o=(function(){function e(e){this._context=e;this._dataSource=new r.e(this._context);this._siteHeaderLogoAcronymDataSource=new i.t(this._context)}e.prototype.getAssociatedPermissionGroups=function(){return this._dataSource.associatedPermissionGroups()};e.prototype.getHubSitePermissionGroups=function(){return this._dataSource.hubSitePermissionGroups()};e.prototype.getSiteGroupsAndUsersWithPermissions=function(e){var t=this,n=[];if(e){var r=[];for(var i in e){var o=this._getSiteGroupAndUsersById(e[i],i,n);r.push(o)}return s.n.all(r).then(function(){return t._fixUsersImage(n)})}return s.n.resolve(void 0)};e.prototype.getSiteGroupsAndUsers=function(e){return this._dataSource.getSiteGroupsAndUsers(e)};e.prototype.getRoleAssignments=function(){return this._dataSource.getRoleAssignments().catch(function(e){})};e.prototype._fixUsersImage=function(e){var t=[];if(e&&e.length>0){e.forEach(function(e){e.users&&e.users.length>0&&e.users.forEach(function(e){e.urlImage||t.push(e)})});if(t&&t.length>0)return this._siteHeaderLogoAcronymDataSource.getAcronyms(t.map(function(e){return e.title})).then(function(n){if(n&&n.length>0)for(var r=0;r<n.length;r++){t[r].imageInitials=n[r].acronym;t[r].initialsColor=i.t.decodeAcronymColor(n[r].color)}return e},function(){return e})}return s.n.resolve(e)};e.prototype._getSiteGroupAndUsersById=function(e,t,n){return this._dataSource.getSiteGroupAndUsersById(e.id).then(function(r){r.roleType=e.roleType;r.users&&r.users.length>0&&r.users.forEach(function(e){e.roleType=r.roleType});n[t]=r}).catch(function(r){if(403!==r.status)throw r;e.currentUserCannotViewMembers=!0;n[t]=e})};return e})()},4625:function(e,t,n){"use strict";n.r(t);n.d(t,"UserExpirationProvider",function(){return r});var r=(function(){function e(e){this._dataSource=e.dataSource}e.prototype.getUsersWithExpirations=function(e,t,n,r,i){return this._dataSource.getUsersWithExpirations(e,t,n,r,i)};e.prototype.getUsersWithExpirationsWithCache=function(e,t,n,r,i,s){return this._dataSource.getUsersWithExpirationsWithCache(e,t,n,r,i,s)};e.prototype.setUserExpiration=function(e,t){return this._dataSource.setUserExpiration(e,t)};e.prototype.expireUser=function(e){return this._dataSource.expireUser(e)};e.prototype.getExternalUserExpirationPolicy=function(){return this._dataSource.getExternalUserExpirationPolicy()};return e})();t.default=r},4626:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=(function(){function e(e){this._dataSource=e.dataSource}e.prototype.getPendingAccessRequests=function(e,t,n,r){return this._dataSource.getPendingAccessRequests(e,t,n,r)};e.prototype.changeRequestStatus=function(e,t){return this._dataSource.changeRequestStatus(e,t)};e.prototype.hasAccessRequests=function(){return this._dataSource.hasAccessRequests()};return e})()},4627:function(e,t,n){"use strict";n.d(t,"e",function(){return l});var r=n(291),i=n(69),s=n(83),o=n(58),u=n(2471),a=1073741830,f=1073741826,l=(function(){function e(e){this._pageContext=e.pageContext;this._urlBeginning=Object(s.n)(e.pageContext);this._getPendingAccessRequestsUrl=this._urlBeginning+"/_api/web/AccessRequestsList/GetItems";this._getChangeRequestStatusUrl=this._urlBeginning+"/_api/SP.AccessRequests.ChangeRequestStatus";this._getIfPendingAccessRequestsUrl=this._urlBeginning+"/_api/SP.Web.GetObjectSharingSettings?$expand=ObjectSharingInformation";this._dataRequestor=new r.t({pageContext:e.pageContext})}e.prototype.changeRequestStatus=function(e,t){var n=this;if(!e||e.length<1)return i.n.reject([!1]);if(e.length>1){var r=o.e.generate(),s="multipart/mixed; boundary=batch_"+r,l=[],c=[],h=[];e.forEach(function(e){h.push(n._getChangeRequestStatusUrl);var r=e.isWeb?"SharePoint Group":"Role Definition",i=e.isWeb?e.groupId:e.isEditor?a:f;l.push(JSON.stringify({itemId:e.id,newStatus:t,convStr:null,permType:r,permissionLevel:i}));c.push("POST")});return this._dataRequestor.getData({url:u.t.getBatchOperationUrl(this._pageContext.webAbsoluteUrl),parseResponse:function(e){return e},qosName:"acceptDenyAccessRequests",additionalPostData:u.t.getBatchContentExtended(r,h,"POST",u.t.defaultBatchRequestPostData,l,u.t.defaultBatchAcceptData,c),method:"POST",contentType:s,noRedirect:!0,needsRequestDigest:!0}).then(function(e){var t=u.t.processBatchResponse(e);return t.hasError?i.n.reject(t):t}).then(function(e){return e.items.map(function(){return!0})},function(e){return e.items.map(function(e){return!e.error})})}var p=this._getChangeRequestStatusUrl,d=e[0].isWeb?"SharePoint Group":"Role Definition",v=e[0].isWeb?e[0].groupId:e[0].isEditor?a:f,m={itemId:e[0].id,newStatus:t,convStr:null,permType:d,permissionLevel:v};return this._dataRequestor.getData({url:p,parseResponse:function(e){return[!e]},qosName:"acceptDenyAccessRequests",additionalPostData:JSON.stringify(m),method:"POST",noRedirect:!0,needsRequestDigest:!0})};e.prototype.getPendingAccessRequests=function(e,t,n,r){var i=this,s=[];n&&s.push("$top="+n);r&&s.push("$skip="+r);s.push("$select=ID,RequestedForDisplayName,RequestDate,ObjectRequestedTitleDisp,RequestedObjectUrl,RequestedForUserId,RequestedFor,Conversation,RequestedWebId,RequestedListId,RequestedListItemId");var u=this._getPendingAccessRequestsUrl;s.length>0&&(u+="?"+s.join("&"));var a={query:{__metadata:{type:"SP.CamlQuery"},ViewXml:"<View><Query><OrderBy><FieldRef Name='"+e+"' Ascending='"+(t?"FALSE":"TRUE")+"'/></OrderBy><Where><And><Eq><FieldRef Name='IsInvitation'></FieldRef><Value Type='Boolean'>0</Value></Eq><Eq><FieldRef Name='Status'></FieldRef><Value Type='Integer'>0</Value></Eq></And></Where></Query></View>"}};return this._dataRequestor.getData({url:u,method:"POST",additionalPostData:JSON.stringify(a),qosName:"getPendingAccessRequests",parseResponse:function(e){var t=JSON.parse(e);return t&&t.d&&t.d.results?t.d.results.map(function(e){return{id:e.ID,requesterDispName:e.RequestedForDisplayName,requestDate:new Date(e.RequestDate),item:e.ObjectRequestedTitleDisp,itemUrl:new URL(e.RequestedObjectUrl.Url),userLogin:i.getLogin(e.RequestedFor),userId:e.RequestedForUserId,isEditor:!0,isWeb:e.RequestedListItemId===o.e.Empty&&e.RequestedListId===o.e.Empty&&e.RequestedWebId!=o.e.Empty,comment:e.Conversation}}):e}})};e.prototype.hasAccessRequests=function(){var e=this._getIfPendingAccessRequestsUrl,t={objectUrl:this._pageContext.webAbsoluteUrl,useSimplifiedRoles:!0};return this._dataRequestor.getData({url:e,method:"POST",additionalPostData:JSON.stringify(t),qosName:"getIfPendingAccessRequests",parseResponse:function(e){var t=JSON.parse(e);return t&&t.d&&t.d.ObjectSharingInformation&&t.d.ObjectSharingInformation.HasPendingAccessRequests}})};e.prototype.getLogin=function(e){var t=e.lastIndexOf("|")+1;return e.substring(t)};return e})()},4629:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r;(function(e){e[e.Approve=1]="Approve";e[e.Decline=3]="Decline"})(r||(r={}))},4630:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=(function(){function e(){}e.readFile=function(e){if(!e)return Promise.resolve("");var t=new FileReader;return new Promise(function(n,r){t.onloadend=function(){return n(t.result)};t.onerror=function(e){return r(e.error)};t.readAsDataURL(e)})};return e})()},4631:function(e,t,n){"use strict";n.d(t,"e",function(){return u});var r=n(0),i=n(592),s=n(59),o=n(67).t.isActivated("f5ec737a-1970-45cb-b6c8-8526638856b0","10/28/2020","check for sync/notify new list creation capability"),u=(function(e){Object(r.__extends)(t,e);function t(t){return e.call(this,{dataSourceName:"ListCollectionDataSource"},{pageContext:t})||this}t.prototype.createList=function(t){var n=this,r=e.prototype.getData.call(this,function(){return s.e.escapeUrlForCallback(n._pageContext.webAbsoluteUrl)+"/_api/web/lists?&$expand=DefaultViewUrl"},function(e){return n._getSPList(e)},"CreateList",function(){return n._constructCreateListBody(t)});!o&&r&&this._pageContext&&this._pageContext.dataSyncClient&&this._pageContext.dataSyncClient.then(function(e){return e&&e.notifyNewListCreated()});return r};t.prototype.ensureSiteAssetsLibrary=function(){var t=this;return e.prototype.getData.call(this,function(){return s.e.escapeUrlForCallback(t._pageContext.webAbsoluteUrl)+"/_api/web/lists/ensureSiteAssetsLibrary()"},function(e){return t._getSPList(e)},"EnsureSiteAssetsLibrary")};t.prototype._constructCreateListBody=function(e){return JSON.stringify({__metadata:{type:"SP.List"},BaseTemplate:e.templateType,Description:e.description,Title:e.title,OnQuickLaunch:0!==e.quickLaunchOption})};t.prototype._getSPList=function(e){var t=JSON.parse(e);if(t&&t.d){var n=t.d;return{title:n.Title,description:n.Description,defaultViewUrl:n.DefaultViewUrl,baseTemplate:n.BaseTemplate,hidden:n.Hidden,id:n.Id}}};return t})(i.t)},4632:function(e,t,n){"use strict";n.d(t,"e",function(){return c});var r=n(0),i=n(1555),s=n(2244),o=n(67),u=n(84),a=n(44),f=n(18),l=n(244),c=(function(e){Object(r.__extends)(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;t._hasTranslations=!1;return t}t.prototype.onSave=function(e,t,n){var r=this._transformToEditableMenuState(e,t,n);return this.dataRequestor.getData({url:this._pageContext.webAbsoluteUrl+"/_api/navigation/SaveMenuState",qosExtraData:{alias:this._hasTranslations?"isMUIEditing":void 0,isFooterNodeTitle:!!n},qosName:"NavigationSaveMenuState",additionalPostData:r,method:"POST",additionalHeaders:{"ODATA-VERSION":"4.0",Accept:"*/*, application/json; odata.metadata=minimal"},contentType:"application/json; odata.metadata=minimal",maxRetries:1}).then(function(e){return 200===e.value}).catch(function(){return!1})};t.prototype.addLinkToQuickLaunch=function(e,t,n){void 0===n&&(n=!0);var r=new u.e({name:"addLinkToQuickLaunch"}),s={__metadata:{type:"SP.NavigationNode"},IsExternal:n,Title:e,Url:t};return this.dataRequestor.getData({url:this._pageContext.webAbsoluteUrl+"/_api/web/navigation/quicklaunch",parseResponse:function(e){var t=JSON.parse(e);if(t.d&&void 0!==t.d.Id){r.end({resultType:a.e.Success});return{key:String(t.d.Id),name:t.d.Title,url:t.d.Url,target:i.e.shouldLinkOpenInSameWindow(t.d.Url)?"":"_blank"}}r.end({resultType:a.e.Failure,error:"addLinkToQuickLaunch failed"});return null},qosName:"AddToQuickLaunch",additionalPostData:JSON.stringify(s),method:"POST"})};t.prototype.saveAudienceTargetSetting=function(e){var t=this;return this.dataRequestor.getData({url:this._pageContext.webAbsoluteUrl+"/_api/web",qosName:"saveNavAudienceTargetingEnabled",method:"POST",additionalHeaders:{"X-HTTP-Method":"MERGE"},additionalPostData:JSON.stringify({NavAudienceTargetingEnabled:e,__metadata:{type:"SP.Web"}})}).then(function(n){e?t._pageContext.webPropertyFlags2|=i.e.NAV_AUDIENCE_TARGET_FLAG:t._pageContext.webPropertyFlags2&=~i.e.NAV_AUDIENCE_TARGET_FLAG;return n})};t.prototype._transformToEditableMenuState=function(e,t,n){var r,i=new Date,s=f.format("{0}-{1}-{2}T{3}:{4}:{5}Z",i.getUTCFullYear(),i.getUTCMonth()+1,i.getUTCDate(),i.getUTCHours(),i.getUTCMinutes(),i.getUTCSeconds()),o=this._pageContext;r=n?{Version:s,StartingNodeKey:void 0,StartingNodeTitle:n,SPSitePrefix:t?o.siteServerRelativeUrl:"/",SPWebPrefix:o.webServerRelativeUrl,FriendlyUrlPrefix:"",SimpleUrl:"",Nodes:this._getEditableNodesFromLinks(e)}:{Version:s,StartingNodeKey:t?"1002":"1025",StartingNodeTitle:t?"SharePoint Top Navigation Bar":"Quick launch",SPSitePrefix:t?o.siteServerRelativeUrl:"/",SPWebPrefix:o.webServerRelativeUrl,FriendlyUrlPrefix:"",SimpleUrl:"",Nodes:this._getEditableNodesFromLinks(e)};return JSON.stringify({menuState:r,mapProviderName:this._mapProviderName})};t.prototype._getEditableNodesFromLinks=function(e){if(e&&!(e.length<=0)){for(var t=[],n=0,r=e;n<r.length;n++){var i=r[n];o.t.isActivated("1372e263-2892-46e2-b145-a6f3bd92077f","02/26/2021","mark MUIEditing flag")||!i.translatedTitles||this._hasTranslations||(this._hasTranslations=!0);(void 0===i.key||Number(i.key)>=0)&&t.push({NodeType:0,Key:i.key,Title:i.webDefaultTitle||i.name,SimpleUrl:i.url,FriendlyUrlSegment:"",IsDeleted:i.isDeleted,AudienceIds:i.audiences||void 0,Translations:i.translatedTitles?s.t.convertTranslationInputToSPResourceEntry(i.translatedTitles):void 0,OpenInNewWindow:this._isOpenInNewWindowFeatureEnabled?i.openInNewWindow:void 0,Nodes:this._getEditableNodesFromLinks(i.links)})}return t}};Object.defineProperty(t.prototype,"_isOpenInNewWindowFeatureEnabled",{get:function(){return l.e.isFeatureEnabled({ODB:60322})},enumerable:!0,configurable:!0});return t})(i.e)},4640:function(e,t,n){"use strict";var r;(function(e){e[e.share=1]="share";e[e.copy=2]="copy";e[e.atMention=3]="atMention";e[e.linkSettings=4]="linkSettings";e[e.manageAccess=5]="manageAccess";e[e.notify=6]="notify";e[e.addPeople=7]="addPeople"})(r||(r={}));t.e=r},4652:function(e,t,n){"use strict";var r=n(2079);n.d(t,"e",function(){return r})},4664:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r;(function(e){e[e.none=0]="none";e[e.view=1]="view";e[e.edit=2]="edit";e[e.owner=3]="owner";e[e.review=6]="review";e[e.restrictedview=7]="restrictedview";e[e.submit=8]="submit";e[e.manageList=9]="manageList"})(r||(r={}))},4672:function(e,t,n){"use strict";n.d(t,"e",function(){return d});var r=n(0),i=n(775),s=n(369),o=n(592),u=n(69),a=n(44),f=n(163),l=n(58),c=n(67),h=n(244),p={ODB:1201},d=(function(e){Object(r.__extends)(t,e);function t(t){return e.call(this,{dataSourceName:"ListItemDataSource"},{pageContext:t.pageContext})||this}t.prototype.getItem=function(t,n,r,i){var s=this;t.postDataContext.isOnePage=!!t.newTargetListUrl||!!t.isOnePageNavigation;var o=t.remoteItem&&h.e.isFeatureEnabled(p)?this._getRemoteItemPostData():this.getAdditionalPostData(t.postDataContext,n,t.pageSize);return e.prototype.getData.call(this,function(){return s.getUrl(n,t)},function(e,t){return s._parseResponse(e,r.qosEvent,t)},r.qosName,function(){return o},"POST",this._getListRequestHeaders(t,n),void 0,void 0,t.noRedirect,void 0,function(e){var t=s._telemetryHandler(e);i&&i(t.eventData);return t},void 0,t.authToken).then(function(e){return e},function(e){s._errorHandler(r.qosName,e);return u.n.reject(e)})};t.prototype.getUrl=function(e,t){var n,r=t&&t.postDataContext;n=h.e.isFeatureEnabled(p)?{webUrl:this._pageContext.webAbsoluteUrl,listId:t.remoteItem?t.remoteItem.ListId:e.listId,urlParts:t.remoteItem?{}:e.urlParts,searchTerm:e.searchTerm,rootFolder:t.remoteItem?void 0:e.folderPath,isOnePageNavigation:t.isOnePageNavigation,remoteWebUrl:t.remoteItem?t.remoteItem.SiteUrl:t.remoteWebUrl,uniqueId:t.remoteItem&&t.remoteItem.UniqueId}:{webUrl:this._pageContext.webAbsoluteUrl,listId:e.listId,urlParts:e.urlParts||{},searchTerm:e.searchTerm,rootFolder:e.folderPath,isOnePageNavigation:t.isOnePageNavigation};c.t.isActivated("03784CEA-7833-4740-8D6A-4EA05116664F","5/18/21","Set prefetch param")||(n.isPrefetchPageContext=e.listId&&!this._pageContext.listUrl);if(this._isSpecifiedItemRequest(e))n.viewId=e.viewIdForRequest;else{(!e.viewXmlForRequest||r&&r.isOnePage)&&e.viewIdForRequest!==l.e.Empty&&(n.view=e.viewIdForRequest);!n.view&&e.viewPathForRequest&&(n.viewPath=e.viewPathForRequest);t&&t.ignoreFilterParams||(n.filterParams=e.filterParams);if(e.sortField){n.sortField=e.sortField;n.sortDir="false"===e.isAscending?"Desc":"Asc"}r&&r.groupReplace?n.requestToken=this._isExpandingGroup(n)?void 0:e.requestToken:n.requestToken=e.group?void 0:e.requestToken;!this._isExpandingGroup(e)||r&&r.groupReplace||(n.groupString=e.group.groupString);r&&r.webId&&(n.webId=r.webId)}return i.t(n)};t.prototype.getAdditionalPostData=function(e,t,n){return s.e(e,t,n)};t.prototype.needsRequestDigest=function(e){return!!c.t.isActivated("4CE25DD5-0B47-4B9E-B6F9-5037A00C6CF8","04/21/2021","need Request Digest")||-1===e.toLowerCase().indexOf("/renderlistdataasstream?")};t.prototype._getRemoteItemPostData=function(){return JSON.stringify({parameters:{RenderOptions:7}})};t.prototype._getListRequestHeaders=function(e,t){var n=i.r(t,e.postDataContext);n["X-ServiceWorker-Strategy"]=e.skipServiceWorkerCache?"SkipCache":"CacheFirst";return n};t.prototype._isSpecifiedItemRequest=function(e){return e.itemIds&&e.itemIds.length>0};t.prototype._isExpandingGroup=function(e){return e.group&&"__next__"!==e.group.groupingId};t.prototype._parseResponse=function(e,t,n){var r=n.getServiceWorkerDataSourceHeader();try{if(void 0!==e)return this._getListItemResponse(e,r)}catch(n){if("{}"!==e.substring(0,2)){t.end({resultType:a.e.Failure,resultCode:"BadJSON"});throw n}return this._getListItemResponse(e.substring(2),r)}};t.prototype._getListItemResponse=function(e,t){var n;n=JSON.parse(e);"ServiceWorker-FromCache"===t&&(n.isFromServiceWorkerCache=!0);return n};t.prototype._telemetryHandler=function(e){var t=e.errorData,n=Object(r.__assign)({},e.eventData);if(t){var i=void 0,s=t.code?t.code:"";if(s.indexOf("2147024860")>-1)s="ListViewTreshold";else if(s.indexOf("2147024749")>-1)s="LookupColumnTreshold";else if(s.indexOf("2147024809")>-1&&s.indexOf("requestUrl")>-1)s="RequestURLFailure";else if(s.indexOf("2147024809")>-1&&s.indexOf("range")>-1)s="RangeError";else if(s.indexOf("2147024809")>-1&&s.indexOf("view")>-1)s="InvalidView";else if(s.indexOf("2130575340")>-1&&s.indexOf("field")>-1)s="FieldTypesNotInstalledProperly";else if(s.indexOf("2146232832")>-1){s="DefaultDoclibNotFound";if(500===t.status){i=!1;n.resultType=a.e.ExpectedFailure}}else if(s.indexOf("2147024895")>-1){s="PrefetchWebMismatch";if(500===t.status){i=!1;n.resultType=a.e.ExpectedFailure}}else s=n.resultCode;n.resultCode=s;return{canRetry:i,eventData:n}}return{eventData:n}};t.prototype._errorHandler=function(e,t){var n=t&&t.code?t.code:"";n.indexOf("2147024860")>-1?f.e.logData({name:e+".ListViewTreshold"}):n.indexOf("2147024749")>-1&&f.e.logData({name:e+".LookupColumnTreshold"})};return t})(o.t)},4690:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(0);function i(){return Object(r.__awaiter)(this,void 0,void 0,function(){return Object(r.__generator)(this,function(e){return[2]})})}},4695:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var r=n(0),i=n(69),s=n(1151),o=n(592),u={method:"GET",contentType:"application/json",additionalHeaders:{accept:"application/json"}},a=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,{dataSourceName:"GraphUserInfo"},n)||this;r._oAuthTokenProvider=n.oAuthTokenProvider;r._canUseGraph=r._pageContext.isSPO;r._requestCache=new s.e({id:"GraphUserInfo"},{pageContext:r._pageContext});return r}t.prototype.canUseTeams=function(){var e=this;return this._canUseGraph?this._requestCache.getDataUtilizingCache({cacheRequestKey:"CanUseTeams",getData:function(){return e._oAuthTokenProvider.getToken(e._pageContext.msGraphEndpointUrl).then(function(t){return e._canUseTeams(t)})}}).catch(function(){return null}):i.n.resolve(null)};t.prototype._canUseTeams=function(e){return this.dataRequestor.getData(Object(r.__assign)(Object(r.__assign)({url:this._pageContext.msGraphEndpointUrl+"/beta/me/licenseDetails",authToken:e,qosName:"CanUseTeams"},u),{parseResponse:function(e){return JSON.parse(e).value.some(function(e){for(var t=e.servicePlans||[],n=0;n<t.length;n++)if("57ff2da0-773e-42df-b2af-ffb7a2317929"===t[n].servicePlanId)return"Success"===t[n].provisioningStatus;return!1})}}))};return t})(o.e)},5020:function(e,t,n){"use strict";n.d(t,"e",function(){return h});var r=n(0),i=n(592),s=n(83),o=n(69),u=n(2471),a=n(58),f=n(18),l=n(2329),c=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,{dataSourceName:"SharingSiteDataSource"},{pageContext:t})||this,r=Object(s.n)(n._pageContext);n._getSharingSettingsUrl=r+"/_api/SP.Web.GetObjectSharingSettings?$expand=ObjectSharingInformation,SharePointSettings/PickerProperties";n._shareUrl=r+"/_api/SP.Web.ShareObject";n._getSiteSharingtSettingsUrl=r+"/_api/web?$select=MembersCanShare,TenantAdminMembersCanShare,RequestAccessEmail,UseAccessRequestDefault,AccessRequestSiteDescription,AssociatedOwnerGroup,AssociatedMemberGroup&$expand=AssociatedOwnerGroup,AssociatedMemberGroup,AssociatedMemberGroup/AllowMembersEditMembership";n._setSiteSharingSettingsUrl=r+"/_api/web";n._setUseAccessRequestDefaultUrl=r+"/_api/web/SetUseAccessRequestDefaultAndUpdate";n._setUseAccessRequestDescriptiontUrl=r+"/_api/web/SetAccessRequestSiteDescriptionAndUpdate";n._setGroupAllowMembersEditMembershipUrl=r+"/_api/web/SiteGroups({0})";return n}t.prototype.getSharingSettings=function(){var e=this;return this._getSharingSettingsRawResponse().then(function(t){return e._parseSettings(t)},function(t){return e._parseError(t)})};t.prototype.getSiteSharingSettings=function(){var e=this;return this.getData(function(){return e._getSiteSharingtSettingsUrl},function(e){return JSON.parse(e).d},"SP.Web.SiteSharingSettings",null,"GET",null,null,null,!0).then(function(t){var n={};n.membersCanShare=t.MembersCanShare;n.tenantAdminMembersCanShare=t.TenantAdminMembersCanShare;n.requestAccessEmail=t.RequestAccessEmail;n.useAccessRequestDefault=t.UseAccessRequestDefault;n.accessRequestSiteDescription=t.AccessRequestSiteDescription;n.ownersGroup=e.parseSPGroup(t.AssociatedOwnerGroup);n.membersGroup=e.parseSPGroup(t.AssociatedMemberGroup);return n},function(t){return e._parseError(t)})};t.prototype.setSiteSharingSettings=function(e){var t=this,n=a.e.generate(),r="multipart/mixed; boundary=batch_"+n,i=[],s=[],l=[];if(void 0!==e.membersCanShare||void 0!==e.requestAccessEmail){i.push(this._setSiteSharingSettingsUrl);l.push("MERGE");s.push(JSON.stringify({__metadata:{type:"SP.Web"},MembersCanShare:e.membersCanShare,RequestAccessEmail:e.requestAccessEmail}))}if(void 0!==e.useAccessRequestDefault){i.push(this._setUseAccessRequestDefaultUrl);l.push("POST");s.push(JSON.stringify({useAccessRequestDefault:e.useAccessRequestDefault}))}if(void 0!==e.accessRequestSiteDescription){i.push(this._setUseAccessRequestDescriptiontUrl);l.push("POST");s.push(JSON.stringify({description:e.accessRequestSiteDescription}))}if(e.membersGroup&&void 0!==e.defaultMembersGroupAddMembers){i.push(f.format(this._setGroupAllowMembersEditMembershipUrl,e.membersGroup.id));l.push("MERGE");s.push(JSON.stringify({__metadata:{type:"SP.Group"},AllowMembersEditMembership:e.defaultMembersGroupAddMembers}))}if(0!=i.length){var c=this.getData(function(){return u.e.getBatchOperationUrl(t._pageContext.webAbsoluteUrl)},function(e){return e},"SP.Web.SetSiteSharingSettings",function(){return u.e.getBatchContentExtended(n,i,"POST",u.e.defaultBatchRequestPostData,s,u.e.defaultBatchAcceptData,l)},"POST",null,r,void 0,void 0,void 0);return new o.n(function(e,t){c.then(function(n){var r=u.e.processBatchResponse(n);r.hasError?t(r):e(r)},function(e){t(e)})}).then(function(e){},function(e){return o.n.reject(e)})}};t.prototype.shareSite=function(e,n){var r=this;return this.getData(function(){return r._shareUrl},function(e){var r=JSON.parse(e).d,i=[];r.UniquelyPermissionedUsers&&r.UniquelyPermissionedUsers.results&&(i=r.UniquelyPermissionedUsers.results);var s=[];r.InvitedUsers&&r.InvitedUsers.results&&(s=r.InvitedUsers.results);var o={};o.statusCode=r.StatusCode;o.errorMessage=r.ErrorMessage;o.people=t._parsePeople(i,n.siteUrl);o.invitedUsers=t._parsePeople(s,n.siteUrl);return o},"ShareSite",function(){for(var t=[],r=0;r<e.length;r++){var i=e[r];t.push(i.rawPersonData)}n.roleValue===2..toString()?n.roleValue=l.e:n.roleValue===1..toString()?n.roleValue=l.r:n.roleValue===(0).toString()&&(n.roleValue=l.n);var s={url:n.siteUrl,peoplePickerInput:JSON.stringify(t),roleValue:n.roleValue,groupId:n.groupId,sendEmail:n.sendEmail,emailBody:n.message,emailSubject:n.subject,includeAnonymousLinkInEmail:!n.requireSignIn,propagateAcl:n.propagateSharing,useSimplifiedRoles:!0};return JSON.stringify(s)})};t.prototype._getSharingSettingsRawResponse=function(){var e=this,t={useSimplifiedRoles:!0};t.objectUrl=this._pageContext.webAbsoluteUrl;return this.getData(function(){return e._getSharingSettingsUrl},function(e){return JSON.parse(e).d},"SP.Web.GetObjectSharingSettings",function(){return JSON.stringify(t)},"POST",null,null,null,!0)};t._parsePeople=function(e,n){return e.map(function(e){var r={siteUrl:n,role:t._parseSharingRole(e.CurrentRole),statusCode:Number(!e.Status),errorMessage:e.Message||null};return{name:e.DisplayName,email:e.Email,userId:e.UserId,sharingInfo:r}})};t._parseSharingRole=function(e){switch(e){case 0:return 5;case 1:return 1;case 2:return 2;default:return 1}};t.prototype._parseError=function(e){var t={};t.sharingApiErrorMessage=e.message.value;return t};t.prototype._parseSettings=function(e){var t={};t.canSendEmail=e.canSendEmail;t.pickerProperties={};t.itemUrl=e.itemUrl;t.mailSettings={defaultCharacterLimit:500};t.itemId=e.ItemId;t.itemName=e.ItemName;t.canManagePermissions=e.ObjectSharingInformation.CanManagePermissions;t.canSendEmail=e.CanSendEmail;t.pickerProperties={};t.supportsSharingPropagation=e.SupportsAclPropagation;t.showAdditionalExternalWarning=e.ShowExternalSharingWarning;t.sharedWithMany=e.ObjectSharingInformation.IsSharedWithSecurityGroup||e.ObjectSharingInformation.IsSharedWithMany;t.blockPeoplePickerAndSharing=e.BlockPeoplePickerAndSharing;t.canCurrentUserShareExternally=e.CanCurrentUserShareExternally;e.SharePointSettings&&e.SharePointSettings.PickerProperties&&this._setPickerProperties(e.SharePointSettings.PickerProperties,e.SharePointSettings.PickerProperties.PrincipalAccountType,t);var n=[];if(e.SimplifiedRoles&&e.SimplifiedRoles.results)for(var r=0;r<e.SimplifiedRoles.results.length;r++){var i={};i.name=e.SimplifiedRoles.results[r].Key;i.value=e.SimplifiedRoles.results[r].Value;n.push(i)}t.sharingRoles=n;t.showAdvanced=t.canManagePermissions;return t};t.prototype.parseSPGroup=function(e){return{id:e.Id,loginName:e.LoginName,principalType:e.PrincipalType,title:e.Title,allowMembersEditMembership:e.AllowMembersEditMembership,description:e.Description}};t.prototype._setPickerProperties=function(e,t,n){n.pickerProperties=e;n.pickerProperties.PrincipalAccountType=this._convertPrincipalType(t)};t.prototype._convertPrincipalType=function(e){if(!e)return 0;for(var t=0,n=0,r=e.split(",");n<r.length;n++){var i=r[n];"User"===i?t|=1:"DL"===i?t|=2:"SecGroup"===i?t|=4:"SPGroup"===i&&(t|=8)}return t};return t})(i.t),h=(function(){function e(e){this._dataSource=e.sharingSiteDataSource||new c(e.pageContext)}e.prototype.getSharingSettings=function(){return this._dataSource.getSharingSettings()};e.prototype.shareSite=function(e,t){return this._dataSource.shareSite(e,t)};e.prototype.getSiteSharingSettings=function(){return this._dataSource.getSiteSharingSettings()};e.prototype.setSiteSharingSettings=function(e){return this._dataSource.setSiteSharingSettings(e)};return e})()},5033:function(e,t,n){"use strict";n.d(t,"e",function(){return l});var r=n(0),i=n(83),s=n(592),o=n(59),u=n(1030),a=(function(e){Object(r.__extends)(t,e);function t(t){return e.call(this,{dataSourceName:"ThemeManager"},{pageContext:t})||this}t.prototype.getThemingOptions=function(){var e=this,t=Object(i.n)(this._pageContext),n=this.getTenantThemeRestUrl(t);return this.getData(function(){return n+"GetTenantThemingOptions"},function(t){return e._processResponse(t,"GetTenantThemingOptions")},"GetTenantThemingOptions",null,"GET")};t.prototype.setTheme=function(e){var t={name:e.name,themeJson:JSON.stringify(e.theme)};return this._applyTheme(t)};t.prototype.clearTheme=function(){return this._applyTheme({name:"",themeJson:""}).then(function(e){return!0},function(e){return!1})};t.prototype._applyTheme=function(e){var t=Object(i.n)(this._pageContext),n=this.getTenantThemeRestUrl(t);return this.getData(function(){return n+"ApplyTheme"},function(e){var t=JSON.parse(e);return t.d&&t.d.ApplyTheme?t.d.ApplyTheme:""},"ApplyTheme",function(){return JSON.stringify(e)},"POST",null,null,null,!0,null,function(e){var t=e.errorData,n=e.eventData;return t?{eventData:Object(r.__assign)(Object(r.__assign)({},n),{resultCode:"error was thrown "+t.correlationId})}:{eventData:n}})};t.prototype._processResponse=function(e,t){var n=JSON.parse(e),i=[],s=!1;if(n&&n.d&&n.d[t]){var o=n.d[t];s=!!o.hideDefaultThemes;for(var a=0,f=o.themePreviews.results;a<f.length;a++){var l=f[a],c=void 0,h=void 0,p={name:l.name,theme:{backgroundImageUri:"",cacheToken:"",isDefault:!1,isInverted:!1,palette:{},version:""}};try{c=JSON.parse(l.themeJson);h=u.e.convertColorsToRgba(c.palette);p.theme=Object(r.__assign)(Object(r.__assign)({},c),{palette:h})}catch(e){p.error=!0}i.push(p)}}return{hideDefaultThemes:s,themes:i}};t.prototype.getTenantThemeRestUrl=function(e){var t=e&&e.replace(/\/$/,"")||"";return o.e.escapeUrlForCallback(t)+"/_api/ThemeManager/"};return t})(s.e),f=n(1029),l=(function(){function e(e){this._themeDataSource=e.tenantThemeDataSource?e.tenantThemeDataSource:new a(e.pageContext)}e.prototype.getTenantThemingOptions=function(){return this._themeDataSource.getThemingOptions()};e.prototype.setTheme=function(e){return this._themeDataSource.setTheme(e).then(function(t){t&&f.e.updateThemeCache(e.theme,t);return t})};e.prototype.clearTheme=function(){return this._themeDataSource.clearTheme()};return e})()}}]);