(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([["deferred.items-view"],Array(1542).concat([function(e,t,n){"use strict";n.d(t,"t",function(){return b});n.d(t,"e",function(){return w});var r=n(0),i=n("react-lib"),s=n(1440),o=n(2),u=n(72),a=n(679),f=n(13),l=n(22),c=n(627),h=n(32),p=n(1),d=(function(e){Object(r.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){return this.props.canOpenInOffice?i.createElement(l.e,null):i.createElement(c.t,null)};return t})(i.PureComponent);var v=Object(h.e)(function(e,t){var n=t.itemKey;return{canOpenInOffice:!!e.demandItem({appMap:p.at},n).appMap}})(d),m=Object(f.s)()(Object(f.r)()(v)),g=n(704),y=n(703),b={key:a.e.key,automationId:a.e.automationId,name:a.e.name,subMenuProps:{items:[y.e,g.e],contextualMenuItemAs:s.t},facets:Object(r.__assign)({},u.t.pack(!0))},w={key:new o.e("fallbackOpen").id,automationId:"fallbackOpen",name:a.e.name,action:i.createElement(m,null),facets:Object(r.__assign)({},u.t.pack(!0))}},,,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r=n(5),i=n(494),s=new r.e("spSharedByMePage",{itemSet:Object(r.o)(i.t),after:Object(r.s)()})},,,,,,,,,,,function(e,t,n){"use strict";n.r(t);n.d(t,"DropTargetHook",function(){return d});n.d(t,"DragSourceHook",function(){return v});n.d(t,"DragDropHook",function(){return b});var r=n(0),i=n("react-lib"),s=n(1281),o=n(1171),u=n(797),a=n(1428),f=n(4366),l=n(580),c=n(104),h=n(169),p=n(1412);var d=function(e){return i.createElement(s.e,null,i.createElement(o.e,Object(r.__assign)({},e)))};var v=function(e){var t=e.dragSourceKey,n=e.type,o=i.useState(),a=o[0],f=o[1],l=Object(h.e)(function(t){var n;e.hookCallback(t);f(null===(n=t.collectedProps)||void 0===n?void 0:n.isDragging)});return i.createElement(s.e,null,i.createElement(u.t,Object(r.__assign)({},e,{hookCallback:l})),e.showDefaultDragPreview||!a?null:i.createElement(u.e,{dragSourceKey:t,type:n},function(e){return i.createElement(y,{draggedItem:e.draggedItem,dropEffect:e.dropEffect})}))};function m(e){var t=e.resolve,n=Object(r.__rest)(e,["resolve"]);i.useEffect(function(){return function(){t()}},[]);return i.createElement(a.e,Object(r.__assign)({},n))}function g(e){var t,n,r=e.draggedItem,o=e.resolve;return i.createElement(s.e,null,i.createElement(u.e,{dragSourceKey:null===(t=r)||void 0===t?void 0:t.dragSourceKey,type:null===(n=r)||void 0===n?void 0:n.type,as:p.e,getItemStyles:p.n},function(e){return i.createElement(m,{draggedItem:e.draggedItem,dropEffect:e.dropEffect,resolve:o})}))}function y(e){var t=Object(l.i)({scope:"global"});i.useEffect(function(){if(e.draggedItem&&t){var n=new c.e,r=n.reject,s=n.resolve,o=n.promise,u=i.createElement(g,{draggedItem:e.draggedItem,reject:r,resolve:s});t.enqueue({content:u,promise:o,scope:"global"})}},[e.draggedItem]);return null}var b=i.memo(function(e){var t=e.dragDropKey,n=e.dragType,o=i.useState(),a=o[0],l=o[1],c=Object(h.e)(function(t){var n;e.hookCallback(t);l(null===(n=t.collectedDragProps)||void 0===n?void 0:n.isDragging)});return i.createElement(s.e,null,i.createElement(f.e,Object(r.__assign)({},e,{hookCallback:c})),e.showDefaultDragPreview||!a?null:i.createElement(u.e,{dragSourceKey:t,type:n},function(e){return i.createElement(y,{draggedItem:e.draggedItem,dropEffect:e.dropEffect})}))})}],Array(50),[function(e,t,n){"use strict";n.d(t,"e",function(){return m});n.d(t,"t",function(){return g});n.d(t,"n",function(){return y});n.d(t,"r",function(){return b});n.d(t,"i",function(){return w});n.d(t,"s",function(){return E});var r=n(0),i=n(332),s=n(2357),o=n(2612),u=n(621),a=n(501),f=n(534),l=n(268),c=n(1349),h=n(109),p=n(69),d=n(3491),v=n(232),m=Object(i.e)(function(e){var t=e(a.e),n=e(Object(l.e)({graphDataRequestorConfiguration:c.e,graphTokenProvider:d.e})),r=n.graphDataRequestorConfiguration,i=n.graphTokenProvider,o=r&&r.alwaysSendContentType,h=r&&r.cookieOrigin;return{dataRequestor:new s.e({alwaysSendContentType:o},{cookieOrigin:h,apiEvent:f.e.withManager(t),sessionManagementProvider:i,isOffline:function(){return new p.n(function(t,n){try{var r=e(Object(u.n)()),i=void 0!==window.navigator.onLine&&!window.navigator.onLine;t(r||i)}catch(e){n(e)}})}}),hasTokenProvider:!!i&&!!i.getSessionToken,cookieOrigin:h}});function g(e,t){return"&orderby=folder,"+e+" "+(t?"asc":"desc")}function y(e){var t=this,n=e.url,i=e.method,s=void 0===i?"GET":i,u=e.body,a=e.qosName,f=e.endpoint,c=e.headers,p=void 0===c?{}:c,d=e.timeout,g=e.expectedErrors,y=e.driveUrl,b=e.parseResponse,w=e.allowCookies,E=e.useMultiPartIfSupported,S=e.apiVersion;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,c,x,T,N,C,k,L,A,O,M,_;return Object(r.__generator)(this,function(D){switch(D.label){case 0:t=e(m),i=t.dataRequestor,c=t.hasTokenProvider,x=t.cookieOrigin;T=void 0!==typeof u?JSON.stringify(u):void 0;N=new v.e(n).authority;C=x&&N&&x===N;return c||w&&C?[3,2]:[4,e(Object(o.getSessionToken)(f,y))];case 1:k=D.sent();D.label=2;case 2:L=e(Object(l.e)({clientName:h.t,enableUseMultiPart:h.d,isClaimsPerSiteEnabled:h.E})),A=L.clientName,O=L.isClaimsPerSiteEnabled,M=L.enableUseMultiPart;_=void 0===M||M(f);return[4,i.send({path:n,endpoint:f,driveUrl:y,requestType:s,apiName:a,accessToken:k,useAuthorizationHeaders:!0,postData:T,headers:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},p),A?{"X-ClientService-ClientTag":A}:{}),O?{"x-ms-cc":"t"}:{}),useMultiPart:_?E:void 0,expectedErrors:g,allowCookies:w,timeout:d,parseResponse:b,apiVersion:S})];case 3:return[2,D.sent()]}})})}}function b(e){var t=this,n=e.url,i=e.method,s=void 0===i?"GET":i,o=e.body,a=e.qosName,f=e.timeout,l=e.endpoint,c=e.headers,h=e.expectedErrors,p=e.driveUrl,d=e.useMultiPartIfSupported,v=e.parseResponse,m=e.allowCookies;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,g,b,w,E,S,x;return Object(r.__generator)(this,function(r){switch(r.label){case 0:t=void 0!==typeof o?JSON.stringify(o):"";i=(function(e,t,n){var r=void 0!==n?n:"";return e+"__"+t+"__"+r})(n,s,t);g=e(Object(u.n)());b=void 0!==window.navigator.onLine&&!window.navigator.onLine;w=g||b;return[4,e(Object(u.t)(i))];case 1:E=r.sent();if(w&&E)return[2,E];S=y({url:n,method:s,body:o,qosName:a,endpoint:l,headers:c,expectedErrors:h,timeout:f,driveUrl:p,useMultiPartIfSupported:d,parseResponse:v,allowCookies:m});if(!E)return[3,2];e(S).then(function(t){e(Object(u.r)(i,t))});return[2,E];case 2:return[4,e(S)];case 3:x=r.sent();return[4,e(Object(u.r)(i,x))];case 4:r.sent();return[2,x]}})})}}function w(e){return function(t){var n=t(Object(l.e)({isODCEndpoint:h.S})).isODCEndpoint;return!!n&&n(e)}}function E(e,t){return function(n){var r=n(Object(l.e)({supportsRandomAccess:h.M})).supportsRandomAccess;return!!r&&r(e,t)}}},,function(e,t,n){"use strict";n.r(t);n.d(t,"ConfirmationDialog",function(){return c});var r=n("react-lib"),i=n(3771),s=n(2473),o=n(2849),u=n(1616),a=n(1115),f=n(2611),l=n(1648),c=function(e){var t=e.onConfirm,n=e.onCancel,c=e.defaultToYes,h=void 0!==c&&c,p=e.defaultFocusToYes,d=void 0!==p&&p,v=e.yesText,m=void 0===v?l.t:v,g=e.noText,y=void 0===g?l.e:g,b=function(e){e&&e.focus()},w=h?u.e:a.e,E=h?a.e:u.e,S=d?void 0:b,x=d?b:void 0;return r.createElement(f.e,null,r.createElement(i.e,{dialogContentProps:{type:s.e.close,subText:e.prompt?e.prompt:""},onDismiss:n,hidden:!1,title:e.title,maxWidth:e.maxWidth},r.createElement(o.e,null,r.createElement(w,{"data-automationid":"confirmbutton",onClick:t,componentRef:x},m),r.createElement(E,{"data-automationid":"cancelbutton",onClick:n,componentRef:S},y))))}}],Array(38),[function(e,t,n){"use strict";n.r(t);n.d(t,"spItemUploadItemsOperationHandler",function(){return y});var r=n(0),i=n(43),s=n(90),o=n(3531),u=n(16),a=n(122),f=n(2474),l=n(2),c=n(61),h=n(10),p=n(200),d=n(3901),v=n(160),m=n(268),g=n(1),y=Object(u.i)({mergeForSameItemKey:!1,maxParallelOperationCount:3,timeout:864e5})(function(e){var t=this,n=e.itemKey,u=e.options.sourceEntries,y=i.e.deserialize(n),b=y.webAbsoluteUrl,w=y.listFullUrl,E=Object.keys(u)[0],S=u[E].progressItemKey;return function(i){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,u,x,T,N,C,k,L,A,O;return Object(r.__generator)(this,function(M){switch(M.label){case 0:t=i(Object(a.e)({sourceFile:f.t},E)).sourceFile;u=i(Object(m.e)({listItemUploader:g.Ve})).listItemUploader,x=void 0===u?o.e:u;return[4,i(x(e))];case 1:T=M.sent().itemKey;N=new p.e;S&&t&&N.resolveItems({items:(L={},L[S]=Object(r.__assign)(Object(r.__assign)({},c.s.pack({itemKey:T})),Object(l.n)({progressSize:c.y},{progressSize:{current:t.size}})),L)});N.invalidateItems({items:(A={},A[n]=[h.t],A)});if(y.listFullUrl){C=new v.e(y.listFullUrl+"/Forms").path;if(y.rootFolder&&(y.rootFolder+"/").slice(0,C.length+1)===C+"/"){k=s.e.serialize({webAbsoluteUrl:b,listFullUrl:w});i(Object(d.e)({items:(O={},O[k]={childItemKey:T},O)}))}}i(N.execute());return[2]}})})}})},function(e,t,n){"use strict";n.r(t);n.d(t,"spItemCreateFolderOperationHandler",function(){return x});n.d(t,"getCreateFolderUrl",function(){return T});var r=n(0),i=n(160),s=n(43),o=n(90),u=n(1),a=n(231),f=n(262),l=n(400),c=n(122),h=n(143),p=n(880),d=n(16),v=n(61),m=n(10),g=n(6),y=n(874),b=n(203),w=n(46),E=n(268),S=n(4291),x=Object(d.i)({mergeForSameItemKey:!1,maxParallelOperationCount:8})(function(e){var t=this,n=e.itemKey,d=e.options.folders;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,y,b,E,x,C,k,L,A,O,M,_,D,P,H,B,j;return Object(r.__generator)(this,function(F){switch(F.label){case 0:t=Object.keys(d)[0];y=d[t],b=y.progressItemKey,E=y.conflictResolution;x=s.e.deserialize(n);C=x.rootFolder||new i.e(x.listFullUrl).path;k=o.e.serialize({webAbsoluteUrl:x.webAbsoluteUrl,listFullUrl:x.listFullUrl});L=e(Object(c.e)({list:u.Ue},k));A=Object(S.mapConflictResolutionToNameConflictBehavior)(E);O=T({webAbsoluteUrl:x.webAbsoluteUrl,listFullUrl:x.listFullUrl,parentFolderPath:C,isDocLib:!!L&&!!L.list&&L.list.isDocumentLibrary,folderName:t,nameConflictBehavior:A});return[4,e(Object(a.t)({webAbsoluteUrl:x.webAbsoluteUrl,listFullUrl:x.listFullUrl,url:O,method:"POST",qosName:"createFolder",parseResponse:function(e){var t;try{return null===(t=JSON.parse(e))||void 0===t?void 0:t.d}catch(e){}},telemetryHandler:function(e){var t=e.errorData,n=e.eventData;if(t){var i=t.code,s=i&&(i.indexOf("-2130575257")>-1||i.indexOf("-2130575245")>-1||i.indexOf("-2130247139")>-1)?w.t.expectedFailure:w.t.failure;return{eventData:Object(r.__assign)(Object(r.__assign)({},n),{resultType:s})}}return{eventData:n}}})).catch(function(t){if(t instanceof f.e&&t.message&&C){var n=C;"/"===n[0]&&(n=n.substr(1));"/"!==n[n.length-1]&&(n+="/");t.message=t.message.replace(n,"")}throw new l.e({innerError:t,facets:e(N(t))})})];case 1:M=F.sent();if(b){_=null===(j=M)||void 0===j?void 0:j.Name;D=C+"/"+_;P=s.e.serialize({webAbsoluteUrl:x.webAbsoluteUrl,listFullUrl:x.listFullUrl,rootFolder:D});e(Object(h.e)({items:(H={},H[b]=Object(r.__assign)(Object(r.__assign)({},v.s.pack({itemKey:P})),_&&t!==_?g.h.pack(_):{}),H[P]=Object(r.__assign)(Object(r.__assign)({},u.pe.pack(D)),g.M.pack({itemKey:n})),H)}))}e(Object(p.e)({items:(B={},B[n]=[m.t],B)}));return[2]}})})}});function T(e){var t=e.webAbsoluteUrl,n=e.listFullUrl,i=e.parentFolderPath,s=e.isDocLib,o=void 0===s||s,u=e.folderName,a=e.nameConflictBehavior,f=Object(y.r)({webAbsoluteUrl:t,listOrItemFullUrl:n}),l=u?u.trim():"";return(f=o?(f=f.segment("folders")).methodWithAliases("AddUsingPath",Object(r.__assign)({DecodedUrl:i+"/"+l,overwrite:!1},2===a?{EnsureUniqueFileName:!0}:{})).oDataParameter("$Expand","ListItemAllFields/PermMask"):f.methodWithAliases("GetFolderByServerRelativePath",{DecodedUrl:i}).methodWithAliases("AddSubFolderUsingPath",{DecodedUrl:l||"Folder"+(Math.floor(100*Math.random())+1)})).toString()}function N(e){return function(t){if(e instanceof f.e){switch((function(e){var t=e.errorData.code;return(void 0===t?"":t).split(",").map(function(e){return Number(e)})[0]})(e)){case Number("-2130575257"):if(t(Object(E.e)({enableRenameOnUploadConflict:u.G})).enableRenameOnUploadConflict)return Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},b.m.pack({})),b.t.pack(!0)),b.n.pack(!1));break;case-2147023080:case-2130575282:return b.w.pack({})}}}}},function(e,t,n){"use strict";n.r(t);n.d(t,"spItemCreateDocumentOperationHandler",function(){return o});var r=n(0),i=n(16),s=n(3356);n.d(t,"getCreateDocumentUrl",function(){return s.e});n.d(t,"getRedirectUrlFromResponse",function(){return s.t});var o=Object(i.i)({mergeForSameItemKey:!1,maxParallelOperationCount:4})(function(e){var t=this;return function(i){return Object(r.__awaiter)(t,void 0,void 0,function(){return Object(r.__generator)(this,function(t){switch(t.label){case 0:return[4,n.ee([36,"ondemand.resx-ondemand"],4415)];case 1:return[4,(0,t.sent().createDocumentsCore)(i,e)];case 2:t.sent();return[2]}})})}})}],Array(29),[function(e,t,n){"use strict";n.r(t);n.d(t,"fileHandlerGetItemsOperationHandler",function(){return w});n.d(t,"filehandlerPerExtensionGetItemsOperationHandler",function(){return E});n.d(t,"fetchFileHandlerData",function(){return S});var r=n(0),i=n(16),s=n(1238),o=n(85),u=n(3848),a=n(787),f=n(1611),l=n(2612),c=n(218),h=n(129),p=n(109),d=n(268),v=n(486),m=n(44),g=n(793),y=n(213),b=n(945),w=Object(i.i)()(function(e){var t=this,n=e.itemKey,i=c.t.deserialize(n),s=i.endpoint;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,u;return Object(r.__generator)(this,function(r){t=e(Object(v.e)({name:"getFileHandlersOperation"}));u={endpoint:s};return[2,e(S(i)).then(function(r){if(r){Object(b.e)({driveAppsKey:i,data:r});e(Object(b.n)(r,n));u.fileHandlerRequestEndpoint=r.signature.endpoint;u.accessTokenObtained=!0;e(t({resultType:m.e.Success,extraData:u}))}else e(t({resultType:m.e.Failure,resultCode:"NoFileHandlerData",extraData:u}))}).catch(function(n){o.e.logError(n);e(t({resultType:m.e.Failure,extraData:u}));throw n})]})})}}),E=Object(i.i)()(function(e){var t=this,n=e.itemKey,i=c.e.deserialize(n).endpoint;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t;return Object(r.__generator)(this,function(n){switch(n.label){case 0:t=c.t.serialize({endpoint:i});return[4,e(Object(s.e)(function(e){return e.demandItemFacet(h.t,t)}))];case 1:n.sent();return[2]}})})}});function S(e){var t=e.endpoint,n=e.driveId;return function(e){var i,s={endpoint:t,driveId:n},o=e(Object(v.e)({name:"fetchFileHandlerData",extraData:s})),c=e(Object(d.e)({getUserOneDriveEndpoint:p.v,useOneDriveEndpoint:p.D,enableFileHandlerPrefetch:p.f,graphQLPrefetchCache:p.y})),h=c.getUserOneDriveEndpoint,b=c.useOneDriveEndpoint,w=c.enableFileHandlerPrefetch,E=c.graphQLPrefetchCache,S=Object(a.n)({endpoint:t,driveId:n}),x=new u.e({},Object(r.__assign)({dataRequestor:e(f.e).dataRequestor},w&&E?{prefetchCache:E}:{})),T=Promise.resolve(t);h&&b&&(T=e(h({endpoint:t})));return T.then(function(t){i=t;S=Object(a.n)({endpoint:i});s.fileHandlerRequestEndpoint=i;return e(Object(l.getSessionToken)(i,S,{qosExtraData:{requestor:"GetFileHandlerData",endPoint:i,driveUrl:S}}))}).then(function(t){s.accessTokenObtained=!!t;return x.getFileHandlerData({accessToken:t,endpoint:i,includePromotedApp:!0,driveId:n}).then(function(t){if(t){var r={data:t,lastModified:Date.now(),signature:{endpoint:i,includePromotedApp:!0,driveId:n}};e(o({resultType:m.e.Success,extraData:s}));return r}e(o({resultType:m.e.Failure,resultCode:"NoDataFromFileHandlerService",extraData:s}))}).catch(function(t){e(o(Object(g.e)({resultType:m.e.Failure,extraData:s},Object(y.e)(t))));throw t})}).catch(function(t){e(o(Object(g.e)({resultType:m.e.Failure,resultCode:"getSessionTokenError",extraData:s},Object(y.e)(t))));throw t})}}}],Array(18),[function(e,t,n){"use strict";n.r(t);n.d(t,"getListRootFolder",function(){return o});var r=n(0),i=n(231),s=n(874);function o(e){var t=this,n=e.webAbsoluteUrl,o=e.listFullUrl,u=e.qosName;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t;return Object(r.__generator)(this,function(r){switch(r.label){case 0:t=Object(s.e)({webAbsoluteUrl:n,listFullUrl:o}).segment("RootFolder");return[4,e(Object(i.r)({url:t.toString(),method:"GET",webAbsoluteUrl:n,listFullUrl:o,qosName:"rootFolder."+u,noRedirect:!0}))];case 1:return[2,r.sent()]}})})}}}],Array(391),[function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=n(2),i=n(363),s=new r.e("saveViewCore"),o=Object(i.e)({operationTypeFacet:s})}],Array(68),[function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=n(2),i=n(363),s=new r.e("refreshItemsInSet"),o=Object(i.e)({operationTypeFacet:s})}],Array(266),[function(e,t,n){"use strict";n.d(t,"e",function(){return o});n.d(t,"t",function(){return a});var r=n(2),i=n(526),s=n(5),o=new r.e("updateItem"),u=new s.e("updateListItem",{itemDisplayName:Object(s.s)()}),a=new i.e("updateListItemProgress",function(e,t){return u.serialize({})})}],Array(42),[function(e,t,n){"use strict";n.d(t,"e",function(){return i});n.d(t,"t",function(){return s});var r=n(2),i=new r.e("entryBatch"),s=new r.e("sourceFile")}],Array(74),[function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=n(21),i=n(75),s=new r.e("itemTileFolderCoverControl",{folderCoverAs:Object(i.e)()}),o=new r.e("itemTileControl",{tileAs:Object(i.e)(),folderCoverControlHandler:Object(r.n)(s)})},,,,,,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return M});n.d(t,"t",function(){return D});var r=n(0),i=n(123),s=n(6),o=n(10),u=n(137),a=n(1112),f=n(3351),l=n(3542),c=n(610),h=n(1133),p=n(2383),d=n(138),v=n(55),m=n(1185),g=n(3030),y=n(1169),b=n(2809),w=n(3891),E=n(3353),S=n(3354),x=n(3352),T=n(272),N=n(3893),C=n(3892),k=n(1278),L=n(3543),A=n(3894),O=n(200);function M(e){var t=e.itemKey,n=e.driveItemKey,P=e.driveItem,H=e.endpoint,B=e.parentFolderItemKey,j=e.shouldReturnShareFacets,F=void 0===j||j,I=P.coverImage,q=P.file,R=P.fileSystemInfo,U=P.name,z=P.parentReference,W=P.remoteItem,X=P.root,V=P.size,$=P.thumbnails,J=P.image,K=P.video,Q=P.eTag,G=P.tags,Y=P.photo,Z=P.specialFolder;return function(e){var j,ee,te,ne=P.lastModifiedDateTime,re=void 0===ne?R&&R.lastModifiedDateTime||W&&W.lastModifiedDateTime:ne,ie=P.createdDateTime||R&&R.createdDateTime||W&&W.createdDateTime,se=z&&z.driveId,oe=z&&z.driveType||W&&W.parentReference&&W.parentReference.driveType,ue="personal"===oe,ae=R&&R.lastAccessedDateTime||W&&W.fileSystemInfo&&W.fileSystemInfo.lastAccessedDateTime,fe=null===(ee=Y)||void 0===ee?void 0:ee.takenDateTime,le=P.package||W&&W.package,ce=$||W&&W.thumbnails,he=J||W&&W.image,pe=K||W&&W.video,de=P.shared||W&&W.shared,ve={itemId:P.id,driveId:se,endpoint:H},me=R&&R.systemPath,ge=n||W&&W.parentReference&&{itemId:W.id,driveId:W.parentReference.driveId,endpoint:H}||ve,ye=u.e.serialize(ge),be=P.webDavUrl||W&&W.webDavUrl;te="business"!==oe&&"documentLibrary"!==oe&&"personal"!==oe||!X?U||W&&W.name||"":p.t;var we=P.folder||W&&W.folder,Ee=V||W&&W.size,Se=we&&we.childCount,xe=D(te,!!we),Te=xe.extension||P.package&&P.package.type,Ne=Te&&Object(w.e)(Te),Ce=P.sharepointIds||W&&W.sharepointIds,ke=P.localItem,Le=P.webUrl||W&&W.webUrl,Ae=new O.e({publisher:M});Ae.resolveItems({items:(j={},j[t]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},u.e.pack(ge)),s.h.pack(te)),void 0!==Ee?s.v.pack(Ee):{}),R||P.folder||q||W&&W.folder?Object(r.__assign)({},s.m.pack(we?{}:void 0)):{}),Le?s.O.pack(Le):{}),y.n.pack(me)),be?s.i.pack(decodeURIComponent(be)):{}),s.f.pack(re?new Date(re).getTime():void 0)),s.u.pack(ie?new Date(ie).getTime():void 0)),d.u.pack(fe?new Date(fe).getTime():void 0)),ae?Object(r.__assign)({},s.o.pack(new Date(ae).getTime())):{}),i.i.pack(le&&"oneNote"===le.type?{}:void 0)),ce?Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},f.e.pack(ce)),x.e.pack(!0)),C.e.pack(Object(k.t)(xe.extension))):{}),Object(T.e)().forFacet(d.v).thenInvalidate(ye,f.e).pack()),l.e.pack(P)),Q?s.p.pack(Q):{}),he&&he.width&&he.height?d.a.pack({width:he.width,height:he.height}):{}),he&&!pe?d.p.pack({}):{}),pe?d.g.pack({}):{}),o.t.pack({itemKey:a.e.serialize({driveItemKey:ge,sortBy:"",isAscending:!0})})),s.n.pack({itemKey:c.e.serialize({driveItemKey:ge})})),s.M.pack(B?{itemKey:B}:void 0)),!ue&&be?Object(r.__assign)({},s._.pack(_(be))):{}),m.e.pack(oe)),ue?Object(r.__assign)({},g.e.pack(P.vault)):{}),ue&&P.restricted?Object(r.__assign)({},L.e.pack(P.restricted)):{}),s.d.pack(xe)),F?Object(r.__assign)(Object(r.__assign)({},s.x.pack(!!de)),h.e.pack(de)):{}),ke?y.e.pack(ke):{}),"number"==typeof Se?v.e.pack(Se):{}),N.e.pack(I)),A.e.pack(G)),y.t.pack(q&&q.mimeType)),Ne?b.e.pack(Ne):{}),Ce?E.e.pack(Ce):{}),Z?S.e.pack(Z.name):{}),j)});return{itemResolver:Ae}}}function _(e){var t=e.split("/");return t.length>2?decodeURIComponent(t[t.length-2]):void 0}function D(e,t){var n=e.lastIndexOf(".");return t||n<0?{name:e,extension:""}:{name:e.substring(0,n),extension:e.substring(n)}}}],Array(51),[function(e,t,n){"use strict";n.d(t,"e",function(){return a});n.d(t,"t",function(){return f});var r=n("react-lib"),i=n(1232),s=n(128),o=n(98),u=0;function a(e){var t=e.isDefault,n=void 0!==t&&t,o=r.useState(""+ ++u)[0],a=r.useContext(i.e),f=r.useRef(),c=f.current||n&&a.keyboardManager||(f.current=new i.t({isDefault:!1,id:o,parent:a.keyboardManager})),h=l(c),p=h.isActive,d=h.isChildActive;r.useEffect(function(){return function(){if(!n){c.setIsActive(!1);c.dispose()}}},[]);var v=r.useMemo(function(){return{keyboardManager:c}},[c]);return r.createElement("div",{"data-keyboard-zone-id":o},r.createElement(i.e.Provider,{value:v},Object(s.t)(e.children,{isActive:p,isChildActive:d})))}function f(){return l(r.useContext(i.e).keyboardManager)}function l(e){var t=r.useState(function(){return e.getIsActive()}),n=t[0],i=t[1],s=r.useState(function(){return e.hasActiveChildren()}),u=s[0],a=s[1];r.useEffect(function(){var t=new o.e(null);t.on(e,"change",function(){i(e.getIsActive());a(e.hasActiveChildren())});return function(){t.dispose()}},[]);return{isActive:n,isChildActive:u}}},function(e,t,n){"use strict";n.r(t);n.d(t,"getAuthToken",function(){return l});n.d(t,"getSessionToken",function(){return c});var r=n(0),i=n(1355),s=n(268),o=n(486),u=n(44),a=n(82),f=n(3491);function l(e,t,n,l){var c=this;return function(h){return Object(r.__awaiter)(c,void 0,void 0,function(){var c,p,d,v,m,g,y,b,w,E,S,x,T,N=this;return Object(r.__generator)(this,function(C){switch(C.label){case 0:c=(l||{}).qosExtraData;p=h(Object(s.e)({graphDataSourceConfiguration:i.e,graphTokenProviderConfiguration:f.e})),d=p.graphDataSourceConfiguration,v=p.graphTokenProviderConfiguration;m=d&&d.ensureAuthToken;g=n&&d&&d.ensureAuthTokenWithAction;y=v&&v.getSessionToken;if(!(w=y?function(){return Object(r.__awaiter)(N,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,y({endpoint:t,driveUrl:n,path:n||t})];case 1:return[2,e.sent().accessToken]}})})}:g?function(){return Object(r.__awaiter)(N,void 0,void 0,function(){return Object(r.__generator)(this,function(r){switch(r.label){case 0:return[4,h(g(e,t,n))];case 1:return[2,r.sent()]}})})}:m?function(){return Object(r.__awaiter)(N,void 0,void 0,function(){return Object(r.__generator)(this,function(n){switch(n.label){case 0:return[4,m(e,t)];case 1:return[2,n.sent()]}})})}:void 0))return[3,4];E=h(Object(o.e)({name:"graphDataSource.getAuthToken",extraData:c}));C.label=1;case 1:C.trys.push([1,3,,4]);return[4,w()];case 2:b=C.sent();h(E({resultType:u.e.Success,extraData:Object(r.__assign)(Object(r.__assign)({},c),{authTokenObtained:!!b})}));return[3,4];case 3:S=C.sent();x=u.e.Failure;T=void 0;if(S instanceof a.e){S.isExpected&&(x=u.e.ExpectedFailure);T=S.code}else T=S instanceof Error?S.name+"("+S.message+")":"UnknownAuthError";h(E({resultType:x,resultCode:T,error:S&&JSON.stringify(S),extraData:c}));throw S;case 4:return[2,b]}})})}}function c(e,t,n){var i=this;return function(s){return Object(r.__awaiter)(i,void 0,void 0,function(){var i,o;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return[4,s(l(["Files.ReadWrite.All"],e,t,n))];case 1:(i=r.sent())&&(o={accessToken:i});return[2,o]}})})}}},,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return o});n.d(t,"t",function(){return a});var r=n(2),i=n(526),s=n(5),o=new r.e("setItemValuesFromFormatter"),u=new s.e("setItemValuesFromFormatter",{}),a=new i.e("setItemValuesFromFormatterProgress",function(e,t){return u.serialize({})})}],Array(67),[function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(332),i=Object(r.e)(function(e){return{}})}],Array(98),[function(e,t,n){"use strict";n.d(t,"t",function(){return i});n.d(t,"e",function(){return s});var r=n(5),i=new r.e("uploadProgress",{sourceEntryKey:Object(r.s)()});function s(e){return i.serialize({sourceEntryKey:e})}}],Array(18),[function(e,t,n){"use strict";n.d(t,"e",function(){return i});n.d(t,"t",function(){return s});var r=n(2),i=new r.e("officeApp"),s=new r.e("officeLens")}],Array(49),[function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(2).e)("bundle")}],Array(33),[function(e,t,n){"use strict";n.d(t,"n",function(){return r});n.d(t,"e",function(){return i});n.d(t,"t",function(){return s});var r="root",i="/drive/root:",s=30},function(e,t,n){"use strict";n.d(t,"e",function(){return l});n.d(t,"t",function(){return c});n.d(t,"n",function(){return h});n.d(t,"r",function(){return p});n.d(t,"i",function(){return d});n.d(t,"s",function(){return m});var r=n(0),i=n(1133),s=n(3540),o=n(3539),u=n(137),a=n(135),f=n(123),l=(new a.e("addToOneDrive",function(e,t){return v(e,Object(r.__assign)(Object(r.__assign)({},t),{commandFacet:s.e}))}),new a.e("canCreateFolder",function(e,t){return v(e,Object(r.__assign)(Object(r.__assign)({},t),{commandFacet:s.t}))})),c=(new a.e("canCreateLink",function(e,t){return v(e,Object(r.__assign)(Object(r.__assign)({},t),{commandFacet:s.n}))}),new a.e("canDelete",function(e,t){return v(e,Object(r.__assign)(Object(r.__assign)({},t),{commandFacet:s.r}))})),h=new a.e("canDownload",function(e,t){return!e.demandItemFacet(f.i,t.itemKey)&&v(e,Object(r.__assign)(Object(r.__assign)({},t),{commandFacet:s.i}))}),p=(new a.e("canInvite",function(e,t){return v(e,Object(r.__assign)(Object(r.__assign)({},t),{commandFacet:s.s}))}),new a.e("canMove",function(e,t){return v(e,Object(r.__assign)(Object(r.__assign)({},t),{commandFacet:s.o}))}),new a.e("canUseOfficeLens",function(e,t){return v(e,Object(r.__assign)(Object(r.__assign)({},t),{commandFacet:s.u}))}),new a.e("canRename",function(e,t){return v(e,Object(r.__assign)(Object(r.__assign)({},t),{commandFacet:s.a}))})),d=new a.e("canUpload",function(e,t){return v(e,Object(r.__assign)(Object(r.__assign)({},t),{commandFacet:s.f}))});function v(e,t){var n=t.itemKey,r=t.commandFacet,i=e.demandItemFacet(u.e,n);if(!i)return!1;var s=i.endpoint,a=i.driveId,f=e.demandItemFacet(r,o.e.serialize({endpoint:s,driveId:a}));return!!f&&!!f.roles&&m(e,{itemKey:n,oneOfRequiredRoles:f.roles})}function m(e,t){var n=t.itemKey;return(function(e,t){var n=t.oneOfRequiredRoles,r=t.effectiveRoles;for(var i in r)if(i in n)return!0;return!1})(0,{oneOfRequiredRoles:t.oneOfRequiredRoles,effectiveRoles:(function(e,t){if((function(e,t,n){var r,s,o,u=e.demandItemFacet(i.e,t),a=null===(o=null===(s=null===(r=u)||void 0===r?void 0:r.owner)||void 0===s?void 0:s.user)||void 0===o?void 0:o.id;if(n&&a)return n.toUpperCase()===a.toUpperCase();return!u||!u.effectiveRoles||!u.owner})(e,t))return["read","write","owner"];var n=e.demandItemFacet(i.e,t);if(n&&n.effectiveRoles)return n.effectiveRoles;return[]})(e,n)})}}],Array(134),[function(e,t,n){"use strict";n.d(t,"t",function(){return h});n.d(t,"r",function(){return p});n.d(t,"n",function(){return d});n.d(t,"e",function(){return g});var r=n(0),i=n(231),s=n(268),o=n(874),u=n(486),a=n(44),f=n(1),l=n(621),c=n(82);n(3535);function h(e){return function(t){var n=t(Object(s.e)({spHomeDataSourceConfiguration:f.Zt})).spHomeDataSourceConfiguration,r=n&&n.contextAcquiresAuthToken;return t(Object(i.r)({webAbsoluteUrl:e.tenantRootUrl,listFullUrl:e.tenantRootUrl,method:"GET",url:v(e),qosName:"getSPHomeContext",parseResponse:function(e){var t=JSON.parse(e).d;return{payloadHeader:t.Payload,resource:t.Urls&&t.Urls.results&&t.Urls.results.length>0&&t.Urls.results[0]||"",accessToken:t.Token&&t.Token.access_token||""}},noRedirect:!0,skipAuth:r,crossSiteCollectionCall:r,needsRequestDigest:!r,ignoreDiskCacheWhenOnline:!0}))}}function p(e,t,n){var i=this;void 0===n&&(n=8);return function(o){return Object(r.__awaiter)(i,void 0,void 0,function(){var i,u,a,l,c,p;return Object(r.__generator)(this,function(r){switch(r.label){case 0:i=o(Object(s.e)({spFrequentSitesConfiguration:f.Gt,enableFilesWeightedFrequentSitesConfiguration:f.M})),u=i.spFrequentSitesConfiguration,a=i.enableFilesWeightedFrequentSitesConfiguration;return u&&u.getExternalData?[4,u.getExternalData()]:[3,2];case 1:if(l=r.sent())return[2,l];r.label=2;case 2:return!t&&u&&u.getCacheContext?[4,u.getCacheContext()]:[3,4];case 3:(c=r.sent())&&(t=JSON.stringify(c));r.label=4;case 4:return[4,o(h({tenantRootUrl:e}))];case 5:p=r.sent();return[2,o(g({path:"api/v1/sites/feed?acronyms=true&start=0&count="+n,method:"GET",qosName:"getSPHomeFrequentSites",context:p,clientType:a?"ODBWeb":void 0,cacheContext:t}))]}})})}}function d(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,o;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return(t=n(Object(s.e)({spFollowedSitesConfiguration:f.Qt})).spFollowedSitesConfiguration)&&t.getExternalData?[4,t.getExternalData()]:[3,2];case 1:if(i=r.sent())return[2,i];r.label=2;case 2:return[4,n(h({tenantRootUrl:e}))];case 3:o=r.sent();return[2,n(g({path:"api/v1/sites/followed?acronyms=true&fillsitedata=true&mostRecentFirst=true&start=0&count=36",method:"GET",qosName:"getSPHomeFollowedSites",context:o}))]}})})}}function v(e){var t=e.tenantRootUrl;return Object(o.n)({webAbsoluteUrl:t}).segment("sphomeservice").segment("context").oDataParameter("$expand","Token,Payload").toString()}function m(e){var t=this,n=e.context;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t;return Object(r.__generator)(this,function(r){switch(r.label){case 0:t=e(Object(s.e)({spHomeTokenProvider:f.nn})).spHomeTokenProvider;return n.accessToken?[2,n.accessToken]:t?[4,t.getToken({resource:n.resource})]:[3,2];case 1:return[2,r.sent().token];case 2:return[4,e(Object(i.e)({url:n.resource}))];case 3:return[2,r.sent()]}})})}}function g(e){var t=this,n=e.method,i=e.path,s=e.context,o=e.qosName,f=e.clientType,h=e.contentType,p=void 0===h?"application/json;odata=verbose":h,d=e.body,v=e.cacheContext,g=o?"getData."+o:"getData";return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,o,h,y,b,w,E,S,x=this;return Object(r.__generator)(this,function(T){switch(T.label){case 0:t=new Headers;return[4,e(m({context:s}))];case 1:(o=T.sent())&&t.set("Authorization","Bearer "+o);s.payloadHeader&&t.set("SPHome-ApiContext",s.payloadHeader);v&&t.set("SPHome-CacheContext",v);t.set("SPHome-ClientType",f||"ODSPDocLibsWeb");t.set("Content-Type",p);h={headers:t,credentials:"omit",method:n,mode:"cors",cache:"default",body:d};y=e(Object(u.e)({name:g}));b=s.resource+"/"+i+"__"+n;return[4,e(Object(l.t)(b))];case 2:w=T.sent();E=fetch(s.resource+"/"+i,h).then(function(t){return Object(r.__awaiter)(x,void 0,void 0,function(){var n;return Object(r.__generator)(this,function(r){switch(r.label){case 0:if(!t.ok)return[3,2];e(y({resultType:a.e.Success}));return 204===t.status?[2,{}]:[4,t.json()];case 1:n=r.sent();e(Object(l.r)(b,n));return[2,n];case 2:throw new c.e({code:""+t.status,message:t.statusText})}})})}).catch(function(t){e(y({resultType:a.e.Failure,resultCode:t instanceof c.e?t.code:t.name,error:t&&JSON.stringify(t)}));throw t});return(S=w)?[3,4]:[4,E];case 3:S=T.sent();T.label=4;case 4:return[2,S]}})})}}},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(2).e)("vault")},function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(5),i=new r.e("userByEmail",{email:Object(r.s)(),endpoint:Object(r.s)()})},function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r=n(5),i=n(137),s=new r.e("searchItemSet",{driveItemKey:Object(r.o)(i.e),searchTerm:Object(r.s)()})},function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=n(2),i=n(363),s=new r.e("modifyFieldProperties"),o=Object(i.e)({operationTypeFacet:s})},function(e,t,n){"use strict";n.d(t,"t",function(){return u});n.d(t,"e",function(){return a});var r=n(231),i=n(874),s=n(12),o=n(368);function u(e){return function(t){return t(Object(r.r)({webAbsoluteUrl:e.webAbsoluteUrl,listFullUrl:e.listFullUrl,method:"GET",url:c(e),qosName:"getViewData",additionalHeaders:e.preferredLanguage?{"Accept-Language":e.preferredLanguage}:{},parseResponse:function(t){return JSON.parse(t).d.results.map(function(t){var n=f(t,!1,e.listTemplate);t&&n&&!t.ViewData&&(t.ViewData=n.viewData);return{serverView:t,view:n}})},noRedirect:!0}))}}function a(e){return function(t){return t(Object(r.r)({webAbsoluteUrl:e.webAbsoluteUrl,listFullUrl:e.listFullUrl,method:"GET",url:c(e),qosName:"getViewDataById",parseResponse:function(e){var t=JSON.parse(e).d;return{serverView:t,view:f(t,!0)}},noRedirect:!0}))}}function f(e,t,n){if(e.ViewType&&e.Id){var r=o.e.isAppView(e),i=e.Hidden&&!r,u=n===s.t.pictureLibrary&&"2"===e.BaseViewId&&window.location.pathname.toLowerCase()!==e.ServerRelativeUrl.toLowerCase();if(t||!i&&!u){var a=new o.e(e);if(a.viewType)return a}}}var l=["BaseViewId","DefaultView","EditorModified","Hidden","Id","ListViewXml","PersonalView","RowLimit","Scope","ServerRelativeUrl","TabularView","Title","ViewType","VisualizationInfo","CustomFormatter"].join(",");function c(e){var t=e.webAbsoluteUrl,n=e.listFullUrl,r=e.viewId,s=Object(i.e)({webAbsoluteUrl:t,listFullUrl:n});return(s=r?s.method("Views",r):s.segment("Views")).oDataParameter("$select",l).toString()}},function(e,t,n){"use strict";n.d(t,"n",function(){return g});n.d(t,"t",function(){return y});n.d(t,"e",function(){return S});var r=n(14),i=n(43),s=n(90),o=n(983),u=n(1),a=n(12),f=n(29),l=n(160),c=n(137),h=n(787),p=n(6),d=n(465),v=n(56),m=n(49),g=Object(r.t)()(w),y=Object(r.t)()(w),b={ODB:1928};function w(){return function(e){return E}}function E(e,t){var n=t.itemKey,r=t.desiredSize,f=e.demandItemFacet(i.e,n);if(!f)return{};var l=(function(e,t){var n=t.itemKey,r=t.spItem,i=t.desiredSize,s=S(e,{itemKey:n,spItem:r});if(s){var o=Math.ceil(i.width),u=Math.ceil(i.height);return{url:s(o,u),width:0,height:0}}})(e,{itemKey:n,spItem:f,desiredSize:r})||(function(e,t){var n=t.itemKey,r=t.desiredSize,i=e.demandItemFacet(o.t,n),s=i&&i(r.width,r.height);if(s)return{url:s,width:0,height:0}})(e,{itemKey:n,desiredSize:r})||(function(e,t){var n=t.spItem,r=t.itemKey,i=s.e.serialize(n),f=e.demandItemFacet(u.Ue,i);if(!f)return;var l=f.templateType===a.n.publishingAsset;if(f.isPromotedLinks||l){var c=e.demandItemFacet(u.At,r),h=void 0;f.isPromotedLinks?h=c&&c.BackgroundImageLocation:l&&c&&c.AlternateThumbnailUrl&&(h=e.demandItemFacet(o.e,r));if(h)return{url:h,width:0,height:0}}})(e,{spItem:f,itemKey:n});return l?{thumbnail:l}:{}}function S(e,t){var n=t.itemKey,r=t.spItem,i=Object(f.e)(e,{enableSharePointDirectThumbnails:u.ee,spCookieDomainConfiguration:u.It}),s=i.enableSharePointDirectThumbnails,o=void 0===s||s,a=i.spCookieDomainConfiguration,g=Object(m.e)(e,n);if(o&&Object(v.e)(e,{pageContext:g,feature:b})&&g){var y=r.webAbsoluteUrl,w=r.listFullUrl,E=new l.e(y||w).authority;if(a&&a===E){var S=E+"/_api/v2.1",x=e.demandItemFacet(c.e,n),T=e.demandItemFacet(p.p,n)||"";if(x){var N=x.driveId,C=x.itemId,k=Object(h.t)({endpoint:S,driveId:N,itemId:C});return function(e,t){return k+"/thumbnails/0/c"+e+"x"+(t=t||e)+"/content?"+Object(d.e)({prefer:"noredirect,closestavailablesize",cb:T})}}}}}},function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r=n(78),i=n(204);function s(e,t){var n=t.itemSetKey,s=e.demandItemFacet(r.e,n);return s&&s.viewKey&&i.e.serialize(s.viewKey)}}],Array(19),[function(e,t,n){"use strict";n.r(t);n.d(t,"ItemSwitchViewAction",function(){return b});n.d(t,"SwitchViewExecutor",function(){return w});var r=n(0),i=n("react-lib"),s=n(13),o=n(22),u=n(143),a=n(10),f=n(43),l=n(78),c=n(204),h=n(1),p=n(368),d=n(20),v=n(295),m=n(880),g=n(27),y=n(32),b=Object(y.t)(function(e,t){var n=t.itemKey,s=t.itemSetKey,y=t.viewId,b=t.currentDerivedView,w=e.demandItemFacet(f.e,n);if(!w)return null;var E=w.webAbsoluteUrl,S=w.listFullUrl,x=e.demandItemFacet(l.e,s),T=l.e.serialize({webAbsoluteUrl:E,listFullUrl:S,rootFolder:x&&x.rootFolder||"",viewKey:{viewId:y}}),N=b&&c.e.serialize({viewId:b.id}),C=e.isItemFacetResolved(h.Ot,N)?e.demandItemFacet(h.Ot,N):void 0,k=Object(g.t)(e,{itemKey:n,engagement:{name:"SwitchView",isIntentional:!0}}),L=e.dispatch,A=Object(d.i)(e,i.createElement(v.e,{itemKey:T}));return i.createElement(d.n,{action:A},function(e){var t=e.isAvailable,s=e.execute;return i.createElement(o.e,Object(r.__assign)({isAvailable:t,isToggled:b?y===b.id:""===y,onExecute:function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var t,i,o;return Object(r.__generator)(this,function(f){switch(f.label){case 0:L(Object(u.e)({items:Object(r.__assign)(Object(r.__assign)({},N?(t={},t[N]=Object(r.__assign)(Object(r.__assign)({},h.Dt.pack(!1)),C&&b&&b.isDirty()?Object(r.__assign)({},h.m.pack(new p.e(C))):{}),t):{}),n?(i={},i[T]=Object(r.__assign)({},a.s.pack({itemKey:n})),i):{})}));N&&b&&b.isDirty()&&L(Object(m.e)({items:(o={},o[N]=[h.Ot,h.m],o)}));return[4,s(e)];case 1:f.sent();return[2]}})})}},k))})}),w=Object(s.e)()(b)}],Array(255),[function(e,t,n){"use strict";n.d(t,"t",function(){return i});n.d(t,"e",function(){return s});var r=n(21),i=new r.e("progressListGroupControl",{}),s=new r.e("progressListControl",{groupControlHandler:Object(r.n)(i)})},,,function(e,t,n){"use strict";n.d(t,"t",function(){return u});n.d(t,"n",function(){return a});n.d(t,"e",function(){return f});var r=n(0),i=n(2),s=n(400),o=n(526),u=new i.e("moveCopyItems"),a=new o.e("moveCopyItems"),f=(function(e){Object(r.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}return t})(s.e)}],Array(23),[function(e,t,n){"use strict";n.d(t,"t",function(){return i});n.d(t,"e",function(){return s});var r=n(118);function i(e){switch(e){case r.e.Word:return".docx";case r.e.Excel:case r.e.ExcelSurvey:case r.e.ExcelForm:return".xlsx";case r.e.PowerPoint:return".pptx";case r.e.OneNote:return"";case r.e.Text:return".txt";case r.e.Visio:return".vsdx";case r.e.Bohemia:return".b";case r.e.Prague:return".prague"}}function s(e,t){var n="";switch(e){case r.e.Word:n=t.CreateWord;break;case r.e.Excel:n=t.CreateExcel;break;case r.e.PowerPoint:n=t.CreatePowerPoint;break;case r.e.OneNote:n=t.CreateOneNote;break;case r.e.ExcelSurvey:n=t.CreateExcelSurvey;break;case r.e.Text:n=t.CreateText;break;case r.e.ExcelForm:n=t.CreateFormForExcel;break;case r.e.Visio:n=t.CreateVisio;break;case r.e.Bohemia:n=t.CreateBohemia;break;case r.e.Prague:n=t.CreatePrague}return n}},,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return s});n.d(t,"t",function(){return o});var r=n(2),i=n(526),s=new r.e("addContentTypesToList"),o=new i.e("addContentTypesToList")},,,,function(e,t,n){"use strict";n.d(t,"t",function(){return s});var r=n(2),i=n(363),s=new r.e("pinSite"),o=Object(i.e)({operationTypeFacet:s});t.e=o},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(2).e)("mountPoint")},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(2).e)("graphThumbnailSet")},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(2).e)("hasThumbnailAuthTokenFacet")},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(2).e)("sharepointIds")},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(2).e)("specialFolder")},function(e,t,n){"use strict";n.d(t,"t",function(){return o});n.d(t,"n",function(){return u});n.d(t,"e",function(){return a});var r=n(2),i=n(526),s=n(363),o=new r.e("removeFromOneDrive"),u=new i.e("removeFromOneDrive"),a=Object(s.e)({operationTypeFacet:o})},function(e,t,n){"use strict";n.d(t,"t",function(){return u});n.d(t,"e",function(){return a});var r=n(3460),i=n(118),s=n(3339),o=n(874);function u(e){var t=e.responseText,n=e.documentType,i=e.fileName,s="",o="";if(null!=t){var u=JSON.parse(t);if(null!==u&&null!==u.d&&null!==u.d.CreateDocumentAndGetEditLink){o=u.d.CreateDocumentAndGetEditLink;s=Object(r.t)(o,n,i||"",!1)}else try{o=(new DOMParser).parseFromString(t,"text/xml").getElementsByTagName("d:CreateDocumentAndGetEditLink")[0].textContent||"";s=Object(r.t)(o,n,i||"",!1)}catch(e){}}return{originalEditLink:o,redirectUrl:s}}function a(e){var t=i.e.Visio,n=e.webAbsoluteUrl,r=e.listFullUrl,u=e.parentFolderPath,a=e.templateUrl,f=e.docName,l=e.docType;if(null!==l&&l>=i.e.Word&&l<=t&&l!==i.e.Text){if(l!==i.e.OneNote||f){if(f){f+=Object(s.t)(l)}}else f="Notebook"+Math.floor(100*Math.random())+1;f||(f="");l===i.e.ExcelForm&&(l=i.e.ExcelSurvey);return Object(o.e)({webAbsoluteUrl:n,listFullUrl:r}).methodWithAliases("CreateDocumentAndGetEditLink",{fileName:f,folderPath:u,documentTemplateType:l,templateUrl:a||""}).toString()}throw new Error("document type is not valid, here are the valid type: 1 - Word, 2 - Excel,\n    3 - PowerPoint, 4 - OneNote, 5 - Excel Survey, 7 - ExcelForm, 8 - Visio")}},function(e,t,n){"use strict";n.d(t,"t",function(){return o});n.d(t,"e",function(){return u});var r,i=n(2),s=n(363);(function(e){e[e.previewColumnFormatter=0]="previewColumnFormatter";e[e.saveColumnFormatter=1]="saveColumnFormatter";e[e.previewViewFormatter=2]="previewViewFormatter";e[e.saveViewFormatter=3]="saveViewFormatter"})(r||(r={}));var o=new i.e("updateFormatter"),u=Object(s.e)({operationTypeFacet:o})},function(e,t,n){"use strict";n.d(t,"n",function(){return o});n.d(t,"e",function(){return u});n.d(t,"t",function(){return a});var r=n(2),i=n(526),s=n(741),o=new r.e("removeItemsFromSharedList"),u=new i.e("removeItemsFromSharedList"),a=Object(s.e)({operationTypeFacet:o,progressKeyFacet:u})},function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=n(2),i=n(363),s=new r.e("createFreshView"),o=Object(i.e)({operationTypeFacet:s})}],Array(96),[function(e,t,n){"use strict";n.d(t,"t",function(){return h});n.d(t,"e",function(){return p});var r=n(0),i=n("react-lib"),s=n(121),o=n(1533),u=n(813),a=n(419),f=n(4235);var l=n(32),c=n(317),h=[],p=Object(l.t)(function(e,t){var n=t.items,l=void 0===n?h:n,p=t.directionalHint,d=void 0===p?s.e.rightTopEdge:p,v=t.isBeakVisible,m=void 0!==v&&v,g=t.isOpen,y=t.contextMenuAs,b=Object(r.__rest)(t,["items","directionalHint","isBeakVisible","isOpen","contextMenuAs"]),w=y?Object(c.e)(y,o.e):o.e;return i.createElement(u.e,{commands:t.commands},function(e){var n=e.menuItems,s=Object(a.e)(l,(function e(t,n){var i=n.target,s=n.preserveIcons,o=void 0!==s&&s;return t.map(function(t){var s=t.subMenuProps,u=t.onClick,a=t.hasLaunchTarget,l=Object(r.__rest)(t,["subMenuProps","onClick","hasLaunchTarget"]);return Object(r.__assign)(Object(r.__assign)({},l),{name:t.iconProps&&"More"===t.iconProps.iconName?f.e:t.name,icon:void 0,iconProps:o?t.iconProps:void 0,subMenuProps:s?Object(r.__assign)(Object(r.__assign)({},s),{items:e(s.items,n)}):void 0,onClick:a&&u?function(e){e&&i&&(i instanceof Event?e.target=i.target:i instanceof Element&&(e.target=i));u(e)}:u})})})(n,t));return g?i.createElement(w,Object(r.__assign)({},b,{items:s,directionalHint:d,isBeakVisible:m})):null})})},,function(e,t,n){"use strict";n.d(t,"e",function(){return y});var r=n(189),i=n("react-lib"),s=n(1441),o=n(6),u=n(20),a=n(598),f=n(160),l=n(173);var c=n(275),h=n(74),p=n(866),d=n(867),v=n(845),m=n(846),g=n(843),y=Object(p.e)({key:c.r,name:r.f,fieldName:"",isCollapsible:!1,minWidth:445,maxWidth:445,sortProps:h.r},[d.e,g.e,function(e,t){var n=t.itemKey,r=t.renderer,c=e.demandItemFacet(o.M,n),h=c&&e.demandItemFacet(o.O,c.itemKey)||"",p=h?(function(e){for(var t=[],n=new f.e(e),r=0,i=n.segments.slice(1);r<i.length;r++){var s=i[r];try{t.push(decodeURIComponent(s))}catch(e){t.push(s)}}return t})(h):[],d=c&&h?Object(l.r)(e,i.createElement(a.e,{itemKey:c.itemKey})):null;return{renderer:function(e,t,n){var o=r?r(e,t,n):null;return i.createElement(i.Fragment,null,o?i.createElement(i.Fragment,{key:"content"},o):null,d?i.createElement(u.n,{key:"path",action:d},function(e){var t=e.execute,n=e.isAvailable?function(e){t({event:e}).catch(function(){});e.preventDefault();e.stopPropagation()}:void 0;return i.createElement(s.e,{displayPathSegments:p,parentLink:h,onClick:n})}):null)}}},v.e,m.e])}],Array(29),[function(e,t,n){"use strict";n.d(t,"e",function(){return c});var r=n(0),i=n(71),s=n(10),o=n(78),u=n(237),a=n(51),f=n(437),l=n(47);var c=Object(i.e)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([559],4009)];case 1:return[2,e.sent().SortActionExecutor]}})})},function(e,t){var n=t.sortFieldKey,i=t.itemSetKey,s=t.isAscending,u=e.demandItemFacet(o.e,i);if(!u)return!1;var c=Object(a.e)(e).itemsScopeItemKey;if(!c)return!1;var h=o.e.serialize(Object(r.__assign)(Object(r.__assign)({},u),{sortFieldKey:n,sortAscending:s})),p=e.demandItemFacet(f.e,h),d=f.e.evaluate(p)(e,{itemKey:h,itemsScopeItemKey:c,isAvailable:!0}),v=d.itemKey;if(!d.isAvailable)return!1;var m=e.demandItemFacet(l.n,c),g=m&&m.itemKey;return!!v&&v!==g},function(e,t){var n=t.sortFieldKey,r=t.itemSetKey,i=t.isAscending,a=e.demandItemFacet(o.e,r);if(!a)return!1;var f=e.demandItemFacet(s.u,r),l=f&&e.demandItemFacet(u.e,f.columnKey),c=l&&l.internalName||a.sortFieldKey,h=f?f.isAscending:a.sortAscending;return c===n&&h===i})},,,function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(2).e)("graphTokenProvider")}],Array(39),[function(e,t,n){"use strict";n.d(t,"e",function(){return S});var r=n(0),i=n(43),s=n(90),o=n(4563),u=n(231),a=n(1),f=n(233),l=n(122),c=n(2474),h=n(143),p=n(2),d=n(61),v=n(874),m=n(106),g=n(6),y=n(12),b=n(3880),w=n(82),E=n(160);function S(e){var t=this,n=e.itemKey,S=e.options.sourceEntries,x=i.e.deserialize(n),T=x.webAbsoluteUrl,N=x.listFullUrl,C=Object.keys(S)[0],k=S[C],L=k.progressItemKey,A=k.conflictResolution;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,S,k,O,M,_,D,P,H,B,j,F,I,q,R,U,z,W,X,V,$,J,K,Q,G,Y,Z;return Object(r.__generator)(this,function(ee){switch(ee.label){case 0:t=e(Object(u.n)({webAbsoluteUrl:T,listFullUrl:N})),S=t.dataRequestor,k=t.hasDigest;if(!t.hasTokenProvider)return[3,1];M=void 0;return[3,3];case 1:return[4,e(Object(u.e)({url:T||N,disallowCookies:!k}))];case 2:M=ee.sent();ee.label=3;case 3:O=M;_=e(Object(l.e)({sourceFile:c.t},C)).sourceFile;D=e(Object(l.e)({folderPath:a.pe},n)).folderPath,P=void 0===D?x.rootFolder:D;if(!_)throw new w.e({code:"MissingSourceFileForUpload",message:"No source file for upload."});if(!P)throw new w.e({code:"MissingTargetFolderPathForUpload",message:"No path information for target folder."});H=Object(v.r)({webAbsoluteUrl:T,listOrItemFullUrl:N});B=new f.e(void 0);j=B.debounce(function(t){var n;L&&e(Object(h.e)({items:(n={},n[L]=Object(p.n)({progressSize:d.y},{progressSize:{current:t}}),n)}))},300,{leading:!1});F=e(Object(m.e)(function(e){return e.demandItemFacet(a.Ue,s.e.serialize({webAbsoluteUrl:T,listFullUrl:N}))}));I=F&&F.contentTypesEnabled&&F.templateType!==y.t.mySiteDocumentLibrary;(q=new o.e({authToken:O,dataRequestor:S,parentItemKey:"",targetItemKey:"",fileUpload:_,iconName:"",serverRelativeItemUrl:P,webApiUrl:H,onProgress:j,expandAllItemFields:I})).nameConflictBehavior="replace"===A?1:0;L&&e(Object(h.e)({items:(Y={},Y[L]=Object(r.__assign)({},d.y.pack({total:_.size,current:0})),Y)}));R=q.start();U=e(Object(m.e)(function(e){return e.demandItemFacet(d.i,L)}));z=U?U.token.subscribe(function(){q.abort()}):void 0;ee.label=4;case 4:ee.trys.push([4,6,7,8]);return[4,R];case 5:ee.sent();return[3,8];case 6:W=ee.sent();q.abort();throw Object(b.e)(W);case 7:z&&z();q.dispose();return[7];case 8:X=q.item;V=X.properties;$=V&&V.ID||X.id;J=V&&V.uniqueId;K=new E.e(T).authority;Q=K&&X.id?""+K+X.id:"";G=i.e.serialize({webAbsoluteUrl:T,listFullUrl:N,itemId:$});e(Object(h.e)({items:(Z={},Z[G]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},g.h.pack(X.displayName)),X.id?a.pe.pack(X.id):{}),J?a.Sn.pack(J):{}),g.M.pack({itemKey:n})),Q?g.i.pack(Q):{}),Z)}));return[2,{itemKey:G}]}})})}}},,,function(e,t,n){"use strict";n.r(t);n.d(t,"sharePointItemByFullUrlAddon",function(){return M});var r=n(0),i=n(16),s=n(246),o=n(200),u=n(160),a=n(264),f=n(622),l=n(871),c=n(1014),h=n(90),p=n(143),d=n(307),v=n(675),m=n(43),g=n(78),y=n(333),b=n(1),w=n(6),E=n(10),S=n(346),x=n(301),T=n(369),N=n(122),C=n(439),k=n(452),L=n(350),A=n(400),O=n(857),M=Object(i.t)(function(){return function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(t){e(Object(p.t)({keyFacet:c.e,facets:[m.e,w.h,w.d,b.Sn,w.m,b.pe,E.t,b.Ge,C.e,C.t,b.ht,w.i]}));e(Object(s.r)(c.e,d.e)(Object(i.i)({maxParallelOperationCount:8})(_)));return[2]})})}});function _(e){var t=this,n=e.itemKey,i=c.e.deserialize(n);return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,s,p,d,w,C,M,D,P,H,B,j,F,I,q,R,U,z,W,X,V,$;return Object(r.__generator)(this,function(J){switch(J.label){case 0:t=new o.e({publisher:_});s=!1;p=new u.e(i.itemFullUrl);d=e((function(e,t,n){return function(r){var i,s=e.itemFullUrl,o=["File_x0020_Type","FileRef","FileLeafRef","_ip_UnifiedCompliancePolicyUIAction","_ComplianceFlags","CheckoutUser","CheckedOutUserId","Created_x0020_Date.ifnew"];i=[new u.e(s).path];var a=r(Object(N.e)({contentTypeId:b.d},c.e.serialize(e)));if(t&&t.length>0&&a&&a.contentTypeId)for(var f=0,l=t;f<l.length;f++){var h=l[f];if(h.contentTypeId===a.contentTypeId&&h.Fields)for(var p=0,d=h.Fields.split(",");p<d.length;p++){var v=d[p];"Modified_x0020_By"===v?o.push("Editor"):"Created_x0020_By"===v?o.push("Author"):o.push(v)}}var m=Object(T.r)({itemRefs:i,recurseInFolders:!0,pageSize:1,fieldNames:o});return{webAbsoluteUrl:"",listFullUrl:s,currentPageContext:void 0,qosName:n,viewXml:m,rootFolder:void 0,postDataContext:{needUpdatePageContext:!0,needsSchema:!0}}}})(i,void 0,"getSPItemByFullUrl"));J.label=1;case 1:J.trys.push([1,3,,4]);return[4,e(Object(S.e)({getItemContext:d}))];case 2:w=J.sent();C=w.WebUrl||v.i(decodeURIComponent(w.HttpRoot||""))||p.authority;M=""+new u.e(C).authority+(w.ListUrl||decodeURIComponent(w.listUrlDir||""));D={webAbsoluteUrl:C,listFullUrl:M,rootFolder:""};P=e(Object(x.t)({serverData:w,itemSetKey:D,currentPageContext:d.currentPageContext,contentTypes:void 0,isItemSetRequest:s})),H=P.itemResolver,B=P.childKeys,j=P.pageContext;F=B[0];I=g.e.serialize(D);F&&t.mapKeys({mappings:(V={},V[F]=c.e.serialize(i),V)});if(j){q=y.e.serialize({webAbsoluteUrl:C,listFullUrl:M});e(Object(N.e)({pageContext:b.ln},q)).pageContext||e(Object(f.e)({itemKey:q,options:{pageContext:j}}))}t.merge(H);if(m.e.matches(F)){R=m.e.deserialize(F);(U=e(Object(k.t)({webAbsoluteUrl:R.webAbsoluteUrl,listFullUrl:R.listFullUrl,serverData:w,pageContext:j})))&&t.merge(U.itemResolver)}z=h.e.serialize({webAbsoluteUrl:C,listFullUrl:M});t.resolveItems({items:($={},$[m.e.serialize(D)]=Object(r.__assign)({},E.t.pack({itemKey:I})),$[n]=Object(r.__assign)({},a.n.pack(m.e)),$[z]=Object(r.__assign)({},Object(l.e)(w,j)),$)});e(t.execute());e(Object(L.e)({itemSetKey:I,serverData:w,isItemSetRequest:s}));return[3,4];case 3:W=J.sent();X=Object(O.e)(W);throw new A.e({facets:X,innerError:W});case 4:return[2]}})})}}},function(e,t,n){"use strict";n.d(t,"t",function(){return r});n.d(t,"e",function(){return i});n.d(t,"n",function(){return s});var r=50,i=8,s=2},function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(5),i=new r.e("quickAccessItemSetKeyFacet",{tenantRootUrl:Object(r.s)()})},,,function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(5),i=new r.e("commands",{endpoint:Object(r.s)(),driveId:Object(r.s)({shouldNormalizeToEmpty:!0})})},function(e,t,n){"use strict";n.d(t,"e",function(){return i});n.d(t,"t",function(){return s});n.d(t,"n",function(){return o});n.d(t,"r",function(){return u});n.d(t,"i",function(){return a});n.d(t,"s",function(){return f});n.d(t,"o",function(){return l});n.d(t,"u",function(){return c});n.d(t,"a",function(){return h});n.d(t,"f",function(){return p});var r=n(2),i=new r.e("addToOneDrive"),s=new r.e("createFolder"),o=new r.e("createLink"),u=new r.e("delete"),a=new r.e("download"),f=new r.e("invite"),l=new r.e("move"),c=new r.e("officeLens"),h=new r.e("rename"),p=new r.e("upload")},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=n(244).e.isFeatureEnabled({ODC:"EnableDefaultSortOrderFromBackend"})},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(2).e)("driveItemResponse")},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(2).e)("restricted")},function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(5),i=new r.e("topCollaboratorSetKeyFacet",{endpoint:Object(r.s)()})},function(e,t,n){"use strict";n.d(t,"t",function(){return o});n.d(t,"e",function(){return u});var r=n(2),i=n(526),s=n(741),o=new r.e("updateCheckoutState"),u=new i.e("checkout");Object(s.e)({operationTypeFacet:o,progressKeyFacet:u})},function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=n(2),i=n(526),s=new r.e("updatePublishState"),o=new i.e("publish")},function(e,t,n){"use strict";n.d(t,"e",function(){return u});n.d(t,"t",function(){return a});n.d(t,"n",function(){return f});var r=n(2),i=n(363),s=n(526),o=n(5),u=new r.e("editPinnedItem"),a=new o.e("editPinnedItemProgressItem",{itemKey:Object(o.s)(),editType:Object(o.i)()}),f=new s.e("editPinnedItemProgress",function(e,t){var n=Object.keys(t.itemEditTypeMap)[0],r=t.itemEditTypeMap[n].editType;return a.serialize({itemKey:n,editType:r})});Object(i.e)({operationTypeFacet:u})},function(e,t,n){"use strict";n.d(t,"e",function(){return r});function r(e){for(var t=e,n="",r=0,i=void 0,s=0,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";t.charAt(0|s)||(o="=",s%1);n+=o.charAt(63&r>>8-s%1*8)){if((i=t.charCodeAt(s+=3/4))>255)throw new Error("Unable to obtain default share URL: btoa failed");r=r<<8|i}return n}},function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=n(2),i=n(363),s=new r.e("updateView"),o=Object(i.e)({operationTypeFacet:s})},,,,,,,,function(e,t,n){"use strict";n.d(t,"n",function(){return i});n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=n(2),i=new r.e("shortcutExistedAlready"),s=new r.e("nestedDescendantShortcutExists"),o=new r.e("nestedAscendantShortcutExists")},,function(e,t,n){"use strict";n.r(t);n.d(t,"hasManageListsPermission",function(){return m});n.d(t,"modifyColumn",function(){return g});var r=n(0),i=n(78),s=n(204),o=n(1046),u=n(16),a=n(122),f=n(1),l=n(10),c=n(200),h=n(106),p=n(2095),d=n(85),v=n(90);function m(e,t){var n=t.itemSetKey;if(n){var r=e.demandItemFacet(f.Ue,v.e.serialize({webAbsoluteUrl:n.webAbsoluteUrl,listFullUrl:n.listFullUrl}));return!!(r&&r.permissions&&r.permissions.manageLists)}return!1}var g=Object(u.i)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,n=e.options.columnModifyTypeMap;return function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var u,v,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_;return Object(r.__generator)(this,function(D){switch(D.label){case 0:if(!(u=e(Object(a.e)({setKey:i.e},t)).setKey))return[3,3];v=Object.keys(n)[0];g=n[v],y=g.modifyType,b=g.targetIndex;if(!(w=u.viewKey?s.e.serialize(u.viewKey):void 0))return[3,3];if(!(E=e(Object(a.e)({currentDerivedView:f.m},w)).currentDerivedView))return[3,3];S=E.getEffectiveFieldNames();if(!(x=e(Object(a.e)({internalName:f.Te},v)).internalName))return[3,3];if((T=S.indexOf(x))<0||1===y&&0===T||2===y&&T===S.length-1)return[2];N=E.isDirty();switch(y){case 0:E.updateField(x);break;case 1:E.updateField(x,T-1);break;case 2:E.updateField(x,T+1);break;case 3:E.updateField(x,b)}C=e(Object(h.e)(function(e){return m(e,{itemSetKey:u})}));k=!1;return C?[4,e(Object(p.e)({items:(A={},A[o.e.serialize({webAbsoluteUrl:u.webAbsoluteUrl,listFullUrl:u.listFullUrl})]={views:(O={},O[w]={shouldSaveViewFieldsOnly:!0},O),qosName:"autoSaveModifyColumn"},A)})).then(function(){N||(E.baseViewXml=E.getEffectiveViewXml());k=!0},function(e){d.e.logError(e,{eventName:"ModifyColumn",feature:"ColumnFieldsAutoSave",columnFieldName:x,modifyType:y,errorCode:e.errorData.code,correlationId:e.errorData.correlationId,status:e.errorData.status});throw e})]:[3,2];case 1:D.sent();D.label=2;case 2:L=new c.e;k||L.resolveItems({items:(M={},M[w]=Object(r.__assign)({},f.Dt.pack(!0)),M)});L.invalidateItems({items:(_={},_[t]=[l.e],_[w]=[f.m],_)});e(L.execute());D.label=3;case 3:return[2]}})})}})}],Array(233),[function(e,t,n){"use strict";n.r(t);n.d(t,"getSPFilterOptionSetHandler",function(){return E});var r=n(0),i=n(1),s=n(231),o=n(1236),u=n(180),a=n(874);function f(e){var t=e.webAbsoluteUrl,n=e.listFullUrl,r=e.fieldInternalName,i=e.viewId,s=e.rootFolder,f=e.excludeFieldFilteringHtml,l=e.filterParams,c=e.currentUserDisplayName,h=Object(a.e)({webAbsoluteUrl:t,listFullUrl:n}).segment("RenderListFilterData").parameter("FieldInternalName",r||"");i&&(h=h.parameter("ViewId",i));s&&(h=h.parameter("RootFolder",{raw:Object(o.e)(s)}));f&&(h=h.parameter("ExcludeFieldFilteringHtml",!0));if(l){var p=u.default.getFilterParams(l,!0,{replaceMeFormatFilterWithCurrentUser:!0,currentUserDisplayName:c});h=h.rawParameter(p)}return h.toString()}var l=n(2131),c=n(1374),h=n(43),p=n(333),d=n(237),v=n(33),m=n(16),g=n(122),y=n(200),b=n(268),w=n(58),E=Object(m.i)({maxParallelOperationCount:8})(function e(t){var n=this,o=t.itemKey,u=c.e.deserialize(o);return function(t){return Object(r.__awaiter)(n,void 0,void 0,function(){var n,a,c,m,E;return Object(r.__generator)(this,function(S){switch(S.label){case 0:n=t((function(e){var t=e.itemSetKey,n=e.fieldKey;return function(e){var r=e(Object(b.e)({spDataSourceConfiguration:i.Ut})).spDataSourceConfiguration,s=r&&r.ensureAuthToken,o=h.e.serialize(t),u=e(Object(g.e)({folderPath:i.pe},o)),a=e(Object(g.e)({internalName:i.Te,mappedColumnFieldType:i.Ke,isCalculated:i.Ce},d.e.serialize(n))),f=u&&u.folderPath,l=a&&a.internalName&&a.internalName,c=a&&a.mappedColumnFieldType===v.e.Taxonomy,m=a&&a.isCalculated,y=p.e.serialize({webAbsoluteUrl:t.webAbsoluteUrl,listFullUrl:t.listFullUrl}),E=e(Object(g.e)({pageContext:i.ln},y)).pageContext,S=t.viewKey&&t.viewKey.viewId,x=S===w.e.Empty?E&&E.viewId:S;return{webAbsoluteUrl:t.webAbsoluteUrl,listFullUrl:t.listFullUrl,rootFolder:f,ensureAuthToken:s,fieldInternalName:l,isCalculatedField:m,filterParams:t.filterParams,excludeFieldFilteringHtml:c,viewId:x,currentUserDisplayName:E&&E.userDisplayName}}})({itemSetKey:u.itemSetKey,fieldKey:u.fieldKey}));return[4,t((x=n,function(e){return e(Object(s.t)({webAbsoluteUrl:x.webAbsoluteUrl,listFullUrl:x.listFullUrl,method:"POST",url:f(x),parseResponse:function(e){return e},qosName:"getFilterData",noRedirect:!0}))}))];case 1:a=S.sent();c=l.e.getFilterData(a,n.fieldInternalName||"",n.isCalculatedField);(m=new y.e({publisher:e})).resolveItems({items:(E={},E[o]=Object(r.__assign)({},i.he.pack(c)),E)});t(m.execute());return[2]}var x})})}})},,,,function(e,t,n){"use strict";n.d(t,"e",function(){return v});var r=n(0),i=n("react-lib"),s=n(78),o=n(204),u=n(32),a=n(134),f=n(22),l=n(20),c=n(27),h=new(n(21).e)("filterActionControl"),p=n(70),d=Object(p.e)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([556,"deferred.odsp-common","deferred.odsp-datasources","ondemand.resx-ondemand"],4930)];case 1:return[2,e.sent().FilterPanel]}})})}),v=Object(u.t)(function(e,t){var n=t.columnKey,u=t.itemSetKey,p=t.isToggled,v=e.demandItemFacet(h,u),m=e.demandItemFacet(s.e,u),g=m&&m.viewKey&&o.e.serialize(m.viewKey),y=h.evaluate(v)(e,{viewKey:g,isAvailable:!0}).isAvailable,b=Object(l.o)(function(e){return i.createElement(d,{onClose:function(){e.reject(new a.e)},onComplete:function(){e.resolve()},columnKey:n,itemSetKey:u})});return i.createElement(f.e,Object(r.__assign)({isAvailable:y,isToggled:p,onExecute:b},Object(c.t)(e,{itemKey:u,engagement:{name:"LaunchFilterPanel",isIntentional:!0}})))})},,function(e,t,n){"use strict";n.d(t,"e",function(){return m});n.d(t,"t",function(){return g});var r=n(0),i=n(272),s=n(6),o=n(10),u=n(200),a=n(692),f=n(1127),l=n(5),c=new l.e("userById",{id:Object(l.s)(),endpoint:Object(l.s)()}),h=n(190),p=n(3895),d=n(3031),v=n(2559);function m(e){var t=e.itemKey,n=e.driveItemKey,l=e.parentFolderItemKey,h=e.setItemKey,y=e.driveItemResponse,b=e.endpoint,w=e.getDriveItemFacets,E=void 0===w?v.e:w,S=e.shouldInvalidateItemSetOnChildItemRename,x=void 0===S?void 0:S;return function(e){var v,w=new u.e({publisher:m}),S=a.e.serialize({driveItemKey:n}),T=void 0;if(h){var N=Object(i.e)().forFacet(s.l).thenInvalidate(h,o.e).forFacet(s.M).thenInvalidate(h,o.e);x&&!x(b)||(N=N.forFacet(s.h).thenInvalidate(h,o.e));T=N.pack()}w.merge(e(E({itemKey:t,driveItemKey:n,driveItem:y,endpoint:b,parentFolderItemKey:l})).itemResolver);w.resolveItems({items:(v={},v[t]=Object(r.__assign)(Object(r.__assign)({},s.e.pack({itemKey:S})),T),v)});if(y.lastModifiedBy){if(A=y.lastModifiedBy.user){var C=A.id&&c.serialize({id:A.id,endpoint:b});if(C=A.email&&d.e.serialize({email:A.email,endpoint:b})){var k=g({itemKey:t,personFacet:s.A,userKey:C,user:A}).itemResolver;w.merge(k)}}}if(y.createdBy){var L=void 0;if((A=y.createdBy.user)&&A.email&&(L=d.e.serialize({email:A.email,endpoint:b}))){k=g({itemKey:t,personFacet:f.r,userKey:L,user:A}).itemResolver;w.merge(k)}}if(y.remoteItem&&y.remoteItem.shared&&y.remoteItem.shared.sharedBy&&y.remoteItem.shared.sharedBy.user){var A,O=void 0;if((A=y.remoteItem.shared.sharedBy.user).email&&(O=d.e.serialize({email:A.email,endpoint:b}))){k=g({itemKey:t,personFacet:p.e,userKey:O,user:A}).itemResolver;w.merge(k)}}return{itemResolver:w}}}function g(e){var t,n,i=e.itemKey,o=e.personFacet,a=e.userKey,f=e.user,l=new u.e({publisher:g});l.resolveItems({items:Object(r.__assign)((t={},t[a]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},s.h.pack(f.displayName)),h.e.pack(f.email)),h.i.pack(f.id)),t),o&&(n={},n[i]=Object(r.__assign)({},o.pack({itemKey:a,displayValue:f.displayName})),n))});return{itemResolver:l}}}],Array(31),[function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(21).e)("itemAutoRefreshControl")},,,,function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(21).e)("openSyncIssuesActionControl")}],Array(43),[function(e,t,n){"use strict";n.r(t);n.d(t,"spProjectedUploadedItemSetAddon",function(){return m});var r=n(14),i=n(386),s=n(29),o=n(78),u=n(43),a=n(10),f=n(1346),l=n(6),c=n(1),h=n(4166),p=n(1393),d=n(16),v=Object(r.t)()(function(){return function(e){return function(e,t){var n=t.itemKey,r=t.itemKeys,i=Object(s.e)(e,{isProjectedUploadedItemSetEnabled:c.V}).isProjectedUploadedItemSetEnabled;if(void 0!==i&&i){var p=e.demandItemFacet(o.e,n);if(p){var d=(function(e,t,n){var r=[],i=f.e.serialize({itemSetKey:t}),s=e.demandItemFacet(a.e,i);e.demandItemFacet(h.e,f.e.serialize({itemSetKey:t}));if(!s||s.itemKeys&&0===s.itemKeys.length)return;for(var o={},c={},p=0,d=s.itemKeys;p<d.length;p++){var v=d[p];r.push(v);var m=e.demandItemFacet(u.e,v);if(m){m.itemId&&(o[m.itemId]=!0);m.rootFolder&&(c[m.rootFolder]=!0)}o[v]=!0}if(n)for(var g=0,y=n;g<y.length;g++){var b=y[g],w=e.demandItemFacet(u.e,b);if(w){if(e.demandItemFacet(l.m,b)){if(w.rootFolder&&w.rootFolder in c)continue}else if(w.itemId&&w.itemId in o)continue}r.push(b)}return r})(e,p,r);return d?{itemKeys:d}:{}}}return{}}}}),m=Object(d.t)(function(){return function(e){e(Object(i.e)(o.e,p.e)(Object(r.t)()(v)))}})},function(e,t,n){"use strict";n.d(t,"t",function(){return p});n.d(t,"e",function(){return d});var r=n(0),i=n(69),s=n(203),o=n(2077),u=n(134),a=n(2430),f=n(1168),l=n(1),c=n(3881),h=n(268);function p(e){throw new f.e({facets:Object(r.__assign)({},s.f.pack({maxFileSize:e}))})}function d(e){return function(t){if(i.n.isCanceled(e))return new u.e;if(e instanceof a.e)return new f.e({facets:t((p=e,function(e){if(p.errorType===o.e.conflict||p.errorType===o.e.similarNameExists){var t=e(Object(h.e)({enableRenameOnUploadConflict:l.G})).enableRenameOnUploadConflict;switch(p.errorType){case o.e.conflict:return Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},s.m.pack({})),s.t.pack(!!t)),s.n.pack(!0)),s.s.pack({supportsRename:!!t}));case o.e.similarNameExists:return Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},s.S.pack({})),s.t.pack(!0)),s.n.pack(!1))}}switch(p.errorType){case o.e.accessDenied:return Object(r.__assign)({},s.e.pack({}));case o.e.disconnected:return Object(r.__assign)({},s.y.pack({}));case o.e.emptyFileOrFolder:case o.e.emptyFileOrFolderForDocLib:return Object(r.__assign)({},s.o.pack({}));case o.e.folderUploadNotSupported:return Object(r.__assign)({},s.l.pack({}));case o.e.invalidName:return Object(r.__assign)({},s.h.pack({}));case o.e.lockMismatch:return Object(r.__assign)({},s.d.pack({}));case o.e.malwareDetected:return Object(r.__assign)({},s.v.pack({}));case o.e.overQuota:return Object(r.__assign)({},s.w.pack({}));case o.e.targetFolderMissing:return Object(r.__assign)({},s.x.pack({}));case o.e.throttled:return Object(r.__assign)({},s.T.pack({}));case o.e.versionMismatch:return Object(r.__assign)({},s.N.pack({}))}return Object(r.__assign)({},s.E.pack({}))})),innerError:e});if(Object(c.t)(e)){var n=t(Object(h.e)({enableRenameOnUploadConflict:l.G})).enableRenameOnUploadConflict;return new f.e({facets:Object(r.__assign)(Object(r.__assign)({},"-2130575257"===e.code?Object(r.__assign)({},s.s.pack({supportsRename:!!n})):Object(r.__assign)({},s.E.pack({}))),l.Wt.pack(e)),message:Object(c.e)(e)})}var p;return e}}},function(e,t,n){"use strict";n.d(t,"t",function(){return r});n.d(t,"e",function(){return i});function r(e){return!!e&&("status"in e||!(!e.message||"object"!=typeof e.message))}function i(e){return e&&e.message&&("object"==typeof e.message?e.message.value:e.message.toString())||""}},,,,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(5),i=new r.e("siteLogoItemKeyFacet",{webAbsoluteUrl:Object(r.s)()})},,function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(593),i=function(e){var t=e.replace(".",""),n=Object.keys(r.e);for(var i in n)if(r.e.hasOwnProperty(n[i])){var s=n[i];if(r.e[s].indexOf(t)>-1)return s}}},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(2).e)("hasPdfFacet")},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(2).e)("coverImage")},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(2).e)("tags")},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(2).e)("sharedBy")},function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r,i;(function(e){e[e.MalwareDetected=0]="MalwareDetected";e[e.ThisFileIsCheckedOut=1]="ThisFileIsCheckedOut";e[e.DLPBlocked=2]="DLPBlocked";e[e.MissingMetaData=3]="MissingMetaData";e[e.DLPWarning=4]="DLPWarning";e[e.AwaitingApproval=5]="AwaitingApproval";e[e.Trending=6]="Trending";e[e.New=7]="New";e[e.NeedsRepublishing=8]="NeedsRepublishing"})(r||(r={}));(function(e){e[e.Mail=0]="Mail";e[e.CalendarEvent=1]="CalendarEvent";e[e.Teams=2]="Teams"})(i||(i={}))},function(e,t,n){"use strict";n.d(t,"n",function(){return i});n.d(t,"e",function(){return s});n.d(t,"t",function(){return o});var r=n(5),i=new r.e("SharedByPersonKeyFacet",{displayName:Object(r.s)(),email:Object(r.s)()}),s=new r.e("dateSharedGroupKeyFacet",{relativeTime:Object(r.s)(),sharedDateTime:Object(r.s)()}),o=new r.e("relativeTimeGroupKeyFacet",{relativeTime:Object(r.s)()})},,function(e,t,n){"use strict";n.d(t,"e",function(){return g});var r=n(0),i=n(16),s=n(200),o=n(692),u=n(787),a=n(1611),f=n(2964),l=n(850),c=n(371),h=n(272),p=n(3799),d=n(3031),v=n(137),m=n(6),g=Object(i.n)({maxParallelOperationCount:1,maxItemCountPerBatch:20,areSameBatch:function(e,t){var n=o.e.deserialize(e.itemKey).driveItemKey,r=n.endpoint,i=n.driveId,s=o.e.deserialize(t.itemKey).driveItemKey,u=s.endpoint,a=s.driveId;return!!i&&!!a&&i===a&&r===u}})(function e(t){var n=this,i=t.items;return function(t){return Object(r.__awaiter)(n,void 0,void 0,function(){var n,p,d,g,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q,R,U,z,W,X,V,$;return Object(r.__generator)(this,function(J){switch(J.label){case 0:n=Object.keys(i);p=n[0];d=o.e.deserialize(p);g=d.driveItemKey,E=g.endpoint,S=g.driveId;if(!E)throw new Error("No endpoint to determine activity items.");x=n.map(function(e){return o.e.deserialize(e).driveItemKey.itemId});T=Object(u.n)({endpoint:(K=E,K.replace("2.1","2.0")),driveId:S});N=T+"/ExtendedActivitiesForItems";C={driveItems:x,badgeOnly:!0};return[4,t(Object(a.n)({url:N,method:"POST",body:C,qosName:"ItemActivityFieldDataSource.extendedActivitiesForItems",endpoint:E}))];case 1:if((k=J.sent()).value){L=(function(e){for(var t={},n=0,r=e;n<r.length;n++){var i=r[n],s=i.driveItemId;if(s){(t[s]||(t[s]=[])).push(i)}}return t})(k.value);A=0;O=0;M=0;_=0;D=new s.e({publisher:e});for(P=0,H=n;P<H.length;P++){B=H[P];A++;j=o.e.deserialize(B);F=j.driveItemKey.itemId;I=F&&L[F];q=v.e.serialize(j.driveItemKey);R=void 0;if(I){U=new f.e;z=U.processResponse({item:{name:F||"",relativePath:"",absolutePath:"",isFolder:!1,graphItemUrl:N},response:{value:I,"@odata.nextLink":""}}).activities;W=y(z);if(X=b(z)){M++;O++;if(!W){_++;V=w(X,B).itemResolver;D.merge(V);R=X}}}D.resolveItems({items:($={},$[B]=Object(r.__assign)({},l.e.pack(R)),$[q]=Object(r.__assign)({},Object(h.e)().forFacet(m.e).thenInvalidate(B,l.e).pack()),$)})}t(D.execute());t(Object(c.e)({name:"ItemActivityField.View",extraData:{activityFieldProcessedItemCount:A,activityFieldEligibleItemCount:O,activityFieldActiveItemCount:M,activityFieldBadgedItemCount:_,activityFieldBadgedPercent:A?Math.round(_/A*100):0},isIntentional:!1}))}return[2]}var K})})}});function y(e){var t=e[0];return!!t&&1===t.actors.length&&t.actors[0].self&&!t.type||!1}function b(e){var t=e[0],n={};if(t)for(var i=0,s=t.actors;i<s.length;i++){(l=s[i]).id&&(n[l.id]=!0)}for(var o=Object(r.__assign)(Object(r.__assign)({},t),{actors:Object(r.__spreadArrays)(t.actors||[])}),u=1;u<e.length;u++)for(var a=0,f=e[u].actors;a<f.length;a++){var l;if("string"==typeof(l=f[a]).id&&!n[l.id]){o.actors.push(l);n[l.id]=!0}}return o||t}function w(e,t){var n=new s.e({publisher:w}),i=o.e.deserialize(t).driveItemKey,u=(function(e){var t=e.actors,n=e.action.mention&&e.action.mention.mentionees||[],i=e.action.share&&e.action.share.recipients||[],s=e.action.commentResponse&&e.action.commentResponse.commentAuthor,o=Object(r.__spreadArrays)(t,n,i);s&&o.push(s);return o})(e);if(u.length>0){var a=E(u,i).itemResolver;n.merge(a)}return{itemResolver:n}}function E(e,t){for(var n=new s.e({publisher:E}),r=0,i=e;r<i.length;r++){var o=S(i[r],t).itemResolver;n.merge(o)}return{itemResolver:n}}function S(e,t){var n=new s.e({publisher:S}),r={itemKey:v.e.serialize(t),userKey:d.e.serialize({email:e.email||"",endpoint:t.endpoint}),user:{displayName:e.displayName,email:e.email}},i=Object(p.t)(r).itemResolver;n.merge(i);return{itemResolver:n}}},function(e,t,n){"use strict";n.d(t,"t",function(){return d});n.d(t,"e",function(){return v});var r=n(0),i=n(14),s=n(42),o=n(96),u=n(137),a=n(1112),f=n(10),l=n(143),c=n(3350),h=n(325),p=n(713),d=Object(i.t)()(function(){return function(e){return function(e,t){var n,i,o=Object(s.e)(e),f={},l=e.demandItemFacet(a.e,t.itemKey),d=e.demandItemFacet(u.e,t.itemKey),m=e.demandItemFacet(c.e,t.itemKey,{suppressGetItems:!0});if(m&&t.itemKey){i={driveItemKey:m,sortBy:"",isAscending:!0};var g=a.e.serialize(i);return Object(r.__assign)(Object(r.__assign)({},v(e,{itemSetKey:g,parentItemKey:u.e.serialize(i.driveItemKey),stageItem:t.stageItem})),{itemKey:h.e.serialize({localItemKey:t.itemKey,remoteItemKey:g})})}if(l){n=v(e,{itemSetKey:a.e.serialize(l),parentItemKey:u.e.serialize(l.driveItemKey),stageItem:t.stageItem});f={itemKey:t.itemKey}}else{f=(g=(i=(function(e,t){var n=t.folderItemKey,i=t.currentItemSetKey;if(i&&n){var s=e.demandItemFacet(a.e,i),o=e.demandItemFacet(u.e,n);if(s&&o){var f=o.endpoint,l=o.driveId,c=o.itemId;return Object(r.__assign)(Object(r.__assign)({},s),{driveItemKey:{endpoint:f,driveId:l,itemId:c}})}}return})(e,{folderItemKey:t.itemKey,currentItemSetKey:o}))?a.e.serialize(i):void 0)?{itemKey:g}:{};n=i&&g&&v(e,{itemSetKey:g,parentItemKey:u.e.serialize(i.driveItemKey),stageItem:t.stageItem})}var y=Object(p.e)(e),b=y?e.demandItemFacet(u.e,y.localItemKey):void 0;if(y&&(i||f||d)){var w=b&&b.driveId,E=l&&l.driveItemKey&&l.driveItemKey.driveId||d&&d.driveId,S=i?a.e.serialize(i):l?a.e.serialize(l):d?u.e.serialize(d):void 0;if(w!==E&&S)return Object(r.__assign)({itemKey:h.e.serialize({localItemKey:y.localItemKey,remoteItemKey:S})},n?{stageItem:n}:{})}return Object(r.__assign)(Object(r.__assign)({},f),n?{stageItem:n}:{})}}});function v(e,t){var n=this,i=t.parentItemKey,s=t.itemSetKey,u=t.stageItem;if(i)return u?Object(o.t)(function(e){var t=e.itemsScopeItemKey,o=e.currentItemKey;return function(e){return Object(r.__awaiter)(n,void 0,void 0,function(){var n;return Object(r.__generator)(this,function(a){switch(a.label){case 0:e(Object(l.e)({items:(n={},n[s]=Object(r.__assign)({},f.s.pack({itemKey:i})),n)}));return[4,e(u({currentItemKey:o,itemsScopeItemKey:t}))];case 1:a.sent();return[2]}})})}}):void 0}},function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=n(2),i=n(363),s=new r.e("saveUploadedTemplateToView"),o=Object(i.e)({operationTypeFacet:s})},function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=n(2),i=n(363),s=new r.e("updateItemRating"),o=Object(i.e)({operationTypeFacet:s})},function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=n(2),i=n(363),s=new r.e("updateItemLikes"),o=Object(i.e)({operationTypeFacet:s})},function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=n(2),i=n(363),s=new r.e("modifyColumnAggregateType"),o=Object(i.e)({operationTypeFacet:s})},function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=n(2),i=n(363),s=new r.e("reorderListItems"),o=Object(i.e)({operationTypeFacet:s})},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(21).e)("permissionInviteActionControl")},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(21).e)("getDefaultShareLinkActionControl")},function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=n(2),i=n(363),s=new r.e("createView"),o=Object(i.e)({operationTypeFacet:s})},function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=n(2),i=n(363),s=new r.e("saveTemplatesToView"),o=Object(i.e)({operationTypeFacet:s})},function(e,t,n){"use strict";n.d(t,"e",function(){return g});var r=n(0),i=n("react-lib"),s=n(14),o=n(49),u=n(28),a=n(359),f=n(29),l=n(46),c=n(232),h=n(3491),p=n(32),d=n(4132),v=n(24),m=n(1),g=Object(s.t)()(function(){return function(e){return function(e,t){var n=t.itemKeys[0],i=Object(f.e)(e,{graphTokenProvider:h.e,spRestTokenProvider:m.mn,logger:l.o}),s=i.graphTokenProvider,p=i.spRestTokenProvider,g=i.logger,b=Object(o.e)(e,n),w=b&&(b.env2||b.env),E=g&&g.scenarioId;return{initializeShareFrame:function(e){var t=e.parentElement,n=e.calloutProps,i=e.sharingInformation,o=e.onError,f=n.defaultRecipients,h=n.itemName,m=n.locale,g=n.mode,y=n.openManageAccess,b=n.theme,S=n.getClientId,x=n.enableWiderShareDialog,T=i.authToken,N=i.isListSharing,C=i.listId,k=i.serverRelativeItemUrl,L=i.shareItemKey,A=i.webAbsoluteUrl,O=S(),M={authToken:T||"",clientId:O,defaultRecipients:f,itemName:h,mode:Number(g),theme:b||Object(v._)(),webAbsoluteUrl:A||""},_={};if(L&&a.n.matches(L)){var D=a.n.deserialize(L);_={listId:D.listId,uniqueId:D.uniqueId,webAbsoluteUrl:D.webAbsoluteUrl}}else{var P=""+new c.e(A).authority+k;N&&O===l.e[l.e.listsHome]&&(E="list");_={isListSharing:N,itemUrl:P,listId:C,scenarioId:E}}new d.e({element:t,environment:w||u.e.prod,locale:m,context:Object(r.__assign)(Object(r.__assign)({},M),_),options:{onError:o,openManageAccess:y,graphTokenProvider:s,spRestTokenProvider:p},styles:{minWidth:x&&t.offsetWidth>=480?"480px":void 0}}).initializeUI()},sharingIFrameAs:y}}}}),y=Object(p.t)(function(e,t){var n=t.defaultRender,s=Object(r.__rest)(t,["defaultRender"]),o=s.enableWiderShareDialog,a=Object(f.e)(e,{enableWiderShareDialog:u.x}).enableWiderShareDialog,l=void 0!==a&&a;return n?i.createElement(n,Object(r.__assign)({},s,{enableWiderShareDialog:void 0===o?l:o})):null})},,,function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(21).e)("removeFromShardListActionControl")},,function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(2),i=Object(r.t)("launchCopyPickerCommand")},function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(2),i=Object(r.t)("launchMovePickerCommand")},function(e,t,n){"use strict";n.d(t,"e",function(){return b});var r=n(0),i=n("react-lib"),s=n(32),o=n(27),u=n(22),a=n(13),f=n(157),l=n(235),c=n(2691),h=n(98),p=n(2690),d=n(56),v=n(49),m={ODB:1024},g=function(e){var t=e.undoRedoActionType,n=e.dispatch,s=e.isAvailable,o=i.useState(0),a=o[0],f=o[1],l=i.useState(0),d=l[0],v=l[1],m=i.useRef(new h.e({})),g=s&&("undo"===t&&a>0||"redo"===t&&d>0);i.useEffect(function(){var e=n(c.e);m.current.on(e,p.e.undoRealCmdCountChangeEventName,function(e){f(e.undoRealCmdCount)});m.current.on(e,p.e.redoRealCmdCountChangeEventName,function(e){v(e.redoRealCmdCount)});return function(){m.current.dispose()}},[]);return i.createElement(u.e,Object(r.__assign)({},e,{isAvailable:g}))},y=Object(s.t)(function(e,t){var n=t.itemKey,s=t.undoRedoActionType,u="undo"===s,a=Object(v.e)(e,n),y=Object(d.e)(e,{feature:m,pageContext:a});if(y){y=Object(f.e)(e)===l.e}var b=e.dispatch;return i.createElement(g,Object(r.__assign)({undoRedoActionType:s,dispatch:b,isAvailable:y,onExecute:function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var e;return Object(r.__generator)(this,function(t){e=b(c.e);h.e.raise(e,u?p.e.undoChangeEventName:p.e.redoChangeEventName);return[2]})})}},Object(o.t)(e,{itemKey:n,engagement:{name:u?"QuickEditUndoAction":"QuickEditRedoAction",isIntentional:!0}})))}),b=Object(a.n)()(y)},function(e,t,n){"use strict";n.d(t,"e",function(){return u});var r=n(0),i=n("react-lib"),s=n(22),o=n(32),u=Object(o.t)(function(e,t){return i.createElement(s.e,{onExecute:function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var e;return Object(r.__generator)(this,function(n){e=null;t.selector?e=document.querySelector(t.selector):t.elementId&&(e=document.getElementById(t.elementId));if(e){e.focus();t.shouldClick&&e.click&&e.click()}return[2]})})},engagement:{name:"SetFocus",isIntentional:!0}})})},,function(e,t,n){"use strict";n.d(t,"e",function(){return u});var r=n("react-lib"),i=n(64),s=n(63),o=n(3921),u={key:n(3916).e,automationId:"launchMovePickerCommand",name:i.v,ariaLabel:i.v,action:r.createElement(s.t,null,r.createElement(o.t,null)),iconProps:{iconName:"FabricMoveToFolder"}}},function(e,t,n){"use strict";n.d(t,"t",function(){return g});n.d(t,"e",function(){return y});var r=n(0),i=n("react-lib"),s=n(13),o=n(22),u=n(20),a=n(32),f=n(131),l=n(73),c=n(70),h=n(27),p=n(839),d=Object(l.e)()(Object(c.e)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee(4,4533)];case 1:return[2,e.sent().LaunchMoveCopyPickerWizard]}})})})),v=Object(a.t)(function(e,t){var n=t.itemKeys,s=t.isMove,a=void 0!==s&&s;if(0===n.length)return null;var l=Object(f.e)(e);if(!l)return null;var c=e.demandItemFacet(p.e,n[0]),v=p.e.evaluate(c)(e,{entryItemKey:l,sourceItemKeys:n,isMove:a,isAvailable:!1,moveCopyPickerWizard:d}),m=v.isAvailable,g=v.moveCopyPickerWizard;if(!m||!g)return null;var y=Object(u.o)(function(e){return i.createElement(g,Object(r.__assign)({isMove:a,entryItemKey:l,sourceItemKeys:n},e))},{scope:"global"});return i.createElement(o.e,Object(r.__assign)({onExecute:y},Object(h.t)(e,{itemKey:n[0],engagement:{name:a?"MoveTo":"CopyTo"}})))}),m=Object(s.s)()(v),g=Object(a.e)(function(){return{isMove:!0}})(m),y=Object(a.e)(function(){return{isMove:!1}})(m)},function(e,t,n){"use strict";n.d(t,"e",function(){return u});var r=n("react-lib"),i=n(64),s=n(63),o=n(3921),u={key:n(3915).e,automationId:"launchCopyPickerCommand",name:i.t,ariaLabel:i.t,action:r.createElement(s.t,null,r.createElement(o.e,null)),iconProps:{iconName:"Copy"}}},,,,,,,function(e,t,n){"use strict";n.d(t,"t",function(){return p});n.d(t,"e",function(){return d});var r=n(0),i=n(400),s=n(2018),o=n(203),u=n(268),a=n(232),f=n(3557),l=n(1611),c=n(137),h=n(109);function p(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,s,o,f,c,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M;return Object(r.__generator)(this,function(_){switch(_.label){case 0:t=e.name,s=e.endpoint,o=e.sharepointIds,f=e.qosName,c=e.webAbsoluteUrl;p=n(Object(u.e)({getUserOneDriveEndpoint:h.v,isTestMode:h.x})),d=p.getUserOneDriveEndpoint,v=p.isTestMode;m=new a.e(c).authority;return(y=s)?[3,3]:(b=d)?[4,n(d({endpoint:m}))]:[3,2];case 1:b=_.sent();_.label=2;case 2:y=b;_.label=3;case 3:if(g=y)return[3,4];throw new i.e({code:"A2ODAddToOneDrive_missingDriveEndpointInfo"});case 4:w=g.replace("v2.0","v2.1");E=w+"/drives/me/root/children";S=o.listId;x=o.listItemUniqueId;T=o.siteId;N=o.siteUrl;C=o.webId;k={name:t,remoteItem:{sharepointIds:{listId:S,listItemUniqueId:x,siteId:T,siteUrl:N,webId:C}},"@microsoft.graph.conflictBehavior":"rename"};L=[{code:"notAllowed"},{code:"shortcutAlreadyExists"},{code:"nestedDescendantShortcutExists"},{code:"nestedAscendantShortcutExists"}];return[4,n(Object(l.n)({url:E,qosName:f,method:"POST",body:k,expectedErrors:L,endpoint:g}))];case 5:A=_.sent();if(v&&A){O=[];try{(M=window.localStorage.getItem("TAB.AddShortcut"))&&(O=JSON.parse(M))}catch(e){}window.localStorage.setItem("TAB.AddShortcut",JSON.stringify(Object(r.__spreadArrays)(O,[{name:t,id:A.id,endpoint:g}])))}return[2,A]}})})}}function d(e,t,n){var r=Object(s.t)(e,function(r,i){var s=e.response,u=s&&s.error;if(u){var a=u["@error.fixItItemIds"],l=u["@error.fixItWebUrl"],h=u["@error.fixItItemName"],p=[];if(a&&t&&n)for(var d=0,v=a;d<v.length;d++){var m=v[d],g=c.e.serialize({endpoint:t,driveId:n,itemId:m});p.push(g)}switch(r){case"unauthenticated":case 401:return o.r.pack({});case"itemNotFound":case 404:return o.a.pack({});case"accessDenied":case 403:return o.e.pack({});case"shortcutAlreadyExists":return f.n.pack({existShortcutUrl:l,existShortcutName:h});case"nestedDescendantShortcutExists":return f.t.pack({nestDescendantItemKeys:p});case"nestedAscendantShortcutExists":return f.e.pack({existShortcutUrl:l,existShortcutName:h});default:return o.y.pack({})}}});throw new i.e({innerError:e,facets:r})}},,function(e,t,n){"use strict";n.r(t);n.d(t,"GroupByActionExecutor",function(){return y});var r=n(0),i=n("react-lib"),s=n(78),o=n(43),u=n(204),a=n(22),f=n(10),l=n(1),c=n(295),h=n(20),p=n(27),d=n(32),v=n(173),m=n(200),g=n(2092),y=Object(d.t)(function(e,t){var n=t.groupByFieldKey,d=t.itemSetKey,y=e.demandItemFacet(s.e,d);if(!y)return i.createElement(h.n,null);var b=e.demandItemFacet(l.b,d),w=!y.groupByFieldKey&&!!b&&-1!==b.indexOf(n),E=y.groupByFieldKey===n||w,S=s.e.serialize(Object(r.__assign)(Object(r.__assign)({},y),{groupByFieldKey:E?void 0:n})),x=o.e.serialize(y),T=y.viewKey&&u.e.serialize(y.viewKey),N=e.demandItemFacet(l.m,T),C=Object(p.t)(e,{itemKey:d,engagement:{name:"GroupBy",isIntentional:!0}}),k=e.dispatch,L=Object(v.r)(e,i.createElement(c.e,{itemKey:S}));return i.createElement(h.n,{action:L},function(e){var t=e.execute,s=function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var i,o,u,a,c,h,p,d;return Object(r.__generator)(this,function(v){switch(v.label){case 0:i=new m.e({publisher:s});if(T&&w&&N&&(o=N.getDomParts())&&o.groupBy){u=Object(g.n)(o.groupBy);a=void 0;u.group1.fieldName===n?u.group2&&(a={isCollapsed:u.isCollapsed,group1:u.group2}):(null===(d=u.group2)||void 0===d?void 0:d.fieldName)===n&&(a={isCollapsed:u.isCollapsed,group1:u.group1});N.updateGroupBy(a);i.invalidateItems({items:(c={},c[S]=[f.e],c[T]=[l.m],c)})}i.resolveItems({items:Object(r.__assign)((h={},h[S]=Object(r.__assign)({},f.s.pack({itemKey:x})),h),T?(p={},p[T]=Object(r.__assign)({},l.Dt.pack(!0)),p):{})});k(i.execute());return[4,t(e)];case 1:v.sent();return[2]}})})};return i.createElement(a.e,Object(r.__assign)({onExecute:s},C))})})},,function(e,t,n){"use strict";n.d(t,"t",function(){return r});n.d(t,"n",function(){return i});n.d(t,"r",function(){return s});n.d(t,"i",function(){return o});n.d(t,"s",function(){return u});n.d(t,"e",function(){return a});var r="socialBarList_36611a00",i="socialBarPanel_36611a00",s="socialBarPanelContent_36611a00",o="socialBarPanelPersona_36611a00",u="socialBarPanelPersonaDescription_36611a00",a="analyticsStatsLink_36611a00"},function(e,t,n){"use strict";n.r(t);n.d(t,"CreateViewAction",function(){return w});var r=n(0),i=n("react-lib"),s=n(32),o=n(78),u=n(90),a=n(333),f=n(1),l=n(42),c=n(1023),h=n(27),p=n(20),d=n(22),v=n(70),m=n(51),g=n(434),y=n(786),b=Object(v.e)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee(65,4178)];case 1:return[2,e.sent().FreshViewCreator]}})})}),w=Object(s.t)(function(e,t){var n,s=t.isEditing,v=t.currentViewKey,w=Object(l.e)(e),E=Object(m.e)(e).itemsScopeItemKey,S=e.demandItemFacet(o.e,w),x=e.demandItemFacet(c.e,w),T=e.demandItemFacet(f.m,v),N=c.e.evaluate(x)(e,{viewKey:v}).onViewSaved;if(!w||!E)return null;var C=!1;if(S&&T){var k=u.e.serialize({webAbsoluteUrl:S.webAbsoluteUrl,listFullUrl:S.listFullUrl}),L=e.demandItemFacet(f.Ue,k);C=!!(L&&T&&"POWER"!==T.viewType&&L.permissions&&(L.permissions.managePersonalViews||L.permissions.manageLists))}var A=S?e.demandItemFacet(f.ln,a.e.serialize({webAbsoluteUrl:S.webAbsoluteUrl,listFullUrl:S.listFullUrl})):void 0,O=Object(y.t)(e,{mapping:{fieldData:f.ue},itemSetKey:w}).map(function(e){return e.fieldData}),M=e.demandItemFacet(f.ve,w),_=Number(null===(n=M)||void 0===n?void 0:n.ListTemplateType),D=Object(p.o)(function(e){return i.createElement(g.e,{itemsScopeItemKey:E},i.createElement(b,Object(r.__assign)({},e,t,{pageContext:A,itemSetKey:w,currentViewFields:O,listTemplateType:_,onViewSaved:N})))},{scope:"global"});return i.createElement(d.e,Object(r.__assign)({isAvailable:C,onExecute:D},Object(h.t)(e,{itemKey:w,engagement:{name:s?"EditView":"CreateNewView",isIntentional:!0}})))})}],Array(99),[function(e,t,n){"use strict";n.d(t,"e",function(){return w});n.d(t,"t",function(){return E});var r=n(0),i=n(137),s=n(16),o=n(106),u=n(787),a=n(1611),f=n(352),l=n(880),c=n(6),h=n(123),p=n(203),d=n(61),v=n(400),m=n(2018),g=n(2),y=n(143),b=n(127),w=Object(s.i)({mergeForSameItemKey:!1})(function(e){return function(t){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(n){switch(n.label){case 0:return[4,t(E(e))];case 1:n.sent();return[2]}})})}});function E(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,s,w,E,x,T,N,C,k,L,A,O,M,_;return Object(r.__generator)(this,function(D){switch(D.label){case 0:t=e.itemKey,s=e.options;w=i.e.deserialize(t);E=n(Object(o.e)(function(e){return e.demandItem({folder:c.m,oneNote:h.i,driveItem:i.e},t)}));x=!!E.folder||!!E.oneNote;T=Object(u.t)(w);N={};!!s.breakLock&&(N.Prefer="bypass-shared-lock");x&&(N.Prefer="respond-async");return[4,n(Object(a.n)({url:T,method:"DELETE",qosName:"deleteItemVroom",endpoint:w.endpoint,headers:N,parseResponse:function(e){return e.getResponseHeader("Location")||""}})).catch(function(e){if(e instanceof m.e)throw new v.e({innerError:e,facets:Object(r.__assign)({},Object(m.t)(e,S)||Object(g.n)({},{}))});throw new v.e({innerError:e})})];case 1:if(""===(C=D.sent()))return[3,12];n(Object(y.e)({items:Object(b.t)({itemKey:s},function(e){e.progressItemKey;return Object(r.__assign)(Object(r.__assign)({},d.y.pack({total:1,current:0})),d.p.pack(!0))},function(e,t){return t.progressItemKey})}));k=!1;D.label=2;case 2:D.trys.push([2,4,,7]);return[4,n(Object(a.n)({url:C,qosName:"getDeleteOperationStatus",endpoint:w.endpoint,parseResponse:function(e){var t=JSON.parse(e.responseText);return{percentComplete:t.percentComplete,status:t.status,retryAfter:Number(e.getResponseHeader("Retry-After")||"10")}}}))];case 3:L=D.sent();return[3,7];case 4:if(!((A=D.sent())instanceof m.e))return[3,6];O=Object(r.__assign)({},Object(m.t)(A,S)||Object(g.n)({},{}));return Object(g.r)({autoRetryError:p.i},O).autoRetryError?[4,Object(f.t)(2e4)]:[3,6];case 5:D.sent();return[3,10];case 6:throw new v.e({innerError:A});case 7:n(Object(y.e)({items:Object(b.t)({itemKey:s},function(e){e.progressItemKey;return Object(r.__assign)({},d.y.pack({total:1,current:L.percentComplete/100}))},function(e,t){return t.progressItemKey})}));if(!L||void 0!==L.percentComplete&&"Completed"!==L.status&&"Failed"!==L.status)return[3,8];k=!0;return[3,10];case 8:return[4,Object(f.t)(1e3*(null===(_=L)||void 0===_?void 0:_.retryAfter)||1e4)];case 9:D.sent();D.label=10;case 10:if(!k)return[3,2];D.label=11;case 11:if(!k)throw new v.e({facets:Object(r.__assign)({},p.c.pack(408))});D.label=12;case 12:n(Object(l.e)({items:(M={},M[t]=[c.l],M)}));return[2]}})})}}function S(e){switch(e){case"resourceLocked":case 423:return Object(r.__assign)({},p.u.pack({}));case"nameAlreadyExists":case 409:return Object(r.__assign)({},p.b.pack({}));case 0:return Object(r.__assign)({},p.i.pack({}))}}}],Array(80),[function(e,t,n){"use strict";n.d(t,"e",function(){return Se});var r=n(0),i=n(16),s=n(246),o=n(143),u=n(307),a=n(997),f=n(1379),l=n(1380),c=n(655),h=n(1378),p=n(718),d=n(43),v=n(6),m=n(10),g=n(1),y=n(3029),b=n(200);function w(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,s,o;return Object(r.__generator)(this,function(u){switch(u.label){case 0:t=h.e.deserialize(e.itemKey).tenantRootUrl;i=new b.e;return[4,n(Object(y.t)({tenantRootUrl:t}))];case 1:s=u.sent();i.resolveItems({items:(o={},o[e.itemKey]=Object(r.__assign)(Object(r.__assign)({},g.tn.pack(s.resource)),g.en.pack(s.payloadHeader)),o)});n(i.execute());return[2]}})})}}var E=n(55),S=n(3537),x=n(3888),T=n(106),N=n(29),C=n(5),k=new C.e("spJoinedTeamSetKeyFacet",{tenantRootUrl:Object(C.s)()}),L=n(3536);function A(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,s,o,u,a,c,h,d,y,w,N,C;return Object(r.__generator)(this,function(A){t=p.e.deserialize(e.itemKey).tenantRootUrl;i=new b.e;s=n(Object(T.e)(O));o=n(Object(T.e)(M));u=l.e.serialize({tenantRootUrl:t});a=f.e.serialize({tenantRootUrl:t});c=k.serialize({tenantRootUrl:t});h=L.e.serialize({tenantRootUrl:t});d=o?[h]:[u,a];y=Object(r.__assign)(Object(r.__assign)({},o?((w={})[h]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},E.s.pack(!0)),v.h.pack(S.n)),g.ct.pack({itemKey:e.itemKey})),w):((N={})[u]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},E.s.pack(!0)),v.h.pack(S.t)),g.ct.pack({itemKey:e.itemKey})),N[a]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},E.s.pack(!0)),v.h.pack(S.e)),g.ct.pack({itemKey:e.itemKey})),N)),((C={})[e.itemKey]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},v.h.pack(x.t)),E.s.pack(!0)),m.e.pack({itemKeys:d})),C));if(s){d.push(c);y[c]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},E.s.pack(!0)),v.h.pack(S.r)),g.ct.pack({itemKey:e.itemKey}))}i.resolveItems({items:y});n(i.execute());return[2]})})}}function O(e){return!!Object(N.e)(e,{enableSharedChannel:g.ne}).enableSharedChannel}function M(e){return!!Object(N.e)(e,{enableQuickAccess:g.J}).enableQuickAccess}var _=n(1384),D=n(3535),P=n(272),H=n(268);function B(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,s,o,u,f,h,d;return Object(r.__generator)(this,function(y){switch(y.label){case 0:t=l.e.deserialize(e.itemKey).tenantRootUrl;i=new b.e;return[4,n(j(t))];case 1:s=y.sent();o=[];u=p.e.serialize({tenantRootUrl:t});f=void 0;h=void 0;s&&s.Items&&s.Items.forEach(function(t,n){var l,p=a.e.serialize({webAbsoluteUrl:t.Url}),d=c.e.serialize({webAbsoluteUrl:t.Url}),y=t.ItemReference||{},b=y.SiteId,w=void 0===b?void 0:b,E=y.WebId,S=void 0===E?void 0:E,x=y.GroupId,T=void 0===x?void 0:x,N=_.e.serialize({rootItemKey:u,itemKey:p});f=s.Items[n-1]&&s.Items[n-1].PinOrder;h=s.Items[n+1]&&s.Items[n+1].PinOrder;i.resolveItems({items:(l={},l[p]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},v.h.pack(t.Title)),g.e.pack(t.Acronym)),g.o.pack(t.BannerColor)),g.u.pack(t.BannerImageUrl)),g.je.pack(!0)),v.m.pack({})),g.Ht.pack(t.Weight)),a.e.pack({webAbsoluteUrl:t.Url})),g.Pt.pack(w)),g.Ln.pack(S)),g.be.pack(T)),m.t.pack({itemKey:d})),l[N]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},g.St.pack(f)),g.vt.pack(t.PinOrder)),g.ut.pack(h)),Object(P.e)().forFacet(g.vt).thenInvalidate(e.itemKey,m.e).pack()),l[d]=Object(r.__assign)({},m.s.pack({itemKey:p})),l)});o.push(p)});i.resolveItems({items:(d={},d[e.itemKey]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},v.h.pack(S.t)),m.e.pack({itemKeys:o})),g.ct.pack({itemKey:u})),d)});n(i.execute());return[2]}})})}}function j(e){var t=this;return function(i){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,s,o,u;return Object(r.__generator)(this,function(r){switch(r.label){case 0:t=i(Object(H.e)({enableSitePinningConfiguration:g.ie,enableSPHomeServiceConfiguration:g.Z})),s=t.enableSitePinningConfiguration;return!1!==t.enableSPHomeServiceConfiguration?[3,3]:[4,n.ee(36,4407)];case 1:o=r.sent().getFrequentSitesData;return[4,i(o(e))];case 2:return[2,r.sent()];case 3:u=s?D.t:D.e;return[4,i(Object(y.r)(e,void 0,u))];case 4:return[2,r.sent()]}})})}}function F(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,s,o;return Object(r.__generator)(this,function(u){t=a.e.deserialize(e.itemKey).webAbsoluteUrl;i=new b.e;s=c.e.serialize({webAbsoluteUrl:t});i.resolveItems({items:(o={},o[e.itemKey]=Object(r.__assign)({},m.t.pack({itemKey:s})),o)});n(i.execute());return[2]})})}}var I=n(78),q=n(115),R=n(621),U=n(507),z=n(50),W=n(874),X=n(231),V=n(67);function $(e){var t=this,n=e.webAbsoluteUrl,i=e.types,s=!!i&&i.indexOf("media")>-1,o=!!i&&i.indexOf("page")>-1;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,u,a,f,l,c;return Object(r.__generator)(this,function(r){switch(r.label){case 0:t=e(Object(H.e)({spHostPageWebAbsoluteUrl:g.rn,spSitesListsDataWebAbsoluteUrl:g.gn})),i=t.spHostPageWebAbsoluteUrl,u=t.spSitesListsDataWebAbsoluteUrl;a=s?n:i||u||n;f=s?"GetDocumentAndMediaLibraries":"GetDocumentLibraries";l=Object(W.n)({webAbsoluteUrl:a}).segment("SP.Web."+f).parameter("webFullUrl",n);s&&o&&(l=l.parameter("includePageLibraries",o));return[4,e(Object(X.r)({webAbsoluteUrl:a,method:"POST",url:l.toString(),qosName:""+f[0].toLowerCase()+f.slice(1),noRedirect:!0}))];case 1:c=r.sent();return[2,s?c.d.GetDocumentAndMediaLibraries.results:c.d.GetDocumentLibraries.results]}})})}}function J(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,s,o,u,f,l,h,p,y,w,E,S,x,T,N,C,k,L;return Object(r.__generator)(this,function(A){switch(A.label){case 0:t=c.e.deserialize(e.itemKey),i=t.webAbsoluteUrl,s=t.types;o=a.e.serialize({webAbsoluteUrl:i});u=new b.e;return[4,n($({webAbsoluteUrl:i,types:s}))];case 1:f=A.sent();l=[];for(h=0,p=f;h<p.length;h++){y=p[h];w=new q.t({context:{webAbsoluteUrl:i}});E=w.getUrlParts({webUrl:i,listUrl:y.AbsoluteUrl,path:y.AbsoluteUrl});S={webAbsoluteUrl:i,listFullUrl:E.fullListUrl||"",rootFolder:""};x=d.e.serialize(S);T=I.e.serialize({webAbsoluteUrl:i,listFullUrl:E.fullListUrl||"",rootFolder:""});N=new z.e(E.fullListUrl||"").authority;C=N&&y.DriveId?N+"/_api/v2.0/"+encodeURIComponent(y.DriveId):"";u.merge(n(Object(U.e)({itemKey:x,spItem:S,driveUrl:C})).itemResolver);u.resolveItems({items:(k={},k[x]=Object(r.__assign)(Object(r.__assign)({},v.h.pack(y.Title)),g.Le.pack(y.IsDefaultDocumentLibrary)),k[T]=Object(r.__assign)({},m.s.pack({itemKey:x})),k)});l.push(x)}u.resolveItems({items:(L={},L[e.itemKey]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},m.e.pack({itemKeys:l})),Object(P.e)().forFacet(m.e).thenInvalidate(R.e).pack()),V.t.isActivated("FEB96EC9-6F3F-4031-89D3-61214B0E3BBF","9/7/2021","Dont map the librariesItemSet to an spWeb")?a.e.pack({webAbsoluteUrl:i}):{}),m.s.pack({itemKey:o})),L)});n(u.execute());return[2]}})})}}var K=n(158),Q=n(794),G=n(14),Y=n(1183),Z=Object(G.t)()(function(){return function(e){return function(e,t){var n=t.itemKey,i=t.handlers,s=e.demandItemFacet(c.e,n);if(i&&s){for(var o=[],u=0,a=i;u<a.length;u++){var f=a[u],l=Object(Y.e)(f);".JPEG"===l?o.push("media"):".ASPX"===l&&o.push("page")}return o.length<1?{}:{itemKey:c.e.serialize(Object(r.__assign)(Object(r.__assign)({},s),{types:o}))}}return{}}}});var ee=n(386),te=new C.e("spSharedChannelGroupKeyFacet",{tenantRootUrl:Object(C.s)(),groupId:Object(C.s)(),tenantId:Object(C.s)()}),ne=n(433),re=Object(i.i)()(function(e){var t=this,n=e.itemKey;return function(i){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,s,o,u,f,l,h,p,d,v,y,w;return Object(r.__generator)(this,function(E){switch(E.label){case 0:t=i(Object(H.e)({spHostPageWebAbsoluteUrl:g.rn})).spHostPageWebAbsoluteUrl;s=te.deserialize(n);o=t||s.tenantRootUrl;u=new ne.t({webAbsoluteUrl:o}).build().segments("GroupSiteManager","GetSharedChannelSharePointUrl").toString();f={tenantId:s.tenantId,groupId:s.groupId};return[4,i(Object(X.t)({url:u,method:"POST",body:JSON.stringify(f),qosName:"getSharedChannelGroupUrlFromSharePoint",webAbsoluteUrl:o,noRedirect:!0}))];case 1:l=E.sent();h=l.d.GetSharedChannelSharePointUrl;p=a.e.serialize({webAbsoluteUrl:h});d=c.e.serialize({webAbsoluteUrl:h});(v=new b.e).mapKeys({mappings:(y={},y[e.itemKey]=p,y)});v.resolveItems({items:(w={},w[e.itemKey]=Object(r.__assign)({},m.t.pack({itemKey:d})),w)});i(v.execute());return[2]}})})}});var ie=new C.e("spSharedChannelGroupSetKeyFacet",{tenantRootUrl:Object(C.s)()}),se=new(n(2).e)("groupResourceCapability"),oe=Object(i.i)()(function(e){var t=this,n=e.itemKey;return function(i){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,s,u,a,f,l,c,h,p,d,y,w,E,S,x,T,N,C,k,L,A;return Object(r.__generator)(this,function(O){switch(O.label){case 0:t=new b.e;s=ie.deserialize(n);a=i(Object(H.e)({spHostPageWebAbsoluteUrl:g.rn})).spHostPageWebAbsoluteUrl;f=a||s.tenantRootUrl;l=new ne.t({webAbsoluteUrl:f}).build().segments("GroupSiteManager","GetCurrentUserSharedChannelMemberGroups").toString();c={};return[4,i(Object(X.t)({url:l,method:"POST",body:JSON.stringify(c),qosName:"getSharedChannelGroupsFromSharePoint",webAbsoluteUrl:f,noRedirect:!0}))];case 1:u=O.sent();h=[];p=JSON.parse(u.d.GetCurrentUserSharedChannelMemberGroups);for(d=0,y=p.value;d<y.length;d++){w=y[d];E=w.oid,S=w.tid,x=w.DisplayName,T=w.GroupResourceCapability,N=w.Acronym,C=w.BannerColor;k=te.serialize({groupId:E,tenantId:S,tenantRootUrl:f});i(Object(o.e)({items:(L={},L[k]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},v.h.pack(x)),se.pack(T)),g.e.pack(N)),g.o.pack(C)),v.m.pack({})),L)}));h.push(k)}t.resolveItems({items:(A={},A[e.itemKey]=Object(r.__assign)({},m.e.pack({itemKeys:h})),A)});i(t.execute());return[2]}})})}});var ue=n(437),ae=n(96),fe=n(1238),le=Object(G.t)()(function(){return function(e){return function(e,t){var n=(function(e,t){var n=this,i=t.stageItem;return i?Object(ae.t)(function(e){var t=e.itemsScopeItemKey,s=e.currentItemKey;return function(e){return Object(r.__awaiter)(n,void 0,void 0,function(){return Object(r.__generator)(this,function(n){switch(n.label){case 0:return[4,e(Object(fe.e)(function(e){return e.demandItemFacet(d.e,s,{suppressGetItems:!1})}))];case 1:return n.sent()?[4,e(i({currentItemKey:s,itemsScopeItemKey:t}))]:[3,3];case 2:n.sent();n.label=3;case 3:return[2]}})})}}):void 0})(0,{itemKey:t.itemKey,stageItem:t.stageItem});return n?{stageItem:n}:{}}}});var ce=n(131),he=n(42),pe=Object(G.t)()(function(){return function(){return function(e,t){var n,i=t.itemKey,s=Object(ce.e)(e),o=Object(he.e)(e);if(e.demandItemFacet(p.e,i)){var u=e.demandItemFacet(d.e,s),a=e.demandItemFacet(c.e,o);(u||a)&&(n={isToggled:!0})}return Object(r.__assign)({},n||{})}}});var de=new C.e("spJoinedTeamKeyFacet",{tenantRootUrl:Object(C.s)(),groupId:Object(C.s)()}),ve=n(3889);Object(i.i)()(function(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,s,o,u,a,f,l,c,h,p;return Object(r.__generator)(this,function(d){switch(d.label){case 0:t=e.itemKey;i=ve.e.deserialize(t).webAbsoluteUrl;s=new b.e;o=n(Object(H.e)({spHostPageWebAbsoluteUrl:g.rn,spCookieDomainConfiguration:g.It})),u=o.spHostPageWebAbsoluteUrl,a=o.spCookieDomainConfiguration;if(!(f=u||a))return[3,1];l=me(f,i);return[3,3];case 1:c=Object(W.n)({webAbsoluteUrl:i}).segment("siteiconmanager").segment("getsitelogo").toString();return[4,n(Object(X.t)({webAbsoluteUrl:i,method:"GET",url:c,qosName:"siteiconmanager.getsitelogo",responseType:"blob"}))];case 2:h=d.sent();l=URL.createObjectURL(h);d.label=3;case 3:s.resolveItems({items:(p={},p[t]=Object(r.__assign)({},v.O.pack(l)),p)});n(s.execute());return[2]}})})}});function me(e,t){return Object(W.n)({webAbsoluteUrl:e||""}).segment("siteiconmanager").segment("getsitelogo").parameter("siteUrl",t).toString()}var ge=Object(i.i)()(function(e){var t=this,n=e.itemKey;return function(i){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,s,o,u,a,f,l,c,h,p,d,y,w,E,S,x,T,N,C,L,A,O,M,_,D,P,B;return Object(r.__generator)(this,function(j){switch(j.label){case 0:t=k.deserialize(n).tenantRootUrl;s=i(Object(H.e)({spHostPageWebAbsoluteUrl:g.rn,spCookieDomainConfiguration:g.It})),o=s.spHostPageWebAbsoluteUrl,u=s.spCookieDomainConfiguration;a=o||u||t;f=new ne.t({webAbsoluteUrl:a}).build().segments("GroupSiteManager","GetCurrentUserJoinedTeams").toString();l={getLogoData:!0};return[4,i(Object(X.t)({url:f,method:"POST",body:JSON.stringify(l),qosName:"getJoinedTeamsFromSharePoint",webAbsoluteUrl:a,noRedirect:!0}))];case 1:c=j.sent();h=JSON.parse(c.d.GetCurrentUserJoinedTeams);p=new b.e;d=[];for(y=0,w=h.value;y<w.length;y++){E=w[y];S=E.id,x=E.displayName,T=E.description,N=E.BannerColor,C=E.Acronym,L=E.GroupSiteUrl,A=E.LogoUrl;O=de.serialize({groupId:S,tenantRootUrl:t});M="";_="";if(A){D=new z.e(decodeURIComponent(L));M=D.authority;_=""+M+A}else a&&L&&(_=me(a,L));p.resolveItems({items:(P={},P[O]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},v.h.pack(x)),v.c.pack(T)),g.e.pack(C)),g.o.pack(N)),L?v.i.pack(L):{}),A||L?g.u.pack(_):{}),v.m.pack({})),P)});d.push(O)}p.resolveItems({items:(B={},B[e.itemKey]=Object(r.__assign)({},m.e.pack({itemKeys:d})),B)});i(p.execute());return[2]}})})}});var ye=Object(G.t)()(function(){return function(e){return function(e,t){var n=(function(e,t){var n=this,i=t.stageItem;return i?Object(ae.t)(function(e){var t=e.itemsScopeItemKey,s=e.currentItemKey;return function(e){return Object(r.__awaiter)(n,void 0,void 0,function(){return Object(r.__generator)(this,function(n){switch(n.label){case 0:return[4,e(Object(fe.e)(function(e){return e.demandItemFacet(d.e,s,{suppressGetItems:!1})}))];case 1:return n.sent()?[4,e(i({currentItemKey:s,itemsScopeItemKey:t}))]:[3,3];case 2:n.sent();n.label=3;case 3:return[2]}})})}}):void 0})(0,{itemKey:t.itemKey,stageItem:t.stageItem});return n?{stageItem:n}:{}}}});var be=n(264),we=Object(i.i)()(function(e){var t=this,n=e.itemKey;return function(i){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,s,o,u,f,l,h,p,d,v,y,w,E;return Object(r.__generator)(this,function(S){switch(S.label){case 0:t=i(Object(H.e)({spHostPageWebAbsoluteUrl:g.rn})).spHostPageWebAbsoluteUrl;s=de.deserialize(n);o=t||s.tenantRootUrl;u=new ne.t({webAbsoluteUrl:o}).build().segments("GroupSiteManager","GetSiteStatus").toString();f={groupId:s.groupId};return[4,i(Object(X.t)({url:u,method:"POST",body:JSON.stringify(f),qosName:"getSpJoinedTeamUrlFromSharePoint",webAbsoluteUrl:o,noRedirect:!0}))];case 1:l=S.sent();h=new b.e;p=l.d.GetSiteStatus.SiteUrl;d=a.e.serialize({webAbsoluteUrl:p});h.mapKeys({mappings:(y={},y[e.itemKey]=d,y)});h.resolveItems({items:(w={},w[d]=Object(r.__assign)({},be.n.pack(a.e)),w)});v=c.e.serialize({webAbsoluteUrl:p});h.resolveItems({items:(E={},E[e.itemKey]=Object(r.__assign)({},m.t.pack({itemKey:v})),E)});i(h.execute());return[2]}})})}});var Ee=Object(K.t)(Object(K.e)(function(){return n.ee(60,4706)},{chunkName:"addon-sharepointhome-deferred"}),"getSPFollowedSitesItemSet"),Se=Object(i.t)(function(){return function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(t){e(Object(o.t)({keyFacet:a.e,facets:[v.h,m.t]}));e(Object(o.t)({keyFacet:f.e,facets:[f.e,m.e]}));e(Object(o.t)({keyFacet:l.e,facets:[l.e,m.e]}));e(Object(o.t)({keyFacet:c.e,facets:[c.e,m.e,m.t]}));e(Object(s.r)(h.e,u.e)(Object(i.i)({maxParallelOperationCount:4})(w)));e(Object(s.r)(p.e,u.e)(Object(i.i)()(A)));e(Object(s.r)(l.e,u.e)(Object(i.i)()(B)));e(Object(s.r)(a.e,u.e)(Object(i.i)({maxParallelOperationCount:4})(F)));e(Object(s.r)(c.e,u.e)(Object(i.i)({maxParallelOperationCount:8})(J)));e(Object(ee.e)(c.e,Q.e)(Z));e(Object(s.r)(f.e,u.e)(Object(i.r)(Ee)));e(Object(o.t)({keyFacet:te,facets:[d.e]}));e(Object(s.r)(te,u.e)(re));e(Object(s.r)(ie,u.e)(oe));e(Object(ee.e)(te,ue.e)(le));e(Object(o.t)({keyFacet:de,facets:[d.e]}));e(Object(s.r)(k,u.e)(ge));e(Object(ee.e)(de,ue.e)(ye));e(Object(s.r)(de,u.e)(we));e(Object(ee.e)(p.e,ue.e)(pe));return[2]})})}})}],Array(26),[function(e,t,n){"use strict";n.r(t);n.d(t,"sharePointBasicActionsAddonDeferred",function(){return N});var r=n(0),i=n(386),s=n(16),o=n(246),u=n(698),a=n(1036),f=n(1152),l=n(43),c=n("react-lib"),h=n(1),p=n(30),d=n(18),v=n(12),m=n(14),g=n(32),y=n(29),b=n(4304),w=n(1390),E=n(624),S=Object(m.t)()(function(){return function(e){return function(e,t){var n,r=t.itemKey,i=t.isBatchDelete,s=e.demandItemFacet(h.et,r,{suppressGetItems:!0}),o=e.demandItemFacet(h.ht,r,{suppressGetItems:!0}),u=e.demandItemFacet(h.At,r,{suppressGetItems:!0}),a=Object(w.e)(null===(n=u)||void 0===n?void 0:n.ProgId),f=p.e.hasItemPermission({permissions:o},p.e.deleteListItems)&&!a;if(f&&s){f=!!Object(y.e)(e,{enableDeleteCommandForMountPointConfiguration:h.C}).enableDeleteCommandForMountPointConfiguration&&i}return{isAvailable:f,deleteWizard:x}}}});var x=Object(g.t)(function(e,t){var n,i,s,o,u,a,f=t.itemKeys,p=t.defaultRender,m=Object(r.__rest)(t,["itemKeys","defaultRender"]),g=void 0,w=Object(y.e)(e,{enableDeleteCommandForMountPointConfiguration:h.C}).enableDeleteCommandForMountPointConfiguration,S=(function(e,t){if(e.demandItemFacet(l.e,t)){var n=Object(E.e)(e,t),r=!(n&&n.isDocumentLibrary),i=n&&n.templateType===v.n.mySiteDocumentLibrary;return!(!r&&!i)}return!1})(e,f[0]);if(1===f.length){var x=e.demandItemFacet(h.tt,f[0]);if(x){var T=x&&Object(d.formatToArray)(Object(d.getLocalizedCountValue)(b.t,b.n,x)||"",x),N=m.deleteWizardStrings.confirmText;g=Object(r.__assign)(Object(r.__assign)({},m),{deleteWizardStrings:Object(r.__assign)(Object(r.__assign)({},m.deleteWizardStrings),{confirmTitle:b.r,confirmText:[T," ",N]})})}else S&&(g=Object(r.__assign)(Object(r.__assign)({},m),{deleteWizardStrings:Object(r.__assign)(Object(r.__assign)({},m.deleteWizardStrings),{confirmText:b.e})}))}else if(f.length>1){var C=!1;if(w){n=0;f.forEach(function(t){e.demandItemFacet(h.et,t,{suppressGetItems:!0})&&n++});if(n>0){var k=f.length-n;g=Object(r.__assign)(Object(r.__assign)({},m),{deleteWizardStrings:Object(r.__assign)(Object(r.__assign)({},m.deleteWizardStrings),{confirmTitle:b.i,confirmText:(i=n,s=k,o=Object(d.format)(Object(d.getLocalizedCountValue)(b.f,b.l,i)||"",i),u=Object(d.format)(Object(d.getLocalizedCountValue)(b.u,b.a,s)||"",s),a=Object(d.format)(b.s,o,u),a)})})}else C=!0}C&&S&&(g=Object(r.__assign)(Object(r.__assign)({},m),{deleteWizardStrings:Object(r.__assign)(Object(r.__assign)({},m.deleteWizardStrings),{confirmText:b.o})}))}var L=g||m;return p?c.createElement(p,Object(r.__assign)({itemKeys:f},L)):null});var T=Object(m.t)()(function(){return function(e){return function(e,t){var n=t.itemKeys;if(!Object(y.e)(e,{enableDeleteCommandForMountPointConfiguration:h.C}).enableDeleteCommandForMountPointConfiguration)return{};for(var r=0,i=n;r<i.length;r++){var s=i[r];if(!e.demandItemFacet(h.et,s,{suppressGetItems:!0}))return{}}return{isAvailable:!1}}}});var N=Object(s.t)(function(){return function(e){e(Object(o.r)(l.e,f.t)(Object(s.r)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([614],5011)];case 1:return[2,e.sent().spItemDeleteItemsOperationHandler]}})})})));e(Object(i.e)(l.e,u.t)(S));e(Object(i.e)(l.e,a.e)(T))}})}],Array(23),[function(e,t,n){"use strict";n.d(t,"e",function(){return b});n.d(t,"t",function(){return w});var r=n(0),i=n(1346),s=n(78),o=n(16),u=n(200),a=n(272),f=n(2),l=n(10),c=n(106),h=n(43),p=n(418),d=n(29),v=n(2790),m=n(61),g=n(143),y=n(1);var b=new f.e("projection");var w=Object(o.i)()(function(e){var t=this,n=i.e.deserialize(e.itemKey).itemSetKey;return function(o){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,f,w;return Object(r.__generator)(this,function(E){t=s.e.serialize(n);(f=new u.e).resolveItems({items:(w={},w[e.itemKey]=Object(r.__assign)(Object(r.__assign)({},b.pack({})),Object(a.e)().forFacet(b).thenInvalidate(function(){return function(){o((function(e){var t=this,n=e.itemSetKey,o=s.e.deserialize(n),u=i.e.serialize({itemSetKey:o});return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t;return Object(r.__generator)(this,function(n){e(Object(c.e)(function(e){var t=Object(d.e)(e,{isProjectedUploadedItemSetEnabled:y.V}).isProjectedUploadedItemSetEnabled;if(void 0!==t&&t){var n=h.e.serialize(o),r=e.demandItemFacet(y.n,n);if(r&&Object.keys(r).length>0)return!1;for(var i=e.demandItemFacet(l.e,p.e),s=0,u=i&&i.itemKeys||[];s<u.length;s++){var a=u[s];if(e.demandItemFacet(v.t,a)){var f=e.demandItemFacet(m.o,a),c=e.demandItemFacet(h.e,f&&f.itemKey);if(c&&c.rootFolder===o.rootFolder)return!1}}}return!0}))&&e(Object(g.e)({items:(t={},t[u]=Object(r.__assign)({},l.e.pack({itemKeys:[]})),t)}));return[2]})})}})({itemSetKey:t}))}}).pack()),w[t]=Object(a.e)().forFacet(l.e).thenInvalidate(e.itemKey,b).pack(),w)});o(f.execute());return[2]})})}})},,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return p});var r=n(16),i=n(386),s=n(43),o=n(0),u=n("react-lib"),a=n(14),f=n(70),l=Object(f.e)(function(){return Object(o.__awaiter)(void 0,void 0,void 0,function(){return Object(o.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([31,"deferred.odsp-datasources","ondemand.resx-ondemand"],3407)];case 1:return[2,e.sent().PropertiesForm]}})})}),c=Object(a.t)()(function(){return function(e){return function(e,t){return{getPropertiesForm:function(e){return u.createElement(l,Object(o.__assign)({},e))}}}}});var h=n(1021),p=Object(r.t)(function(){return function(e){e(Object(i.e)(s.e,h.e)(c))}})},,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return l});var r=n(0),i=n("react-lib"),s=n(1623),o=n(3771),u=n(2473),a=n(1617),f=n(395),l=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._onClose=function(){n.setState({isOpen:!1})};n._iframeOnLoad=function(){var e=n.props.heightOffset;if(n._iframeElement&&n._iframeElement.contentDocument){var t=n._iframeElement.contentDocument.body.clientHeight;t<=0&&e&&(t=document.body.clientHeight*e);n._iframeElement.style.height=t+"px"}n.setState({isIFrameLoaded:!0});n.props.onLoad&&n._iframeElement&&n.props.onLoad(n._iframeElement)};n.state={isOpen:!0,isIFrameLoaded:!1};return n}t.prototype.UNSAFE_componentWillReceiveProps=function(e){this.setState({isIFrameLoaded:!1})};t.prototype.render=function(){var e=this,t=this.props,n=t.url,l=(t.heightOffset,Object(r.__rest)(t,["url","heightOffset"])),c=this.state.isIFrameLoaded;return i.createElement(o.e,Object(r.__assign)({className:"IFrameDialog_d45656a1",hidden:!this.state.isOpen,type:u.e.close},l),i.createElement(s.e,null,!c&&i.createElement(a.e,{size:f.e.large}),i.createElement("iframe",{ref:function(t){return e._setupIFrameElementFunctions(t)},src:n,style:{display:c?"block":"none"},onLoad:this._iframeOnLoad})))};t.prototype._setupIFrameElementFunctions=function(e){if(e){var t=e;t.cancelPopUp=this._onClose;t.commitPopup=this._onClose}this._iframeElement=e};return t})(i.Component)}],Array(113),[function(e,t,n){"use strict";n.r(t);n.d(t,"uploadListItem",function(){return _});n.d(t,"mapConflictResolutionToNameConflictBehavior",function(){return D});var r=n(0),i=n(58),s=n(43),o=n(90),u=n(30),a=n(3447),f=n(3346),l=n(231),c=n(1),h=n(233),p=n(109),d=n(122),v=n(2474),m=n(143),g=n(2),y=n(61),b=n(874),w=n(106),E=n(332),S=n(6),x=n(12),T=n(268),N=n(3880),C=n(49),k=n(1516),L=n(82),A=n(160),O=Object(E.e)(function(){return new f.e({maxParallelUploads:1/0})}),M=function(e){return function(t){var n=t.demandItemFacet(c.ht,e);return!(n&&!u.t.hasItemPermission({permissions:n},u.t.editListItems))}};function _(e){var t=this,n=e.itemKey,f=e.options.sourceEntries,E=s.e.deserialize(n),_=E.webAbsoluteUrl,P=E.listFullUrl,H=Object.keys(f)[0],B=f[H],j=B.progressItemKey,F=B.conflictResolution;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,f,B,I,q,R,U,z,W,X,V,$,J,K,Q,G,Y,Z,ee,te,ne,re,ie,se,oe,ue,ae,fe,le,ce,he,pe,de,ve,me,ge,ye,be;return Object(r.__generator)(this,function(we){switch(we.label){case 0:t=e(Object(l.n)({webAbsoluteUrl:_,listFullUrl:P})),f=t.dataRequestor,B=t.hasDigest;if(!t.hasTokenProvider)return[3,1];q=void 0;return[3,3];case 1:return[4,e(Object(l.e)({url:_||P,disallowCookies:!B}))];case 2:q=we.sent();we.label=3;case 3:I=q;if(!(R=e(Object(d.e)({sourceFile:v.t},H)).sourceFile))throw new L.e({code:"MissingSourceFileForUpload",message:"No source file for upload."});U=e(Object(d.e)({folderPath:c.pe},n)).folderPath;if(!(z=void 0===U?E.rootFolder:U))throw new L.e({code:"MissingTargetFolderPathForUpload",message:"No path information for target folder."});W=e(Object(w.e)((function(e,t){return function(t){var n=Object(C.e)(t,e);return 1024*(n&&n.maximumFileSize||Number.POSITIVE_INFINITY)*1024}})(n)));R.size>W&&Object(N.t)(W);X=Object(b.r)({webAbsoluteUrl:_,listOrItemFullUrl:P});V=new h.e(void 0);$=V.debounce(function(t){var n;j&&e(Object(m.e)({items:(n={},n[j]=Object(g.n)({progressSize:y.y},{progressSize:{current:t}}),n)}))},300,{leading:!1});J=o.e.serialize({webAbsoluteUrl:_,listFullUrl:P});K=e(Object(w.e)(function(e){return e.demandItemFacet(c.Ue,J)}));Q=!(!K||!K.contentTypesEnabled||K.templateType===x.t.mySiteDocumentLibrary);G=D(F);Y=e(Object(T.e)({clientName:p.t,combineStartFinish:c.xn})),Z=Y.clientName,ee=Y.combineStartFinish;te=new a.e({authToken:I,onProgress:$,dataRequestor:f,combineStartFinish:ee,nameConflictBehavior:G,webApiUrl:X,fileUpload:R,destinationUrl:z,appName:Z||"Unknown",throttler:e(O),canStream:e(Object(w.e)(M(n))),itemExpansion:Q?"ListItemAllFields/ContentType/Fields":"ListItemAllFields"});j&&e(Object(m.e)({items:(ve={},ve[j]=Object(r.__assign)({},y.y.pack({total:R.size,current:0})),ve)}));ne=te.upload();re=e(Object(w.e)(function(e){return e.demandItemFacet(y.i,j)}));ie=re?re.token.subscribe(function(){te.abort()}):void 0;we.label=4;case 4:we.trys.push([4,6,7,8]);return[4,ne];case 5:se=we.sent();return[3,8];case 6:oe=we.sent();te.abort();j&&e(Object(m.e)({items:(me={},me[j]=Object(r.__assign)({},y.y.pack({total:R.size,current:0})),me)}));throw e(Object(N.e)(oe));case 7:ie&&ie();V.dispose();te.dispose();return[7];case 8:ue=se.ServerRelativeUrl;ae=se.ServerRedirectedUrl;fe=se.ListItemAllFields&&se.ListItemAllFields.Id?String(se.ListItemAllFields.Id):se.ServerRelativeUrl;le=s.e.serialize({webAbsoluteUrl:_,listFullUrl:P,itemId:fe});ce=se.UniqueId?i.e.normalizeLower(se.UniqueId):"";he=se.Name;pe=new A.e(_).authority;de=pe&&ue?""+pe+ue:"";j&&e(Object(m.e)({items:(ge={},ge[j]=Object(r.__assign)({},S.h.pack(he)),ge)}));e(Object(k.e)({items:(ye={},ye[le]=Object(r.__assign)({},c.ht.pack(u.t.openItems)),ye)}));e(Object(m.e)({items:(be={},be[le]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},S.h.pack(he)),ce?c.Sn.pack(ce):{}),ue?c.pe.pack(ue):{}),ae?S.O.pack(ae):{}),S.M.pack({itemKey:n})),de?S.i.pack(de):{}),be)}));return[2,{itemKey:le}]}})})}}function D(e){switch(e){case"replace":return 1;case"rename":return 2;default:return 0}}},,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r=n("react-lib"),i=n(995);function s(e){var t=e.controlHandlers;return o(e.children,t)}function o(e,t){return r.createElement(i.e,{value:t},e)}},,,function(e,t,n){"use strict";n.r(t);n.d(t,"sharePointBasicItemDataAddonDeferred",function(){return s});var r=n(16),i=n(3534),s=Object(r.t)(function(){return function(e){e(i.sharePointItemByFullUrlAddon)}})},,,,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return u});var r=n("react-lib"),i=n(257),s=n(2),o=n(3918),u={key:new s.e("GetNPSSurveyFocusShortcut").id,automationId:"GetNPSSurveyFocusShortcut",shortcutProps:{keySequences:["AltDown"],content:i.o},action:r.createElement(o.e,{elementId:"obf-TPromptContainer"})}}],Array(214),[function(e,t,n){"use strict";n.r(t);n.d(t,"graphAddonDataOnlyDeferred",function(){return Ze});var r=n(0),i=n(16),s=n(246),o=n(386),u=n(137),a=n(1200),f=n(1152),l=n(815),c=n(1168),h=n(716),p=n(653),d=n(698),v=n(446),m=n(707),g=n(203),y=n(400),b=n(2018),w=n(2),E=n(787),S=n(1611),x=n(61),T=n(10),N=n(2559),C=n(200);function k(e){switch(e){case"rename":return"rename";case"replace":return"replace";default:return"fail"}}var L=Object(i.i)({mergeForSameItemKey:!1})(function e(t){var n=this,i=t.itemKey,s=t.options.folders,o=u.e.deserialize(i),a=o.endpoint,f=o.driveId,l=o.itemId,c=Object.keys(s)[0],h=s[c],p=h.progressItemKey,d=h.conflictResolution,v=void 0===d?"fail":d,m=Object(E.n)(o);return function(t){return Object(r.__awaiter)(n,void 0,void 0,function(){var n,s,h,d,g,L,O,M;return Object(r.__generator)(this,function(_){switch(_.label){case 0:n=Object(E.t)(o)+"/children";s=k(v);h={name:c,folder:{},"@microsoft.graph.conflictBehavior":s};f&&l&&(h.parentReference={driveId:f,id:l});return[4,t(Object(S.n)({url:n,driveUrl:m,method:"POST",body:h,qosName:"createFolder",endpoint:a})).catch(function(e){throw new y.e({innerError:e,facets:Object(r.__assign)({},Object(b.t)(e,A)||Object(w.n)({},{}))})})];case 1:d=_.sent();g=u.e.serialize({endpoint:a,driveId:f,itemId:d.id});L=new C.e({publisher:e});p&&L.resolveItems({items:(O={},O[p]=Object(r.__assign)({},x.s.pack({itemKey:g})),O)});L.invalidateItems({items:(M={},M[i]=[T.t],M)});L.merge(t(Object(N.e)({itemKey:g,driveItem:d,parentFolderItemKey:i,endpoint:a})).itemResolver);t(L.execute());return[2]}})})}});function A(e){switch(e){case"nameAlreadyExists":case 409:return Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},g.m.pack({supportsRename:!0})),g.t.pack(!0)),g.n.pack(!1))}}var O=n(4034),M=n(6),_=n(122),D=Object(i.i)({mergeForSameItemKey:!1})(function e(t){var n=this,i=t.itemKey,s=t.options.names,o=u.e.deserialize(i);return function(t){return Object(r.__awaiter)(n,void 0,void 0,function(){var n,u,a,f,l,c,h,p;return Object(r.__generator)(this,function(d){switch(d.label){case 0:n=Object.keys(s)[0];u=s[n],a=u.newName,f=u.newExtension;l=Object(E.t)(o);c=Object(E.n)(o);h=t(Object(_.e)({fileName:M.d},i)).fileName;p="string"==typeof f?f:h&&h.extension||"";return[4,t(Object(S.n)({url:l,driveUrl:c,method:"PATCH",body:{name:""+a+p},qosName:"renameItem",endpoint:o.endpoint})).then(function(n){var s,o,u=new C.e({publisher:e});u.invalidateItems({items:(s={},s[i]=[M.h],s)});u.resolveItems({items:(o={},o[i]=Object(r.__assign)(Object(r.__assign)({},M.h.pack(n.name)),M.d.pack(Object(N.t)(n.name||"",!!n.folder))),o)});t(u.execute())}).catch(function(e){if(e instanceof b.e&&e.status===y.t)throw new y.e({facets:Object(r.__assign)({},g.y.pack({})),innerError:e});throw e})];case 1:d.sent();return[2]}})})}});var P=n(4412),H=n(4410),B=n(4408),j=n(4411),F=n(4409),I=n(2612),q=n(233),R=n(332),U=n(106),z=n(2474),W=n(143),X=n(69),V=n(134),$=Object(R.e)(function(){return new B.e({},{})}),J=Object(R.e)(function(e){var t=e(S.e).dataRequestor,n=(function(e){Object(r.__extends)(t,e);function t(t){return e.call(this,t,{performanceNow:F.t})||this}return t})(F.e),i=new H.e({},{dataRequestor:t}),s=new j.e({},{activityBandwidthVerifierType:n,uploadService:i});return new P.e({},{uploadService:i,uploadStateMachine:s})}),K=0;function Q(e){var t=this,n=e.itemKey,i=e.options.sourceEntries,s=u.e.deserialize(n),o=s.endpoint,a=s.driveId,f=Object.keys(i)[0],l=i[f],c=l.progressItemKey,h=l.conflictResolution,p=void 0===h?"fail":h;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,l,h,d,v,m,g,y;return Object(r.__generator)(this,function(b){switch(b.label){case 0:if(!(t=e(Object(_.e)({sourceFile:z.t},f)).sourceFile))throw new Error("No source file for Graph upload.");i=Object(E.t)(s)+":";l=Object(E.n)(s);c&&e(Object(W.e)({items:(m={},m[c]=Object(r.__assign)({},x.y.pack({total:t.size,current:0})),m)}));return[4,e(G({progressItemKey:c,sourceFile:t,itemUrl:i,driveUrl:l,conflictResolution:p,endpoint:o}))];case 1:h=b.sent();d=u.e.serialize({endpoint:o,driveId:a,itemId:h.id});v=new C.e({publisher:Q});c&&v.resolveItems({items:(g={},g[c]=Object(r.__assign)(Object(r.__assign)({},x.s.pack({itemKey:d})),Object(w.n)({progressSize:x.y},{progressSize:{current:t.size}})),g)});v.invalidateItems({items:(y={},y[n]=[T.t],y)});v.merge(e(Object(N.e)({itemKey:d,driveItem:h,parentFolderItemKey:n,endpoint:o})).itemResolver);return[2,{itemResolver:v,driveItem:h,itemKey:d}]}})})}}function G(e){var t=this,n=e.progressItemKey,i=e.sourceFile,s=e.itemUrl,o=e.driveUrl,u=e.endpoint,a=k(e.conflictResolution);return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,f,l,h,p,d,v,m,y,E;return Object(r.__generator)(this,function(S){switch(S.label){case 0:t=e(J);f=e($);return[4,e(Object(I.getSessionToken)(u,o))];case 1:l=S.sent();h=new q.e;p=0;d=h.debounce(function(t){var r;if(t>p){n&&e(Object(W.e)({items:(r={},r[n]=Object(w.n)({progressSize:x.y},{progressSize:{current:t}}),r)}));p=t}},300,{leading:!1});v=e(Object(U.e)(function(e){return e.demandItemFacet(x.i,n)}));m=t.upload({conflictBehavior:a,qosData:{uploadId:""+ ++K},accessToken:l,fileName:i.name,content:i,itemUrl:s,onProgress:d,onPromptForConfictBehavior:function(e){return Promise.reject(e)},onWait:function(e){return f.wait(e)},select:"*,sharepointIds"});y=v?v.token.subscribe(function(){m.cancel()}):void 0;S.label=2;case 2:S.trys.push([2,4,5,6]);return[4,m];case 3:return[2,S.sent()];case 4:E=S.sent();if(X.n.isCanceled(E))throw new V.e;throw new c.e({facets:Object(r.__assign)({},Object(b.t)(E,function(e){switch(e){case"authFailure":case"unauthenticated":case 401:return g.e.pack({});case"nameAlreadyExists":case 409:return g.s.pack({supportsRename:!0})}})||Object(w.n)({},{})),innerError:E});case 5:y&&y();h.dispose();return[7];case 6:return[2]}})})}}var Y=Object(i.i)({mergeForSameItemKey:!1,maxParallelOperationCount:3,timeout:864e5})(function(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return[4,n(Q(e))];case 1:t=r.sent().itemResolver;n(t.execute());return[2]}})})}});var Z=n(14),ee=n(2894),te=Object(Z.t)()(function(){return function(){return function(e,t){var n=t.itemKey;return{isAvailable:e.demandItemFacet(ee.e,n)}}}});var ne=n(1000),re=Object(Z.t)()(function(){return function(){return function(e,t){var n=t.itemKey;return{isAvailable:e.demandItemFacet(ee.r,n),validator:ne.e}}}});var ie=n("react-lib"),se=n(3350),oe=n(32),ue=n(4413),ae=Object(Z.t)()(function(){return function(){return function(e,t){var n=t.itemKey,r=e.demandItemFacet(ee.t,n),i=e.demandItemFacet(se.e,n);return{isAvailable:r&&!i,deleteWizard:fe}}}});var fe=Object(oe.t)(function(e,t){var n=t.itemKeys,i=t.defaultRender,s=Object(r.__rest)(t,["itemKeys","defaultRender"]),o=void 0;1===n.length?o=Object(r.__assign)(Object(r.__assign)({},s),{deleteWizardStrings:Object(r.__assign)(Object(r.__assign)({},s.deleteWizardStrings),{confirmText:ue.e})}):n.length>0&&(o=Object(r.__assign)(Object(r.__assign)({},s),{deleteWizardStrings:Object(r.__assign)(Object(r.__assign)({},s.deleteWizardStrings),{confirmText:ue.t})}));var u=o||s;return i?ie.createElement(i,Object(r.__assign)({itemKeys:n},u)):null}),le=Object(Z.t)()(function(){return function(){return function(e,t){var n=t.itemKey;return{isAvailable:e.demandItemFacet(ee.i,n)}}}});var ce=Object(Z.t)()(function(){return function(e){return he}});function he(e,t){var n=t.itemKey,i=e.demandItemFacet(u.e,n);return{isAvailable:!0,getShareLink:function(){return(function(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,s,o;return Object(r.__generator)(this,function(r){switch(r.label){case 0:if(!(t=e.driveItem))return[3,2];i=Object(E.t)(t)+"/invite";s=Object(E.n)(t);return[4,n(Object(S.r)({url:i,driveUrl:s,method:"POST",qosName:"getDefaultShareLink",endpoint:t.endpoint,headers:{prefer:"getDefaultLink","Content-type":"application/json"}}))];case 1:if(!(o=r.sent()))throw new Error("Unable to obtain default share URL");return[2,{url:o.value[0].link.webUrl,scope:o.value[0].link.scope}];case 2:throw new Error("Unable to obtain default share URL")}})})}})({driveItem:i})}}}var pe=Object(Z.t)()(function(){return function(){return function(){return{}}}});var de=Object(Z.t)()(function(){return function(e){return ve}});function ve(e,t){var n=t.itemKey,i=t.link,s=t.recipients,o=e.demandItemFacet(u.e,n);return{isAvailable:!0,permissionInvite:function(){return(function(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,s,o,u,a,f,l,c,h,p,d;return Object(r.__generator)(this,function(r){switch(r.label){case 0:t=e.driveItem,i=e.link,s=e.recipients;if(!t||!i)throw new Error("Unable to obtain default share URL");o=t.endpoint;a=btoa(i);u="u!"+a.replace(/=/g,"").replace(/\//g,"_").replace(/\+/g,"-");f=s.map(function(e){return{email:e}});l={recipients:f,roles:["read"]};c=o.replace("v1.0","beta");h=c+"/shares/"+u+"/permission/grant";return[4,n(Object(S.r)({url:h,method:"POST",qosName:"permissionGrant",endpoint:t.endpoint,headers:{"Content-type":"application/json",Accept:"application/json"},body:l}))];case 1:p=r.sent();d=p.value[0].grantedToIdentities.map(function(e){return{email:e.user.email}});return[2,{recipients:d}]}})})}})({driveItem:o,link:i,recipients:s})}}}var me=n(3907),ge=n(3906),ye=n(495),be=n(109),we=n(268),Ee=Object(i.i)({mergeForSameItemKey:!1})(function e(t){var n=this,i=t.itemKey,s=t.options,o=s.isFollowed,a=s.progressItemKey,f=ye.e.deserialize(i),l=f.driveItemKey,c=l.itemId,h=void 0===c?"":c,p=Object(E.n)(l);return function(t){return Object(r.__awaiter)(n,void 0,void 0,function(){var n,i,s,c,d,v,m,g,y;return Object(r.__generator)(this,function(b){switch(b.label){case 0:n=t(Object(we.e)({saveForLaterGraphEndpoint:be.A})).saveForLaterGraphEndpoint;i=new C.e({publisher:e});s=ye.e.serialize(f);c=n||l.endpoint;a&&t(Object(W.e)({items:(m={},m[a]=Object(r.__assign)({},x.b.pack({itemKey:u.e.serialize(l)})),m)}));d=o?{url:c+"/drives/"+l.driveId+"/items/"+h+"/follow",method:"POST",qosName:"followItem"}:{url:c+"/drives/"+l.driveId+"/following/"+h,method:"DELETE",qosName:"unfollowItem"};b.label=1;case 1:b.trys.push([1,3,,4]);return[4,t(Object(S.n)({url:d.url,driveUrl:p,method:d.method,qosName:d.qosName,endpoint:c}))];case 2:b.sent();i.invalidateItems({items:(g={},g[s]=[M.E],g)});i.resolveItems({items:(y={},y[s]=Object(r.__assign)({},M.E.pack(o||void 0)),y)});t(i.execute());return[3,4];case 3:v=b.sent();throw new Error(v.message);case 4:return[2]}})})}});var Se=n(575),xe=n(1050),Te=n(1112),Ne=n(3032);function Ce(e,t){return Ne.e.serialize(Object(r.__assign)({driveItemKey:e.driveItemKey},t?{searchTerm:t}:{searchTerm:void 0}))}var ke=Object(Z.t)()(Ae),Le=Object(Z.t)()(Ae);function Ae(){return function(e){return function(e,t){var n,r=t.itemKey,i=e.demandItemFacet(Te.e,r);if(i)n=function(e){return i?Ce(i,e):void 0};else{var s=e.demandItemFacet(Ne.e,r);n=function(e){return s?Ce(s,e):void 0}}return{isAvailable:!0,getSearchItemKey:n}}}}var Oe=n(794),Me=n(1183),_e=n(443),De=Object(Z.t)()(function(){return function(e){return Pe}});function Pe(e,t){var n=t.handlers,i=t.itemKey,s=e.demandItemFacet(Te.e,i),o=e.demandItemFacet(Ne.e,i);if(n&&(s||o)){for(var u=[],a=0,f=n;a<f.length;a++){var l=f[a];if(l.key===_e.o.key)u.push("photo");else if(l.key===_e.u.key)u.push("video");else if(l.key===_e.e.key)u.push("folder");else if(l.key===_e.s.key)u.push("onenote");else if(l.key===_e.r.key)u.push("!photo");else if(l.key===_e.i.key)u.push("!video");else if(l.key===_e.t.key)u.push("!folder");else if(l.key===_e.n.key)u.push("!onenote");else{var c=Object(Me.e)(l);c&&u.push(c)}}if(s)return{itemKey:Te.e.serialize(Object(r.__assign)(Object(r.__assign)({},s),{extFilters:u}))}}return{}}var He=n(3315),Be=n(1238),je=n(2893),Fe=Object(i.i)({mergeForSameItemKey:!1})(function e(t){var n=this,i=t.itemKey,s=t.options,o=Object.keys(s)[0];return function(t){return Object(r.__awaiter)(n,void 0,void 0,function(){var n,a,f,l,c,h,p,d,v,m,w,x,N,k;return Object(r.__generator)(this,function(L){switch(L.label){case 0:if(!t(Object(U.e)(function(e){return e.demandItemFacet(u.e,o)})))throw new Error("Source item does not have a driveItem key");n=s[o],a=n.isMove,f=n.conflictBehavior,l=n.progressItemKey;c=u.e.deserialize(i);return[4,t(Object(Be.e)(function(e){return e.demandItemFacet(u.e,o)}))];case 1:if(!(h=L.sent()))throw new Error("Unable to get metadata for destination item.");p=Object(E.t)(h);d=Object(E.n)(h);v=h.endpoint;L.label=2;case 2:L.trys.push([2,4,,5]);return[4,t(Object(S.n)({url:p+(a?"":"/copy"),driveUrl:d,method:a?"PATCH":"POST",body:{parentReference:{id:c.itemId||je.n,driveId:c.driveId||""},"@microsoft.graph.conflictBehavior":f},qosName:a?"moveItem":"copyItem",endpoint:v}))];case 3:m=L.sent();(w=new C.e({publisher:e})).invalidateItems({items:(N={},N[o]=a?[M.M,M.l]:[],N[i]=[T.t],N)});l&&!a&&m.name&&w.resolveItems({items:(k={},k[l]=Object(r.__assign)({},M.h.pack(m.name)),k)});t(w.execute());return[3,5];case 4:if((x=L.sent())instanceof b.e&&x.status===y.t)throw new He.e({innerError:x,facets:Object(r.__assign)({},g.c.pack(x.status))});throw x;case 5:return[2]}})})}});var Ie=n(1223),qe=Object(Z.t)()(function(){return function(){return function(e,t){return{validator:ne.e}}}});var Re=n(79),Ue=n(158),ze=n(692),We=n(307),Xe=n(3899),Ve=n(769),$e=n(808),Je=n(3353),Ke=n(393),Qe=n(3929),Ge=Object(i.i)()(function(e){var t=e.itemKey,n=e.options.itemSetKey;return function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var i,s,o,a,f,l;return Object(r.__generator)(this,function(r){switch(r.label){case 0:if(!Ke.e.matches(n))throw new y.e({code:"invalidItemSetForAddToOneDrive"});i=Ke.e.deserialize(n).driveItemKey.endpoint;s=e(Object(U.e)(function(e){return{fileName:e.demandItemFacet(M.d,t),sharepointIds:e.demandItemFacet(Je.e,t),remoteDriveInfo:e.demandItemFacet(u.e,t)}})),o=s.fileName,a=s.sharepointIds,f=s.remoteDriveInfo;if(!(i&&o&&f&&a))throw new y.e({code:"missingItemInfoForAddToOneDrive"});r.label=1;case 1:r.trys.push([1,3,,4]);return[4,e(Object(Qe.t)({name:o.name,sharepointIds:a,qosName:"AddToOneDrive_SWM",endpoint:i}))];case 2:r.sent();return[3,4];case 3:if(!((l=r.sent())instanceof b.e))throw l;Object(Qe.e)(l);return[3,4];case 4:return[2]}})})}}),Ye=Object(Ue.e)(function(){return n.ee(0,4810)},{chunkName:"addon-graph-deferredoperations"}),Ze=Object(i.t)(function(){return function(e){var t=e(Object(we.e)({useBatchedDeleteConfiguration:be._})).useBatchedDeleteConfiguration;e(Object(Ve.e)(function(){e(Object(o.e)(Te.e,xe.e)(ke));e(Object(o.e)(Ne.e,xe.e)(Le));e(Object(o.e)(Te.e,Oe.e)(De));e(Object(s.r)(u.e,a.t)(L));e(t?Object(s.r)(u.e,f.t)(Object(i.r)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(t){switch(t.label){case 0:return[4,e(Object(Re.o)())];case 1:t.sent();return[4,Ye()];case 2:return[2,t.sent().driveItemDeleteItemsBatchedOperationHandler]}})})})):Object(s.r)(u.e,f.t)(O.e));e(Object(s.r)(u.e,l.t)(D));e(Object(s.r)(u.e,c.t)(Y));e(Object(s.r)(u.e,He.t)(Fe));e(Object(s.r)(u.e,$e.t)(Ge));e(Object(o.e)(u.e,h.e)(te));e(Object(o.e)(u.e,Ie.e)(qe));e(Object(o.e)(u.e,p.e)(re));e(Object(o.e)(u.e,d.t)(ae));e(Object(o.e)(u.e,v.e)(le));e(Object(o.e)(u.e,me.e)(ce));e(Object(o.e)(u.e,ge.e)(de));e(Object(o.e)(u.e,m.e)(pe));e(Object(s.r)(ye.e,Se.e)(Ee));e(Object(s.r)(ze.e,We.e)(Xe.e))}))}})},function(e,t,n){"use strict";n.r(t);n.d(t,"spItemUploadItemsOperationHandler",function(){return vt.spItemUploadItemsOperationHandler});n.d(t,"spItemCreateFolderOperationHandler",function(){return mt.spItemCreateFolderOperationHandler});n.d(t,"spItemCreateDocumentOperationHandler",function(){return gt.spItemCreateDocumentOperationHandler});n.d(t,"getSPFilterOptionSetHandler",function(){return ke.getSPFilterOptionSetHandler});n.d(t,"spDataOnlyAddonDeferred",function(){return Pt});n.d(t,"spfxAddon",function(){return Ht});n.d(t,"spNeedsAttentionAddon",function(){return Bt});n.d(t,"spWebPageContextAddon",function(){return jt});n.d(t,"spLikedByItemAddon",function(){return Ft});n.d(t,"spListViewsAddon",function(){return It});var r,i=n(0),s=n(16),o=n(246),u=n(1168),a=n(307),f=n(816),l=n(43),c=n(521),h=n(78),p=n(851),d=n(1014),v=n(90),m=n(1040),g=n(1377),y=n(1047),b=n(1344),w=n(1366),E=n(1046),S=n(3547),x=n(3545),T=n(3546),N=n(3902),C=n(3903),k=n(461),L=n(1275),A=n(2095),O=n(3908),M=n(3359),_=n(3549),D=n(386),P=n(1002),H=n(2),B=n(363);(function(e){e[e.preview=0]="preview";e[e.save=1]="save"})(r||(r={}));var j=new H.e("updateColumnFormatter"),F=(Object(B.e)({operationTypeFacet:j}),n(4115)),I=n(1382),q=n(1383),R=n(718),U=n(200),z=n(10),W=n(3536),X=n(268),V=n(1),$=n(831),J=Object(s.i)()(function(e){var t=this,n=e.itemKey,r=I.e.deserialize(n).tenantRootUrl;return function(e){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,s,o,u;return Object(i.__generator)(this,function(a){t=new U.e;s=e(Object(X.e)({enableQuickAccessConfiguration:V.J})).enableQuickAccessConfiguration;o=e(Object(X.e)({enableQuickAccessPinningConfiguration:V.K})).enableQuickAccessPinningConfiguration;t.resolveItems({items:(u={},u[n]=Object(i.__assign)({},z.e.pack({itemKeys:[q.e.serialize({tenantRootUrl:r}),s?o?$.e.serialize({tenantRootUrl:r}):W.e.serialize({tenantRootUrl:r}):R.e.serialize({tenantRootUrl:r})]})),u)});e(t.execute());return[2]})})}});var K=n(1238),Q=n(106),G=n(123),Y=n(28),Z=n(155),ee=n(667),te=n(333),ne=n(6),re=n(2383),ie=n(403),se=n(407),oe=n(606),ue=n(196),ae=n(109),fe=n(55),le=Object(s.i)()(function(e){var t=this,n=e.itemKey,r=q.e.deserialize(n).tenantRootUrl;return function(e){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,s,o,u,a,f,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k;return Object(i.__generator)(this,function(L){switch(L.label){case 0:t=new U.e;s=ee.e.serialize({tenantRootUrl:r});return[4,e(Object(K.e)(function(e){return e.demandItemFacet(l.e,s,{suppressGetItems:!1})}))];case 1:return(o=L.sent())?[4,e(Object(K.e)(function(e){return e.demandItemFacet(V.ln,te.e.serialize({webAbsoluteUrl:o.webAbsoluteUrl,listFullUrl:o.listFullUrl}))}))]:[2];case 2:u=L.sent();a=e(Object(Q.e)(function(e){return{isSavedForLaterEnabled:e.demandItemFacet(Y.p,Z.e),isSharedWithMeEnabled:!!e.demandItemFacet(ae.w,Z.e)}})),f=a.isSavedForLaterEnabled,c=a.isSharedWithMeEnabled;h={};p=u&&u.userDisplayName;d=l.e.serialize(o);h[d]={icon:"FabricFolder",displayName:ue.files};t.mapKeys({mappings:(N={},N[d]=s,N)});v=ie.e.serialize({endpoint:r+"/_api/v2.0"});h[v]={icon:"History",displayName:re.n};m=se.e.serialize({endpoint:r+"/_api/v2.0"});h[m]={icon:"SingleBookmark",displayName:re.r};g=oe.e.serialize({endpoint:""+r});h[g]={icon:"People",displayName:re.s};y=Object(i.__spreadArrays)([d,v],c?[g]:[],f?[m]:[]);for(b=0,w=y;b<w.length;b++){E=w[b];S=h[E],x=S.icon,T=S.displayName;t.resolveItems({items:(C={},C[E]=Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({},G.t.pack(x)),ne.h.pack(T)),ne.m.pack({})),C)})}t.resolveItems({items:(k={},k[n]=Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({},z.e.pack({itemKeys:y})),fe.s.pack(!0)),ne.h.pack(p)),k)});e(t.execute());return[2]}})})}});var ce=n(1384),he=n(3029),pe=n(465),de=Object(s.i)({mergeForSameItemKey:!1})(function(e){var t=this,n=Object.keys(e.options),r=e.itemKey,s=n[0],o=e.options[s],u=o.type,a=o.reorderPinInfo,f=ce.e.serialize({itemKey:s,rootItemKey:r});return function(e){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,n,o,l,c,h,p,d,v;return Object(i.__generator)(this,function(m){switch(m.label){case 0:t=e(Object(Q.e)(function(e){return e.demandItem({siteId:V.Pt,webId:V.Ln,groupId:V.be},s)})),n=t.siteId,o=t.webId,l=t.groupId;c=new U.e;h=(function(e,t){switch(e){case"pin":return me();case"unpin":return;case"reorderPin":if(t){var n=t.nextPinOrder,r=t.prevPinOrder;if(n||r)return r?n?(r+n)/2:r/2:me()}return;default:return}})(u,a);c.resolveItems({items:(d={},d[f]=Object(i.__assign)({},V.vt.pack(h)),d)});e(c.execute());return(p=R.e.deserialize(r).tenantRootUrl)?[4,e(ve(p,{siteId:n||"",webId:o||"",groupId:l},u,a))]:[3,2];case 1:m.sent();(c=new U.e).invalidateItems({items:(v={},v[f]=[V.vt],v)});e(c.execute());m.label=2;case 2:return[2]}})})}});function ve(e,t,n,r){var s=this;return function(o){return Object(i.__awaiter)(s,void 0,void 0,function(){var s,u,a,f,l;return Object(i.__generator)(this,function(i){switch(i.label){case 0:if("pin"===n){s="api/v1/sites/pinned/add";u="pinSite"}else if("unpin"===n){s="api/v1/sites/pinned/remove";u="unpinSite"}else{if("reorderPin"!==n)return[2];if(!r)return[2];a=Object(pe.e)({PreviousPinOrder:r.prevPinOrder||"",NextPinOrder:r.nextPinOrder||""},void 0,!0);s="api/v1/sites/pinned/update?"+a;u="reorderSite"}return[4,o(Object(he.t)({tenantRootUrl:e}))];case 1:f=i.sent();l="";t&&(l=JSON.stringify({Title:t.title,Acronym:t.acronym,BannerColor:t.color,Url:t.url,Type:"Site",ItemReference:{Type:t.groupId?"GroupReference":"SiteReference",SiteId:t.siteId,WebId:t.webId,GroupId:t.groupId}}));return[4,o(Object(he.e)({path:s,method:"POST",qosName:u,context:f,body:l}))];case 2:i.sent();return[2]}})})}}function me(e){void 0===e&&(e=new Date);return 621355968e9+1e4*e.getTime()}var ge=n(3349),ye=n(1438),be=Object(s.t)(function(){return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(t){e(ye.e);e(Object(o.r)(I.e,a.e)(J));e(Object(o.r)(q.e,a.e)(le));e(Object(o.r)(R.e,ge.t)(de));return[2]})})}}),we=n(1381),Ee=n(231),Se=n(874),xe=Object(s.i)({maxParallelOperationCount:4})(function(e){var t=this,n=e.itemKey,r=we.e.deserialize(n).tenantRootUrl;return function(n){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,s,o,u,a,f,l,c,h,p,d,v;return Object(i.__generator)(this,function(m){switch(m.label){case 0:t=b.e.serialize({webAbsoluteUrl:r});return[4,n(Object(K.e)(function(e){return e.demandItemFacet(V.ft,t)}))];case 1:s=m.sent();o=n(Object(Q.e)(function(e){return e.demandItemFacet(Y.N,Z.e)}));u=!s;f=o&&o.language||"en-US";l=Object(pe.e)({Locale:f,v:2,msajax:1,cv:2});a=u?r+"/_layouts/15/online/handlers/SpoSuiteLinks.ashx?"+l:Object(Se.n)({webAbsoluteUrl:r}).segments("Microsoft.SharePoint.Portal.SuiteNavData.GetSuiteNavData").parameters({v:2,Locale:f});return[4,n(Object(Ee.t)({url:a.toString(),qosName:"LoadData",method:"POST",webAbsoluteUrl:r,noRedirect:!0}))];case 2:c=m.sent();h=u?c:JSON.parse(c.d.GetSuiteNavData);p=!(!h.NavBarData||!h.NavBarData.AdminLink)||void 0;(d=new U.e).resolveItems({items:(v={},v[e.itemKey]=Object(i.__assign)({},V.yn.pack(p)),v)});n(d.execute());return[2]}})})}});var Te=Object(s.t)(function(){return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(t){e(Object(o.r)(we.e,a.e)(xe));return[2]})})}}),Ne=n(3357),Ce=n(3033),ke=n(3793),Le=n(905),Ae=n(826),Oe=n(304),Me=n(310),_e=n(148),De=n(122),Pe=n(306),He=n(1351),Be=n(12),je=n(4306),Fe=n(58),Ie=n(1052),qe=n(42),Re=n(1352),Ue=n(67),ze=Object(s.i)()(function(e){var t=e.itemKey,n=m.e.deserialize(t),r=n.webAbsoluteUrl,s=n.listFullUrl;return function(e){var n,o=e(Object(He.t)({webAbsoluteUrl:r,listFullUrl:s}));if(o.listTemplate===Be.t.mySiteDocumentLibrary){var u=new U.e;u.resolveItems({items:(n={},n[t]=Object(i.__assign)({},z.e.pack(void 0)),n)});e(u.execute());return Promise.resolve()}return e(Object(He.e)(r,s,o)).then(function(n){return e(Object(Re.e)({customActionSetKey:t,customActions:n,context:o}))}).then(function(t){return e(t.execute())})}}),We=Object(s.i)()(function(e){var t=this,n=e.itemKey,r=g.e.deserialize(n),s=r.webAbsoluteUrl,o=r.listFullUrl,u=r.isSPFXandCustomActionsAvailable,a=r.targetCustomActionSetKey,f=r.itemsScopeItemKey;return function(e){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,r,l,c,h,d,m,g,y,b,w;return Object(i.__generator)(this,function(E){switch(E.label){case 0:t=new U.e;r=v.e.serialize({webAbsoluteUrl:s,listFullUrl:o});l=e(Object(Q.e)(Ie.e));c=function(){var n;t.resolveItems({items:(n={},n[r]=_e.u.pack(void 0),n)});e(t.execute())};if(!u&&!l){c();return[2]}return(d=l)?[4,l()]:[3,2];case 1:d=E.sent();E.label=2;case 2:m=!1;if(!(h=d))return[3,7];g=h.createListViewAdapter();t.resolveItems({items:(w={},w[r]=Object(i.__assign)({},g?_e.u.pack(g):{}),w)});y=e(Object(De.e)({rawCustomActions:V.Ct},a)).rawCustomActions;return[4,Xe({setKey:n,actions:y||[],listViewAdapter:g},e)];case 3:b=E.sent().itemResolver;t.merge(b);return[4,e(Object(K.e)(function(e){var n=Object(qe.e)(e,f);if(n&&g){var r=e.demandItemFacet(z.e,n),u=r&&r.itemKeys,a=function(n){var r,s=e.isItemFacetResolved(V.At,n)?e.demandItemFacet(V.At,n):void 0;if(s&&g){var o=g.createRowAdapter({values:s});t.resolveItems({items:(r={},r[n]=Object(i.__assign)({},o?_e.a.pack(o):{}),r)})}else if(e.demandItemFacet(p.e,n)){var u=e.isItemFacetResolved(z.e,n)?e.demandItemFacet(z.e,n):void 0;if(u)for(var f=0,l=u.itemKeys;f<l.length;f++){var c=l[f];a(c)}}};if(u)for(var l=0,c=u;l<c.length;l++){var h=c[l];a(h)}var d=e.demandItemFacet(z.o,n),v=d&&d.columnKeys||[];if(v&&g)for(var y=function(n){var r,i=e.demandItem({fieldId:V.le,internalName:V.Te,realFieldName:V.kt,fieldType:V.fe,isRequired:Oe.r,displayName:ne.h,clientSideComponentId:_e.e,clientSideComponentProperties:_e.t},n),u=i.fieldId,a=i.internalName,f=i.realFieldName,l=i.fieldType,c=i.isRequired,h=i.displayName,p=i.clientSideComponentId,d=i.clientSideComponentProperties;if(u&&a){m=!0;var v={listKey:{webAbsoluteUrl:s,listFullUrl:o},internalName:a},y={id:u,internalName:f||a,fieldType:l||"Text",isRequired:c||!1,isVisible:!0,displayName:h||"",clientSideComponentId:p||Fe.e.Empty,clientSideComponentProperties:d||"",onSetVisible:function(e){return console.log("ISpfxAdapter.IColumn.onSetVisible not implemented")},onFieldCustomizerError:function(e){console.log("Fail to load customizer for column: "+a+",\n                      componentId: "+p+", error: "+e.message)}},b=g.addColumnAdapter(y);if(p&&p!==Fe.e.Empty){var w=Ae.e.serialize(v);t.resolveItems({items:(r={},r[w]=_e.n.pack(b),r[n]=_e.r.pack(w),r)})}}},b=0,w=v;b<w.length;b++){y(w[b])}}}))];case 4:E.sent();return m?[4,g.loadFieldCustomizers()]:[3,6];case 5:E.sent();E.label=6;case 6:return[3,8];case 7:c();E.label=8;case 8:e(t.execute());return[2]}})})}});function Xe(e,t){return Object(i.__awaiter)(this,void 0,void 0,function(){var n,r,s,o,u,a,f,l,c,h,p;return Object(i.__generator)(this,function(d){switch(d.label){case 0:n=e.setKey,r=e.actions,s=e.listViewAdapter;o=new U.e;u=[];a=0;f=function(e){var r,f,l,c,h,p,d,v,m,g,y,b;return Object(i.__generator)(this,function(i){switch(i.label){case 0:r=[];if(!Object(Pe.t)(e))return[3,5];f=e.children;l=0;c=0,h=f;i.label=1;case 1:if(!(c<h.length))return[3,5];p=h[c];d=p.id?p.id:p.text+a+"."+l;v=Le.e.serialize({actionId:d});return $e(p)&&s?[4,Ve({action:p,listViewAdapter:s,setKey:n},t)]:[3,3];case 2:m=i.sent(),b=m.actionKeys,y=m.itemResolver;o.merge(y);b.forEach(function(e){r.push(e)});i.label=3;case 3:r.push(v);l++;i.label=4;case 4:c++;return[3,1];case 5:return!Object(Pe.t)(e)&&$e(e)&&s?[4,Ve({action:e,listViewAdapter:s,setKey:n},t)]:[3,7];case 6:g=i.sent(),y=g.itemResolver,b=g.actionKeys;o.merge(y);u=u.concat(b);i.label=7;case 7:a++;return[2]}})};l=0,c=r;d.label=1;case 1:if(!(l<c.length))return[3,4];h=c[l];return[5,f(h)];case 2:d.sent();d.label=3;case 3:l++;return[3,1];case 4:o.resolveItems({items:(p={},p[n]=Object(i.__assign)(Object(i.__assign)({},fe.s.pack(!0)),z.e.pack(0===u.length?void 0:{itemKeys:u})),p)});return[2,{itemResolver:o}]}})})}function Ve(e,t){return Object(i.__awaiter)(this,void 0,void 0,function(){var n,r,s,o,u,a,f,l,c,h;return Object(i.__generator)(this,function(p){switch(p.label){case 0:n=e.action,r=e.listViewAdapter,s=e.setKey;o=g.e.deserialize(s);u=o.targetCustomActionSetKey;a=new U.e;f=[];l=n.clientSideComponentId&&n.clientSideComponentId.toString()||"";c=n.clientSideComponentProperties||"";return l&&l!==Fe.e.Empty?[4,r.loadCommandSet(l,c).catch(function(){})]:[2,{itemResolver:a,actionKeys:[]}];case 1:if((h=p.sent())&&h.commandAdapters){Ue.t.isActivated(je.e,"09/27/2021","Fix of onExecute communication with SPFx Command Set")||(h.onChange=function(e){(function(e,t){var n=new U.e,r={};Object.keys(t).forEach(function(e){var n=t[e];r[e]=Object(i.__assign)(Object(i.__assign)({},ne.h.pack(n.title)),_e.s.pack(n.visible))});n.resolveItems({items:r});e(n.execute())})(t,e)});h.commandAdapters.forEach(function(e){var t,r="";r=Ue.t.isActivated("3d0eacb4-96d8-4af7-9dba-37e597ccff42")?n.clientSideComponentId+"."+e.commandId:u+"."+n.clientSideComponentId+"."+e.commandId;var s=Le.e.serialize({actionId:r});Ue.t.isActivated(je.e,"09/27/2021","Fix of onExecute communication with SPFx Command Set")||(e.itemKey=s);a.resolveItems({items:(t={},t[s]=Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({},ne.h.pack(e.title)),ne.O.pack(n.action)),Me.e.pack(n.allowMultiSelect)),Me.n.pack(n.isEnabled||!1)),Me.t.pack(e.iconUrl||n.iconUrl)),_e.i.pack(e)),_e.s.pack(e.visible)),t)});f.push(s)})}return[2,{itemResolver:a,actionKeys:f}]}})})}function $e(e){return e&&(!!e.clientSideCommandAdapter||e.clientSideComponentId&&e.clientSideComponentId!==Fe.e.Empty)||!1}var Je=Object(s.i)({maxParallelOperationCount:4})(function(e){var t=this,n=e.itemKey,r=b.e.deserialize(n).webAbsoluteUrl;return function(n){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,s,o,u,a,f,l;return Object(i.__generator)(this,function(c){switch(c.label){case 0:t=Object(Se.n)({webAbsoluteUrl:r}).segments("ComponentContextInfo");return[4,n(Object(Ee.t)({url:t.toString(),qosName:"GetWebPageContext",method:"GET",webAbsoluteUrl:r,noRedirect:!0}))];case 1:s=c.sent();o=JSON.parse(s.d.SerializedData);u=o.isSPO,a=void 0===u||u;(f=new U.e).resolveItems({items:(l={},l[e.itemKey]=Object(i.__assign)(Object(i.__assign)({},V.ft.pack(a?void 0:{})),V.ln.pack(o)),l)});n(f.execute());return[2]}})})}});var Ke=n(3907),Qe=n(14),Ge=n(3548),Ye=n(160),Ze=Object(Qe.t)()(tt),et=Object(Qe.t)()(tt);function tt(){return function(e){return nt}}function nt(e,t){var n=t.itemKey,r=e.demandItem({driveItem:l.e,canonicalLinkUrl:ne.i},n),s=r.driveItem,o=r.canonicalLinkUrl;return{isAvailable:!0,getShareLink:function(){return(function(e){var t=this;return function(n){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,r,s,o,u,a,f,l,c,h,p;return Object(i.__generator)(this,function(i){switch(i.label){case 0:t=e.driveItem,r=e.canonicalLinkUrl;if(t&&r)return[3,1];throw new Error("Unable to obtain default share URL");case 1:s=void 0;if(r){o=new Ye.e(r);u=o.authority;for(a=0,f=o.segments;a<f.length;a++)""!==(l=f[a])&&(u=u+"/"+encodeURIComponent(l));c=Object(Ge.e)(u.toString());s="u!"+c.replace(/=/g,"").replace(/\//g,"_").replace(/\+/g,"-")}h=new Ye.e(t.webAbsoluteUrl).authority;return[4,n(Object(Ee.t)({webAbsoluteUrl:h,listFullUrl:void 0,url:h+"/_api/v2.0/shares/"+s+"/driveItem/invite",body:void 0,method:"POST",additionalHeaders:{prefer:"getDefaultLink","Content-type":"application/json",Accept:"application/json"},qosName:"getDefaultShareLink",noRedirect:!0}))];case 2:return[2,{url:(p=i.sent()).value[0].link.webUrl,scope:p.value[0].link.scope}]}})})}})({driveItem:s,canonicalLinkUrl:o})}}}var rt=n(2431),it=n(2164),st=n(3906),ot=Object(Qe.t)()(function(){return function(e){return ut}});function ut(e,t){var n=t.itemKey,r=t.link,s=t.recipients,o=e.demandItem({driveItem:l.e},n).driveItem;return{isAvailable:!0,permissionInvite:function(){return(function(e){var t=this;return function(n){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,r,s,o,u,a,f,l,c,h;return Object(i.__generator)(this,function(i){switch(i.label){case 0:t=e.driveItem,r=e.link,s=e.recipients;if(!t)return[3,2];void 0;u=Object(Ge.e)(r);o="u!"+u.replace(/=/g,"").replace(/\//g,"_").replace(/\+/g,"-");a=s.map(function(e){return{email:e}});f={recipients:a,roles:["read"]};l=new Ye.e(t.webAbsoluteUrl).authority;return[4,n(Object(Ee.t)({webAbsoluteUrl:l,listFullUrl:void 0,url:l+"/_api/v2.0/shares/"+o+"/permission/invite",body:JSON.stringify(f),method:"POST",additionalHeaders:{"Content-type":"application/json",Accept:"application/json"},qosName:"permissionInvite",noRedirect:!0}))];case 1:c=i.sent();h=c.value[0].grantedToIdentities.map(function(e){return{email:e.user.email}});return[2,{recipients:h}];case 2:throw new Error("Unable to set permissions on the sharing URL")}})})}})({driveItem:o,link:r,recipients:s})}}}var at=n(1057),ft=n(137),lt=n(787),ct=n(439),ht=n(115),pt=Object(Qe.t)()(function(){return function(e){return function(e,t){var n=t.itemKey,r=void 0,i=e.demandItem({key:l.e,driveItemKey:ft.e},n),s=i.key,o=i.driveItemKey;if(o)return{driveItemFullUrl:Object(lt.t)(o)};if(s){var u={webAbsoluteUrl:s.webAbsoluteUrl,listFullUrl:s.listFullUrl},a=e.demandItem({listMediaFacets:ct.t},v.e.serialize(u)).listMediaFacets;if(a&&a[".driveUrl"]){var f=a[".driveUrl"],c=s.rootFolder||"",h="";if(c){var p=new ht.t({context:{webAbsoluteUrl:s.webAbsoluteUrl,listUrl:s.listFullUrl}}).getUrlParts();p.serverRelativeListUrl&&"/"!==(h=c.replace(p.serverRelativeListUrl,"")).charAt(0)&&(h="/"+h)}return{driveItemFullUrl:r=f+"/items/root"+(h?":":"")+h}}}return{driveItemFullUrl:r}}}});var dt=n(1272),vt=n(1652),mt=n(1653),gt=n(1654),yt=n(1392),bt=n(3358),wt=n(4142),Et=n(4305),St=n(3905),xt=n(3345),Tt=n(1369),Nt=n(190),Ct={key:Tt.e,displayName:ne.h,email:Nt.e,picture:Nt.r},kt=Object(s.i)()(function(e){var t=this,n=e.itemKey,r=w.e.deserialize(n),s=r&&r.spItem,o=s.webAbsoluteUrl,u=s.listFullUrl,a=s.itemId;return function(e){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,r,s,f,l,c,h;return Object(i.__generator)(this,function(p){switch(p.label){case 0:t=a&&Object(Se.e)({webAbsoluteUrl:o,listFullUrl:u}).method("GetItemById",a).segment("likedByInformation");r=new U.e;return(f=t)?[4,e(Object(Ee.r)({url:t.toString()+"&$expand=likedby&$top=10",method:"GET",qosName:"likedByInformation",webAbsoluteUrl:o,listFullUrl:u}))]:[3,2];case 1:f=p.sent();p.label=2;case 2:l=[];(c=(s=f)&&s.d&&s.d.likedBy&&s.d.likedBy.results)&&c.forEach(function(e){var t,n=e.email,i=Tt.e.serialize({id:String(n)});r.resolveItems({items:(t={},t[i]=Object(H.n)(Ct,{key:{id:String(n)},displayName:e.name,email:n,picture:n}),t)});l.push(i)});r.resolveItems({items:(h={},h[n]=Object(i.__assign)({},ne.N.pack({personKeys:l})),h)});e(r.execute());return[2]}})})}});var Lt=n(3034),At=n(204),Ot=n(611),Mt=n(1386),_t=Object(s.i)({maxParallelOperationCount:8})(function e(t){var n=this,r=t.itemKey,s=E.e.deserialize(r),o=s.webAbsoluteUrl,u=s.listFullUrl;return function(t){return Object(i.__awaiter)(n,void 0,void 0,function(){var n,a,f,l,c,h,p,d,m,g;return Object(i.__generator)(this,function(y){switch(y.label){case 0:n=[];a=new U.e({publisher:e});f=v.e.serialize({webAbsoluteUrl:s.webAbsoluteUrl,listFullUrl:s.listFullUrl});l=t(Object(De.e)({list:V.Ue},f));c=t(Object(X.e)({localeConfiguration:Y.N})).localeConfiguration;return[4,t(Object(Lt.t)({webAbsoluteUrl:o,listFullUrl:u,listTemplate:l.list&&l.list.templateType,preferredLanguage:c&&c.language}))];case 1:h=y.sent();p={};d=void 0;h.filter(function(e){return!!e.view}).map(function(e){var r,s=e.serverView,f=e.view,l={viewId:f.id},c=At.e.serialize(l);if(f.isDefault){d=c;var h=f.getDomParts().newDocumentTemplates;h&&h.textContent&&a.merge(Object(Mt.e)({webAbsoluteUrl:o,listFullUrl:u,newDocumentTemplatesString:h.textContent}).itemResolver)}p[c]=f;Object(Ot.n)(f);var v=t(Object(Q.e)(function(e){if(e.isItemFacetResolved(V.m,c))return e.demandItemFacet(V.m,c)})),m=!!v&&v.getEffectiveViewXml().replace(/ \/>/g,"/>")===f.getEffectiveViewXml().replace(/ \/>/g,"/>");a.resolveItems({items:(r={},r[c]=Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({},At.e.pack(l)),V.Ot.pack(s)),m?{}:V.m.pack(f)),V.Dt.pack(!1)),V.kn.pack(f.viewType)),r)});n.push(c)});n.sort(function(e,t){return p[e].compareTo(p[t])});a.resolveItems({items:(m={},m[r]=Object(i.__assign)(Object(i.__assign)({},E.e.pack(s)),z.e.pack({itemKeys:n})),m)});d&&a.resolveItems({items:(g={},g[f]=Object(i.__assign)({},V.w.pack({viewKey:d})),g)});t(a.execute());return[2]}})})}});var Dt=n(3904),Pt=Object(s.t)(function(){return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(t){e(wt.sharePointBasicActionsAddonDeferred);e(Et.sharePointBasicItemDataAddonDeferred);e(yt.e);e(F.e);e(be);e(Te);e(Ht);e(Bt);e(jt);e(Ft);e(It);e(Object(o.r)(l.e,x.t)(Object(s.r)(function(){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([34],4712)];case 1:return[2,e.sent().updateCheckoutState]}})})})));e(Object(o.r)(l.e,T.t)(Object(s.r)(function(){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([49],4713)];case 1:return[2,e.sent().publishItem]}})})})));e(Object(o.r)(l.e,N.t)(Object(s.r)(function(){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([50],4714)];case 1:return[2,e.sent().updateItemRating]}})})})));e(Object(o.r)(l.e,C.t)(Object(s.r)(function(){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([45],4715)];case 1:return[2,e.sent().updateItemLikes]}})})})));e(Object(o.r)(l.e,f.t)(Object(s.r)(function(){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([35],4716)];case 1:return[2,e.sent().createCustomDocument]}})})})));e(Object(o.r)(c.e,S.e)(Object(s.r)(function(){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([44],3796)];case 1:return[2,e.sent().editPinnedItem]}})})})));e(Object(o.r)(l.e,k.e)(Object(s.r)(function(){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([65],4717)];case 1:return[2,e.sent().assignItemsToGroup]}})})})));e(Object(o.r)(h.e,P.t)(Object(s.r)(function(){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee(0,3559)];case 1:return[2,e.sent().modifyColumn]}})})})));e(Object(o.r)(h.e,Dt.t)(Object(s.r)(function(){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([46],4718)];case 1:return[2,e.sent().modifyColumnAggregateType]}})})})));e(Object(o.r)(h.e,j)(Object(s.r)(function(){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([40],4719)];case 1:return[2,e.sent().updateColumnFormatter]}})})})));e(Object(o.r)(h.e,it.t)(Object(s.r)(function(){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([62],5002)];case 1:return[2,e.sent().refreshItemsInSet]}})})})));e(Object(o.r)(h.e,dt.t)(Object(s.r)(function(){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([61],4720)];case 1:return[2,e.sent().bulkUpdateListItems]}})})})));e(Object(o.r)(p.e,u.t)(Object(s.r)(function(){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([63],4721)];case 1:return[2,e.sent().uploadItemsToGroupOperationHandler]}})})})));e(Object(o.r)(h.e,Ne.t)(Object(s.r)(function(){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([41],4722)];case 1:return[2,e.sent().updateCustomFormatter]}})})})));e(Object(o.r)(h.e,Ce.t)(Object(s.r)(function(){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([47],4723)];case 1:return[2,e.sent().modifyFieldProperties]}})})})));e(Object(o.r)(l.e,rt.e)(Object(s.r)(function(){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([68],4724)];case 1:return[2,e.sent().updateListItem]}})})})));e(Object(o.r)(l.e,bt.n)(Object(s.r)(function(){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee(73,4725)];case 1:return[2,e.sent().spItemRemoveItemsFromSharedListOperationHandler]}})})})));e(Object(o.r)(d.e,bt.n)(Object(s.r)(function(){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee(73,4725)];case 1:return[2,e.sent().spItemFullUrlRemoveItemsFromSharedListOperationHandler]}})})})));e(Object(o.r)(h.e,St.t)(Object(s.r)(function(){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([64],4726)];case 1:return[2,e.sent().spFolderItemSetReorderListItemsOperationHandler]}})})})));e(Object(o.r)(v.e,xt.e)(Object(s.r)(function(){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([58],4727)];case 1:return[2,e.sent().spListAddContentTypesToListOperationHandler]}})})})));e(Object(D.e)(l.e,st.e)(ot));e(Object(D.e)(l.e,Ke.e)(Ze));e(Object(D.e)(d.e,Ke.e)(et));e(Object(D.e)(l.e,at.e)(pt));return[2]})})}}),Ht=Object(s.t)(function(){return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(t){e(Object(o.r)(m.e,a.e)(ze));e(Object(o.r)(g.e,a.e)(We));return[2]})})}}),Bt=Object(s.t)(function(){return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(t){e(Object(o.r)(y.e,a.e)(Object(s.r)(function(){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([32],4728)];case 1:return[2,e.sent().getNeedsAttentionFlagOperationHandler]}})})})));return[2]})})}}),jt=Object(s.t)(function(){return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(t){e(Object(o.r)(b.e,a.e)(Je));return[2]})})}}),Ft=Object(s.t)(function(){return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(t){e(Object(o.r)(w.e,a.e)(kt));return[2]})})}}),It=Object(s.t)(function(){return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(t){e(Object(o.r)(E.e,a.e)(_t));e(Object(o.r)(E.e,O.t)(Object(s.r)(function(){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([39],4729)];case 1:return[2,e.sent().createView]}})})})));e(Object(o.r)(E.e,M.t)(Object(s.r)(function(){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([37],4730)];case 1:return[2,e.sent().createFreshView]}})})})));e(Object(o.r)(E.e,_.t)(Object(s.r)(function(){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([53],4731)];case 1:return[2,e.sent().updateView]}})})})));e(Object(o.r)(E.e,L.t)(Object(s.r)(function(){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([48],4732)];case 1:return[2,e.sent().modifyView]}})})})));e(Object(o.r)(E.e,A.t)(Object(s.r)(function(){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([70],4733)];case 1:return[2,e.sent().saveViewCoreOperationHandler]}})})})));return[2]})})}})},function(e,t,n){"use strict";n.r(t);n.d(t,"OpenAsHyperLinkExecutor",function(){return u});n.d(t,"OpenAsShortcutExecutor",function(){return a});n.d(t,"NewItemInOfficeClientAction",function(){return f.t});n.d(t,"ItemOpenInOfficeClientAction",function(){return f.e});n.d(t,"OpenInOfficeClientAction",function(){return f.n});n.d(t,"ItemOpenInOfficeOnlineAction",function(){return l.e});n.d(t,"OpenInOfficeOnlineAction",function(){return l.t});n.d(t,"OpenInBFileAction",function(){return x});n.d(t,"ItemSwitchViewAction",function(){return T.ItemSwitchViewAction});n.d(t,"SwitchViewExecutor",function(){return T.SwitchViewExecutor});n.d(t,"SetDefaultViewAction",function(){return N.e});n.d(t,"ViewCreator",function(){return ce});n.d(t,"LaunchFilterPanelAction",function(){return pe.e});n.d(t,"SortAction",function(){return de.e});n.d(t,"GroupByAction",function(){return be});n.d(t,"GroupByActionExecutor",function(){return we.GroupByActionExecutor});n.d(t,"ModifyColumnAction",function(){return Ne});n.d(t,"ModifyColumnAggregateTypeAction",function(){return Le});n.d(t,"ApproveRejectAction",function(){return Ae.e});n.d(t,"ItemFileHandlerOpenAction",function(){return Oe.t});n.d(t,"FileHandlerOpenAction",function(){return Oe.e});var r,i=n(0),s=n("react-lib"),o=n(4177),u=(function(e){Object(i.__extends)(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;t._onDismiss=function(){t.props.resolve()};return t}t.prototype.render=function(){var e=this.props,t=e.title,n=e.linkLocation,r=e.launchBehaviorType;if(n&&void 0!==r){if("dialog"===r)return s.createElement(o.e,{url:n,heightOffset:.7,dialogContentProps:{title:t},onDismiss:this._onDismiss});"inPageNavigation"===r?window.open(n,"_self"):window.open(n,"_blank")}this.props.resolve();return null};return t})(s.PureComponent),a=(function(e){Object(i.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props.targetUrl;e&&window.open(e,"_blank");this.props.resolve();return null};return t})(s.PureComponent),f=n(817),l=n(830),c=n(32),h=n(22),p=n(27),d=n(43),v=n(90),m=n(1),g=n(557),y=n(6),b=n(3548),w=n(137),E=n(67),S=n(49),x=Object(c.e)(function(e,t){var n,r,s=t.itemKey,o=e.demandItem({key:d.e,itemUrl:y.I,driveItem:w.e,fileName:y.d},s),u=o.key,a=o.itemUrl,f=o.driveItem,l=o.fileName,c=Object(S.e)(e,s),h="",x="",T="",N=!1;if(E.t.isActivated("3deefa50-273b-494f-81c7-72a6f9f4876a","09/21/2021","Use drive item to get driveId and itemId")&&u&&a){var C=v.e.serialize({webAbsoluteUrl:u.webAbsoluteUrl,listFullUrl:u.listFullUrl}),k=e.demandItem({driveUrl:m.x},C).driveUrl;if(k){var L=Object(g.e)(k);if(L){h=L.driveId||"";if(l){T=l.extension;(L=Object(g.e)(a))&&(N=!!(x=L.itemId||""))}}}}else if(f){h=f.driveId||"";N=!!(x=f.itemId||"");T=(null===(n=l)||void 0===n?void 0:n.extension)||""}var A,O=u?Object(b.e)("spo:"+u.webAbsoluteUrl):void 0,M=encodeURIComponent(null!=O?O:""),_=encodeURIComponent(h),D=encodeURIComponent(x),P=T.toLowerCase();if(".note"===P)A="https://www.onenote.com/meetingnotes/"+M+"/"+_+"/"+D;else if(".whiteboard"===P)A=E.t.isActivated("A1AE7AB1-F5D8-49BE-AB01-4CC90527BADD","09/12/2021","Whiteboard GCCH support")||"gcch"!==(null===(r=c)||void 0===r?void 0:r.cloudType)?"https://whiteboard.office.com/me/whiteboards/p/"+M+"/"+_+"/"+D:"https://whiteboard.office365.us/me/whiteboards/p/"+M+"/"+_+"/"+D;else{var H=e.demandItemFacet(y.i,s)||"",B=u?u.webAbsoluteUrl:"";A="https://www.office.com/launch/fluid/content?drive="+h+"&item="+x+"&file="+encodeURIComponent(H)+"&siteUrl="+encodeURIComponent(B)}return Object(i.__assign)({isAvailable:N,onExecute:N?function(){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(e){window.open(A);return[2]})})}:void 0},Object(p.t)(e,{itemKey:s,engagement:{name:"OpenInBFile",isIntentional:!0}}))})(h.e),T=n(3056),N=n(1274),C=n(3908),k=n(134),L=n(3034),A=n(3364),O=n(18),M=n(361),_=n(122),D=n(254),P=n(78),H=n(204),B=n(70),j=n(169),F=n(265),I=n(51),q=n(10),R=n(2095),U=n(741),z=n(16),W=n(386),X=n(14),V=n(293),$=n(431),J=n(136),K=n(61),Q=new(n(526).e)("saveView",function(e,t){return Object.keys(t.views)[0]}),G=((r={})[K.r.started]=A.a,r[K.r.completed]=A.o,r[K.r.failed]=A.u,r),Y=Object(z.t)(function(){return function(e){e(Object(W.e)(Q,$.e)(Object(X.t)()(Z)));e(Object(W.e)(Q,V.n)(Object(X.t)()(te)))}});function Z(){return function(e){return ee}}function ee(e,t){var n,r=t.itemKey,s=t.format,o=Object(J.r)(e,t).phase,u=void 0,a=e.demandItemFacet(q.e,r),f=a&&a.itemKeys;if(f&&f.length>0)n=(u=G)&&u[o];else if("item"===s){var l=e.demandItemFacet(Q,r),c=l&&l.taskKey;if(c){var h=e.demandItemFacet(m.m,c);n=h&&h.title}}return Object(i.__assign)({},n?{title:n}:{})}function te(){return function(e){return function(e,t){return{reportMode:V.e.pin}}}}var ne=Object(U.e)({operationTypeFacet:R.t,progressKeyFacet:Q,initializeBatch:function(){return Y}}),re=n(1582),ie=n(200),se=n(880),oe=new M.e("saveViewProgressBatch"),ue=Object(B.e)(function(){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([24,"ondemand.resx-ondemand"],5026)];case 1:return[2,e.sent().SaveViewDialog]}})})});function ae(){return oe.serializeNext()}var fe=Object(D.t)()(T.SwitchViewExecutor);function le(e){var t=this,n=e.viewTitle,r=e.isPublicView,o=e.onViewSaved,u=e.currentViewKey,a=e.itemSetKey,f=e.itemsScopeItemKey,l=e.listViewSetKey,c=e.reject,h=e.resolve,p=e.currentDerivedView,d=e.saveViewOperation,v=s.useState(!0),m=v[0],g=v[1],y=s.useState(ae)[0],b=s.useState(),w=b[0],E=b[1],S=s.useState(),x=S[0],T=S[1],N=Object(F.t)(),M=Object(j.e)(function(){T(!0);o&&o();h()}),D=Object(j.e)(function(e){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,n,r,s,o,h,v,m,b;return Object(i.__generator)(this,function(i){switch(i.label){case 0:t=e.viewTitle,n=e.isPublicView;r=p&&p.title!==t;s=N(Object(_.e)({deserializedSetKey:P.e},a)).deserializedSetKey;if(!(r&&s&&p))return[3,3];if(!(o=t.trim()))throw new Error(A.e);return[4,N(Object(L.t)({webAbsoluteUrl:s.webAbsoluteUrl,listFullUrl:s.listFullUrl}))];case 1:if(i.sent().some(function(e){return e.serverView.Title===t}))throw new Error(O.format(A.r,t));return[4,N(Object(C.e)({items:(m={},m[l]={views:(b={},b[o]={itemSetKey:a,isPublic:n,sourceView:p,progressItemKey:y},b)},m)}))];case 2:i.sent();if(h=N(Object(_.e)({createdViewKey:H.e},y)).createdViewKey){E(h.viewId);g(!1)}return[3,5];case 3:if(!f){c(new Error("Cannot save a view without a current ItemsScope"));return[2]}return[4,N(he({itemsScopeItemKey:f,listViewSetKey:l,itemSetKey:a,currentViewKey:u,saveViewOperation:d}))];case 4:i.sent();if(v=N(Object(_.e)({savedViewKey:H.e},u)).savedViewKey){E(v.viewId);g(!1)}i.label=5;case 5:return[2]}})})}),B=Object(j.e)(function(){c(new k.e)});return m?s.createElement(ue,{viewTitle:n,isPublicView:r,onContinue:D,onCancel:B}):!x&&w?s.createElement(fe,{viewId:w,currentDerivedView:p,onComplete:M,itemSetKey:a}):null}var ce=Object(c.t)(function(e,t){var n=Object(I.e)(e).itemsScopeItemKey,r=Object(S.e)(e,t.itemSetKey),o=!!r&&Object(E.n)(r).isActivated("49F1ADD5-332D-4BAF-A4F9-FBEA104C76BE","01/20/21","Use saveViewWithProgress operation"),u=e.demandItemFacet(m.m,t.currentViewKey),a=o?R.e:ne;return s.createElement(le,Object(i.__assign)({},t,{itemsScopeItemKey:n,currentDerivedView:u,saveViewOperation:a}))});function he(e){return function(t){var n,r,s=e.listViewSetKey,o=e.itemSetKey,u=e.currentViewKey,a=e.saveViewOperation,f=t(Object(_.e)({childItems:q.e,parentItem:q.s,deserializedItemSetKey:P.e},o)),l=f.childItems,c=f.parentItem,h=f.deserializedItemSetKey;return t(a({items:(n={},n[s]={views:(r={},r[u]={itemSetKey:o},r)},n)})).then(function(){var e,n;if(h){var r=P.e.serialize(Object(i.__assign)(Object(i.__assign)({},h),{filterParams:void 0,sortFieldKey:void 0,sortAscending:void 0,groupByFieldKey:void 0})),s=t(Object(_.e)({filterOptionSets:q.n},r)).filterOptionSets;if(s&&h.filterParams){var o={};for(var a in s)s.hasOwnProperty(a)&&(o[s[a]]=!0);t(Object(re.e)({items:o}))}var f=new ie.e({publisher:he});f.resolveItems({items:(e={},e[r]=Object(i.__assign)(Object(i.__assign)({},l?q.e.pack(l):{}),c?q.s.pack(c):{}),e[u]=Object(i.__assign)({},m.Dt.pack(!1)),e)});t(f.execute());t(Object(se.e)({items:(n={},n[u]=[m.Ot,m.m],n[r]=[q.e],n)}))}})}}var pe=n(3797),de=n(3488),ve=n(71),me=new(n(21).e)("groupByActionControl"),ge=n(12),ye=n(29);var be=Object(ve.e)(function(){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee(0,3931)];case 1:return[2,e.sent().GroupByActionExecutor]}})})},function(e,t){var n=t.groupByFieldKey,r=t.itemSetKey,s=e.demandItemFacet(P.e,r);if(!s)return!1;var o=v.e.serialize(s),u=e.demandItemFacet(m.Ue,o),a=u&&u.templateType===ge.n.mySiteDocumentLibrary,f=Object(ye.e)(e,{enableGroupByInOneDrive:m.H}).enableGroupByInOneDrive,l=e.demandItemFacet(m.b,r),c=s.groupByFieldKey===n||!!l&&-1!==l.indexOf(n),h=P.e.serialize(Object(i.__assign)(Object(i.__assign)({},s),{groupByFieldKey:c?void 0:n})),p=s.viewKey&&H.e.serialize(s.viewKey),d=e.demandItemFacet(me,r);return me.evaluate(d)(e,{itemSetKey:r,viewKey:p,groupedItemSetKey:h,isAvailable:!a||!!f}).isAvailable},function(e,t){var n=t.groupByFieldKey,r=t.itemSetKey,i=e.demandItemFacet(P.e,r);if(!i)return!1;var s=e.demandItemFacet(m.b,r);return i.groupByFieldKey===n||!!s&&-1!==s.indexOf(n)}),we=n(3931),Ee=n(1002),Se=n(3559),xe=n(4564),Te=!1,Ne=Object(c.e)(function(e,t){var n=t.itemSetKey,r=t.modifyType,s=t.columnKey,o=!1,u=e.demandItem({setKey:P.e,canModifySchema:m.l},n),a=u.setKey,f=u.canModifySchema,l=a&&a.viewKey?H.e.serialize(a.viewKey):void 0,c=e.demandItem({currentDerivedView:m.m},l).currentDerivedView,h=e.demandItemFacet(m.Te,s);if(a&&f&&c&&c.baseViewXml&&h)if(1===r||2===r){var d=c.getEffectiveFieldNames();if(d&&d.length){var v=d.indexOf(h),g=a.groupByFieldKey?1:0;o=1===r?v>g+1:v>=g&&v<d.length-1}}else o=!0;Te=!!a&&Object(Se.hasManageListsPermission)(e,{itemSetKey:a});return Object(i.__assign)({isAvailable:o},Object(p.t)(e,{itemKey:n,engagement:{name:"ModifyColumn",isIntentional:!0}}))},function(e,t){var n=t.itemSetKey,r=t.modifyType,s=t.columnKey,o=Te?xe.modifyColumnWithProgress:Ee.e;return{onExecute:function(){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var t,u;return Object(i.__generator)(this,function(i){switch(i.label){case 0:return[4,e(o({items:(t={},t[n]={columnModifyTypeMap:(u={},u[s]={modifyType:r},u)},t)}))];case 1:i.sent();return[2]}})})}}})(h.e),Ce=n(3904),ke=n(568),Le=Object(c.e)(function(e,t){var n=t.itemSetKey,r=t.columnKey,s=t.aggregateType,o=e.demandItemFacet(m.c,n),u=o&&o[r]&&o[r].aggregateFunctionType||ke.e[0],a=u===ke.e[s]?void 0:ke.e[s];return Object(i.__assign)({isAvailable:!0,isToggled:u===ke.e[s]},a?Object(p.t)(e,{itemKey:n,engagement:{isIntentional:!0,action:"ModifyColumnAggregateType",name:a||"AggregateTypeNone",extraData:{PreviousAggregateType:u||"AggregateTypeNone",component:"ColumnContextMenu"}}}):{})},function(e,t){var n=t.itemSetKey,r=t.columnKey,s=t.aggregateType;return{onExecute:function(){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var t;return Object(i.__generator)(this,function(i){switch(i.label){case 0:return[4,e(Object(Ce.e)({items:(t={},t[n]={aggregateType:s,columnKey:r},t)}))];case 1:i.sent();return[2]}})})}}})(h.e),Ae=n(1271),Oe=n(1022)}],Array(33),[function(e,t,n){"use strict";n.r(t);n.d(t,"modifyColumnWithProgress",function(){return k});var r,i=n(1002),s=n(741),o=n(0),u=n(4336),a=n(16),f=n(386),l=n(14),c=n(431),h=n(293),p=n(3312),d=n(136),v=n(10),m=n(61),g=n(526),y=n(5),b=new y.e("modifyColumnProgressItem",{columnKey:Object(y.s)(),modifyType:Object(y.i)(),targetIndex:Object(y.i)()}),w=new g.e("modifyColumnProgress",function(e,t){var n=Object.keys(t.columnModifyTypeMap)[0],r=t.columnModifyTypeMap[n].modifyType,i=t.columnModifyTypeMap[n].targetIndex;return b.serialize({columnKey:n,modifyType:r,targetIndex:i})}),E=n(1),S=((r={})[m.r.started]=u.n,r[m.r.completed]=u.e,r[m.r.failed]=u.t,r),x=Object(a.t)(function(){return function(e){e(Object(f.e)(w,c.e)(Object(l.t)()(T)));e(Object(f.e)(w,h.n)(Object(l.t)()(N)));e(Object(f.e)(w,p.t)(Object(l.t)()(C)))}});function T(){return function(e){return function(e,t){var n,r=t.itemKey,i=t.format,s=Object(d.r)(e,t).phase,u=void 0,a=e.demandItemFacet(v.e,r),f=a&&a.itemKeys;if(f&&f.length>0)n=(u=S)&&u[s];else if("item"===i){var l=e.demandItemFacet(w,r),c=l&&l.taskKey;if(c){var h=e.demandItemFacet(b,c),p=h&&h.columnKey;if(p){n=e.demandItemFacet(E.Te,p)}}}return Object(o.__assign)({},n?{title:n}:{})}}}function N(){return function(e){return function(e,t){return{reportMode:h.e.pin}}}}function C(){return function(e){return function(e,t){return{maxChildItemCount:0}}}}var k=Object(s.e)({operationTypeFacet:i.t,progressKeyFacet:w,initializeBatch:function(){return x}})},,,,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return u});var r=n("react-lib"),i=n(3917),s=n(52),o=n(2),u={key:Object(o.t)("quickEditUndo"),automationId:"quickEditUndoCommand",name:s.G,iconProps:{iconName:"Undo"},isPermanent:!0,action:r.createElement(i.e,{undoRedoActionType:"undo"})}},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var r=n("react-lib"),i=n(52),s=n(2),o=Object(s.t)("quickEditRedo"),u=n(3917),a={key:o,automationId:"quickEditRedoCommand",name:i.Q,iconProps:{iconName:"Redo"},action:r.createElement(u.e,{undoRedoActionType:"redo"})}},,,,,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return m});var r=n(0),i=n("react-lib"),s=n(1780),o=n(2332),u=n(20),a=n(13),f=n(22),l=n(70),c=n(27),h=n(32),p=Object(l.e)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([72,"ondemand.resx-ondemand"],4756)];case 1:return[2,e.sent().default]}})})}),d=Object(h.t)(function(e,t){var n=t.itemKey,s=Object(u.o)(function(e){return i.createElement(p,Object(r.__assign)({},e,{itemKey:n}))},{scope:"global"});return i.createElement(f.e,Object(r.__assign)({onExecute:s},Object(c.t)(e,{itemKey:n,engagement:{name:"SocialBar",isIntentional:!0}})))}),v=(Object(a.i)()(d),n(3933)),m=(function(e){Object(r.__extends)(t,e);function t(t){return e.call(this,t)||this}t.prototype.render=function(){var e=this.props,t=e.likeLabel,n=e.itemKey,r=i.createElement(o.e,{activityDescription:t,isCompact:!0});return i.createElement(u.n,{action:i.createElement(d,{itemKey:n})},function(e){var t=e.isAvailable,n=e.execute,o=t?function(){n().catch(function(){})}:void 0;return i.createElement(s.e,{disabled:!1,className:v.e,onClick:o},r)})};return t})(i.Component)}],Array(38),[function(e,t,n){"use strict";n.r(t);n.d(t,"ItemAutoRefresh",function(){return a});n.d(t,"CurrentItemAutoRefresh",function(){return f});var r=n("react-lib"),i=n(13),s=n(32),o=n(3831);function u(e){var t=e.subscribe;r.useLayoutEffect(function(){return t()},[t]);return null}var a=Object(s.t)(function(e,t){var n=t.itemKey,i=e.demandItemFacet(o.e,n),s=o.e.evaluate(i)(e,{itemKey:n,itemSubscriber:null}),a=s.isAvailable,f=s.itemSubscriber,l=s.subscribe;return a?f||(l?r.createElement(u,{subscribe:l}):null):null}),f=Object(i.n)()(a)}],Array(40),[function(e,t,n){"use strict";n.r(t);n.d(t,"sharePointGraphAddon",function(){return E});var r=n(0),i=n(16),s=n(143),o=n(155),u=n(109),a=n(200),f=n(1014),l=n(43),c=n(264),h=n(4663),p=n(2),d=n(3534),v=n(6),m=n(1019),g=n(1),y=n(268),b=n(1385);function w(e){var t=e.itemKey,n=e.driveItem;return function(e){var i,s,o=e(Object(y.e)({enableSharePointItemMapping:g.te})).enableSharePointItemMapping,u=void 0===o||o,d=new a.e({publisher:w}),b=n.webDavUrl||n.remoteItem&&n.remoteItem.webDavUrl||n.webUrl,E=b&&decodeURIComponent(b);if(E){var S={itemFullUrl:E},x=Object(m.e)(E),T={itemFullUrl:x},N=f.e.serialize(S),C=f.e.serialize(T);d.mapKeys({mappings:(i={},i[N]=t,i)});d.resolveItems({items:(s={},s[N]=Object(r.__assign)(Object(r.__assign)({},u?Object(r.__assign)({},Object(p.n)({preferredKeyFacet:c.n},{preferredKeyFacet:new h.e(f.e,function(e){return e===l.e})})):{}),v.M.pack({itemKey:C})),s[C]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},v.m.pack({})),v.i.pack(x)),v.O.pack(encodeURI(x))),s)})}return{itemResolver:d}}}var E=Object(i.t)(function(){return function(e){var t;e(b.e);e(d.sharePointItemByFullUrlAddon);e(Object(s.e)({items:(t={},t[o.e]=Object(r.__assign)({},u.N.pack({process:w})),t)}))}})},,,,,,,,,,,,,function(e,t,n){"use strict";n.r(t);n.d(t,"getNeedsAttentionView",function(){return p});var r=n(0),i=n(368),s=n(678),o=n(12),u=n(52),a=n(122),f=n(1),l=n(90),c=n(244),h=n(1255);function p(e,t,n){var p=l.e.serialize({webAbsoluteUrl:t.webAbsoluteUrl,listFullUrl:t.listFullUrl}),d=n(Object(a.e)({list:f.Ue},p)),v=d&&d.list&&d.list.templateType&&Object(o.s)(d.list.templateType),m=v?"LinkTitle":"LinkFilename",g={},y=[];if(e)for(var b=0,w=e;b<w.length;b++){var E=w[b];if(E.contentTypeId&&E.requiredFields&&E.requiredLookups){for(var S={fieldName:"ContentTypeId",operator:"Eq",values:[E.contentTypeId]},x=s.e(S),T=[],N=E.requiredFields.split(","),C=E.requiredLookups.split(","),k=0;k<N.length;k++){var L=N[k],A="True"===C[k];void 0===g[L]&&(g[L]=A);var O={fieldName:L,lookupId:!!A||void 0,operator:"Eq",values:[""]};T.push(O)}var M=s.t(T,"Or");if(M){var _=s.t([x,M],"And");y.push(_)}}}0===y.length&&y.push(s.e({fieldName:"FileLeafRef",operator:"Eq",values:[""]}));var D=Object.keys(g),P=D.map(function(e){return g[e]}),H=Object(r.__spreadArrays)(["DocIcon",m,"Editor","Modified"],D,["FileDirRef"]),B=Object(r.__spreadArrays)([void 0,void 0,void 0,void 0],P,[void 0]),j=!!d&&!!d.list&&!!d.list.templateType&&d.list.templateType===o.n.webPageLibrary,F=new i.e("<View Scope='Recursive'/>");j&&c.e.isFeatureEnabled({ODB:1743})?F.title=u.g:F.title=v?u.m:u.p;F.isReadOnly=!0;F.id=h.e;F.replaceFields(H,B);F.updateSort({fieldName:"ID",isAscending:!0});F.updateRowLimit({rowLimit:30,isPerPage:!0});var I=s.t(y,"Or");F.addFilters([I]);return F}},,,,,,,,function(e,t,n){"use strict";n.r(t);n.d(t,"sharePointWebBasicActionsAddonDeferred",function(){return f});var r=n(16),i=n(386),s=n(43),o=n(3910),u=n(503),a=n(4142),f=Object(r.t)(function(){return function(e){e(Object(i.e)(s.e,u.e)(o.e));e(a.sharePointBasicActionsAddonDeferred)}})}],Array(126),[function(e,t,n){"use strict";n.r(t);n.d(t,"driveItemDeleteItemsBatchedOperationHandler",function(){return g});var r,i=n(0),s=n(400),o=n(16),u=n(352),a=n(127),f=n(61),l=n(143),c=n(880),h=n(6),p=n(137),d=n(787),v=n(1611),m=n(203);(function(e){e.Completed="completed";e.Failed="failed";e.InProgress="inProgress"})(r||(r={}));var g=Object(o.n)({maxParallelOperationCount:4,timeout:3e5,areSameBatch:function(e,t){var n=p.e.deserialize(e.itemKey).driveId,r=p.e.deserialize(t.itemKey).driveId;return!!n&&!!r&&n===r}})(function(e){var t=this,n=e.items,g=Object.keys(n),y=g.map(function(e){return p.e.deserialize(e)});return function(e){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,p,b,w,E,S,x;return Object(i.__generator)(this,function(T){switch(T.label){case 0:e(Object(l.e)({items:Object(a.t)(n,function(e){e.progressItemKey;return Object(i.__assign)(Object(i.__assign)({},f.y.pack({total:1,current:0})),f.p.pack(!0))},function(e,t){return t.progressItemKey})}));t={value:y.map(function(e){return{id:e.itemId,deleted:{}}})};p="";b=Object(d.n)(y[0]);return[4,e(Object(v.n)({url:b+"/items",method:"PATCH",body:t,qosName:"deleteItems",endpoint:y[0].endpoint,parseResponse:function(e){p=e.getResponseHeader("Location")||""}}))];case 1:T.sent();w=0;E=!1;S=!1;Object(u.t)(3e5).then(function(){return S=!0});x=function(){var t;return Object(i.__generator)(this,function(i){switch(i.label){case 0:return[4,e(Object(v.n)({url:p,qosName:"getOperationStatus",endpoint:y[0].endpoint}))];case 1:t=i.sent();g.forEach(function(){e(Object(l.e)({items:Object(a.t)(n,function(e){e.progressItemKey;return f.y.pack({total:1,current:t.percentageComplete/g.length})},function(e,t){return t.progressItemKey})}))});if(t.status!==r.Completed&&t.status!==r.Failed)return[3,2];E=!0;w=t.summary.failed;return[3,4];case 2:return[4,Object(u.t)(500)];case 3:i.sent();i.label=4;case 4:return[2]}})};T.label=2;case 2:return[5,x()];case 3:T.sent();T.label=4;case 4:if(!E&&!S)return[3,2];T.label=5;case 5:if(S)throw new s.e({facets:Object(i.__assign)({},m.c.pack(408))});e(Object(c.e)({items:Object(a.e)(g,function(){return[h.l]})}));if(w>0)throw new o.e({items:Object(a.e)(g.slice(0,w),function(){return new s.e({facets:Object(i.__assign)({},m.c.pack(500))})})});return[2]}})})}})}],Array(25),[function(e,t,n){"use strict";n.r(t);n.d(t,"graphAddon",function(){return Ys});var r=n(0),i=n(16),s=n(246),o=n(393),u=n(79),a=n(386),f=n(14),l=n(396),c=n(615),h=n(319),p=Object(r.__assign)(Object(r.__assign)({},c.e),{key:h.n,minWidth:32,maxWidth:32}),d=n(3458),v=n(1087),m=n(1263),g=n(74),y=n(1133),b=n(685),w=n(28),E=n(155),S=Object(g.i)({name:m.t,key:h.e,fieldName:"",minWidth:g.e.regularMin,maxWidth:g.e.regularMax,isCollapsable:!0,sortProps:g.t},b.e)(function(e,t){var n=e.demandItemFacet(y.e,t),r=n&&new Date(n.sharedDateTime).getTime();if("number"!=typeof r||isNaN(r))return{text:""};var i=e.demandItemFacet(w.N,E.e);return i&&i.language||window.navigator.language?{text:Object(v.r)(new Date(r),!1)}:{dateValue:r}}),x=n(705),T=n(190),N=n(3895),C=n(3031),k=n(3544),L=n("react-lib"),A=n(965),O=n(537),M=n(18),_=n(1627),D=n(4301),P=(function(e){Object(r.__extends)(t,e);function t(t){return e.call(this,t)||this}t.prototype.render=function(){var e=this.props,t=e.userName,n=e.isPlaceholder,r=L.createElement(O.e,{className:"topCollaboratorIcon_7990aeb5",iconName:"TeamFavorite"}),i=L.createElement("span",{className:"topCollaboratorUserName_7990aeb5"},t),s=L.createElement("div",{className:"topCollaboratorTooltip_7990aeb5"},M.formatToArray(D.e,i));return L.createElement("div",{className:"topCollaPlaceHolder_7990aeb5"},n?null:t?L.createElement(_.e,{content:s},r):r)};return t})(A.e),H=n(10),B=Object(g.i)({name:m.n,key:h.i,fieldName:"",minWidth:g.e.regularMin,maxWidth:g.e.regularMax,isCollapsable:!0,sortProps:g.r,headerClassName:"columnHeader_7990aeb5"},x.e)(function(e,t){var n=e.demandItem({shareByPerson:N.e},t).shareByPerson,r=e.demandItem({sharedBy:y.e},t).sharedBy,i=n&&n.itemKey,s=n&&n.displayValue||r&&r.sharedBy&&r.sharedBy.user&&r.sharedBy.user.displayName,o=!1;if(i&&C.e.matches(i)){var u=C.e.deserialize(i).email,a=e.demandItemFacet(H.e,k.e.serialize({endpoint:"https://graph.microsoft.com/beta"}));a&&(o=a.itemKeys.slice(0,3).some(function(t){var n=e.demandItemFacet(T.e,t);return!!n&&n===u}))}return i||s?{people:[{itemKey:i||"",displayValue:s}],onRenderUser:function(e,t){if(!e||!t)return null;var n=t(e),r=e.user;return L.createElement("div",{className:"userWithTopCollaborator_7990aeb5"},L.createElement(P,{userName:r.title,isPlaceholder:!o}),n)}}:{people:[]}},function(e,t){return""+e.demandItemFacet(T.e,t)}),j=Object(f.t)()(function(){return function(e){return I}});var F=[p,d.e,S,B];function I(e,t){return{columns:F}}var q=n(6),R=n(1169),U=n(143),z=n(307),W=n(268),X=n(137),V=n(787),$=n(1611),J=n(2559),K=n(3799),Q=n(2893),G=n(5),Y=new G.e("driveItem",{endpoint:Object(G.s)(),driveId:Object(G.s)({shouldNormalizeToEmpty:!0}),canonicalUrl:Object(G.s)()}),Z=n(160);function ee(e){var t=e.driveItemResponse,n=e.endpoint,i=e.getDriveItemFacets,s=void 0===i?J.e:i;return function(i){var o,u,a,f=t.remoteItem,l=f&&f.parentReference,c=t.parentReference,h=c||l,p=h&&h.driveId,d=h&&h.id,v="personal"===(h&&h.driveType),m=!!t.root;if(f){a=f.id;l&&(p=l.driveId)}else a=v&&t.root?Q.n:t.id;var g={endpoint:n,driveId:p,itemId:a},y=X.e.serialize(g),b=t&&(t.webDavUrl||t.webUrl),w=v&&h&&h.path===Q.e?Q.n:d||void 0,E=h&&w?X.e.serialize({endpoint:n,driveId:h.driveId||p,itemId:w}):void 0,S=[],x="";if(b){var T=new Z.e(b);S.push.apply(S,T.path.split("/").slice(1,-1).map(function(e){return decodeURIComponent(e)}));S.unshift(T.authority);x=S.join("/")}h&&!m&&!w&&x&&(E=Y.serialize({endpoint:n,driveId:h.driveId,canonicalUrl:x}));var N=i(Object(K.e)(Object(r.__assign)(Object(r.__assign)({},e),{itemKey:y,driveItemKey:g,parentFolderItemKey:E}))).itemResolver;N.resolveItems({items:Object(r.__assign)({},E&&(o={},o[E]=Object(r.__assign)({},x?q.O.pack(x):{}),o))});if(f&&l){var C=X.e.serialize({endpoint:n,driveId:c&&c.driveId,itemId:t.id}),k=X.e.serialize({endpoint:n,driveId:l.driveId,itemId:f.id});N.mapKeys({mappings:(u={},u[C]=k,u)});N.merge(i(s({itemKey:k,driveItem:t,endpoint:n})).itemResolver)}return{itemResolver:N,actualDriveItemKey:g,actualItemKey:y}}}var te=n(123),ne=n(1112),re=n(3351),ie=n(3542),se=n(3350),oe=n(610),ue=n(2383),ae=n(138),fe=n(55),le=n(1185),ce=n(3030),he=n(2809),pe=n(3891),de=n(3353),ve=n(3354),me=n(3352),ge=n(272),ye=n(2859),be=n(3893),we=n(3892),Ee=n(1278),Se=n(3894),xe=n(3543),Te=n(200);function Ne(e){var t=e.itemKey,n=e.driveItemKey,i=e.driveItem,s=e.endpoint,o=e.parentFolderItemKey,u=e.shouldReturnShareFacets,a=void 0===u||u,f=i.bundle,l=i.coverImage,c=i.file,p=i.fileSystemInfo,d=i.name,v=i.parentReference,m=i.lenses,g=i.remoteItem,b=i.root,w=i.size,E=i.thumbnails,S=i.image,x=i.video,T=i.eTag,N=i.photo,C=i.restricted,k=i.tags,L=i.specialFolder;return function(e){var u,A,O,M,_,D,P,B,j,F=i.lastModifiedDateTime,I=void 0===F?p&&p.lastModifiedDateTime:F,U=i.createdDateTime||p&&p.createdDateTime,z=(new Date).getTime(),W=U?new Date(U).getTime():void 0,V=W?z-W<1728e5:void 0,$=v&&v.driveId,J=v&&v.driveType,K="personal"===J,Q=p&&p.lastAccessedDateTime,G=null===(O=N)||void 0===O?void 0:O.takenDateTime,Y=i.package,Z=E,ee=S,Ce=x,ke=i.shared||(null===(M=i.remoteItem)||void 0===M?void 0:M.shared),Le={itemId:i.id,driveId:$,endpoint:s},Ae=p&&p.systemPath,Oe=void 0;g&&(Oe={itemId:g.id,driveId:g.parentReference&&g.parentReference.driveId||"",endpoint:s});var Me,_e=n||Le,De=X.e.serialize(_e),Pe=i.webDavUrl;Me="business"!==J&&"documentLibrary"!==J&&"personal"!==J||!b?d||"":ue.t;var He,Be=i.folder||(null===(_=g)||void 0===_?void 0:_.folder);Be&&(He=ke?g?12:5:2);var je=(null===(P=null===(D=Be)||void 0===D?void 0:D.folderView)||void 0===P?void 0:P.sortBy)||"",Fe="descending"===(null===(j=null===(B=Be)||void 0===B?void 0:B.folderView)||void 0===j?void 0:j.sortOrder),Ie=je&&{columnKey:Object(h.s)(je),isAscending:!Fe},qe=w,Re=Be&&Be.childCount,Ue=(function(e,t){var n=e.lastIndexOf(".");if(t||n<0)return{name:e,extension:""};return{name:e.substring(0,n),extension:e.substring(n)}})(Me,!!Be),ze=Ue.extension||i.package&&i.package.type,We=ze&&Object(pe.e)(ze),Xe=i.sharepointIds,Ve=i.localItem,$e=i.webUrl,Je=new Te.e({publisher:Ne});Je.resolveItems({items:(u={},u[t]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},X.e.pack(_e)),q.h.pack(Me)),R.n.pack(Ae)),q.f.pack(I?new Date(I).getTime():void 0)),q.u.pack(W)),ae.u.pack(G?new Date(G).getTime():void 0)),q.S.pack(V)),te.i.pack(Y&&"oneNote"===Y.type?{}:void 0)),Object(ge.e)().forFacet(ae.v).thenInvalidate(De,re.e).pack()),ie.e.pack(i)),H.t.pack({itemKey:ne.e.serialize({driveItemKey:_e,sortBy:je,isAscending:!Fe})})),q.n.pack({itemKey:oe.e.serialize({driveItemKey:_e})})),q.M.pack(o?{itemKey:o}:void 0)),le.e.pack(J)),q.d.pack(Ue)),ye.e.pack(f)),be.e.pack(l)),R.t.pack(c&&c.mimeType)),he.t.pack(m&&m.length>0?m:void 0)),Se.e.pack(k)),p||Be||c?Object(r.__assign)({},q.m.pack(Be?{}:void 0)):{}),Q?Object(r.__assign)({},q.o.pack(new Date(Q).getTime())):{}),Z?Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},re.e.pack(Z)),me.e.pack(!0)),we.e.pack(Object(Ee.t)(Ue.extension))):{}),T?q.p.pack(T):{}),ee&&ee.width&&ee.height?ae.a.pack({width:ee.width,height:ee.height}):{}),ee&&!Ce?ae.p.pack({}):{}),Ce?ae.g.pack({}):{}),K?Object(r.__assign)({},ce.e.pack(i.vault)):{}),a?Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},q.x.pack(!!ke)),y.e.pack(ke)),He?te.e.pack(He):{}):{}),u)});Je.resolveItems({items:(A={},A[t]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},void 0!==qe?q.v.pack(qe):{}),$e?q.O.pack($e):{}),Ie?H.u.pack(Ie):{}),Oe?se.e.pack(Oe):{}),Pe?q.i.pack(decodeURIComponent(Pe)):{}),Ve?R.e.pack(Ve):{}),"number"==typeof Re?fe.e.pack(Re):{}),We?he.e.pack(We):{}),C?xe.e.pack(C):{}),Xe?de.e.pack(Xe):{}),L?ve.e.pack(L.name):{}),A)});return{itemResolver:Je}}}function Ce(e){var t=e.driveItemResponse,n=e.endpoint;return function(i){var s=t.parentReference,o=s&&s.driveId,u=s&&s.id,a=t.id;t.root&&(a=Q.n);var f={endpoint:n,driveId:o,itemId:a},l=X.e.serialize(f),c=s&&s.path===Q.e?Q.n:u||void 0,h=s&&c?X.e.serialize({endpoint:n,driveId:s.driveId,itemId:c}):void 0;return{itemResolver:i(Object(K.e)(Object(r.__assign)(Object(r.__assign)({},e),{itemKey:l,driveItemKey:f,getDriveItemFacets:Ne,parentFolderItemKey:h}))).itemResolver,actualDriveItemKey:f,actualItemKey:l}}}var ke=n(133),Le=n(109);function Ae(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,s,o,u;return Object(r.__generator)(this,function(r){switch(r.label){case 0:t=e.endpoint;i=n(Object(W.e)({getUserOneDriveEndpoint:Le.v,graphEndpoint:Le.m})),s=i.getUserOneDriveEndpoint;return(o=i.graphEndpoint)&&t!==o&&s?[4,n(s({endpoint:t}))]:[3,2];case 1:u=r.sent();t=u;r.label=2;case 2:return[2,t]}})})}}var Oe=Object(i.i)()(function(e){var t=this,n=e.itemKey,i=X.e.deserialize(n);return function(s){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,o,u,a,f,l,c,h,p,d,v,m;return Object(r.__generator)(this,function(g){switch(g.label){case 0:t=i;return i.driveId&&"me"!==i.driveId?[3,2]:[4,s(Ae({endpoint:i.endpoint}))];case 1:(o=g.sent())!==i.endpoint&&(t=Object(r.__assign)(Object(r.__assign)({},i),{endpoint:o}));g.label=2;case 2:u=Object(V.n)(t);a=s(Object(W.e)({disableRemoteItemInPlace:Le.i})).disableRemoteItemInPlace;f=a?Ce:ee;return[4,s(Object($.r)({url:Object(V.t)(t)+"?$expand=thumbnails",driveUrl:u,qosName:"getItem",endpoint:t.endpoint}))];case 3:l=g.sent();c=s(f({driveItemResponse:l,endpoint:t.endpoint})),h=c.itemResolver,p=c.actualItemKey;h.resolveItems({items:(d={},d[e.itemKey]=Object(r.__assign)({},ke.r.pack(X.e)),d)});h.mapKeys({mappings:(v={},v[p]=n,v)});i.driveId&&"me"!==i.driveId||h.mapKeys({mappings:(m={},m[X.e.serialize(Object(r.__assign)(Object(r.__assign)({},i),{driveId:"me"}))]=X.e.serialize(Object(r.__assign)(Object(r.__assign)({},i),{driveId:""})),m[n]=X.e.serialize(t),m)});s(h.execute());return[2]}})})}});var Me=n(1127),_e=n(4558),De=n(3896),Pe=n(882),He=Object(i.i)()(function(e){var t=this,n=e.itemKey,i=oe.e.deserialize(n).driveItemKey,s=i.endpoint;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,o,u,a,f,l,c,h=this;return Object(r.__generator)(this,function(p){t={Caller:"HoverCard"};o=e(Object(W.e)({enableCookiesForAnalyticsRequests:Le.a})).enableCookiesForAnalyticsRequests,u=void 0!==o&&o;"GetItemAnalytics_addon-graph";a=Object(r.__awaiter)(h,void 0,void 0,function(){var o,a,f,l,c,h;return Object(r.__generator)(this,function(p){switch(p.label){case 0:return[4,e(Object($.r)({url:(d=Object(V.t)(i),v=Be(d),m="$expand=analytics($expand=allTime($expand=activities))",g="$select=*,id,reactions,trending",y=g+"&"+m+",insights($expand=keyPoints)",b=v+"?"+y,b),qosName:"GetItemAnalytics_addon-graph_GetAnalyticsSections",endpoint:s,timeout:6e3,headers:t,driveUrl:Be(Object(V.n)(i)),allowCookies:u}))];case 1:o=p.sent();a=Object(_e.t)(o);if(f=a.createdBy){l=C.e.serialize({email:f.email,endpoint:s});e(Object(U.e)({items:(c={},c[l]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},q.h.pack(f.displayName)),T.e.pack(f.email)),T.r.pack(f.image)),T.i.pack(f.id)),c[n]=Object(r.__assign)({},Me.r.pack({itemKey:l,displayValue:f.displayName})),c)}))}e(Object(U.e)({items:(h={},h[n]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},Me.h.pack(a.viewCount)),Me.p.pack(a.viewerCount)),Me.o.pack(a.isTrending)),Me.e.pack(a.activities)),Me.f.pack(a.likeCount)),Me.t.pack(a.commentCount)),Me.a.pack(a.lifeCycleStatus)),Me.u.pack(a.keyPointsData)),Me.s.pack(a.incompleteData)),Me.i.pack(a.createdDateTime)),h)}));return[2]}var d,v,m,g,y,b})});f=[a];l=Object(r.__awaiter)(h,void 0,void 0,function(){var o,a,f,l;return Object(r.__generator)(this,function(c){switch(c.label){case 0:return[4,e(Object($.r)({url:(h=Object(V.t)(i),p=Be(h),p+"?$expand=recommendedActionSet($expand=nonAggregatedRecommendedActions,aggregatedEditRecommendedAction($expand=importantActorsAndActivities)),conversationSet($expand=emailConversations($expand=participants),meetingConversations($expand=participants),teamsConversations($expand=participants))"),qosName:"GetItemAnalytics_addon-graph_GetRecommendedActionsAndConversations",endpoint:s,timeout:6e3,headers:t,driveUrl:Be(Object(V.n)(i)),allowCookies:u}))];case 1:o=c.sent();a=(function(e){var t=e.recommendedActionSet,n=t.nonAggregatedRecommendedActions;t.aggregatedEditRecommendedAction&&t.aggregatedEditRecommendedAction.recentEditorCount&&(n=n.concat(t.aggregatedEditRecommendedAction));return n})(o);f=(function(e){var t=e.conversationSet,n=t.emailConversations.concat(t.meetingConversations,t.teamsConversations),r={},i=[];n.forEach(function(e){var t=e.teamsMessageThreadId||e.conversationInstance.conversationId;if(!r.hasOwnProperty(t)){r[t]=!0;i.push({activityTimestamp:e.conversationInstance.sharedByTime,context:e.conversationInstance.subject,conversationType:De.e[e.conversationInstance.referenceType],deepLink:e.conversationInstance.deepLink,referencePreview:e.conversationInstance.referencePreview,isSharedByMe:e.conversationInstance.isSharedByMe,sharedByUserDisplayName:e.sharedByUser.displayName,sharedByUserEmail:e.sharedByUser.email,participants:e.participants})}});return i.sort(function(e,t){return Date.parse(t.activityTimestamp)-Date.parse(e.activityTimestamp)})})(o);e(Object(U.e)({items:(l={},l[n]=Object(r.__assign)(Object(r.__assign)({},Me.l.pack(a)),Me.n.pack(f)),l)}));return[2]}var h,p})});f.push(l);e(Object(U.e)({items:(c={},c[n]=Object(r.__assign)({},Me.c.pack([])),c)}));return[2,Object(Pe.e)(f)]})})}});function Be(e){return e.replace("2.0","2.1")}var je=new G.e("specialDriveItem",{endpoint:Object(G.s)(),driveId:Object(G.s)({shouldNormalizeToEmpty:!0}),name:Object(G.s)()}),Fe=n(264),Ie=Object(i.i)()(function e(t){var n=this,i=t.itemKey,s=je.deserialize(i),o=s.driveId,u=s.endpoint,a=Object(V.n)(s);return function(t){return Object(r.__awaiter)(n,void 0,void 0,function(){var n,f,l,c,h,p,d,v,m;return Object(r.__generator)(this,function(g){switch(g.label){case 0:return[4,t(Object($.n)({url:Object(V.i)(s),driveUrl:a,qosName:"getItem",endpoint:u}))];case 1:n=g.sent();f=new Te.e({publisher:e});l=n&&n.parentReference;c=l&&l.driveId;h={endpoint:u,driveId:c||o,itemId:n.id};p=X.e.serialize(h);d=l&&l.id?X.e.serialize({endpoint:u,driveId:c,itemId:l.id}):void 0;f.merge(t(Object(J.e)({itemKey:p,driveItem:n,endpoint:u,parentFolderItemKey:d})).itemResolver);f.resolveItems({items:(v={},v[p]=Object(r.__assign)(Object(r.__assign)({},Fe.n.pack(X.e)),H.t.pack({itemKey:ne.e.serialize({driveItemKey:h,sortBy:"",isAscending:!0})})),v)});f.mapKeys({mappings:(m={},m[p]=i,m)});t(f.execute());return[2]}})})}});var qe=new G.e("driveItemPage",{endpoint:Object(G.s)(),setItemKey:Object(G.s)(),token:Object(G.s)()}),Re=n(238);function Ue(e){return e.reduce(function(e,t){return e&&t?"("+e+" or "+t+")":t||e})}function ze(e){return e.reduce(function(e,t){return e&&t?"("+e+" and "+t+")":t||e})}function We(e){return function(t){for(var n=void 0,r=void 0,i=0;i<e.length;i++){var s=e[i],o=!1,u=s;if("!"===s[0]){u=s.slice(1);o=!0}if("."===u[0])if(t.name){var a=new RegExp(u.toLocaleLowerCase()+"$"),f=t.name.toLocaleLowerCase().split(a),l=2===f.length&&""===f[1]||!1;o?n=void 0!==n?n&&!l:l:r=r||l}else{n=!1;r=!1}else if("folder"===u){var c=void 0!==t.folder||void 0!==t.remoteItem&&void 0!==t.remoteItem.folder||!1;o?n=void 0!==n?n&&!c:c:r=r||c}else if("onenote"===u){var h=t.package&&"oneNote"===t.package.type||t.remoteItem&&t.remoteItem.package&&"oneNote"===t.remoteItem.package.type||!1;o?n=void 0!==n?n&&!h:h:r=r||h}}return void 0===r?void 0!==n&&n:(void 0===n||n)&&!r}}var Xe=Object(i.i)()(function e(t){var n=this,i=t.itemKey,s=qe.deserialize(i),o=s.setItemKey,u=s.endpoint,a=s.token,f=G.e.get(o).deserialize(o),l=f.extFilters,c=f.driveItemKey,h=Object(V.n)(c),p=ne.e.matches(o);return function(t){return Object(r.__awaiter)(n,void 0,void 0,function(){var n,s,f,c,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_;return Object(r.__generator)(this,function(D){switch(D.label){case 0:return[4,t(Object($.n)({endpoint:u,url:a,driveUrl:h,qosName:"getChildrenPage"}))];case 1:n=D.sent();s=l&&l.length>0?We(l):void 0;f=new Te.e({publisher:e});c=[];for(d=0,v=n.value;d<v.length;d++){m=v[d];if(!(!!s&&s(m))){g=m&&(m.parentReference||m.remoteItem&&m.remoteItem.parentReference);y=g&&g.driveId;b=X.e.serialize({itemId:m.id,driveId:y,endpoint:u});w=null===(M=g)||void 0===M?void 0:M.id;E=(null===(_=g)||void 0===_?void 0:_.path)===Q.e?Q.n:w||void 0;S=g?X.e.serialize({itemId:E,driveId:y,endpoint:u}):void 0;x=t(Object(W.e)({allowDisableRemoteItemInPlace:Le.i,processDriveItemFromSharePoint:Le.N})),T=x.allowDisableRemoteItemInPlace,N=x.processDriveItemFromSharePoint;C=p&&T?Ne:J.e;c.push(b);f.merge(t(C({itemKey:b,driveItem:m,endpoint:u,parentFolderItemKey:S})).itemResolver);f.resolveItems({items:(O={},O[b]=Object(r.__assign)({},Object(ge.e)().forFacet(q.h).thenInvalidate(i,H.e).forFacet(q.l).thenInvalidate(i,H.e).pack()),O)});if(N){k=t(N.process({itemKey:b,driveItem:m})).itemResolver;f.merge(k)}}}if(L=n["@odata.nextLink"]){A=qe.serialize({setItemKey:o,endpoint:u,token:L});f.merge(Object(Re.t)({itemKey:A}).itemResolver);c.push(A)}f.merge(Object(Re.e)({itemKey:i,itemSetKey:o,childItemKeys:c}).itemResolver);t(f.execute());return[2]}})})}});var Ve=n(606),$e=Object(i.i)()(function e(t){var n=this,i=t.itemKey,s=Ve.e.deserialize(i);return function(t){return Object(r.__awaiter)(n,void 0,void 0,function(){var n,u;return Object(r.__generator)(this,function(a){(n=new Te.e({publisher:e})).resolveItems({items:(u={},u[i]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},H.t.pack({itemKey:o.e.serialize({driveItemKey:s,sortBy:"",isAscending:!0})})),q.h.pack(ue.s)),q.m.pack({})),q.M.pack(void 0)),u)});t(n.execute());return[2]})})}});var Je=n(621),Ke=n(486),Qe=n(44),Ge=n(106),Ye=n(2),Ze=new Ye.e("itemSetEngagementExtraData");function et(e){return function(t){var n,i,s,o,u,a=e.itemKey,f=e.parentItemKey,l=e.itemSetKeyFacet,c=e.filterChildItems,h=e.onProcessResponse,p=e.groupChildItems,d=e.response,v=e.skip,m=void 0===v?0:v,g=e.enableRandomAccess,y=void 0!==g&&g,b=e.disableRemoteItem,w=e.totalChildCount,E=e.getDriveItemFacets,S=l.deserialize(a),x=S.driveItemKey.endpoint,T=new Te.e({publisher:et}),N=t(Object(Ke.e)({name:"remoteItemsMissingParentRef"})),C="number"==typeof d["@odata.count"]?d["@odata.count"]:w||d.value.length,k=d["@odata.nextLink"],L=!!k,A=t(Object(Ge.e)(function(e){return{childItemsFacetResolved:e.isItemFacetResolved(H.e,a),prevChildKeys:e.demandItemFacet(H.e,a)}})),O=A.childItemsFacetResolved,M=A.prevChildKeys,_=M&&M.itemKeys,D=0,P=0;y&&(O&&_?u=_.slice(0):"number"==typeof C&&(u=new Array(C+(L&&C<=d.value.length?1:0))));u||(u=new Array(d.value.length+(L?1:0)));for(var B=m,j=0,F=0,I=d.value;F<I.length;F++){var q=I[F],R=c&&c(q),U=q.remoteItem,z=!(q.remoteItem&&q.remoteItem.parentReference&&q.remoteItem.parentReference.driveId),X=U&&z;X&&j++;if(R||X){u.splice(B,1);C--}else{var V=t(Object(W.e)({graphEndpoint:Le.m,graphRecentEndpoint:Le.b,processDriveItemSet:Le.C,allowDisableRemoteItemInPlace:Le.i})),$=V.graphEndpoint,J=V.graphRecentEndpoint,K=V.processDriveItemSet,Q=V.allowDisableRemoteItemInPlace&&b,G=Q?Ce:ee,Y=q.webDavUrl||!Q&&q.remoteItem&&q.remoteItem.webDavUrl||q.webUrl,te=x.indexOf("/_api/v2.0")>-1||x.indexOf("/_api/v2.1")>-1,ne=$||J;if(Y&&te){var re=Y&&decodeURIComponent(Y);x=ne?new Z.e(re).authority+"/_api/v2.0":""+new Z.e(re).authority+new Z.e(x).path}var ie=t(G({shouldInvalidateItemSetOnChildItemRename:K&&K.shouldInvalidateItemSetOnChildItemRename,setItemKey:a,driveItemResponse:q,endpoint:x,getDriveItemFacets:E})),se=ie.itemResolver,oe=ie.actualItemKey,ue=ie.actualDriveItemKey,ae=q.thumbnails,le=q.remoteItem;D++;(ae||!Q&&le&&le.thumbnails)&&P++;u[B]=oe;T.merge(se);if(h){var ce=h({itemKey:a,driveItemKey:ue,item:q});ce&&T.merge(ce.itemResolver)}var he=t(Object(W.e)({processDriveItemFromSharePoint:Le.N})).processDriveItemFromSharePoint;if(he&&(te||ne)){var pe=t(he.process({itemKey:oe,driveItem:q})).itemResolver;T.merge(pe)}B++}}t(N(Object(r.__assign)({resultType:j<1?Qe.e.Success:Qe.e.Failure},j>0?{extraData:{count:j}}:{})));if(L){var de=qe.serialize({setItemKey:a,endpoint:x,token:k});T.merge(Object(Re.t)({itemKey:de}).itemResolver);u[B]=de}if(p){var ve=p(S);ve&&T.merge(ve.itemResolver)}else T.resolveItems({items:(n={},n[a]=Object(r.__assign)({},H.e.pack({itemKeys:u})),n)});T.resolveItems({items:(i={},i[a]=Object(r.__assign)({},Ze.pack({childCount:D,childCount_withThumbnail:P})),i)});C!==w&&T.resolveItems({items:(s={},s[f]=Object(r.__assign)({},fe.e.pack(C)),s)});T.resolveItems({items:(o={},o[a]=Object(r.__assign)(Object(r.__assign)({},H.s.pack({itemKey:f})),Object(ge.e)().forFacet(H.e).thenInvalidate(Je.e).pack()),o)});return{itemResolver:T}}}var tt=n(150),nt=n(183);function rt(e){var t=e.itemKey,n=e.itemSetKeyFacet,i=e.parentItemKeyFacet,s=e.childItemsResponse,o=e.disableRemoteItem,u=e.parentItemResponse,a=e.mapItemSetKey,f=n.deserialize(t),l=i.serialize(f.driveItemKey),c=f.driveItemKey.endpoint;return function(n){var i,f;nt.n(tt.e.processData.start);var h=n(et(Object(r.__assign)(Object(r.__assign)({},e),{response:s,disableRemoteItem:o,parentItemKey:l}))).itemResolver;if(a){var p=a().itemResolver;h.merge(p)}var d=n(Object(W.e)({allowDisableRemoteItemInPlace:Le.i})).allowDisableRemoteItemInPlace;if(u){var v=n((d&&o?Ce:ee)({setItemKey:t,driveItemResponse:u,endpoint:c})),m=v.itemResolver,g=v.actualItemKey;h.mapKeys({mappings:(i={},i[g]=l,i)});h.merge(m)}h.resolveItems({items:(f={},f[l]=Object(r.__assign)({},Object(ge.e)().forFacet(H.t).thenInvalidate(e.itemKey,H.e).pack()),f)});nt.n(tt.e.processData.end);return{itemResolver:h}}}var it=n(400);function st(e){var t=this,n=e.itemKey,i=e.itemSetKeyFacet,s=e.getUrl,o=e.sortChildItems,u=e.qosName,a=e.preprocessResponse,f=e.expectedErrors,l=e.disableRemoteItem,c=void 0!==l&&l,h=i.deserialize(n),p=h.driveItemKey.endpoint;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,l,d,v,m;return Object(r.__generator)(this,function(g){switch(g.label){case 0:t=Object(V.n)(h.driveItemKey);g.label=1;case 1:g.trys.push([1,4,,5]);return[4,n(Object($.r)({url:s(h),driveUrl:t,qosName:"getChildren"+(u?"."+u:""),endpoint:p,headers:e.additionalHeaders,expectedErrors:f}))];case 2:i=g.sent();l=Object(r.__spreadArrays)(i.value);d=a&&a(l)||i.value;v=o&&o(d)||d;return[4,n(rt(Object(r.__assign)(Object(r.__assign)({},e),{disableRemoteItem:c,childItemsResponse:Object(r.__assign)(Object(r.__assign)({},i),{value:v})})))];case 3:return[2,{itemResolver:g.sent().itemResolver}];case 4:m=g.sent();throw new it.e(Object(r.__assign)({code:"UnknownError"},m instanceof Error?{innerError:m}:{message:JSON.stringify(m)}));case 5:return[2]}})})}}var ot=n(105),ut=n(535),at=n(1096),ft=n(240);function lt(e,t){var n=new Date(e.valueOf());n.setDate(n.getDate()-t);return n}var ct=n(2004),ht="fileName",pt="sharedByName",dt="dateModified";var vt=new Map([["code",ot.e.text],["csv",ot.e.excel],["docx",ot.e.word],["dotx",ot.e.word],["one",ot.e.onenote],["onepkg",ot.e.onenote],["onetoc",ot.e.onenote],["pdf",ot.e.pdf],["photo",ot.e.media],["potx",ot.e.powerpoint],["ppsx",ot.e.powerpoint],["pptx",ot.e.powerpoint],["rtf",ot.e.text],["txt",ot.e.text],["video",ot.e.media],["xlsx",ot.e.excel],["xltx",ot.e.excel],["zip",ot.e.zip]]);function mt(e,t){var n,r,i=(n=e,r=Object(ut.t)(n,!0),Object(at.t)(r)),s=vt.get(i);return!!s&&Object(ot.t)(t.filters,s)}function gt(e,t){void 0===t&&(t=[]);return t.every(function(t){var n,r=!(t.type===pt)||(function(e,t){var n=e.remoteItem&&e.remoteItem.shared&&e.remoteItem.shared.sharedBy&&e.remoteItem.shared.sharedBy.user&&e.remoteItem.shared.sharedBy.user.displayName;return!!n&&t.indexOf(n)>-1})(e,t.values),i=!(t.type===ht)||(function(e,t){return!!e.name&&mt(e.name,t)})(e,Object(ft.t)(t.values)),s=!(t.type===dt)||(function(e,t){var n=e.lastModifiedDateTime||"";return(n&&new Date(n))>=t})(e,(function(e){var t=new Date,n=new Date(t.getFullYear(),t.getMonth(),t.getDate());switch(e){case ct.e.today:return n;case ct.e.yesterday:return lt(n,1);case ct.e.last7Days:return lt(n,7);case ct.e.last30Days:return lt(n,30);case ct.e.last3Months:return lt(n,90);default:return new Date(0)}})((n=t.values).length<1||-1===Object.keys(ct.e).indexOf(n[0])?ct.e.none:ct.e[n[0]]));return r&&i&&s})}var yt=n(275);function bt(e,t,n){var r=e.lastModifiedDateTime,i=t.lastModifiedDateTime,s=r&&i&&new Date(r).getTime()-new Date(i).getTime()||0,o=r&&i&&new Date(i).getTime()-new Date(r).getTime()||0;return n?s:o}function wt(e,t,n){var r=e&&e.remoteItem&&e.remoteItem.shared&&e.remoteItem.shared.sharedDateTime,i=t&&t.remoteItem&&t.remoteItem.shared&&t.remoteItem.shared.sharedDateTime,s=r&&i&&new Date(r).getTime()-new Date(i).getTime()||0,o=r&&i&&new Date(i).getTime()-new Date(r).getTime()||0;return n?s:o}function Et(e,t,n){var r=e.name,i=t.name,s=r&&i&&r.localeCompare(i)||0,o=r&&i&&i.localeCompare(r)||0;return n?s:o}function St(e,t,n){var r=e.remoteItem&&e.remoteItem.shared&&e.remoteItem.shared.sharedBy&&e.remoteItem.shared.sharedBy.user&&e.remoteItem.shared.sharedBy.user.displayName,i=t.remoteItem&&t.remoteItem.shared&&t.remoteItem.shared.sharedBy&&t.remoteItem.shared.sharedBy.user&&t.remoteItem.shared.sharedBy.user.displayName,s=r&&i&&r.localeCompare(i)||0,o=r&&i&&i.localeCompare(r)||0;return n?s:o}function xt(e,t,n,i){return(function(e,t){return Object(r.__spreadArrays)(e).sort(t)})(e,function(e,r){var s=e.folder,o=r.folder;return n&&s&&!o?-1:n&&!s&&o?1:i(e,r,t)})}var Tt=n(3897),Nt=n(4298),Ct=n(547),kt=n(47),Lt=n(3898);function At(e){if(o.e.matches(e)){var t=o.e.deserialize(e).groupBy;if(t===h.t[h.i])return(function(e){var t={},n=function(i){for(var s,o,u=new Te.e({publisher:n}),a=(function(e){for(var t=[],n=0,r=e;n<r.length;n++){var i=r[n];if(!Tt.n.matches(i))return e;var s=Tt.n.deserialize(i);t.push(s)}return t.sort(function(e,t){return e&&t&&e.displayName.localeCompare(t.displayName)}).map(function(e){return Tt.n.serialize(e)})})(Object.keys(t)),f=[],l=0,c=a;l<c.length;l++){var h=c[l];if(Tt.n.matches(h)){var p=Tt.n.deserialize(h);u.resolveItems({items:(s={},s[h]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},q.h.pack(p.displayName)),fe.s.pack(!0)),H.e.pack({itemKeys:t[h]})),s)});f.push(h)}}u.resolveItems({items:(o={},o[e]=Object(r.__assign)(Object(r.__assign)({},H.e.pack({itemKeys:f})),kt.e.pack(!0)),o)});return{itemResolver:u}};return{onProcessResponse:function(e){var n,r=e.driveItemKey,i=e.item;if(i&&r){var s=i.remoteItem,o=s&&s.shared&&s.shared.sharedBy,u=o&&o.user,a=X.e.serialize(r);if(u&&u.email){var f=Tt.n.serialize({displayName:u.displayName,email:u.email});if(n=f,t.hasOwnProperty(n))t[f].push(a);else{t[f]=[];t[f].push(a)}}}},groupChildItems:n}})(e);if(t===h.t[h.e])return(function(e){var t={},n=function(i){for(var s,o,u=new Te.e({publisher:n}),a=(function(e){for(var t={},n=(function(e){for(var t=[],n=0,r=e;n<r.length;n++){var i=r[n];if(!Tt.e.matches(i))return e;var s=Tt.e.deserialize(i);t.push(s)}return t.sort(function(e,t){return e&&t&&new Date(t.sharedDateTime).getTime()-new Date(e.sharedDateTime).getTime()}).map(function(e){return Tt.e.serialize(e)})})(Object.keys(e)),r=function(e){return t.hasOwnProperty(e)},i=0,s=n;i<s.length;i++){var o=s[i];if(Tt.e.matches(o)){var u=Tt.e.deserialize(o).relativeTime,a=Tt.t.serialize({relativeTime:u});if(r(a))for(var f=e[o],l=0,c=f;l<c.length;l++){var h=c[l];t[a].push(h)}else{t[a]=[];f=e[o];for(var p=0,d=f;p<d.length;p++){h=d[p];t[a].push(h)}}}}return t})(t),f=[],l=0,c=Object.keys(a);l<c.length;l++){var h=c[l];if(Tt.t.matches(h)){var p=Tt.t.deserialize(h).relativeTime;u.resolveItems({items:(s={},s[h]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},q.h.pack(p)),fe.s.pack(!0)),H.e.pack({itemKeys:a[h]})),s)});f.push(h)}}u.resolveItems({items:(o={},o[e]=Object(r.__assign)(Object(r.__assign)({},H.e.pack({itemKeys:f})),kt.e.pack(!0)),o)});return{itemResolver:u}};return{onProcessResponse:function(e){var n,r=e.driveItemKey,i=e.item;if(i&&r){var s=i.remoteItem,o=s&&s.shared&&s.shared.sharedDateTime,u=X.e.serialize(r);if(o){var a=(function(e,t){if(!e)return Nt.n;var n=new Date(t.getFullYear(),t.getMonth(),t.getDate());if(e>=n)return Ct.today;n.setDate(n.getDate()-1);if(e>=n)return Ct.yesterday;n.setDate(t.getDate()-t.getDay());if(e>=n)return Nt.i;n.setDate(n.getDate()-7);if(e>n)return Nt.t;var r=new Date(t.getFullYear(),t.getMonth(),1),i=new Date(t.getFullYear(),t.getMonth()-1,1);if(e>=i&&e<r)return Nt.e;n.setDate(n.getDate()-7);if(e>n)return Nt.o;n.setDate(n.getDate()-7);if(e>n)return Nt.s;if(e>=r)return Nt.r;var s=t.getFullYear()===e.getFullYear(),o=Lt.e[e.getMonth()];if(s)return o;return M.format(Ct.MonthAndYear,o,e.getFullYear())})(new Date(o),new Date),f=Tt.e.serialize({relativeTime:a,sharedDateTime:o});if(n=f,t.hasOwnProperty(n))t[f].push(u);else{t[f]=[];t[f].push(u)}}}},groupChildItems:n}})(e)}return{onProcessResponse:void 0,groupChildItems:void 0}}var Ot=Object(i.i)()(function(e){var t=this,n=o.e.deserialize(e.itemKey),i=n.filters,s=n.sortBy,u=n.isAscending;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,a,f,l,c,p,d,v;return Object(r.__generator)(this,function(m){switch(m.label){case 0:t=At(e.itemKey),a=t.onProcessResponse,f=t.groupChildItems;l=o.e.deserialize(e.itemKey);c=l.driveItemKey.endpoint;p=n(Object(W.e)({graphSharedWithMeEndpoint:Le.w})).graphSharedWithMeEndpoint;c=p||c;d=n(Object($.i)(c));return[4,n(st(Object(r.__assign)(Object(r.__assign)({},e),{qosName:"sharedWithMe",itemSetKeyFacet:o.e,parentItemKeyFacet:Ve.e,getUrl:function(e){return d?c+"/drive/oneDrive.sharedWithMe":c+"/me/drive/sharedWithMe?expand=formats&allowExternal=true&$top=500"},filterChildItems:function(e){return!gt(e,i)},sortChildItems:function(e){return(function(e,t,n,r){void 0===r&&(r=!1);var i=h.t[h.e],s=h.t[h.i],o=h.t[yt.t],u=h.t[h.r],a=h.t[yt.r];switch(t){case i:return xt(e,n,r,wt);case s:return xt(e,n,r,St);case o:case a:return xt(e,n,r,Et);case u:return xt(e,n,r,bt);default:return e}})(e,s,u,!0)},onProcessResponse:a,groupChildItems:f})))];case 1:v=m.sent().itemResolver;n(v.execute());return[2]}})})}});var Mt=new G.e("sharedByMeRootItem",{endpoint:Object(G.s)()}),_t=new G.e("sharedByMeItemSet",{driveItemKey:Object(G.o)(X.e)}),Dt=Object(i.i)()(function e(t){var n=this,i=t.itemKey,s=Mt.deserialize(i);return function(t){return Object(r.__awaiter)(n,void 0,void 0,function(){var n,o;return Object(r.__generator)(this,function(u){(n=new Te.e({publisher:e})).resolveItems({items:(o={},o[i]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},H.t.pack({itemKey:_t.serialize({driveItemKey:s})})),q.h.pack(ue.i)),q.m.pack({})),q.M.pack(void 0)),o)});t(n.execute());return[2]})})}});var Pt=Object(i.i)()(function(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t;return Object(r.__generator)(this,function(i){switch(i.label){case 0:return[4,n(st(Object(r.__assign)(Object(r.__assign)({},e),{qosName:"sharedByMe",itemSetKeyFacet:_t,parentItemKeyFacet:Mt,getUrl:function(e){return e.driveItemKey.endpoint+"/drive/shared"}})))];case 1:t=i.sent().itemResolver;n(t.execute());return[2]}})})}});var Ht=n(402),Bt=n(403),jt=Object(i.i)()(function e(t){var n=this,i=t.itemKey,s=Bt.e.deserialize(i);return function(t){return Object(r.__awaiter)(n,void 0,void 0,function(){var n,o,u;return Object(r.__generator)(this,function(a){n=t(Object(W.e)({groupBy:Le.L})).groupBy;(o=new Te.e({publisher:e})).resolveItems({items:(u={},u[i]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},H.t.pack({itemKey:Ht.e.serialize({driveItemKey:s,sortBy:"",isAscending:!0,groupBy:n||""})})),q.h.pack(ue.n)),q.m.pack({})),q.M.pack(void 0)),u)});t(o.execute());return[2]})})}});var Ft=n(609),It=n(407),qt=Object(i.i)()(function e(t){var n=this,i=t.itemKey,s=It.e.deserialize(i);return function(t){return Object(r.__awaiter)(n,void 0,void 0,function(){var n,o;return Object(r.__generator)(this,function(u){(n=new Te.e({publisher:e})).resolveItems({items:(o={},o[i]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},H.t.pack({itemKey:Ft.e.serialize({driveItemKey:s,sortBy:"",isAscending:!0})})),q.h.pack(ue.r)),q.m.pack({})),q.M.pack(void 0)),o)});t(n.execute());return[2]})})}});var Rt,Ut=n(141),zt=new G.e("recentGroup",{recentItemSet:Object(G.o)(Ht.e),relativeTime:Object(G.r)({today:"today",yesterday:"yesterday",thisWeek:"thisWeek",lastWeek:"lastWeek",twoWeeksAgo:"twoWeeksAgo",threeWeeksAgo:"threeWeeksAgo",thisMonth:"thisMonth",lastMonth:"thisMonth",twoMonthsAgo:"twoMonthsAgo",older:"older"})});(function(e){e.today="today";e.yesterday="testerday";e.thisWeek="thisWeek";e.lastWeek="lastWeek";e.twoWeeksAgo="twoWeeksAgo";e.threeWeeksAgo="threeWeeksAgo";e.thisMonth="thisMonth";e.lastMonth="lastMonth";e.twoMonthsAgo="twoMonthsAgo";e.older="older"})(Rt||(Rt={}));function Wt(e){var t=new Date;return(function(e,t){return Xt(t,e)})(e,t)?Rt.today:(function(e,t){return Xt(new Date(t.getTime()-864e5),e)})(e,t)?Rt.yesterday:(function(e,t){var n=t.setHours(0,0,0,0)-864e5*t.getDay();return e.getTime()>n})(e,t)?Rt.thisWeek:(function(e,t){var n=t.setHours(0,0,0,0)-864e5*(t.getDay()+7);return e.getTime()>n})(e,t)?Rt.lastWeek:(function(e,t){var n=t.setHours(0,0,0,0)-12096e5;return e.getTime()>n})(e,t)?Rt.twoWeeksAgo:(function(e,t){var n=t.setHours(0,0,0,0)-18144e5;return e.getTime()>n})(e,t)?Rt.threeWeeksAgo:(function(e,t){return t.getFullYear()===e.getFullYear()&&t.getMonth()===e.getMonth()})(e,t)?Rt.thisMonth:(function(e,t){var n=t.getMonth(),r=e.getMonth();return n-r==11||t.getFullYear()===e.getFullYear()&&t.getMonth()-e.getMonth()==1})(e,t)?Rt.lastMonth:(function(e,t){var n=t.getFullYear(),r=e.getFullYear(),i=t.getMonth(),s=e.getMonth(),o=n-r==1&&i-s==-10;return n===r&&i-s==2||o})(e,t)?Rt.twoMonthsAgo:Rt.older}function Xt(e,t){return e.toDateString()===t.toDateString()}var Vt=n(4300);var $t=function(e,t){var n=new RegExp("^"+t+"\\/","i");return e.filter(function(e){var t=e&&e.remoteItem||e;return!(!t||!t.file)&&n.test(t.file.mimeType)})},Jt=Object(i.i)()(function(e){var t=this,n=Ht.e.deserialize(e.itemKey),i=n.filters,s=void 0===i?[]:i,o=n.groupBy,u=void 0===o?"":o,a=n,f=Object(ft.e)({extFilters:Object(ft.t)(s),allowedMediaTypes:[ot.e.photo,ot.e.video],fileTypeIconMap:Ut.e}),l=Object(ft.e)({extFilters:Object(ft.t)(s),allowedMediaTypes:[ot.e.photo],fileTypeIconMap:Ut.e}),c=Object(ft.e)({extFilters:Object(ft.t)(s),allowedMediaTypes:[ot.e.video],fileTypeIconMap:Ut.e});return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,o,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,B,j,F,I,R,U;return Object(r.__generator)(this,function(z){switch(z.label){case 0:t=n(Object(W.e)({graphRecentEndpoint:Le.b,enableOverflowRecentGroup:Le.c})),i=t.graphRecentEndpoint,o=t.enableOverflowRecentGroup;if(!i)return[3,1];a=Object(r.__assign)(Object(r.__assign)({},a),{driveItemKey:Object(r.__assign)(Object(r.__assign)({},a.driveItemKey),{endpoint:i})});return[3,3];case 1:return[4,n(Ae({endpoint:a.driveItemKey.endpoint}))];case 2:(h=z.sent())!==a.driveItemKey.endpoint&&(a=Object(r.__assign)(Object(r.__assign)({},a),{driveItemKey:Object(r.__assign)(Object(r.__assign)({},a.driveItemKey),{endpoint:h})}));z.label=3;case 3:p=Ht.e.serialize(a);d=zt.serialize({recentItemSet:a,relativeTime:"today"});v=zt.serialize({recentItemSet:a,relativeTime:"yesterday"});m=zt.serialize({recentItemSet:a,relativeTime:"thisWeek"});g=zt.serialize({recentItemSet:a,relativeTime:"lastWeek"});y=zt.serialize({recentItemSet:a,relativeTime:"twoWeeksAgo"});b=zt.serialize({recentItemSet:a,relativeTime:"threeWeeksAgo"});w=zt.serialize({recentItemSet:a,relativeTime:"lastMonth"});E=zt.serialize({recentItemSet:a,relativeTime:"twoMonthsAgo"});S=zt.serialize({recentItemSet:a,relativeTime:"older"});x=[];T=[];N=[];C=[];k=[];L=[];A=[];O=[];M=[];_="";D="date"===u;P=function(e){var t,n=e.driveItemKey,i=e.item,s=new Te.e({publisher:P});if(i&&n){var o=i.remoteItem,u=o&&o.fileSystemInfo,a=u&&u.lastAccessedDateTime,f=X.e.serialize(n);if(D&&a){var l=new Date(a);switch(Wt(l)){case Rt.today:x.push(f);break;case Rt.yesterday:T.push(f);break;case Rt.thisWeek:N.push(f);break;case Rt.lastWeek:C.push(f);break;case Rt.twoWeeksAgo:k.push(f);break;case Rt.threeWeeksAgo:L.push(f);break;case Rt.lastMonth:A.push(f);break;case Rt.twoMonthsAgo:O.push(f);_=Lt.e[l.getMonth()];break;case Rt.older:default:M.push(f)}}s.resolveItems({items:(t={},t[f]=Object(r.__assign)({},q.m.pack(void 0)),t)});return{itemResolver:s}}};B=!f&&D?function(t){var n,i,s=new Te.e({publisher:B});s.resolveItems({items:(n={},n[d]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},q.h.pack(Vt.s)),fe.s.pack(!0)),H.e.pack({itemKeys:x})),n[v]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},q.h.pack(Vt.u)),fe.s.pack(!0)),H.e.pack({itemKeys:T})),n[m]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},q.h.pack(Vt.r)),fe.s.pack(!0)),H.e.pack({itemKeys:N})),n[g]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},q.h.pack(Vt.t)),fe.s.pack(!0)),H.e.pack({itemKeys:C})),n[y]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},q.h.pack(Vt.o)),fe.s.pack(!0)),H.e.pack({itemKeys:k})),n[b]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},q.h.pack(Vt.i)),fe.s.pack(!0)),H.e.pack({itemKeys:L})),n[w]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},q.h.pack(Vt.e)),fe.s.pack(!0)),H.e.pack({itemKeys:A})),n[E]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},q.h.pack(_)),fe.s.pack(!0)),H.e.pack({itemKeys:O})),n[S]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},q.h.pack(Vt.n)),fe.s.pack(!0)),H.e.pack({itemKeys:M})),n)});var u=[];x.length>0&&u.push(d);T.length>0&&u.push(v);N.length>0&&u.push(m);C.length>0&&u.push(g);k.length>0&&u.push(y);L.length>0&&u.push(b);A.length>0&&u.push(w);O.length>0&&u.push(E);M.length>0&&o&&u.push(S);s.resolveItems({items:(i={},i[e.itemKey]=Object(r.__assign)({},H.e.pack({itemKeys:u})),i)});return{itemResolver:s}}:void 0;j=n(Object($.i)(a.driveItemKey.endpoint));F=[{code:"notAllowed",message:"You do not have permission to create this personal site or you do not have a valid license"},{code:"notAllowed",message:"Access to this site has been blocked. Please contact the administrator to resolve this problem."},{code:"notAllowed",message:"Operation not allowed"},{code:"BadRequest",message:"Tenant does not have a SPO license."},{code:"AccessDenied",message:"Access to this site has been blocked. Please contact the administrator to resolve this problem."},{code:"UnknownError",message:"401 UNAUTHORIZED"},{code:"503"},{code:"ItemNotFound"},{code:"activityLimitReached"},{code:"serviceNotAvailable"}];return[4,n(st(Object(r.__assign)(Object(r.__assign)({},e),{qosName:f?"recentMedia":j?"ODC-recent":"recent",itemKey:p,itemSetKeyFacet:Ht.e,parentItemKeyFacet:Bt.e,getUrl:function(e){var t=Object(V.n)({endpoint:e.driveItemKey.endpoint,driveId:"me"})+"/recent?";if(j)t=e.driveItemKey.endpoint+"/drive/view.recent?";else if(f){return t+="$filter=(remoteItem/image ne null or remoteItem/video ne null)&$expand=thumbnails"}return""+t+(function(e){if(!e||0===e.length)return"";for(var t=[],n=[],i=0;i<e.length;i++){var s=e[i],o=!1,u=s;if("!"===s[0]){u=s.slice(1);o=!0}"folder"===u?!o&&t.push("folder ne null"):"onenote"===u?o?n.push("(remoteItem/package/type ne 'oneNote' and package/type ne 'oneNote')"):t.push("(remoteItem/package/type eq 'oneNote' or package/type eq 'oneNote')"):"."!==u[0]||!o&&t.push("(endsWith(name, '"+u.toLowerCase()+"') or endsWith(remoteItem/name, '"+u.toLowerCase()+"'))")}return t.length>0||n.length>0?"&$filter="+(0===n.length?Ue(t):0===t.length?ze(n):ze(Object(r.__spreadArrays)([Ue(t)],n))):""})(s)},getDriveItemFacets:Kt,expectedErrors:F,preprocessResponse:function(e){l?e=$t(e,"image"):c&&(e=$t(e,"video"));return(function(e){if(!e)return e;return e.filter(function(e,t,n){return n.map(function(e){return e.id}).indexOf(e.id)===t})})(e.sort(function(e,t){var n=e.remoteItem&&e.remoteItem.fileSystemInfo&&e.remoteItem.fileSystemInfo.lastAccessedDateTime,r=t.remoteItem&&t.remoteItem.fileSystemInfo&&t.remoteItem.fileSystemInfo.lastAccessedDateTime;return n||r?n?r?n>r?-1:1:-1:1:0}))},additionalHeaders:f?{Prefer:"ApiVersion=2.1,RecentOnlyMediaApp,NoPreAuthThumbnailUrls"}:{Prefer:"ApiVersion=2.1;ODC,returnparentresource,returnowner"},onProcessResponse:P,groupChildItems:B})))];case 4:I=z.sent().itemResolver;f&&I.resolveItems({items:(R={},R[e.itemKey]=Object(r.__assign)({},fe.u.pack({})),R)});I.mapKeys({mappings:(U={},U[p]=e.itemKey,U)});n(I.execute());return[2]}})})}});function Kt(e){return function(t){var n,i=new Te.e({publisher:Kt});i.merge(t(Object(J.e)(e)).itemResolver);var s=e.driveItem,o=s.thumbnails,u=s.remoteItem,a=o||u&&u.thumbnails;i.resolveItems({items:(n={},n[e.itemKey]=Object(r.__assign)({},a?Object(r.__assign)({},me.e.pack(!1)):{}),n)});return{itemResolver:i}}}var Qt=n(495);function Gt(e){var t,n,r=e.name&&(t=e.name,n=".aspx",t.substr(t.length-n.length)===n),i=e.package||e.remoteItem&&e.remoteItem.package,s=i&&"oneNote"===i.type;return r||s||!1}var Yt=Object(i.i)()(function e(t){var n=this;return function(i){return Object(r.__awaiter)(n,void 0,void 0,function(){var n,s,o,u,a,f;return Object(r.__generator)(this,function(l){switch(l.label){case 0:n=i(Object(W.e)({saveForLaterGraphEndpoint:Le.A})).saveForLaterGraphEndpoint;s=Ft.e.deserialize(t.itemKey);if(!n||n===s.driveItemKey.endpoint)return[3,1];s=Object(r.__assign)(Object(r.__assign)({},s),{driveItemKey:Object(r.__assign)(Object(r.__assign)({},s.driveItemKey),{endpoint:n})});return[3,3];case 1:return[4,i(Ae({endpoint:s.driveItemKey.endpoint}))];case 2:(o=l.sent())!==s.driveItemKey.endpoint&&(s=Object(r.__assign)(Object(r.__assign)({},s),{driveItemKey:Object(r.__assign)(Object(r.__assign)({},s.driveItemKey),{endpoint:o})}));l.label=3;case 3:u=Ft.e.serialize(s);a=[{code:"provisioningNotAllowed",message:"You do not have permission to create this personal site or you do not have a valid license"},{code:"BadRequest",message:"Unable to retrieve user's mysite URL."},{code:"InvalidAuthenticationToken",message:"Access token has expired."},{code:"resourceBeingProvisioned",message:"The requested resource is being automatically provisioned. Please try again in a few minutes."}];return[4,i(st(Object(r.__assign)(Object(r.__assign)({},t),{itemKey:u,qosName:"savedForLater",itemSetKeyFacet:Ft.e,parentItemKeyFacet:It.e,getUrl:function(e){if(e.driveItemKey.endpoint===n){return e.driveItemKey.endpoint+"/me/drive/following?top=5000&select="+["followed","name","parentReference","webDavUrl","webUrl","id","size","lastModifiedBy","lastModifiedDateTime","sharepointIds"].join(",")}return e.driveItemKey.endpoint+"/drives/me/followed?top=5000&select=*,webDavUrl"},onProcessResponse:function(t){var n,i,s=t.itemKey,o=t.driveItemKey,u=t.item,a=new Te.e({publisher:e});if(o&&u){var f=X.e.serialize(o),l=Qt.e.serialize({driveItemKey:o}),c=u&&(u.webDavUrl||u.webUrl);a.resolveItems({items:(n={},n[f]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},q.g.pack({itemKey:l})),q.i.pack(c)),q.v.pack(u.size)),n[l]=Object(r.__assign)(Object(r.__assign)({},q.E.pack(!0)),Object(ge.e)().forFacet(q.E).thenInvalidate(s,H.e).pack()),n)});a.invalidateItems({items:(i={},i[s]=[H.e],i)})}return{itemResolver:a}},filterChildItems:Gt,getDriveItemFacets:Zt,mapItemSetKey:function(){var n,r=new Te.e({publisher:e});r.mapKeys({mappings:(n={},n[u]=t.itemKey,n)});return{itemResolver:r}},expectedErrors:a})))];case 4:f=l.sent().itemResolver;i(f.execute());return[2]}})})}});function Zt(e){var t=e.driveItem;return function(n){var i,s=t.root,o=t.remoteItem,u=t.name,a=s?ue.t:u||o&&o.name||"",f=!t.webDavUrl,l=t.followed&&t.followed.followedDateTime,c=new Te.e({publisher:Zt});c.merge(n(Object(J.e)(Object(r.__assign)(Object(r.__assign)({},e),{shouldReturnShareFacets:!1}))).itemResolver);c.resolveItems({items:(i={},i[e.itemKey]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},q.d.pack(Object(J.t)(a,f))),l?q.a.pack(new Date(l).getTime()):{}),q.m.pack(f?{}:void 0)),i)});return{itemResolver:c}}}var en=n(3899),tn=n(1238),nn=Object(i.n)()(function e(t){var n=this,i=t.items;return function(t){return Object(r.__awaiter)(n,void 0,void 0,function(){var n,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,S;return Object(r.__generator)(this,function(x){switch(x.label){case 0:return[4,t(Object(Ge.e)(function(e){return e.demandItemFacet(w.p,E.e)}))];case 1:if(!x.sent())return[2];n=Object.keys(i);s=n[0];o=Qt.e.deserialize(s);if(!(u=o.driveItemKey.endpoint))throw new Error("No endpoint to determine followed items.");a=Ft.e.serialize({driveItemKey:{endpoint:u},sortBy:"",isAscending:!0});return[4,t(Object(tn.e)(function(e){return e.demandItemFacet(H.e,a)}))];case 2:f=x.sent();l=f&&f.itemKeys||[];c=new Te.e({publisher:e});h={};for(p=0,d=l;p<d.length;p++){y=d[p];h[y]=!0}for(v=0,m=n;v<m.length;v++){g=m[v];y=Qt.e.deserialize(g).driveItemKey;b=!!h[X.e.serialize(y)];c.resolveItems({items:(S={},S[g]=Object(r.__assign)(Object(r.__assign)({},q.E.pack(b||void 0)),Object(ge.e)().forFacet(q.E).thenInvalidate(a,H.e).pack()),S)})}t(c.execute());return[2]}})})}});var rn=n(3032),sn=new G.e("searchRootItem",{endpoint:Object(G.s)()}),on=Object(i.i)()(function(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i;return Object(r.__generator)(this,function(s){switch(s.label){case 0:t=[{code:"AccessDenied",message:"Access to this site has been blocked. Please contact the administrator to resolve this problem."},{code:"UnknownError",message:"401 UNAUTHORIZED"},{code:"503"},{code:"ItemNotFound"},{code:"activityLimitReached"},{code:"serviceNotAvailable"}];return[4,n(st(Object(r.__assign)(Object(r.__assign)({},e),{qosName:"search",itemSetKeyFacet:rn.e,parentItemKeyFacet:sn,getUrl:function(e){var t,n=e.driveItemKey,r=e.searchTerm;r&&(t=encodeURIComponent(r));return Object(V.t)(n)+"/search(q='"+t+"')?$expand=thumbnails&select=*,webDavUrl"},expectedErrors:t})))];case 1:i=s.sent().itemResolver;n(i.execute());return[2]}})})}});var un=new Ye.e("convergenceConfigurationFacet"),an=n(203),fn=n(2018);var ln=n(3541);function cn(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,B,j,F,I,q,R,U,z,J,K,Q,G;return Object(r.__generator)(this,function(Y){switch(Y.label){case 0:t=e.itemKey,i=e.top,s=e.skip,o=e.disableRemoteItemInPlace;u=ne.e.deserialize(t);a=u.driveItemKey,f=u.extFilters;l=u.sortBy,c=u.isAscending;h=u;p=a;return a.driveId&&"me"!==a.driveId?[3,2]:[4,n(Ae({endpoint:a.endpoint}))];case 1:if((d=Y.sent())!==a.endpoint){p=Object(r.__assign)(Object(r.__assign)({},a),{endpoint:d});h=Object(r.__assign)(Object(r.__assign)({},u),{driveItemKey:p})}Y.label=2;case 2:v=X.e.serialize(p);m=Object(V.n)(p);return[4,n(Object(Ge.e)(function(e){return{isParentItemResolved:e.isItemFacetResolved(X.e,v),totalChildCount:e.isItemFacetResolved(fe.e,v)?e.demandItemFacet(fe.e,v):void 0,driveType:e.isItemFacetResolved(le.e,v)?e.demandItemFacet(le.e,v):void 0}}))];case 3:g=Y.sent(),y=g.isParentItemResolved,b=g.totalChildCount,w=g.driveType;E=n(Object($.i)(p.endpoint));S=n(Object(W.e)({convergenceConfiguration:un})).convergenceConfiguration;x=S&&S.canHandleUserMigration;T=Promise.resolve(void 0);y||(T=n(Object($.r)({url:Object(V.t)(p),driveUrl:m,useMultiPartIfSupported:E,qosName:"getItem",endpoint:p.endpoint,headers:E&&x?{Prefer:"Migration=EnableRedirect;FailOnMigratedFiles"}:void 0})));N=[{code:"notAllowed",message:"You do not have access to create this personal site or you do not have a valid license"},{code:"BadRequest",message:"Tenant does not have a SPO license."},{code:"AccessDenied",message:"Access to this site has been blocked. Please contact the administrator to resolve this problem."},{code:"UnknownError",message:"401 UNAUTHORIZED"},{code:"ItemNotFound"},{code:"503"},{code:"userContentMigrated"}];C=Object(V.t)(a);k=s?"&skiptoken="+(s+1)+"/"+b+"&skip="+s:"";L=E&&ln.e?"&orderby=folder,savedSortFieldValue":"";A=l&&void 0!==c?Object($.t)(l,c):L;O=(function(e){if(!e||0===e.length)return"";for(var t=[],n=[],i=0;i<e.length;i++){var s=e[i],o=!1,u=s;if("!"===s[0]){u=s.slice(1);o=!0}if("folder"===u&&1===e.length)!o&&t.push("folder ne null");else if("."!==u[0]);else{t=[];n=[]}}return t.length>0||n.length>0?"&$filter="+(0===n.length?Ue(t):0===t.length?ze(n):ze(Object(r.__spreadArrays)([Ue(t)],n))):""})(f);M="thumbnails"+(E?",lenses,tags":"");_=n(Object($.r)({url:C+"/children?$top="+i+k+A+"&$expand="+M+"&select=*,ocr,webDavUrl"+O,driveUrl:m,qosName:"getChildren.folder",useMultiPartIfSupported:E,endpoint:p.endpoint,headers:E&&x?{Prefer:"Migration=EnableRedirect;FailOnMigratedFiles"}:void 0,expectedErrors:N})).catch(function(t){throw n((function(e,t){var n=e.error;return function(i){var s,o=(function(e,t){var n=Object(Ye.n)({},{});e instanceof fn.e&&(n=Object(fn.t)(e,function(e){switch(e){case 404:return an.p.pack({});case 401:return an.e.pack({});case 0:return an.g.pack({domain:new Z.e(t).domain})}})||Object(Ye.n)({},{}));return n})(n,t),u=Object(Ye.r)({itemNotFoundError:an.p,accessDeniedError:an.e,networkBlockedError:an.g},o),a=u.itemNotFoundError,f=u.accessDeniedError,l=u.networkBlockedError,c=new it.e({facets:o,innerError:new it.e(n)});if(a||f||l){var h=new Te.e;h.updateItems({items:(s={},s[e.itemKey]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},H.e.pack(void 0)),H.o.pack(void 0)),ke.e.pack(c)),s)});i(h.execute())}return c}})(Object(r.__assign)(Object(r.__assign)({},e),{error:t}),p.endpoint))});D=[_,T];P=!1;if(!nt.t(tt.e.dataFetch.start)){nt.n(tt.e.dataFetch.start);P=!0}return[4,Promise.all(D)];case 4:B=Y.sent(),j=B[0],F=B[1];P&&nt.n(tt.e.dataFetch.end);if(F){F.folder&&(b=F.folder.childCount);F.parentReference&&F.parentReference.driveType&&(w=F.parentReference.driveType)}I=n(Object($.s)(p.endpoint,w));(q=new Te.e({publisher:cn})).mapKeys({mappings:(z={},z[ne.e.serialize(h)]=e.itemKey,z[v]=X.e.serialize(u.driveItemKey),z)});if(!u.driveItemKey.driveId||"me"===u.driveItemKey.driveId){(null===(G=null===(Q=F)||void 0===Q?void 0:Q.parentReference)||void 0===G?void 0:G.driveId)&&q.mapKeys({mappings:(J={},J[ne.e.serialize(Object(r.__assign)(Object(r.__assign)({},h),{driveItemKey:Object(r.__assign)(Object(r.__assign)({},h.driveItemKey),{driveId:F.parentReference.driveId})}))]=e.itemKey,J)});q.mapKeys({mappings:(K={},K[X.e.serialize(Object(r.__assign)(Object(r.__assign)({},u.driveItemKey),{driveId:"me"}))]=X.e.serialize(Object(r.__assign)(Object(r.__assign)({},u.driveItemKey),{driveId:""})),K)})}U=(R=q).merge;return[4,n(rt({itemKey:t,itemSetKeyFacet:ne.e,parentItemKeyFacet:X.e,parentItemResponse:F,childItemsResponse:j,disableRemoteItem:o,filterChildItems:f&&f.length>0?We(f):void 0,skip:s,enableRandomAccess:I,totalChildCount:b,onProcessResponse:function(e){var t,n=e.driveItemKey,i=new Te.e({publisher:cn});n&&i.resolveItems({items:(t={},t[X.e.serialize(n)]=Object(r.__assign)({},ke.r.pack(X.e)),t)});return{itemResolver:i}}}))];case 5:U.apply(R,[Y.sent().itemResolver]);return[2,q]}})})}}var hn=Object(i.i)()(function(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i;return Object(r.__generator)(this,function(s){switch(s.label){case 0:t=n(Object(W.e)({pageSize:Le.s})).pageSize;return[4,n(cn(Object(r.__assign)(Object(r.__assign)({},e),{disableRemoteItemInPlace:!0,skip:0,top:t||Q.t})))];case 1:i=s.sent();nt.n(tt.e.resolveData.start);n(i.execute());nt.n(tt.e.resolveData.end);return[2]}})})}});var pn=n(769),dn=Object(i.t)(function(){return function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(t){e(Object(pn.e)(function(){e(Object(U.t)({keyFacet:ne.e,facets:[ne.e,H.e]}));e(Object(s.r)(ne.e,z.e)(hn))}));return[2]})})}}),vn=n(692),mn=n(3540),gn=n(3539),yn=Object(i.i)()(function e(t){var n=this;return function(i){return Object(r.__awaiter)(n,void 0,void 0,function(){var n,s,o,u,a,f,l;return Object(r.__generator)(this,function(c){switch(c.label){case 0:n=t.itemKey;s=gn.e.deserialize(n);o=s.endpoint;u=Object(V.n)(s);return[4,i(bn({url:Object(V.e)(s),driveUrl:u,qosName:"commands",endpoint:o}))];case 1:a=c.sent();(f=new Te.e({publisher:e})).resolveItems({items:(l={},l[n]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},mn.e.pack(a.addToOneDrive)),mn.t.pack(a.createFolder)),mn.n.pack(a.createLink)),mn.r.pack(a.delete)),mn.i.pack(a.download)),mn.s.pack(a.invite)),mn.o.pack(a.move)),mn.u.pack(a.officeLens)),mn.a.pack(a.rename)),mn.f.pack(a.upload)),l)});i(f.execute());return[2]}})})}});function bn(e){var t=this;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){return Object(r.__generator)(this,function(e){return[2,{addToOneDrive:{roles:["write"]},createFolder:{roles:["owner","write"]},createLink:{defaultScope:"anonymous",linkTypes:["view","edit"],scopes:["anonymous","application"]},delete:{roles:["owner","write"]},download:{roles:["owner","write","read"]},invite:{roles:["owner","write"]},move:{roles:["owner","write"]},officeLens:{extensions:["jpeg","jpg","jpe"],lensNames:["officeLens"],roles:["owner"]},rename:{roles:["owner","write"]},upload:{roles:["owner","write"]}}]})})}}var wn=n(3900),En=n(437),Sn=new G.e("thumbnailToken",{endpoint:Object(G.s)(),driveId:Object(G.s)({shouldNormalizeToEmpty:!0})}),xn=new Ye.e("thumbnailAccessToken"),Tn=n(465),Nn=n(244),Cn={ODC:"EnableCropModeFolderCoverThumbnail"},kn=Object(f.t)()(function(){return function(e){return Ln}});function Ln(e,t){var n=t.itemKey,r=t.desiredSize,i=t.fitMode,s=e.demandItemFacet(X.e,n);if(!s)return{};var o=e.demandItemFacet(me.e,n)?(function(e,t){var n=t.itemKey,r=t.desiredSize,i=t.fitMode,s=(function(e){return e&&(t=e,t&&"number"==typeof t.length)?e[0]:e;var t})(e.demandItemFacet(re.e,n));if(s&&s.large)return{url:_n(s.large.url,r,i),width:0,height:0}})(e,{itemKey:n,driveItem:s,desiredSize:r,fitMode:i}):(function(e,t){var n=t.itemKey,r=t.driveItem,i=t.desiredSize;if(r.endpoint.indexOf("/_api/v2.")>-1){var s=e.demandItemFacet(q.i,n),o=e.demandItemFacet(q.p,n,{suppressGetItems:!0})||"";if(s){var u=new Z.e(r.endpoint).authority+"/_api/v2.1",a=Sn.serialize({endpoint:u,driveId:r.driveId}),f=e.demandItemFacet(xn,a);if(f){var l=Object(V.t)({endpoint:u,driveId:r.driveId,itemId:r.itemId}),c=Math.ceil(i.width),h=Math.ceil(i.height);return{url:l+"/thumbnails/0/c"+c+"x"+h+"/content?"+Object(Tn.e)({prefer:"noredirect,closestavailablesize",cb:o,access_token:{uriValue:f}}),width:0,height:0}}}}})(e,{itemKey:n,driveItem:s,desiredSize:r});return o?{thumbnail:o}:{}}var An=/width=[0-9]*/,On=/height=[0-9]*/,Mn=/cropmode=[a-z]*/;function _n(e,t,n){if(Nn.e.isFeatureEnabled(Cn)){var r="cover"===n?"center":"none";Mn.test(e)?e=e.replace(Mn,"cropmode="+r):e+=(e.indexOf("?")>-1?"&":"?")+"cropmode="+r}var i="number"==typeof t.width?Math.ceil(t.width):t.width,s="number"==typeof t.height?Math.ceil(t.height):t.height,o=""+(i||"");An.test(e)?e=e.replace(An,"width="+o):e+=(e.indexOf("?")>-1?"&":"?")+"width="+o;var u=""+(s||"");On.test(e)?e=e.replace(On,"height="+u):e+=(e.indexOf("?")>-1?"&":"?")+"height="+u;return e}var Dn=n(788),Pn=n(794),Hn=n(1183),Bn=n(443),jn=Object(f.t)()(function(){return function(e){return Fn}});function Fn(e,t){var n=t.handlers,i=t.itemKey,s=e.demandItemFacet(Ht.e,i);if(n&&s){for(var o=[],u=0,a=n;u<a.length;u++){var f=a[u];if(f.key===Bn.o.key)o.push("photo");else if(f.key===Bn.u.key)o.push("video");else if(f.key===Bn.e.key)o.push("folder");else if(f.key===Bn.s.key)o.push("onenote");else if(f.key===Bn.r.key)o.push("!photo");else if(f.key===Bn.i.key)o.push("!video");else if(f.key===Bn.t.key)o.push("!folder");else if(f.key===Bn.n.key)o.push("!onenote");else{var l=Object(Hn.e)(f);l&&o.push(l)}}return{itemKey:Ht.e.serialize(Object(r.__assign)(Object(r.__assign)({},s),{filters:o}))}}return{}}var In=n(546),qn=n(686),Rn=n(296),Un=Object(f.t)()(Wn),zn=Object(f.t)()(Wn);function Wn(){return function(e){return function(e,t){var n=t.itemKey;if(n){var r=e.demandItemFacet(Ht.e,n);if(r&&r.filters&&Object(ft.e)({extFilters:Object(ft.t)(r.filters),allowedMediaTypes:[ot.e.photo,ot.e.video],fileTypeIconMap:Ut.e}))return{defaultLayout:Rn.e,isLayoutResolved:!0}}return{}}}}var Xn=n(527),Vn=new G.e("sharesItem",{endpoint:Object(G.s)(),shareId:Object(G.s)()}),$n=Object(i.i)()(function e(t){var n=this,i=t.itemKey,s=Vn.deserialize(i),o=s.endpoint;return function(t){return Object(r.__awaiter)(n,void 0,void 0,function(){var n,u,a,f,l,c,h,p,d;return Object(r.__generator)(this,function(v){switch(v.label){case 0:return[4,t(Object($.n)({url:Object(V.r)(s)+"?$expand=thumbnails&select=*,webDavUrl",qosName:"getSharesItem",endpoint:o,headers:{Prefer:"redeemSharingLinkIfNecessary"}}))];case 1:n=v.sent();u=new Te.e({publisher:e});a=n&&n.parentReference;f=a&&a.driveId;l={endpoint:o,driveId:f,itemId:n.id};c=X.e.serialize(l);h=a&&a.id?X.e.serialize({endpoint:o,driveId:f,itemId:a.id}):void 0;u.merge(t(Object(J.e)({itemKey:c,driveItem:n,endpoint:o,parentFolderItemKey:h})).itemResolver);u.resolveItems({items:(p={},p[c]=Object(r.__assign)(Object(r.__assign)({},Fe.n.pack(X.e)),H.t.pack({itemKey:ne.e.serialize({driveItemKey:l,sortBy:"",isAscending:!0})})),p)});u.mapKeys({mappings:(d={},d[c]=i,d)});t(u.execute());return[2]}})})}});var Jn=n(1391),Kn=new G.e("driveItemVirtualizedPage",{endpoint:Object(G.s)(),setItemKey:Object(G.s)(),skip:Object(G.i)(),top:Object(G.i)()}),Qn=Object(i.i)()(function(e){var t=this,n=e.itemKey,i=Kn.deserialize(n),s=i.setItemKey,o=i.top,u=i.skip;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i;return Object(r.__generator)(this,function(a){switch(a.label){case 0:return[4,n(cn(Object(r.__assign)(Object(r.__assign)({},e),{itemKey:s,disableRemoteItemInPlace:!1,skip:u,top:o})))];case 1:(t=a.sent()).resolveItems({items:(i={},i[s]=Object(r.__assign)({},Object(ge.e)().forFacet(H.e).thenInvalidate(e.itemKey,H.e).pack()),i)});n(t.execute());return[2]}})})}});var Gn=n(158),Yn=n(1439),Zn=n(502),er=n(2894),tr=Object(f.t)()(function(){return function(e){return nr}});function nr(e,t){if(1!==t.itemKeys.length)return{};var n=t.itemKeys[0];if(e.demandItemFacet(q.m,n))return{};var i=e.demandItemFacet(X.e,n),s=i?Object(V.t)(i):void 0,o=i?Object(V.n)(i):void 0,u=i&&i.endpoint||"";return{isAvailable:e.demandItemFacet(er.n,n),getDownloadData:s&&o?function(){return(function(e){var t=this,n=e.itemUrl,i=e.driveUrl,s=e.endpoint;return function(o){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,u,a,f;return Object(r.__generator)(this,function(r){switch(r.label){case 0:r.trys.push([0,2,,3]);return[4,o(Object($.n)({url:e.itemUrl,driveUrl:i,method:"GET",qosName:"getItemDownloadUrl",endpoint:s}))];case 1:t=r.sent();if(!(u=(function(e){return 0===e.toLowerCase().lastIndexOf("https://graph.microsoft.com",0)})(n)?t["@microsoft.graph.downloadUrl"]:t["@content.downloadUrl"]))throw new Error("Unable to obtain download URL.");return[2,{method:"GET",url:u}];case 2:if((a=r.sent())instanceof fn.e){f=Object(fn.t)(a,function(e,t){switch(e){case"unauthenticated":case 401:return an.r.pack({});case"itemNotFound":case 404:return an.a.pack({});case"accessDenied":case 403:return an.e.pack({});default:return an.y.pack({})}});throw new it.e({innerError:a,facets:f})}throw a;case 3:return[2]}})})}})({itemUrl:s,driveUrl:o,endpoint:u})}:void 0}}var rr=Object(Gn.e)(function(){return n.ee(0,4528)},{chunkName:"graphaddondeferred"}),ir=Object(i.t)(function(){return function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var t,n;return Object(r.__generator)(this,function(r){switch(r.label){case 0:e(Object(pn.e)(function(){e(Object(U.t)({keyFacet:X.e,facets:[X.e,q.h,q.v,q.m,se.e,q.O,q.f,H.t,q.M,q.i,q.p,R.n]}));e(Object(U.t)({keyFacet:qe,facets:[qe,H.e,H.r]}));e(Object(U.t)({keyFacet:Ve.e,facets:[Ve.e,q.h,q.v,q.m,q.O,q.i,q.f,H.t,q.M,R.n]}));e(Object(U.t)({keyFacet:o.e,facets:[o.e,H.e]}));e(Object(U.t)({keyFacet:Mt,facets:[Mt,q.h,q.v,q.m,q.O,q.i,q.f,H.t,q.M,R.n]}));e(Object(U.t)({keyFacet:_t,facets:[_t,H.e]}));e(Object(U.t)({keyFacet:Bt.e,facets:[Bt.e,q.h,q.v,q.m,q.O,q.f,H.t,q.M,R.n]}));e(Object(U.t)({keyFacet:Ht.e,facets:[Ht.e,H.e]}));e(Object(U.t)({keyFacet:It.e,facets:[It.e,q.h,q.v,q.m,q.O,q.f,H.t,q.M]}));e(Object(U.t)({keyFacet:gn.e,facets:[mn.e,mn.t,mn.n,mn.r,mn.i,mn.s,mn.o,mn.u,mn.a,mn.f]}));e(Object(U.t)({keyFacet:oe.e,facets:[Me.h]}));e(dn);e(Object(s.r)(X.e,z.e)(Oe));e(Object(s.r)(Kn,z.e)(Qn));e(Object(s.r)(oe.e,z.e)(He));e(Object(s.r)(je,z.e)(Ie));e(Object(s.r)(Vn,z.e)($n));e(Object(s.r)(qe,z.e)(Xe));e(Object(s.r)(Ve.e,z.e)($e));e(Object(s.r)(o.e,z.e)(Ot));e(Object(s.r)(Mt,z.e)(Dt));e(Object(s.r)(_t,z.e)(Pt));e(Object(s.r)(Bt.e,z.e)(jt));e(Object(s.r)(It.e,z.e)(qt));e(Object(s.r)(Ht.e,z.e)(Jt));e(Object(s.r)(Ft.e,z.e)(Yt));e(Object(s.r)(rn.e,z.e)(on));e(Object(U.t)({keyFacet:Qt.e,facets:[q.E]}));e(Object(s.r)(Qt.e,z.e)(nn));e(Object(s.r)(vn.e,z.e)(en.e));e(Object(s.r)(gn.e,z.e)(yn));e(Object(a.e)(X.e,En.e)(wn.t));e(Object(a.e)(ne.e,En.e)(wn.t));e(Yn.e);e(Object(a.e)(Ht.e,Pn.e)(jn));e(Object(a.e)(Ht.e,In.e)(Un));e(Object(a.e)(Ht.e,qn.e)(zn));e(Object(a.e)(X.e,Dn.e)(kn));e(Jn.e);e(Object(a.e)(X.e,Zn.e)(tr))}));return[4,e(Object(u.o)({waitIndefinitely:!0}))];case 1:r.sent();r.label=2;case 2:r.trys.push([2,4,,5]);return[4,rr()];case 3:if(!(t=r.sent().graphAddonDataOnlyDeferred))throw new Error("Couldn't load extended Microsoft Graph features.");e(t);return[3,5];case 4:n=r.sent();e(Object(Xn.e)({error:n}));return[3,5];case 5:return[2]}})})}}),sr=n(1403),or=n(409),ur=n(987),ar=Object(f.t)()(function(){return function(){return function(e,t){var n=t.setItemKey,r=e.demandItemFacet(ne.e,n);if(!n||!r)return{};var i=r.driveItemKey.endpoint,s=X.e.serialize(r.driveItemKey),o=e.demandItemFacet(le.e,s),u=e.demandItemFacet(Le.s,E.e)||Q.t,a=e.demandItemFacet(Le.M,E.e);if(a&&a(i,o)){return{totalItemCount:e.demandItemFacet(fe.e,s),getPageKey:function(e,t){return Kn.serialize({setItemKey:n,endpoint:r.driveItemKey.endpoint,skip:e,top:t-e})},pageSize:u}}return{}}}});var fr=n(498),lr=n(1020),cr=n(189),hr=n(1203),pr=Object(g.i)({key:new Ye.e("dateTakenColumn").id,name:cr.n,fieldName:"",minWidth:g.e.regularMin,maxWidth:g.e.regularMax,isCollapsable:!0,sortProps:g.t},hr.t)(function(e,t){return function(){return{itemKey:t}}},function(e,t){return""+e.demandItemFacet(ae.u,t,{suppressGetItems:!0})}),dr=n(951),vr=n(1064),mr=n(1001),gr=n(318),yr={ODC:"DisableModifiedByColumn"},br=Object(f.t)()(function(){return function(e){return xr}});var wr=[c.e,fr.e,lr.e,dr.e,vr.e],Er=[c.e,fr.e,lr.e,mr.e,dr.e,vr.e],Sr=[c.e,fr.e,lr.e,pr,dr.e,vr.e];function xr(e,t){var n,r,i=t.itemSetKey;if(i){var s=Object(gr.e)(e,{itemKey:i});if("photo"===(null===(r=null===(n=e.demandItemFacet(ie.e,s))||void 0===n?void 0:n.folder)||void 0===r?void 0:r.folderType))return{columns:Sr}}if(Nn.e.isFeatureEnabled(yr)){if((0,e.dispatch)(Object(W.e)({disableModifiedByColumn:Le.r})).disableModifiedByColumn)return{columns:wr}}return{columns:Er}}var Tr=n(717),Nr=Object(i.t)(function(){return function(e){e(Object(a.e)(X.e,Tr.e)(Object(f.n)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(t){switch(t.label){case 0:return[4,e(Object(u.o)())];case 1:t.sent();return[4,n.ee(92,4682)];case 2:return[2,t.sent().driveItemActivityFieldControlHandler]}})})})))}}),Cr=n(331),kr=n(29),Lr=Object(f.t)()(function(){return function(e){return Ar}});function Ar(e,t){return(function(e,t,n){var i,s,o=n.itemSetKey,u=n.handler,a=u.columnKey,f=u.isAscending,l=e.demandItemFacet(t,o);if(!l)return{};var c=X.e.serialize(Object(r.__assign)({},l.driveItemKey)),p=e.demandItemFacet(le.e,c);if(!p||"business"===p||"documentLibrary"===p)return{};if(!l.sortBy)if(ln.e){var d=e.demandItemFacet(H.u,c);if(a===(null===(i=d)||void 0===i?void 0:i.columnKey)&&(null===(s=d)||void 0===s?void 0:s.isAscending)===f)return{newItemSetKey:o}}else if(a===fr.e.key&&!0===f)return{newItemSetKey:o};var v=Object(kr.e)(e,{customColumnKeysToFieldNamesConfiguration:Le.n}).customColumnKeysToFieldNamesConfiguration,m=Object(r.__assign)(Object(r.__assign)({},h.t),v),g=m?m[a]:void 0;if(!g)return{};return{newItemSetKey:t.serialize(Object(r.__assign)(Object(r.__assign)({},l),{sortBy:g,isAscending:f}))}})(e,ne.e,t)}var Or=n(560),Mr=Object(f.t)()(function(){return function(e){return function(e,t){return{isAvailable:!0}}}});var _r=n(2612),Dr=Object(i.i)()(function e(t){var n=this,i=t.itemKey,s=Sn.deserialize(i),o=s.endpoint,u=s.driveId;return function(t){return Object(r.__awaiter)(n,void 0,void 0,function(){var n,s,a,f,l;return Object(r.__generator)(this,function(c){switch(c.label){case 0:n=Object(V.n)({endpoint:o,driveId:u});return[4,t(Object(_r.getSessionToken)(o,n))];case 1:s=c.sent();a=s&&s.accessToken;(f=new Te.e({publisher:e})).resolveItems({items:(l={},l[i]=Object(r.__assign)({},xn.pack(a)),l)});t(f.execute());return[2]}})})}});var Pr,Hr=n(492),Br=n(103),jr=n(32),Fr=n(282),Ir=n(314);(function(e){e.vaultOpen="vaultopen";e.vaultClosed="vaultclosed"})(Pr||(Pr={}));var qr={small:{vaultclosed:"vaultCoverSmallVaultClosed",vaultopen:"vaultCoverSmallVaultOpen"},large:{vaultclosed:"VaultCoverLargeVaultClosed",vaultopen:"VaultCoverLargeVaultOpen"}},Rr=(function(e){Object(r.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e,t=this.props,n=t.vaultCoverSize,i=void 0===n?"large":n,s=t.vaultCoverType,o=void 0===s?"vaultclosed":s,u=(t.ref,t.children,t.isFluent),a=Object(r.__rest)(t,["vaultCoverSize","vaultCoverType","ref","children","isFluent"]),f=qr[i][o];"small"===i?e="vaultCoverIsSmall_0b1cee7d":"large"===i&&(e="vaultCoverIsLarge_0b1cee7d");return L.createElement("div",Object(r.__assign)({},a,{className:"root_0b1cee7d "+e+" "+(u?"isFluent":"")}),L.createElement(O.e,{"aria-hidden":!0,className:"ms-VaultCover cover_0b1cee7d",iconName:f}))};return t})(L.Component);var Ur=Object(f.t)()(function(){return function(e){return function(e,t){var n,i,s,o,u=t.itemKey,a=e.demandItemFacet(ce.e,u);if(a&&a.root){var f=e.demandItemFacet(q.h,u),l=a.isLocked?Pr.vaultClosed:Pr.vaultOpen,c={iconType:Hr.e.Image,ariaLabel:f,imageProps:{src:(n=l,"https://spoprod-a.akamaihd.net/files/fabric-cdn-prod_20201207.001//assets/item-types/"+(i||"20")+(o&&"png"===s?"_2x":"")+"/"+n+"."+(s||"png")),imageFit:Br.t.contain,className:"fileHandlerFileTypeIcon_7f11123a"}};return{iconAs:function(e){return L.createElement(O.e,Object(r.__assign)({},e,c))}}}return{fileTypeIconAs:zr}}}});var zr=Object(jr.t)(function(e,t){var n=t.defaultRender,i=Object(r.__rest)(t,["defaultRender"]),s=i.isFolder,o=i.itemKey,u=i.type,a=u;if(s&&void 0===u){var f=e.demandItemFacet(ve.e,o);void 0!==f&&("desktop"===f?a=Fr.e.desktopFolder:"documents"===f?a=Fr.e.documentsFolder:"pictures"===f&&(a=Fr.e.picturesFolder))}return n?L.createElement(n,Object(r.__assign)({},i,{type:a})):null}),Wr=n(550),Xr=n(2549),Vr=n(217),$r=n(173);(function(e,t){void 0===e&&(e="https://spoprod-a.akamaihd.net/files/fabric/office-ui-fabric-react-assets/foldericons");Object(Ir.n)({fontFace:{},style:{width:78,height:58,overflow:"hidden"},icons:{vaultCoverSmallVaultClosed:L.createElement("img",{src:e+"/vault-sm.svg"}),vaultCoverSmallVaultOpen:L.createElement("img",{src:e+"/vault-sm-open.svg"})}},t);Object(Ir.n)({fontFace:{},style:{width:118,height:86,overflow:"hidden"},icons:{VaultCoverLargeVaultClosed:L.createElement("img",{src:e+"/vault-lg.svg"}),VaultCoverLargeVaultOpen:L.createElement("img",{src:e+"/vault-lg-open.svg"})}},t)})("https://spoprod-a.akamaihd.net/files/fabric/office-ui-fabric-react-assets/foldericons",{disableWarnings:!0});var Jr=Object(f.t)()(function(){return function(e){return function(e,t){var n=t.itemKey,i=e.demandItemFacet(ce.e,n);return Object(r.__assign)(Object(r.__assign)({},i&&i.root?{tileAs:Qr}:{}),{folderCoverControlHandler:function(t,n){var r=n.signalData;if(r&&r.signal)return{};var i=e.demandItem({specialFolder:ve.e},n.itemKey).specialFolder;if(!i)return{};var s=(function(e){var t=null;"desktop"===e?t=L.createElement(Vr.n,null):"documents"===e?t=L.createElement(Vr.r,null):"pictures"===e&&(t=L.createElement(Vr.c,null));return{signal:t,key:e||""}})(i);return s&&s.signal?{signalData:s}:{}}})}}});var Kr=Object(jr.t)(function(e,t){var n=t.itemKey,i=Object(r.__rest)(t,["itemKey"]),s=e.demandItemFacet(ce.e,n),o=s&&s.isLocked?Pr.vaultClosed:Pr.vaultOpen;return L.createElement(Rr,Object(r.__assign)({},i,{vaultCoverSize:i.folderCoverSize,vaultCoverType:o}))}),Qr=Object(jr.t)(function(e,t){var n=t.defaultRender,i=t.foreground,s=Object(r.__rest)(t,["defaultRender","foreground"]),o=t.itemKey,u=i,a=e.demandItemFacet(ce.e,o);a&&a.root&&(u=Object($r.r)(e,L.createElement(Kr,Object(r.__assign)({},s,{folderCoverSize:s.tileSize,itemKey:o}))));return n?L.createElement(n,Object(r.__assign)({},s,{foreground:u})):null}),Gr=n(679),Yr=n(72),Zr=n(1154),ei=n(311),ti=n(13),ni=n(1595),ri=n(22),ii=n(27),si=n(21),oi=new si.e("openInOfficeOnlineActionControl"),ui=Object(jr.e)(function(e,t){var n=t.itemKey,i=e.demandItem({openUrl:q.O,appFacet:he.e,isMalwareDetected:q.k},n),s=i.openUrl,o=i.appFacet,u=i.isMalwareDetected,a=e.dispatch,f=!u&&!!o&&!!s,l=e.demandItemFacet(oi,n);return Object(r.__assign)({isAvailable:f,onExecute:s?function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var e,t;return Object(r.__generator)(this,function(r){e=(new Date).getTime().toString();t=ni.e.AddWopiPerfMarkToTargetUrl(e,"ItemsView",s);a(Object(Ge.e)(function(e){return oi.evaluate(l)(e,{itemKey:n,forceInSameWindow:!1})})).forceInSameWindow?window.location.href=t:window.open(t);return[2]})})}:void 0},Object(ii.t)(e,{itemKey:n,engagement:{name:"OpenInOfficeOnline",isIntentional:!0}}))})(ri.e),ai=Object(ti.s)()(Object(ti.r)()(ui)),fi={key:new Ye.e("openInOfficeOnline").id,automationId:"openInOfficeOnlineCommand",action:L.createElement(ai,null),facets:Object(r.__assign)({},Yr.t.pack(!0))},li=n(88),ci=n(1401),hi=new si.e("openInOfficeClientActionControl"),pi=new li.e,di=function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){return[2]})})},vi=Object(jr.e)(function(e,t){var n=t.itemKey,i=e.demandItem({key:X.e,appMap:he.e,fileName:q.d,openUrl:q.O,canonicalUrl:q.i,isMalwareDetected:q.k},n),s=i.key,o=i.appMap,u=i.fileName,a=i.openUrl,f=i.canonicalUrl,l=i.isMalwareDetected,c=!1,h=di,p=Object(er.s)(e,{itemKey:n,oneOfRequiredRoles:["write","owner"]});if(n){var d=!l&&!!o&&!!a&&(pi.isMac||pi.isWindows||pi.isIOS||pi.isWinPhone||pi.isAndroid),v=e.demandItemFacet(hi,n),m=hi.evaluate(v)(e,{itemKey:n,isAvailable:d,protocolCallback:gi}),g=m.protocolCallback,y=m.isAvailable;c=d&&y;s&&c&&(h=(function(e){var t=this,n=e.key,i=e.openUrl,s=e.canonicalUrl,o=e.canEdit,u=e.appMap,a=e.fileName,f=e.isNew,l=e.defaultLocation,c=e.protocolCallback;return function(){return Object(r.__awaiter)(t,void 0,void 0,function(){var e,t;return Object(r.__generator)(this,function(r){if(!n)return[2];e=!!o;t=function(){i&&window.open(i)};Object(ci.e)({app:u||"",itemUrl:s||"",extension:a&&a.extension||"",shouldEdit:e,isNew:Boolean(f),defaultLocation:l||"",platformDetection:pi,onNavigate:c,onFailureCallback:t});return[2]})})}})({key:s,openUrl:a,canonicalUrl:f,canEdit:p,appMap:o,fileName:u,protocolCallback:g}))}return Object(r.__assign)({isAvailable:c,onExecute:h},Object(ii.t)(e,{itemKey:n,engagement:{name:"OpenInOfficeClient",isIntentional:!0}}))})(ri.e),mi=Object(ti.s)()(Object(ti.r)()(vi));function gi(e){window.location.href=e}var yi={key:new Ye.e("openInOfficeClient").id,automationId:"openInOfficeClientCommand",action:L.createElement(mi,null),facets:Object(r.__assign)({},Yr.t.pack(!0))},bi=new Ye.e("fileHandlerOpenCommand").id,wi=(Object(ti.s)()(Object(ti.r)()(Object(jr.e)(function(e,t){var n=t.itemKey,r=t.item,i=e.demandItem({appMap:he.e},n).appMap,s=r.name;r.key===fi.key?s=s||(i?Object(ei.s)(i,!1):ei.e.OpenInBrowser):r.key===yi.key&&(s=s||(i?Object(ei.o)(i,!0):ei.e.Open));return{name:s}})(function(e){return L.createElement("div",{className:"contextualMenuItemLinkContent_e78d58c6"},L.createElement("span",{dir:"auto",className:"contextualMenuItemTextLabel_e78d58c6"},e.name))}))),Object(ti.s)()(Object(ti.r)()(Object(jr.e)(function(e,t){var n=t.itemKey,i=t.menuProps,s=e.demandItem({appMap:he.e,fileName:q.d},n),o=s.appMap,u=s.fileName,a={};if(i&&i.items){var f=i.items[0];f&&-1!==f.key.indexOf(bi)&&f.iconProps&&(a=f.iconProps)}var l=!!u&&!!u.extension&&".pdf"===u.extension.toLowerCase(),c=o&&Object(ei.n)(o),h={iconName:o?Object(ei.t)(o):l?"PDF":"OpenFile"},p=void 0;i&&i.items&&(p=i.items.map(function(e){return e.key===fi.key?Object(r.__assign)(Object(r.__assign)({},e),{iconProps:h,name:e.name||o&&Object(ei.s)(o,!0)||(l?ei.e.OpenInBrowser:ei.e.Open),onRenderIcon:c?Ei.bind(void 0,c,!0):void 0}):e.key===yi.key?Object(r.__assign)(Object(r.__assign)({},e),{iconProps:h,name:e.name||o&&Object(ei.i)(o),onRenderIcon:c?Ei.bind(void 0,c,!0):void 0}):e}));return{iconProps:a||h,onRenderIcon:c?Ei.bind(void 0,c,!1):void 0,text:ei.e.Open,menuProps:p?Object(r.__assign)(Object(r.__assign)({},i),{items:p}):i}})(Zr.e))));function Ei(e,t){return e?L.createElement("span",{className:t?"menuItemIconContainer_e78d58c6":"iconContainer_e78d58c6"},L.createElement(O.e,{iconName:e.logoFill16,className:"logoFillIcon_e78d58c6"}),L.createElement(O.e,{iconName:e.logo16,className:"logoIcon_e78d58c6"})):null}var Si={key:Gr.e.key,automationId:Gr.e.automationId,subMenuProps:{items:[fi,yi]},onRender:function(e){return L.createElement(wi,Object(r.__assign)({},e,{menuProps:e.subMenuProps}))},facets:Object(r.__assign)({},Yr.t.pack(!0))},xi=(Gr.e.key,Gr.e.automationId,Gr.e.name,Object(r.__assign)({},Yr.t.pack(!0)),Object(f.t)()(function(){return function(e){return function(e,t){var n=t.commands,i=t.overflowCommands,s=t.farCommands,o=i?Object(r.__spreadArrays)(i):[],u=n?Object(r.__spreadArrays)(n):[],a=s;return{commands:u=Ti(e,{defaultCommands:u}).overrideDefaultCommands,overflowCommands:o,farCommands:a}}}}));function Ti(e,t){for(var n=[],r=0,i=t.defaultCommands;r<i.length;r++){var s=i[r];s.key===Gr.e.key?n.push(Si):n.push(s)}return{overrideDefaultCommands:n}}var Ni=n(370),Ci=n(544),ki=n(1400),Li=n(20),Ai=n(509),Oi={key:new Ye.e("openInOfficeOnlineDefaultClickHandler").id,evaluate:function(e,t){var n=t.itemKey,r=e.demandItem({openUrl:q.O,appMap:he.e},n),i=r.openUrl,s=r.appMap;return{action:!!i&&!!s?L.createElement(Ai.e,{itemKey:n,action:Object(Li.i)(e,L.createElement(ui,{itemKey:n}))}):void 0}}},Mi={key:new Ye.e("openInOfficeClientDefaultClickHandler").id,evaluate:function(e,t){var n=t.itemKey,r=e.demandItem({openUrl:q.O,appMap:he.e},n),i=r.openUrl,s=r.appMap;return{action:!!i&&!!s?L.createElement(Ai.e,{itemKey:n,action:Object(Li.i)(e,L.createElement(vi,{itemKey:n}))}):void 0}}},_i=Object(f.t)()(function(){return function(e){return function(e,t){var n=t.handlers,i=void 0===n?[]:n;return{handlers:Object(r.__spreadArrays)([ki.e,Oi,Mi],i)}}}});var Di=n(652),Pi=n(345),Hi=Object(g.i)({key:new Ye.e("dateAccessedColumn").id,name:cr.e,fieldName:"",minWidth:g.e.regularMin,maxWidth:g.e.regularMax,isCollapsable:!0},b.e)(function(e,t){var n=e.demandItemFacet(q.o,t,{suppressGetItems:!0}),r=n&&new Date(n).getTime();if("number"!=typeof r||isNaN(r))return{text:""};var i=e.demandItemFacet(w.N,E.e),s=i&&i.language||window.navigator.language;return s?{text:Object(Pi.n)(new Date(r),s)}:{dateValue:r}},function(e,t){return""+e.demandItemFacet(q.o,t)}),Bi=Object(f.t)()(function(){return function(e){return Fi}});var ji=[p,d.e,Hi];function Fi(e,t){return{columns:ji}}var Ii=n(274),qi=n(598),Ri=Object(ti.s)()(Object(ti.r)()(Object(jr.t)(function(e,t){var n=t.itemKey,r=e.demandItemFacet(q.M,n);return r?L.createElement(qi.e,{itemKey:r.itemKey}):null}))),Ui=n(376),zi={key:"OpenFileLocation",name:Ui.i,title:Ui.i,action:Ri,iconProps:{iconName:"FabricFolder"}},Wi=Object(f.t)()(function(){return function(e){return Vi}});var Xi=[Gr.e,zi,Ii.n,Ii.t];function Vi(e,t){return{commands:Ti(0,{defaultCommands:Xi}).overrideDefaultCommands}}var $i=n(243),Ji=Object(f.t)()(function(){return function(e){return Gi}});var Ki={name:"-",key:"divider_1",itemType:$i.e.Divider},Qi=[Gr.e,zi,Ki,Ii.n,Ii.t];function Gi(e,t){return{commands:Qi}}var Yi=n(781),Zi=Object(f.t)()(function(){return function(e){return function(e,t){return{isAvailable:!1}}}});var es=n(453),ts=n(42),ns=Object(f.t)()(function(){return function(e){return function(e,t){var n=t.itemsScopeItemKey,i=t.engagement,s=i&&i.name;return{engagement:{datasource:"Recent",extraData:Object(r.__assign)({},"ItemsView.Load"===s?rs(e,{itemsScopeItemKey:n}):{})}}}}});function rs(e,t){var n=t.itemsScopeItemKey,i=Object(ts.e)(e,n),s=e.demandItemFacet(Ze,i);return Object(r.__assign)({},s)}var is=Object(i.t)(function(){return function(e){e(Object(a.e)(Bt.e,es.e)(ns))}}),ss=n(723),os=n(545),us=Object(f.t)()(function(){return function(){return as}});function as(e,t){var n,i=t.layouts,s=e.demandItemFacet(fe.u,t.itemKey);if(i){n=[];for(var o=0,u=i;o<u.length;o++){var a=u[o];a.layoutType!==ss.t.layoutType?a.layoutType!==ss.e.layoutType?a.layoutType!==os.t.layoutType?n.push(a):n.push(os.t):n.push(ss.e):n.push(ss.t)}}return Object(r.__assign)(Object(r.__assign)({},n?{layouts:n}:{}),s?{defaultLayout:os.t.layoutType,isLayoutResolved:!0}:{})}var fs=Object(i.t)(function(){return function(e){e(Object(a.e)(Ht.e,l.e)(Bi));e(Object(a.e)(Bt.e,Ni.e)(Wi));e(Object(a.e)(Bt.e,Yi.e)(Ji));e(Object(a.e)(zt,En.e)(Zi));e(Object(a.e)(Ht.e,qn.e)(us));e(is)}}),ls=n(1139),cs=Object(g.i)({key:new Ye.e("dateFollowedColumn").id,name:cr.c,fieldName:"",minWidth:g.e.regularMin,maxWidth:g.e.regularMax,isCollapsable:!0},b.e)(function(e,t){var n=e.demandItemFacet(q.a,t),r=n&&new Date(n).getTime();if("number"!=typeof r||isNaN(r))return{text:""};var i=e.demandItemFacet(w.N,E.e),s=i&&i.language||window.navigator.language;return s?{text:Object(Pi.n)(new Date(r),s)}:{dateValue:r}},function(e,t){return""+e.demandItemFacet(q.a,t)}),hs=n(1345),ps=Object(f.t)()(function(){return function(e){return vs}});var ds=[p,d.e,cs,hs.e];function vs(e,t){return{columns:ds}}var ms=n(322),gs=(function(e){Object(r.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){return this.props.group?L.createElement("div",{className:"root_de13c386"},this.props.group.name):null};return t})(L.PureComponent),ys=n(1663),bs=n(4302),ws=n(617),Es=n(419),Ss=n(796);function xs(e,t){var n=t.signals;if(n){var i=Object(Es.t)(n,function(e){return e.key===Ss.n});if(i&&i.index>-1){var s=i.index;return{signals:Object(r.__spreadArrays)(n.slice(0,s),n.slice(s+1))}}}return{}}var Ts=Object(f.t)()(function(){return function(e){return Cs}});var Ns=function(e){var t=e.defaultRender,n=Object(r.__assign)({},ws.e.pack(xs));return t?L.createElement(bs.e,{controlHandlers:n},L.createElement(t,Object(r.__assign)({},e))):null};function Cs(){return{groupHeaderRenderer:gs,rowRenderer:Ns,groupProps:{collapseAllVisibility:ys.e.hidden}}}var ks=Object(f.t)()(function(){return function(e){return Os}});function Ls(e,t){var n=t.itemKey,r=e.demandItemFacet(q.a,n,{suppressGetItems:!0}),i=r&&new Date(r).getTime();if("number"==typeof i&&!isNaN(i)){var s=e.demandItemFacet(w.N,E.e),o=s&&s.language||window.navigator.language,u=Object(Pi.n)(new Date(i),o);return{itemActivity:u&&L.createElement(b.e,{text:u})||null}}return{}}var As=(function(e){Object(r.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props,t=e.defaultRender,n=Object(r.__rest)(e,["defaultRender"]),i=Object(r.__assign)(Object(r.__assign)({},ws.e.pack(xs)),Xr.e.pack(Ls));return t?L.createElement(bs.e,{controlHandlers:i},L.createElement(t,Object(r.__assign)({},n))):null};return t})(L.PureComponent);function Os(){return{tileRenderer:As}}var Ms=n(410),_s=n(4303),Ds=Object(f.t)()(function(){return function(e){return function(e,t){return{emptyFolderIconUrl:"https://static2.sharepointonline.com/files/fabric/onedrive-assets/images/empty_state_sfl.svg",emptyFolderTitle:_s.e}}}});var Ps=Object(i.t)(function(){return function(e){e(Object(a.e)(Ft.e,ms.e)(Ts));e(Object(a.e)(Ft.e,ls.e)(ks));e(Object(a.e)(Ft.e,l.e)(ps));e(Object(a.e)(Ft.e,Ms.e)(Ds));e(Object(a.e)(It.e,Ni.e)(xi))}}),Hs=n(1434),Bs=n(646),js=n(194),Fs=n(764),Is=function(e,t){return n=e,Object(r.__assign)(((i={version:2})[0]="",i[1]="",i[3]="",i[6]="",i[16]="",i),n);var n,i},qs=function(e,t){var n=t.queryType,r=t.layoutType,i=r&&(function(e){return e===js.e?Fs.e:e===Rn.e?Fs.n:Fs.t})(r),s=Is(e);"number"==typeof n&&i&&(s[n]=i);return s},Rs=n(96),Us=n(1774),zs=Object(Rs.t)(function(e){e.itemsScopeItemKey;var t=e.localStorageKey,n=Object(r.__rest)(e,["itemsScopeItemKey","localStorageKey"]);return function(e){var i,s=e(Object(Ge.e)(function(e){return Object(Us.e)(e,{name:t})}))||{},o=s&&qs(s,Object(r.__assign)({},n));e(Object(Us.n)({values:(i={},i[t]=o,i)}))}}),Ws=Object(f.t)()(function(){return function(){return Vs}}),Xs=new G.e("itemsScopeList",{driveId:Object(G.s)(),itemsScopeItemKey:Object(G.s)()});function Vs(e,t){var n=Object(kr.e)(e,{isLayoutResolvedEnabled:w.T,isLocalStorageForLayoutEnabled:Le.T}),i=n.isLayoutResolvedEnabled,s=n.isLocalStorageForLayoutEnabled;if(!i||!s)return{};var o,u,a,f,l=t.itemsScopeItemKey,c=Object(ts.e)(e),h=e.demandItemFacet(ne.e,c),p=void 0;if(c&&h&&l){var d=h.driveItemKey;if(d){var v=d.endpoint,m=d.driveId;if(!m||!v)return{};var g,y,b=Xs.serialize({driveId:m,itemsScopeItemKey:l}),S=e.demandItemFacet(Le.g,E.e),x=S&&S(e,{itemSetKey:c}),T=x&&x.queryType||0;g="ItemsStore"+(o={endpoint:v,driveId:m,queryType:T},u=o.endpoint,a=o.driveId,f="Graph.Files.FilesQueryType."+u,f=a?f+"."+a:f).toLocaleLowerCase();var N=Object(Us.e)(e,{name:g});p=Object(Us.t)(e,{name:g});var C=N&&N[T]||"";y=p?(function(e){switch(e){case Fs.t:return js.t;case Fs.e:return js.e;default:return Rn.e}})(C):void 0;var k=e.demandItemFacet(kt.l,b);return{preferredLayoutType:e.demandItemFacet(kt.f,b)||y,preferredLayoutVersion:k,setPreferredLayout:function(e){var t=e.layoutType;return function(n){g&&m&&v&&n(zs({endpoint:v,driveId:m,itemsScopeItemKey:l,queryType:T,localStorageKey:g,layoutType:t}));n(Object(pn.e)(function(){var t,i;n(Object(U.e)({items:(t={},t[b]=Object(r.__assign)({},kt.f.pack(e.layoutType)),t)}));n(Object(U.e)({items:(i={},i[b]=Object(r.__assign)({},kt.l.pack((k||0)+1)),i)}))}))}}}}}return{}}var $s=n(1033),Js=new Ye.e("itemRestrictedSignal").id,Ks=Object(f.t)()(function(){return function(e){return function(e,t){var n=t.itemKey;if(e.demandItemFacet(xe.e,n)&&n){var i=Object(r.__spreadArrays)(t.signals||[]);i.push(Qs);return{signals:i}}return{}}}});var Qs={signal:L.createElement(Vr.t,null),title:ue.e,key:Js},Gs=Object(Gn.e)(function(){return n.ee(0,4851)},{chunkName:"graphaddondeferred"}),Ys=Object(i.t)(function(){return function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var t,i;return Object(r.__generator)(this,function(c){switch(c.label){case 0:e(Object(pn.e)(function(){e(ir);e(Object(a.e)(ne.e,l.e)(br));e(Object(a.e)(ne.e,$s.e)(Object(f.n)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(t){switch(t.label){case 0:return[4,e(Object(u.o)())];case 1:t.sent();return[4,n.ee([8],4707)];case 2:return[2,t.sent().driveItemSortActionControlHandler]}})})})));e(Object(a.e)(ne.e,Cr.e)(Lr));e(Object(a.e)(o.e,l.e)(j));e(Object(a.e)(X.e,ws.e)(Ks));e(Object(a.e)(X.e,or.e)(sr.e));e(Object(a.e)(ne.e,ur.e)(ar));e(Object(a.e)(X.e,Or.e)(Mr));e(Object(s.r)(Sn,z.e)(Dr));e(Object(a.e)(X.e,Wr.e)(Ur));e(Object(a.e)(je,Wr.e)(Ur));e(Object(a.e)(X.e,Xr.e)(Jr));e(Object(a.e)(je,Xr.e)(Jr));e(Object(a.e)(X.e,Ci.e)(_i));e(Object(a.e)(Bt.e,Ni.e)(xi));e(Object(a.e)(X.e,Di.e)(Hs.e));e(Object(a.e)(ne.e,Bs.e)(Ws));e(Nr);e(fs);e(Ps)}));return[4,e(Object(u.o)({waitIndefinitely:!0}))];case 1:c.sent();c.label=2;case 2:c.trys.push([2,4,,5]);return[4,Gs()];case 3:if(!(t=c.sent().graphAddonDeferred))throw new Error("Couldn't load extended Microsoft Graph features.");e(t);return[3,5];case 4:i=c.sent();e(Object(Xn.e)({error:i}));return[3,5];case 5:return[2]}})})}})},,,,,,,,function(e,t,n){"use strict";n.r(t);n.d(t,"spProjectedUploadedItemSetAddon",function(){return Xn.spProjectedUploadedItemSetAddon});n.d(t,"SpAddonDeferred",function(){return or});var r=n(0),i=n(16),s=n(246),o=n(386),u=n(446),a=new(n(21).e)("itemsBreadcrumbControl"),f=n(437),l=n(370),c=n(781),h=n(43),p=n(851),d=n(1048),v=n(1376),m=n(1266),g=n(90),y=n(78),b=n(997),w=n(1346),E=n(998),S=n(4529),x=n(333),T=n(1041),N=n(1),C=n(1207),k=n(276),L=n(1556),A=n(1542),O=n(1024),M=n(859),_=n(14),D=n(1420),P=n(160),H=n(218),B=n(1055),j=n(1395),F=n(451),I=n(56),q=n(12),R=n(67),U=n(1227),z=n(493),W=n(551),X=n(274),V=n(565),$=n(268),J=n(46),K=n(1418),Q=n(109),G=n(29),Y={ODB:1544},Z=Object(_.t)()(function(){return function(e){return function(t,n){var i,s=n.itemKey,o=n.commands,u=t.demandItemFacet(h.e,s);if(u){var a=g.e.serialize(u);i=t.demandItemFacet(N.Ue,a)}var f=o?Object(r.__spreadArrays)(o):[];f.push(O.t,O.e);var l=void 0;if(u){var c=u.listFullUrl,p=u.webAbsoluteUrl,d=Object(M.i)({listFacets:i}),v=t.demandItemFacet(N.ln,x.e.serialize({webAbsoluteUrl:p,listFullUrl:c}));if(i&&!i.isDocumentLibrary){f=[C.n];for(var m=0,y=Object(C.t)(v);m<y.length;m++){var b=y[m];b.key===X.n.key&&Object(I.e)(t,{feature:Y,pageContext:v})?f.push(X.e):b.key!==k.e.key&&f.push(b)}}f.push(d);var w=T.e.serialize({webAbsoluteUrl:p,listFullUrl:c}),E=Object(D.e)({itemCache:t,targetCustomActionSetKey:w,keys:{webAbsoluteUrl:p,listFullUrl:c}}),S=t.demandItemFacet(N.pe,s);f=f.concat(Object(D.n)(t,w,S));E&&(f=f.concat(Object(D.n)(t,E,S)));if(v&&i&&(i.templateType===q.t.documentLibrary||i.templateType===q.t.mySiteDocumentLibrary)){var L=new P.e(p||c).authority+"/_api/v2.0",A=H.t.serialize({endpoint:L});l=Object(F.e)(t,{itemKey:A})}}var _=!R.t.isActivated(U.e,"7/5/2019","Show file handler commands before OOB commands"),B=!!Object(G.e)(t,{enableUniversalPrint:Q.h}).enableUniversalPrint;return{commands:ee(f,l,i&&i.templateType===q.t.mySiteDocumentLibrary,_,B),onMenuOpened:function(){e(function(e){var t=(e(Object($.e)({spLoggerConfiguration:J.o})).spLoggerConfiguration||{}).scenarioId,n=void 0===t?"":t;e(V.t(n))})}}}}});function ee(e,t,n,r,i){for(var s=[],o=0,u=e;o<u.length;o++){var a=u[o],f=a.key;if(f===L.e.key){var l=t&&t.open||[];l.length>0&&A.t.subMenuProps&&(A.t.subMenuProps.items=Object(F.t)(A.t.subMenuProps.items,l,r));s.push(A.t)}else{s.push(a);if(f===z.e.key)s.push(j.e);else if(f===W.e.key){s.push(B.e);i&&n&&s.push(K.e)}}}return t&&t.custom&&t.custom.length>0?Object(F.t)(s,t.custom):s}var te=n(42),ne=n(10),re=n(96),ie=n(143),se=n(629),oe=Object(_.t)()(function(){return function(e){return function(e,t){var n=Object(te.e)(e),i=(function e(t,n,i){var s=n,o=i;if(n&&i){var u=t.demandItem({spGroupField:N.Yt,groupValue:N.Se,parentGroupKey:N.ct,groupFilterByValue:N.ye,groupValueDisplayValue:N.Ee},n),a=u.spGroupField,f=u.groupValue,l=u.parentGroupKey,c=u.groupFilterByValue,h=u.groupValueDisplayValue;l&&(o=e(t,l.itemKey,i));var d=t.demandItemFacet(y.e,o);if(d){var v=t.demandItemFacet(p.e,n),m=Object(se.e)(Object(r.__assign)(Object(r.__assign)({},d),v?{viewKey:v.viewKey}:{})),g=c||f;if(void 0!==g&&a&&a.internalName&&a.fieldType){var b=!R.t.isActivated("b53559e1-298d-4488-a512-60e0d8b8b827","09/15/2020","Include fitler displays for group that has raw value for filterByValue")&&"DateTime"===a.fieldType,w=!R.t.isActivated("e278b853-095c-41f6-a0b9-8ad603442ce7","2/22/2021","Use group display value as the filterDisplays");s=m({filterField:a.internalName,filterValues:[g],filterDisplays:w&&!!h&&[h]||b&&[f||g]||[],filterType:a.fieldType,useLookupId:!1})}}}return s})(e,t.itemKey,n),s=e.demandItem({parentItem:ne.s},n).parentItem,o=(function(e){var t=this,n=e.stageItem,i=e.parentItemKey;return n?Object(re.t)(function(e){var s=e.itemsScopeItemKey,o=e.currentItemKey;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t;return Object(r.__generator)(this,function(u){switch(u.label){case 0:i&&e(Object(ie.e)({items:(t={},t[o]=Object(r.__assign)({},ne.s.pack({itemKey:i})),t)}));return[4,e(n({currentItemKey:o,itemsScopeItemKey:s}))];case 1:u.sent();return[2]}})})}}):void 0})({parentItemKey:s&&s.itemKey,stageItem:t.stageItem});return i?Object(r.__assign)({itemKey:i},o?{stageItem:o}:{}):{}}}});var ue=n(655),ae=n(135),fe=n(131),le=new ae.e("siteTargetDocumentLibraryItem",function(e,t){var n=t.itemKey,r=e.demandItemFacet(ne.t,n),i=r&&r.itemKey,s=e.demandItemFacet(ne.e,i),o=s&&s.itemKeys;if(o&&1===o.length)return{itemKey:o[0]};if(o&&Object(I.e)(e,{feature:{ODB:60127}})){if(Object(G.e)(e,{enableLibrariesDropdown:N.F}).enableLibrariesDropdown)for(var u=0,a=o;u<a.length;u++){var f=a[u];if(e.demandItemFacet(N.Le,f))return{itemKey:f}}}}),ce=Object(_.t)()(function(){var e=this;return function(){return function(t,i){var s,o=i.itemKey,u=i.stageItem,a=Object(fe.e)(t),f=Object(te.e)(t),l=t.demandItemFacet(b.e,o);if(l){var c=t.demandItemFacet(h.e,a),p=t.demandItemFacet(ue.e,f);c?l.webAbsoluteUrl===c.webAbsoluteUrl&&(s={isToggled:!0}):p&&l.webAbsoluteUrl===p.webAbsoluteUrl&&(s={isToggled:!0})}var d=t.demandItemFacet(le,o,{suppressGetItems:!0});return Object(r.__assign)(Object(r.__assign)({},s||{}),d?{itemKey:d.itemKey}:{stageItem:function(t){return function(i){return Object(r.__awaiter)(e,void 0,void 0,function(){var e,s,o,a,f,l;return Object(r.__generator)(this,function(c){switch(c.label){case 0:o=[Object(r.__assign)({},t)];return(a=u)?[4,i(u(t))]:[3,2];case 1:a=c.sent();c.label=2;case 2:e=r.__assign.apply(void 0,o.concat([a||{}])).currentItemKey,s=void 0===e?t.currentItemKey:e;return[4,n.ee(9,1610)];case 3:f=c.sent().demandItems;return[4,i(f(function(e){return e.demandItemFacet(le,s)}))];case 4:return(l=c.sent())?[2,{currentItemKey:l.itemKey}]:[2]}})})}}})}}});var he=n(180),pe=n(1053),de=n(196),ve=n(6),me=Object(_.t)()(function(){return function(e){return function(e,t){var n=t.createOpenItem,r=t.rootItemKey,i=t.itemKey,s=Object(te.e)(e),o=void 0;if(r){var u=e.demandItemFacet(h.e,r);u&&(o=h.e.serialize(u))}return{getBreadcrumbItems:function(){var t=[],u={},a=e.demandItemFacet(y.e,s),f=a&&a.filterParams,l=e.demandItemFacet(N.$t,s),c=l&&l.filterList;!l&&f&&(c=he.default.getFilterList(f,void 0,!0));if(c&&c.length&&f)for(var h=c.length-1;h>=0;h--){var p=c[h],d=(p.displays&&p.displays.length?p.displays:p.values).map(function(e){return e||de.EmptyFilterOptionLabel}),v=he.default.formatBreadcrumbFilterValues(d,p.type||"",{booleanFalse:de.booleanFalse,booleanTrue:de.booleanTrue}),m=ge(f,c,h+1),g=(b=Object(pe.e)(e,{folderItemKey:i,currentItemSetKey:s,newFilterParams:m}))?y.e.serialize(b):i;t.unshift({key:p.fieldName,text:v,onClick:n&&g?n(g):void 0})}for(;i&&!u[i];){u[i]=!0;var b,w=e.demandItem({displayName:ve.h,parentFolder:ve.M},i),E=w.displayName,S=w.parentFolder;g=(b=Object(pe.e)(e,{folderItemKey:i,currentItemSetKey:s,newFilterParams:""}))?y.e.serialize(b):i;t.unshift({key:i,text:E||"",onClick:n&&g?n(g):void 0});if(r&&(r===i||o===i))break;i=S&&S.itemKey||""}return t}}}}});function ge(e,t,n){for(var r=n=n||0;r<t.length;r++){var i=t[r];e=he.default.addFilterInfo(e,i.fieldName,"",!0)}return e}var ye=n(30),be=n(55),we=Object(_.t)()(function(){return function(e){return function(e,t){var n=t.itemKey,r=e.demandItem({key:p.e,isDropEnabled:be.i},n),i=r.key,s=r.isDropEnabled,o=i&&i.itemSetKey&&h.e.serialize(i.itemSetKey),u=o&&e.demandItemFacet(N.ht,o),a=ye.e.hasItemPermission({permissions:u},ye.e.insertListItems);if(a){var f=i&&i.itemSetKey&&e.demandItemFacet(N.Ue,g.e.serialize({webAbsoluteUrl:i.itemSetKey.webAbsoluteUrl,listFullUrl:i.itemSetKey.listFullUrl}));a=!!s&&!!f&&!!f.isDocumentLibrary&&f.templateType!==q.t.webPageLibrary}return{isAvailable:a}}}});var Ee=n(724),Se=n("react-lib"),xe=n(999),Te=n(1406),Ne=n(122),Ce=Object(i.i)()(function(e){var t=this,n=e.itemKey,i=v.e.deserialize(n);return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,s,o,u;return Object(r.__generator)(this,function(a){t=e(Object(Ne.e)({listFacets:N.Ue},g.e.serialize(i.listKey))).listFacets;s=xe.e.serialize({listKey:{webAbsoluteUrl:i.listKey.webAbsoluteUrl,listFullUrl:i.listKey.listFullUrl},contentTypeId:i.contentTypeId});o=!!t&&t.openInClient;e(Object(ie.e)({items:(u={},u[n]=Object(r.__assign)({},N.t.pack(function(){return Se.createElement(Te.e,{contentTypeId:i.contentTypeId,openInClient:o,contentTypeKey:s})})),u)}));return[2]})})}});var ke=n(307),Le=n(231),Ae=n(2370),Oe=n(200),Me=Object(i.i)()(function(e){var t=this,n=m.e.deserialize(e.itemKey),i=n.webAbsoluteUrl,s=n.listFullUrl;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,o,u,a,f,l;return Object(r.__generator)(this,function(c){t=n(Object(Ne.e)({pageContext:N.ln},x.e.serialize({webAbsoluteUrl:i,listFullUrl:s}))).pageContext;o=n(Object(Le.n)({webAbsoluteUrl:i,listFullUrl:s})).hasTokenProvider;if(t){u=o?void 0:function(e){return n(Object(Le.e)({url:e}))};a=new Ae.e({},{pageContext:t,getAuthToken:u});(f=new Oe.e).resolveItems({items:(l={},l[e.itemKey]=Object(r.__assign)({},N.pn.pack(a)),l)});n(f.execute())}return[2]})})}});var _e=n(3901),De=n(3909),Pe=n(1054),He=n(3355),Be=n(490),je=n(1169),Fe=Object(_.t)()(function(){return function(e){return function(e,t){var n=t.itemKey,r=e.demandItemFacet(N.et,n,{suppressGetItems:!0}),i=e.demandItemFacet(je.e,n);return{isAvailable:!(e.demandItemFacet(Be.t,n)||!r&&!i)}}}});var Ie=Object(i.t)(function(){return function(e){e(Object(o.e)(h.e,Pe.e)(Fe));e(Object(s.r)(h.e,He.t)(Object(i.r)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([60],4711)];case 1:return[2,e.sent().removeFromOneDriveOperationHandler]}})})})))}}),qe=n(1005),Re=n(32),Ue=n(140),ze=n(371),We=n(3036),Xe=n(4302),Ve=n(2549),$e=n(786),Je=n(40),Ke=n(761),Qe=n(112),Ge=n(812),Ye=n(1623),Ze=n(321),et=n(84),tt=n(44),nt=n(4307),rt=n(132),it=n(3002);function st(e,t){return{enableItemHoverCard:!1}}var ot=Object(Re.e)(function(e,t){var n=at(e,t.itemSetKey),r=n.viewFormatter,i=n.isGenerated,s=n.isTileDesignerTemplateApplied,o=n.qosEndPayload;return{customFormatterFeature:r&&e.demandItemFacet(Ue.n,Ue.t.serialize({})),viewFormatter:r,isGenerated:i,qosEndPayload:o,telemetry:Object(rt.n)(e).telemetry,isTileDesignerTemplateApplied:s,dispatch:e.dispatch,isDefaultCardEnabled:Object(I.e)(e,{feature:{ODB:1615}})}})(function(e){var t=Se.useMemo(function(){var t=e.telemetry,n=e.qosEndPayload,i=function(){};if(0===e.selectionIndex){var s=new(t(et.e))({name:"customItemTileRenderQoS"}),o=new it.e({scenario:"ModernViewsRender"});if(n&&n.resultType===tt.e.Failure){var u=Object(r.__assign)(Object(r.__assign)({},n),{extraData:Object(r.__assign)(Object(r.__assign)({},n.extraData||{}),{error:n.error||"Something went wrong with rendering Gallery view.",isOOTB:m||g.isTileDesignerTemplateApplied,errorStage:"JSON generation"})});s.end(u);o.end(u)}else i=function(e){var t=e?{resultType:tt.e.Failure,error:e.errorString||"Something went wrong with rendering Gallery view.",extraData:Object(r.__assign)(Object(r.__assign)({},e.extraData),{isOOTB:m||g.isTileDesignerTemplateApplied,errorStage:"internal components"})}:{resultType:tt.e.Success};s&&s.end(t);o&&o.end(t)}}return{customItemTileRenderQoSEnd:i}},[]).customItemTileRenderQoSEnd;Object(Se.useEffect)(function(){if(d&&d.isTileFormatterAvailable()&&0===b){document.querySelectorAll(".sp-card-defaultClickButton")&&t();m||g.isTileDesignerTemplateApplied?e.dispatch(Object(ze.e)({name:"GalleryViewRender",isIntentional:!0})):e.dispatch(Object(ze.e)({name:"CustomFormatterTileLoad",isIntentional:!0}));d.hasFormatterReferences()&&e.dispatch(Object(ze.e)({name:"FormatterReferenceTile",isIntentional:!0}))}},[]);var n=Se.useState(!1),i=n[0],s=n[1],o=Se.useState([]),u=o[0],a=o[1],f=Se.useState(-1),l=f[0],c=f[1],h=e.defaultRender,p=e.customFormatterFeature,d=e.viewFormatter,v=e.isDefaultCardEnabled,m=e.isGenerated,g=Object(r.__rest)(e,["defaultRender","customFormatterFeature","viewFormatter","isDefaultCardEnabled","isGenerated"]);if(!h)return null;var y=p&&p.tileRenderer,b=g.selectionIndex,w=g.itemKey,E=g.itemSetKey,S=void 0===E?"":E;if(d&&d.isTileFormatterAvailable()&&y){var x=d.shouldHideSelectionInTiles(),T=d.getTileFormatter(),N=Se.createElement(nt.e,{qosEvent:t},Se.createElement(h,Object(r.__assign)({},g,{href:void 0,invokeSelection:!1},{className:Object(Je.e)(g.className,"customTile_7196c80e"),itemName:null,itemActivity:null,foreground:null,isSelectable:!x,selection:x?void 0:g.selection,selectionIndex:x?-1:g.selectionIndex,background:Se.createElement(Ye.e,{handleTabKey:Ze.t.all,direction:Ze.e.domOrder,tabIndex:i?0:-1,onKeyDown:function(e){if(e.which===Qe.e.tab){var t=l+1;if(t<u.length&&u[t]){u[t].focus();c(t);e.stopPropagation();e.preventDefault()}}else c(-1)},className:"customTileFocusZone_7196c80e"},Se.createElement(y,{rowIndex:b,itemKey:w,itemSetKey:S,formatter:T,qosEvent:t})),onFocus:function(e){s(!0);var t=e.currentTarget.querySelectorAll(".sp-card-keyboard-focusable");a(t)},onBlur:function(e){s(!1);a([]);c(-1)}})));return v&&T?Se.createElement(Xe.e,{controlHandlers:Ve.e.pack(st)},N):N}return Se.createElement(h,Object(r.__assign)({},g))}),ut=new ae.e("generatedViewFormatter",function(e,t){var n,r=t.itemKey;if(e.isItemFacetResolved(N.$e,r)&&r){var i=Object(We.e)(e,{itemSetKey:r}),s=e.demandItemFacet(Ue.n,Ue.t.serialize({})),o=e.demandItemFacet(y.e,r);if(o&&i&&s){var u=e.demandItemFacet(N.Ue,g.e.serialize(o)),a=Object($e.t)(e,{mapping:{fieldData:N.ue},itemSetKey:r}),f=Object(I.e)(e,{feature:{ODB:522}}),l=Object(I.e)(e,{feature:{ODB:1822}}),c=a.map(function(e){return e.fieldData}),h={};if(l){var p=e.demandItem({schema:ne.o},r).schema,d=p&&p.columnKeys;d&&f&&(h=Object(Ge.e)(e,d))}var v=u&&u.templateType||q.n.invalidType,m=void 0;if(c&&c.length>0&&v===q.n.genericList){var b=Object.keys(h).length>0?{fieldFormatters:h}:void 0;n=void 0===(m=s.tileDesigner.createDefaultTileProps(c,b))?{resultType:tt.e.Failure,error:"Error generating defaultTileProps",extraData:{fields:JSON.stringify(c)}}:{resultType:tt.e.Success}}var w=Object(qe.n)({formatter:void 0,fieldFormatters:h,generatedTileProps:m,columnFormatterReferenceProps:{columnFormatterReferenceEnabled:l}});if(w)return{viewFormatter:w.viewFormatter,qosEndPayload:n}}}});function at(e,t){var n,r=!1;if(!t)return{viewFormatter:void 0,isGenerated:r,isTileDesignerTemplateApplied:!1,qosEndPayload:n};var i=e.demandItemFacet(N.Cn,Object(We.e)(e,{itemSetKey:t})),s=i&&i.viewFormatter,o=s&&s.getTileProps(),u=Boolean(s&&s.isTileDesignerTemplateApplied());u&&(s=e.demandItemFacet(ft,t));if(!(o&&o.formatter&&o.formatter)){var a=e.demandItemFacet(ut,t);s=a&&a.viewFormatter;n=a&&a.qosEndPayload;r=!0}return{viewFormatter:s,isGenerated:r,isTileDesignerTemplateApplied:u,qosEndPayload:n}}var ft=new ae.e("postColumnDeleteViewFormatterFacet",function(e,t){var n=t.itemKey,r=e.demandItemFacet(N.Cn,Object(We.e)(e,{itemSetKey:n})),i=r&&r.viewFormatter;if(n){for(var s=Object($e.t)(e,{mapping:{fieldData:N.ue},itemSetKey:n}),o=[],u={},a=0;a<s.length;a++){var f=s[a],l=f.fieldData?f.fieldData.RealFieldName:"";if(l){o.push(f.fieldData);u[l]=f.fieldData}}var c=i&&i.getTileFormatterDesignerConfig(),h=e.demandItemFacet(Ue.n,Ue.t.serialize({})),p=e.demandItemFacet(y.e,n),d=p&&e.demandItemFacet(N.Ue,g.e.serialize(p)),v=d&&d.templateType||q.n.invalidType,m=Object(I.e)(e,{feature:{ODB:522}}),b=Object(I.e)(e,{feature:{ODB:1822}});if(h){var w=h.tileDesigner,E=w.encodeTileDesignerConfig,S=w.decodeTileDesignerConfig,x=w.createJSONFromConfig,T=w.shouldExcludeColumnInCards,C=w.encodeTileDesignerConfigForDocLib,k=c&&S(c),L=[],A={};if(m){var O=e.demandItem({schema:ne.o},n).schema,M=O&&O.columnKeys;M&&(A=Object(Ge.e)(e,M))}if(k){var _=!1;for(a=0;a<k.columns.length;a++){var D=k.columns[a],P=void 0;switch(D.id){case"LinkTitle":P="Title";break;case"LinkFilename":P="FileLeafRef";break;default:P=D.id}T(u[P],P)?_=!0:L.push(D)}k.columns=L;var H=v===q.n.documentLibrary?C(k,!0):E(k);if(_||m){var B=x(o,H,Object.keys(A).length>0?{fieldFormatters:A}:void 0,v),j=Object(qe.n)({formatter:JSON.stringify({tileProps:B}),fieldFormatters:A,columnFormatterReferenceProps:{columnFormatterReferenceEnabled:b}});return j&&j.viewFormatter}}}}return i});function lt(e){return function(){return Object(r.__assign)(Object(r.__assign)({},e?{headerRenderer:e}:{}),{maxItemCount:30})}}var ct=n(1399),ht=n(49),pt=Object(_.t)()(function(){return function(e){return function(e,t){var n,i=t.itemSetKey;if("3a867b4a-7429-0e1a-b02e-bf4b240ff1ce"===(null===(n=Object(ht.e)(e,i))||void 0===n?void 0:n.listTemplateId))return{};var s=(function(e,t){var n=at(e,t).viewFormatter,r=n&&n.isTileFormatterAvailable(),i=t&&Object(Ke.t)(e)?Object(Ke.e)(t,"TILES"):void 0;if(!r)return i?{groupControlHandler:lt(i)}:{};var s=(function(e){var t=254,n=340,r=e&&e.getTileProps(),i=r&&r.width&&r.width>=0?r.width:t;return{height:r&&r.height&&r.height>=0?r.height:n,width:i,disableMarqueeSelection:r&&r.hideSelection}})(n),o=s.height,u=s.width,a=s.disableMarqueeSelection,f=n&&n.fillCardsHorizontally()?3:1;return{tileRenderer:ot,grid:{minRowHeight:o,mode:f},className:"sp-gallery-listContainer",disableMarqueeSelection:a,tileControlHandler:function(){return{desiredSize:{width:u,height:o}}},groupControlHandler:lt(i)}})(e,i),o=Object(G.e)(e,{enableMediaTilesInDocumentGroup:N.R}).enableMediaTilesInDocumentGroup;!(void 0===o||o)||s.tileControlHandler||R.e.isActivated("AE9181E6-211F-42C9-B30A-9CAC1BEF5937","8/30/2021","Restore media handler for TilesList")||(s=Object(r.__assign)(Object(r.__assign)({},s),{tileControlHandler:ct.e}));return s}}});var dt=n(1139),vt=n(503),mt=n(3910),gt=n(1191),yt=n(3912),bt=n(54),wt=n(926),Et=Object(_.t)()(function(){return function(e){return function(t,n){var r=n.itemKey,i=t.demandItemFacet(h.e,r),s=i&&x.e.serialize(i),o=t.demandItemFacet(N.ln,s),u=t.demandItemFacet(N.Sn,r),a=t.demandItemFacet(ve.i,r),f=i&&i.listFullUrl,l=i&&i.webAbsoluteUrl,c=t.demandItemFacet(ve.d,r);return{checkInAction:Se.createElement(wt.e,{checkInOutType:"checkIn"}),undoCheckOutAction:Se.createElement(wt.e,{checkInOutType:"undoCheckOut"}),onDismiss:function(t,n){var r=e(Object(Le.n)({webAbsoluteUrl:l||"",listFullUrl:f})).dataRequestor,i={ListId:o&&o.listId,ListItemUniqueId:u,Operation:"RecommendationActedOn",AffectedResourceUrl:a,ItemType:"File",json:JSON.stringify({FileName:c&&c.name,Scenario:"RecommendedActions",SourceRelativeUrl:f,DismissRecommendationsCategory:"FocusedTask",PositionNumber:(n+1).toString(),TotalRecommendationsPresented:"3",RecommendationAlgorithmVersion:"1",ReferringCorrelationId:t,Canvas:"Web",Workload:"SharePoint",WebId:o&&o.webId,SiteId:o&&o.siteId,SiteUrl:o&&o.siteAbsoluteUrl,ClientLocalTime:(new Date).toISOString(),SourceFileName:c&&c.name,SourceFileExtension:c&&c.extension,ClientUTCOffsetInMinutes:(new Date).getTimezoneOffset().toString(),RecommendationId:t,ActionType:"Dismiss"})},s=new bt.t(l+"/_api/web/ActivityLogger/FeedbackDirect");r.getData({url:s.toString(),qosName:"DismissActions",method:"POST",needsRequestDigest:!0,additionalPostData:JSON.stringify(i),timeout:6e3,qosExtraData:{Caller:"HoverCard"}})}}}}});var St=n(20),xt=n(1059),Tt=n(1056),Nt=n(3550),Ct=n(569),kt=Object(_.t)()(function(){return function(e){return function(e,t){var n=t.signalData,i=t.itemKey;if(n&&i&&n.key===Tt.t.key){var s=e.demandItemFacet(N.rt,i),o=e.demandItemFacet(h.e,i),u=o&&x.e.serialize(o),a=e.demandItemFacet(N.ln,u);if(!s||!a||a.listBaseTemplate!==q.n.webPageLibrary)return{};var f=a&&Object(R.n)(a);if(!(!!f&&f.isActivated("eccf828d-ab98-4d4e-b9dd-25467f4f2f10","9/7/2020","Remove file card flight"))){var l=e.demandItemFacet(N.wn,i),c=e.demandItemFacet(N.Ze,i),p=Object(Ct.t)(e,i),d=Nt.p,v=0,m=Tt.t.signal,g=Nt.r;if(c)d=Nt.x;else if(p){d=Nt.g;v=1;m=Tt.e.signal;g=Nt.i}else if(l){var y=Math.floor(Number(l)/512);d=0===y?Nt.p:Nt.m}return{onRenderLifeCycleSignal:function(e,t){return t?Se.createElement(St.n,{action:Se.createElement(xt.e,{itemKeys:[i],publishType:v,source:"FileCard"})},function(n){var i=n.isAvailable,s=n.execute,o=i?function(){s()}:void 0,u=Object(r.__assign)(Object(r.__assign)({},e),{actionName:d,action:o,content:g,signal:m});return t(u)}):null}}}return{}}return{}}}});var Lt=n(865),At=n(679),Ot=n(2),Mt=n(626),_t=n(64),Dt=n(63),Pt=n(72),Ht={key:new Ot.e("manageAccess").id,automationId:"manageAccessCommand",name:_t.p,title:_t.d,action:Se.createElement(Dt.t,null,Se.createElement(Mt.ManageAccessAction,null)),iconProps:{iconName:"PlayerSettings"},facets:Object(r.__assign)({},Pt.r.pack(!0))},Bt=!R.t.isActivated(U.e,"7/5/2019","Show file handler commands before OOB commands"),jt=Object(_.t)()(function(){return function(e){return It}});var Ft=[At.e,X.n,X.t,Ht];function It(e,t){var n=qt(e,t.itemKey);return{commands:(function(e,t){return e.map(function(e){return e.key===At.e.key?Object(U.t)(t,Bt):e})})(Ft,n)}}function qt(e,t){var n,r=e.demandItemFacet(Be.t,t);if(r){var i=new P.e(r.tenantRootUrl).authority+"/_api/v2.0",s=H.t.serialize({endpoint:i});n=Object(F.e)(e,{itemKey:s})}return n}var Rt=!R.t.isActivated(U.e,"7/5/2019","Show file handler commands before OOB commands"),Ut=[At.e,X.n,X.t],zt=Object(_.t)()(function(){return function(e){return Wt}});function Wt(e,t){var n=qt(e,t.itemKey);return{commands:ee(Ut,n,!0,Rt,!1)}}var Xt=n(615),Vt=n(3458),$t=n(1001),Jt=Object(_.t)()(function(){return function(e){return Qt}});var Kt=[Xt.e,Vt.e,$t.e];function Qt(e,t){return{columns:Kt}}var Gt=n(396),Yt=n(400),Zt=n(494),en=n(4310),tn=n(874),nn=n(203),rn=Object(i.i)()(function(e){var t=this,n=e.itemKey,i=Be.t.deserialize(n).tenantRootUrl;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,s,o,u,a,f;return Object(r.__generator)(this,function(l){switch(l.label){case 0:t=Object(tn.n)({webAbsoluteUrl:i}).segments("SP.Directory.DirectorySession","me").rawParameter("$select=mySite");return[4,e(Object(Le.t)({url:t.toString(),qosName:"GetMyOneDriveUrl",method:"POST",webAbsoluteUrl:i,noRedirect:!0}))];case 1:if(!((s=l.sent())&&s.d&&s.d.mySite))throw new Yt.e({facets:Object(r.__assign)({},nn.p.pack({}))});o=s.d.mySite.replace(/\/$/,"");u=Zt.t.serialize({webAbsoluteUrl:o||i});(a=new Oe.e).resolveItems({items:(f={},f[n]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},ne.t.pack({itemKey:u})),ve.h.pack(en.e)),ve.m.pack({})),f)});e(a.execute());return[2]}})})}});var sn=n(4656),on=n(272),un=n(190),an=n(123),fn=n(1019),ln=n(1014),cn=n(1369),hn=n(282),pn=n(692),dn=n(557),vn=n(610),mn=n(495),gn=n(137),yn=n(165);function bn(e,t){var n=[];e.d.results.forEach(function(e){var i,s,o,u,a=""+new P.e(e.SiteUrl).authority+e.UrlPath,f=e.LinkingUrl?e.LinkingUrl:a,l=ln.e.serialize({itemFullUrl:a});n.push(l);var c=Object(sn.t)(e.Modified),h=(function(e){var t=Object(fn.e)(e),n={itemFullUrl:t};return{parentItemUrl:t,parentItemKey:ln.e.serialize(n)}})(a),p=h.parentItemKey,d=h.parentItemUrl;t.mapKeys({mappings:(i={},i[ln.e.serialize({itemFullUrl:d})]=p,i)});var v=(function(e,t){var n=void 0!==t?t:3,r=!1,i=!1;if(e.IsContainer){n=hn.e.folder;i=!0}"OneNote.Notebook"===e.ProgId&&(r=!0);return{isOneNote:r,isDocSet:!1,fileIconType:n,isFolder:i}})(e),m=e.SpItemUrl?Object(dn.e)(e.SpItemUrl):void 0;if(m)for(var g=0,y=Object(dn.t)(m);g<y.length;g++){var b=y[g];t.mapKeys({mappings:(s={},s[b]=l,s)})}var w,E,S,x,T=e.Editor;if(T&&T.email&&T.name){var C=cn.e.serialize({id:T.email});w={itemKey:C,displayValue:T.name};t.resolveItems({items:(o={},o[C]=Object(r.__assign)(Object(r.__assign)({},ve.h.pack(T.name)),un.e.pack(T.email)),o)})}t.resolveItems({items:(u={},u[l]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},ve.h.pack(e.FileLeafRef)),ve.x.pack(!0)),ve.d.pack((E=e.FileLeafRef,S=e.IsContainer,x=E.lastIndexOf("."),S||x<0?{name:E,extension:""}:{name:E.substring(0,x),extension:E.substring(x)}))),an.e.pack(v.fileIconType)),ve.f.pack(c.getTime())),ve.i.pack(a)),ve.M.pack({itemKey:p})),w?ve.A.pack(w):{}),an.i.pack(v.isOneNote?{}:void 0)),ve.m.pack(v.isFolder?{}:void 0)),ve.O.pack(f)),gn.e.pack(m)),N.Xe.pack(e.ListItemId.toString())),e.UniqueId?N.Sn.pack(Object(yn.normalizeLower)(e.UniqueId,!1)):{}),e.ListId?N.We.pack(Object(yn.normalizeLower)(e.ListId,!1)):{}),m?Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},ve.n.pack({itemKey:vn.e.serialize({driveItemKey:m})})),ve.g.pack({itemKey:mn.e.serialize({driveItemKey:m})})),ve.e.pack({itemKey:pn.e.serialize({driveItemKey:m})})):{}),Object(on.e)().forFacet(ve.h).thenInvalidate(l,ne.e).pack()),u[p]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},ve.m.pack({})),ve.i.pack(d)),ve.O.pack(d)),u)})});return n}var wn=n(1549),En=n(238),Sn=Object(i.i)()(function(e){var t=this,n=e.itemKey,i=Zt.t.deserialize(n).webAbsoluteUrl;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,s,o,u,a,f,l,c,h;return Object(r.__generator)(this,function(p){switch(p.label){case 0:t=(t=Object(tn.r)({webAbsoluteUrl:i,listOrItemFullUrl:""})).segment("OneDriveSharedItems").parameter("$top",100).parameter("$expand",{raw:"SpItemUrl,DriveAccessToken,DriveAccessTokenV21,DriveUrl"});s=t.toString();return[4,e(Object(Le.t)({url:s,method:"GET",qosName:"getSharedByMeDocs",webAbsoluteUrl:i}))];case 1:o=p.sent();u=new Oe.e;a=bn(o,u);f=""+new P.e(i).authority;l=Be.t.serialize({tenantRootUrl:f});if(o.d.__next){c=wn.e.serialize({itemSet:Zt.t.deserialize(n),after:o.d.__next});a.push(c);u.merge(Object(En.t)({itemKey:c}).itemResolver)}u.resolveItems({items:(h={},h[n]=Object(r.__assign)(Object(r.__assign)({},ne.e.pack({itemKeys:a})),ne.s.pack({itemKey:l})),h[l]=Object(r.__assign)({},Object(on.e)().forFacet(ne.t).thenInvalidate(n,ne.e).pack()),h)});e(u.execute());return[2]}})})}});var xn=Object(i.i)()(function e(t){var n=this,i=t.itemKey,s=wn.e.deserialize(i).after,o=wn.e.deserialize(i).itemSet;return function(t){return Object(r.__awaiter)(n,void 0,void 0,function(){var n,u,a,f,l;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return[4,t(Object(Le.t)({url:s,method:"GET",qosName:"getSharedByMeDocs",webAbsoluteUrl:o.webAbsoluteUrl}))];case 1:n=r.sent();u=Zt.t.serialize(o);a=new Oe.e({publisher:e});f=bn(n,a);if(n.d.__next){l=wn.e.serialize({itemSet:o,after:n.d.__next});f.push(l);a.merge(Object(En.t)({itemKey:l}).itemResolver)}a.merge(Object(En.e)({itemKey:i,itemSetKey:u,childItemKeys:f}).itemResolver);t(a.execute());return[2]}})})}});var Tn=n(4166),Nn=n(868),Cn=n(685),kn=n(1291),Ln=n(173),An=Object(_.t)()(function(){return function(e){return function(e,t){return(function(e,t){var n=t.itemKey,i=Object(G.e)(e,{enableItemActivityField:N.B}).enableItemActivityField,s=e.demandItemFacet(N.de,n),o=i&&Object(Ln.r)(e,Se.createElement(kn.e,{itemKey:n,isCompact:!0,hideDate:!0}))||s&&Se.createElement(Cn.e,{text:s}),u=e.demandItemFacet(N.et,n);return Object(r.__assign)(Object(r.__assign)({},o?{itemActivity:o}:{}),{folderCoverControlHandler:function(e,t){return u?{folderCoverAs:On}:{}}})})(e,t)}}});function On(e){var t=e.defaultRender,n=Object(r.__rest)(e,["defaultRender"]);return t?Se.createElement(t,Object(r.__assign)({},n,{folderCoverType:"linked"})):null}var Mn=n(1427),_n=n(788),Dn=n(3035),Pn=n(1270),Hn=n(1238),Bn=n(439),jn=n(465),Fn=n(774);function In(e){var t=e.listMediaTransformSchema,n=e.itemMediaTransformSchema;if(t&&n){var i=t[".transformUrl"],s=n[".hasThumbnail"],o=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},t),n),{".method":"thumbnail"});if("True"===s&&i)return function(e,t){var n=t?{width:e,height:t}:{width:e};return Object(Fn.n)(i,o)+"&"+Object(jn.e)(n)}}}var qn=Object(i.i)({maxParallelOperationCount:16})(function(e){var t=this,n=Pn.e.deserialize(e.itemKey).itemKey;return function(i){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,s,o,u;return Object(r.__generator)(this,function(a){switch(a.label){case 0:return[4,i(Object(Hn.e)(function(e){var t=e.demandItemFacet(h.e,n),r=t&&g.e.serialize(t);return{generator:In({listMediaTransformSchema:e.demandItemFacet(Bn.t,r),itemMediaTransformSchema:e.demandItemFacet(Bn.e,n)})}}))];case 1:t=a.sent().generator;(s=new Oe.e).resolveItems(((o={items:(u={},u[e.itemKey]=Object(r.__assign)({},Bn.n.pack(t)),u)})[n]=Object(r.__assign)({},Object(on.e)().forFacet(Bn.e).thenInvalidate(e.itemKey,Bn.n).pack()),o));i(s.execute());return[2]}})})}});var Rn=Object(i.t)(function(){return function(e){e(Object(s.r)(Pn.e,ke.e)(qn));e(Object(o.e)(h.e,_n.e)(Dn.n));e(Object(o.e)(ln.e,_n.e)(Dn.t))}}),Un=Object(i.t)(function(){return function(e){e(Object(o.e)(h.e,Ve.e)(An));e(Rn);e(Mn.e)}}),zn=n(3913),Wn=Object(_.t)()(function(){return function(e){return function(e,t){var n=t.itemKey;return{isAvailable:!!e.demandItemFacet(h.e,n)}}}});var Xn=n(3879),Vn=n(375),$n=n(829),Jn=n(4311),Kn=n(1115),Qn=n(82),Gn=n(18),Yn=n(713),Zn=Object(_.t)()(function(){return function(e){return function(e,t){return{errorRenderer:er}}}});var er=Object(Re.t)(function(e,t){var n=t.defaultRender,i=(t.itemKey,t.title,Object(r.__rest)(t,["defaultRender","itemKey","title"])),s=i.error;if(s instanceof Qn.e&&s.extraData&&404===s.extraData.status){var o=Object(Yn.e)(e),u=o&&o.localItemKey,a=void 0,f=Jn.e;if(u){var l=e.demandItemFacet(ve.h,u);l&&(f=Gn.format(Jn.t,l));a=Se.createElement("div",null,Se.createElement(St.n,{action:Se.createElement($n.e,{itemKeys:[u]})},function(e){var t=e.execute;return Se.createElement(Kn.e,{onClick:function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,t().then(function(){window.location.href="#"}).catch()];case 1:e.sent();return[2]}})})}},Jn.r)}))}return Se.createElement(Se.Fragment,null,n?Se.createElement(n,Object(r.__assign)({key:"error"},i,{title:Jn.n,subText:f,actions:a})):null)}return n?Se.createElement(n,Object(r.__assign)({},t)):null}),tr=n(1017),nr=n(1611),rr={key:cn.e,displayName:ve.h,email:un.e},ir=Object(i.i)()(function(e){var t=e.itemKey,n=tr.e.deserialize(t);return function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var i,s,o,u,a,f,l,c,h,p;return Object(r.__generator)(this,function(d){switch(d.label){case 0:i=n.siteUrl||"";s=n.listId||"";o=n.uniqueId||"";u=i+"/_api/web/Lists('"+s+"')/GetPlacesInformation('"+o+"')?$expand=places";d.label=1;case 1:d.trys.push([1,3,,4]);return[4,e(Object(nr.n)({url:u,qosName:"GetPlacesInformation",method:"GET",endpoint:i}))];case 2:a=d.sent();f=new Oe.e;l=[];(c=a&&a.places)&&c.forEach(function(e){var t,n=e.userEntity.email,r=cn.e.serialize({id:String(n)});f.resolveItems({items:(t={},t[r]=Object(Ot.n)(rr,{key:{id:String(n)},displayName:e.userEntity.name,email:n}),t)});l.push(r)});h=a.placesCount&&parseInt(a.placesCount,10);f.resolveItems({items:(p={},p[t]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},N.gt.pack({locationKeys:l})),h&&!isNaN(h)?Object(r.__assign)({},N.yt.pack(h)):{}),N.Fe.pack(a.itemSourcePath)),ve.h.pack(a.itemSourceSiteTitle)),p)});e(f.execute());return[3,4];case 3:throw d.sent();case 4:return[2]}})})}}),sr=n(2623),or=Object(i.t)(function(){return function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(t){e(Ie);e(Lt.e);e(Nn.e);e(S.spDataOnlyAddonDeferred);e(Object(o.e)(h.e,c.e)(Z));e(Object(o.e)(p.e,f.e)(oe));e(Object(o.e)(h.e,a)(me));e(Object(o.e)(p.e,u.e)(we));e(Un);e(Object(s.r)(d.e,ke.e)(Ee.e));e(Object(s.r)(v.e,ke.e)(Ce));e(Object(s.r)(m.e,ke.e)(Me));e(Object(s.r)(g.e,_e.t)(Object(i.r)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([43],4708)];case 1:return[2,e.sent().saveUploadedTemplateToView]}})})})));e(Object(s.r)(g.e,De.t)(Object(i.r)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([42],4709)];case 1:return[2,e.sent().saveTemplatesToView]}})})})));e(Object(o.e)(y.e,dt.e)(pt));e(Object(o.e)(h.e,vt.e)(mt.e));e(Object(o.e)(h.e,gt.e)(Et));e(Object(o.e)(Be.t,l.e)(jt));e(Object(o.e)(Zt.t,Gt.e)(Jt));e(Object(o.e)(Be.t,c.e)(zt));e(Object(s.r)(Be.t,ke.e)(rn));e(Object(s.r)(Zt.t,ke.e)(Sn));e(Object(s.r)(wn.e,ke.e)(xn));e(Object(s.r)(tr.e,ke.e)(ir));e(Object(o.e)(b.e,f.e)(ce));e(Object(o.e)(h.e,yt.e)(kt));e(Object(s.r)(w.e,ke.e)(Tn.t));e(Object(o.e)(E.e,Vn.e)(Zn));e(Object(o.e)(h.e,zn.e)(Wn));e(Object(s.r)(h.e,sr.e)(Object(i.r)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee(63,4710)];case 1:return[2,e.sent().setItemValuesFromFormatter]}})})})));return[2]})})}})},,,,,,,function(e,t,n){"use strict";n.r(t);n.d(t,"graphAddonDeferred",function(){return Ve});var r,i=n(16),s=n(246),o=n(370),u=n(781),a=n(386),f=n(14),l=n(679),c=n(274),h=n(2),p=n("react-lib"),d=n(376),v=n(858),m={action:p.createElement(v.e,null),automationId:"addShortcutFromSharedWithMeCommand",title:d.t,iconProps:{iconName:"FabricFolderLink"},key:new h.e("AddShortcutFromSharedWithMe").id,name:d.e},g=n(63),y=n(829),b={action:p.createElement(g.t,null,p.createElement(y.t,null)),automationId:"removeShortcutFromSharedWithMeCommand",title:d.a,iconProps:{iconName:"FabricFolderLink"},key:new h.e("RemoveShortcutFromSWM").id,name:d.u},w=n(0),E=n(134),S=n(192),x=n(1613),T=n(741),N=n(3358),C=n(6),k=n(32),L=n(42),A=n(127),O=n(20),M=n(22),_=n(13),D=n(3913),P=n(27),H=n(393),B=n(67),j=Object(k.t)(function(e,t){var n=t.itemKeys,r=t.removeFromSharedListWizard,i=t.removeItemsFromSharedList,s=void 0===i?N.t:i,o=Object(L.e)(e)||"",u=e.demandItemFacet(H.e,o);if(0===n.length)return null;for(var a=u&&n.length<=200,f=r,l=0,c=n;l<c.length;l++){var h=c[l],d=e.demandItemFacet(D.e,h),v=!B.t.isActivated("6c28a705-1f14-4f06-97c7-ee39b2d66e9e","11/5/2020","Action should be available unless otherwise stated in control handler");D.e.evaluate(d)(e,{itemKey:h,isAvailable:v}).isAvailable||(a=!1)}var m=e.dispatch,g=function(){return Object(w.__awaiter)(void 0,void 0,void 0,function(){var e,t;return Object(w.__generator)(this,function(r){switch(r.label){case 0:e={itemSetKey:o};t=Object(A.e)(n,function(){return e});return[4,m(s({items:t}))];case 1:r.sent();return[2]}})})},y=Object(O.o)(function(e){return p.createElement(f,Object(w.__assign)({},e,{onItemRemoved:g,itemKeys:n}))});return p.createElement(M.e,Object(w.__assign)({isAvailable:a,onExecute:y},Object(P.t)(e,{itemKey:void 0,engagement:{name:"RemoveFromSharedList",isIntentional:!0,extraData:{itemCount:n.length}}})))}),F=Object(_.s)()(j),I=n(4414),q=n(4035),R=n(18),U=n(61),z=n(431),W=n(136),X=((r={})[U.r.started]=function(e){return Object(R.formatToArray)(Object(R.getLocalizedCountValue)(q.s,q.t,e)||"",e)},r[U.r.completed]=function(e){return Object(R.formatToArray)(Object(R.getLocalizedCountValue)(q.e,q.t,e)||"",e)},r[U.r.failed]=function(e){return Object(R.formatToArray)(Object(R.getLocalizedCountValue)(q.n,q.r,e)||"",e)},r[U.r.canceled]=function(e){return Object(R.formatToArray)(Object(R.getLocalizedCountValue)(q.n,q.r,e)||"",e)},r),V=Object(i.t)(function(){return function(e){e(Object(a.e)(N.e,z.e)(Object(f.t)()($)))}});function $(){return function(e){return J}}function J(e,t){var n,r=Object(W.r)(e,t),i=r.phase,s=r.count;n=X[i](s);return Object(w.__assign)({},n&&"item"!==t.format?{title:n}:{})}var K=(function(e){Object(w.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this,t=this.props,n=t.resolve,r=t.reject,i=t.onItemRemoved,s=t.itemKeys,o=function(){return Object(w.__awaiter)(e,void 0,void 0,function(){return Object(w.__generator)(this,function(e){switch(e.label){case 0:n();return[4,i()];case 1:e.sent();return[2]}})})},u=function(){return Object(w.__awaiter)(e,void 0,void 0,function(){return Object(w.__generator)(this,function(e){r(new E.e);return[2]})})};return p.createElement(S.e,null,function(e){var t=e.itemCache,n=Q(t,s),r=n.title,i=n.prompt;return p.createElement(x.ConfirmationDialog,{onCancel:u,onConfirm:o,yesText:q.i,noText:I.o,defaultToYes:!0,title:r,prompt:i})})};return t})(p.PureComponent),Q=function(e,t){if(t.length>1)return{title:I.s,prompt:I.i};if(1===t.length){var n=e.demandItemFacet(C.m,t[0]);return{title:n?I.r:I.t,prompt:n?I.n:I.e}}return{title:"",prompt:""}},G=Object(T.e)({operationTypeFacet:N.n,progressKeyFacet:N.e,initializeBatch:function(){return V}});var Y=Object(k.e)(function(){return{removeFromSharedListWizard:K,removeItemsFromSharedList:G}})(F),Z={key:new h.e("removeFromSharedList").id,automationId:"removeFromSharedListCommand",name:d.f,title:d.l,action:p.createElement(g.t,null,p.createElement(Y,null)),iconProps:{iconName:"Cancel"}},ee=Object(f.t)()(function(){return function(e){return ne}});var te=[l.e,c.n,c.t,m,b,Z];function ne(e,t){return{commands:te}}var re=n(4528),ie=n(606),se=Object(f.t)()(function(){return function(e){return ue}});var oe=[l.e,c.n,c.t,m,b,Z];function ue(e,t){return{commands:oe}}var ae,fe=n(331),le=n(319),ce=n(275),he=((ae={})[ce.t]=!0,ae[ce.r]=!0,ae[le.i]=!0,ae[le.e]=!0,ae[le.r]=!0,ae),pe=Object(f.t)()(function(){return function(e){return de}});function de(e,t){var n=t.itemSetKey,r=t.handler,i=r.columnKey,s=r.isAscending;if(!he[i])return{};var o=e.demandItemFacet(H.e,n);if(!o)return{};var u=le.t[i];return u?{newItemSetKey:H.e.serialize(Object(w.__assign)(Object(w.__assign)({},o),{sortBy:u,isAscending:s}))}:{}}var ve,me=n(437),ge=n(520),ye=n(3900),be=Object(f.t)()(function(){return function(e){return function(e,t){var n=t.itemKey,r=e.demandItemFacet(H.e,n),i=r&&r.driveItemKey.endpoint,s=i&&r&&Object(ye.e)(e,{itemSetKey:H.e.serialize(r),parentItemKey:ie.e.serialize({endpoint:i}),stageItem:t.stageItem});return Object(w.__assign)({},s?{stageItem:s}:{})}}});var we=((ve={})[le.i]=!0,ve[le.e]=!0,ve),Ee=Object(f.t)()(function(){return function(e){return Se}});function Se(e,t){var n=t.itemSetKey,r=t.handler.columnKey;if(!we[r])return{};var i=e.demandItemFacet(H.e,n);if(!i)return{};var s=le.t[r];return s?{newItemSetKey:H.e.serialize(Object(w.__assign)(Object(w.__assign)({},i),{groupBy:s}))}:{}}var xe=Object(f.t)()(function(){return function(e){return Te}});function Te(e,t){var n=t.itemSetKey,r=e.demandItemFacet(H.e,n);return r?{newItemSetKey:H.e.serialize(Object(w.__assign)(Object(w.__assign)({},r),{groupBy:void 0}))}:{}}var Ne=n(3897),Ce=Object(f.t)()(function(){return function(e){return function(e,t){return{isAvailable:!1}}}});var ke=Object(f.t)()(function(){return function(e){return function(e,t){return{isAvailable:!1}}}});var Le=n(769),Ae=n(3544),Oe=n(307),Me=n(200),_e=n(268),De=n(109),Pe=n(1611),He=n(5),Be=new He.e("topCollaboratorItemKeyFacet",{id:Object(He.s)()}),je=n(143),Fe=n(190),Ie=n(10),qe=Object(i.i)()(function e(t){var n=this,r=t.itemKey;return function(i){return Object(w.__awaiter)(n,void 0,void 0,function(){var n,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b;return Object(w.__generator)(this,function(E){switch(E.label){case 0:n=new Me.e({publisher:e});s=i(Object(_e.e)({graphEndpoint:De.m})).graphEndpoint;o=Ae.e.deserialize(r);u=s||o.endpoint;a=u+"/me/people/";return[4,i(Object(Pe.n)({url:a,qosName:"getTopCollaborator",endpoint:u}))];case 1:f=E.sent();l=[];for(c=0,h=f.value;c<h.length;c++){p=h[c];d=p.id,v=p.displayName,m=p.userPrincipalName;g=Be.serialize({id:d});i(Object(je.e)({items:(y={},y[g]=Object(w.__assign)(Object(w.__assign)({},C.h.pack(v)),Fe.e.pack(m)),y)}));l.push(g)}n.resolveItems({items:(b={},b[t.itemKey]=Object(w.__assign)({},Ie.e.pack({itemKeys:l})),b)});i(n.execute());return[2]}})})}});var Re=n(686),Ue=n(723),ze=n(545),We=Object(f.t)()(function(){return function(){return Xe}});function Xe(e,t){var n,r=t.layouts;if(r){n=[];for(var i=0,s=r;i<s.length;i++){var o=s[i];o.layoutType!==Ue.t.layoutType?o.layoutType!==Ue.e.layoutType?o.layoutType!==ze.t.layoutType?n.push(o):n.push(ze.t):n.push(Ue.e):n.push(Ue.t)}}return Object(w.__assign)({},n?{layouts:n}:{})}var Ve=Object(i.t)(function(){return function(e){e(Object(Le.e)(function(){e(re.graphAddonDataOnlyDeferred);e(Object(a.e)(ie.e,o.e)(se));e(Object(a.e)(ie.e,u.e)(ee));e(Object(a.e)(H.e,fe.e)(pe));e(Object(a.e)(H.e,me.e)(be));e(Object(a.e)(H.e,ge.e)(Ee));e(Object(a.e)(H.e,ge.t)(xe));e(Object(a.e)(Ne.n,me.e)(Ce));e(Object(a.e)(Ne.t,me.e)(ke));e(Object(s.r)(Ae.e,Oe.e)(qe));e(Object(a.e)(H.e,Re.e)(We))}))}})}],Array(21),[function(e,t,n){"use strict";n.r(t);n.d(t,"sharePointAddonAutoRefresh",function(){return Le});var r,i=n(16),s=n(386),o=n(78),u=n(3831),a=n(0),f=n("react-lib"),l=n(486),c=n(14),h=n(29),p=n(10),d=n(6),v=n(200),m=n(178),g=n(244),y=n(67),b=n(1267),w=n(3924),E=n(2018),S=n(84),x=n(44);(function(e){e[e.New=0]="New";e[e.Update=1]="Update";e[e.Delete=2]="Delete"})(r||(r={}));var T={ODB:819,ODC:"EnablePushChannelLogging"},N={ODB:459},C=(function(){function e(e){var t=this;this.subscribe=function(){t._log("Subscribe");if(0===t._subscribers){t._async=new m.e;y.t.isActivated("90f6bcb1-03a0-4a02-9370-1e6807d6763a","7/22/2021","Fix Item Auto Refresh Bug")||(t._syncToken="latest");var e=t._async.debounce(function(){return t._onNotification()},1e4,{leading:!0,maxWait:1e4});t._pushChannelService.setupNotificationHandler({source:w.t.WebhookSubscription},function(){t._log("PushChannelMessageSource",w.t.WebhookSubscription);e()});t._pushChannelService.setupNotificationHandler({source:w.t.EventHub},function(){t._log("PushChannelMessageSource",w.t.EventHub);e()});t._pushChannelService.addConnectionHandler(t._id,function(e){return t._onPushChannelConnection(e)})}t._subscribers++;t._pushChannelService.isConnected()||t._pushChannelService.connect(t._getNotification(),{methodInvoker:"ItemAutoRefreshHelper.subscribe"});return t._unsubscribe.bind(t)};this._id=e.id;this._driveUrlParts=e.driveUrl?Object(b.e)(e.driveUrl):void 0;this._dispatch=e.dispatch;this._template=e.template;this._itemScopeItemKey=e.itemsScopeItemKey||"";this._pushChannelService=e.pushChannelService;this._onUnsubscribe=e.onUnsubscribe;this._isTestMode=e.isTestMode;this._onPushChannelConnected=e.onPushChannelConnected;this._onNotificationReceived=e.onNotificationReceived;this._subscribers=0;this._syncToken="latest";this._getChangesAttempts=0}e.prototype._unsubscribe=function(){this._log("Unsubscribe");this._subscribers--;this._template.onUnsubscribe(this._subscribers);if(0===this._subscribers){if(this._async){this._async.dispose();this._async=void 0;this._refreshSubscriptionTimeoutId=void 0}this._pushChannelService.setupNotificationHandler({source:w.t.WebhookSubscription},function(){});this._pushChannelService.removeConnectionHandler(this._id);this._pushChannelService.disconnect()}this._onUnsubscribe(this._subscribers);return this._subscribers};e.prototype._onPushChannelConnection=function(e){return Object(a.__awaiter)(this,void 0,void 0,function(){var t,n;return Object(a.__generator)(this,function(r){switch(r.label){case 0:if(!e){this._log("Disconnected");this._clearRefreshSubscriptionTimeout();return[2]}this._log("Connected");this._isTestMode&&this._onPushChannelConnected&&this._onPushChannelConnected();if(y.t.isActivated("90f6bcb1-03a0-4a02-9370-1e6807d6763a","7/22/2021","Fix Item Auto Refresh Bug"))return[3,5];r.label=1;case 1:r.trys.push([1,3,,4]);return[4,this._resolveChangeMessages()];case 2:r.sent();return[3,4];case 3:t=r.sent();this._handleError(t);return[2];case 4:return[3,9];case 5:if("latest"!==this._syncToken)return[3,9];r.label=6;case 6:r.trys.push([6,8,,9]);return[4,this._getChangeMessages()];case 7:r.sent();return[3,9];case 8:n=r.sent();this._handleError(n);return[2];case 9:this._refreshSubscriptionHandler();return[2]}})})};e.prototype._handleError=function(e){var t=this;this._getChangesAttempts++;if(!(this._getChangesAttempts>10)){var n=!1;if(Object(E.s)(e))switch(e.status){case 404:case 410:n=!0;this._syncToken="latest"}n&&this._async&&this._async.setTimeout(function(){return t._onPushChannelConnection(t._pushChannelService.isConnected())},500+Math.pow(2,this._getChangesAttempts))}};e.prototype._getNotification=function(){return this._template.getSubscription&&this._template.getSubscription(this._dispatch)};e.prototype._refreshSubscriptionHandler=function(){var e=this;if(this._async){var t=this._pushChannelService.getSocketIoSubscription();if(t){var n=105001*Math.random()+15e3,r=Date.parse(t.expirationDateTime),i=Date.now(),s=r-i-n;if(s<12e4){if(g.e.isFeatureEnabled(N)){var o={refreshDelay:s,expirationDateTime:t.expirationDateTime,expirationDateTimeinMS:r,dateTimeNow:i,recreateBufferRandom:n};new S.e({name:"ItemAutoRefreshHelper.refreshSubscription",extraData:o}).end({resultType:x.e.Failure,extraData:o})}s=12e4}this._clearRefreshSubscriptionTimeout();this._refreshSubscriptionTimeoutId=this._async.setTimeout(function(){return Object(a.__awaiter)(e,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:this._log("Refreshing subscription");this._refreshSubscriptionTimeoutId=void 0;return[4,this._pushChannelService.refreshSubscription()];case 1:!0===e.sent()&&this._refreshSubscriptionHandler();return[2]}})})},s)}}};e.prototype._clearRefreshSubscriptionTimeout=function(){if(this._async&&void 0!==this._refreshSubscriptionTimeoutId){this._async.clearTimeout(this._refreshSubscriptionTimeoutId);this._refreshSubscriptionTimeoutId=void 0}};e.prototype._getChangeMessages=function(){return Object(a.__awaiter)(this,void 0,void 0,function(){var e;return Object(a.__generator)(this,function(t){switch(t.label){case 0:return[4,this._template.getChangeMessages(this._dispatch,this._syncToken,this._driveUrlParts)];case 1:e=t.sent();this._syncToken=e.syncToken?e.syncToken:"latest";this._getChangesAttempts=0;return[2,e]}})})};e.prototype._onNotification=function(){return Object(a.__awaiter)(this,void 0,void 0,function(){var e;return Object(a.__generator)(this,function(t){switch(t.label){case 0:t.trys.push([0,2,,3]);if(this._template.hasPendingRequest())return[2];this._isTestMode&&this._onNotificationReceived&&this._onNotificationReceived();return[4,this._resolveChangeMessages()];case 1:t.sent();return[3,3];case 2:e=t.sent();this._log("onNotification error",e);return[3,3];case 3:return[2]}})})};e.prototype._resolveChangeMessages=function(){return Object(a.__awaiter)(this,void 0,void 0,function(){var t,n,i,s,o,u,f,l,c;return Object(a.__generator)(this,function(a){switch(a.label){case 0:t=new v.e({publisher:e});return[4,this._getChangeMessages()];case 1:n=a.sent();this._log("Change messages",n);i=this._processMessages(n.messages);this._log("Changes",i);t.merge(n.itemResolver);for(s=0,o=i;s<o.length;s++)switch((u=o[s]).type){case r.New:t.invalidateItems({items:(f={},f[u.invalidateKey]=[p.t],f)});break;case r.Update:u.hasSelection&&this._itemScopeItemKey?this._updateItems(u.invalidateKey):t.invalidateItems({items:(l={},l[u.invalidateKey]=[u.invalidateFacet],l)});break;case r.Delete:t.invalidateItems({items:(c={},c[u.invalidateKey]=[d.l],c)})}this._dispatch(t.execute());return[2]}})})};e.prototype._processMessages=function(e){var t=[];e.sort(function(e,t){return e.parentItemKey?0:1});for(var n=0;n<e.length;n++){var r=e[n],i=this._template.processMessage(this._dispatch,r,this._itemScopeItemKey);if(void 0!==i){this._log("Change",i.invalidateKey,i.reason);t.push(i)}else if(r.parentItemKey)for(var s=n+1;s<e.length;s++){if(e[s].itemKey===r.parentItemKey){e.splice(s,1);break}}}return t};e.prototype._updateItems=function(e){this._template.updateItems(this._dispatch,e)};e.prototype._log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];g.e.isFeatureEnabled(T)&&console.log.apply(console,Object(a.__spreadArrays)(["ItemAutoRefreshHelper"],e))};return e})(),k=n(1611),L=n(2612),A=n(109),O=n(4315),M=n(4314),_=n(12),D=n(439),P=n(56),H=n(1),B=n(43),j=n(333),F=n(90),I=n(122),q=n(106),R=n(268),U=n(137),z=n(557),W=n(675),X=n(1014),V=n(82),$=(function(){function e(e){this._dataRequestor=e.dataRequestor;this._rootItemKey=e.rootItemKey;this._pendingRequest=!1}e.prototype.onUnsubscribe=function(e){};e.prototype.getSubscription=function(e){var t,n,r,i,s,o,u,a,f,l=this,c=e(Object(q.e)(function(e){return{spItem:e.demandItemFacet(B.e,l._rootItemKey)}})).spItem;if((null===(t=c)||void 0===t?void 0:t.webAbsoluteUrl)&&c.listFullUrl){var h=F.e.serialize({webAbsoluteUrl:null===(n=c)||void 0===n?void 0:n.webAbsoluteUrl,listFullUrl:null===(r=c)||void 0===r?void 0:r.listFullUrl}),p=e(Object(q.e)(function(e){return e.demandItemFacet(H.Je,h)}));if((null===(i=p)||void 0===i?void 0:i.notificationUrl)&&(null===(s=p)||void 0===s?void 0:s.expirationDateTime)&&(null===(o=p)||void 0===o?void 0:o.subscribeID))return{notificationUrl:null===(u=p)||void 0===u?void 0:u.notificationUrl,expirationDateTime:null===(a=p)||void 0===a?void 0:a.expirationDateTime,id:null===(f=p)||void 0===f?void 0:f.subscribeID}}};e.prototype.hasPendingRequest=function(){return this._pendingRequest};e.prototype.getChangeMessages=function(e,t,n){var r;return Object(a.__awaiter)(this,void 0,void 0,function(){var i,s,o,u,f,l,c,h,p,d,m,g,b,w,E,S,x,T,N,C,k,O,M,_,D,P,j,$,J,K,Q,G=this;return Object(a.__generator)(this,function(Y){switch(Y.label){case 0:if(void 0===n||void 0===n.endpoint||void 0===n.driveId)throw"Invalid drive url parts";i=n.endpoint+"/drives/"+n.driveId;s=e(Object(R.e)({isTAB:A.x})).isTAB;o=e(Object(q.e)(function(e){return{spItem:e.demandItemFacet(B.e,G._rootItemKey)}})).spItem;u=new v.e;if("latest"===t&&o){f=F.e.serialize({webAbsoluteUrl:o.webAbsoluteUrl,listFullUrl:o.listFullUrl});l=e(Object(q.e)(function(e){return e.demandItemFacet(H.Ue,f)}));if(c=null===(r=l)||void 0===r?void 0:r.tick){h=c-621355968e9;h/=1e4;p=new Date(h);if(!y.t.isActivated("90f6bcb1-03a0-4a02-9370-1e6807d6763a","7/22/2021","Fix Item Auto Refresh Bug")){t=""+p.toISOString();d=new Date;if((d.getTime()-p.getTime())/1e3<30)return[2,{syncToken:t,messages:[],itemResolver:u}]}return[2,{syncToken:""+p.toISOString(),messages:[],itemResolver:u}]}}return(b=n.endpoint)?[4,e(Object(L.getSessionToken)(n.endpoint,i))]:[3,2];case 1:b=Y.sent();Y.label=2;case 2:if(void 0===(m=(g=b)&&g.accessToken))throw new V.e({code:"authFailure"});this._pendingRequest=!0;w=i+"/root/view.delta?token="+encodeURIComponent(t);return[4,this._dataRequestor.send({apiName:"viewDelta",path:w,accessToken:{accessToken:m,tokenUrl:i},useAuthorizationHeaders:!0,headers:Object(a.__assign)({"X-RestrictedReadCapabilities":"ForceCheckOut,RequiredColumn,ContentApproval,Irm,ExcludeFromOfflineClient,DocumentParser,DraftItemSecurity,ItemLevelPermissions"},s?{}:{ScenarioType:"BGO"})})];case 3:E=Y.sent();S=[];if(E&&E.value)for(x=0,T=E.value;x<T.length;x++){N=T[x];C=void 0;k={endpoint:n.endpoint,driveId:n.driveId,itemId:N.id};if(N.root){P=Object(z.t)(k);for(O=0,M=P;O<M.length;O++){J=M[O];u.mapKeys({mappings:(K={},K[J]=this._rootItemKey,K)})}}else if(N.webUrl&&(_=Object(W.n)(N.webUrl))){D=X.e.serialize({itemFullUrl:_});if(e(Object(I.e)({spItemKey:B.e},D)).spItemKey){P=Object(z.t)(k);for(j=0,$=P;j<$.length;j++){J=$[j];u.mapKeys({mappings:(Q={},Q[J]=D,Q)})}}}if(!N.root){N.parentReference&&(C=N.parentReference.id);S.push({itemKey:U.e.serialize(k),parentItemKey:C&&U.e.serialize({endpoint:n.endpoint,driveId:n.driveId,itemId:C}),isDeleted:!!N.deleted,isShared:!!N.shared,name:N.name,dateModified:N.lastModifiedDateTime,eTag:N.eTag})}}this._pendingRequest=!1;return[2,{syncToken:E["@delta.token"],messages:S,itemResolver:u}]}})})};e.prototype.updateItems=function(e,t,n){};e.prototype.processMessage=function(e,t,n){if(t.isDeleted){if(e(Object(I.e)({deleted:d.l},t.itemKey)).deleted)return;return{type:r.Delete,invalidateKey:t.itemKey,reason:"Deleted"}}var i=e(Object(I.e)({spItemKey:B.e,mediaTransformSchema:D.e,displayName:d.h},t.itemKey)),s=i.spItemKey,o=i.mediaTransformSchema,u=i.displayName;if(void 0===s){if(!t.parentItemKey)return;return{type:r.New,invalidateKey:t.parentItemKey,reason:"New item"}}if(o&&t.eTag){var a=o[".etag"];if(a&&t.eTag&&t.eTag!==a)return{type:r.Update,invalidateKey:t.itemKey,invalidateFacet:D.e,reason:"eTag changed from "+a+" to "+t.eTag}}if(void 0!==t.name&&u!==t.name)return{type:r.Update,invalidateKey:t.itemKey,invalidateFacet:d.h,reason:"Name changed from "+u+" to "+t.name}};return e})(),J=n(368),K=n(33),Q=n(46),G=n(1946),Y=n(58),Z=n(245),ee=n(231),te=n(874),ne={ODB:819,ODC:"EnablePushChannelLogging"},re=(function(){function e(e){this._dispatch=e.dispatch;this._webAbsoluteUrl=e.webAbsoluteUrl;this._listFullUrl=e.listFullUrl;this._listId=e.listId}e.prototype.getSocketIoSubscription=function(e){return Object(a.__awaiter)(this,void 0,void 0,function(){var t,n,r,i,s,o,u,f,c,h,p,d,v,m,g;return Object(a.__generator)(this,function(a){switch(a.label){case 0:if(e.existingSubscription)return[3,5];n=Object(te.n)({webAbsoluteUrl:this._webAbsoluteUrl}).segments("microservicemanager","getserviceurls").parameter("service","push");return[4,this._dispatch(Object(ee.t)({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl,url:n.toString(),method:"GET",qosName:"GetServiceUrls",noRedirect:!0})).catch(function(e){Z.n.isFeatureEnabled(ne)&&console.log("Error getting service url: ",e)})];case 1:r=a.sent();i=this._dispatch(Object(R.e)({isTest:A.x})).isTest;if(!(s=r&&r.d&&r.d.GetServiceUrls&&r.d.GetServiceUrls.results&&r.d.GetServiceUrls.results[0])&&!i)throw new Error("Unable to retrieve PushChannel base url");i&&(s="https://northcentralus0-pushs.svc.ms");o=s+"/notifications/register";u=Y.e.generate();f=this._dispatch(Object(l.e)({name:"SubscriptionServiceGenericList.Register"}));c={correlationId:u};a.label=2;case 2:a.trys.push([2,4,,5]);return[4,G.e.start({url:o,method:"GET",headers:{"X-Correlation-Id":u},requestTimeoutInMS:1e4})];case 3:(h=a.sent())&&h.responseText&&h.responseText.length>0&&(p=JSON.parse(h.responseText))&&p.serverUrl&&p.webhookUrl&&(t=p.webhookUrl);if(void 0===t)throw new Error("Unable to retireve PushChannel notification url");this._dispatch(f({resultType:Q.t.success,extraData:c}));return[3,5];case 4:d=a.sent();this._dispatch(f({resultType:Q.t.failure,extraData:c}));throw d;case 5:v=Object(te.r)({webAbsoluteUrl:this._webAbsoluteUrl,listOrItemFullUrl:this._listFullUrl}).segment("lists").method("GetById",this._listId);if(e.existingSubscription){v=v.method("Subscriptions",{guid:e.existingSubscription.id}).segment("Update");t=e.existingSubscription.notificationUrl}else v=v.segments("Subscriptions","Add");m={parameters:{resource:this._listId,notificationUrl:t,expirationDateTime:new Date(Date.now()+3e5).toISOString(),clientState:""}};return[4,this._dispatch(Object(ee.t)({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl,url:v.toString(),body:JSON.stringify(m),qosName:"SubscriptionServiceGenericList.getSocketIoSubscription",method:"POST",noRedirect:!0}))];case 6:if((g=a.sent())&&g.d){delete g.d.__metadata;if(e.existingSubscription){g.d.id=e.existingSubscription.id;g.d.notificationUrl=e.existingSubscription.notificationUrl;g.d.expirationDateTime=m.parameters.expirationDateTime}return[2,g.d]}throw new Error("Invalid subscription object")}})})};e.prototype.deleteSocketIoSubscription=function(e){var t=Object(te.r)({webAbsoluteUrl:this._webAbsoluteUrl,listOrItemFullUrl:this._listFullUrl}).segment("lists").method("GetById",this._listId).method("Subscriptions",e.id);return this._dispatch(Object(ee.t)({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl,url:t.toString(),qosName:"SubscriptionServiceGenericList.deleteSocketIoSubscription",method:"DELETE",noRedirect:!0}))};return e})(),ie=n(346),se=n(49),oe=n(164),ue=n(301),ae=n(222),fe=(function(){function e(e){this._pushChannelService=e.pushChannelService;this._subscriptionService=e.subscriptionService;this._webAbsoluteUrl=e.webAbsoluteUrl;this._listFullUrl=e.listFullUrl;this._itemSetKey=e.itemSetKey;this._serverResponse=void 0;this._pendingRequest=!1}e.prototype.onUnsubscribe=function(e){if(0===e&&this._subscriptionService instanceof re){var t=this._pushChannelService.getSocketIoSubscription();t&&this._subscriptionService&&this._subscriptionService.deleteSocketIoSubscription(t)}};e.prototype.getSubscription=function(e){var t,n,r,i,s,o;if(this._webAbsoluteUrl&&this._listFullUrl){var u=F.e.serialize({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl}),a=e(Object(q.e)(function(e){return e.demandItemFacet(H.Je,u)}));if((null===(t=a)||void 0===t?void 0:t.notificationUrl)&&(null===(n=a)||void 0===n?void 0:n.expirationDateTime)&&(null===(r=a)||void 0===r?void 0:r.subscribeID))return{notificationUrl:null===(i=a)||void 0===i?void 0:i.notificationUrl,expirationDateTime:null===(s=a)||void 0===s?void 0:s.expirationDateTime,id:null===(o=a)||void 0===o?void 0:o.subscribeID}}};e.prototype.getChangeMessages=function(e,t,n){var r;return Object(a.__awaiter)(this,void 0,void 0,function(){var n,i,s,o,u,f,l,c,h,p,d,m,g,b,w,E,S,x,T,N,C,k,L,O,M,_,D,P,j,I,U,z,W,X=this;return Object(a.__generator)(this,function(V){switch(V.label){case 0:if("latest"===t){n=F.e.serialize({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl});i=e(Object(q.e)(function(e){return e.demandItemFacet(H.Ue,n)}));if(s=null===(r=i)||void 0===r?void 0:r.lastItemModifiedTime){o=new v.e;return[2,{syncToken:"SPO_LIST,"+s,messages:[],itemResolver:o}]}}this._pendingRequest=!0;if(l=!!t&&"SPO_LIST,"===t.substr(0,9)){c=t.split(",");h=c[1];p='<Gt><FieldRef Name="Modified" />';p+='<Value Type="DateTime" IncludeTimeValue="True" StorageTZ="True">'+h+"</Value>";u=p+="</Gt>";f=["ID","FileRef","Modified","Title"];d=this._getListColumns(e);for(m=0,g=d;m<g.length;m++)"ID"!==(b=g[m]).internalName&&"FileRef"!==b.internalName&&"Modified"!==b.internalName&&"Title"!==b.internalName&&f.push(b.internalName)}else{if(!y.t.isActivated("8E64F532-F77B-4526-B16A-48C7551BAD64","10/04/2021","Return empty messages and current time as sync token for initial sync"))return[2,{syncToken:"SPO_LIST,"+(new Date).toISOString(),messages:[],itemResolver:new v.e}];f=["ID","FileRef","Modified"]}"ID";w=l;E=l?200:1;S=new J.e("<View></View>");u&&S.addFilters([u]);f&&S.replaceFields(f);S.updateSort({fieldName:"ID",isAscending:w});S.updateRowLimit({rowLimit:E,isPerPage:!1});x=e(Object(q.e)(function(e){return Object(se.e)(e,B.e.serialize({webAbsoluteUrl:X._webAbsoluteUrl,listFullUrl:X._listFullUrl}))}));return[4,e(Object(R.e)({isTAB:A.x}))];case 1:T=V.sent().isTAB;this._requestDatesInUtc=!x;return[4,e(Object(ie.e)({getItemContext:Object(a.__assign)(Object(a.__assign)({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl,qosName:"ItemAutoRefreshGenericList.GetChanges",viewXml:S.getEffectiveViewXml()},T?{}:{isBackground:!0}),{postDataContext:{requestDatesInUtc:this._requestDatesInUtc,needsSchema:!0},currentPageContext:x})}))];case 2:N=V.sent();this._serverResponse=N;C=N.ListData;k=C&&C.Row||[];L=[];O=l?this._getLastModifiedTimeInList(k,x):(new Date).toISOString();for(M=0,_=k;M<_.length;M++)if(void 0!==(D=_[M]).FileRef){P={};j=Object.keys(D);for(I=0,U=j;I<U.length;I++){z=U[I];W=0===z.indexOf("OData_")?z.substr(6):z;P[W]=D[z]}L.push(Object(a.__assign)(Object(a.__assign)({itemKey:B.e.serialize({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl,itemId:D.ID}),parentItemKey:B.e.serialize({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl}),isDeleted:!1,isShared:!1,name:D.Title||""},D.Modified?{dateModified:""+D.Modified}:{}),{fields:P}))}0===L.length&&L.push({itemKey:B.e.serialize({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl}),isDeleted:!1,isShared:!1});this._pendingRequest=!1;return[2,{syncToken:"SPO_LIST,"+O,messages:L,itemResolver:new v.e}]}})})};e.prototype.hasPendingRequest=function(){return this._pendingRequest};e.prototype.updateItems=function(e,t){if(t&&o.e.matches(this._itemSetKey)&&this._serverResponse){var n=o.e.deserialize(this._itemSetKey),r={webAbsoluteUrl:n.webAbsoluteUrl,listFullUrl:n.listFullUrl,rootFolder:n.rootFolder||""},i=e(Object(ae.n)({itemSetKey:r})),s=e(Object(ae.e)(n,i,"getSPItem")),u=e(Object(ue.t)({serverData:this._serverResponse,itemSetKey:r,contentTypes:i,currentPageContext:s.currentPageContext,isItemSetRequest:!1})).itemResolver;e(u.execute())}this._serverResponse=void 0};e.prototype.processMessage=function(e,t,n){var i=e(Object(q.e)(function(e){var r=Object(oe.e)(e,{itemsScopeItemKey:n});return e.isItemFacetResolved(B.e,t.itemKey)?{rowData:e.demandItemFacet(H.At,t.itemKey),spItemKey:e.demandItemFacet(B.e,t.itemKey),title:e.demandItemFacet(H.bn,t.itemKey),selectedItemKeys:r}:{rowData:void 0,spItemKey:void 0,title:void 0,selectedItemKeys:r}})),s=i.rowData,o=i.spItemKey,u=i.title,a=i.selectedItemKeys,f=a&&a.length>0;if(void 0===t.parentItemKey){if(f)return;return{type:r.New,invalidateKey:t.itemKey,reason:"Deleted an unknown item"}}if(t.isDeleted){if(e(Object(I.e)({deleted:d.l},t.itemKey)).deleted||f)return;return{type:r.Delete,invalidateKey:t.itemKey,reason:"Deleted"}}if(void 0===o||void 0===s){if(!t.parentItemKey)return;if(void 0===e(Object(I.e)({spParentItemKey:B.e},t.parentItemKey)).spParentItemKey)return;return f?void 0:{type:r.New,invalidateKey:t.parentItemKey,reason:"New item"}}if(void 0!==u&&void 0!==t.name&&u!==t.name)return{type:r.Update,invalidateKey:t.itemKey,invalidateFacet:H.bn,hasSelection:f,reason:'Item title changed from "'+u+'" to '+t.name+")"};if(t.fields){f||(this._serverResponse=void 0);for(var l=this._getListColumns(e),c=function(e){for(var n=e.internalName,i=0,o=Object.keys(t.fields).filter(function(e){return e!==n+".COUNT"&&0===e.indexOf(n)});i<o.length;i++){var u=o[i],a=s&&s[u],l=t.fields[u];try{"object"==typeof a&&(a=JSON.stringify(a));"object"==typeof l&&(l=JSON.stringify(l));if(h._requestDatesInUtc&&"DateTime"===e.fieldType){var c=Date.parse(a),p=Date.parse(l);if(!isNaN(c)&&!isNaN(p)){a=c;l=p}}}catch(e){continue}if(a!==l)return{value:{type:r.Update,invalidateKey:t.itemKey,invalidateFacet:H.At,hasSelection:f,reason:'Item field "'+n+'" changed from "'+a+'" ('+typeof a+') to "'+l+'" ('+typeof l+")"}}}},h=this,p=0,v=l;p<v.length;p++){var m=c(v[p]);if("object"==typeof m)return m.value}}};e.prototype._getLastModifiedTimeInList=function(e,t){var n=(new Date).toISOString();if(e&&e.length>0)for(var r=void 0,i=0,s=e;i<s.length;i++){var o=s[i];if(this._requestDatesInUtc){var u=o.Modified;if(u){f=new Date(u);if(void 0===r||r<f){r=f;n=""+u}}}else{var a=o["Modified."];if(a){var f=new Date(a),l=t&&t.webTimeZoneData?t.webTimeZoneData.Bias-f.getTimezoneOffset():0;l&&f.setTime(f.getTime()+6e4*l);if(void 0===r||r<f){r=f;n=f.toISOString()}}}}return n};e.prototype._getListColumns=function(e){var t=[],n=e(Object(I.e)({schema:p.o},this._itemSetKey)).schema,r=n&&n.columnKeys;if(r)for(var i=0,s=r;i<s.length;i++){var o=s[i],u=e(Object(I.e)({internalName:H.Te,fieldType:H.ce,mappedFieldType:H.Ke},o)),a=u.internalName,f=u.fieldType,l=u.mappedFieldType;void 0!==a&&void 0!==f&&void 0!==l&&l!==K.t.Title&&t.push({internalName:a,fieldType:f,mappedFieldType:l})}return t};return e})(),le=n(265),ce=n(332),he=n(51),pe=n(5),de=n(157),ve=n(235),me=n(155),ge=n(2247),ye=(function(){function e(e){this._connectionCallbacks={};this._notificationCallback=void 0;this._notificationId=void 0;this._siteId=e.siteId;this._listId=e.listId;this._isConnected=!1;this._client=e.dataSyncClient}e.prototype.isConnected=function(){return this._isConnected};e.prototype.getSocketIoSubscription=function(){};e.prototype.addConnectionHandler=function(e,t){this._connectionCallbacks[e]=t};e.prototype.removeConnectionHandler=function(e){this._connectionCallbacks[e]&&delete this._connectionCallbacks[e]};e.prototype.setupNotificationHandler=function(e,t){this._notificationCallback=t;return!0};e.prototype.disconnect=function(){this._notificationCallback=void 0;this._connectionCallbacks={};this._notificationId&&this._client&&this._client.removeListStatusCallback(this._notificationId);this._isConnected=!1};e.prototype.refreshSubscription=function(){return Object(a.__awaiter)(this,void 0,void 0,function(){return Object(a.__generator)(this,function(e){return[2,!0]})})};e.prototype.connect=function(e,t){return Object(a.__awaiter)(this,void 0,void 0,function(){var e,t,n,r,i,s;return Object(a.__generator)(this,function(o){switch(o.label){case 0:t=(e=this)._client,n=e._siteId,r=e._listId;i={siteId:n,listId:r};return[4,t.isListDataSyncEnabledAsync(i)];case 1:if(!o.sent())return[3,3];s=this;return[4,t.addListStatusCallbackAsync(this._onNotification.bind(this),i,{sendConnectionNotifications:!0})];case 2:s._notificationId=o.sent();return[2,!0];case 3:return[2,!1]}})})};e.prototype._onNotification=function(e){if(1===e.length){var t=e[0];t.dataRefreshNeeded?this._notificationCallback&&this._notificationCallback(void 0):t.state===ge.e.ListStatusConnected?this._notifyConnectionHandlers(!0):t.state===ge.e.ListStatusConnectionLost&&this._notifyConnectionHandlers(!1)}};e.prototype._notifyConnectionHandlers=function(e){this._isConnected=e;for(var t in this._connectionCallbacks)this._connectionCallbacks.hasOwnProperty(t)&&this._connectionCallbacks[t](e)};return e})(),be=n(215),we={ODB:860},Ee={ODB:818},Se=new pe.e("itemAutoRefreshHelper",{itemsScopeItemKey:Object(pe.s)(),spPageContextKey:Object(pe.s)()}),xe=Object(ce.e)(function(e){return{}});function Te(e){var t=e.spPageContextKey,n=e.pageContext,r=e.listId,i=e.webAbsoluteUrl,s=e.listFullUrl,o=e.isTAB,u=e.itemKey,a=e.driveUrl,f=e.itemsScopeItemKey,c=e.getDataSyncClient;return function(h){var p=h(xe),d=Se.serialize({itemsScopeItemKey:f,spPageContextKey:t}),v=p[d];if(!v){var m,g=void 0,b=void 0,w=!n||!Object(y.n)(n).isActivated("f3c67c53-3465-4927-924d-963e1011836b","09/29/2020","Skip checking the subscription service");if(c&&e.pushChannelService&&(w||e.subscriptionService)){g=e.pushChannelService;b=e.subscriptionService}else{if(n){var E=h(k.e).dataRequestor;b=new O.e({listId:r,webAbsoluteUrl:i},{dataRequestor:E})}else b=new re({dispatch:h,webAbsoluteUrl:i,listFullUrl:s,listId:r});g=new M.e({disableWebSockets:!0},{subscriptionService:b})}m=new fe({pushChannelService:g,subscriptionService:b,webAbsoluteUrl:i,listFullUrl:s,itemSetKey:u});v=p[d]=new C({id:d,isTestMode:o,onPushChannelConnected:function(){return window._isPushChannelConnected=!0},onNotificationReceived:function(){return window._tabPushNotification=!0},driveUrl:a,dispatch:h,template:m,itemsScopeItemKey:f,pushChannelService:g,logQoS:function(e){var t=h(Object(l.e)(e));return function(e){return h(t(e))}},onUnsubscribe:function(e){0===e&&delete p[d]}})}return v}}function Ne(e){var t=Object(le.t)();f.useLayoutEffect(function(){if(e.getDataSyncClient){var n=new Promise(function(n){(function(e){var t=this,n=e.pageContext,r=e.listId,i=e.getDataSyncClient;return i?i.then(function(i){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,s,o;return Object(a.__generator)(this,function(u){switch(u.label){case 0:t=void 0;s=void 0;return(o=i&&n&&r&&n.siteId)?[4,i.isListDataSyncEnabledAsync({listId:r,siteId:n.siteId})]:[3,2];case 1:o=u.sent();u.label=2;case 2:if(o){t=new ye({listId:r,siteId:n.siteId,dataSyncClient:i});s=void 0;return[2,Te(Object(a.__assign)(Object(a.__assign)({},e),{subscriptionService:s,pushChannelService:t}))]}return[2,Te(e)]}})})}):Promise.resolve(Te(e))})(e).then(function(e){var r=t(e);n(r.subscribe())})});return function(){n.then(function(e){return e()})}}return t(Te(e)).subscribe()},[]);return null}function Ce(e){var t=Object(le.t)();f.useLayoutEffect(function(){return t((function(e){var t=this,n=e.spPageContextKey,r=e.webAbsoluteUrl,i=e.listFullUrl,s=e.isTAB,o=e.driveUrl,u=e.endpoint,f=e.itemsScopeItemKey;return function(e){var c=e(xe),h=Se.serialize({itemsScopeItemKey:f,spPageContextKey:n}),p=c[h];if(!p){var d,v,m=e(k.e).dataRequestor;v=new $({dataRequestor:m,rootItemKey:B.e.serialize({webAbsoluteUrl:r,listFullUrl:i,rootFolder:""})});d=new M.e({disableWebSockets:!0},{subscriptionService:new O.e({},{dataRequestor:m}),sessionTokenFetcher:function(){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,n,r;return Object(a.__generator)(this,function(i){switch(i.label){case 0:return(n=u)?[4,e(Object(L.getSessionToken)(u,o))]:[3,2];case 1:n=i.sent();i.label=2;case 2:if(!(r=(t=n)&&t.accessToken))throw new V.e({code:"authFailure"});return[2,{accessToken:r,tokenUrl:o}]}})})}});p=c[h]=new C({id:h,isTestMode:s,onPushChannelConnected:function(){return window._isPushChannelConnected=!0},onNotificationReceived:function(){return window._tabPushNotification=!0},driveUrl:o,dispatch:e,itemsScopeItemKey:f,template:v,pushChannelService:d,logQoS:function(t){var n=e(Object(l.e)(t));return function(t){return e(n(t))}},onUnsubscribe:function(e){0===e&&delete c[h]}})}return p}})(e)).subscribe()},[]);return null}var ke=Object(c.t)()(function(){return function(e){return function(e,t){var n,r=t.itemKey;if(!r)return{};var i=e.demandItem({key:o.e},r).key;if(!i||!i.webAbsoluteUrl||!i.listFullUrl)return{};var s=i.webAbsoluteUrl,u=i.listFullUrl,a=j.e.serialize({webAbsoluteUrl:s,listFullUrl:u}),l=e.demandItemFacet(H.ln,a);if(!Object(P.e)(e,{feature:we,pageContext:l})||!Object(P.e)(e,{feature:Ee,pageContext:l}))return{};var c=Object(be.c)(function(t){return Object(P.e)(e,{feature:t})},be.e.SharePointList)?null===(n=e.demandItemFacet(H.zt,me.e))||void 0===n?void 0:n.dataSyncClient:void 0,p=F.e.serialize({webAbsoluteUrl:s,listFullUrl:u}),d=e.demandItem({listFacets:H.Ue,listMediaTransformSchema:D.t},p),v=d.listFacets,m=d.listMediaTransformSchema;if(!v||void 0===v.id||void 0===v.templateType)return{};var g=v.isDocumentLibrary,y=_.s(v.templateType);if(!g&&!y)return{};var w,E=Object(h.e)(e,{isTAB:A.x}).isTAB,S=m&&m[".driveUrl"],x=S&&Object(b.e)(S),T=x&&x.endpoint,N=Object(he.e)(e).itemsScopeItemKey||"itemsSCopeItemKey";if(g&&!S)return{};var C=Object(de.e)(e,{itemsScopeItemKey:N});if(C&&C.id===ve.e.id)return{};if(g){if(!m)return{};if(!S)return{};if(E){var k=m[".driveAccessToken"];w=k&&k.replace("access_token=","")}if(!x)return{};var L=x.driveId;return T&&L?{isAvailable:!0,itemSubscriber:f.createElement(Ce,{spPageContextKey:a,driveUrl:S,isTAB:E,listFullUrl:u,endpoint:T,driveAccessToken:w,webAbsoluteUrl:s,pageContext:l,itemsScopeItemKey:N})}:{}}return{isAvailable:!0,itemSubscriber:f.createElement(Ne,{spPageContextKey:a,isTAB:E,itemKey:r,listFullUrl:u,webAbsoluteUrl:s,listId:v.id,pageContext:l,driveUrl:S,itemsScopeItemKey:N,getDataSyncClient:c})}}}});var Le=Object(i.t)(function(){return function(e){e(Object(s.e)(o.e,u.e)(ke))}})}],Array(74),[function(e,t,n){"use strict";n.r(t);n.d(t,"sharePointAddonQuickEdit",function(){return b});var r=n(16),i=n(386),s=n(78),o=n(417),u=n("react-lib"),a=n(1318),f=n(0),l=n(70),c=n(42),h=n(235),p=n(870),d=Object(l.e)(function(){return Object(f.__awaiter)(void 0,void 0,void 0,function(){return Object(f.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee(64,1707)];case 1:return[2,e.sent().ItemSetQuickEditList]}})})}),v=function(e){var t=e&&e.itemKey;return t?u.createElement(d,Object(f.__assign)({},e,{itemKey:t})):null},m={layoutType:h.e,layoutHandler:function(e,t){var n=Object(c.e)(e);return{isAvailable:Object(p.e)(e,t),allowEmptyFolder:!1,itemKey:n,onRender:v}}},g=n(14),y=Object(g.t)()(function(){return function(e){return function(e,t){return{quickEditLayout:m,quickEditLegacyLayout:u.createElement(a.e,null)}}}});var b=Object(r.t)(function(){return function(e){e(Object(i.e)(s.e,o.e)(y))}})},,,function(e,t,n){"use strict";n.r(t);n.d(t,"ItemLibrariesDropdown",function(){return A});n.d(t,"LibrariesDropdown",function(){return O});var r=n("react-lib"),i=n(121),s=n(4234),o=n(192),u=n(78),a=n(90),f=n(655),l=n(40),c=n(10),h=n(6),p=n(43),d=n(1),v=n(537),m=n(169),g=n(12),y=n(295),b=n(29),w=n(713),E=n(13),S=n(3456),x=new(n(21).e)("LibrariesDropdownControl",{}),T=n(132),N=n(163),C=n(216),k={component:"LibrariesDropdown;"},L=Object(T.t)({withContext:k}),A=Object(C.n)(L)(function(e){var t=r.useRef(null),n=r.useState(!1),E=n[0],C=n[1],k=Object(m.e)(function(){return C(!1)}),L=Object(l.e)("librariesDropdown_6ac370b8",e.className,E?"librariesDropdownOpen_6ac370b8":"librariesDropdownNotOpen_6ac370b8");return r.createElement(o.e,null,function(n){var o,m=n.itemCache,A=(n.dispatch,null===(o=Object(T.n)(m))||void 0===o?void 0:o.telemetry),O=e.itemKey,M=m.demandItemFacet(p.e,O),_=m.demandItemFacet(u.e,O),D=Object(w.e)(m);if(M||_){var P=Object(b.e)(m,{enableLibrariesDropdown:d.F}).enableLibrariesDropdown,H=void 0,B=void 0,j=void 0;if(M){H=M.webAbsoluteUrl;B=M.rootFolder;j=a.e.serialize(M)}else{if(!_)return null;H=_.webAbsoluteUrl;B=_.rootFolder;j=a.e.serialize(_)}var F=m.demandItemFacet(d.Ue,j),I=!(D||!P||!F||F.templateType!==g.n.documentLibrary||""!==B),q=m.demandItemFacet(x,O);if(!x.evaluate(q)(m,{itemKey:O,isAvailable:I}).isAvailable)return null;var R=[],U=null;if(E){var z=m.demandItemFacet(c.e,f.e.serialize({webAbsoluteUrl:H}));if(z&&z.itemKeys&&z.itemKeys.length){U=function(){A&&A(N.e).logData({name:"LibrariesDropdown.Load",component:"LibrariesDropdown;",objectType:"Libraries",extraData:{numberOfLibraries:z.itemKeys.length},isIntentional:!0})};R=z.itemKeys.map(function(e){return{key:e,name:m.demandItemFacet(h.h,e)||"",action:r.createElement(y.e,{itemKey:e})}})}}return r.createElement(r.Fragment,null,r.createElement("button",{className:L,onClick:E?k:function(){A&&A(N.e).logData({name:"LibrariesDropdown.OpenDropdown",component:"LibrariesDropdown;",isIntentional:!0});C(!0)},ref:t,"aria-label":s.e,title:s.e},r.createElement(v.e,{iconName:"Library",className:Object(l.e)("librariesDropdownIcon_6ac370b8")}),r.createElement(v.e,{iconName:"ChevronDown",className:Object(l.e)("librariesDropdownChevron_6ac370b8")})),E?r.createElement(S.e,{commands:R,target:t.current,directionalHint:i.e.bottomLeftEdge,alignTargetEdge:!0,onDismiss:k,isOpen:!0,onMenuOpened:U||void 0}):null)}return null})}),O=Object(E.e)()(A)}])]);